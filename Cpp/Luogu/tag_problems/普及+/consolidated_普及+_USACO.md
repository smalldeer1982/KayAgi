---
title: "[USACO24JAN] Cowmpetency S"
layout: "post"
diff: 普及+/提高
pid: P10134
tag: ['贪心', '线段树', 'USACO', '2024', '排序']
---
# [USACO24JAN] Cowmpetency S
## 题目描述

Farmer John 正在为他的奶牛们雇用一位新的牛群领队。为此，他面试了 $N$（$2\le N\le 10^5$）头奶牛来担任该职位。在面试第 $i$ 个候选牛后，他会为候选牛分配一个 $1$ 到 $C$（$1\le C\le 10^9$）范围内的整数「牲任力」分数 $c_i$，与她们的领导能力相关。

由于 Farmer John 面试了如此多的奶牛，他没能记得所有奶牛的牲任力分数。然而，他确实记得 $Q$（$1\le Q<N$）对数字 $(a_j,h_j)$，其中奶牛 $h_j$ 是第一头比奶牛 $1$ 到 $a_j$ 拥有严格更高牲任力分数的奶牛（所以 $1\le a_j<h_j\le N$）。

Farmer John 现在告诉你序列 $c_1,\ldots,c_N$
（其中 $c_i=0$ 表示他忘记了奶牛 $i$ 的牲任力分数）和 $Q$ 对 $(a_j,h_j)$。帮助他求出与此信息一致的最小字典序的牲任力分数序列，或者判断不存在这样的序列！如果一个分数序列比另一个分数序列于这两个序列不同的第一个位置上的奶牛分配了更小的分数，则这个分数序列的字典序更小。

每个测试点包含 $T$（$1\le T\le 20$）个独立的测试用例。输入保证所有测试用例的 $N$ 之和不超过 $3\cdot 10^5$。 
## 输入格式

输入的第一行包含 $T$，独立的测试用例的数量。每个测试用例描述如下：

 1. 第一行包含 $N$，$Q$ 和 $C$。
 2. 第二行包含序列 $c_1,\ldots,c_N$（$0\le c_i\le C$）。
 3. 最后 $Q$ 行，每行包含一个数对 $(a_j,h_j)$。输入保证同一测试用例内的所有 $a_j$ 各不相同。
## 输出格式

 对于每个测试用例，输出一行，包含与 Farmer John 记忆一致的最小字典序牲任力分数序列，或者如果这样的序列不存在时输出 $−1$。
## 样例

### 样例输入 #1
```
1
7 3 5
1 0 2 3 0 4 0
1 2
3 4
4 5
```
### 样例输出 #1
```
1 2 2 3 4 4 1
```
### 样例输入 #2
```
5
7 6 10
0 0 0 0 0 0 0
1 2
2 3
3 4
4 5
5 6
6 7
8 4 9
0 0 0 0 1 6 0 6
1 3
6 7
4 7
2 3
2 1 1
0 0
1 2
10 4 10
1 2 0 2 1 5 8 6 0 3
4 7
1 2
5 7
3 7
10 2 8
1 0 0 0 0 5 7 0 0 0
4 6
6 9
```
### 样例输出 #2
```
1 2 3 4 5 6 7
1 1 2 6 1 6 7 6
-1
1 2 5 2 1 5 8 6 1 3
-1
```
## 提示

### 样例解释 1

我们可以看到给定的输出满足所有 Farmer John 记得的数对。

- $\max(c_1)=1$，$c_2=2$ 且 $1<2$，故第一个数对是满足的
- $\max(c_1,c_2,c_3)=2$，$c_4=3$ 且 $2<3$，故第二个数对是满足的
- $\max(c_1,c_2,c_3,c_4)=3$，$c_5=4$ 且 $3<4$，故第三个数对是满足的

存在一些其他的序列与 Farmer John 的记忆相一致，如

$1\ 2\ 2\ 3\ 5\ 4\ 1$  
$1\ 2\ 2\ 3\ 4\ 4\ 5$

然而，其中没有序列比给定的输出字典序更小。 

### 样例解释 2

在测试用例 $3$ 中，由于 $C=1$，唯一可能的序列是

$1\ 1$

然而，在这种情况下，奶牛 $2$ 的分数并不比奶牛 $1$ 高，因此我们无法满足条件。

在测试用例 $5$ 中，$a_1$ 和 $h_1$ 告诉我们奶牛 $6$ 是第一头分数严格高于奶牛 $1$ 到 $4$ 的奶牛。因此，奶牛 $1$ 到 $6$ 的最高得分是奶牛 $6$，为 $5$。由于奶牛 $7$ 的分数为 $7$，所以奶牛 $7$ 是第一头比奶牛 $1$ 到 $6$ 得分更高的奶牛。因此，第二个陈述「奶牛 $9$ 是第一头比奶牛 $1$ 到 $6$ 得分更高的奶牛」不能成立。 

### 测试点性质

 - 测试点 $3$：$N \le 10$ 且 $Q,C\le 4$。
 - 测试点 $4-8$：$N\le 1000$。
 - 测试点 $9-12$：没有额外限制。


---

---
title: "[USACO24JAN] Cowlendar S"
layout: "post"
diff: 普及+/提高
pid: P10136
tag: ['USACO', '2024', '数论', '鸽笼原理']
---
# [USACO24JAN] Cowlendar S
## 题目描述

Bessie 在一个陌生的星球上醒来。这个星球上有 $N$（$1\le N\le 10^4$）个月，分别有 $a_1,\ldots,a_N$ 天（$1\le a_i\le 4\cdot 10^9$，所有 $a_i$ 均为整数）。此外，这个星球上还存在周，一周为 $L$ 天，其中 $L$ 是一个正整数。有趣的是，Bessie 知道以下事情：

- 对于正确的 $L$，每个月至少有 $4$ 周。
- 对于正确的 $L$，$a_i\bmod L$ 至多有 $3$ 个不同值。

不幸的是，Bessie 忘记了 $L$ 是多少！请通过输出 $L$ 的所有可能值之和来帮助她。

**注意这个问题涉及到的整数可能需要使用 64 位整数型（例如，C/C++ 中的 "long long"）。**
## 输入格式

输入的第一行包含一个整数 $N$。第二行包含 $N$ 个空格分隔的整数 $a_1,\ldots,a_N$。
## 输出格式

输出一个整数，为 $L$ 的所有可能值之和。
## 样例

### 样例输入 #1
```
12
31 28 31 30 31 30 31 31 30 31 30 31
```
### 样例输出 #1
```
28
```
### 样例输入 #2
```
4
31 35 28 29
```
### 样例输出 #2
```
23
```
## 提示

### 样例解释 1

$L$ 的可能值为 $1$，$2$，$3$，$4$，$5$，$6$ 和 $7$。例如，$L=7$ 是合法的，因为每个月的至少有 $4\cdot 7=28$ 天，且每个月的天数模 $7$ 的余数均为 $0$，$2$ 或 $3$。

### 样例解释 2

$L$ 的可能值为 $1$，$2$，$3$，$4$，$6$ 和 $7$。例如，$L=6$ 是合法的，因为每个月的至少有 $4\cdot 6=24$ 天，且每个月的天数模 $6$ 的余数均为 $1$，$4$ 或 $5$。

### 测试点性质

- 测试点 $3-4$：$1\le a_i\le 10^6$。
- 测试点 $5-14$：没有额外限制。


---

---
title: "[USACO24JAN] Nap Sort G"
layout: "post"
diff: 普及+/提高
pid: P10139
tag: ['二分', 'USACO', '2024']
---
# [USACO24JAN] Nap Sort G
## 题目描述

Bessie 正在尝试使用她自己的排序算法对一个整数数组进行排序。她有一堆共 $N$（$1\le N\le 2\cdot 10^5$）个整数 $a_1,a_2,\ldots,a_N$（$1\le a_i\le 10^{11}$），她将会按排序顺序将这些数放入一个单独的数组中。她反复查找这堆数中的最小数，将其删除，同时将其添加到数组的末尾。Bessie 在 $p$ 个数的堆中找到最小数需要花费 $p$ 秒。

Farmer John 命令了农场中其他一些奶牛帮助 Bessie 完成任务，她们很懒，然而 Bessie 利用了这一点。她将整数分成两堆：Bessie 堆和助手堆。对于 Bessie 堆中的每个整数，她会正常执行她的算法。对于助手堆中的每个整数，她将其分配给不同的助手奶牛。Farmer John 有一个很大的农场，所以 Bessie 可以找来任意多的助手奶牛。如果助手收到整数 $a_i$，Bessie 会指示该牛小睡 $a_i$ 秒，并在她们醒来时立即将该整数添加到数组末尾。如果 Bessie 和一个助手同时向数组添加整数，Bessie 的整数将优先被添加，因为她是领导者。如果多个助手被分配了相同的整数，她们会同时将多个该整数添加到数组中。

请帮助 Bessie 划分她的数，使得最终得到的数组是排序的，并使得排序该数组所需的时间最少。 
## 输入格式

输入的第一行包含 $T$，为独立的测试用例的数量（$1\le T\le 10$）。

每个测试用例的格式如下：

每个测试用例的第一行包含 Bessie 的数组中的数的数量 $N$。

下一行包含 $a_1,a_2,\ldots,a_N$，为 Bessie 将要排序的整数。相同的数值可能会多次出现。

输入保证所有测试用例的 $N$ 之和不超过 $2\cdot 10^5$。
## 输出格式

 对于每个测试用例输出一行，包含当 Bessie 以最优方案划分她的数时，排序该数组所需要的最小时间。
## 样例

### 样例输入 #1
```
4
5
1 2 4 5 100000000000
5
17 53 4 33 44
4
3 5 5 5
6
2 5 100 1 4 5
```
### 样例输出 #1
```
6
15
5
6
```
## 提示

### 样例解释 1

在第一个测试用例中，Bessie 可以将 $1,2$ 分配给助手，将 $4,5,10^{11}$ 留给自己。

| 时间 | 事件 |
| :-----------:| :----------- |
| $1$ | 助手添加了 $1$ |
| $2$ | 助手添加了 $2$ |
| $3$ | Bessie 添加了 $4$ |
| $5$ | Bessie 添加了 $5$ |
| $6$ | Bessie 添加了 $10^{11}$ |

在第二个测试用例中，Bessie 的最优方案是自己对所有数进行排序。一个不正确的划分是 Bessie 将 $4$ 分配给助手，其余的分配给她自己，因为助手将 $4$ 添加到数组之前 Bessie 就会将 $17$ 添加到数组中。

在第三个测试用例中，Bessie 可以将所有数都分配给助手。

在第四个测试用例中，Bessie 可以将 $1,4,5$ 分配给助手，将 $2,5,100$ 留给自己。

| 时间 | 事件 |
| :-----------:| :----------- |
| $1$ | 助手添加了 $1$ |
| $3$ | Bessie 添加了 $2$ |
| $4$ | 助手添加了 $4$ |
| $5$ | Bessie 添加了 $5$ |
| $5$ | 助手添加了 $5$ |
| $6$ | Bessie 添加了 $100$ |

### 测试点性质

- 测试点 $2$：$N\le 16$。
- 测试点 $3-5$：$N\le 150$。
- 测试点 $6-8$：$\sum N\le 5000$。
- 测试点 $9-11$：没有额外限制。


---

---
title: "[USACO24FEB] Milk Exchange B"
layout: "post"
diff: 普及+/提高
pid: P10188
tag: ['数学', 'USACO', '2024', 'O2优化', '图论建模']
---
# [USACO24FEB] Milk Exchange B
## 题目描述

Farmer John 的 $N$（$1\le N\le 2\cdot 10^5$）头奶牛排成一圈，使得对于 $1,2,\ldots,N−1$ 中的每个 $i$，奶牛 $i$ 右边的奶牛是奶牛 $i+1$，而奶牛 $N$ 右边的奶牛是奶牛 $1$。第 $i$ 头奶牛有一个容量为整数 $a_i$（$1\le a_i\le 10^9$）升的桶。所有桶初始时都是满的。

每一分钟，奶牛都会根据一个字符串 $s_1s_2\ldots s_N$
传递牛奶，该字符串仅由字符 `L` 和 `R` 组成。当第 $i$ 头奶牛至少有 $1$ 升牛奶时，如果 $s_i=\texttt{L}$，她会将 $1$ 升牛奶传递给她左边的奶牛，如果 $s_i=\texttt R$ 则传递给右边的奶牛。所有交换同时发生（即，如果一头奶牛的桶是满的，送出一升牛奶，但也收到一升，则她的牛奶量保持不变）。如果此时一头奶牛的牛奶量超过 $a_i$，则多余的牛奶会损失。

FJ 想要知道：经过 $M$ 分钟（$1\le M\le 10^9$）后，所有奶牛总共还余下多少牛奶？ 
## 输入格式

输入的第一行包含 $N$ 和 $M$。

第二行包含一个字符串 $s_1s_2\ldots s_N$，仅由字符 `L` 或 `R` 组成，表示每头奶牛传递牛奶的方向。

第三行包含整数 $a_1,a_2,\ldots,a_N$，为每个桶的容量。 
## 输出格式

输出一个整数，为 $M$ 分钟后所有奶牛总共余下的牛奶量。 

**注意这个问题涉及到的整数可能需要使用 64 位整数型（例如，C/C++ 中的 `long long`）。**
## 样例

### 样例输入 #1
```
3 1
RRL
1 1 1
```
### 样例输出 #1
```
2
```
### 样例输入 #2
```
5 20
LLLLL
3 3 2 3 3
```
### 样例输出 #2
```
14
```
### 样例输入 #3
```
9 5
RRRLRRLLR
5 8 4 9 3 4 9 5 4
```
### 样例输出 #3
```
38
```
## 提示

### 样例解释 1

奶牛 $2$ 和 $3$ 互相传递一升牛奶，因此她们的牛奶得以保留。当奶牛 $1$ 将牛奶传递给奶牛 $2$ 时，奶牛 $2$ 的桶会溢出，从而一分钟后损失了一升牛奶。 

### 样例解释 2

 每头奶牛都将一升牛奶传递给左边的奶牛，并从右边的奶牛那里获得一升牛奶，因此无论经过多长时间所有牛奶都会被保留下来。 
 
### 样例解释 3

初始时，共有 $51$ 升牛奶。$5$ 分钟后，奶牛 $3$，$6$ 和 $7$ 将分别损失 $5$，$3$ 和 $5$ 升牛奶。因此，总共还剩下 $38$ 升牛奶。

### 测试点性质

- 测试点 $4-8$：$N,M\le 1000$。
- 测试点 $9-16$：没有额外限制。


---

---
title: "[USACO24FEB] Target Practice II S"
layout: "post"
diff: 普及+/提高
pid: P10190
tag: ['数学', '二分', 'USACO', '2024', 'O2优化']
---
# [USACO24FEB] Target Practice II S
## 题目背景

**注意：本题的时间限制为 2.5 秒，通常限制的 1.25 倍。**

**注意：这个问题涉及到的整数可能需要使用 64 位整数型（例如，C/C++ 中的 `long long`）。**
## 题目描述

巴黎哞运会即将来临，Farmer John 正在对他的奶牛队进行射箭训练！他在二维坐标平面上设置了以下练习。

有 $N$（$1\le N\le 4\cdot 10^4$）个四边与坐标轴平行的矩形箭靶和 $4N$ 头奶牛。每头牛都必须被分配一个不同的箭靶顶点。对于 $1\le i\le N$，在时刻 $i$：

1. 箭靶 $i$ 出现。
2. 分配其顶点的 $4$ 头奶牛向它们射箭。
3. 如果奶牛的箭在击中所分配的顶点之前穿过箭靶内部，或未命中，则奶牛们的练习失败。
4. 箭靶消失，为下一个箭靶腾出空间。

每头牛都位于 $y$ 轴（$x=0$）上，每个箭靶都是一个矩形，其中箭靶 $i$ 的左下顶点坐标为 $(X_1,y^{(i)}_1)$，右上顶点坐标为 $(x^{(i)}_2,y^{(i)}_2)$。所有坐标满足 $1\le X_1<x^{(i)}_2\le 10^9$ 以及 $1\le y^{(i)}_1<y^{(i)}_2\le 10^9$（注意：$X_1$ 对于每个箭靶都是相同的）。

此外，每头奶牛都有一个正在钻研的「瞄准」角度。因此她们在射箭时会转向特定的角度。考虑到她们的箭从她们的位置沿直线射向指定的顶点，奶牛 $i$ 的箭的轨迹可以用轨迹的斜率 $s_i$（$0<|s_i|<10^9$）来表示。

为了能够仔细检查奶牛们的技术，Farmer John 希望尽量缩短最远的奶牛之间的距离。如果 Farmer John 以最佳方式给每头奶牛分配箭靶顶点并将她们放置在 $y$ 轴上，你能否帮助他求出最远奶牛之间的最小距离是多少，或者奶牛是否总是会练习失败？

每个测试点包含 $T$（$1\le T\le 10$）个独立的测试用例。输入保证所有测试用例的 $N$ 之和不超过 $4\cdot 10^4$。 
## 输入格式

输入的第一行包含 $T$（$1\le T\le 10$），为测试用例的数量。每个测试用例的描述如下：

每个测试用例的第一行包含两个整数 $N$ 和 $X_1$，分别为箭靶的数量以及所有箭靶的左端的 $x$ 坐标。

以下 $N$ 行，第 $i$ 行包含三个整数 $y^{(i)}_1$，$y^{(i)}_2$ 和 $x^{(i)}_2$，分别为第 $i$ 个箭靶的下端 $y$ 坐标，上端 $y$ 坐标和右端 $x$ 坐标。

最后一行包含 $4N$ 个整数 $s_1,s_2,\ldots,s_{4N}$，其中 $s_i$ 表示奶牛 $i$ 的射箭轨迹的斜率。
## 输出格式

输出最远奶牛之间的最小可能距离，或如果奶牛总是练习失败时输出 $−1$。
## 样例

### 样例输入 #1
```
3
2 1
1 3 6
4 6 3
1 -1 2 -2 3 -3 4 -4
2 1
1 3 6
4 6 3
1 1 2 2 3 3 4 4
2 1
1 3 3
4 6 3
1 -1 2 -2 3 -3 4 -4
```
### 样例输出 #1
```
17
-1
11
```
## 提示

### 样例解释

对于测试用例 $1$，一个最佳分配方案是分别为奶牛 $1-8$ 分配以下目标顶点：

$$(6,1),(6,3),(3,4),(3,6),(1,4),(1,3),(1,6),(1,1)$$

这得出了奶牛 $1-8$ 的 $y$ 坐标如下：

$$−5,9,−2,12,1,6,2,5$$

这给出了最小距离 $12−(−5)=17$。

第二个测试用例的答案是不可能的原因之一是，如果箭不穿过箭靶 $1$ 的内部，不可能射中 $(6,3)$ 处的顶点（箭靶 $1$ 的右上顶点）。

### 测试点性质

- 测试点 $2$：对于所有的 $1\le i\le 4N$，$|S_i|$ 均相同。
- 测试点 $3-9$：所有测试用例的 $N$ 之和不超过 $1000$。
- 测试点 $10-15$：没有额外限制。


---

---
title: "[USACO24FEB] Moorbles S"
layout: "post"
diff: 普及+/提高
pid: P10192
tag: ['动态规划 DP', '贪心', 'USACO', '2024', 'O2优化']
---
# [USACO24FEB] Moorbles S
## 题目描述

Bessie 和 Elsie 正在玩弹珠游戏。游戏的玩法如下：Bessie 和 Elsie 开始时各有一定数量的弹珠。Bessie 取出 $A$ 个弹珠放在蹄子下，Elsie 猜测 $A$ 是偶数还是奇数。如果 Elsie 猜对了，她从 Bessie 那里赢得 $A$ 个弹珠，如果她猜错了，她输给 Bessie $A$ 个弹珠（如果 Elsie 有少于 $A$ 个弹珠，她就会输掉所有弹珠）。一名玩家失去所有弹珠时即失败。

游戏进行了一定回合后，Elsie 拥有 $N$（$1\le N\le 10^9$）个弹珠。她感觉获胜很难，但她只是想不要输。在与 Bessie 玩得足够久之后，Elsie 对 Bessie 的习惯有了很好的了解，她发现在回合 $i$，Bessie 只可能会取出 $K$（$1\le K\le 4$）种不同数量的弹珠。距离 Bessie 感到无聊退出游戏只有 $M$（$1\le M\le 3\cdot 10^5$）个回合了。你能求出一个字典序最小的行动序列，使得无论 Bessie 如何选择，Elsie 都不会输吗？
## 输入格式

输入的第一行包含一个整数 $T$（$1\le T\le 10$），为测试用例的数量。每个测试用例的描述如下：

- 第一行包含三个整数 $N$，$M$ 和 $K$，分别表示 Elsie 拥有的弹珠数量，回合数及 Bessie 可能进行的选择数。
- 以下 $M$ 行，第 $i$ 行包含 $K$ 个不同的空格分隔的整数 $a_{i,1}a_{i,2}\ldots a_{i,K}$（$1\le a_{i,j}\le10^3$），表示 Bessie 在回合 $i$ 可能取出的弹珠数量。

输入保证所有测试用例的 $M$ 之和不超过 $3\cdot 10^5$。 
## 输出格式

对于每一个测试用例，输出 Elsie 保证不输的字典序最小的行动序列，或者如果她会输则输出 $−1$。行动序列输出在一行中，包含 $M$ 个空格分隔的单词，每个单词为 `Even`（偶）或 `Odd`（奇）。

注意：`Even` 的字典序小于 `Odd`。 
## 样例

### 样例输入 #1
```
2
10 3 2
2 5
1 3
1 3
10 3 3
2 7 5
8 3 4
2 5 6
```
### 样例输出 #1
```
Even Even Odd
-1
```
### 样例输入 #2
```
1
20 8 2
3 5
3 5
3 5
3 5
3 5
3 5
3 5
3 5
```
### 样例输出 #2
```
Even Even Even Odd Even Odd Even Odd
```
## 提示

### 样例解释 1

在第一个测试用例中，唯一字典序更小的行动序列是 `Even Even Even`，但 Bessie 可以使 Elsie 输，通过先出 $5$，将 Elsie 的弹珠数量从 $10$ 减少到 $5$，然后再出 $3$，将 Elsie 的弹珠数量从 $5$ 减少到 $2$，然后出 $3$，这会输光她所有的弹珠。

如果 Elsie 采用正确的行动序列 `Even Even Odd`，那么如果 Bessie 以同样的方式进行游戏，最后当她出 $3$ 时，Elsie 将获得那 $3$ 个弹珠，将她的弹珠数量增加到 $5$。可以进一步证明，只要 Elsie 操作是 `Even Even Odd`，Bessie 无法以其他的方式赢走 Elsie 的所有弹珠。

在第二个测试用例中，可以证明，对于 Elsie 可以选择的任何行动顺序，Bessie 都存在一种方式可以赢走 Elsie 的所有弹珠。

### 测试点性质

- 测试点 $3$：$M\le 16$。
- 测试点 $4-6$：$M\le 1000$。
- 测试点 $7-12$：没有额外限制。


---

---
title: "[USACO24FEB] Quantum Moochanics G"
layout: "post"
diff: 普及+/提高
pid: P10195
tag: ['数学', 'USACO', '堆', '2024', 'O2优化']
---
# [USACO24FEB] Quantum Moochanics G
## 题目描述

在空闲时间，Bessie 喜欢涉猎实验物理。她最近发现了一对新的亚原子粒子，命名为**哞微子**和**反哞微子**。如同标准的[物质-反物质对](https://baike.baidu.com/item/%E5%8F%8D%E7%89%A9%E8%B4%A8/115035)，哞微子和反哞微子相遇时会相互湮灭并消失。但这些粒子的独特之处在于，每当 Bessie 看向它们时它们就会改变运动方向（同时保持相同的速率）。

在她最新的实验中，Bessie 将**偶数** $N$（$2\le N\le 2\cdot 10^5$）个这些粒子排成一行。这一行的左端以哞微子开始，然后在两种类型的粒子之间交替，第 $i$ 个粒子位于位置 $p_i$（$0\le p_1<\cdots <p_N\le 10^{18}$）。哞微子初始时**向右**运动而反哞微子初始时**向左**运动，其中第 $i$ 个粒子以每秒 $s_i$ 单位的恒定速率运动（$1\le s_i\le 10^9$）。

Bessie 在以下时刻进行观察：

- 首先是实验开始后 $1$ 秒。
- 然后是第一次观察后 $2$ 秒。
- 然后是第二次观察后 $3$ 秒。
- $\ldots \ldots$
- 然后是第 $n$ 次观察后 $n+1$ 秒。

在每次观察中，Bessie 都会记下哪些粒子消失了。

这个实验可能需要非常长的时间才能完成，所以 Bessie 想要首先模拟一下它的结果。根据实验设置，请帮助 Bessie 求出她何时（即**观察次数**）会观察到各个粒子消失！可以证明，所有粒子最终都会消失。
## 输入格式

每个测试点包含 $T$（$1\le T\le 10$）个独立的测试用例。

每个测试用例包含三行。第一行包含 $N$，第二行包含 $p_1,\ldots,p_N$，第三行包含 $s_1,\ldots,s_N$。

输入保证所有 $N$ 之和不超过 $2\cdot 10^5$。 
## 输出格式

对于每一个测试用例，输出每个粒子消失时的观察次数，用空格分隔。 
## 样例

### 样例输入 #1
```
4
2
1 11
1 1
2
1 12
1 1
2
1 11
4 6
2
1 11
4 5
```
### 样例输出 #1
```
9 9
11 11
1 1
3 3
```
### 样例输入 #2
```
2
4
1 3 5 8
1 1 1 1
4
1 4 5 8
1 1 1 1
```
### 样例输出 #2
```
1 1 3 3
7 2 2 7
```
## 提示

### 样例解释 1

对于第一个测试用例，Bessie 在前 $8$ 次观察中观察到以下情况：

- 哞微子（初始时向右运动）出现在位置 $2\to 0\to 3\to −1\to 4\to −2\to 5\to −3$。
- 反哞微子（初始时向左运动）出现在位置 $10\to 12\to 9\to 13\to 8\to 14\to 7\to 15$。

然后恰好在观察 $9$ 时，两个粒子在位置 $6$ 相遇并相互湮灭。

对于第二个测试用例，反哞微子的初始位置更靠右 $1$
单位，从而两个粒子在观察 $11$ 之前半秒在位置 $6.5$ 相遇。

注意我们只关心观察次数，不关心时刻或位置。

### 样例解释 2

对于第一个测试用例：

- 最左边的两个粒子恰好在观察 $1$ 时在位置 $2$ 相遇。
- 最右边的两个粒子在观察 $3$ 之前半秒在位置 $6.5$ 相遇。

### 测试点性质

- 测试点 $3$：$N=2$。
- 测试点 $4$：$N\le 2000$，且对于所有粒子，$p_i\le 10^4$。
- 测试点 $5-7$：$N\le 2000$。
- 测试点 $8-12$：没有额外限制。


---

---
title: "[USACO24OPEN] Logical Moos B"
layout: "post"
diff: 普及+/提高
pid: P10274
tag: ['模拟', 'USACO', '2024', '分类讨论']
---
# [USACO24OPEN] Logical Moos B
## 题目描述

Farmer John 有一个布尔语句，包含 $N$ 个关键字（$1\le N<2\cdot 10^5$，$N$ 为奇数）。奇数位置仅出现 $\texttt{true}$ 或 $\texttt{false}$，偶数位置上仅出现 $\texttt{and}$ 或 $\texttt{or}$。

一个 $x \operatorname{OPERATOR} y$ 形式的短语，其中 $x$ 和 $y$ 为 $\texttt{true}$ 或 $\texttt{false}$，而 $\operatorname{OPERATOR}$ 为 $\texttt{and}$ 或 $\texttt{or}$ ，按如下规则求值：

- $x \operatorname{and} y$：如果 $x$ 和 $y$ 均为 $\texttt{true}$，则求值结果为 $\texttt{true}$，否则为 $\texttt{false}$。
- $x \operatorname{or} y$：如果 $x$ 或 $y$ 为 $\texttt{true}$，则求值结果为 $\texttt{true}$，否则为 $\texttt{false}$。

在求值该语句时，FJ 必须考虑 Moo 语言中的运算符优先级。与 C++ 类似，$\operatorname{and}$ 优先级高于 $\operatorname{or}$。更具体地说，在求值该语句时，重复以下步骤直至该语句仅包含一个关键字。

1. 如果语句中包含 $\operatorname{and}$，选择其中任意一个，并将其周围的短语替换为其求值结果。
2. 否则，该语句包含 $\operatorname{or}$。选择其中任意一个，并将其周围的短语替换为其求值结果。

可以证明，如果在指定的一个步骤中可以求值多个短语，那么选择哪一个求值并不重要；该语句最终的求值结果将始终相同。

FJ 有 $Q$（$1\le Q\le 2\cdot 10^5$）个询问。在每个询问中，他给你两个整数 $l$ 和 $r$（$1\le l\le r\le N$，$l$ 和 $r$ 均为奇数），并删除关键字 $l$ 到关键字 $r$ 之间的段。反过来，他希望用一个简单的 $\texttt{true}$ 或 $\texttt{false}$ 替换他刚刚删除的段，以使整个语句的求值结果为某个指定的布尔值。帮助 FJ 判断是否可行！ 
## 输入格式

输入的第一行包含 $N$ 和 $Q$。

下一行包含 $N$ 个字符串，为一个合法的布尔语句。

以下 $Q$ 行，每行包含两个整数 $l$ 和 $r$，以及一个字符串 $\texttt{true}$ 或 $\texttt{false}$，表示他希望整个语句的求值结果为 $\texttt{true}$ 还是 $\texttt{false}$。 
## 输出格式

输出一个长度为 $Q$ 的字符串，其中如果第 $i$ 个询问的结果为可能，则第 $i$ 个字符为 `Y`，否则为 `N`。 
## 样例

### 样例输入 #1
```
5 7
false and true or true
1 1 false
1 3 true
1 5 false
3 3 true
3 3 false
5 5 false
5 5 true
```
### 样例输出 #1
```
NYYYNYY
```
### 样例输入 #2
```
13 4
false or true and false and false and true or true and false
1 5 false
3 11 true
3 11 false
13 13 true
```
### 样例输出 #2
```
YNYY
```
## 提示

### 样例解释 1

我们来分析第一个询问：

如果我们删除段 $[1,1]$ 并替换为 $\texttt{true}$，那么整个语句将变为：

$\texttt{true and true or true}$

我们对位置 $2$ 处的 $\texttt{and}$

关键字求值，得到

$\texttt{true or true}$

由于我们没有剩下的 $\texttt{and}$ 关键字，我们必须求值 $\texttt{or}$ 关键字。求值结束后，余下的是

$\texttt{true}$

可以证明，如果我们用 $\texttt{false}$ 替换该段，该语句仍将求值为 $\texttt{true}$，因此我们输出 `N`，因为该语句不可能求值为 false。

对于第二个询问，我们可以将段 $[1,3]$
替换为 true，整个语句将求值为 $\texttt{true}$，因此我们输出 `Y`。

对于第三个询问，由于 $[1,5]$ 是整个语句，我们可以将其替换为任意内容，因此我们输出 `Y`。

### 测试点性质

- 测试点 $3-5$：$N,Q\le 10^2$。
- 测试点 $6-8$：$N,Q\le 10^3$。
- 测试点 $9-26$：没有额外限制。


---

---
title: "[USACO24OPEN] Bessie's Interview S"
layout: "post"
diff: 普及+/提高
pid: P10277
tag: ['USACO', '堆', '2024', '图论建模']
---
# [USACO24OPEN] Bessie's Interview S
## 题目描述

Bessie 正在寻找新工作！幸运的是，$K$ 名农夫目前正在招聘并举行面试。由于工作竞争激烈，农夫们决定按申请的顺序对奶牛进行编号和面试。有 $N$ 头奶牛在 Bessie 之前申请，因此她的编号为 $N+1$（$1\le K\le N\le 3\cdot 10^5$）。

面试过程如下。在时刻 $0$，对于每一个 $1\le i\le K$，农夫 $i$ 将开始面试奶牛 $i$。一旦一名农夫完成面试，他将立刻开始面试队列中的下一头奶牛。如果多名农夫同时完成，下一头奶牛可以根据自己的偏好选择接受任一此时空闲的农夫的面试。

对于每一个 $1\le i\le N$，Bessie 已经知道奶牛 $i$ 的面试将恰好花费 $t_i$ 分钟（$1\le t_i\le 10^9$）。然而，她不知道每头奶牛对农夫的偏好。

由于这份工作对 Bessie 来说非常重要，所以她想要认真准备面试。为此，她需要知道她会在何时接受面试，以及哪些农夫可能会面试她。帮助她求出这些信息！ 
## 输入格式

输入的第一行包含两个整数 $N$ 和 $K$。

第二行包含 $N$ 个整数 $t_1\ldots t_N$。 
## 输出格式

输出的第一行包含 Bessie 的面试将开始的时刻。

第二行包含一个长为 $K$ 的 `01` 字符串，其中如果农夫 $i$ 可能面试 Bessie 则第 $i$ 个字符为 `1`，否则为 `0`。 
## 样例

### 样例输入 #1
```
6 3
3 1 4159 2 6 5
```
### 样例输出 #1
```
8
110
```
## 提示

### 样例解释 1

除了 Bessie 之外有 $6$ 头奶牛，以及 $3$ 名农夫。面试过程将如下进行：

1. 于时刻 $t=0$，农夫 $1$ 面试奶牛 $1$，农夫 $2$ 面试奶牛 $2$，农夫 $3$ 面试奶牛 $3$。
2. 于时刻 $t=1$，农夫 $2$ 结束了对奶牛 $2$ 的面试并开始面试奶牛 $4$。
3. 于时刻 $t=3$，农夫 $1$ 和农夫 $2$ 都完成了面试，从而有两种可能：
    * 农夫 $1$ 面试奶牛 $5$，农夫 $2$ 面试奶牛 $6$。在这种情况下，农夫 $2$ 将于时刻 $t=8$ 完成面试并开始面试 Bessie。
    * 农夫 $1$ 面试奶牛 $6$，农夫 $2$ 面试奶牛 $5$。在这种情况下，农夫 $1$ 将于时刻 $t=8$ 完成面试并开始面试 Bessie。

从而，Bessie 的面试将于时刻 $t=8$ 开始，并且她可能会被农夫 $1$ 或农夫 $2$ 面试。

### 测试点性质

- 测试点 $2-3$：没有两名农夫同时完成面试。
- 测试点 $4-9$：$N\le 3\cdot 10^3$。
- 测试点 $10-21$：没有额外限制。


---

---
title: "[USACO24OPEN] The 'Winning' Gene S"
layout: "post"
diff: 普及+/提高
pid: P10279
tag: ['USACO', '2024', '单调栈']
---
# [USACO24OPEN] The 'Winning' Gene S
## 题目背景

**注意：本题的内存限制为 512MB，通常限制的 2 倍。**
## 题目描述

在多年举办比赛并看着 Bessie 一次又一次地获得第一名后，Farmer John 意识到这绝非偶然。他得出结论，Bessie 一定将胜利写进了 DNA，于是他开始寻找这种「胜利」基因。

他设计了一个过程来识别这个「胜利」基因的可能候选。他获取了 Bessie 的基因组，为一个长为 $N$ 的字符串 $S$，其中 $1\le N\le 3000$。他选择某个数对 $(K,L)$，其中 $1\le L\le K\le N$，表示「胜利」基因候选的长度将为 $L$，并且将在一个较大的 $K$ 长度子串中进行寻找。为了识别这一基因，他从 $S$ 中取出所有 $K$ 长度的子串，我们将称这样的子串为一个 $K$-mer。对于一个给定的 $K$-mer，他取出其所有长度为 $L$ 的子串，将字典序最小的子串识别为胜利基因候选（如果存在并列则选择其中最左边的子串），然后将该字串在 $S$ 中的起始位置 $p_i$（从 $0$ 开始索引）写入一个集合 $P$。

由于他还没有选定 $K$ 和 $L$，他想知道每对 $(K,L)$ 将有多少个候选。

对于 $1\ldots N$ 中的每一个 $v$，帮助他求出满足 $|P|=v$ 的 $(K,L)$ 对的数量。 
## 输入格式

输入的第一行包含 $N$，为字符串的长度。第二行包含 $S$，为给定的字符串。输入保证所有字符均为大写字符，其中 $s_i\in \texttt A-\texttt Z$，因为奶牛遗传学远比我们的高级。
## 输出格式

对于 $1\ldots N$ 中的每一个 $v$，输出满足 $|P|=v$ 的 $(K,L)$ 对的数量，每行输出一个数。

## 样例

### 样例输入 #1
```
8
AGTCAACG
```
### 样例输出 #1
```
11
10
5
4
2
2
1
1
```
## 提示

### 样例解释 1

在这个测试用例中，输出的第三行为 $5$ 是因为我们发现恰好有 $5$ 对 $K$ 和 $L$ 存在三个「胜利」基因候选。这些候选为（其中 $p_i$ 从 $0$ 开始索引）：

```plain
(4,2) -> P = [0,3,4]
(5,3) -> P = [0,3,4]
(6,4) -> P = [0,3,4]
(6,5) -> P = [0,1,3]
(6,6) -> P = [0,1,2]
```

为了了解 $(4,2)$ 如何得到这些结果，我们取出所有的 $4$-mer

```plain
AGTC
GTCA
TCAA
CAAC
AACG
```

对于每一个 $4$-mer，我们识别出字典序最小的长度为 $2$ 的子串

```plain
AGTC -> AG
GTCA -> CA
TCAA -> AA
CAAC -> AA
AACG -> AA
```

我们取出所有这些子串在原字符串中的位置并将它们添加到集合 $P$ 中，得到 $P=[0,3,4]$。

另一方面，如果我们关注 $(4,1)$ 对，我们会发现这只会得到总共 $2$ 个「胜利」基因候选。如果我们取出所有的 $4$-mer 并识别字典序最小的长度为 $1$ 的子串（用 A，A' 和 A* 来区分不同的 A），我们得到

```plain
AGTC -> A
GTCA' -> A'
TCA'A* -> A'
CA'A*C -> A'
A'A*CG -> A'
```

尽管 A' 和 A* 在最后 3 种情况下字典序均为最小，但最左边的子串优先，因此仅有 A' 在所有这些情况中被视为候选。这意味着 $P=[0,4]$。

### 测试点性质

- 测试点 $2-4$：$N\le 100$。
- 测试点 $5-7$：$N\le 500$。
- 测试点 $8-16$：没有额外限制。


---

---
title: "[USACO03FALL] Milking Grid（数据加强版）"
layout: "post"
diff: 普及+/提高
pid: P10475
tag: ['USACO', '哈希 hashing', 'KMP 算法']
---
# [USACO03FALL] Milking Grid（数据加强版）
## 题目描述

Every morning when they are milked, the Farmer John's cows form a rectangular grid that is $R (1 \leq R \leq 10,000)$ rows by $C (1 \leq C \leq 75)$ columns. As we all know, Farmer John is quite the expert on cow behavior, and is currently writing a book about feeding behavior in cows. He notices that if each cow is labeled with an uppercase letter indicating its breed, the two-dimensional pattern formed by his cows during milking sometimes seems to be made from smaller repeating rectangular patterns.

Help FJ find the rectangular unit of smallest area that can be repetitively tiled to make up the entire milking grid. Note that the dimensions of the small rectangular unit do not necessarily need to divide evenly the dimensions of the entire milking grid, as indicated in the sample input below.
## 输入格式

- Line $1$: Two space-separated integers: $R$ and $C$

- Lines $2\dots R+1$: The grid that the cows form, with an uppercase letter denoting each cow's breed. Each of the $R$ input lines has $C$ characters with no space or other intervening character.
## 输出格式

- Line 1: The area of the smallest unit from which the grid is formed
## 样例

### 样例输入 #1
```
2 5 
ABABA 
ABABA

```
### 样例输出 #1
```
2
```
## 提示

The entire milking grid can be constructed from repetitions of the pattern `AB`.
## 题目翻译

**【题目描述】**

每天早上挤奶时，农夫约翰的奶牛们排成一个 $R (1 \leq R \leq 10,000)$ 行乘 $C (1 \leq C \leq 75)$ 列的矩形网格。众所周知，约翰农夫是一个相当擅长牛行为的专家，目前正在撰写一本关于奶牛饲养行为的书。他注意到，如果每头奶牛都标有一个表示其品种的大写字母，那么奶牛在挤奶时形成的二维图案有时似乎是由更小的重复矩形图案组成的。

帮助约翰农夫找到可以重复铺设以组成整个挤奶网格的最小面积的矩形单元。请注意，小矩形单元的尺寸不一定需要完全整除整个挤奶网格的尺寸，如下面的示例输入所示。

**【输入格式】**

- 第一行：两个用空格分隔的整数：$R$ 和 $C$
- 第 $2\dots R+1$ 行：奶牛形成的网格，每个奶牛的品种用大写字母表示。每个 $R$ 输入行有 $C$ 个字符，没有空格或其他间隔字符。

**【输出格式】**

第一行：形成网格的最小单位的面积

**【提示说明】**

整个挤奶网格可以由图案 AB 的重复构建。

翻译来自于：ChatGPT。


---

---
title: "[USACO24DEC] Deforestation S"
layout: "post"
diff: 普及+/提高
pid: P11453
tag: ['贪心', '线段树', '二分', 'USACO', '堆', '2024', '差分约束']
---
# [USACO24DEC] Deforestation S
## 题目描述

Farmer John 正在扩大他的农场！他已经找到了完美的位置——红黑森林，由数轴上的 $N$ 棵树（$1≤N≤10^5$）组成，第 $i$ 棵树位于位置 $x_i$（$−10^9≤x_i≤10^9$）。

环境保护法限制了 Farmer John 可以砍伐哪些树来为他的农场腾出空间。有 $K$ 个限制（$1≤K≤10^5$），规定在线段 $[l_i,r_i]$（包含端点）中必须始终至少存在 $t_i$ 棵树（$−10^9≤l_i,r_i≤10^9$）。输入保证红黑森林初始时满足这些限制。

Farmer John 想要他的农场尽可能大。请帮助他计算他可以砍伐的树的最大数量，同时仍然满足所有限制！
## 输入格式

每个测试点包含 $T$（$1≤T≤10$）个独立的测试用例。输入保证一个测试点中的所有 $N$ 之和以及 $K$ 之和均不超过 $3⋅10^5$。

输入的第一行包含 $T$。每个测试用例的格式如下：

- 第一行包含整数 $N$ 和 $K$。
- 下一行包含 $N$ 个整数 $x_1,\cdots,x_N$。
- 以下 $K$ 行，每行包含三个空格分隔的整数 $l_i$，$r_i$ 和 $t_i$。
## 输出格式

对于每个测试用例，输出一行，包含一个整数，表示 Farmer John 可以砍伐的树的最大数量。
## 样例

### 样例输入 #1
```
3
7 1
8 4 10 1 2 6 7
2 9 3
7 2
8 4 10 1 2 6 7
2 9 3
1 10 1
7 2
8 4 10 1 2 6 7
2 9 3
1 10 4
```
### 样例输出 #1
```
4
4
3
```
## 提示

### 样例解释

对于第一个测试用例，Farmer John 可以砍伐前 $4$ 棵树，留下位于 $x_i=2,6,7$ 的树来满足限制。

对于第二个测试用例，额外的限制不会影响 Farmer John 可以砍伐哪些树，因此他可以砍伐相同的树并同时满足两个限制。

对于第三个测试用例，Farmer John 至多只能砍伐 $3$ 棵树，因为初始时有 $7$ 棵树，但第二个限制要求他至少留下 $4$ 棵树不砍伐。

### 测试点性质

测试点性质：
- 测试点 1：样例。
- 测试点 2：$N,K≤16$。
- 测试点 3-5：$N,K≤1000$。
- 测试点 6-7：对于所有的 $i=1,\cdots,K$ 有 $ti=1$。
- 测试点 8-11：没有额外限制。


---

---
title: "[USACO25JAN] Astral Superposition B"
layout: "post"
diff: 普及+/提高
pid: P11667
tag: ['USACO', '2025']
---
# [USACO25JAN] Astral Superposition B
## 题目描述

**注意：本题的时间限制为 4 秒，通常限制的 2 倍。**

Bessie 正在使用她超酷的望远镜拍摄夜空中所有星星的照片。她的望远镜能够拍摄到一张 $N \times N$（$1 \leq N \leq 1000$）的星星照片，其中每个像素是一颗星星或者空旷的天空。每颗星星可由恰好一个像素表示，并且没有两颗不同的星星位于同一像素内。

一夜之间，一些奇怪的事情发生在了天空中的星星之上。每颗星星要么消失，要么向右移动 $A$ 像素，并且向下移动 $B$ 像素（$0 \leq A,B \leq N$）。如果一颗星星消失或移动超出照片边界，它将不再出现在第二张照片中。

Bessie 在星星移动位置之前和之后拍了照片，但在 Mootoshop 中进行了一些实验后，她不小心将一张照片叠加到了另一张上。现在，她可以在两张照片都是天空的位置看到白色（white）像素，在星星仅存在于恰好一张照片的位置看到灰色（gray）像素，而在两张照片中都有星星的位置看到黑色（black）像素。Bessie 同时记得没有新的星星移动入第二张照片的范围，从而她的第一张照片包含了夜空中所有的星星。

对于 $T$（$1 \leq T \leq 1000$）个独立的测试用例，给定最终的照片，求在移动事件发生之前天空中星星的最小可能数量。如果不存在星星的排列可以产生给定的最终照片，输出 $-1$。
## 输入格式

输入的第一行包含 $T$，以下为 $T$ 个测试用例。

每个测试用例的第一行包含 $N$，$A$，$B$。

以下 $N$ 行，每行表示叠加后的照片的一行。从上到下第 $i$ 行由一个字符串 $c_{i,1}c_{i,2}\dots c_{i,N}$ 表示，其中 $c_{i,j} \in \{\texttt{W,G,B}\}$，分别表示颜色为白色，灰色以及黑色。

输入保证所有测试用例的 $N^2$ 之和不超过 $10^7$。
## 输出格式

对于每一个测试用例，输出移动之前存在的星星的最小数量，或 $-1$ 表示不可能。
## 样例

### 样例输入 #1
```
1
3 0 0
WWB
BBB
GGG
```
### 样例输出 #1
```
7
```
### 样例输入 #2
```
3
5 1 2
GWGWW
WGWWW
WBWGW
WWWWW
WWGWW
3 1 1
WWW
WBW
WWW
3 1 0
GGB
GGW
WWW
```
### 样例输出 #2
```
4
-1
4
```
## 提示

### 样例解释

在样例 #1 中，没有移动发生。第一张照片如下（. 表示天空，* 表示星星）：
```
..*
***
***
```
第二张照片中最下方一行的星星都消失了，如下：

```
..*
***
...
```
这是产生叠加后照片的唯一方式，所以初始时星星的最小可能数量为 $7$。

对于样例 #2，在第一个测试用例中，初始时至少有 $4$ 颗星星。如果我们令 $(r,c)$ 表示从上到下第 $r$ 行和从左到右第 $c$ 列的交点，一种可能性是它们最初位于 $(1,1)$，$(3,2)$，$(2,2)$ 和 $(1,3)$。除了位于 $(2,2)$ 的星星消失之外，其他所有星星都移动了。

在第二个测试用例中，在给定的移动方式下，没有任何初始照片中的星星排列可以产生中间的黑色像素。

在第三个测试用例中，初始时至少有 $4$ 颗星星。一种可能性是它们最初位于 $(1,1)$，$(1,2)$，$(1,3)$ 和 $(2,1)$。在第二张照片中，原先位于 $(1,1)$ 的星星消失了，原先位于 $(1,3)$ 的星星移出了照片边界。其他两颗星星向右移动了 $1$ 像素。

### 子任务

- 测试点 3：$A=B=0$。
- 测试点 4-7：$A=1$，$B=0$，$N\le 10$。
- 测试点 8-9：$A=1$，$B=0$。
- 测试点 10-12：没有额外限制。


---

---
title: "[USACO25JAN] Cow Checkups S"
layout: "post"
diff: 普及+/提高
pid: P11670
tag: ['USACO', '2025']
---
# [USACO25JAN] Cow Checkups S
## 题目描述

Farmer John 的 $N$（$1 \leq N \leq 5 \cdot 10^5$）头奶牛站成一行，奶牛 $1$ 在队伍的最前面，奶牛 $N$ 在队伍的最后面。FJ 的奶牛也有许多不同的品种。他用从 $1$ 到 $N$ 的整数来表示每一品种。队伍从前到后第 $i$ 头奶牛的品种是 $a_i$（$1 \leq a_i \leq N$）。

FJ 正在带他的奶牛们去当地的奶牛医院进行体检。然而，奶牛兽医非常挑剔，仅愿意当队伍中第 $i$ 头奶牛为品种 $b_i$（$1 \leq b_i \leq N$）时对其进行体检。

FJ 很懒惰，不想完全重新排列他的奶牛。他将执行以下操作恰好一次。

- 选择两个整数 $l$ 和 $r$，使得 $1 \leq l \le r \leq N$。反转队伍中第 $l$ 头奶牛到第 $r$ 头奶牛之间的奶牛的顺序。

FJ 想要衡量这种方法有多少效果。求出对于所有 $N(N+1)/2$ 种可能的操作被兽医检查的奶牛数量之和。
## 输入格式

输入的第一行包含 $N$。

第二行包含 $a_1, a_2, \ldots, a_N$。

第三行包含 $b_1, b_2, \ldots, b_N$。
## 输出格式

输出一行，包含对于所有可能的操作被兽医检查的奶牛数量之和。
## 样例

### 样例输入 #1
```
3
1 3 2
3 2 1
```
### 样例输出 #1
```
3
```
### 样例输入 #2
```
3
1 2 3
1 2 3
```
### 样例输出 #2
```
12
```
### 样例输入 #3
```
7
1 3 2 2 1 3 2
3 2 2 1 2 3 1
```
### 样例输出 #3
```
60
```
## 提示

### 样例解释

#### 样例 #1
如果 FJ 选择 $(l=1,r=1)$，$(l=2,r=2)$ 或 $(l=3,r=3)$，则没有奶牛将会被检查。注意这些操作并没有改变奶牛的位置。

以下操作会导致一头奶牛被检查。

- $(l=1,r=2)$：FJ 反转第一头和第二头奶牛的顺序，因此新队伍中每头奶牛的品种将为 $[3,1,2]$。第一头奶牛将会被检查。
- $(l=2,r=3)$：FJ 反转第二头和第三头奶牛的顺序，因此新队伍中每头奶牛的品种将为 $[1,2,3]$。第二头奶牛将会被检查。
- $(l=1,r=3)$：FJ 反转第一头，第二头和第三头奶牛的顺序，因此新队伍中每头奶牛的品种将为 $[2,3,1]$。第三头奶牛将会被检查。

所有六种操作中被检查的奶牛数量之和为 $0+0+0+1+1+1=3$。

#### 样例 #2

有三种导致 $3$ 头奶牛被检查的可能操作：$(l=1,r=1)$，$(l=2,r=2)$ 和 $(l=3,r=3)$。其余每种操作均导致 $1$ 头奶牛被检查。所有六种操作中被检查的奶牛数量之和为 $3+3+3+1+1+1=12$。

### 子任务
- 测试点 4：$N\le 100$。
- 测试点 5：$N\le 5000$。
- 测试点 6-9：$a_i$，$b_i$ 均在范围 $[1,N]$ 内均匀随机生成。
- 测试点 10-15：$a_i$，$b_i$ 均在范围 $[1,2]$ 内均匀随机生成。
- 测试点 16-23：没有额外限制。


---

---
title: "[USACO25JAN] Farmer John's Favorite Operation S"
layout: "post"
diff: 普及+/提高
pid: P11671
tag: ['USACO', '2025']
---
# [USACO25JAN] Farmer John's Favorite Operation S
## 题目描述

又是 Farmer John 的农场上寒冷而无聊的一天。为了打发时间，Farmer John 发明了一种关于在整数数组上进行操作的有趣的休闲活动。

Farmer John 有一个包含 $N$（$1 \leq N \leq 2 \cdot 10^5$）个非负整数的数组 $a$ 和一个整数 $M$（$1 \leq M \leq 10^9$）。然后，FJ 会请 Bessie 给出一个整数 $x$。在一次操作中，FJ 可以选择一个索引 $i$，并对 $a_i$ 加 $1$ 或减 $1$。FJ 的无聊值是他必须执行的最小操作次数，以使得对于所有的 $1 \leq i \leq N$，$a_i-x$ 均可被 $M$ 整除。

对于所有可能的 $x$，输出 FJ 的最小无聊值。
## 输入格式

输入的第一行包含 $T$（$1 \leq T \leq 10$），为需要求解的独立的测试用例数量。

每一个测试用例的第一行包含 $N$ 和 $M$。

第二行包含 $a_1, a_2, ..., a_N$ （$0 \leq a_i \leq 10^9$）。

输入保证所有测试用例的 $N$ 之和不超过 $5 \cdot 10^5$。
## 输出格式

对于每一个测试用例输出一行，包含对于所有可能的 $x$，FJ 的最小无聊值。
## 样例

### 样例输入 #1
```
2
5 9
15 12 18 3 8
3 69
1 988244353 998244853
```
### 样例输出 #1
```
10
21
```
## 提示

### 样例解释

在第一个测试用例中，$x$ 的一个最优选择是 $3$。FJ 可以执行 $10$ 次操作使得 $a = [12, 12, 21, 3, 12]$。

### 子任务

- 测试点 2：$N \le 1000$ 以及 $M \le 1000$。
- 测试点 3：$N\le 1000$。
- 测试点 4-5：$M\le 10^5$。
- 测试点 6-16：没有额外限制。


---

---
title: "[USACO25JAN] Table Recovery S"
layout: "post"
diff: 普及+/提高
pid: P11672
tag: ['USACO', '2025']
---
# [USACO25JAN] Table Recovery S
## 题目描述

Bessie 有一个 $N\times N$（$1\le N\le 1000$）的加法表，其中对于所有 $1\le r,c\le N$，第 $r$ 行第 $c$ 列的方格中的整数为 $r+c$。例如，对于 $N=3$，表格如下所示：

```
2 3 4
3 4 5
4 5 6
```

不幸的是，Elsie 得到了这张表格，并通过执行若干次以下三种类型的操作对表格进行了变换。

1. 交换两行；
2. 交换两列；
3. 选择两个同时存在于表格中的值 $a$ 和 $b$，然后同时将每一个 $a$ 更改为 $b$，每一个 $b$ 更改为 $a$。

Elsie 总是按类型顺序执行操作；也就是说，她首先执行任意数量（可能为零）的类型 $1$ 操作，然后是类型 $2$ 操作，最后是类型 $3$ 操作。

请帮助 Bessie 恢复 Elsie 在执行完所有类型 $1$ 和 $2$ 操作后，但在执行任意类型 $3$ 操作之前，表格的一种可能状态。可能存在多种可能的答案，在这种情况下你应当输出字典序最小的答案。

按字典序比较两个表格时，比较它们在自然顺序（行间从上到下，行内从左到右）下读取时第一个不同的项。
## 输入格式

输入的第一行包含 $N$。

以下 $N$ 行每行包含 $N$ 个整数，表示 Elsie 变换后的 Bessie 的加法表。
## 输出格式

输出所有类型 1 和 2 操作后，类型 3 操作前，表格的字典序最小可能状态。输入保证答案存在。
## 样例

### 样例输入 #1
```
1
2
```
### 样例输出 #1
```
2
```
### 样例输入 #2
```
3
3 4 2
5 2 3
6 3 5
```
### 样例输出 #2
```
4 2 3
5 3 4
6 4 5
```
### 样例输入 #3
```
6
8 10 5 6 7 4
12 11 10 4 8 2
5 4 6 7 9 8
10 2 4 8 5 12
6 8 7 9 3 5
4 12 8 5 6 10
```
### 样例输出 #3
```
7 5 8 9 10 6
4 2 5 6 7 3
8 6 9 10 11 7
5 3 6 7 8 4
9 7 10 11 12 8
6 4 7 8 9 5
```
## 提示

### 样例解释

#### 样例 #1

无论 Elsie 执行什么操作表格均不会改变。

#### 样例 #2

以下是 Elsie 可能执行的一种操作序列。

```text
2 3 4
3 4 5
4 5 6
-> （操作 2：交换列 2 和 3）
2 4 3
3 5 4
4 6 5
-> （操作 2：交换列 1 和 2）
4 2 3
5 3 4
6 4 5
-> （操作 3：交换值 2 和 3）
4 3 2
5 2 4
6 4 5
-> （操作 3：交换值 3 和 4）
3 4 2
5 2 3
6 3 5
```
注意：以下也是经过类型 1 和 2 操作后表格的一种可能状态，但它不是字典序最小的，因为第一行的第二项比正确答案中的要大。
```
4 6 5
3 5 4
2 4 3
```

### 子任务

- 测试点 4-5：$N\le 6$。
- 测试点 6-7：$N\le 8$。
- 测试点 8-11：$N\le 100$。
- 测试点 12-15：没有额外限制。


---

---
title: "[USACO25JAN] Reachable Pairs G"
layout: "post"
diff: 普及+/提高
pid: P11674
tag: ['USACO', '2025']
---
# [USACO25JAN] Reachable Pairs G
## 题目描述

考虑一个无向图，包含 $N$ 个结点，编号为 $1\dots N$，以及 $M$ 条边（$1\le N\le 2\cdot 10^5$，$0\le M\le 4\cdot 10^5$）。给定一个位串 $s_1s_2\dots s_N$。对于每一个 $t\in [1,N]$，在时刻 $t$ 时，

- 如果 $s_t=0$，则从图中移除结点 $t$。
- 如果 $s_t=1$，则从图中移除结点 $t$，并在结点 $t$ 被移除之前的每对邻居之间添加一条边。

注意在这两种情况下，当一个结点从图中被移除时它的所有相邻边也会被移除。

计算在每一个时刻 $1\ldots N$ 之前，可以通过一组边相互到达的结点对数。
## 输入格式

输入的第一行包含 $N$ 和 $M$。

第二行包含长为 $N$ 的位串 $s$。

以下 $M$ 行，每行包含两个整数，表示图中的一条边。
## 输出格式

输出 $N$ 行，为每一个时刻之前所求的对数。

## 样例

### 样例输入 #1
```
3 2
111
1 2
1 3
```
### 样例输出 #1
```
3
1
0
```
### 样例输入 #2
```
3 2
000
1 2
1 3
```
### 样例输出 #2
```
3
0
0
```
### 样例输入 #3
```
7 8
1101101
6 2
1 2
2 3
6 3
1 3
1 7
4 5
2 7
```
### 样例输出 #3
```
11
7
4
2
1
1
0
```
## 提示

样例 1 解释：

在移除之前，所有结点对之间都可以相互到达。结点 $1$ 被移除后，结点 $2$ 和 $3$ 之间添加了一条边，因此它们仍然可以相互到达。

样例 2 解释：

在移除之前，所有结点对之间都可以相互到达。结点 $1$ 被移除后，结点 $2$ 和 $3$ 之间不再可以相互到达。

- 测试点 $4\sim 6$：$N\le 100$。
- 测试点 $7\sim 8$：所有 $s_i$ 均等于 $0$。
- 测试点 $9\sim 11$：所有 $s_i$ 均等于 $1$。
- 测试点 $12\sim 23$：没有额外限制。


---

---
title: "[USACO25FEB] Printing Sequences B"
layout: "post"
diff: 普及+/提高
pid: P11838
tag: ['模拟', 'USACO', '递归', '2025', '区间 DP']
---
# [USACO25FEB] Printing Sequences B
## 题目描述

Bessie 正在学习使用一种简单的编程语言进行编程。她首先定义一个合法的程序，然后执行该程序以产生一些输出序列。

### 定义：

一个程序是一个非空的语句序列。

一个语句的形式或者是 "PRINT $c$"，其中 $c$ 是一个整数，或者是 "REP $o$"，随后是一个程序，随后是 "END"，其中 $o$ 是一个不小于 1 的整数。

### 执行：

执行一个程序将依次执行其语句。

执行语句 "PRINT $c$" 将使 $c$ 追加到输出序列中。

执行以 "REP $o$" 开始的语句将依次执行内部程序共 $o$ 次。

Bessie 知道如何编写的一个程序示例如下。

```plain
REP 3
    PRINT 1
    REP 2
        PRINT 2
    END
END
```

该程序输出序列 $[1,2,2,1,2,2,1,2,2]$。

Bessie 想要输出一个包含 $N$（$1 \le N \le 100$）个正整数的序列。Elsie 挑战她使用不超过 $K$（$1 \le K \le 3$）个 "PRINT" 语句。注意，Bessie 可以使用任意数量的 "REP" 语句。同时注意，序列中的每个正整数都不超过 $K$。

对于 $T$（$1 \le T \le 100$）个独立的测试用例中的每一个，求 Bessie 是否可以编写一个程序，使用至多 $K$ 个 "PRINT" 语句输出给定的序列。
## 输入格式

输入的第一行包含 $T$。

每一个测试用例的第一行包含空格分隔的两个整数 $N$ 和 $K$。

每一个测试用例的第二行包含一个由 $N$ 个空格分隔的正整数组成的序列，每个数都不超过 $K$，为 Bessie 想要产生的序列。
## 输出格式

对于每一个测试用例输出一行，包含 "YES" 或 "NO"（大小写敏感）。

## 样例

### 样例输入 #1
```
2
1 1
1
4 1
1 1 1 1
```
### 样例输出 #1
```
YES
YES
```
### 样例输入 #2
```
11
4 2
1 2 2 2
4 2
1 1 2 1
4 2
1 1 2 2
6 2
1 1 2 2 1 1
10 2
1 1 1 2 2 1 1 1 2 2
8 3
3 3 1 2 2 1 2 2
9 3
1 1 2 2 2 3 3 3 3
16 3
2 2 3 2 2 3 1 1 2 2 3 2 2 3 1 1
24 3
1 1 2 2 3 3 3 2 2 3 3 3 1 1 2 2 3 3 3 2 2 3 3 3
9 3
1 2 2 1 3 3 1 2 2
6 3
1 2 1 2 2 3
```
### 样例输出 #2
```
YES
NO
YES
NO
YES
YES
YES
YES
YES
NO
NO
```
## 提示

样例 1 解释：

对于第二个测试用例，以下代码使用了 $1$ 个 "PRINT" 语句输出了序列 $[1,1,1,1]$。

```plain
REP 4
    PRINT 1
END
```

样例 2 解释：

对于第一个测试用例，以下代码使用了 $2$ 个 "PRINT" 语句输出了序列 $[1,2,2,2]$。

```plain
PRINT 1
REP 3
    PRINT 2
END
```

对于第二个测试用例，答案是 "NO"，因为使用不超过 $2$ 个 "PRINT" 语句输出序列 $[1,1,2,1]$ 是不可能的。

对于第六个测试用例，以下代码使用了 $3$ 个 "PRINT" 语句输出了序列 $[3,3,1,2,2,1,2,2]$。

```plain
REP 2
    PRINT 3
END
REP 2
    PRINT 1
    REP 2
        PRINT 2
    END
END
```

- 测试点 $3$：$K=1$。
- 测试点 $4\sim 7$：$K \le 2$。
- 测试点 $8\sim 13$：没有额外限制。


---

---
title: "[USACO25FEB] The Best Lineup S"
layout: "post"
diff: 普及+/提高
pid: P11839
tag: ['模拟', '贪心', 'USACO', '2025']
---
# [USACO25FEB] The Best Lineup S
## 题目描述

Farmer John 有 $N$（$1 \leq N \leq 2 \cdot 10^5$）头奶牛排成一条队伍 $a$。队伍 $a$ 中从前到后第 $i$ 头奶牛编号为一个整数 $a_i$（$1 \leq a_i \leq N$）。可能存在多头奶牛编号为同一整数。

FJ 将以以下方式构造另一条队伍 $b$：

- 初始时，$b$ 为空。
- 当 $a$ 非空时，移除 $a$ 最前面的奶牛，并选择是否将该奶牛添加到 $b$ 的最后。

FJ 想要构造队伍 $b$，使得 $b$ 中从前到后的编号序列是字典序最大的（见脚注）。

在 FJ 构造队伍 $b$ 之前，他可以执行以下操作至多一次：

- 选择队伍 $a$ 中的一头奶牛，并将其移动至当前位置之前的任意位置。

假设 FJ 以最优方式执行至多一次上述操作，输出他可以达到的字典序最大的 $b$ 的编号序列。

每个测试点将包含 $T$（$1 \leq T \leq 100$）个独立的测试用例。
## 输入格式

输入的第一行包含 $T$。

每一个测试用例的第一行包含 $N$。

每一个测试用例的第二行包含 $N$ 个空格分隔的整数 $a_1, a_2, \ldots, a_N$。

输入保证所有测试用例的 $N$ 之和不超过 $10^6$。
## 输出格式

对于每一个测试用例输出一行，包含字典序最大的 $b$。

## 样例

### 样例输入 #1
```
3
5
4 3 2 1 3
6
5 1 2 6 3 4
6
4 1 3 2 1 1
```
### 样例输出 #1
```
4 3 3 2 1
6 5 4
4 3 2 1 1
```
## 提示

样例 1 解释：

在第一个测试用例中，FJ 可以将第五头奶牛移动到第二头奶牛之后。现在，$a = [4, 3, 3, 2, 1]$。可以证明，$[4, 3, 3, 2, 1]$ 也是字典序最大的 $b$。

在第二个测试用例中，FJ 可以将第四头奶牛移动到队伍的最前面。

在第三个测试用例中，FJ 不需要执行任何操作。他可以通过将除第二头奶牛之外的每头奶牛添加到 $b$ 的最后来构造 $b$。可以证明，这得到了字典序最大的 $b$。

- 测试点 $2\sim 4$：$N \leq 100$。
- 测试点 $5\sim 8$：$N \leq 750$。
- 测试点 $9\sim 18$：没有额外限制。

### 脚注

我们知道，序列 $s$ 的字典序大于序列 $t$ 当且仅当以下条件之一成立：
- 在 $s_i \neq t_i$ 的第一个位置 $i$ 处，有 $s_i > t_i$。
- 当不存在这样的 $i$ 时，$s$ 的长度大于 $t$。


---

---
title: "[USACO25FEB] Vocabulary Quiz S"
layout: "post"
diff: 普及+/提高
pid: P11840
tag: ['USACO', '2025', '树的遍历']
---
# [USACO25FEB] Vocabulary Quiz S
## 题目描述

Bessie 正在帮助 Elsie 准备她即将到来的词汇测验。要测验的单词将从 $M$ 个不同单词的词库中抽取，其中词库里没有一个单词是另一个单词的前缀。

当词库非空时，Bessie 将从词库中选择一个单词，将其从词库中移除，并从左到右逐个字符地读给 Elsie。Elsie 的任务是在她能够唯一确定该单词时告诉 Bessie，此后 Bessie 将停止朗读。

Bessie 已经决定按顺序 $w_1,w_2,\dots,w_M$ 朗读单词。如果 Elsie 尽可能快地回答，Bessie 将朗读每个单词的多少个字符？

这些单词以一种压缩格式给出。我们将首先定义 $N+1$（$1\le N\le 10^6$）个不同的单词，然后词库将由其中所有不作为另一个单词前缀的单词组成。这些单词定义如下：

- 初始时，第 $0$ 个单词为空字符串。
- 然后对于每一个 $1\le i\le N$，第 $i$ 个单词将等于第 $p_i$ 个单词在末尾加上一个额外的字符（$0\le p_i<i$）。字符的选择使得所有 $N+1$ 个单词各不相同。
## 输入格式

输入的第一行包含 $N$，其中 $N+1$ 是以压缩格式给出的单词的数量。

以下一行包含 $p_1,p_2,\dots,p_N$，其中 $p_i$ 表示第 $i$ 个单词是通过取第 $p_i$ 个单词并在末尾添加一个字符形成的。

令 $M$ 为不是某个其他单词前缀的单词数量。以下 $M$ 行将包含 $w_1,w_2,\dots,w_M$，表示第 $w_i$ 个单词将是第 $i$ 个被朗读的单词。输入保证朗读的单词形成词库中单词的一个排列。
## 输出格式

输出 $M$ 行，其中第 $i$ 行包含 Bessie 对第 $i$ 个单词朗读的字符数量。

## 样例

### 样例输入 #1
```
5
0 1 2 3 4
5
```
### 样例输出 #1
```
0
```
### 样例输入 #2
```
4
0 0 1 1
4
3
2
```
### 样例输出 #2
```
2
1
0
```
### 样例输入 #3
```
4
0 0 1 1
2
3
4
```
### 样例输出 #3
```
1
2
0
```
## 提示

样例 1 解释：

有 $6$ 个单词编号为 $0 \dots 5$。单词 $5$ 是唯一一个不是另一个单词的前缀的单词，因此它是词库中唯一的单词。一般地说，一旦库中仅剩下一个单词，Elsie 就不再需要任何字符以确定它。

样例 2 解释：

词库由单词 $2$，$3$ 和 $4$ 组成。

Elsie 需要两个字符来确定单词 $4$，因为单词 $3$ 和 $4$ 的第一个字符相同。

一旦 Bessie 朗读了单词 $3$ 的第一个字符，Elsie 就有了足够的字符来唯一确定它，因为单词 $4$ 已经被朗读。

- 测试点 $4\sim 5$：所有单词的长度均不超过 $20$。
- 测试点 $6\sim 10$：词库中所有单词的长度之和不超过 $10^7$。
- 测试点 $11\sim 18$：没有额外限制。


---

---
title: "[USACO25FEB] Transforming Pairs S"
layout: "post"
diff: 普及+/提高
pid: P11841
tag: ['USACO', '2025', '数论', '最大公约数 gcd']
---
# [USACO25FEB] Transforming Pairs S
## 题目描述

聪明奶牛 Bessie 发现了一种新的迷恋——数学魔法！一天，当她在 Farmer John 牧场的草地上小跑时，她偶然发现了两堆有魔法的干草。第一堆包含 $a$ 捆干草，第二堆包含 $b$ 捆干草（$1\le a,b\le 10^{18}$）。

在干草堆边上，半埋在泥土里，她发现了一卷古老的卷轴。当她展开卷轴时，发光的字母揭示了一个预言：

奉大草原之令，被选中者需令此平凡之干草堆转为恰好 $c$ 捆及 $d$ 捆——不可多，亦不可少。

Bessie 意识到她只能施展以下两种魔法：

- 她可以施法召唤新的干草捆以增加第一堆的大小，增加的数量等于当前第二堆的数量。
- 她可以施法召唤新的干草捆以增加第二堆的大小，增加的数量等于当前第一堆的数量。

她必须逐次执行这些操作，但可以任意顺序执行任意多次。她必须恰好使第一堆达到 $c$ 捆，第二堆达到 $d$ 捆（$1\le c,d\le 10^{18}$）。

对于 $T$（$1\le T\le 10^4$）个独立的测试用例中的每一个，输出实现预言所需的最小操作次数，或者如果不可能实现时输出 -1。
## 输入格式

输入的第一行包含 $T$。

以下 $T$ 行，每行包含四个整数 $a$，$b$，$c$，$d$。
## 输出格式

输出 $T$ 行，为每一个测试用例的答案。

## 样例

### 样例输入 #1
```
4
5 3 5 2
5 3 8 19
5 3 19 8
5 3 5 3
```
### 样例输出 #1
```
-1
3
-1
0
```
### 样例输入 #2
```
1
1 1 1 1000000000000000000
```
### 样例输出 #2
```
999999999999999999
```
## 提示

样例 1 解释：

在第一个测试用例中，由于 $b>d$，但操作只可能增加 $b$，因此不可能实现。

在第二个测试用例中，最初两堆有 $(5, 3)$ 捆。Bessie 可以将第一堆增加第二堆的数量，得到 $(8, 3)$ 捆。然后 Bessie 可以将第二堆增加第一堆的新数量，并执行该操作两次，得到 $(8, 11)$ 并最后得到 $(8, 19)$ 捆。这与 $c$ 和 $d$ 一致，且是达到目标的最小操作次数。

注意，第三个测试用例的答案与第二个不同，因为 $c$ 和 $d$ 的值交换了（堆的顺序有影响）。

在第四个测试用例中，不需要任何操作。

- 测试点 $3\sim 4$：$\max(c, d) \le 20 \cdot\min(a, b)$。
- 测试点 $5\sim 7$：$T \le 10$ 且 $a,b,c,d\le 10^6$。
- 测试点 $8\sim 12$：没有额外限制。


---

---
title: "[USACO25OPEN] It's Mooin' Time III B"
layout: "post"
diff: 普及+/提高
pid: P12024
tag: ['USACO', '2025']
---
# [USACO25OPEN] It's Mooin' Time III B
## 题目描述

Elsie 正在试图向 Bessie 描述她最喜欢的 USACO 竞赛，但 Bessie 很难理解为什么 Elsie 这么喜欢它。Elsie 说「现在是哞哞时间！谁想哞哞？请，我只想参加 USACO」。

Bessie 仍然不理解，于是她将 Elsie 的描述转文字得到了一个长为 $N$（$3 \leq N \leq 10^5$）的字符串，包含小写字母字符 $s_1s_2 \ldots s_N$。Elsie 认为一个包含三个字符的字符串 $t$ 是一个哞叫，如果 $t_2 = t_3$ 且 $t_2 \neq t_1$。

一个三元组 $(i, j, k)$ 是合法的，如果 $i < j < k$ 且字符串 $s_i s_j s_k$ 组成一个哞叫。对于该三元组，FJ 执行以下操作计算其值：

- FJ 将字符串 $s$ 在索引 $j$ 处弯曲 90 度
- 该三元组的值是 $\Delta ijk$ 的面积的两倍。

换句话说，该三元组的值等于 $(j-i)(k-j)$。

Bessie 向你进行 $Q$（$1 \leq Q \leq 3 \cdot 10^4$）个查询。在每个查询中，她给你两个整数 $l$ 和 $r$（$1 \leq l \leq r \leq N$，$r-l+1 \ge 3$），并询问满足 $l \leq i$ 和 $k \leq r$ 的所有合法三元组 $(i, j, k)$ 的最大值。如果不存在合法的三元组，输出 $-1$。

注意这个问题涉及到的整数可能需要使用 64 位整数类型（例如，C/C++ 中的 `long long`）。
## 输入格式

输入的第一行包含两个整数 $N$ 和 $Q$。
以下一行包含 $s_1 s_2, \ldots s_N$。

以下 $Q$ 行每行包含两个整数 $l$ 和 $r$，表示每个查询。
## 输出格式

对于每一个查询输出一行，包含对于该查询的答案。
## 样例

### 样例输入 #1
```
12 5
abcabbacabac
1 12
2 7
4 8
2 5
3 10
```
### 样例输出 #1
```
28
6
1
-1
12
```
## 提示

样例解释：对于第一个查询，$(i,j,k)$ 必须满足 $1 \le i < j < k \le 12$。可以证明，对于某个合法的 $(i,j,k)$，$\Delta ijk$ 的最大面积在 $i=1$，$j=8$ 以及 $k=12$ 时取到。注意 $s_1 s_8 s_{12}$ 是字符串 "acc"，根据前述定义是一个哞叫。$\Delta ijk$ 的直角边长为 $7$ 和 $4$，从而它的面积的两倍将等于 $28$。
对于第三个查询，$(i,j,k)$ 必须满足 $4 \le i < j < k \le 8$。可以证明，对于某个合法的 $(i,j,k)$，$\Delta ijk$ 的最大面积在 $i=4$，$j=5$ 以及 $k=6$ 时取到。

对于第四个查询，不存在满足 $2 \le i < j < k \le 5$ 的 $(i,j,k)$ 使得 $s_i s_j s_k$ 是一个哞叫，所以该查询的输出为 $-1$。

- 测试点 $2\sim3$：$N,Q\le 50$。
- 测试点 $4\sim6$：$Q=1$，唯一的询问满足 $l=1$ 且 $r=N$。
- 测试点 $7\sim 11$：没有额外限制。


---

---
title: "[USACO25OPEN] Sequence Construction S"
layout: "post"
diff: 普及+/提高
pid: P12025
tag: ['USACO', '2025', 'Special Judge', '构造']
---
# [USACO25OPEN] Sequence Construction S
## 题目描述

最近，农夫约翰农场里的奶牛们迷上了观看《炼乳神探》这档节目。节目讲述了一头聪明的奶牛侦探CowCow解决各类案件的故事。贝茜从节目中发现了新的谜题，但答案要等到下周的下一集才会揭晓！请帮她解决这个问题。

给定整数 $M$ 和 $K$ $(1 \leq M \leq 10^9, 1 \leq K \leq 31)$。请选择一个正整数 $N$ 并构造一个包含 $N$ 个非负整数的序列 $a$，满足以下条件：

- $1 \le N \le 100$。
- $a_1 + a_2 + \dots + a_N = M$。
- $\text{popcount}(a_1) \oplus \text{ popcount}(a_2) \oplus \dots \oplus \text{ popcount}(a_N) = K$。

如果不存在这样的序列，输出 $-1$。

$\dagger \text{ popcount}(x)$ 表示整数 $x$ 的二进制表示中 $1$ 的位数。例如，$11$ 的 popcount 是 $3$，$16$ 的 popcount 是 $1$。

$\dagger \oplus$ 表示按位异或运算符。

输入包含 $T$ ($1 \le T \le 5 \cdot 10^3$) 组独立测试用例。
## 输入格式

第一行包含 $T$。

每个测试用例的第一行也是唯一一行包含 $M$ 和 $K$。

保证所有测试用例都是唯一的。
## 输出格式

按以下方式输出 $T$ 个测试用例的解答：

如果无解，该测试用例对应的唯一一行输出应为 $-1$。

否则，该测试用例的第一行输出应为序列长度 $N$（$1 \le N \le 100$），第二行输出应包含 $N$ 个用空格分隔且满足条件的整数（$0 \le a_i \le M$）。
## 样例

### 样例输入 #1
```
3
2 1
33 5
10 5
```
### 样例输出 #1
```
2
2 0
3
3 23 7 
-1
```
## 提示

在第一个测试用例中，数组 $a = [2, 0]$ 的元素之和为 $2$。其 popcount 的异或和为 $1 \oplus 0 = 1$，因此所有条件均被满足。

在第二个测试用例中，数组 $a = [3, 23, 7]$ 的元素之和为 $33$。其 popcount 的异或和为 $2 \oplus 4 \oplus 3 = 5$，因此所有条件均被满足。

其他有效数组包括 $a = [4, 2, 15, 5, 7]$ 和 $a = [1, 4, 0, 27, 1]$。

可以证明第三个测试用例不存在有效数组。

- 测试点 $2$：$M \leq 8, K \leq 8$。
- 测试点 $3\sim 5$：$M > 2^K$。
- 测试点 $6\sim18$：无额外限制。


---

---
title: "[USACO25OPEN] Compatible Pairs S"
layout: "post"
diff: 普及+/提高
pid: P12026
tag: ['图论', '贪心', 'USACO', '2025', '图论建模', '拓扑排序']
---
# [USACO25OPEN] Compatible Pairs S
## 题目描述

在遥远的乡村，农夫约翰的奶牛并非普通的农场动物——它们隶属于一个秘密的奶牛情报网络。每头奶牛都有一个由精英密码学家精心分配的ID号码。但由于农夫约翰随意的标记系统，部分奶牛出现了重复ID的情况。

农夫约翰记录到共有 $N$（$1\le N\le 2\cdot 10^5$）个不同的ID号码，对于每个唯一ID $d_i$（$0\le d_i\le 10^9$），有 $n_i$（$1\le n_i\le 10^9$）头奶牛共享该ID。

奶牛们只能成对交流，它们的加密通信有一个严格规则：两头奶牛仅当不是同一头牛且它们的ID号码之和等于 $A$ 或 $B$（$0\le A\le B\le 2\cdot 10^9$）时才能交换信息。每头奶牛同一时间只能参与一次对话（即不能同时属于多对通信组合）。

农夫约翰希望最大化互不干扰的通信对数来确保最佳信息流通。你能计算出最多可以同时建立多少对通信吗？

## 输入格式

第一行包含 $N$、$A$、$B$。
接下来 $N$ 行每行包含 $n_i$ 和 $d_i$。所有 $d_i$ 均不相同。

## 输出格式

可同时建立的最大互不干扰通信对数。
注意：由于涉及大整数运算，可能需要使用 64 位整数类型（如C/C++中的 `long long`）。
## 样例

### 样例输入 #1
```
4 4 5
17 2
100 0
10 1
200 4
```
### 样例输出 #1
```
118
```
## 提示

解释：
ID为 $0$ 的奶牛可与 ID 为 $4$ 奶牛通信（ID 之和为 $4$）。由于共有 $100$ 头 ID $0$ 的奶牛和 $200$ 头 ID $4$ 的奶牛，最多可组成 $100$ 对通信组合。

ID 为 $4$ 的奶牛还可与 ID 为 $1$ 的奶牛通信（ID 之和为$5$）。此时剩余 $100$ 头 ID $4$ 的奶牛和 $10$ 头 ID $1$ 的奶牛可组成 $10$ 对通信组合。

最后，ID 为 $2$ 的奶牛可与其他同 ID 奶牛通信。$17$ 头 ID $2$ 的奶牛最多可组成 $8$ 对通信组合（$\lfloor17/2\rfloor=8$）。

总计 $100+10+8=118$ 对通信组合，可以证明这是最大可能值。

- 测试点 $3\sim4$：$A=B$。
- 测试点 $5\sim7$：$N\le 1000$。
- 测试点 $8\sim12$：无额外限制。


---

---
title: "[USACO25OPEN] Ski Slope S"
layout: "post"
diff: 普及+/提高
pid: P12027
tag: ['USACO', '2025']
---
# [USACO25OPEN] Ski Slope S
## 题目描述

贝茜要和朋友们一起去滑雪。雪山上有 $N$ 个路标（$1 \leq N \leq 10^5$），按海拔从低到高依次标记为 $1, 2, \ldots, N$（路标 $1$ 位于山脚）。

对于每个路标 $i > 1$，有一条从路标 $i$ 出发，终点为路标 $p_i$（$1 \leq p_i < i$）的滑雪道。这条滑道的难度为 $d_i$（$0 \leq d_i \leq 10^9$），乐趣值为 $e_i$（$0 \leq e_i \leq 10^9$）。

贝茜的 $M$ 个朋友（$1 \leq M \leq 10^5$）每人会进行如下操作：选择一个起始路标 $i$，然后沿着滑道向下滑行（依次经过 $p_i,p_{p_i}$，依此类推），直到抵达路标 $1$。

每位朋友获得的乐趣值等于他们经过的所有滑道的乐趣值之和。每个朋友有不同的技能水平 $s_j$（$0 \leq s_j \leq 10^9$）和勇气值 $c_j$（$0 \leq c_j \leq 10$），这限制他们选择的起始路标必须满足：滑行过程中最多有 $c_j$ 条滑道的难度超过 $s_j$。

请为每位朋友计算他们能获得的最大乐趣值。

## 输入格式

第一行包含 $N$。

接下来 $2$ 到 $N$ 行，每行包含三个整数 $p_i$，$d_i$ 和 $e_i$。

随后一行包含 $M$。

接下来 $M$ 行，每行包含两个整数 $s_j$ 和 $c_j$。

## 输出格式

输出 $M$ 行，每行对应一个朋友的答案。

注意：由于涉及大整数运算，可能需要使用 64 位整数类型（如 C/C++ 中的 `long long`）。

## 样例

### 样例输入 #1
```
4
1 20 200
2 30 300
2 10 100
8
19 0
19 1
19 2
20 0
20 1
20 2
29 0
30 0
```
### 样例输出 #1
```
0
300
500
300
500
500
300
500
```
## 提示

第一位朋友只能选择路标 $1$ 作为起点，因为其他路标都会导致至少经过一条难度超过 $19$ 的滑道。总乐趣值为 $0$。

第二位朋友可以选择路标 $4$，依次滑行至路标 $2$ 和 $1$。总乐趣值为 $100 + 200 = 300$，其中有一条滑道难度超过 $19$。

第三位朋友可以选择路标 $3$，依次滑行至路标 $2$ 和 $1$。总乐趣值为 $300 + 200 = 500$，其中有两条滑道难度超过 $19$。

- 测试点 $2\sim4$：$N, M \leq 1000$。
- 测试点 $5\sim7$：所有 $c_j = 0$。
- 测试点 $8\sim17$：无额外限制。


---

---
title: "[USACO25OPEN] Moo Decomposition G"
layout: "post"
diff: 普及+/提高
pid: P12028
tag: ['USACO', '2025']
---
# [USACO25OPEN] Moo Decomposition G
## 题目描述

给定一个由 $\texttt{M}$ 和 $\texttt{O}$ 组成的长字符串 $S$ 和一个整数 $K \geq 1$。计算将 $S$ 分解为若干子序列的方式数，其中每个子序列形如 $\texttt{MOOO...O}$（恰好包含 $K$ 个 $\texttt{O}$），结果对 $10^9+7$ 取模。

由于字符串非常长，我们不直接给出 $S$。而是给定一个整数 $L$（$1 \leq L \leq 10^{18}$）和一个长度为 $N$ 的字符串 $T$（$1 \leq N \leq 10^6$）。字符串 $S$ 是 $T$ 重复 $L$ 次拼接而成。

## 输入格式

第一行包含 $K$、$N$ 和 $L$。

第二行包含长度为 $N$ 的字符串 $T$，每个字符是 $\texttt{M}$ 或 $\texttt{O}$。

保证 $S$ 的分解方式数不为零。
## 输出格式

输出字符串 $S$ 的分解方式数，对 $10^9+7$ 取模。
## 样例

### 样例输入 #1
```
2 6 1
MOOMOO
```
### 样例输出 #1
```
1
```
### 样例输入 #2
```
2 6 1
MMOOOO
```
### 样例输出 #2
```
6
```
### 样例输入 #3
```
1 4 2
MMOO
```
### 样例输出 #3
```
4
```
### 样例输入 #4
```
1 4 100
MMOO
```
### 样例输出 #4
```
976371285
```
## 提示

样例一解释：唯一分解方式是将前三个字符组成一个 $\texttt{MOO}$，后三个字符组成另一个 $\texttt{MOO}$。

样例二解释：共有六种不同的分解方式（大写字母组成一个 $\texttt{MOO}$，小写字母组成另一个 $\texttt{MOO}$）：
1. $\texttt{MmOOoo}$
2. $\texttt{MmOoOo}$
3. $\texttt{MmOooO}$
4. $\texttt{MmoOOo}$
5. $\texttt{MmoOoO}$
6. $\texttt{MmooOO}$

样例四解释：注意：结果需对 $10^9+7$ 取模。

- 测试点 $5\sim7$：$K=1$，$L=1$。
- 测试点 $8\sim10$：$K=2$，$N \leq 1000$，$L=1$。
- 测试点 $11\sim13$：$K=1$。
- 测试点 $14\sim19$：$L=1$。
- 测试点 $20\sim25$：无额外限制。


---

---
title: "[USACO1.4] 铺放矩形块 Packing Rectangles"
layout: "post"
diff: 普及+/提高
pid: P1212
tag: ['搜索', 'USACO']
---
# [USACO1.4] 铺放矩形块 Packing Rectangles
## 题目描述

给定 $4$ 个矩形块，找出一个最小的封闭矩形将这 $4$ 个矩形块放入，但不得相互重叠。所谓最小矩形指该矩形面积最小。

![](https://cdn.luogu.com.cn/upload/image_hosting/gu39gbyb.png)

$4$ 个矩形块中任一个矩形的边都与封闭矩形的边相平行，上图显示出了铺放 $4$ 个矩形块的 $6$ 种方案。  

这 $6$ 种方案是唯一可能的基本铺放方案。因为其它方案能由基本方案通过旋转和镜像反射得到。

可能存在满足条件且有着同样面积的各种不同的封闭矩形，你应该输出所有这些封闭矩形的边长。


## 输入格式

共有 $4$ 行，每行两个正整数，表示每个矩形的边长。

## 输出格式

总行数为解的总数加一。  

第一行是一个整数，代表封闭矩形的最小面积。  
接下来的每一行都表示一个解，由 $p,q\space (p \leqslant q)$ 来表示。这些行必须根据 $p$ 的大小按升序排列，且所有行都应是不同的。

## 样例

### 样例输入 #1
```
1 2
2 3
3 4
4 5

```
### 样例输出 #1
```
40
4 10
5 8

```
## 提示

【数据范围】  
对于 $100\%$ 的数据，输入的所有数在 $[1,50]$ 内。

题目翻译来自NOCOW。

USACO Training Section 1.4



---

---
title: "[IOI 1994] 时钟 The Clocks"
layout: "post"
diff: 普及+/提高
pid: P1213
tag: ['搜索', '2001', 'USACO', 'IOI', '剪枝', '进制']
---
# [IOI 1994] 时钟 The Clocks
## 题目描述

考虑将如此安排在一个 $3 \times 3$ 行列中的九个时钟:

```plain
|-------|   |-------|   |-------|
|       |   |       |   |   |   |
|---o   |   |---o   |   |   o   |
|       |   |       |   |       |
|-------|   |-------|   |-------|
    A           B           C

|-------|   |-------|   |-------|
|       |   |       |   |       |
|   o   |   |   o   |   |   o   |
|   |   |   |   |   |   |   |   |
|-------|   |-------|   |-------|
    D           E           F

|-------|   |-------|   |-------|
|       |   |       |   |       |
|   o   |   |   o---|   |   o   |
|   |   |   |       |   |   |   |
|-------|   |-------|   |-------|
    G           H           I
```

目标要找一个最小的移动顺序将所有的指针指向 $12$ 点。下面原表格列出了 $9$ 种不同的旋转指针的方法，每一种方法都叫一次移动。  
选择 $1 \sim 9$ 号移动方法，将会使在表格中对应的时钟的指针顺时针旋转 
 $90$ 度。


|移动方法  | 受影响的时钟 |
| :----------: | :----------: |
| 1 | ABDE |
| 2 | ABC |
| 3 | BCEF |
| 4 | ADG |
| 5 | BDEFH |
| 6 | CFI |
| 7 | DEGH |
| 8 | GHI |
| 9 | EFHI |

例子：

```plain
9 9 12       9 12 12        9 12 12        12 12 12        12 12 12
6 6 6   5 -> 9  9  9   8 -> 9  9  9   4 -> 12  9  9   9 -> 12 12 12
6 3 6        6  6  6        9  9  9        12  9  9        12 12 12
```

**但这可能不是正确的方法，请看下文。**

## 输入格式

输入三行，每行三个正整数，表示一个时钟的初始时间，数字的含意和上面第一个例子一样。

## 输出格式

单独的一行包括一个用空格分开的将所有指针指向 $12$ 点的最短移动顺序的列表。

如果有多种方案，输出那种使其连接起来的数字最小的方案。（举例来说 $5\ 2\ 4\ 6 < 9\ 3\ 1\ 1$）。

## 样例

### 样例输入 #1
```
9 9 12
6 6 6
6 3 6 

```
### 样例输出 #1
```
4 5 8 9

```
## 提示

题目翻译来自NOCOW。

USACO Training Section 1.4



---

---
title: "[USACO1.4] 等差数列 Arithmetic Progressions"
layout: "post"
diff: 普及+/提高
pid: P1214
tag: ['数学', 'USACO']
---
# [USACO1.4] 等差数列 Arithmetic Progressions
## 题目描述

一个等差数列是一个能表示成 $a, a+b, a+2b, \dots ,a+nb\space (n \in \mathbb N)$ 的数列。

在这个问题中 $a$ 是一个非负的整数，$b$ 是正整数。  
写一个程序来找出在双平方数集合：  
$$\{ x | x = p^2 + q^2 \wedge p,q \in \mathbb N \cap [0,m]\}$$
中长度为 $n$ 的等差数列。


## 输入格式

第一行一个正整数 $n$，表示要找的数列长度。  
第二行一个非负整数 $m$，表示 $p,q$ 的上界。
## 输出格式

如果没有找到数列，输出 `NONE`。

如果找到了，输出一行或多行，每行由二个整数组成：$a,b$。

这些行应该以 $b$ 为第一关键字，$a$ 为第二关键字升序排序。

所求的等差数列将不会多于10,000个。

## 样例

### 样例输入 #1
```
5
7

```
### 样例输出 #1
```
1 4
37 4
2 8
29 8
1 12
5 12
13 12
17 12
5 20
2 24

```
## 提示

【数据范围】  
对于 $100\%$ 的数据，$3 \le n \le 25$，$0 \le m \le 250$。

题目翻译来自NOCOW。

USACO Training Section 1.4



---

---
title: "[USACO08JAN] Running S"
layout: "post"
diff: 普及+/提高
pid: P1353
tag: ['动态规划 DP', '2008', 'USACO', '福建省历届夏令营']
---
# [USACO08JAN] Running S
## 题目描述

奶牛们打算通过锻炼来培养自己的运动细胞，作为其中的一员，贝茜选择的运动方式是每天进行 $n$ 分钟的晨跑。在每分钟的开始，贝茜会选择下一分钟是用来跑步还是休息。


贝茜的体力限制了她跑步的距离。更具体地，如果贝茜选择在第 $i$ 分钟内跑步，她可以在这一分钟内跑 $d_i$ 米，并且她的疲劳度会增加 $1$。不过，无论何时贝茜的疲劳度都不能超过 $m$。  

如果贝茜选择休息，那么她的疲劳度就会每分钟减少 $1$，但她必须休息到疲劳度恢复到 $0$ 为止。在疲劳度为 $0$ 时休息的话，疲劳度不会再变动。晨跑开始时，贝茜的疲劳度为 $0$ 。

还有，在 $n$ 分钟的锻炼结束时，贝茜的疲劳度也必须恢复到 $0$，否则她将没有足够的精力来对付这一整天中剩下的事情。

请你计算一下，贝茜最多能跑多少米。

## 输入格式

第一行两个正整数 $n,m$。   
接下来 $n$ 行，每行一个正整数 $d_i$。

## 输出格式

输出一个整数，表示在满足所有限制条件的情况下，贝茜能跑的最大距离。

## 样例

### 样例输入 #1
```
5 2
5
3
4
2
10

```
### 样例输出 #1
```
9

```
## 提示

【数据范围】  
对于 $100\%$ 的数据，$1\le n \le 10^4$，$1\le d_i \le 1000$，$1\le m \le 500$。

【样例说明】

贝茜在第 $1$ 分钟内选择跑步（跑了 $5$ 米），在第 $2$ 分钟内休息，在第 $3$ 分钟内跑步（跑了 $4$ 米），剩余的时间都用来休息。  
因为在晨跑结束时贝茜的疲劳度必须为0，所以她不能在第 $5$ 分钟内选择跑步。  
最终跑的总距离为 $9$。




---

---
title: "[USACO2.2] 派对灯 Party Lamps"
layout: "post"
diff: 普及+/提高
pid: P1468
tag: ['模拟', '搜索', 'USACO', '位运算']
---
# [USACO2.2] 派对灯 Party Lamps
## 题目描述

在 IOI98 的节日宴会上，我们有 $n$ 盏彩色灯，他们分别从 $1 \sim n$ 被标上号码。这些灯都连接到四个按钮：

按钮 $1$：当按下此按钮，将改变所有的灯：本来亮着的灯就熄灭，本来是关着的灯被点亮。

按钮 $2$：当按下此按钮，将改变所有奇数号的灯。

按钮 $3$：当按下此按钮，将改变所有偶数号的灯。

按钮 $4$：当按下此按钮，将改变所有序号是 $3k+1 \ (k \in [0,+\infty) \cap \mathbb Z)$ 的灯。例如：$1,4,7,10 \dots$

一个计数器 $c$ 记录按钮被按下的次数。当宴会开始，所有的灯都亮着，此时计数器 $c$ 为 $0$。

你将得到计数器 $c$ 上的数值和经过若干操作后某些灯的状态。写一个程序去找出所有灯最后可能的与所给出信息相符的状态，并且没有重复。

## 输入格式

第一行一个正整数 $n$；第二行一个整数 $c$，表示最后计数器的数值。  
第三行若干个整数，表示最后亮着的灯，以 `-1` 结束。  
第四行若干个整数，表示最后关着的灯，以 `-1` 结束。

保证不会有灯会在输入中出现两次。
## 输出格式

每一行是所有灯可能的最后状态（没有重复）。  
每一行有 $n$ 个字符，第 $i$ 个字符表示 $i$ 号灯。$0$ 表示关闭，$1$ 表示亮着。这些行必须从小到大排列（看作是二进制数）。

如果没有可能的状态，则输出一行 `IMPOSSIBLE`。

## 样例

### 样例输入 #1
```
10
1
-1
7 -1

```
### 样例输出 #1
```
0000000000
0101010101
0110110110

```
## 提示

【数据范围】  
对于 $100\%$ 的数据，$10 \le n \le 100$，$0 \le c \le 10^4$。

【样例解释】  
在这个样例中，有三种可能的状态：

- 所有灯都关着

- $1,4,7,10$ 号灯关着，$2,3,5,6,8,9$ 亮着。

- $1,3,5,7,9$ 号灯关着，$2,4,6,8,10$ 亮着。


翻译来自NOCOW

USACO 2.2



---

---
title: "[USACO2.3] 最长前缀 Longest Prefix"
layout: "post"
diff: 普及+/提高
pid: P1470
tag: ['字符串', '动态规划 DP', 'USACO', 'KMP 算法']
---
# [USACO2.3] 最长前缀 Longest Prefix
## 题目描述

在生物学中，一些生物的结构是用包含其要素的大写字母序列来表示的。生物学家对于把长的序列分解成较短的序列（即元素）很感兴趣。

如果一个集合 $P$ 中的元素可以串起来（元素可以重复使用）组成一个序列 $s$ ，那么我们认为序列 $s$ 可以分解为 $P$ 中的元素。元素不一定要全部出现（如下例中 `BBC` 就没有出现）。举个例子，序列 `ABABACABAAB` 可以分解为下面集合中的元素：`{A,AB,BA,CA,BBC}`

序列 $s$ 的前面 $k$ 个字符称作 $s$ 中长度为 $k$ 的前缀。设计一个程序，输入一个元素集合以及一个大写字母序列  ，设 $s'$ 是序列 $s$ 的最长前缀，使其可以分解为给出的集合 $P$ 中的元素，求 $s'$ 的长度 $k$。

## 输入格式

输入数据的开头包括若干个元素组成的集合 $P$，用连续的以空格分开的字符串表示。字母全部是大写，数据可能不止一行。元素集合结束的标志是一个只包含一个 `.` 的行，集合中的元素没有重复。  

接着是大写字母序列 $s$ ，长度为，用一行或者多行的字符串来表示，每行不超过 $76$ 个字符。换行符并不是序列 $s$ 的一部分。

## 输出格式

只有一行，输出一个整数，表示 S 符合条件的前缀的最大长度。

## 样例

### 样例输入 #1
```
A AB BA CA BBC
.
ABABACABAABC

```
### 样例输出 #1
```
11

```
## 提示

**【数据范围】**

对于 $100\%$ 的数据，$1\le \text{card}(P) \le 200$，$1\le |S| \le 2\times 10^5$，$P$ 中的元素长度均不超过 $10$。

翻译来自NOCOW

USACO 2.3



---

---
title: "[USACO2.4] 牛的旅行 Cow Tours"
layout: "post"
diff: 普及+/提高
pid: P1522
tag: ['图论', 'USACO', '枚举', '最短路']
---
# [USACO2.4] 牛的旅行 Cow Tours
## 题目描述

Farmer John 的农场里有很多 **牧区**。有的路径连接一些特定的牧区。**一片所有连通的牧区** 称为一个 **牧场**。但是就目前而言，你能看到至少有两个牧区通过任何路径都不连通。这样，Farmer John 就有 **多个** 牧场了。

John 想在牧场里添加 **恰好** 一条路径。对这条路径有以下限制：

一个牧场的 **直径** 就是牧场中 **最远** 的两个牧区的距离（本题中所提到的所有距离指的都是 **最短的距离**）。考虑如下的有 5 个牧区的牧场，牧区用 `*` 表示，路径用直线表示。每一个牧区都有自己的坐标：

```plain
                (15,15) (20,15)
                 D       E
                 *-------*
                 |     _/|
                 |   _/  |
                 | _/    |
                 |/      |
        *--------*-------*
        A        B       C
     (10,10)  (15,10) (20,10)
```
这个牧场的直径大约是 $12.07106$，最远的两个牧区是 A 和 E，它们之间的最短路径是 $A \to B \to E$。

这里是 John 的另一个牧场：

```plain
                         *F(30,15)
                        / 
                      _/  
                    _/    
                   /      
                  *------* 
                  G      H
                  (25,10)   (30,10)
```

在这个例子中，他刚好有这两个牧场。John 将会在这两个牧场中各选一个牧区（即从 $\{A,B,C,D,E\}$ 中选择一个牧区，从 $\{F,G,H\}$ 中选择一个牧区），然后用一条路径将它们连起来，使得连通后这个新的更大的牧场的直径尽可能小。

注意，如果两条路径中途相交，我们不认为它们是连通的。只有两条路径在同一个牧区相交，我们才认为它们是连通的。

输入文件包括牧区、它们各自的坐标，还有一个如下的对称邻接矩阵：

```plain
　 A  B  C  D  E  F  G  H 
A  0  1  0  0  0  0  0  0
B  1  0  1  1  1  0  0  0
C  0  1  0  0  1  0  0  0
D  0  1  0  0  1  0  0  0
E  0  1  1  1  0  0  0  0
F  0  0  0  0  0  0  1  0
G  0  0  0  0  0  1  0  1
H  0  0  0  0  0  0  1  0
```

其他邻接表中可能直接使用行列而不使用字母来表示每一个牧区。输入数据中不包括牧区的名字。

输入文件 **至少** 包括两个不连通的牧区。

请编程找出一条连接属于两个 **不同牧场** 的牧区的路径，使得连上这条路径后，这个更大的新牧场的直径尽可能小。输出在所有合法的连接方案中，新牧场直径的最小值。
## 输入格式

第一行一个整数 $N$（$1 \leq N \leq 150$），表示牧区数。

接下来 $N$ 行，每行两个整数 $X,Y$（$0 \leq X ,Y \leq 10^5$），表示 $N$ 个牧区的坐标。注意每个牧区的坐标都是不一样的。

接下来 $N$ 行，每行 $N$ 个数字，代表邻接矩阵 $M$。第 $i$ 行第 $j$ 列的数字为 $1$，表示 $i$ 号牧区和 $j$ 号牧区之间存在一条道路直接相连；第 $i$ 行第 $j$ 列的数字为 $0$，表示 $i$ 号牧区和 $j$ 号牧区之间不存在直接相连的道路。

保证 $M_{i,j} = M_{j,i}$。
## 输出格式

只有一行，包括一个实数，表示所求直径。数字保留六位小数。

只需要打到小数点后六位即可，不要做任何特别的四舍五入处理。

## 样例

### 样例输入 #1
```
8
10 10
15 10
20 10
15 15
20 15
30 15
25 10
30 10
01000000
10111000
01001000
01001000
01110000
00000010
00000101
00000010
```
### 样例输出 #1
```
22.071068

```
## 提示

样例对应题目描述中的情况。

最优解是连接 C 牧区和 G 牧区，连接后图上只有一个牧场。这个牧场的直径为 $A \to B \to C \to G \to F$，长度约为 $22.071068$。可以证明不存在更优的方案。

USACO 2.4



---

---
title: "幸福的路"
layout: "post"
diff: 普及+/提高
pid: P1556
tag: ['搜索', 'USACO']
---
# 幸福的路
## 题目描述

每天，John 都要为了农场里 $n$（$1 \leq n\leq 10$） 头牛的健康和幸福四处奔波。

每头牛的位置可以描述为一个二维坐标，John 从坐标原点 $(0,0)$ 出发。为了使路径更有趣，John 决定只沿着平行于坐标轴的方向行走，这样只能沿着东西南北方向运动。而且只有到达某头牛的坐标后 John 才会改变行走的方向（当然，如果有必要，John 也会穿过某头牛的坐标而不改变行走的方向。）

如果 John 改变行走的方向，他会原地转 $90^\circ$ 或者 $180^\circ$。John 的路径必须保证检查完所有牛后返回原点。

John 可以穿过某头牛的坐标而不改变方向任意次，请计算出有多少条路径满足 John 能检查完 $n$ 头牛，在每头牛的坐标处恰好改变一次方向。同一条路径从不同方向经过要计算两次。
## 输入格式

第一行，整数 $n$。

第二行到第 $n+1$ 行，第 $i+1$ 行是两个用空格隔开的整数 $x$ 和 $y$，表示第 $i$ 头牛的坐标（$-1000 \leq x,y \leq 1000$）。
## 输出格式

一行一个整数，表示路径的量。如果没有满足要求则输出 $0$。
## 样例

### 样例输入 #1
```
4
0 1
2 1
2 0
2 -5
```
### 样例输出 #1
```
2
```


---

---
title: "Kruscal的加法"
layout: "post"
diff: 普及+/提高
pid: P1557
tag: ['模拟', '字符串', 'USACO']
---
# Kruscal的加法
## 题目背景

奶牛 Kruscal 认为人类的加法太落后了。比如说有时候想要用加法计算 `+15*3`，只能写成 `+15+15+15`，真是浪费精力啊！于是，Kruscal 决定开发出一种新的加法算式。
## 题目描述

当然，新的算式也是建立在原本算式的基础上的，不同就在于上式可以直接写成 `+++15`，同理，对于 `-15*3` 这样的算式可以写成 `---15`。一段时间后，Kruscal 又被那无穷多个 `+-` 号囧到了，于是他又将这个算式改进了一下。

比如 `+15*3` 又可以写成 `+(3)15`，同样，`-15*3` 等价于 `-(3)15`。但从上面可以看出，对于乘数较小的情况，如 `+++15` 这样的表述还是很方便的，于是在新的算式中还是保留了这种形式。

对于算式还要做一点特殊的说明：`+15*3` 转换成 Kruscal 型算式时可以写成 `+++15` 或 `+(3)15`，但不可以写成 `++(2)15` 这样的形式。

对于算式 `23+15*3-2` 可以表示为以下几种形式：`23+++15-2`、`23+(3)15-2`、`+23+++15-2`、`+23+(3)15-2、+(1)23+(3)15-(1)2`。不会出现如下几种形式：`(1)23+++15-2`、`+23++(2)15-(1)2`、`23+++15-2+(0)100`、`23-(-3)15-2`。
## 输入格式

一行，一个 Kruscal 型算式。
## 输出格式

一行，为运算结果。
## 样例

### 样例输入 #1
```
+(1)23+(3)15-(1)2
```
### 样例输出 #1
```
66
```
## 提示

对于 $100 \%$ 的数据，算式长度不超过 $2000$。


---

---
title: "[USACO04DEC] Cleaning Shifts S"
layout: "post"
diff: 普及+/提高
pid: P1668
tag: ['动态规划 DP', '图论', '贪心', '2004', '线段树', 'USACO', '最短路']
---
# [USACO04DEC] Cleaning Shifts S
## 题目描述

一天有 $T(1\le T\le 10^6)$ 个时段。约翰正打算安排他的 $N(1\le N\le 2.5\times 10^4)$ 只奶牛来值班，打扫打扫牛棚卫生。每只奶牛都有自己的空闲时间段 $ [S_i,E_i](1\le S_i\le E_i\le T)$，只能把空闲的奶牛安排出来值班。而且，每个时间段必需有奶牛在值班。

那么，最少需要动用多少奶牛参与值班呢？如果没有办法安排出合理的方案，就输出 $-1$。
## 输入格式

第 $1$ 行：$N$，$T$。

第 $2$ 到 $N+1$ 行：$S_i$，$E_i$。
## 输出格式

一行，输出最少安排的奶牛数。
## 样例

### 样例输入 #1
```
3 10
1 7
3 6
6 10
```
### 样例输出 #1
```
2
```
## 提示

$1\le T\le 10^6$，$N\le 2.5\times 10^4$，$1\le S_i\le E_i\le T$。

$\text{Update On 2023/08/08}$：添加了一组hack数据，详情见[这里](https://www.luogu.com.cn/discuss/613052)。叉掉了时间复杂度为 $\mathcal O(nt)$ 的错解。


---

---
title: "[USACO04DEC] Tree Cutting S"
layout: "post"
diff: 普及+/提高
pid: P1670
tag: ['2004', 'USACO']
---
# [USACO04DEC] Tree Cutting S
## 题目描述

约翰意识到贝茜建设网络花费了他巨额的经费，就把她解雇了。贝茜很愤怒，打算狠狠报复。她打算破坏刚建成的约翰的网络。约翰的网络是树形的，连接着 $N$ 个牛棚。她打算切断某一个牛棚的电源，使和这个牛棚相连的所有电缆全部中断。之后，就会存在若干子网络。为保证破坏够大，每一个子网的牛棚数不得超过总牛棚数的一半，那哪些牛棚值得破坏呢？
## 输入格式

第 $1$ 行：一个整数 $N$。

第 $2$ 到 $N$ 行：每行输入两个整数，表示一条电缆的两个端点。
## 输出格式

按从小到大的顺序，输出所有值得破坏的牛棚。如果没有一个值得破坏，就输出 `NONE`。
## 样例

### 样例输入 #1
```
10
1 2
2 3
3 4
4 5
6 7
7 8
8 9
9 10
3 8
```
### 样例输出 #1
```
3
8

```
## 提示

$1\le N\le 10^4$。


---

---
title: "[USACO12MAR] Tractor S"
layout: "post"
diff: 普及+/提高
pid: P1849
tag: ['字符串', '图论', '贪心', '2012', 'USACO', '枚举']
---
# [USACO12MAR] Tractor S
## 题目描述

经过一天漫长的工作，农场主 John 完全忘记了他的拖拉机还在场地中央。他的奶牛们总喜欢和他搞些恶作剧，它们在场地的不同位置丢下 $n$ 堆干草。这样 John 就必须先移走一些干草堆才能将拖拉机开走。

拖拉机和干草堆都可以看作是二维平面上的点，它们的坐标都是整数，没有哪堆干草的坐标和拖拉机的初始坐标一致。John 驾驶拖拉机只能沿着坐标轴的方向移动若干单位长度，比如说，他可以先朝北移动 $2$ 个单位长度，再向东移动 $3$ 个单位长度等等。拖拉机不能移动到干草堆所占据的点。

请你帮助 John 计算一下，最少要移动多少堆干草才能将拖拉机开回坐标原点。
## 输入格式

输入的第一行是三个用空格隔开的整数，依次代表干草的堆数 $n$ 和拖拉机的起始坐标 $(x_0, y_0)$。

第 $2$ 行到第 $(n+1)$ 行，每行有两个用空格隔开的整数，第 $(i + 1)$ 行的整数 $x_i, y_i$ 代表第 $i$ 堆干草的坐标为 $(x_i, y_i)$。
## 输出格式

一行一个整数，表示最少要移动多少堆干草 John 才能将拖拉机开回坐标原点。
## 样例

### 样例输入 #1
```
7 6 3 
6 2 
5 2 
4 3 
2 1 
7 3 
5 4 
6 4 
```
### 样例输出 #1
```
1 
```
## 提示

对于 $100\%$ 的数据，保证 $1 \leq n \leq 5 \times 10^4$，$1 \leq x_i, y_i \leq 10^3$。


---

---
title: "[IOI 1998 ] [USACO5.5] 矩形周长Picture"
layout: "post"
diff: 普及+/提高
pid: P1856
tag: ['1998', '线段树', 'USACO', 'IOI', '扫描线']
---
# [IOI 1998 ] [USACO5.5] 矩形周长Picture
## 题目背景

墙上贴着许多形状相同的海报、照片。它们的边都是水平和垂直的。每个矩形图片可能部分或全部的覆盖了其他图片。所有矩形合并后的边长称为周长。

## 题目描述

编写一个程序计算周长。

![](https://cdn.luogu.com.cn/upload/image_hosting/2eo4hzl6.png)

如图 $1$ 所示 $7$ 个矩形。

![](https://cdn.luogu.com.cn/upload/image_hosting/buk96amj.png)

如图 $2$ 所示，所有矩形的边界。所有矩形顶点的坐标都是整数。

## 输入格式

输入文件的第一行是一个整数 $N$，表示有多少个矩形。接下来 $N$ 行给出了每一个矩形左下角坐标和右上角坐标。
## 输出格式

输出文件只有一个正整数，表示所有矩形的周长。

## 样例

### 样例输入 #1
```
7
-15 0 5 10
-5 8 20 25
15 -4 24 14
0 -6 16 4
2 15 10 22
30 10 36 20
34 0 40 16
```
### 样例输出 #1
```
228
```
## 提示

### 数据范围及约定

对于全部数据，$1 \le N<5000$，所有坐标的数值范围都在 $-10^4$ 到 $10^4$ 之间。


---

---
title: "[USACO12FEB] Overplanting S"
layout: "post"
diff: 普及+/提高
pid: P1884
tag: ['2012', 'USACO', '离散化']
---
# [USACO12FEB] Overplanting S
## 题目描述

Farmer John has purchased a new machine that is capable of planting grass within any rectangular region of his farm that is "axially aligned" (i.e., with vertical and horizontal sides).  Unfortunately, the machine malfunctions one day and plants grass in not one, but N (1 <= N <= 1000) different rectangular regions, some of which may even overlap.

Given the rectangular regions planted with grass, please help FJ compute the total area in his farm that is now covered with grass.

在一个笛卡尔平面坐标系里（则 $X$ 轴向右是正方向，$Y$ 轴向上是正方向），有 $N\ (1 \le N \le 1000)$ 个矩形，第 $i$ 个矩形的左上角坐标是 $(x_1,y_1)$，右下角坐标是 $(x_2,y_2)$。问这 $N$ 个矩形所覆盖的面积是多少？

注意：被重复覆盖的区域的面积只算一次。
## 输入格式

第一行，一个整数 $N\ (1 \le N \le 1000)$。

接下来有 $N$ 行，每行描述一个矩形的信息，分别是矩形的 $x_1,y_1,x_2,y_2(-10^8 \le x_1,y_1,x_2,y_2 \le 10^8)$。

## 输出格式

一个整数，被 $N$ 个矩形覆盖的区域的面积。

## 样例

### 样例输入 #1
```
2
0 5 4 1
2 4 6 2

```
### 样例输出 #1
```
20
```


---

---
title: "[USACO4.2] 完美的牛栏The Perfect Stall"
layout: "post"
diff: 普及+/提高
pid: P1894
tag: ['USACO', '二分图']
---
# [USACO4.2] 完美的牛栏The Perfect Stall
## 题目描述

农夫约翰上个星期刚刚建好了他的新牛棚，他使用了最新的挤奶技术。

不幸的是，由于工程问题，每个牛栏都不一样。

第一个星期，农夫约翰随便地让奶牛们进入牛栏，但是问题很快地显露出来：每头奶牛都只愿意在她们喜欢的那些牛栏中产奶。

上个星期，农夫约翰刚刚收集到了奶牛们的爱好的信息（每头奶牛喜欢在哪些牛栏产奶）。

一个牛栏只能容纳一头奶牛，当然，一头奶牛只能在一个牛栏中产奶。

给出奶牛们的爱好的信息，计算最大分配方案。
## 输入格式

第一行为两个整数，$n$ 和 $m$。$n$ 是农夫约翰的奶牛数量，$m$ 是新牛棚的牛栏数量。

第二行到第 $n+1$ 行 一共 $n$ 行，每行对应若干个整数一只奶牛。第一个数字 $s_i$ 是这头奶牛愿意在其中产奶的牛栏的数目。后面的 $s_i$ 个数表示这些牛栏的编号。牛栏的编号限定在区间 $[1,m]$ 中，在同一行，一个牛栏不会被列出两次。

## 输出格式

只有一行，为一个整数，表示最多能分配到的牛栏的数量。
## 样例

### 样例输入 #1
```
5 5
2 2 5
3 2 3 4
2 1 5
3 1 2 5
1 2
```
### 样例输出 #1
```
4
```
## 提示

$0\le n,m\le 200$，$0\le s_i\le m$。


---

---
title: "[USACO09DEC] Dizzy Cows G"
layout: "post"
diff: 普及+/提高
pid: P2017
tag: ['搜索', '图论', '2009', 'USACO', 'Special Judge', '栈']
---
# [USACO09DEC] Dizzy Cows G
## 题目描述

The cows have taken to racing each other around the farm but they get very dizzy when running in circles, and everyone knows that dizzy cows don't produce any milk. Farmer John wants to convert all of the two-way cow paths in the farm to one-way paths in order to eliminate any 'cycles' and prevent the cows from getting dizzy.  A 'cycle' enables a cow to traverse one or more cow paths and arrive back at her starting point, thus completing a loop or circle.

The farm comprises N pastures (1 <= N <= 100,000) conveniently numbered 1..N. M1 (1 <= M1 <= 100,000) one-way cow paths and M2 two-way cow paths (1 <= M2 <= 100,000) connect the pastures. No path directly connects a pasture to itself, although multiple paths might connect two different pastures. A cow may or may not be able to travel between any two given pastures by following a sequence of cow paths.

Your job is to assign a direction to the two-way cow paths such that the entire farm (ultimately with only one-way paths) has no cycles. That is, there should be no sequence of one-way cow paths which leads back to its starting position. The existing one-way cow paths do not form a cycle and should be left as they are.

One-way cow paths run from pasture A\_i (1 <= A\_i <= N) to pasture B\_i (1 <= B\_i <= N). Two-way cow paths connect pastures X\_i (1 <= X\_i <= N) and Y\_i (1 <= Y\_i <= N).

Consider this example:

```cpp
1-->2 
|  /| 
| / | 
|/  | 
3<--4 
```
The cow paths between pastures 1 and 3, 2 and 3, and 2 and 4 are two-way paths. One-way paths connect 1 to 2 and also 4 to 3. One valid way to convert the two-way paths into one-way paths in such a way that there are no cycles would be to direct them from 1 to 3, from 2 to 3, and from 3 to 4:

```cpp
1-->2 
|  /| 
| / | 
vL  v 
3<--4 
```

## 输入格式

第一行三个整数 $n,m_1,m_2$，分别表示点数，有向边的数量，无向边的数量。

第二行起输入 $m_1$ 行，每行 $2$ 个整数 $a,b$，表示 $a$ 到 $b$ 有一条有向边。

接下来输入 $m_2$ 行，每行 $2$ 个整数 $a,b$，表示 $a$ 和 $b$ 中间有一条无向边。

## 输出格式

对于每条无向边，我们要求按输入顺序输出你定向的结果，也就是如果你输出 $a\ b$，那表示你将 $a$ 和 $b$ 中间的无向边定向为 $a \to b$。

注意，也许存在很多可行的解。你只要输出其中任意一个就好。

## 样例

### 样例输入 #1
```
4 2 3
1 2
4 3
1 3
4 2
3 2

```
### 样例输出 #1
```
1 3
4 2
2 3
```
## 题目翻译

奶牛们发现，在农场里面赛跑是很有趣的一件事.可是她们一旦在农场里面不断地转圈，就 会变得头晕目眩.众所周知，眩晕的奶牛是无法产奶的.于是，农夫约翰想要把他农场里面的双 向道路全部改为单向道路，使得他的农场里面一个圈都没有，以避免他的奶牛们被搞得晕头转 向.如果奶牛可以经过若干条道路回到起点，那么这些道路就称为一个圈.

农场有 $n\ (1 < n < 100000)$ 片草地，编号为 $1$ 到 $n$。这些草地由 $m_1$ 条单向 道路和 $m_2$ 条双向道路连接起来.任何一条道路都不会把一片草地和这片草地本身连接起来.但是，任意两片草地之间都可能有多条道路连接.不保证任意两片草地之间都有路 径相连。

你的任务是给所有的双向道路设定一个方向，使得整个农场(只剩下单向道路)最后一个圈都没有。也就是说，不存在一个单向道路序列的终点和起点重合。数据保证一开始就有的单向道路中，一个圈都没有。而且一开始就有的单向道路不能改变。

单向道路的起点是草地 $A_i$，终点是草地 $B_i$。双向道路连接草地 $X_i,Y_i$。



---

---
title: "刷墙"
layout: "post"
diff: 普及+/提高
pid: P2070
tag: ['USACO']
---
# 刷墙
## 题目描述

Farmer John已经设计了一种方法来装饰谷仓旁边的长栅栏（把栅栏认为是一根一维的线）。他把一只画刷绑在他最喜爱的奶牛Bessie身上，之后就去喝一杯冰水，而Bessie隔着栅栏来回走，当她走过某个地方，这里的一段栅栏就被刷上了涂料。

Bessie从栅栏上的位置0开始，并且遵循着一个N次移动的次序(1 <= N <= 100,000)。例如“10 L”表示Bessie向左移动了10个单位长度，“15 R”表示Bessie向右移动了15个单位长度。现给出Bessie所有移动的列表，Farmer John想要知道哪些区域的栅栏至少涂了两层涂料（只涂一层涂料的区域可能在大雨中被洗掉）。Bessie在她的行走中最远到达距起始点1,000,000,000个单位长度。

## 输入格式

第1行：一个整型数N。

第2..N+1行：每行描述了Bessie的N次移动中的一次，例如“15 L”。

## 输出格式

1行：被至少涂了两层涂料的区域总数。

## 样例

### 样例输入 #1
```
6

2 R

6 L

1 R

8 L

1 R

2 R
```
### 样例输出 #1
```
6
```
## 提示

【样例解释】

Bessie从位置0开始，向右移动2个单位长度，向左移动6个单位长度，向右移动1个单位长度，向左移动8个单位长度，最后向右移动3个单位长度。

6个单位区域至少被涂了两层涂料，是 [-11,-8], [-4,-3], [0,2]这些区域。



---

---
title: "[USACO16DEC] Team Building P"
layout: "post"
diff: 普及+/提高
pid: P2098
tag: ['动态规划 DP', '2016', 'USACO', '动态规划优化', '前缀和']
---
# [USACO16DEC] Team Building P
## 题目描述

Every year, Farmer John brings his $N$ cows to compete for "best in show" at the state fair. His arch-rival, Farmer Paul, brings his $M$ cows to compete as well ($1 \leq N \leq 1000, 1 \leq M \leq 1000$).

Each of the $N + M$ cows at the event receive an individual integer score. However, the final competition this year will be determined based on teams of $K$ cows ($1 \leq K \leq 10$), as follows: Farmer John and Farmer Paul both select teams of $K$ of their respective cows to compete. The cows on these two teams are then paired off: the highest-scoring cow on FJ's team is paired with the highest-scoring cow on FP's team, the second-highest-scoring cow on FJ's team is paired with the second-highest-scoring cow on FP's team, and so on. FJ wins if in each of these pairs, his cow has the higher score.

Please help FJ count the number of different ways he and FP can choose their teams such that FJ will win the contest. That is, each distinct pair (set of $K$ cows for FJ, set of $K$ cows for FP) where FJ wins should be counted. Print your answer modulo 1,000,000,009.

## 输入格式

The first line of input contains $N$, $M$, and $K$. The value of $K$ will be no larger than $N$ or $M$.

The next line contains the $N$ scores of FJ's cows.

The final line contains the $M$ scores of FP's cows.

## 输出格式

Print the number of ways FJ and FP can pick teams such that FJ wins, modulo 1,000,000,009.

## 样例

### 样例输入 #1
```
10 10 3
1 2 2 6 6 7 8 9 14 17
1 3 8 10 10 16 16 18 19 19
```
### 样例输出 #1
```
382
```
## 题目翻译

### 题目描述

每年，Farmer John 都会带着他的 $N$ 头奶牛参加州展览会的“最佳展示”比赛。他的劲敌 Farmer Paul 也会带着他的 $M$ 头奶牛参加比赛（$1 \leq N \leq 1000, 1 \leq M \leq 1000$）。

参加比赛的每头 $N + M$ 头奶牛都会获得一个单独的整数得分。然而，今年的最终比赛将由 $K$ 头奶牛组成的团队决定（$1 \leq K \leq 10$），规则如下：Farmer John 和 Farmer Paul 各自选择 $K$ 头奶牛组成团队进行比赛。这两个团队的奶牛将按得分高低配对：FJ 团队中得分最高的奶牛与 FP 团队中得分最高的奶牛配对，FJ 团队中得分第二高的奶牛与 FP 团队中得分第二高的奶牛配对，依此类推。如果在每一对中，FJ 的奶牛得分都更高，那么 FJ 获胜。

请帮助 FJ 计算他和 FP 可以选择团队的不同方式的数量，使得 FJ 能够赢得比赛。也就是说，每个不同的（FJ 的 $K$ 头奶牛集合，FP 的 $K$ 头奶牛集合）对，只要 FJ 获胜，都应被计入。输出结果对 $1\,000\,000\,009$ 取模。

### 输入格式

输入的第一行包含 $N$、$M$ 和 $K$。$K$ 的值不会超过 $N$ 或 $M$。

第二行包含 FJ 的 $N$ 头奶牛的得分。

第三行包含 FP 的 $M$ 头奶牛的得分。

### 输出格式

输出 FJ 和 FP 可以选择团队的方式数量，使得 FJ 获胜，结果对 $1\,000\,000\,009$ 取模。


---

---
title: "[USACO11DEC] RoadBlock S / [USACO14FEB]Roadblock G/S"
layout: "post"
diff: 普及+/提高
pid: P2176
tag: ['搜索', '图论', '2011', '2014', 'USACO', '最短路']
---
# [USACO11DEC] RoadBlock S / [USACO14FEB]Roadblock G/S
## 题目描述

每天早晨，FJ 从家中穿过农场走到牛棚。农场由 $N$ 块农田组成，农田通过 $M$ 条双向道路连接，每条路有一定长度。FJ 的房子在 $1$ 号田，牛棚在 $N$ 号田。没有两块田被多条道路连接，以适当的路径顺序总是能在农场任意一对田间行走。当 FJ 从一块田走到另一块时，总是以总路长最短的道路顺序来走。

FJ 的牛呢，总是不安好心，决定干扰他每天早晨的计划。它们在 $M$ 条路的某一条上安放一叠稻草堆，使这条路的长度加倍。牛希望选择一条路干扰使得 FJ 从家到牛棚的路长增加最多。它们请你设计并告诉它们最大增量是多少。
## 输入格式

第 $1$ 行：两个整数 $N, M$。

第 $2$ 到 $M+1$ 行：第 $i+1$ 行包含三个整数 $A_i, B_i, L_i$，$A_i$ 和 $B_i$ 表示道路 $i$ 连接的田的编号，$L_i$ 表示路长。
## 输出格式

一个整数，表示通过使某条路加倍而得到的最大增量。

## 样例

### 样例输入 #1
```
5 7
2 1 5
1 3 1
3 2 8
3 5 7
3 4 3
2 4 7
4 5 2
```
### 样例输出 #1
```
2
```
## 提示

【样例说明】

若使 $3$ 和 $4$ 之间的道路长加倍，最短路将由 $1 \rightarrow 3 \rightarrow 4 \rightarrow 5$ 变为 $1 \rightarrow 3 \rightarrow 5$。

【数据规模和约定】

对于 $30\%$ 的数据，$N \le 70，M \le 1500$。

对于 $100\%$ 的数据，$1 \le N \le 100，1 \le M \le 5,000，1 \le L_i \le 1,000,000$。


---

---
title: "Haywire"
layout: "post"
diff: 普及+/提高
pid: P2210
tag: ['动态规划 DP', '搜索', 'USACO', '模拟退火']
---
# Haywire
## 题目描述

Farmer John有 $N$ 只奶牛（$4 \leq N \leq 12$，$N$ 是偶数）。

他们建立了一套原生的系统，使得奶牛与他的朋友可以通过由干草保护的线路来进行对话交流。


每一头奶牛在这个牧场中正好有 $3$ 个朋友，并且他们必须把自己安排在一排干草堆中。


一条长 $L$ 的线路要占用刚好 $L$ 堆干草来保护线路。


比如说，如果有两头奶牛分别在草堆 $4$ 与草堆 $7$ 中，并且他们是朋友关系，那么我们就需要用 $3$ 堆干草来建造线路，使他们之间能够联系。


假设每一对作为朋友的奶牛都必须用一条单独的线路来连接，并且我们可以随便地改变奶牛的位置，请计算出我们建造线路所需要的最少的干草堆。

## 输入格式

第 $1$ 行：一个整数 $N$。为了方便，我们给奶牛用 $1\sim N$ 的数字进行编号。

第 $2, 3, \cdots, N + 1$ 行：每一行都有三个在 $1\sim N$ 中的整数。第 $i+1$ 行的数字代表着第 $i$ 头奶牛的三个朋友的编号。显然，如果奶牛 $i$ 是奶牛 $j$ 的三个朋友之一，那么奶牛 $j$ 也是奶牛 $i$ 的三个朋友之一。

## 输出格式

一个整数，代表着建造线路需要的干草堆数量的最小值。

## 样例

### 样例输入 #1
```
6
6 2 5
1 3 4
4 2 6
5 3 2
4 6 1
1 5 3
```
### 样例输出 #1
```
17
```
## 提示

样例解释： 奶牛最好的排列是 `6, 5, 1, 4, 2, 3`, 这个时候我们只需要 $17$ 个单位的干草堆。



---

---
title: "[USACO14MAR] Mooo Moo S"
layout: "post"
diff: 普及+/提高
pid: P2214
tag: ['2014', 'USACO', '背包 DP', '栈']
---
# [USACO14MAR] Mooo Moo S
## 题目描述

Farmer John has completely forgotten how many cows he owns!  He is too embarrassed to go to his fields to count the cows, since he doesn't want the cows to realize his mental lapse.  Instead, he decides to count his cows secretly by planting microphones in the fields in which his cows tend to gather, figuring that he can determine the number of cows from the total volume of all the mooing he hears.

FJ's N fields (1 <= N <= 100) are all arranged in a line along a long straight road.  Each field might contain several types of cows; FJ owns cows that come from B different breeds (1 <= B <= 20), and a cow of breed i moos at a volume of V(i) (1 <= V(i) <= 100).  Moreover, there is a strong wind blowing down the road, which carries the sound of mooing in one direction from left to right: if the volume of mooing in some field is X, then in the next field this will contribute X-1 to the total mooing volume (and X-2 in the field after that, etc.). Otherwise stated, the mooing volume in a field is the sum of the contribution due to cows in that field, plus X-1, where X is the total mooing volume in the preceding field.

Given the volume of mooing that FJ records in each field, please compute the minimum possible number of cows FJ might own.

The volume FJ records in any field is at most 100,000.

### 题目背景
农夫约翰完全忘了他有多少头牛了！他不好意思到牧场里去数牛，因为他不想让牛意识到他的健忘。取而代之的是，他决定在奶牛聚集的牧场里安装麦克风，秘密计算出他能从中听到的所有牛叫声的总音量，以便以此确定奶牛的数量。
### 题目描述
$FJ$ 的 $N(1\le N\le 100)$ 个牧场都是沿着一条笔直的道路分布的。每一个牧场可能有许多种品种的奶牛； $FJ$ 拥有 $B(1\le B\le 20)$ 个不同品种的奶牛，而第 $i$ 种奶牛的叫声音量为 $V_i(1\le V_i \le 100)$ 。此外，有一股强风沿着道路吹来，将牛的叫声从左往右传递，如果某个牧场的总音量是 $x$ ，那么它将传递 $x-1$ 的音量到右边的下一个牧场。这就意味着，一个牧场里的总音量是处在该牧场的奶牛所发出的音量加上左边前一个牧场的总音量 $-1$ 。数据保证，每一个牧场内由该牧场所有奶牛所发出的总音量最多为$10^5$。
### 输入格式
第 $1$ 行：两个用空格分隔的整数 $N$ 和 $B$。      
第 $2...B+1$ 行：第 $i+1$ 行包含整数 $V_i$ 。        
第 $B+2...B+N+1$ 行：第 $B+i+1$ 行表示在第 $i$ 个牧场内所能监听到的总音量。
### 输出格式
共一行，即 $FJ$ 拥有的最小奶牛数量。

如果 FJ 不可能拥有一种牧场配置满足给出的条件，输出 `-1`。
### 说明/提示
#### 输入说明：
$FJ$ 拥有 $5$ 个牧场，每个牧场总音量从左到右分别为为$0、17、16、20、19$。 $FJ$ 有两种不同品种的奶牛；第一种奶牛的叫声音量是 $5$，第二种奶牛的叫声音量是 $7$ 。
#### 输出说明：
$2$ 号牧场场有  $2$ 头 $1$ 号品种的奶牛， $1$ 头 $2$ 号品种奶牛；还有一头牛在 $4$ 号牧场，共 $4$ 头奶牛。
## 输入格式

\* Line 1: The integers N and B.



\* Lines 2..1+B: Line i+1 contains the integer V(i).

\* Lines 2+B..1+B+N: Line 1+B+i contains the total volume of all mooing

in field i.

## 输出格式

\* Line 1: The minimum number of cows owned by FJ, or -1 if there is no

configuration of cows consistent with the input.

## 样例

### 样例输入 #1
```
5 2
5
7
0
17
16
20
19
```
### 样例输出 #1
```
4

```
## 提示

INPUT DETAILS:


FJ owns 5 fields, with mooing volumes 0,17,16,20,19.  There are two breeds

of cows; the first moos at a volume of 5, and the other at a volume of 7.

OUTPUT DETAILS:


There are 2 cows of breed #1 and 1 cow of breed #2 in field 2, and there is

another cow of breed #1 in field 4.


Source: USACO 2014 March Contest, Silver



---

---
title: "[USACO14FEB] Auto-complete S"
layout: "post"
diff: 普及+/提高
pid: P2237
tag: ['2014', 'USACO', '枚举']
---
# [USACO14FEB] Auto-complete S
## 题目描述

Bessie the cow has a new cell phone and enjoys sending text messages, although she keeps making spelling errors since she has trouble typing on such a small screen with her large hooves.  Farmer John has agreed to help her by writing an auto-completion app that takes a partial word and suggests how to complete it.

The auto-completion app has access to a dictionary of W words, each consisting of lowercase letters in the range a..z, where the total number of letters among all words is at most 1,000,000.  The app is given as input a list of N partial words (1 <= N <= 1000), each containing at most 1000 lowercase letters.  Along with each partial word i, an integer K\_i is also provided, such that the app must find the (K\_i)th word in alphabetical order that has partial word i as a prefix.  That is, if one ordered all of the valid completions of the ith partial word, the app should output the completion that is (K\_i)th in this sequence.

## 输入格式

\* Line 1: Two integers: W and N.


\* Lines 2..W+1: Line i+1: The ith word in the dictionary.


\* Lines W+2..W+N+1: Line W+i+1: A single integer K\_i followed by a    partial word.

## 输出格式

\* Lines 1..N: Line i should contain the index within the dictionary

(an integer in the range 1..W) of the (K\_i)th completion (in

alphabetical order) of the ith partial word, or -1 if there

are less than K\_i completions.

## 样例

### 样例输入 #1
```
10 3
dab
ba
ab
daa
aa
aaa
aab
abc
ac
dadba
4 a
2 da
4 da
```
### 样例输出 #1
```
3
1
-1
```
## 提示

OUTPUT DETAILS:


The completions of a are {aa,aaa,aab,ab,abc,ac}. The 4th is ab, which

is listed on line 3 of the dictionary.  The completions of da are

{daa,dab,dadba}. The 2nd is dab, listed on line 1 of the dictionary.

There is no 4th completion of da.


Source: USACO 2014 Feburary Contest, Silver

## 题目翻译

### 题目描述

有 $w$ 个由小写字符构成的字典和 $n$ 个询问。每个询问由一个字符串 $s$ 和一个整数 $k$ 构成，求在字典序排序下字典内由 $s$ 为前缀的第 $k$ 字符串在输入字典的位置。若不存在，则输出 $-1$

### 输入格式

第 $1$ 行是两个整数 $w$ 和 $n$ 

第 $2$ 行到第 $w$ + $1$ 行为字典中的第 $i$ - $1$ 个，每行由字符串构成（$i$ 指输入的第 $i$ 行）

第 $w$ + $2$ 行到第 $w$ + $n$ + $1$ 行由一个整数 $k$ 和一个字符串 $s$ 构成

### 输出格式

第 $1$ 行到第 $n$ 行是对于每个询问的结果，由一个整数构成

### 说明/提示
对于 $100\%$ 的数据，$w \le 30000$，$1\le n \le 1000$，字典内每个字符串的长度均小于等于 $1000$，且字典的单词总长不超过 $10 ^ 6$。

样例解释：

对于第 $1$ 个询问，含义为在字典中找到以 ```a``` 为前缀且按字典序排序后第 $4$ 个字符串，而字典中以 ```a``` 为前缀且按字典序排序后为 $\{$  ```aa```，```aaa```，```aab```，```ab```，```abc```，```ac``` $\}$，第 $4$ 个是 ```ab```，其在输入中为第 $3$ 个，故输出为 $3$

同理，对于第 $2$ 个和第 $3$ 个询问是在字典中找到以 ```da``` 为前缀且按字典序排序后的第 $2$ 和第 $4$ 个字符串。而以 ```da``` 为前缀的字符串按字典序排序后为 $\{$```daa```，```dab```，```dadba``` $\}$，故第 $2$ 个为 ```dab``` ，其在输入中为第 $1$ 个，故第 $2$ 个输出为 $1$，而该序列中没有第 $4$ 个，故第 $3$ 个询问无解，输出 $-1$

来源：USACO 2014 Feburary Contest Silver

翻译：@[zymooll](/user/289296)


---

---
title: "[USACO03FALL / HAOI2006] 受欢迎的牛 G"
layout: "post"
diff: 普及+/提高
pid: P2341
tag: ['图论', '2003', '2006', '河南', 'USACO', '各省省选', '强连通分量', 'Tarjan', '栈']
---
# [USACO03FALL / HAOI2006] 受欢迎的牛 G
## 题目背景

本题测试数据已修复。
## 题目描述

每头奶牛都梦想成为牛棚里的明星。被所有奶牛喜欢的奶牛就是一头明星奶牛。所有奶牛都是自恋狂，每头奶牛总是喜欢自己的。奶牛之间的“喜欢”是可以传递的——如果 $A$ 喜欢 $B$，$B$ 喜欢 $C$，那么 $A$ 也喜欢 $C$。牛栏里共有 $N$ 头奶牛，给定一些奶牛之间的爱慕关系，请你算出有多少头奶牛可以当明星。
## 输入格式

第一行：两个用空格分开的整数：$N$ 和 $M$。

接下来 $M$ 行：每行两个用空格分开的整数：$A$ 和 $B$，表示 $A$ 喜欢 $B$。

## 输出格式

一行单独一个整数，表示明星奶牛的数量。

## 样例

### 样例输入 #1
```
3 3
1 2
2 1
2 3
```
### 样例输出 #1
```
1
```
## 提示

只有 $3$ 号奶牛可以做明星。

【数据范围】

对于 $10\%$ 的数据，$N\le20$，$M\le50$。

对于 $30\%$ 的数据，$N\le10^3$，$M\le2\times 10^4$。

对于 $70\%$ 的数据，$N\le5\times 10^3$，$M\le5\times 10^4$。

对于 $100\%$ 的数据，$1\le N\le10^4$，$1\le M\le5\times 10^4$。


---

---
title: "[USACO09OCT] Allowance G"
layout: "post"
diff: 普及+/提高
pid: P2376
tag: ['贪心', '2009', 'USACO']
---
# [USACO09OCT] Allowance G
## 题目描述

作为创造产奶纪录的回报，Farmer John 决定开始每个星期给Bessie 一点零花钱。

FJ 有一些硬币，一共有 $N (1 \le N \le 20)$ 种不同的面额。每一个面额都能整除所有比它大的面额。

他想用给定的硬币的集合，每个星期至少给 Bessie 某个零花钱的数目 $C (1 \le C \le 100000000)$。请帮他计算他最多能支付多少个星期的零花钱。

## 输入格式

第 $1$ 行: 两个由空格隔开的整数: $N$ 和 $C$；

第 $2$ 到第 $N+1$ 行: 每一行有两个整数表示一个面额的硬币：硬币面额 $V (1 \le V \le 100,000,000)$ 拥有的该面额的硬币数 $B (1 \le B \le 1,000,000)$。

## 输出格式

第 $1$ 行: 一个单独的整数，表示最多能给支付多少个星期至少为 $C$ 的零用钱。

## 样例

### 样例输入 #1
```
3 6
10 1
1 100
5 120
```
### 样例输出 #1
```
111
```


---

---
title: "[USACO08JAN] Cow Contest S"
layout: "post"
diff: 普及+/提高
pid: P2419
tag: ['2008', 'USACO', '深度优先搜索 DFS', '拓扑排序']
---
# [USACO08JAN] Cow Contest S
## 题目描述

$ N (1 ≤ N ≤ 100) $ cows, conveniently numbered $ 1 ~ N $ , are participating in a programming contest. As we all know, some cows code better than others. Each cow has a certain constant skill rating that is unique among the competitors.

The contest is conducted in several head-to-head rounds, each between two cows. If cow $ A $ has a greater skill level than cow $ B (1 ≤ A ≤ N; 1 ≤ B ≤ N; A ≠ B) $, then cow $ A $ will always beat cow $ B $ .

Farmer John is trying to rank the cows by skill level. Given a list the results of $ M (1 ≤ M ≤ 4,500) $ two-cow rounds, determine the number of cows whose ranks can be precisely determined from the results. It is guaranteed that the results of the rounds will not be contradictory.

FJ的 $N$（$1 \leq N \leq 100$）头奶牛们最近参加了场程序设计竞赛。在赛场上，奶牛们按 $1, 2, \cdots, N$ 依次编号。每头奶牛的编程能力不尽相同，并且没有哪两头奶牛的水平不相上下，也就是说，奶牛们的编程能力有明确的排名。 整个比赛被分成了若干轮，每一轮是两头指定编号的奶牛的对决。如果编号为 $A$ 的奶牛的编程能力强于编号为 $B$ 的奶牛 （$1 \leq A, B \leq N$，$A \neq B$)，那么她们的对决中，编号为 $A$ 的奶牛总是能胜出。 FJ 想知道奶牛们编程能力的具体排名，于是他找来了奶牛们所有 $M$（$1 \leq M \leq 4,500$）轮比赛的结果，希望你能根据这些信息，推断出尽可能多的奶牛的编程能力排名。比赛结果保证不会自相矛盾。
## 输入格式

第一行两个用空格隔开的整数 $N, M$。

第 $2\sim M + 1$ 行，每行为两个用空格隔开的整数 $A, B$ ，描述了参加某一轮比赛的奶牛的编号，以及结果（每行的第一个数的奶牛为**胜者**）。
## 输出格式

输出一行一个整数，表示排名可以确定的奶牛的数目。

## 样例

### 样例输入 #1
```
5 5
4 3
4 2
3 2
1 2
2 5
```
### 样例输出 #1
```
2

```
## 提示

样例解释：

编号为 $2$ 的奶牛输给了编号为 $1, 3, 4$ 的奶牛，也就是说她的水平比这 $3$ 头奶牛都差。而编号为 $5$ 的奶牛又输在了她的手下，也就是说，她的水平比编号为 $5$ 的奶牛强一些。于是，编号为 $2$ 的奶牛的排名必然为第 $4$，编号为 $5$ 的奶牛的水平必然最差。其他 $3$ 头奶牛的排名仍无法确定。


---

---
title: "[USACO11OPEN] Mowing the Lawn G"
layout: "post"
diff: 普及+/提高
pid: P2627
tag: ['动态规划 DP', '2011', 'USACO', '单调队列']
---
# [USACO11OPEN] Mowing the Lawn G
## 题目描述

在一年前赢得了小镇的最佳草坪比赛后，Farmer John 变得很懒，再也没有修剪过草坪。现在，新一轮的最佳草坪比赛又开始了，Farmer John 希望能够再次夺冠。

然而，Farmer John 的草坪非常脏乱，因此，Farmer John 只能够让他的奶牛来完成这项工作。Farmer John 有 $N$（$1\le N\le 10^5$）只排成一排的奶牛，编号为 $1\ldots N$。每只奶牛的效率是不同的，奶牛 $i$ 的效率为 $E_i$（$0\le E_i\le 10^9$）。

靠近的奶牛们很熟悉，因此，如果 Farmer John安排超过 $K$ 只连续的奶牛，那么，这些奶牛就会罢工去开派对 :)。因此，现在 Farmer John 需要你的帮助，计算 FJ 可以得到的最大效率，并且该方案中没有连续的超过 $K$ 只奶牛。
## 输入格式

第一行：空格隔开的两个整数 $N$ 和 $K$。

第二到 $N+1$ 行：第 $i+1$ 行有一个整数 $E_i$。
## 输出格式

第一行：一个值，表示 Farmer John 可以得到的最大的效率值。
## 样例

### 样例输入 #1
```
5 2
1
2
3
4
5

```
### 样例输出 #1
```
12

```


---

---
title: "[USACO3.1] 丑数 Humble Numbers"
layout: "post"
diff: 普及+/提高
pid: P2723
tag: ['搜索', '数学', 'USACO', '平衡树', '枚举', '排序']
---
# [USACO3.1] 丑数 Humble Numbers
## 题目描述

对于一给定的素数集合 $S = \{ p_1, p_2, ..., p_k \}$, 考虑一个正整数集合，该集合中任一元素的质因数全部属于 $S$。这个正整数集合包括，$p_1$、$p_1 \times p_2$、$p_1 \times p_1$、$p_1 \times p_2 \times p_3$ ...(还有其它)。该集合被称为 $S$ 集合的“丑数集合”。注意：我们认为 $1$不是一个丑数。

你的工作是对于输入的集合 $S$ 去寻找“丑数集合”中的第 $n$ 个“丑数”。保证答案可以用 32 位有符号整数表示。

补充：丑数集合中每个数从小到大排列，每个丑数都是素数集合中的数的乘积，第 $n$ 个“丑数”就是在能由素数集合中的数相乘得来的（包括它本身）第 $n$ 小的数。

## 输入格式

输入的第一行是两个的整数，分别代表集合 $S$ 的大小 $k$ 和给定的参数 $n$。

输入的第二行有 $k$ 互不相同的整数，第 $i$ 个整数代表 $p_i$。
## 输出格式

输出一行一个整数，代表答案。
## 样例

### 样例输入 #1
```
4 19
2 3 5 7
```
### 样例输出 #1
```
27
```
## 提示

#### 数据规模与约定

对于 $100\%$ 的数据，保证：

- $1 \leq k \leq 100$。
- $1 \leq n \leq 10^5$。
- $2 \leq p_i < 2^{31}$，且 $p_i$ 一定为质数。

---
#### 说明

题目翻译来自 NOCOW。

USACO Training Section 3.1



---

---
title: "[USACO3.2] 魔板 Magic Squares"
layout: "post"
diff: 普及+/提高
pid: P2730
tag: ['搜索', 'USACO', 'IOI']
---
# [USACO3.2] 魔板 Magic Squares
## 题目背景

在成功地发明了魔方之后，鲁比克先生发明了它的二维版本，称作魔板。这是一张有 $8$ 个大小相同的格子的魔板：

$1\quad2\quad3\quad4$

$8\quad7\quad6\quad5$

## 题目描述

我们知道魔板的每一个方格都有一种颜色。这 $8$ 种颜色用前 $8$ 个正整数来表示。可以用颜色的序列来表示一种魔板状态，规定从魔板的左上角开始，沿顺时针方向依次取出整数，构成一个颜色序列。对于上图的魔板状态，我们用序列 $\{1,2,3,4,5,6,7,8\}$ 来表示。这是基本状态。

这里提供三种基本操作，分别用大写字母 $\text A$，$\text B$，$\text C$ 来表示（可以通过这些操作改变魔板的状态）：

$\text A$：交换上下两行；

$\text B$：将最右边的一列插入最左边；

$\text C$：魔板中央四格作顺时针旋转。

下面是对基本状态进行操作的示范：

$\text A$：

$8\quad7\quad6\quad5$

$1\quad2\quad3\quad4$



$\text B$：

$4\quad1\quad2\quad3$

$5\quad8\quad7\quad6$

$\text C$：

$1\quad7\quad2\quad4$

$8\quad6\quad3\quad5$

对于每种可能的状态，这三种基本操作都可以使用。

你要编程计算用最少的基本操作完成基本状态到目标状态的转换，输出基本操作序列。

## 输入格式

只有一行，包括 $8$ 个整数 $a_1,a_2\cdots a_8(1\leq a_1,a_2\cdots a_8\leq8)$，用空格分开，不换行，表示目标状态。

## 输出格式

第一行包括一个整数，表示最短操作序列的长度。

第二行在字典序中最早出现的操作序列，用字符串表示，除最后一行外，每行输出 $60$ 个字符。

## 样例

### 样例输入 #1
```
2 6 8 4 5 7 3 1 
```
### 样例输出 #1
```
7 
BCABCCB
```
## 提示

题目翻译来自 NOCOW。

USACO Training Section 3.2



---

---
title: "[USACO3.3] 骑马修栅栏 Riding the Fences"
layout: "post"
diff: 普及+/提高
pid: P2731
tag: ['搜索', '图论', 'USACO', '欧拉回路']
---
# [USACO3.3] 骑马修栅栏 Riding the Fences
## 题目背景

Farmer John 每年有很多栅栏要修理。他总是骑着马穿过每一个栅栏并修复它破损的地方。
## 题目描述

John 是一个与其他农民一样懒的人。他讨厌骑马，因此从来不两次经过一个栅栏。

John 的农场上一共有 $m$ 个栅栏，每一个栅栏连接两个顶点，顶点用 $1$ 到 $500$ 标号（虽然有的农场并没有那么多个顶点）。一个顶点上至少连接 $1$ 个栅栏，没有上限。两顶点间可能有多个栅栏。所有栅栏都是连通的（也就是你可以从任意一个栅栏到达另外的所有栅栏）。John 能从任何一个顶点（即两个栅栏的交点）开始骑马，在任意一个顶点结束。

你需要求出输出骑马的路径（用路上依次经过的顶点号码表示)，使每个栅栏都恰好被经过一次。如果存在多组可行的解，按照如下方式进行输出：如果把输出的路径看成是一个 $500$ 进制的数，那么当存在多组解的情况下，输出 $500$ 进制表示法中最小的一个 （也就是输出第一位较小的，如果还有多组解，输出第二位较小的，以此类推）。

输入数据保证至少有一个解。
## 输入格式

第一行一个整数 $m$，表示栅栏的数目。

从第二行到第 $(m+1)$ 行，每行两个整数 $u,v$，表示有一条栅栏连接 $u,v$ 两个点。
## 输出格式

共 $(m+1)$ 行，每行一个整数，依次表示路径经过的顶点号。注意数据可能有多组解，但是只有上面题目要求的那一组解是认为正确的。

数据保证至少有一组可行解。
## 样例

### 样例输入 #1
```
9
1 2
2 3
3 4
4 2
4 5
2 5
5 6
5 7
4 6
```
### 样例输出 #1
```
1
2
3
4
2
5
4
6
5
7
```
## 提示

对于 $100\%$ 的数据，$1 \leq m \leq 1024,1 \leq u,v \leq 500$。

题目翻译来自NOCOW。

USACO Training Section 3.3


---

---
title: "[USACO3.4] “破锣摇滚”乐队 Raucous Rockers"
layout: "post"
diff: 普及+/提高
pid: P2736
tag: ['动态规划 DP', '搜索', 'USACO']
---
# [USACO3.4] “破锣摇滚”乐队 Raucous Rockers
## 题目描述

你刚刚继承了流行的 “破锣摇滚” 乐队录制的尚未发表的 $N$（$1\leq N\leq 20$）首歌的版权。你打算从中精选一些歌曲，发行 $M$（$1\leq M\leq 20$）张 CD。每一张 CD 最多可以容纳 $T$（$1\leq T\leq 20$）分钟的音乐，一首歌不能分装在两张 CD 中。CD 数量可以用完，也可以不用完。

不巧你是一位古典音乐迷，不懂如何判定这些歌的艺术价值。于是你决定根据以下标准进行选择：

* 1.歌曲必须按照创作的时间顺序在所有的 CD 盘上出现。(注：第 $i$ 张盘的最后一首的创作时间要早于第 $i+1$ 张盘的第一首)

* 2.选中的歌曲数目尽可能地多。
## 输入格式

第一行：三个整数：$N,T,M$。

第二行：$N$ 个整数，分别表示每首歌的长度，按创作时间顺序排列。
## 输出格式

一个整数，表示可以装进 $M$ 张 CD 盘的乐曲的最大数目。
## 样例

### 样例输入 #1
```
4 5 2
4 3 4 2
```
### 样例输出 #1
```
3
```
## 提示

题目翻译来自NOCOW。

USACO Training Section 3.4



---

---
title: "[USACO4.1] 麦香牛块Beef McNuggets"
layout: "post"
diff: 普及+/提高
pid: P2737
tag: ['数学', 'USACO']
---
# [USACO4.1] 麦香牛块Beef McNuggets
## 题目描述

农夫布朗的奶牛们正在进行斗争，因为它们听说麦当劳正在考虑引进一种新产品：麦香牛块。奶牛们正在想尽一切办法让这种可怕的设想泡汤。奶牛们进行斗争的策略之一是“劣质的包装”。“看，”奶牛们说，“如果你只用一次能装 $3$ 块、 $6$ 块或者 $10$ 块的三种包装盒包装麦香牛块，你就不可能满足一次只想买 $1$ 、 $2$ 、 $4$ 、 $5$ 、 $7$ 、 $8$ 、 $11$ 、 $14$ 或者 $17$ 块麦香牛块的顾客了。劣质的包装意味着劣质的产品。”。

你的任务是帮助这些奶牛。给出包装盒的种类数 $N(1 \le N \le 10)$ 和 $N$ 个代表不同种类包装盒容纳麦香牛块个数的正整数 $(1 \le i \le 256)$，输出顾客不能用上述包装盒（每种盒子数量无限）买到麦香牛块的最大块数。如果所有购买方案都能得到满足或者不存在不能买到块数的上限，则输出 $0$。不能买到的最大块数（倘它存在）不超过 $2\times 10^9$。
## 输入格式

第 $1$ 行：包装盒的种类数 $N$。

第 $2$ 行到 $N+1$ 行：每个种类包装盒容纳麦香牛块的个数。
## 输出格式

输出文件只有一行数字：顾客不能用包装盒买到麦香牛块的最大块数或 $0$（如果所有购买方案都能得到满足或者顾客不能买到的块数没有上限）。
## 样例

### 样例输入 #1
```
3

3

6

10
```
### 样例输出 #1
```
17
```
## 提示

题目翻译来自 NOCOW。

USACO Training Section 4.1



---

---
title: "[USACO4.4] 棋盘游戏Shuttle Puzzle"
layout: "post"
diff: 普及+/提高
pid: P2739
tag: ['USACO']
---
# [USACO4.4] 棋盘游戏Shuttle Puzzle
## 题目描述

大小为3的棋盘游戏里有3个白色棋子，3个黑色棋子，和一个有7个格子一线排开的木盒子。3个白棋子被放在一头，3个黑棋子被放在另一头，中间的格子空着。

初始状态: WWW\_BBB

目标状态: BBB\_WWW

在这个游戏里有两种移动方法是允许的：

你可以把一个棋子移到与它相邻的空格；

你可以把一个棋子跳过一个(仅一个)与它不同色的棋子到达空格。

大小为N的棋盘游戏包括N个白棋子，N个黑棋子，还有有2N+1个格子的木盒子。

这里是3-棋盘游戏的解，包括初始状态，中间状态和目标状态：

WWW BBB

WW WBBB

WWBW BB

WWBWB B

WWB BWB

W BWBWB

WBWBWB
BW WBWB

BWBW WB

BWBWBW
BWBWB W

BWB BWW

B BWBWW

BB WBWW

BBBW WW

BBB WWW

请编一个程序解大小为N的棋盘游戏(1 <= N <= 12)。要求用最少的移动步数实现。

## 输入格式

一个整数N。

## 输出格式

输出用移动的棋子在棋盘的位置(位置从左到右依次为1, 2, ..., 2N+1)表示的变换序列，每个数字之间以空格分隔，每行20个数(除了最后一行)。

输出的解还应当有最小的字典顺序(即如果有多组移动步数最小的解，输出第一个数最小的解；如果还有多组，输出第二个数最小的解；...)。

## 样例

### 样例输入 #1
```
3
```
### 样例输出 #1
```
3 5 6 4 2 1 3 5 7 6 4 2 3 5 4
```
## 提示

题目翻译来自NOCOW。

USACO Training Section 4.3



---

---
title: "[USACO5.3] 校园网Network of Schools"
layout: "post"
diff: 普及+/提高
pid: P2746
tag: ['2001', 'USACO', 'IOI', '强连通分量', 'Tarjan']
---
# [USACO5.3] 校园网Network of Schools
## 题目描述

一些学校连入一个电脑网络。那些学校已订立了协议：每个学校都会给其它的一些学校分发软件（称作“接受学校”）。注意即使 $B$ 在 $A$ 学校的分发列表中，$A$ 也不一定在 $B$ 学校的列表中。

你要写一个程序计算，根据协议，为了让网络中所有的学校都用上新软件，必须接受新软件副本的最少学校数目（子任务 A）。更进一步，我们想要确定通过给任意一个学校发送新软件，这个软件就会分发到网络中的所有学校。为了完成这个任务，我们可能必须扩展接收学校列表，使其加入新成员。计算最少需要增加几个扩展，使得不论我们给哪个学校发送新软件，它都会到达其余所有的学校（子任务 B）。一个扩展就是在一个学校的接收学校列表中引入一个新成员。
## 输入格式

输入文件的第一行包括一个正整数 $N$，表示网络中的学校数目。学校用前 $N$ 个正整数标识。

接下来 $N$ 行中每行都表示一个接收学校列表（分发列表），第 $i+1$ 行包括学校 $i$ 的接收学校的标识符。每个列表用 $0$ 结束，空列表只用一个 $0$ 表示。
## 输出格式

你的程序应该在输出文件中输出两行。

第一行应该包括一个正整数，表示子任务 A 的解。

第二行应该包括一个非负整数，表示子任务 B 的解。
## 样例

### 样例输入 #1
```
5
2 4 3 0
4 5 0
0
0
1 0
```
### 样例输出 #1
```
1
2
```
## 提示

$2 \le N \le 100$。

题目翻译来自NOCOW。

USACO Training Section 5.3



---

---
title: "[USACO15DEC] Switching on the Lights S"
layout: "post"
diff: 普及+/提高
pid: P2845
tag: ['模拟', '搜索', '2015', 'USACO', '广度优先搜索 BFS', '深度优先搜索 DFS']
---
# [USACO15DEC] Switching on the Lights S
## 题目背景

来源：usaco-2015-dec

Farm John 最近新建了一批巨大的牛棚。这些牛棚构成了一个 $N \times N$ 的矩形网络 $(1 < N < 100)$。

然而 Bessie 十分怕黑，他想计算可以把多少个牛棚的灯打开。
## 题目描述

有 $N \times N$ 个房间，组成了一张 $N \times N$ 的网格图，Bessie 一开始位于左上角 $(1,1)$，并且只能上下左右行走。


一开始，只有 $(1,1)$ 这个房间的灯是亮着的，Bessie 只能在亮着灯的房间里活动。


有另外 $M$ 条信息，每条信息包含四个数 $a,b,c,d$，表示房间 $(a,b)$ 里有房间 $(c,d)$ 的灯的开关。


请计算出最多有多少个房间的灯可以被打开。
## 输入格式

第一行输入两个整数 $N,M(1 < N < 100,1 < M < 2 \times 10 ^ 5)$。

第 $2 \sim M + 1$ 行，每行输入四个整数 $(x_1,y_1),(x_2,y_2)$，代表房间的坐标 $(x_1,y_1)$ 可以点亮房间的坐标 $(x_2,y_2)$。
## 输出格式

一个数，最多可以点亮的房间数。

## 样例

### 样例输入 #1
```
3 6
1 1 1 2
2 1 2 2
1 1 1 3
2 3 3 1
1 3 1 2
1 3 2 1

```
### 样例输出 #1
```
5
```
## 提示

Bessie 可以使用 $(1,1)$ 的开关打开 $(1,2),(1,3)$ 的灯，然后走到 $(1,3)$ 并打开 $(2,1)$ 的灯，走到 $(2,1)$ 并打开 $(2,2)$ 的灯。$(2,3)$ 的开关无法到达。因此可以点亮 $5$ 个房间。


---

---
title: "[USACO08NOV] Light Switching G"
layout: "post"
diff: 普及+/提高
pid: P2846
tag: ['2008', '线段树', 'USACO']
---
# [USACO08NOV] Light Switching G
## 题目描述

Farmer John tries to keep the cows sharp by letting them play with intellectual toys. One of the larger toys is the lights in the barn. Each of the $N (2 \le N \le 10^5)$ cow stalls conveniently numbered $1\ldots N$ has a colorful light above it.

At the beginning of the evening, all the lights are off. The cows control the lights with a set of N pushbutton switches that toggle the lights; pushing switch i changes the state of light i from off to on or from on to off.

The cows read and execute a list of $M(1\le M \le 10^5)$ operations expressed as one of two integers ( $0 \le$ operation $\le 1$ ).

The first kind of operation (denoted by a $0$ command) includes two subsequent integers $S_i$ and $E_i (1 \le S_i \le E_i \le N)$ that indicate a starting switch and ending switch. They execute the operation by pushing each pushbutton from $S_i$ through $E_i$ inclusive exactly once.

The second kind of operation (denoted by a $1$ command) asks the cows to count how many lights are on in the range given by two integers $S_i$ and $E_i (1 \le S_i \le E_i \le N)$ which specify the inclusive range in which the cows should count the number of lights that are on.

Help FJ ensure the cows are getting the correct answer by processing the list and producing the proper counts.

农夫约翰试图让奶牛玩智力玩具来保持它们的敏锐。谷仓里的灯是较大的玩具之一。$N (2 \le N \le 10^5)$ 个牛栏编号为 $1 \ldots N$，每个牛栏上面都有一盏灯。起初所有的灯都关着。

共有 $M$ 次操作，分为两种。
1. 指定一个区间 $[S_i,E_i]$，然后改变编号在这个区间内的灯的状态（把开着的灯关上，关着的灯打开）；
2. 指定一个区间 $[S_i,E_i]$，要求你输出这个区间内有多少盏灯是打开的。






## 输入格式

第 $1$ 行: 用空格隔开的两个整数 $N$ 和 $M$，$N$ 是灯数。

第 $2\ldots M+1$ 行: 每行表示一个操作, 有三个用空格分开的整数: 指令号, $S_i$ 和 $E_i$。

若指令号为 $0$，则表示改变 $[S_i,E_i]$ 区间内的灯的状态（把开着的灯关上，关着的灯打开）。

若指令号为 $1$，则表示输出 $[S_i,E_i]$ 这个区间内有多少盏灯是打开的。
## 样例

### 样例输入 #1
```
4 5
0 1 2
0 2 4
1 2 3
0 2 4
1 1 4
```
### 样例输出 #1
```
1
2
```
## 提示

| 数据点编号 | $N$ | $M$ |
| :----------: | :----------: | :----------: |
| $1\sim 2$ | $\le 100$ | $\le 100$ |
| $3\sim 4$ | $\le 1000$ | $\le 1000$ |
| $5\sim 6$ | $\le 10000$ | $\le 10000$ |
| $7\sim 8$ | $\le 10^5$ | $\le 100$ |
| $9\sim 10$ | $\le 100$ | $\le 10^5$ |
| $11\sim 12$ | $\le 1000$ | $\le 10^5$ |
| $13\sim 14$ | $\le 10^5$ | $\le 1000$ |
| $15\sim 16$ | $\le 10000$ | $\le 10000$ |
| $17\sim 18$ | $\le 10$ | $\le 10^5$ |
| $19\sim 20$ | $\le 2000$ | $\le 10^6$ |



---

---
title: "[USACO16DEC] Moocast G"
layout: "post"
diff: 普及+/提高
pid: P2847
tag: ['2016', '二分', 'USACO', '生成树']
---
# [USACO16DEC] Moocast G
## 题目描述

Farmer John's $N$ cows ($1 \leq N \leq 1000$) want to organize an emergency "moo-cast" system for broadcasting important messages among themselves.

Instead of mooing at each-other over long distances, the cows decide to equip themselves with walkie-talkies, one for each cow. These walkie-talkies each have a limited transmission radius, but cows can relay messages to one-another along a path consisting of several hops, so it is not necessary for every cow to be able to transmit directly to every other cow.

The cows need to decide how much money to spend on their walkie-talkies. If they spend $X$, they will each get a walkie-talkie capable of transmitting up to a distance of $\sqrt{X}$. That is, the squared distance between two cows must be at most $X$ for them to be able to communicate.

Please help the cows determine the minimum integer value of $X$ such that a broadcast from any cow will ultimately be able to reach every other cow.

## 输入格式

The first line of input contains $N$.

The next $N$ lines each contain the $x$ and $y$ coordinates of a single cow. These are both integers in the range $0 \ldots 25,000$.

## 输出格式

Write a single line of output containing the integer $X$ giving the minimum amount the cows must spend on walkie-talkies.

## 样例

### 样例输入 #1
```
4
1 3
5 4
7 2
6 1
```
### 样例输出 #1
```
17

```
## 提示

感谢@MrMorning 提供翻译

## 题目翻译

### 题目描述

Farmer John 的 $N$ 头奶牛（$1 \leq N \leq 1000$）希望组织一个紧急的“哞播”系统，用于在它们之间广播重要消息。

为了避免在长距离上互相哞叫，奶牛们决定为自己配备对讲机，每头奶牛一个。这些对讲机每个都有一个有限的传输半径，但奶牛们可以通过多次跳跃的路径中继消息，因此并非每头奶牛都需要能够直接与其他每头奶牛通信。

奶牛们需要决定在对讲机上花费多少钱。如果它们花费 $X$，每头奶牛将获得一个能够传输到 $\sqrt{X}$ 距离的对讲机。也就是说，两头奶牛之间的平方距离必须不超过 $X$，它们才能通信。

请帮助奶牛们确定 $X$ 的最小整数值，使得从任何一头奶牛发出的广播最终能够到达其他所有奶牛。

### 输入格式

输入的第一行包含 $N$。

接下来的 $N$ 行每行包含一头奶牛的 $x$ 和 $y$ 坐标。这些坐标都是 $0 \ldots 25,000$ 范围内的整数。

### 输出格式

输出一行，包含整数 $X$，表示奶牛们在对讲机上必须花费的最小金额。


---

---
title: "[USACO16DEC] Cow Checklist G"
layout: "post"
diff: 普及+/提高
pid: P2848
tag: ['动态规划 DP', '2016', 'USACO']
---
# [USACO16DEC] Cow Checklist G
## 题目描述

Every day, Farmer John walks through his pasture to check on the well-being ofeach of his cows. On his farm he has two breeds of cows, Holsteins and Guernseys. His $H$ Holsteins are conveniently numbered $1 \ldots H$, and his $G$ Guernseys are conveniently numbered $1 \ldots G$($1 \leq H \leq 1000, 1 \leq G \leq 1000$). Each cow is located at a point inthe 2D plane (not necessarily distinct).

Farmer John starts his tour at Holstein 1, and ends at Holstein $H$.  He wantsto visit each cow along the way, and for convenience in maintaining hischecklist of cows visited so far, he wants to visit the Holsteins and Guernseysin the order in which they are numbered. In the sequence of all $H+G$ cows hevisits, the Holsteins numbered $1 \ldots H$ should appear as a (not necessarilycontiguous) subsequence, and likewise for the Guernseys. Otherwise stated, thesequence of all $H+G$ cows should be formed by  interleaving the list ofHolsteins numbered $1 \ldots H$ with the list of Guernseys numbered $1 \ldots G$.

When FJ moves from one cow to another cow traveling a distance of $D$, heexpends $D^2$ energy.  Please help him determine the minimum amount of energyrequired to visit all his cows according to a tour as described above.
## 输入格式

The first line of input contains $H$ and $G$, separated by a space.

The next $H$ lines contain the $x$ and $y$ coordinates of the $H$ Holsteins, and the next $G$ lines after that contain coordinates of the Guernseys. Each coordinate is an integer in the range $0 \ldots 1000$.

## 输出格式

Write a single line of output, giving the minimum energy required for FJ's tour of all the cows.

## 样例

### 样例输入 #1
```
3 2
0 0
1 0
2 0
0 3
1 3
```
### 样例输出 #1
```
20
```
## 题目翻译

### 题目描述

每天，Farmer John 都会穿过他的牧场，检查每头奶牛的健康状况。他的农场里有两类奶牛：荷斯坦牛和根西牛。他的 $H$ 头荷斯坦牛被方便地编号为 $1 \ldots H$，而他的 $G$ 头根西牛被方便地编号为 $1 \ldots G$（$1 \leq H \leq 1000, 1 \leq G \leq 1000$）。每头奶牛都位于二维平面中的一个点（不一定不同）。

Farmer John 从荷斯坦牛 1 开始他的巡视，并在荷斯坦牛 $H$ 结束。他希望沿途访问每头奶牛，并且为了方便维护他已经访问过的奶牛清单，他希望按照编号顺序访问荷斯坦牛和根西牛。在他访问的所有 $H+G$ 头奶牛的序列中，编号为 $1 \ldots H$ 的荷斯坦牛应作为一个（不一定连续的）子序列出现，同样地，编号为 $1 \ldots G$ 的根西牛也应如此。换句话说，所有 $H+G$ 头奶牛的序列应通过将编号为 $1 \ldots H$ 的荷斯坦牛列表与编号为 $1 \ldots G$ 的根西牛列表交错排列而成。

当 Farmer John 从一头奶牛移动到另一头奶牛，移动距离为 $D$ 时，他会消耗 $D^2$ 的能量。请帮助他确定按照上述巡视方式访问所有奶牛所需的最小能量。

### 输入格式

输入的第一行包含用空格分隔的 $H$ 和 $G$。

接下来的 $H$ 行包含 $H$ 头荷斯坦牛的 $x$ 和 $y$ 坐标，随后的 $G$ 行包含根西牛的坐标。每个坐标都是 $0 \ldots 1000$ 范围内的整数。

### 输出格式

输出一行，表示 Farmer John 巡视所有奶牛所需的最小能量。


---

---
title: "[USACO06DEC] Wormholes G"
layout: "post"
diff: 普及+/提高
pid: P2850
tag: ['2006', 'USACO', '深度优先搜索 DFS', '负权环']
---
# [USACO06DEC] Wormholes G
## 题目背景

[英文题面见此链接](https://www.luogu.com.cn/paste/mxuf6zpl)
## 题目描述

John 在他的农场中闲逛时发现了许多虫洞。虫洞可以看作一条十分奇特的有向边，并可以使你返回到过去的一个时刻（相对你进入虫洞之前）。

John 的每个农场有 $m$ 条小路（无向边）连接着 $n$ 块地（从 $1 \sim n$ 标号），并有 $w$ 个虫洞。

现在 John 希望能够从某块地出发，走过一条路径回到出发点，且同时也回到了出发时刻以前的某一时刻。请你告诉他能否做到。
## 输入格式

输入的第一行是一个整数 $T$，代表测试数据的组数。

每组测试数据的格式如下：

每组数据的第一行是三个用空格隔开的整数，分别代表农田的个数 $n$，小路的条数 $m$，以及虫洞的个数 $w$。

每组数据的第 $2$ 到第 $(m + 1)$ 行，每行有三个用空格隔开的整数 $u, v, p$，代表有一条连接 $u$ 与 $v$ 的小路，经过这条路需要花费 $p$ 的时间。

每组数据的第 $(m + 2)$ 到第 $(m + w + 1)$ 行，每行三个用空格隔开的整数 $u, v, p$，代表点 $u$ 存在一个虫洞，经过这个虫洞会到达点 $v$，并回到 $p$ 秒之前。
## 输出格式

对于每组测试数据，输出一行一个字符串，如果能回到出发时刻之前，则输出 `YES`，否则输出 `NO`。
## 样例

### 样例输入 #1
```
2
3 3 1
1 2 2
1 3 4
2 3 1
3 1 3
3 2 1
1 2 3
2 3 4
3 1 8
```
### 样例输出 #1
```
NO
YES
```
## 提示

#### 样例 2 解释

John 只需要沿着 $1 \rightarrow 2 \rightarrow 3 \rightarrow 1$ 的路径一直转圈即可，每转完一圈，时间就会减少一秒。

#### 数据范围与约定

对于 $100\%$ 的数据，$1 \le T \le 5$，$1 \le n \le 500$，$1 \le m \le 2500$，$1 \le w \le 200$，$1 \le p \le 10^4$。


---

---
title: "[USACO06DEC] Milk Patterns G"
layout: "post"
diff: 普及+/提高
pid: P2852
tag: ['2006', '二分', 'USACO', '哈希 hashing', '后缀数组 SA']
---
# [USACO06DEC] Milk Patterns G
## 题目描述

Farmer John has noticed that the quality of milk given by his cows varies from day to day. On further investigation, he discovered that although he can't predict the quality of milk from one day to the next, there are some regular patterns in the daily milk quality.

To perform a rigorous study, he has invented a complex classification scheme by which each milk sample is recorded as an integer between 0 and 1,000,000 inclusive, and has recorded data from a single cow over N (1 ≤ N ≤ 20,000) days. He wishes to find the longest pattern of samples which repeats identically at least K (2 ≤ K ≤ N) times. This may include overlapping patterns -- 1 2 3 2 3 2 3 1 repeats 2 3 2 3 twice, for example.

Help Farmer John by finding the longest repeating subsequence in the sequence of samples. It is guaranteed that at least one subsequence is repeated at least K times.

## 输入格式

Line 1: Two space-separated integers: N and K


Lines 2..N+1: N integers, one per line, the quality of the milk on day i appears on the ith line.

## 输出格式

Line 1: One integer, the length of the longest pattern which occurs at least K times

## 样例

### 样例输入 #1
```
8 2
1
2
3
2
3
2
3
1
```
### 样例输出 #1
```
4
```
## 题目翻译

农夫 John 发现他的奶牛产奶的质量一直在变动。经过细致的调查，他发现：虽然他不能预见明天产奶的质量，但连续的若干天的质量有很多重叠。我们称之为一个“模式”。 John 的牛奶按质量可以被赋予一个 $0$ 到 $1000000$ 之间的数。并且 John 记录了 $N$（$1 \le N \le 2 \times 10 ^ 4$）天的牛奶质量值。他想知道最长的出现了至少 $K$（$2 \le K \le N$）次的模式的长度。比如 `1 2 3 2 3 2 3 1` 中 `2 3 2 3` 出现了两次。当 $K = 2$ 时，这个长度为 $4$。


---

---
title: "[USACO06DEC] Cow Roller Coaster S"
layout: "post"
diff: 普及+/提高
pid: P2854
tag: ['动态规划 DP', '2006', 'USACO', '背包 DP']
---
# [USACO06DEC] Cow Roller Coaster S
## 题目描述

The cows are building a roller coaster! They want your help to design as fun a roller coaster as possible, while keeping to the budget.

The roller coaster will be built on a long linear stretch of land of length L (1 ≤ L ≤ 1,000). The roller coaster comprises a collection of some of the N (1 ≤ N ≤ 10,000) different interchangable components. Each component i has a fixed length Wi (1 ≤ Wi ≤ L). Due to varying terrain, each component i can be only built starting at location Xi (0 ≤ Xi ≤ L - Wi). The cows want to string together various roller coaster components starting at 0 and ending at L so that the end of each component (except the last) is the start of the next component.

Each component i has a "fun rating" Fi (1 ≤ Fi ≤ 1,000,000) and a cost Ci (1 ≤ Ci ≤ 1000). The total fun of the roller coster is the sum of the fun from each component used; the total cost is likewise the sum of the costs of each component used. The cows' total budget is B (1 ≤ B ≤ 1000). Help the cows determine the most fun roller coaster that they can build with their budget.
## 输入格式

Line 1: Three space-separated integers: L, N and B.


Lines 2..N+1: Line i+1 contains four space-separated integers, respectively: Xi, Wi, Fi, and Ci.

## 输出格式

Line 1: A single integer that is the maximum fun value that a roller-coaster can have while staying within the budget and meeting all the other constraints. If it is not possible to build a roller-coaster within budget, output -1.

## 样例

### 样例输入 #1
```
5 6 10
0 2 20 6
2 3 5 6
0 1 2 1
1 1 1 3
1 2 5 4
3 2 10 2
```
### 样例输出 #1
```
17
```
## 提示

Taking the 3rd, 5th and 6th components gives a connected roller-coaster with fun value 17 and cost 7. Taking the first two components would give a more fun roller-coaster (25) but would be over budget.

## 题目翻译

**【题目描述】**

有 $n$ 条线段，每条线段只能放在数轴上的一个特定位置，并且第 $i$ 根线段有如下几个属性：$X_i$（该线段放在数轴上的起点），$W_i$（该线段长度），$F_i$（你若使用该线段你能获得的价值），$C_i$（你若使用该线段你所需要的费用）。现在让你从中选出一些线段，使得这些线段能够铺满数轴上的区间 $[0,L]$ 且线段必须首尾相接（也就是不能重叠，也不能空缺），并且所花费用和不超过 $B$，同时要使你收获的价值尽量大，请你找到这个方案。

**【输入格式】**

第一行三个整数 $L, n, B$。

接下来 $n$ 行，每行四个整数 $X_i, W_i, F_i, C_i$ 表示第 $i$ 根线段的四个属性。

**【输出格式】**

一个整数，表示你能获得的最大价值和。若无法满足上述要求，则输出 $-1$。


---

---
title: "[USACO06FEB] Cellphones G"
layout: "post"
diff: 普及+/提高
pid: P2856
tag: ['贪心', '2006', '线段树', 'USACO', '前缀和']
---
# [USACO06FEB] Cellphones G
## 题目描述

The cows have started using cellphones to cowmunicate with each other, but have found that the button layout doesn't suit their hooves very well. They are designing a special cellphone with fewer but larger buttons.


One feature they liked on the standard cellphones was predictive text. Each button has a few letters associated with it, and one types a word by pushing the associated buttons. Because there is more than one letter for each button, this can be ambiguous for some words.  However, most of the time the ambiguity can be resolved by using a dictionary to determine what word the user wanted.


Since the cows are designing a custom cellphone, they are also going to replace the English alphabet with the Cow alphabet. By an amazing coincidence, the cow alphabet is simply the first L (1 <= L <= 26) letters of the English alphabet, in the same order. They want to find out how to assign the letters of the Cow alphabet to the B buttons (1 <= B <= L) in such a way that the maximum number of words in their dictionary are unambiguous when entered with predictive text. Like normal cellphones, they want the letters on each button to be a contiguous section (one or more consecutive letters) of the alphabet.

奶牛的名字都是由英文字母表的前1(1 < K 26)个字母构成的.现在想设计一种手机， 有个按键.请你把这L个字母按顺序分配给B个按键，使能够通过按这些键而唯一确 定的奶牛数尽量多.

## 输入格式

Line 1: Two space-separated integers: B and L




Line 2: D, the number of words in the dictionary (1 <= D <= 1000)




Lines 3..D+2: Each line contains one word from the dictionary in upper case and of length 1..10 characters. The words are presented in alphabetical order and with no duplicates.

## 输出格式

Line 1: The number of words in the Cow dictionary that have unique button sequences.




Lines 2..B+1: The nth line contains the letters that appear on button n, in upper case and alphabetical order. The lines must be listed in alphabetical order, and every Cow letter must appear exactly once. If there is more than one optimal solution, use the one that places the most letters on button 1. Ties are broken by placing the most letters on button 2, etc.

## 样例

### 样例输入 #1
```
3 13
11
ALL
BALL
BELL
CALK
CALL
CELL
DILL
FILL
FILM
ILL
MILK
```
### 样例输出 #1
```
7
AB
CDEFGHIJK
LM
```
## 提示

Explanation of the sample:




Button 1 contains AB, button two contains C-K, and button 3 contains LM. The words CELL, DILL, FILL and FILM are all entered as 2233, while the remaining 7 words are all entered uniquely.



---

---
title: "[USACO06JAN] Corral the Cows G"
layout: "post"
diff: 普及+/提高
pid: P2862
tag: ['2006', '线段树', '二分', 'USACO']
---
# [USACO06JAN] Corral the Cows G
## 题目描述

Farmer John wishes to build a corral for his cows. Being finicky beasts, they demand that the corral be square and that the corral contain at least C (1 <= C <= 500) clover fields for afternoon treats. The corral's edges must be parallel to the X,Y axes.


FJ's land contains a total of N (C <= N <= 500) clover fields, each a block of size 1 x 1 and located at with its lower left corner at integer X and Y coordinates each in the range 1..10,000. Sometimes more than one clover field grows at the same location; such a field would have its location appear twice (or more) in the input. A corral surrounds a clover field if the field is entirely located inside the corral's borders.


Help FJ by telling him the side length of the smallest square containing C clover fields.

Farmer John 希望为他的奶牛们建立一个畜栏。

这些挑剔的奶牛要求畜栏必须是正方形的，而且至少要包含 $C$ 片三叶草，来当做它们的下午茶。

约翰的土地里一共包含 $N$ 片三叶草，每单位三叶草位于一个 $1\times 1$ 的土地区域内。坐标都为整数，范围在 $1$ 到 $10000$ 以内。

**多片的三叶草可能会位于同一个 $1\times 1$ 的区域内，所以在输入内，同一个区域坐标可能出现多次。**

请你帮 Farmer John 计算一下，在能包含至少 $C$ 片三叶草的情况下，畜栏的最小边长是多少。

$1\le C\le N\le 500$。
## 输入格式

Line 1: Two space-separated integers: C and N




Lines 2..N+1: Each line contains two space-separated integers that are the X,Y coordinates of a clover field.

## 输出格式

Line 1: A single line with a single integer that is length of one edge of the minimum size square that contains at least C clover fields.

## 样例

### 样例输入 #1
```
3 4
1 2
2 1
4 1
5 2
```
### 样例输出 #1
```
4
```
## 提示

Explanation of the sample:



```php
|*   *
| * *
+------
```

Below is one 4x4 solution (C's show most of the corral's area); many others exist.

```php
|CCCC
|CCCC
|*CCC*
|C*C*
+------
```


---

---
title: "[USACO06JAN] The Cow Prom S"
layout: "post"
diff: 普及+/提高
pid: P2863
tag: ['2006', 'USACO', '强连通分量', 'Tarjan']
---
# [USACO06JAN] The Cow Prom S
## 题目描述

有一个 $n$ 个点，$m$ 条边的有向图，请求出这个图点数大于 $1$ 的强连通分量个数。
## 输入格式

第一行为两个整数 $n$ 和 $m$。

第二行至 $m+1$ 行，每一行有两个整数 $a$ 和 $b$，表示有一条从 $a$ 到 $b$ 的有向边。
## 输出格式

仅一行，表示点数大于 $1$ 的强连通分量个数。
## 样例

### 样例输入 #1
```
5 4
2 4
3 5
1 2
4 1
```
### 样例输出 #1
```
1
```
## 提示

#### 数据规模与约定

对于全部的测试点，保证 $2\le n \le 10^4$，$2\le m\le 5\times 10^4$，$1 \leq a, b \leq n$。


---

---
title: "[USACO06NOV] Big Square S"
layout: "post"
diff: 普及+/提高
pid: P2867
tag: ['动态规划 DP', '2006', 'USACO', '枚举', '深度优先搜索 DFS']
---
# [USACO06NOV] Big Square S
## 题目背景

[English version](https://www.luogu.com.cn/paste/x781adew)
## 题目描述

农民 John 的牛参加了一次和农民 Bob 的牛的竞赛。他们在区域中画了一个$N\times N$ 的正方形点阵，两个农场的牛各自占据了一些点。当然不能有两头牛处于同一个点。农场的目标是用自己的牛作为$4$个顶点，形成一个面积最大的正方形 （不必须和边界平行） 。 除了 Bessie 以外，John其他的牛都已经放到点阵中去了，要确定Bessie放在哪个位置，能使得John的农场得到一个最大的正方形(Bessie不是必须参与作为正方形的四个顶点之一)。
## 输入格式

第 $1$ 行：一个单独的整数，$N$（$2 \leq N \leq 100$）。

第 $2 \sim (N-1)$ 行：第 $i-1$ 行使用 $N$ 个字符描述区域的第 $i$ 行。其中，`J`代表此点被 John 的牛占据，`B` 代表此点被 Bob 的牛占据，而 `*` 代表一个未被占据的点。输入保证至少有一个未被占据的点。
## 输出格式

输出一个整数，表示John的农场所能达到的最大面积。如果无法形成正方形，则输出 $0$。
## 样例

### 样例输入 #1
```
6
J*J***
******
J***J*
******
**B***
******
```
### 样例输出 #1
```
4
```


---

---
title: "[USACO07JAN] Tallest Cow S"
layout: "post"
diff: 普及+/提高
pid: P2879
tag: ['模拟', '2007', 'USACO', '哈希 hashing', '前缀和']
---
# [USACO07JAN] Tallest Cow S
## 题目描述

FJ's N (1 ≤ N ≤ 10,000) cows conveniently indexed 1..N are standing in a line. Each cow has a positive integer height (which is a bit of secret). You are told only the height H (1 ≤ H ≤ 1,000,000) of the tallest cow along with the index I of that cow.

FJ has made a list of R (0 ≤ R ≤ 10,000) lines of the form "cow 17 sees cow 34". This means that cow 34 is at least as tall as cow 17, and that every cow between 17 and 34 has a height that is strictly smaller than that of cow 17.

For each cow from 1..N, determine its maximum possible height, such that all of the information given is still correct. It is guaranteed that it is possible to satisfy all the constraints.


## 输入格式

Line 1: Four space-separated integers: N, I, H and R


Lines 2..R+1: Two distinct space-separated integers A and B (1 ≤ A, B ≤ N), indicating that cow A can see cow B.

## 输出格式

Lines 1..N: Line i contains the maximum possible height of cow i.

## 样例

### 样例输入 #1
```
9 3 5 5
1 3
5 3
4 3
3 7
9 8
```
### 样例输出 #1
```
5
4
5
3
4
4
5
5
5
```
## 题目翻译

**【题目描述】**

FarmerJohn 有n头牛，它们按顺序排成一列。FarmerJohn 只知道其中最高的奶牛的序号及它的高度，其他奶牛的高度都是未知的。现在 FarmerJohn 手上有 $R$ 条信息，每条信息上有两头奶牛的序号（$a$ 和 $b$），其中 $b$ 奶牛的高度一定大于等于 $a$ 奶牛的高度，且 $a, b$之间的所有奶牛的高度都比 $a$ 小。现在 FarmerJohn 想让你根据这些信息求出每一头奶牛的可能的最大的高度。（数据保证有解）

**【输入格式】**

第一行：四个以空格分隔的整数：$n, i, h, R$（$n$ 和 $R$ 意义见题面；$i$ 和 $h$ 表示第 $i$ 头牛的高度为 $h$，他是最高的奶牛）

接下来 $R$ 行：两个不同的整数 $a$ 和 $b$（$1 \le a, b \le n$）

**【输出格式】**

一共 $n$ 行，表示每头奶牛的最大可能高度.

**【数据范围】**

$1 \le n \le 10000$，$1 \le h \le 1000000$，$0 \le R \le 10000$

Translate provided by @酥皮


---

---
title: "[USACO07MAR] Ranking the Cows G"
layout: "post"
diff: 普及+/提高
pid: P2881
tag: ['2007', 'USACO']
---
# [USACO07MAR] Ranking the Cows G
## 题目描述

Each of Farmer John's N cows (1 ≤ N ≤ 1,000) produces milk at a different positive rate, and FJ would like to order his cows according to these rates from the fastest milk producer to the slowest.

FJ has already compared the milk output rate for M (1 ≤ M ≤ 10,000) pairs of cows. He wants to make a list of C additional pairs of cows such that, if he now compares those C pairs, he will definitely be able to deduce the correct ordering of all N cows. Please help him determine the minimum value of C for which such a list is possible.

FJ想按照奶牛产奶的能力给她们排序。现在已知有N头奶牛（1 ≤ N ≤ 1,000）。FJ通过比较，已经知道了M（1 ≤ M ≤ 10,000）对相对关系。每一对关系表示为“X Y”，意指X的产奶能力强于Y。现在FJ想要知道，他至少还要调查多少对关系才能完成整个排序。

## 输入格式

Line 1: Two space-separated integers: N and M


Lines 2..M+1: Two space-separated integers, respectively: X and Y. Both X and Y are in the range 1...N and describe a comparison where cow X was ranked higher than cow Y.

## 输出格式

Line 1: A single integer that is the minimum value of C.

## 样例

### 样例输入 #1
```
5 5
2 1
1 5
2 3
1 4
3 4
```
### 样例输出 #1
```
3
```
## 提示

From the information in the 5 test results, Farmer John knows that since cow 2 > cow 1 > cow 5 and cow 2 > cow 3 > cow 4, cow 2 has the highest rank. However, he needs to know whether cow 1 > cow 3 to determine the cow with the second highest rank. Also, he will need one more question to determine the ordering between cow 4 and cow 5. After that, he will need to know if cow 5 > cow 3 if cow 1 has higher rank than cow 3. He will have to ask three questions in order to be sure he has the rankings: "Is cow 1 > cow 3?  Is cow 4 > cow 5? Is cow 5 > cow 3?"



---

---
title: "[USACO07MAR] Face The Right Way G"
layout: "post"
diff: 普及+/提高
pid: P2882
tag: ['贪心', '2007', 'USACO', '枚举']
---
# [USACO07MAR] Face The Right Way G
## 题目描述

Farmer John has arranged his N (1 ≤ N ≤ 5,000) cows in a row and many of them are facing forward, like good cows. Some of them are facing backward, though, and he needs them all to face forward to make his life perfect.

Fortunately, FJ recently bought an automatic cow turning machine. Since he purchased the discount model, it must be irrevocably preset to turn K (1 ≤ K ≤ N) cows at once, and it can only turn cows that are all standing next to each other in line. Each time the machine is used, it reverses the facing direction of a contiguous group of K cows in the line (one cannot use it on fewer than K cows, e.g., at the either end of the line of cows). Each cow remains in the same \*location\* as before, but ends up facing the \*opposite direction\*. A cow that starts out facing forward will be turned backward by the machine and vice-versa.

Because FJ must pick a single, never-changing value of K, please help him determine the minimum value of K that minimizes the number of operations required by the machine to make all the cows face forward. Also determine M, the minimum number of machine operations required to get all the cows facing forward using that value of K.

$N$ 头牛排成一列 $1 \le N \le 5000$。每头牛或者向前或者向后。为了让所有牛都面向前方，农夫每次可以将 $K$ 头连续的牛转向 $1 \le K \le N$，求使操作次数最小的相应 $K$ 和最小的操作次数 $M$。$F$ 为朝前，$B$ 为朝后。

请在一行输出两个数字 $K$ 和 $M$，用空格分开。
## 输入格式

Line 1: A single integer: N


Lines 2..N+1: Line i+1 contains a single character, F or B, indicating whether cow i is facing forward or backward.

## 输出格式

Line 1: Two space-separated integers: K and M

## 样例

### 样例输入 #1
```
7
B
B
F
B
F
B
B
```
### 样例输出 #1
```
3 3
```
## 提示

For K = 3, the machine must be operated three times: turn cows (1,2,3), (3,4,5), and finally (5,6,7)



---

---
title: "[USACO08OCT] Power Failure G"
layout: "post"
diff: 普及+/提高
pid: P2914
tag: ['2008', 'USACO']
---
# [USACO08OCT] Power Failure G
## 题目描述

A vicious thunderstorm has destroyed some of the wires of the farm's electrical power grid! Farmer John has a map of all $N$ ($2\le N \le 1000$) of the powerpoles, which are conveniently numbered $1\ldots N$ and located on integer plane coordinates $(x_i,y_i)$ ($-100000 \le x_i \le 100000, -100000 \le y_i \le 100000$).

Some $W$ ($1 \le W \le 10000$) power wires connect pairs of power poles $P_i$ and $P_j$ ($1 \le Pi \le N, 1 \le Pj \le N$).

He needs to get power from pole $1$ to pole $N$ (which means that some series of wires can traverse from pole $1$ to pole $N$, probably through some intermediate set of poles).

Given the locations of the $N$ poles and the list of remaining power wires, determine the minimum length of power wire required to restore the electrical connection so that electricity can flow from pole $1$ to pole $N$.  No wire can be longer than some real number $M$ ($0.0 < M \le 200000.0$).

As an example, below on the left is a map of the $9$ poles and $3$ wires after the storm. For this task, $M = 2.0$. The best set of wires to add would connect poles $4$ and $6$ and also poles $6$ and $9$.

```cpp
   After the storm              Optimally reconnected
3  . . . 7 9 . . . . .          3  . . . 7 9 . . . . .
                                          /
2  . . 5 6 . . . . . .          2  . . 5 6 . . . . . .
                                        /
1  2-3-4 . 8 . . . . .          1  2-3-4 . 8 . . . . .
   |                               |
0  1 . . . . . . . . .          0  1 . . . . . . . . .

   0 1 2 3 4 5 6 7 8 9             0 1 2 3 4 5 6 7 8 9
```

The total length is then $1.414213562 + 1.414213562 = 2.828427124$.

POINTS: 350

## 输入格式

Line $1$: Two space-separated integers: $N$ and $W$.

Line $2$: A single real number: $M$.

Lines $3\ldots N+2$: Each line contains two space-separated integers: $x_i$ and $y_i$.

Lines $N+3\ldots N+2+W$: Two space-separated integers: $P_i$ and $P_j$.

## 输出格式

Line 1: A single integer on a single line. If restoring connection is impossible, output `-1`. Otherwise, output a single integer that is $1000$ times the total minimum cost to restoreelectricity. Do not perform any rounding; truncate the resulting product.

## 样例

### 样例输入 #1
```
9 3 
2.0 
0 0 
0 1 
1 1 
2 1 
2 2 
3 2 
3 3 
4 1 
4 3 
1 2 
2 3 
3 4 

```
### 样例输出 #1
```
2828 

```
## 提示

Just as in the diagram above.


As above.

## 题目翻译

一场邪恶的暴风雨毁坏了农夫约翰的输电网中的一些电线！农夫约翰有一张包含了所有 $n$（$2\le n\le 1000$）个电能中转点的地图，中转点编号为 $1\ldots n$，第 $i$ 个点的坐标为 $(x_i,y_i)$（$-100000\le x_i\le 100000,-100000\le y_i\le 100000$）。

有 $w$（$1<=w<=10000$）条电线仍然保存着没被暴风雨破坏，每条电线连接着两个电能中转点 $p_i,p_j$（$1\le p_i\le n,1\le p_j\le n$）。

他希望从第一个电能中转点把电导入第 $n$ 个（可能通过一些中间的电能中转点，应当有一组电线连接 $1$ 和 $n$ ）。

给出 $n$ 个电能中转点的坐标和幸存的电线，请确定最少需要架设的电线总长度，但请注意，架设过程中，对于单条电线而言，其长度不应超过$m$（$0.0\le m\le 200000.0$）

给出一个例子，在下面，左边是一个包含 $9$ 个电能中转电和 $3$ 条幸存电线的地图。在这个任务中，规定 $m=2.0$。最佳的架设方案是连接 $6$ 和 $4$，以及 $6$ 和 $9$。

```plain
   After the storm              Optimally reconnected
3  . . . 7 9 . . . . .          3  . . . 7 9 . . . . .
                                          /
2  . . 5 6 . . . . . .          2  . . 5 6 . . . . . .
                                        /
1  2-3-4 . 8 . . . . .          1  2-3-4 . 8 . . . . .
   |                               |
0  1 . . . . . . . . .          0  1 . . . . . . . . .

   0 1 2 3 4 5 6 7 8 9             0 1 2 3 4 5 6 7 8 9
```
总长度是 $1.414213562 + 1.414213562 = 2.828427124$。



---

---
title: "[USACO08NOV] Guarding the Farm S"
layout: "post"
diff: 普及+/提高
pid: P2919
tag: ['搜索', '2008', 'USACO', '深度优先搜索 DFS']
---
# [USACO08NOV] Guarding the Farm S
## 题目描述

The farm has many hills upon which Farmer John would like to place guards to ensure the safety of his valuable milk-cows.

He wonders how many guards he will need if he wishes to put one on top of each hill. He has a map supplied as a matrix of integers; the matrix has N (1 < N <= 700) rows and M (1 < M <= 700) columns. Each member of the matrix is an altitude H\_ij (0 <= H\_ij <= 10,000). Help him determine the number of hilltops on the map.

A hilltop is one or more adjacent matrix elements of the same value surrounded exclusively by either the edge of the map or elements with a lower (smaller) altitude. Two different elements are adjacent if the magnitude of difference in their X coordinates is no greater than 1 and the magnitude of differences in their Y coordinates is also no greater than 1.

## 输入格式

\* Line 1: Two space-separated integers: N and M

\* Lines 2..N+1: Line i+1 describes row i of the matrix with M

space-separated integers: H\_ij

## 输出格式

\* Line 1: A single integer that specifies the number of hilltops

## 样例

### 样例输入 #1
```
8 7 
4 3 2 2 1 0 1 
3 3 3 2 1 0 1 
2 2 2 2 1 0 0 
2 1 1 1 1 0 0 
1 1 0 0 0 1 0 
0 0 0 1 1 1 0 
0 1 2 2 1 1 0 
0 1 1 1 2 1 0 

```
### 样例输出 #1
```
3 

```
## 提示

There are three peaks: The one with height 4 on the left top, one of the points with height 2 at the bottom part, and one of the points with height 1 on the right top corner.

## 题目翻译

农夫 John 的农场里有很多小山丘，他想要在那里布置一些保镖去保卫他的那些相当值钱的奶牛们。

他想知道如果在一座小山丘上布置一名保镖的话，他最少总共需要招聘多少名保镖。他现在手头有一个用数字矩阵来表示地形的地图。这个矩阵有 $N$ 行和 $M$ 列。矩阵中的每个元素都有一个值 $H_{ij}$ 来表示该地区的海拔高度。

小山丘的定义是：若地图中一个元素所邻接的所有元素都小于等于这个元素的高度（或它邻接的是地图的边界），则该元素和其周围所有按照这样顺序排列的元素的集合称为一个小山丘。这里邻接的意义是：若一个位置的横纵坐标与另一个位置的横纵坐标相差不超过 $1$，则称这两个元素邻接，比如某个非边界点的位置有 $8$ 个相邻点：上、下、左、右、左上、右上、左下、右下。

请你帮助他统计出地图上最少且尽量高的小山丘数量。


---

---
title: "[USACO08DEC] Trick or Treat on the Farm G"
layout: "post"
diff: 普及+/提高
pid: P2921
tag: ['动态规划 DP', '搜索', '2008', 'USACO', '记忆化搜索']
---
# [USACO08DEC] Trick or Treat on the Farm G
## 题目描述

Every year in Wisconsin the cows celebrate the USA autumn holiday of Halloween by dressing up in costumes and collecting candy that Farmer John leaves in the N (1 <= N <= 100,000) stalls conveniently numbered 1..N.

Because the barn is not so large, FJ makes sure the cows extend their fun by specifying a traversal route the cows must follow.  To implement this scheme for traveling back and forth through the barn, FJ has posted a 'next stall number' next\_i (1 <= next\_i <= N) on stall i that tells the cows which stall to visit next; the cows thus might travel the length of the barn many times in order to collect their candy.

FJ mandates that cow i should start collecting candy at stall i. A cow stops her candy collection if she arrives back at any stall she has already visited.

Calculate the number of unique stalls each cow visits before being forced to stop her candy collection.

POINTS: 100
## 输入格式

\* Line 1: A single integer: N

\* Lines 2..N+1: Line i+1 contains a single integer: next\_i

## 输出格式

\* Lines 1..N: Line i contains a single integer that is the total number of unique stalls visited by cow i before she returns to a stall  she has previously visited.

## 样例

### 样例输入 #1
```
4 
1 
3 
2 
3 

```
### 样例输出 #1
```
1 
2 
2 
3 

```
## 提示

Four stalls.

\* Stall 1 directs the cow back to stall 1.

\* Stall 2 directs the cow to stall 3

\* Stall 3 directs the cow to stall 2

\* Stall 4 directs the cow to stall 3


Cow 1:  Start at 1, next is 1.  Total stalls visited: 1.

Cow 2:  Start at 2, next is 3, next is 2.  Total stalls visited: 2. Cow 3:  Start at 3, next is 2, next is 3.  Total stalls visited: 2. Cow 4:  Start at 4, next is 3, next is 2, next is 3. Total stalls visited: 3.

## 题目翻译

#### 题目描述

每年，在威斯康星州，奶牛们都会穿上衣服，收集农夫约翰在 $N(1\le N\le 100,000)$ 个牛棚隔间中留下的糖果，以此来庆祝美国秋天的万圣节。

由于牛棚不太大，FJ 通过指定奶牛必须遵循的穿越路线来确保奶牛的乐趣。为了实现这个让奶牛在牛棚里来回穿梭的方案，FJ 在第 $i$ 号隔间上张贴了一个 “下一个隔间：$next_i(1\le next_i\le N)$” 的标语，告诉奶牛要去的下一个隔间。这样，为了收集它们的糖果，奶牛就会在牛棚里来回穿梭了。

FJ 命令奶牛 $i$ 应该从 $i$ 号隔间开始收集糖果。如果一只奶牛回到某一个她已经去过的隔间，她就会停止收集糖果。

在被迫停止收集糖果之前，计算一下每头奶牛要前往的隔间数（包含起点）。

#### 输入格式

第一行一个整数 $n$，表示牛棚隔间的数量。

第 $2$ 至 $n+1$ 行，每行包含一个整数 $next_i$，表示 $i$ 号隔间的下一个隔间。

#### 输出格式

输出共 $n$ 行，第 $i$ 行包含一个整数，表示第 $i$ 只奶牛要前往的隔间数。

#### 样例解释

有 $4$ 个隔间。

- 隔间 $1$ 要求牛到隔间 $1$，

- 隔间 $2$ 要求牛到隔间 $3$，

- 隔间 $3$ 要求牛到隔间 $2$，

- 隔间 $4$ 要求牛到隔间 $3$。

牛 $1$：从 $1\rightarrow 1$，总共访问 $1$ 个隔间；

牛 $2$：$2\rightarrow 3\rightarrow 2$，总共访问 $2$ 个隔间；

牛 $3$：$3\rightarrow 2\rightarrow 3$，总共访问 $2$ 个隔间；

牛 $4$：$4\rightarrow 3\rightarrow 2\rightarrow 3$，总共访问 $3$ 个隔间。

翻译提供者：[busy_programmer](https://www.luogu.com.cn/user/649315)。


---

---
title: "[USACO08DEC] Secret Message G"
layout: "post"
diff: 普及+/提高
pid: P2922
tag: ['2008', 'USACO', '进制', '字典树 Trie']
---
# [USACO08DEC] Secret Message G
## 题目描述

Bessie is leading the cows in an attempt to escape! To do this, the cows are sending secret binary messages to each other.

Ever the clever counterspy, Farmer John has intercepted the first $b_i$ ($1 \le b_i \le 10,000$) bits of each of $M$ ($1 \le M \le 50,000$) of these secret binary messages.

He has compiled a list of $N$ ($1 \le N \le 50,000$) partial codewords that he thinks the cows are using. Sadly, he only knows the first $c_j$ ($1 \le c_j \le 10,000$) bits of codeword $j$.

For each codeword $j$, he wants to know how many of the intercepted messages match that codeword (i.e., for codeword $j$, how many times does a message and the codeword have the same initial bits). Your job is to compute this number.

The total number of bits in the input (i.e., the sum of the $b_i$ and the $c_j$) will not exceed  $500,000$.

贝茜正在领导奶牛们逃跑．为了联络，奶牛们互相发送秘密信息．

信息是二进制的，共有 $M$（$1 \le M \le 50000$）条，反间谍能力很强的约翰已经部分拦截了这些信息，知道了第  $i$ 条二进制信息的前 $b_i$（$1 \le b_i \le 10000$）位，他同时知道，奶牛使用 $N$（$1 \le N \le 50000$）条暗号．但是，他仅仅知道第 $j$ 条暗号的前 $c_j$（$1 \le c_j \le 10000$）位。

对于每条暗号 $j$，他想知道有多少截得的信息能够和它匹配。也就是说，有多少信息和这条暗号有着相同的前缀。当然，这个前缀长度必须等于暗号和那条信息长度的较小者。

在输入文件中，位的总数（即 $\sum b_i + \sum c_i$）不会超过 $500000$。
## 输入格式

Line $1$: Two integers: $M$ and $N$.

Lines $2 \ldots M+1$: Line $i+1$ describes intercepted code $i$ with an integer $b_i$ followed by $b_i$ space-separated `0`'s and `1`'s.

Lines $M+2 \ldots M+N+1$: Line $M+j+1$ describes codeword $j$ with an integer $c_j$ followed by $c_j$ space-separated `0`'s and `1`'s.
## 输出格式

Lines $1 \ldots N$: Line $j$: The number of messages that the $j$-th codeword could match.
## 样例

### 样例输入 #1
```
4 5 
3 0 1 0 
1 1 
3 1 0 0 
3 1 1 0 
1 0 
1 1 
2 0 1 
5 0 1 0 0 1 
2 1 1 

```
### 样例输出 #1
```
1 
3 
1 
1 
2 

```
## 提示

Four messages; five codewords. 

The intercepted messages start with 010, 1, 100, and 110.

The possible codewords start with 0, 1, 01, 01001, and 11.


0 matches only 010: 1 match

1 matches 1, 100, and 110: 3 matches

01 matches only 010: 1 match

01001 matches 010: 1 match

11 matches 1 and 110: 2 matches



---

---
title: "[USACO08DEC] Jigsaw Puzzles S"
layout: "post"
diff: 普及+/提高
pid: P2927
tag: ['2008', 'USACO']
---
# [USACO08DEC] Jigsaw Puzzles S
## 题目描述

The cows have taken up alphabetical jigsaw puzzles. In these puzzles with R (1 <= R <= 10) rows and C (1 <= C <= 10) columns, the edges are not funny-shaped cardboard shapes but rather are letters.

Each piece has a serial number and 4 letters (or borders) that must be aligned as in a regular jigsaw puzzle. The pseudo-letter '0' (the digit 0) will represent a border (and a piece can have several borders if it is a corner piece or even the top of column in a, e.g., 4x1 puzzle).  Below is a set of six pieces (the borders are marked with lines instead of '0's) assembled in one way (of many) that completes the puzzle:

+---+  +---+  +---+

| 1 c  c 3 d  d 5 | 
+-d-+  + a +  +-e-+

+-d-+  +-a-+  +-e-+

| 2 b  b 4 b  b 6 | 
+---+  +---+  +---+

Note that each edge letter of each piece matches the border letter of the piece adjacent to it; the borders appear properly on the top, bottom, and sides.

Pieces are represented by a serial number and a clockwise list of their four edges (where edges are the letters a..z and 0). Pieces might require rotation when placed in the puzzle.

Given a set of pieces, find at least one way to assemble them into a puzzle. Test data for puzzles with larger R and C are easier to solve because they have a more varied set of edge letters.

奶牛们在玩按字母表顺序排列的拼图谜题.每道谜题有R(1≤R≤10)列C(1≤C≤10)行的拼图块,它们边缘是由字母或封闭边界组成,完成后的整副拼图外围是边界线,中间的边界是字母.

每块拼图块都有一个序列号和4个字母或者数字表示边界线(顺序为上右下左),在输入中,数字充当边界线.

拼图可以换位和旋转,完成后的拼图在边缘的块上靠近外围的是边界线,拼图完成后,一块拼图若与另一块相邻,它们的边界字母必须相同,以下是一系列已经成功完成的拼图谜题共6块.

## 输入格式

\* Line 1: Two space-separated integers: R and C

\* Lines 2..R\*C+1: Each line contains five space-separated entities: an integer serial number and four edge identifiers

## 输出格式

\* Lines 1..R\*C: Line R\*(i-1)+j describes the puzzle piece placed a row i, column j with an integer and five space-separated entities: the serial number of the puzzle piece and the four piece edge identifiers in the order top, right, bottom, left.

## 样例

### 样例输入 #1
```
2 3 
1 c d 0 0 
2 0 d b 0 
3 c 0 d a 
4 b a b 0 
5 d 0 0 e 
6 0 0 b e 

```
### 样例输出 #1
```
1 0 c d 0 
3 0 d a c 
5 0 0 e d 
2 d b 0 0 
4 a b 0 b 
6 e 0 0 b 

```
## 提示

Describes the input puzzle although with some of the pieces rotated compared to the sample solution.


As shown in the diagram in the task text. Other solutions (like reflections) are possible; a grading program will check your answer.



---

---
title: "[USACO09JAN] Laserphones S"
layout: "post"
diff: 普及+/提高
pid: P2937
tag: ['2009', 'USACO', '并查集', '广度优先搜索 BFS', '深度优先搜索 DFS', '最短路', '最近公共祖先 LCA']
---
# [USACO09JAN] Laserphones S
## 题目描述

The cows have a new laser-based system so they can have casual conversations while out in the pasture which is modeled as a W x H grid of points (1 <= W <= 100; 1 <= H <= 100).

The system requires a sort of line-of-sight connectivity in order to sustain communication. The pasture, of course, has rocks and trees that disrupt the communication but the cows have purchased diagonal mirrors ('/' and '\' below) that deflect the laser beam through a 90 degree turn. Below is a map that illustrates the

problem.

H is 8 and W is 7 for this map.  The two communicating cows are notated as 'C's; rocks and other blocking elements are notated as '\*'s:

```plain
7 . . . . . . .         7 . . . . . . . 
6 . . . . . . C         6 . . . . . /-C 
5 . . . . . . *         5 . . . . . | * 
4 * * * * * . *         4 * * * * * | * 
3 . . . . * . .         3 . . . . * | . 
2 . . . . * . .         2 . . . . * | . 
1 . C . . * . .         1 . C . . * | . 
0 . . . . . . .         0 . \-------/ . 
0 1 2 3 4 5 6           0 1 2 3 4 5 6 
```
Determine the minimum number of mirrors M that must be installed to maintain laser communication between the two cows, a feat which is always possible in the given test data.

## 输入格式

\* Line 1: Two space separated integers: W and H

\* Lines 2..H+1: The entire pasture.

## 输出格式

\* Line 1: A single integer: M

## 样例

### 样例输入 #1
```
7 8 
....... 
......C 
......* 
*****.* 
....*.. 
....*.. 
.C..*.. 
....... 

```
### 样例输出 #1
```
3 

```
## 题目翻译

奶牛们都改用激光进行通讯了。

在 $W\times H$ 的牧场上，一些地方有树木和石头遮挡激光，所以，奶牛打算使用对角镜来进行激光通讯。两只奶牛的位置是固定的，对角镜能把光线旋转 $90$ 度。

下图是一个例子：

```plain
7 . . . . . . .         7 . . . . . . . 
6 . . . . . . C         6 . . . . . /-C 
5 . . . . . . *         5 . . . . . | * 
4 * * * * * . *         4 * * * * * | * 
3 . . . . * . .         3 . . . . * | . 
2 . . . . * . .         2 . . . . * | . 
1 . C . . * . .         1 . C . . * | . 
0 . . . . . . .         0 . \-------/ . 
0 1 2 3 4 5 6           0 1 2 3 4 5 6 
```

其中 $\verb!*!$ 表示障碍物，$\verb!C!$ 表示奶牛，$\verb!/!$ 和 $\verb!\!$ 表示两种对角镜。

请求出最少需要安装的对角镜的数量，使得两只奶牛可以通讯。


---

---
title: "[USACO09FEB] Stock Market G"
layout: "post"
diff: 普及+/提高
pid: P2938
tag: ['2009', 'USACO', '背包 DP', '最短路', '排列组合']
---
# [USACO09FEB] Stock Market G
## 题目描述

Despite their innate prudence, the cows took a beating in the home mortgage market and now are trying their hand at stocks. Happily, Bessie is prescient and knows not only today's S (2 <= S <= 50) stock prices but also the future stock prices for a total of D days (2 <= D <= 10).

Given the matrix of current and future stock prices on various days (1 <= PR\_sd <= 1,000) and an initial M (1 <= M <= 200,000) units of money, determine an optimal buying and selling strategy in order to maximize the gain realized by selling stock on the final day. Shares must be purchased in integer multiples, and you need not spend all the money (or any money). It is guaranteed that you will not be able to earn a profit of more than 500,000 units of money.

Consider the example below of a bull (i.e., improving) market, the kind Bessie likes most. In this case, S=2 stocks and D=3 days. The cows have 10 units of money to invest.

| Stock | Today's price | Tomorrow's price |    Two days hence Stock   |
| :---: | :-----------: | :--------------: | :--: |
|  $A$  |      10       |        15        |  15  |
|  $B$  |      13       |        11        |  20  |

If money is to be made, the cows must purchase stock 1 on day 1. Selling stock 1 on day 2 and quickly buying stock 2 yields 4 money in the bank and one share of 2. Selling stock 2 on the final day brings in 20 money for a total of 24 money when the 20 is added to the bank.

## 输入格式

\* Line 1: Three space-separated integers: S, D, and M

\* Lines 2..S+1: Line s+1 contains the D prices for stock s on days 1..D: PR\_sd

## 输出格式

\* Line 1: The maximum amount of money possible to have after selling on day D.

## 样例

### 样例输入 #1
```
2 3 10 
10 15 15 
13 11 20 

```
### 样例输出 #1
```
24 

```
## 题目翻译

# 题目描述

尽管奶牛天生谨慎，它们仍然在住房抵押信贷市场中大受打击，现在它们准备在股市上碰碰运气。贝西有内部消息，她知道 $S$ 只股票在今后 $D$ 天内的价格。

假设在一开始，她筹集了 $M$ 元钱，那么她该怎样操作才能赚到最多的钱呢？贝西在每天可以买卖多只股票，也可以多次买卖同一只股票，交易单位必须是整数，数量不限。举一个牛市的例子：

假设贝西有 $10$ 元本金，股票价格如下：

|  股票 | 今天的价格 | 明天的价格 | 后天的价格 |
| :-: | :---: | :---: | :---: |
| $A$ |   $10$  |   $15$  |   $15$  |
| $B$ |   $13$  |   $11$  |   $20$  |

最赚钱的做法是：今天买入 $A$ 股 $1$ 张，到明天把它卖掉并且买入 $B$ 股 $1$ 张，在后天卖掉 $B$ 股，这样贝西就有 $24$ 元了。

# 输入格式

第一行：三个整数 $S,D$ 和 $M$，$2\le S\le 50,2\le D\le 10,1\le M\le 200000$。

第二行到第 $S + 1$ 行：第 $i + 1$ 行有 $D$ 个整数：$P_{i,1}$ 到 $P_{i,D}$，表示第 $i$ 种股票在第一天到最后一天的售价，对所有 $1\le j\le D$，$1\le P_{i,j}\le 1000$。

# 输出格式

单个整数：表示奶牛可以获得的最大钱数，保证这个数不会超过 $500000$。


---

---
title: "[USACO09FEB] Revamping Trails G"
layout: "post"
diff: 普及+/提高
pid: P2939
tag: ['动态规划 DP', '2009', 'USACO', '最短路']
---
# [USACO09FEB] Revamping Trails G
## 题目描述

Farmer John dutifully checks on the cows every day. He traverses some of the M (1 <= M <= 50,000) trails conveniently numbered 1..M from pasture 1 all the way out to pasture N (a journey which is always possible for trail maps given in the test data). The N (1 <= N <= 10,000) pastures conveniently numbered 1..N on Farmer John's farm are currently connected by bidirectional dirt trails.  Each trail i connects pastures P1\_i and P2\_i (1 <= P1\_i <= N; 1 <= P2\_i <= N) and requires T\_i (1 <= T\_i <= 1,000,000) units of time to traverse.

He wants to revamp some of the trails on his farm to save time on his long journey. Specifically, he will choose K (1 <= K <= 20) trails to turn into highways, which will effectively reduce the trail's traversal time to 0. Help FJ decide which trails to revamp to minimize the resulting time of getting from pasture 1 to N.

TIME LIMIT: 2 seconds


## 输入格式

\* Line 1: Three space-separated integers: N, M, and K

\* Lines 2..M+1: Line i+1 describes trail i with three space-separated integers: P1\_i, P2\_i, and T\_i

## 输出格式

\* Line 1: The length of the shortest path after revamping no more than K edges

## 样例

### 样例输入 #1
```
4 4 1 
1 2 10 
2 4 10 
1 3 1 
3 4 100 

```
### 样例输出 #1
```
1 

```
## 提示

K is 1; revamp trail 3->4 to take time 0 instead of 100. The new shortest path is 1->3->4, total traversal time now 1.

## 题目翻译

约翰一共有 $N$ 个牧场.由 $M$ 条布满尘埃的小径连接。小径可以双向通行。每天早上约翰从牧场 $1$ 出发到牧场 $N$ 去给奶牛检查身体。

通过每条小径都需要消耗一定的时间。约翰打算升级其中 $K$ 条小径，使之成为高速公路。在高速公路上的通行几乎是瞬间完成的，所以高速公路的通行时间为 $0$。

请帮助约翰决定对哪些小径进行升级，使他每天从 $1$ 号牧场到第 $N$ 号牧场所花的时间最短。输出这一最短时间即可。


---

---
title: "[USACO09OPEN] Work Scheduling G"
layout: "post"
diff: 普及+/提高
pid: P2949
tag: ['贪心', '递推', '2009', 'USACO', '优先队列']
---
# [USACO09OPEN] Work Scheduling G
## 题目描述

Farmer John has so very many jobs to do! In order to run the farm efficiently, he must make money on the jobs he does, each one of which takes just one time unit.

His work day starts at time 0 and has 1,000,000,000 time units (!).  He currently can choose from any of N (1 <= N <= 100,000) jobs

conveniently numbered 1..N for work to do. It is possible but

extremely unlikely that he has time for all N jobs since he can only work on one job during any time unit and the deadlines tend to fall so that he can not perform all the tasks.

Job i has deadline D\_i (1 <= D\_i <= 1,000,000,000). If he finishes job i by then, he makes a profit of P\_i (1 <= P\_i <= 1,000,000,000).

What is the maximum total profit that FJ can earn from a given list of jobs and deadlines?  The answer might not fit into a 32-bit integer.



## 输入格式

\* Line 1: A single integer: N

\* Lines 2..N+1: Line i+1 contains two space-separated integers: D\_i and P\_i

## 输出格式

\* Line 1: A single number on a line by itself that is the maximum possible profit FJ can earn.

## 样例

### 样例输入 #1
```
3 
2 10 
1 5 
1 7 

```
### 样例输出 #1
```
17 

```
## 提示

Complete job 3 (1,7) at time 1 and complete job 1 (2,10) at time 2 to maximize the earnings (7 + 10 -> 17).

## 题目翻译

约翰有太多的工作要做。为了让农场高效运转，他必须靠他的工作赚钱，每项工作花一个单位时间。 他的工作日从 $0$ 时刻开始，有 $10^9$ 个单位时间。在任一时刻，他都可以选择编号 $1$ 到 $N$ 的 $N(1 \leq N \leq 10^5)$ 项工作中的任意一项工作来完成。 因为他在每个单位时间里只能做一个工作，而每项工作又有一个截止日期，所以他很难有时间完成所有N个工作，虽然还是有可能。 对于第 $i$ 个工作，有一个截止时间 $D_i(1 \leq D_i \leq 10^9)$，如果他可以完成这个工作，那么他可以获利 $P_i( 1\leq P_i\leq 10^9 )$. 在给定的工作利润和截止时间下，约翰能够获得的利润最大为多少.


---

---
title: "[USACO09OPEN] Cow Digit Game S"
layout: "post"
diff: 普及+/提高
pid: P2953
tag: ['模拟', '博弈论', '2009', 'USACO']
---
# [USACO09OPEN] Cow Digit Game S
## 题目描述

Bessie is playing a number game against Farmer John, and she wants you to help her achieve victory.

Game i starts with an integer N\_i (1 <= N\_i <= 1,000,000). Bessie goes first, and then the two players alternate turns. On each turn, a player can subtract either the largest digit or the smallest non-zero digit from the current number to obtain a new number. For example, from 3014 we may subtract either 1 or 4 to obtain either 3013 or 3010, respectively. The game continues until the number becomes 0, at which point the last player to have taken a turn is the winner.

Bessie and FJ play G (1 <= G <= 100) games. Determine, for each game, whether Bessie or FJ will win, assuming that both play perfectly (that is, on each turn, if the current player has a move that will guarantee his or her win, he or she will take it).

Consider a sample game where N\_i = 13. Bessie goes first and takes 3, leaving 10. FJ is forced to take 1, leaving 9. Bessie takes the remainder and wins the game.

贝茜和约翰在玩一个数字游戏．贝茜需要你帮助她．

游戏一共进行了G(1≤G≤100)场．第i场游戏开始于一个正整数Ni(l≤Ni≤1,000,000)．游

戏规则是这样的：双方轮流操作，将当前的数字减去一个数，这个数可以是当前数字的最大数码，也可以是最小的非0数码．比如当前的数是3014，操作者可以减去1变成3013，也可以减去4变成3010．若干次操作之后，这个数字会变成0．这时候不能再操作的一方为输家．    贝茜总是先开始操作．如果贝茜和约翰都足够聪明，执行最好的策略．请你计算最后的赢家．

比如，一场游戏开始于13.贝茜将13减去3变成10．约翰只能将10减去1变成9．贝茜再将9减去9变成0．最后贝茜赢．

## 输入格式

\* Line 1: A single integer: G

\* Lines 2..G+1: Line i+1 contains the single integer: N\_i

## 输出格式

\* Lines 1..G: Line i contains 'YES' if Bessie can win game i, and 'NO' otherwise.

## 样例

### 样例输入 #1
```
2 
9 
10 

```
### 样例输出 #1
```
YES 
NO 

```
## 提示

For the first game, Bessie simply takes the number 9 and wins. For the second game, Bessie must take 1 (since she cannot take 0), and then FJ can win by taking 9.



---

---
title: "[USACO09OPEN] Grazing2 S"
layout: "post"
diff: 普及+/提高
pid: P2954
tag: ['动态规划 DP', '递推', '2009', 'USACO', '单调队列']
---
# [USACO09OPEN] Grazing2 S
## 题目描述

Farmer John has N (2 <= N <= 1,500) prize milk cows conveniently numbered 1..N. His newly-painted barn has S (N <= S <= 1,000,000) stalls (conveniently numbered 1..S) in a single long line; each stall is a unit distance from its neighboring stall(s).

The cows have made their way to the stalls for a rest; cow i is in stall P\_i. Antisocial as they are, the cows get grumpy if they are situated in stalls very close to each other, so Farmer John wants to move the cows to be as spread out as possible.

FJ wants to make sure that the N - 1 distances between adjacent cows are as large as possible, and he would also like them to be similar to each other (i.e., close to equi-distant spacing).

In particular, FJ would like all distances between adjacent cows to be at most 1 different from (S - 1) / (N - 1), where integer division is used. Moreover, he would like as many of these distances as possible to be exactly equal to (S - 1) / (N - 1) [integer

division]. Thus, with four cows and eight stalls, one can place the cows at positions 1, 3, 5, 8 or 1, 3, 6, 8 but not at 1, 2, 4, 7 or 1, 2, 4, 8.

Help FJ spread the cows as efficiently as possible by calculating and reporting the minimum total distance that the cows have to move in order to achieve proper spacing. Ignore the distance it takes for a cow to enter or exit a stall.

约翰有N(2≤N≤1500)头奶牛，S(N≤S≤1,000,000)个一字排开的牛棚．相邻牛棚间的距离恰好为1．

奶牛们已经回棚休息，第i只奶牛现在待在牛棚Pi．如果两只奶牛离得太近，会让奶牛们变得很暴躁．所以约翰想给一些奶牛换一个棚，让她们之间的距离变得尽量大，并且尽管接近．令d=Trunc((s-1)/(n-1))

所以约翰希望最终的奶牛的状态是：两只相邻奶牛间的距离与d之差不超过1，而且让尽量多的间距等于d．因此，对于4只奶牛8个棚的情况，1，3，5，8或1，3，6，8这样的安置情况是允许的，而1，2，4，7或1，2，4，8这样的情况是不允许的．    帮助约翰移动奶牛，让所有奶牛的移动距离之和最小，同时让最终的安置情况符合约翰心意．

## 输入格式

\* Line 1: Two space-separated integers: N and S

\* Lines 2..N+1: Line i+1 contains the single integer: P\_i

## 输出格式

\* Line 1: A single integer: the minimum total distance the cows have to travel. This number is guaranteed to be under 1,000,000,000 (thus fitting easily into a signed 32-bit integer).

## 样例

### 样例输入 #1
```
5 10 
2 
8 
1 
3 
9 

```
### 样例输出 #1
```
4 

```
## 提示

1   2   3   4   5   6   7   8   9  10

Cow Locs     | A | B | C | . | . | . | . | D | E | . | 

Cows move from stall 2 to 3, 3 to 5, and 9 to 10. The total distance moved is 1 + 2 + 1 = 4. The final positions of the cows are in stalls 1, 3, 5, 8, and 10.

1   2   3   4   5   6   7   8   9  10

Init Stall     | A | B | C | . | . | . | . | D | E | . | 
Final Stall    | A | . | B | . | C | . | . | D | . | E | 
Distance moved | 0 | . | 1 | . | 2 | . | . | 0 | . | 1 | 


---

---
title: "[USACO09NOV] Cow Rescue G"
layout: "post"
diff: 普及+/提高
pid: P2963
tag: ['贪心', '2009', 'USACO']
---
# [USACO09NOV] Cow Rescue G
## 题目描述

Bessie is trapped in a triangular maze with N rows (1 <= N <= 1,000,000). A three row maze is shown below:

The i'th row of the maze contains 2\*i-1 triangles. Numbering from the left, the triangles are named (i,1), (i,2), and so on.

Bessie can travel to the (often three) triangles which share an edge with her current triangle. For example, if she is at (3, 3), she can travel to (3, 2), (3, 4) and (4, 4). Bessie takes one minute to travel from one triangle to the next.

FJ has learned the Bessie is trapped and knows by tracking her iPhone that she starts her exit trek at triangle (Si,Sj). FJ's love for Bessie knows no bounds so he wants her back in the minimum possible time.

The maze has M (1 <= M <= 10,000) exits found in locations throughout the set of triangles. Any one of these will enable Bessie to escape. Once she enters an exit triangle, she leaves the maze in just one more minute.

Find the minimum time in minutes, T, required for Bessie to exit the maze and report the optimal exit location she uses, (OUTi, OUTj). If more than one location requires only T minutes, output the location with the smallest row. If two optimal rows are the same, output the one with smaller column.

贝希被困在一个三角形的迷宫之中。这个迷宫有 $N$ 行（$1 \le N \le 1000000$）。比如下图是一个 $3$ 行的迷宫。  迷宫的第 $i$ 行有 $2i-1$ 个三角形，从左到右分别编号为 $(i, 1)$、$(i, 2)$ 等等。

贝希每次可以从一个三角形走到任意一个一个跟当前的三角形有邻边的三角形。

比如说，如果她目前处于三角形 $(3, 3)$，那么，她可以走到三角形 $(3, 2)$、$(3, 4)$ 和 $(4, 4)$。贝希每次需要一分钟的时间来移动到下一个三角形。

农夫约翰发现贝希被困了！于是她跟踪贝希的iPhone手机（可怜的触摸屏～），得知贝希目前处于三角形 $(S_i, S_j)$。

因为约翰对贝希有著无穷无尽的浓浓爱意，所以他希望贝希能尽可能快地回到他的身边。 在迷宫的三角形之中，有 $M$（$1 \le M \le 10000$）个是出口。在任何一个出口都可以让贝希逃离迷宫。一旦贝希进入一个作为出口的三角形，她用多一分钟就可以逃离这个迷宫。 找到一个可以让贝希逃离迷宫最小时间 $T$，并输出她应该从哪一个出口逃离迷宫，这个出口记为 $(\text{OUT}_i, \text{OUT}_j)$。

如果有多个出口同时需要时间 $T$，输出那个行的编号小的出口，如果仍然有多个出口，输出那个列的编号小的。

## 输入格式

\* Line 1: Two space-separated integers: N and M

\* Line 2: Two space-separated integers: Si and Sj

\* Lines 3..M+2: Line i+2 contains two space-separated integers that are the triangle location of exit i: Ei and Ej

## 输出格式

\* Line 1: Two space-separated integers: OUTi and OUTj

\* Line 2: A single integer: T

## 样例

### 样例输入 #1
```
4 2 
2 1 
3 5 
4 4 

```
### 样例输出 #1
```
4 4 
4 

```


---

---
title: "[USACO09DEC] Bobsledding S"
layout: "post"
diff: 普及+/提高
pid: P2968
tag: ['2009', 'USACO']
---
# [USACO09DEC] Bobsledding S
## 题目描述

Bessie has entered a bobsled competition because she hopes her hefty weight will give her an advantage over the L meter course (2 <= L <= 1,000,000,000).

Bessie will push off the starting line at 1 meter per second, but her speed can change while she rides along the course. Near the middle of every meter Bessie travels, she can change her speed either by using gravity to accelerate by one meter per second or by braking to stay at the same speed or decrease her speed by one meter per second.

Naturally, Bessie must negotiate N (1 <= N <= 100,000) turns on the way down the hill. Turn i is located T\_i meters from the course start (1 <= T\_i <= L-1), and she must be enter the corner meter at a speed of at most S\_i meters per second (1 <= S\_i <= 1,000,000,000). Bessie can cross the finish line at any speed she likes.

Help Bessie learn the fastest speed she can attain without exceeding the speed limits on the turns.

Consider this course with the meter markers as integers and the turn speed limits in brackets (e.g., '[3]'):

```cpp

|   1   2   3   4   5   6   7[3]
|---+---+---+---+---+---+---+
|                            \
Start                         + 8    
                               \
                                + 9    
                                 \
                                  + 10       +++ 14 (finish)
                                   \         /
                              11[1] +---+---+
                                        12  13[8]
```
Below is a chart of Bessie's speeds at the beginning of each meter length of the course:

````
Max:                              3               1       8 
Mtrs: 0   1   2   3   4   5   6   7   8   9  10  11  12  13  14 Spd:  1   2   3   4   5   5   4   3   4   3   2   1   2   3   4 
```
Her maximum speed was 5 near the beginning of meter 4. 

贝茜从山顶滑雪到山脚，山顶到山脚距离是L(2<L<10^9)米.贝茜在起点的速度是1米每 秒，但是他的速度是可以改变的，在每一米的速度可以是前一米的速度加1、减1，或者等于前一米 的速度.在滑行的过程中，贝茜会遇到N<=100000)个转弯处，第i个转弯处位于距离出发 Ti米处，为了安全，贝茜到达第i个转弯处的速度不能超过Si(1<Si<10^9)米 每秒.当然贝茜到达终点时的速度没有最大限制.请你计算贝茜在滑雪过程中最大的速度可以是多 少？

## 输入格式

\* Line 1: Two space-separated integers: L and N

\* Lines 2..N+1: Line i+1 describes turn i with two space-separated integers: T\_i and S\_i

## 输出格式

\* Line 1: A single integer, representing the maximum speed which Bessie can attain between the start and the finish line, inclusive.

## 样例

### 样例输入 #1
```
14 3 
7 3 
11 1 
13 8 

```
### 样例输出 #1
```
5 

```


---

---
title: "[USACO10JAN] Cheese Towers S"
layout: "post"
diff: 普及+/提高
pid: P2979
tag: ['动态规划 DP', '2010', 'USACO', '枚举', '背包 DP']
---
# [USACO10JAN] Cheese Towers S
## 题目描述

Farmer John wants to save some blocks of his cows' delicious Wisconsin cheese varieties in his cellar for the coming winter. He has room for one tower of cheese in his cellar, and that tower's height can be at most T (1 <= T <= 1,000). The cows have provided him with a virtually unlimited number of blocks of each kind of N (1 <= N <= 100) different types of cheese (conveniently numbered 1..N). He'd like to store (subject to the constraints of height) the most

valuable set of blocks he possibly can. The cows will sell the rest to support the orphan calves association.

Each block of the i-th type of cheese has some value V\_i (1 <= V\_i <= 1,000,000) and some height H\_i (5 <= H\_i <= T), which is always a multiple of 5.

Cheese compresses. A block of cheese that has height greater than or equal to K (1 <= K <= T) is considered 'large' and will crush any and all of the cheese blocks (even other large ones) located below it in the tower. A crushed block of cheese doesn't lose any value, but its height reduces to just 4/5 of its old height. Because the height of a block of cheese is always a multiple of 5, the height of a crushed block of cheese will always be an integer. A block of cheese is either crushed or not crushed; having multiple large blocks above it does not crush it more. Only tall blocks of cheese crush other blocks; aggregate height of a tower does not affect whether a block is crushed or not.

What is the total value of the best cheese tower FJ can construct?

Consider, for example, a cheese tower whose maximum height can be 53 to be build from three types of cheese blocks. Large blocks are those that are greater than or equal to 25. Below is a chart of the values and heights of the various cheese blocks he stacks:

Type    Value      Height 

1      100         25

2       20          5

3       40         10

FJ constructs the following tower: 

Type Height Value 

top -> [1]   25    100

```cpp
[2]    4     20   <- crushed by [1] above 
[3]    8     40   <- crushed by [1] above 
[3]    8     40   <- crushed by [1] above 
bottom -> [3]    8     40   <- crushed by [1] above 
```
The topmost cheese block is so large that the blocks below it are crushed. The total height is:
```cpp
25 + 4 + 8 + 8 + 8 = 53 
The total height does not exceed 53 and thus is 'legal'. The total value is: 
100 + 20 + 40 + 40 + 40 = 240. 
This is the best tower for this particular set of cheese blocks. 
要建一个奶酪塔，高度最大为T。他有N块奶酪。第i块高度为Hi（一定是5的倍数），价值为Vi。一块高度>=K的奶酪被称为大奶酪，一个奶酪如果在它上方有大奶酪（多块只算一次），它的高度就会变成原来的4/5.。 很显然John想让他的奶酪他价值和最大。求这个最大值。
```
## 输入格式

\* Line 1: Three space-separated integers: N, T, and K

\* Lines 2..N+1: Line i+1 contains two space separated integers: V\_i and H\_i

## 输出格式

\* Line 1: The value of the best tower FJ can build

## 样例

### 样例输入 #1
```
3 53 25 
100 25 
20 5 
40 10 

```
### 样例输出 #1
```
240 

```
## 题目翻译

**【题目描述】**

FJ 要建一个奶酪塔，高度最大为 $T\ (1 \le T \le 10^3)$ 。他有 $N\ (1 \le N \le 10^2)$ 种奶酪。第 $i$ 种奶酪的高度为 $H_i\ (5\le H_i \le T\text{ 且 }5 \mid H_i)$ ，价值为 $V_i\ (1 \le V_i \le 10^6)$ 。一块高度 $H_i\ge K\ (1 \le K \le T)$ 的奶酪被称为大奶酪，如果一个奶酪上方有大奶酪（如果有多块就只算一次），这个奶酪的高度 $H_i$ 就会变成原来的 $\frac{4}{5}$。FJ 想让他的奶酪塔价值和最大。请你求出这个最大值。

例如，考虑一种奶酪塔，其最大高度可以是 $53$，可以用三种类型的奶酪块建造。大块是大于或等于 $25$ 的块。下面是他堆叠的各种奶酪块的值和高度的图表：

|类型|价值|高度|
| :----------: | :----------: | :----------: |
|1|100|25|
|2|20|5|
|3|40|10|

FJ建造了以下奶酪塔：

|类型|价值|高度|
| :----------: | :----------: | :----------: |
|1|100|25|
|2|20|4|
|3|40|8|
|3|40|8|
|3|40|8|

总高度是 $25 + 4 + 8 + 8 + 8 = 53$，除塔顶奶酪外，其余高度均被压低。总价值是 $100 + 20 + 40 + 40 + 40 = 240$。

**【输入格式】**

第1行为三个用空格隔开的整数 $N,T,K$。

第2至 $N+1$ 行中第 $i+1$ 行包含两个用空格隔开的整数 $V_i,H_i$。

**【输出格式】**

一行一个整数为奶酪塔的最大价值。


---

---
title: "[USACO10MAR] Great Cow Gathering G"
layout: "post"
diff: 普及+/提高
pid: P2986
tag: ['动态规划 DP', '2010', 'USACO', '树形 DP']
---
# [USACO10MAR] Great Cow Gathering G
## 题目描述

Bessie 正在计划一年一度的奶牛大集会，来自全国各地的奶牛将来参加这一次集会。当然，她会选择最方便的地点来举办这次集会。

每个奶牛居住在 $N$ 个农场中的一个，这些农场由 $N-1$ 条道路连接，并且从任意一个农场都能够到达另外一个农场。道路 $i$ 连接农场 $A_i$ 和 $B_i$，长度为 $L_i$。集会可以在 $N$ 个农场中的任意一个举行。另外，每个牛棚中居住着 $C_i$ 只奶牛。

在选择集会的地点的时候，Bessie 希望最大化方便的程度（也就是最小化不方便程度）。比如选择第 $X$ 个农场作为集会地点，它的不方便程度是其它牛棚中每只奶牛去参加集会所走的路程之和（比如，农场 $i$ 到达农场 $X$ 的距离是 $20$，那么总路程就是 $C_i\times 20$）。帮助 Bessie 找出最方便的地点来举行大集会。
## 输入格式

第一行一个整数 $N$ 。

第二到 $N+1$ 行：第 $i+1$ 行有一个整数 $C_i$。

第 $N+2$ 行到 $2N$ 行：第 $i+N+1$ 行为 $3$ 个整数：$A_i,B_i$ 和 $L_i$。
## 输出格式

一行一个整数，表示最小的不方便值。
## 样例

### 样例输入 #1
```
5 
1 
1 
0 
0 
2 
1 3 1 
2 3 2 
3 4 3 
4 5 3 

```
### 样例输出 #1
```
15 

```
## 提示

$1\leq N\leq 10^5$，$1\leq A_i\leq B_i\leq N$，$0 \leq C_i,L_i \leq 10^3$。


---

---
title: "[USACO10OCT] Dinner Time S"
layout: "post"
diff: 普及+/提高
pid: P2994
tag: ['贪心', '2010', 'USACO', '排序']
---
# [USACO10OCT] Dinner Time S
## 题目描述

Farmer John's N (1 <= N <= 1,000) cows conveniently numbered 1..N are participating in the IOI in Bulgaria. The cows like the Bulgarian sun and are enjoying their holiday. All seems well.

This changes around dinner time. The restaurant is rather small, having only M (1 <= M <= N) cow seats conveniently numbered 1..M. Each cow starts at a location CX\_i, CY\_i (-1,000,000 <= CX\_i <= 1,000,000; -1,000,000 <= CY\_i <= 1,000,000); the seats can be found at SX\_j, SY\_j (-1,000,000 <= SX\_j <= 1,000,000; -1,000,000 <= SY\_j <= 1,000,000).

The cows have a very efficient (though primitive) method to distribute themselves into the seats. As soon as a cow is certain she will get to a seat first, she rushes there as fast as she can (all cows runs equally fast).

Farmer John's cows, like all prize cows, have no problem jumping over seats, tables, or other cows, so they can run in a straight line. When multiple cows can reach a seat at the very same time, the oldest cow (the one appearing earlier in the input data) gets the seat.  Likewise, when a cow can be the first to reach multiple seats she will also choose the one appearing earliest in the input.

Some cows won't be able to eat dinner, and those hungry cows are collectively planning to steal Farmer John's very own food. Farmer John would like a list of cows he should be wary of. (In the case when there are no hungry cows, output 0). Can you help him?

NOTE: Standard distance calculations will likely require an

intermediate result that will fit into a 64-bit integer but not into a 32-bit integer.
## 输入格式

\* Line 1: Two space-separated integers: N and M

\* Lines 2..N+1: Line i+1 contains two space separated integers: CX\_i and CY\_i

\* Lines N+2..N+M+1: Line j+N+1 contains two space separated integers: SX\_j and SY\_j
## 输出格式

\* Lines 1..N-M: Line i contains the number of the ith cow that Farmer John should be wary of. The cow numbers should be listed in increasing order.
## 样例

### 样例输入 #1
```
2 1 
0 1 
1 0 
1 10 

```
### 样例输出 #1
```
2 

```
## 提示

2 cows: Cow 1 starts at (0, 1) and cow 2 at (1, 0). There 

is only 1 seat at (1, 10). 

Cow 1 is closer to the seat than cow 2, so cow 1 will get the only seat.

## 题目翻译

## 题目描述

农场主约翰的 $N$（$1 \le N \le 10 ^ 3$）头奶牛被编号为 $1 \sim N$，它们正在保加利亚参加 IOI。奶牛们喜欢保加利亚的太阳并享受着它们的假日，一切看起来都没问题。

变化发生在晚餐时间前后。这家餐馆很小，只有 $M$（$1 \le M \le N$）个座位，编号为 $1 \sim M$。每头牛从一个位置 $CX_i$，$CY_i$ 进入餐馆（$-10 ^ 6 \le CX_i \le 10 ^ 6,-10 ^ 6 \le CY_i \le 10 ^ 6$）；座位可以在 $SX_j$，$SY_j$ 找到（$-10 ^ 6 \le SX_j \le10 ^ 6,-10 ^ 6\le SY_j\le 10 ^ 6$）。



奶牛有一种非常有效的（尽管很原始）方法把自己分配到座位上。一旦某只奶牛确定她会先到某个座位上，她就会尽快赶到那里（所有的奶牛都跑得一样快）。



农场主约翰的奶牛和所有获奖的奶牛一样，跳过座位、桌子或其他奶牛都没有问题，因此它们可以直线奔跑。当多头牛可以同时到达一个座位时，最老的牛（在输入数据中出现得更早的牛）获得座位。当一头牛可以第一个到达多个座位时，她也会选择在输入中最早出现的座位。



一些奶牛将不能吃晚饭，这些吃不到饭的饥饿的奶牛正集体计划偷农场主约翰自己的食物。农场主约翰想要一份他应该提防的奶牛名单。（如果没有饥饿的奶牛，则输出 $0$）。你能帮他吗？



注：在计算中可能会有超过 $32$ 位整数范围但在 $64$ 位整数范围内的数。

------------


## 输入格式

第一行：两个空格分隔的整数：$N$ 和 $M$。

第 $2 \sim N + 1$ 行：第 $i+1$ 行包含两个空格分隔的整数：$CX_i$ 和 $CY_i$。



第 $N+2 \sim N+M+1$ 行：行 $j+N+1$ 包含两个空格分隔的整数：$SX_j$ 和 $SY_j$。


------------

##  输出格式

第 $1$ 行到第 $(N-M)$ 行：第 $i$ 行包含农场主约翰应该提防的第 $i$ 头牛的编号。奶牛的编号应递增排序。




---

---
title: "[USACO10NOV] Candy S"
layout: "post"
diff: 普及+/提高
pid: P2998
tag: ['2010', 'USACO']
---
# [USACO10NOV] Candy S
## 题目描述

Farmer John knows that Bessie loves to eat candy. FJ has N (1 <= N <= 40,000) candies that he wants to give Bessie over some number of days. Each day, Farmer John gives Bessie a choice of how many candies she chooses to eat that day by choosing the number from a master list FJ supplies that has Nopt (1 <= Nopt <= 50) different options, C\_i (1 <= C\_i <= N). She must take exactly C\_i candies, no more, no less.

Farmer John has also disclosed F (1 <= F <= 50) of his favorite numbers, FN\_i (1 <= FN\_i <= N). Whenever the number of candies remaining at the end of the day precisely matches one of these favorite numbers, Bessie has the option to have him add exactly M (1 <= M <= 100) more candies to the candy supply. Bessie might get another option to add M candies several times if adding candies creates another favorite number. In the best circumstances, Bessie can obtain an infinite amount of candy!

When Bessie cannot choose some amount of candy to take (because there is not enough), and the number of candies remaining is not any of FJ's favorite numbers, she cannot have any more candy.

Unfortunately, Bessie cannot think ahead as far as she'd like to, so she needs your help in order to eat as many candies as possible.

By way of example, consider this scenario:

\* Farmer John's basket initially contains 10 candies

\* Bessie can chose to eat either 3 or 5 candies each day

\* Farmer John will add 1 candy any time the remaining number of candies is 2 or 4

Bessie could use this set of choices to maximize the amount of candy she can eat:

```cpp

                  Initial      # Candies   Remaining     Bonus     Final
        Day      # Candies       Eaten      Candies     Candies   Candies

         1          10             3          7            0        7
         2           7             3          4            1        5
         3           5             3          2            1        3
         4           3             3          0            0        0

```

Total candies eaten = 3 + 3 + 3 + 3 = 12. 

农民约翰知道Bessie喜欢吃糖果。约翰有N（1≤N≤40000）的糖果，他想给Bessie几天。每一天，贝茜从一个列表（有nopt（1 <= nopt <= 50）种不同的选择），选择那一天吃掉刚好C\_i（1 <= c\_i <= N）个糖果。


农民约翰也透露F（1≤f≤50）他最喜欢的数字，FN\_i（1 <= FN\_i <= N）。当当天最后剩下的糖果数量精确匹配其中一个喜欢的号码，Bessie可以让他添加恰好M（1 <= M = 100）个糖果。如果加后得到的个数，还是FJ喜欢的数字，就可以继续添加糖果M个（加几次由贝西决定）。在最好的情况下，Bessie可以吃掉无限量的糖果！


当Bessie不能选择一定量的糖（因为没有足够的），或者糖果的剩余数量不是任何约翰最喜欢的号码，她不能有任何更多的糖果。


不幸的是，Bessie想不出她想做的事，所以她需要你的帮助才能吃尽可能多的糖果。

## 输入格式

\* Line 1: Four space-separated integers: N, Nopt, F, and M

\* Lines 2..Nopt+1: Line i+1 contains a single integer: C\_i

\* Lines Nopt+2..Nopt+F+1: Line i+Nopt+1 contains a single integer: FN\_i

1行：四个整数N，Nopt，F和M

2行。nopt + 1：i+ 1行包含一个整数：c\_i

nopt + 2 .. nopt + F + 1 + 1 + nopt行：行包含一个整数：fn\_i

## 输出格式

\* Line 1: A single integer, denoting the maximum amount of candies Bessie can eat, or -1 if  Bessie can eat an infinite amount of candy.

1行：一个整数，表示Bessie最多可以吃几个。如果Bessie可以无限量吃糖输出-1。

## 样例

### 样例输入 #1
```
10 2 2 1 
3 
5 
4 
2 

```
### 样例输出 #1
```
12 

```
## 提示

感谢@ 王彦梓 提供翻译，kkksc03进行了修正。



---

---
title: "[USACO10DEC] Treasure Chest S"
layout: "post"
diff: 普及+/提高
pid: P3004
tag: ['动态规划 DP', '递推', '2010', 'USACO']
---
# [USACO10DEC] Treasure Chest S
## 题目描述

Bessie and Bonnie have found a treasure chest full of marvelous gold coins! Being cows, though, they can't just walk into a store and buy stuff, so instead they decide to have some fun with the coins.

The N (1 <= N <= 5,000) coins, each with some value C\_i (1 <= C\_i <= 5,000) are placed in a straight line. Bessie and Bonnie take turns, and for each cow's turn, she takes exactly one coin off of either the left end or the right end of the line. The game ends when there are no coins left.

Bessie and Bonnie are each trying to get as much wealth as possible for themselves. Bessie goes first. Help her figure out the maximum value she can win, assuming that both cows play optimally.

Consider a game in which four coins are lined up with these values:

30  25  10  35

Consider this game sequence:

Bessie    Bonnie       New Coin

Player   Side   CoinValue   Total     Total         Line

Bessie   Right     35        35         0       30  25  10

Bonnie   Left      30        35        30         25  10

Bessie   Left      25        60        30           10

Bonnie   Right     10        60        40           --

This is the best game Bessie can play.

小 A 和小 B 在玩游戏。

初始时，有 $n$ 个硬币被摆成了一行，从左至右数第 $i$ 个硬币的价值为 $c_i$。

小 A 和小 B 每人一回合，在一个人的回合中，他可以选择**当前**硬币序列最左侧或者最右侧的硬币，并将他从序列中取出，将其价值累加到自己获得的累计价值中，然后进行另一个人的回合。当硬币全部被取走时，游戏结束。

请求出在双方都尽可能的使自己累计价值最大的情况下，若由小 A 进行第一回合，那么他能获得的累计价值最大是多少。
## 输入格式

输入的第一行是一个整数 $n$，代表硬币的个数。

第 $2$ 到第 $(n + 1)$ 行，每行一个整数，第 $(i + 1)$ 行的整数代表第 $i$ 个硬币的价值 $c_i$。
## 输出格式

输出一行一个整数，代表小 A 能获得的最大累计价值。
## 样例

### 样例输入 #1
```
4 
30 
25 
10 
35 

```
### 样例输出 #1
```
60 

```
## 提示

#### 输入输出样例 $1$ 解释

初始时，硬币序列为 $\{30,~25,~10,~35\}$。

第一回合，小 A 取走最右侧的硬币，序列变为 $\{30,~25,~10\}$，小 A 的累加价值为 $35$。

第二回合，小 B 取走最左侧的硬币，序列变为 $\{25,~10\}$，小 B 的累加价值为 $30$。

第三回合，小 A 取走最左侧的硬币，序列变为 $\{10\}$，小 A 的累加价值为 $35 + 25 = 60$。

第四回合，小 B 取走最左侧的硬币，序列变为空，小 B 的累加价值为 $30 + 10 = 40$，游戏结束。

小 A 获得的最大累计价值为 $60$。

#### 数据范围与约定

对于全部的测试点，$1 \leq n \leq 5 \times 10^3$，$1 \leq c_i \leq 5 \times 10^3$。

**提示：请注意，本题的空间限制为 $64$ Mib。**


---

---
title: "[USACO11JAN] Dividing the Gold S"
layout: "post"
diff: 普及+/提高
pid: P3010
tag: ['2011', 'USACO']
---
# [USACO11JAN] Dividing the Gold S
## 题目描述

Bessie and Canmuu found a sack of N (1 <= N <= 250) gold coins that they wish to divide as evenly as possible. Coin i has value v\_i (1 <= V\_i <= 2,000). The cows would like to split the pile as evenly as they can, but that is not always possible. What is the smallest difference between the values of the two piles?

In addition, the Bessie and Canmuu have found that there might be multiple ways to split the piles with that minimum difference. They would also like to know the number of ways to split the coins as fairly as possible. If it isn't possible to split the piles evenly, Bessie will get the higher-valued pile.

By way of example, consider a sack of five coins of values: 2, 1, 8, 4, and 16. Bessie and Canmuu split the coins into two piles, one pile with one coin worth 16, and the other pile with the remaining coins worth 1+2+4+8=15. Therefore the difference is 16-15 = 1.  This is the only way for them to split the coins this way, so the number of ways to split it evenly is just 1.

Note that same-valued coins can be switched among the piles to increase the number of ways to perform an optimal split. Thus, the set of coins {1, 1, 1, 1} has six different ways to split into two optimal partitions, each with two coins.
## 输入格式

\* Line 1: A single integer: N

\* Lines 2..N+1: Line i+1 contains a single integer: V\_i

## 输出格式

\* Line 1: A single integer that is the smallest difference of two partitions.

\* Line 2: A single integer that is the number of ways to split the coins with the minimum difference printed in line 1. Since this number can get quite large, print the remainder when divided by 1,000,000.

## 样例

### 样例输入 #1
```
5 
2 
1 
8 
4 
16 

```
### 样例输出 #1
```
1 
1 

```
## 题目翻译

Bessie 和 Canmuu 发现了一个有 ***N*** 个金币的袋子(1 <= N <= 250) 。第i个金币有一个价值 ***Vi***
(1 <= Vi <= 2000)他们希望尽可能的把这堆金币平均分配，但有时这是不可能的。找出使两堆价值差最小的分配方案。如果不能完全平均分开，Bessie会获得较高价值那一堆。

举例来说 ： 有一袋5个金币。价值分别是 2,1,8,4,16。
Bessie 和Canmuu把金币分成两堆，第一堆是价值16的金币，另一堆是剩下的1+2+4+8 = 15 个金币，因此，差是1，这是最优分配方案下的唯一分法（即差最小的唯一分法），所以方案数为1。


请你找出 **最小的差值** 以及在这个差值下分配的**方案数。**

输入第一行 N

之后每一行有一个Vi代表第i个金币的价值

输出第一行是最小差值，

第二行是分配方案数 ,由于方案数可能很大，输出***ans mod 1e6***的答案

感谢@ToBiChi 提供翻译


---

---
title: "[USACO11FEB] Cowlphabet G"
layout: "post"
diff: 普及+/提高
pid: P3012
tag: ['2011', 'USACO']
---
# [USACO11FEB] Cowlphabet G
## 题目描述

Like all bovines, Farmer John's cows speak the peculiar 'Cow'

language. Like so many languages, each word in this language comprises a sequence of upper and lowercase letters (A-Z and a-z).  A word is valid if and only if each ordered pair of adjacent letters in the word is a valid pair.

Farmer John, ever worried that his cows are plotting against him, recently tried to eavesdrop on their conversation. He overheard one word before the cows noticed his presence. The Cow language is spoken so quickly, and its sounds are so strange, that all that Farmer John was able to perceive was the total number of uppercase letters, U (1 <= U <= 250) and the total number of lowercase

letters, L (1 <= L <= 250) in the word. 

Farmer John knows all P (1 <= P <= 200) valid ordered pairs of adjacent letters.  He wishes to know how many different valid 

words are consistent with his limited data.  However, since

this number may be very large, he only needs the value modulo

97654321.

约翰家的奶牛用别人听不懂的“牛语”联络。牛语采用英文字母，而且区分大小写。牛 语中的语法中，前后字母的衔接非常重要，存在P个基本组合，每个字母之后只能接固定的 几个字母。 约翰担心奶牛正在密谋反对他，于是最近一直在偷听她们的对话。可是牛语太复杂了， 他只模模糊糊地听到了一个单词，并确定了这个单词中有U个大写字母，L个小写字母。约 翰对这个单词很在意，他想知道，有多少牛语词汇拥有U个大写字母，L个小写字母。由于 这个数字太大了，你只要输出答案取 97654321 的余数就可以了。 输入格式 ? ? 第一行：三个用空格隔开的整数：U，L和P，1 ≤ U, L ≤ 250，1 ≤ P ≤ 200 第二行到P + 1行：第i + 1有两个字母Ai和Bi，表示字母Ai后面可以接Bi，没有一对Ai和 Bi是完全相同的

## 输入格式

\* Line 1: Three space-separated integers: U, L and P

\* Lines 2..P+1: Two letters (each of which may be uppercase or lowercase), representing one valid ordered pair of adjacent letters in Cow.

## 输出格式

\* Line 1: A single integer, the number of valid words consistent with Farmer  John's data mod 97654321.

## 样例

### 样例输入 #1
```
2 2 7 
AB 
ab 
BA 
ba 
Aa 
Bb 
bB 

```
### 样例输出 #1
```
7 

```
## 提示

The word Farmer John overheard had 2 uppercase and 2 lowercase letters.  The valid pairs of adjacent letters are AB, ab, BA, ba, Aa, Bb and bB.


The possible words are:

AabB
ABba
abBA
BAab
BbBb
bBAa
bBbB


---

---
title: "[USACO11FEB] Cow Line S"
layout: "post"
diff: 普及+/提高
pid: P3014
tag: ['贪心', '2011', 'USACO', '枚举', '康托展开']
---
# [USACO11FEB] Cow Line S
## 题目描述

The N (1 <= N <= 20) cows conveniently numbered 1...N are playing yet another one of their crazy games with Farmer John. The cows will arrange themselves in a line and ask Farmer John what their line number is. In return, Farmer John can give them a line number and the cows must rearrange themselves into that line.

A line number is assigned by numbering all the permutations of the line in lexicographic order.

Consider this example:

Farmer John has 5 cows and gives them the line number of 3.

The permutations of the line in ascending lexicographic order: 1st: 1 2 3 4 5

2nd: 1 2 3 5 4

3rd: 1 2 4 3 5

Therefore, the cows will line themselves in the cow line 1 2 4 3 5.

The cows, in return, line themselves in the configuration '1 2 5 3 4' and ask Farmer John what their line number is.

Continuing with the list:

4th : 1 2 4 5 3

5th : 1 2 5 3 4

Farmer John can see the answer here is 5

Farmer John and the cows would like your help to play their game. They have K (1 <= K <= 10,000) queries that they need help with. Query i has two parts: C\_i will be the command, which is either 'P' or 'Q'.

If C\_i is 'P', then the second part of the query will be one integer A\_i (1 <= A\_i <= N!), which is a line number. This is Farmer John challenging the cows to line up in the correct cow line.

If C\_i is 'Q', then the second part of the query will be N distinct integers B\_ij (1 <= B\_ij <= N). This will denote a cow line. These are the cows challenging Farmer John to find their line number.


## 输入格式

\* Line 1: Two space-separated integers: N and K

\* Lines 2..2\*K+1: Line 2\*i and 2\*i+1 will contain a single query.

Line 2\*i will contain just one character: 'Q' if the cows are lining up and asking Farmer John for their line number or 'P' if Farmer John gives the cows a line number.

If the line 2\*i is 'Q', then line 2\*i+1 will contain N space-separated integers B\_ij which represent the cow line. If the line 2\*i is 'P', then line 2\*i+1 will contain a single integer A\_i which is the line number to solve for.

## 输出格式

\* Lines 1..K: Line i will contain the answer to query i.

If line 2\*i of the input was 'Q', then this line will contain a single integer, which is the line number of the cow line in line 2\*i+1.

If line 2\*i of the input was 'P', then this line will contain N space separated integers giving the cow line of the number in line 2\*i+1.

## 样例

### 样例输入 #1
```
5 2 
P 
3 
Q 
1 2 5 3 4 

```
### 样例输出 #1
```
1 2 4 3 5 
5 

```
## 题目翻译

第一行两个整数 $N,K$。

接下来有 $K$ 组询问，每组询问里先给出 $C_i$，表示操作类型。

如果 $C_i$ 是 `P`，下面给出一个整数 $A_i$，表示求 $1$ 到 $N$ 的第 $A_i$ 个全排列。

如果 $C_i$ 是 `Q`，下面给出 $N$ 个整数 $B_{i,j}$，表示求 $B_{i,1}$ 到 $B_{i,N}$ 这个序列是 $1$ 到 $N$ 的第几个全排列。

对于每个询问，输出相应的答案。

数据范围：$1≤N≤20$，$1≤K≤10^4$，$1≤A_i≤N!$，$1≤B_i≤N$。


---

---
title: "[USACO11MAR] Tree Decoration G"
layout: "post"
diff: 普及+/提高
pid: P3018
tag: ['2011', 'USACO']
---
# [USACO11MAR] Tree Decoration G
## 题目描述

Farmer John is decorating his Spring Equinox Tree (like a Christmas tree but popular about three months later). It can be modeled as a rooted mathematical tree with N (1 <= N <= 100,000) elements, labeled 1...N, with element 1 as the root of the tree. Each tree element e > 1 has a parent, P\_e (1 <= P\_e <= N). Element 1 has no parent (denoted '-1' in the input), of course, because it is the root of the tree.

Each element i has a corresponding subtree (potentially of size 1) rooted there. FJ would like to make sure that the subtree corresponding to element i has a total of at least C\_i (0 <= C\_i <= 10,000,000) ornaments scattered among its members. He would also like to minimize the total amount of time it takes him to place all the ornaments (it takes time K\*T\_i to place K ornaments at element i (1 <= T\_i <= 100)).

Help FJ determine the minimum amount of time it takes to place ornaments that satisfy the constraints.  Note that this answer might not fit into a 32-bit integer, but it will fit into a signed 64-bit integer.

For example, consider the tree below where nodes located higher on the display are parents of connected lower nodes (1 is the root):

```cpp
For example, consider the tree below where nodes located higher on
the display are parents of connected lower nodes (1 is the root):

               1 
               |
               2
               |
               5
              / \
             4   3

Suppose that FJ has the following subtree constraints:

                  Minimum ornaments the subtree requires
                    |     Time to install an ornament
       Subtree      |       |
        root   |   C_i  |  T_i
       --------+--------+-------
          1    |    9   |   3
          2    |    2   |   2
          3    |    3   |   2
          4    |    1   |   4
          5    |    3   |   3

Then FJ can place all the ornaments as shown below, for a total
cost of 20:

            1 [0/9(0)]     legend: element# [ornaments here/
            |                      total ornaments in subtree(node install time)]
            2 [3/9(6)]
            |
            5 [0/6(0)]
           / \
 [1/1(4)] 4   3 [5/5(10)]
```
## 输入格式

\* Line 1: A single integer: N

\* Lines 2..N+1: Line i+1 contains three space-separated integers: P\_i, C\_i, and T\_i

## 输出格式

\* Line 1: A single integer: The minimum time to place all the

ornaments

## 样例

### 样例输入 #1
```
5 
-1 9 3 
1 2 2 
5 3 2 
5 1 4 
2 3 3 

```
### 样例输出 #1
```
20 

```
## 题目翻译

给定一颗以 $1$ 为根的有根树，第 $i$ 个结点的父结点为 $P_i$（$P_1=-1$），在第 $i$ 个结点上挂一个装饰物的代价为 $T_i$，每个结点可以挂任意个。现在给定每棵树子树中至少挂的装饰物个数 $C_i$，求满足要求的最少花费。

$1 \leq n \leq 10^5$，$1 \leq T_i \leq 100$，$1 \leq C_i \leq 10^7$，请注意要开 long long。

### 输入格式

第一行一个整数 $n$。

第 $1$ 行至第 $n$ 行，在第 $i+1$ 行有三个整数，分别表示 $P_i$，$C_i$ 和 $T_i$。

### 输出格式

一行一个整数表示最小花费。

### 样例解释
```
样例中给出的树如下：
               1 
               |
               2
               |
               5
              / \
             4   3

给定如下数据：

                  该子树中所需的装饰物个数
                    |     在该节点挂一个装饰物的花费
                    |       |
       结点编号 |   C_i  |  T_i
       --------+--------+-------
          1    |    9   |   3
          2    |    2   |   2
          3    |    3   |   2
          4    |    1   |   4
          5    |    3   |   3

最佳方案如下：

            1 [0/9(0)]
            |
            2 [3/9(6)]
            |
            5 [0/6(0)]
           / \
 [1/1(4)] 4   3 [5/5(10)]

（格式：[在此处挂的装饰物个数/子树中装饰物总数(在此结点花费代价)]）
```


---

---
title: "[USACO10OCT] Soda Machine G"
layout: "post"
diff: 普及+/提高
pid: P3028
tag: ['2010', 'USACO']
---
# [USACO10OCT] Soda Machine G
## 题目描述

To meet the ever-growing demands of his N (1 &amp;lt;= N &amp;lt;= 50,000) cows, Farmer John has bought them a new soda machine. He wants to figure out the perfect place to install the machine.

The field in which the cows graze can be represented as a one-dimensional number line. Cow i grazes in the range A\_i..B\_i (1 &amp;lt;= A\_i &amp;lt;= B\_i; A\_i &amp;lt;= B\_i &amp;lt;= 1,000,000,000) (a range that includes its endpoints), and FJ can place the soda machine at any integer point in the range 1..1,000,000,000.  Since cows are extremely lazy and try to move as little as possible, each cow would like to have the soda machine installed within her grazing range.

Sadly, it is not always possible to satisfy every cow's desires. Thus FJ would like to know the largest number of cows that can be satisfied.

To demonstrate the issue, consider four cows with grazing ranges 3..5, 4..8, 1..2, and 5..10; below is a schematic of their grazing ranges:

```cpp

         1   2   3   4   5   6   7   8   9  10  11  12  13
         |---|---|---|---|---|---|---|---|---|---|---|---|-...
                 aaaaaaaaa
                     bbbbbbbbbbbbbbbbb
         ccccc           ddddddddddddddddddddd
```
As can be seen, the first, second and fourth cows share the point 5, but the third cow's grazing range is disjoint.  Thus, a maximum of 3 cows can have the soda machine within their grazing range.


有N个人要去膜拜JZ，他们不知道JZ会出现在哪里，因此每个人有一个活动范围，只要JZ出现在这个范围内就能被膜拜，

伟大的JZ当然希望膜拜他的人越多越好，但是JZ不能分身，因此只能选择一个位置出现，他最多可以被多少人膜拜呢，

这个简单的问题JZ当然交给你了

## 输入格式

\* Line 1: A single integer: N

\* Lines 2..N+1: Line i+1 contains two space-separated integers: A\_i and B\_i

## 输出格式

\* Line 1: A single integer representing the largest number of cows whose grazing intervals can all contain the soda machine.

## 样例

### 样例输入 #1
```
4 
3 5 
4 8 
1 2 
5 10 

```
### 样例输出 #1
```
3 

```
## 提示

If the soda machine is placed at location 5, cows 1, 2, and 4 can be satisfied. It is impossible to satisfy all four cows.

## 题目翻译

**为了满足fj所有的N(1<=n<=50000)头奶牛的需求，fj新买了一台汽水机。他想找到一个最完美的位置来安放它。**

**奶牛的牧场可以被表示为一个一维数轴，第i个奶牛被放牧的区间是[Ai...Bi]（包含端点），fj可以把汽水机放在[1..1,000,000,000]。**

**因为奶牛们都懒得要死，她们想尽可能的少移动。她们希望汽水机被放在自己的放牧区间内。**

**遗憾的是，fj并不总能满足所有奶牛的要求，所以他想请你帮忙算出他能满足的奶牛数目**


---

---
title: "[USACO12FEB] Nearby Cows G"
layout: "post"
diff: 普及+/提高
pid: P3047
tag: ['动态规划 DP', '2012', 'USACO', '树形 DP']
---
# [USACO12FEB] Nearby Cows G
## 题目描述

Farmer John has noticed that his cows often move between nearby fields. Taking this into account, he wants to plant enough grass in each of his fields not only for the cows situated initially in that field, but also for cows visiting from nearby fields.

Specifically, FJ's farm consists of N fields (1 <= N <= 100,000), where some pairs of fields are connected with bi-directional trails (N-1 of them in total).  FJ has designed the farm so that between any two fields i and j, there is a unique path made up of trails connecting between i and j. Field i is home to C(i) cows, although cows sometimes move to a different field by crossing up to K trails (1 <= K <= 20).

FJ wants to plant enough grass in each field i to feed the maximum number of cows, M(i), that could possibly end up in that field -- that is, the number of cows that can potentially reach field i by following at most K trails.  Given the structure of FJ's farm and the value of C(i) for each field i, please help FJ compute M(i) for every field i.

给你一棵 $n$ 个点的树，点带权，对于每个节点求出距离它不超过 $k$ 的所有节点权值和 $m_i$。
## 输入格式

\* Line 1: Two space-separated integers, N and K.

\* Lines 2..N: Each line contains two space-separated integers, i and j (1 <= i,j <= N) indicating that fields i and j are directly connected by a trail.

\* Lines N+1..2N: Line N+i contains the integer C(i). (0 <= C(i) <= 1000)

第一行两个正整数 $n,k$。   
接下来 $n-1$ 行，每行两个正整数 $u,v$，表示 $u,v$ 之间有一条边。  
最后 $n$ 行，每行一个非负整数 $c_i$，表示点权。

## 输出格式

\* Lines 1..N: Line i should contain the value of M(i). 

输出 $n$ 行，第 $i$ 行一个整数表示 $m_i$。
## 样例

### 样例输入 #1
```
6 2 
5 1 
3 6 
2 4 
2 1 
3 2 
1 
2 
3 
4 
5 
6 

```
### 样例输出 #1
```
15 
21 
16 
10 
8 
11 

```
## 提示

There are 6 fields, with trails connecting (5,1), (3,6), (2,4), (2,1), and (3,2).  Field i has C(i) = i cows.


Field 1 has M(1) = 15 cows within a distance of 2 trails, etc.

【数据范围】  
对于 $100\%$ 的数据：$1 \le n \le 10^5$，$1 \le k \le 20$，$0 \le c_i \le 1000$


---

---
title: "[USACO12MAR] Landscaping S"
layout: "post"
diff: 普及+/提高
pid: P3049
tag: ['2012', 'USACO']
---
# [USACO12MAR] Landscaping S
## 题目背景

*本题与 [2016 年公开赛白金组同名题目](/problem/P2748) 在题意上一致，唯一的差别是数据范围。*
## 题目描述

Farmer John 打算修建一座花园，他需要移动不少泥土。

花园由 $N$ 个花坛组成（$1 \leq N \leq 100$），其中花坛 $i$ 包含 $A_i$ 单位的泥土。FJ 希望花坛 $i$ 包含 $B_i$ 单位的泥土，保证 $0 \leq A_i,B_i \leq 10$。

为了达到这个目标，他可以做这几件事情：

- 购买一单位的泥土，放在指定的花坛中，费用为 $X$。
- 从任意一个花坛中移走一单位泥土，费用为 $Y$。
- 从花坛 $i$ 运送一单位泥土到花坛 $j$，费用为 $Z|i-j|$。

请你帮 FJ 计算移动泥土的最小开销。
## 输入格式

第一行四个整数 $N,X,Y,Z$（$0 \leq X,Y,Z \leq 1000$）。

接下来 $N$ 行，第 $i$ 行两个整数 $A_i,B_i$。
## 输出格式

输出移动泥土的最小开销。
## 样例

### 样例输入 #1
```
4 100 200 1 
1 4 
2 3 
3 2 
4 0 

```
### 样例输出 #1
```
210 

```
## 提示

按下面的方案，最小花费为 $210$，可以证明不存在开销更小的方案。

- 移除 $4$ 号花坛的一单位泥土，花费 $200$。
- 将 $4$ 号花坛的三单位泥土移到 $1$ 号花坛，花费 $3 \times 3=9$。
- 将 $3$ 号花坛的一单位泥土移到 $2$ 号花坛，花费 $1 \times 1=1$。


---

---
title: "[USACO12MAR] Cows in a Skyscraper G"
layout: "post"
diff: 普及+/提高
pid: P3052
tag: ['贪心', '2012', 'USACO', '状压 DP']
---
# [USACO12MAR] Cows in a Skyscraper G
## 题目描述

A little known fact about Bessie and friends is that they love stair climbing races.  A better known fact is that cows really don't like going down stairs.  So after the cows finish racing to the top of their favorite skyscraper, they had a problem.  Refusing to climb back down using the stairs, the cows are forced to use the elevator in order to get back to the ground floor.

The elevator has a maximum weight capacity of W (1 <= W <= 100,000,000) pounds and cow i weighs C\_i (1 <= C\_i <= W) pounds.  Please help Bessie figure out how to get all the N (1 <= N <= 18) of the cows to the ground floor using the least number of elevator rides.  The sum of the weights of the cows on each elevator ride must be no larger than W.

## 输入格式

\* Line 1: N and W separated by a space.

\* Lines 2..1+N: Line i+1 contains the integer C\_i, giving the weight of one of the cows.

## 输出格式

\* A single integer, R, indicating the minimum number of elevator rides needed.

one of the R trips down the elevator.  

## 样例

### 样例输入 #1
```
4 10 
5 
6 
3 
7 

```
### 样例输出 #1
```
3 
```
## 提示

There are four cows weighing 5, 6, 3, and 7 pounds.  The elevator has a maximum weight capacity of 10 pounds.


We can put the cow weighing 3 on the same elevator as any other cow but the other three cows are too heavy to be combined.  For the solution above, elevator ride 1 involves cow #1 and #3, elevator ride 2 involves cow #2, and elevator ride 3 involves cow #4.  Several other solutions are possible for this input.

## 题目翻译

给出 $n$ 个物品，体积为 $w _ 1, w _ 2, \cdots, w _ n$，现把其分成若干组，要求每组总体积小于等于 $W$，问最小分组数量。

$n\le 18,1\le c_i\le W\le 10^8$。


---

---
title: "[USACO12OPEN] Running Laps S"
layout: "post"
diff: 普及+/提高
pid: P3054
tag: ['2012', 'USACO']
---
# [USACO12OPEN] Running Laps S
## 题目描述

Bored with horse racing, Farmer John decides to investigate the feasibility of cow racing as a sport.  He sets up his N cows (1 <= N <= 100,000) to run a race of L laps around a circular track of length C.  The cows all start at the same point on the track and run at different speeds, with the race ending when the fastest cow has run the total distance of LC.

FJ notices several occurrences of one cow overtaking another, and wonders how many times this sort of "crossing event" happens during the entire race.  More specifically, a crossing event is defined by a pair of cows (x,y) and a time t (less than or equal to the ending time of the race), where cow x crosses in front of cow y at time t.  Please help FJ count the total number of crossing events during the entire race.

有n头牛要在长为c的跑道上跑l圈，每头牛有一个速度s\_i. 某头牛跑完时，所有的牛都停下来，问此之前发生了多少次超越。

## 输入格式

\* Line 1: Three space-separated integers: N, L, and C.  (1 <= L,C <= 25,000).

\* Lines 2..1+N: Line i+1 contains the speed of cow i, an integer in the range 1..1,000,000.

## 输出格式

\* Line 1: The total number of crossing events during the entire race.

## 样例

### 样例输入 #1
```
4 2 100 
20 
100 
70 
1 

```
### 样例输出 #1
```
4 

```
## 提示

There are 4 cows running 2 laps on a circular track of length 100.  The speeds of the cows are 20, 100, 70, and 1.


The race lasts 2 units of time, since this is the time it takes the fastest cow (cow 2) to finish.  Within that time, there are 4 crossing events: cow 2 overtakes cows 1 and 4, and cow 3 overtakes cows 1 and 4.

## 题目翻译

# 题目描述
 农夫约翰让他的 n （1 <= n <= 100,000） 头牛在长度为 c 的跑道上进行跑 l 圈的比赛，所有牛从同一起点，以不同的速度开始跑。直到当跑得最快的那一头牛跑完 l 圈时，所有牛才同时停下。

  约翰发现在跑圈过程中发生了几次“超越事件”。其定义是：在比赛结束前某时刻，奶牛 x 已经超越了奶牛 y **整整一圈**，则称做一次“超越事件”。（注： **至少一圈** ，超越了1/2圈，或者超越了1/4圈等等都不算。且对于同一对奶牛（x，y）不会重复计算次数。）

 约翰想知道比赛过程中发生了多少次“超越事件”。

 （注：可能原文章表达有误或某些其他原因，各种翻译方式过来的题意都有问题，给人误导很大，这里是根据题目数据和样例解释写的正确的题意，而不是原文）

## 输入格式：
第一行：三个整数：n，l，c（1 <= l,c <= 25,000)

第二行到第 n+1 行：每行一个整数 vi ，表示奶牛i的速度（1 <= vi <= 1,000,000）

## 输出格式：
第一行：一个整数，表示总共发生的“超越事件”的次数

感谢@远藤沙椰 提供的翻译


---

---
title: "[USACO12NOV] Distant Pastures S"
layout: "post"
diff: 普及+/提高
pid: P3057
tag: ['2012', 'USACO']
---
# [USACO12NOV] Distant Pastures S
## 题目描述

Farmer John's farm is made up of an N x N grid of pastures, where each pasture contains one of two different types of grass.  To specify these two types of grass, we use the characters ( and ), so for example FJ's farm might look like the following grid:

(()) 
)()( 
)((( 
))))
When Bessie the cow travels around the farm, it takes her A units of time to move from a pasture to an adjacent pasture (one step north, south, east, or west) with the same grass type, or B units of time to move to an adjacent pasture with a different grass type.  Whenever Bessie travels from one pasture to a distant pasture, she always uses a sequence of steps that takes the minimum amount of time.  Please compute the greatest amount of time Bessie will ever need to take while traveling between some pair of pastures on the farm.

给出一个n\*n的括号矩阵，从一个点走到相邻的同字符点需付出A的代价，到不同字符点需付出B的代价。求所有点对之间最短路的最大值。

## 输入格式

\* Line 1: Three integers: N (1 <= N <= 30), A (0 <= A <= 1,000,000), and B (0 <= B <= 1,000,000).

\* Lines 1..N+1: Each line contains a string of parentheses of length N.  Collectively, these N lines form an N x N grid of

parentheses.

## 输出格式

\* Line 1: A single integer specifying the maximum amount of time Bessie can spend traveling between a pair of pastures (given that she always follows a route that takes a minimum amount of time).

## 样例

### 样例输入 #1
```
3 1 2 
((( 
()( 
(() 

```
### 样例输出 #1
```
5 

```
## 提示

It takes Bessie 5 units of time to travel between the upper-left corner and the lower-right corner of the grid.  No other pair of pastures causes her to travel for more time than this.



---

---
title: "[USACO12NOV] Balanced Cow Breeds G/S"
layout: "post"
diff: 普及+/提高
pid: P3058
tag: ['2012', 'USACO']
---
# [USACO12NOV] Balanced Cow Breeds G/S
## 题目描述

Farmer John usually brands his cows with a circular mark, but his branding iron is broken, so he instead must settle for branding each cow with a mark in the shape of a parenthesis -- (.  He has two breeds of cows on his farm: Holsteins and Guernseys.  He brands each of his cows with a

parenthesis-shaped mark.  Depending on which direction the cow is facing, this might look like either a left parenthesis or a right parenthesis.

FJ's N cows are all standing in a row, each facing an arbitrary direction, so the marks on the cows look like a string of parentheses of length N. Looking at this lineup, FJ sees a remarkable pattern: if he scans from left to right through just the Holsteins (in the order they appear in the sequence), this gives a balanced string of parentheses; moreover, the same is true for the Guernseys!  To see if this is truly a rare event, please help FJ compute the number of possible ways he could assign breeds to his N cows so that this property holds.

There are several ways to define what it means for a string of parentheses to be "balanced".  Perhaps the simplest definition is that there must be the same total number of ('s and )'s, and for any prefix of the string, there must be at least as many ('s as )'s.  For example, the following strings are all balanced:

() 
(()) 
()(()()) 

while these are not:

)( 
())( 
((()))) 

给一个只有左右括号的字符串，然后用 `H`、`G` 两种字符来标记这个序列，所有标记 `H` 的括号可以组成一个正确的括号序列，所有 `G` 标记的括号也组成一个正确的括号序列，然后输出这种标记方案的总数 $\operatorname{mod} 2012$ 的值。
## 输入格式

\* Line 1: A string of parentheses of length N (1 <= N <= 1000).

## 输出格式

\* Line 1: A single integer, specifying the number of ways FJ can assign breeds to cows so that the Holsteins form a balanced subsequence of parentheses, and likewise for the Guernseys. Since the answer might be a very large number, please print the remainder of this number when divided by 2012 (i.e., print the number mod 2012).  Breed assignments involving only one breed type are valid.

## 样例

### 样例输入 #1
```
(()) 

```
### 样例输出 #1
```
6 

```
## 提示

The following breed assignments work:

(()) 
HHHH
(()) 
GGGG
(()) 
HGGH
(()) 
GHHG
(()) 
HGHG
(()) 
GHGH
 
感谢@CREEPER\_ 提供翻译



---

---
title: "[USACO12DEC] Milk Routing S"
layout: "post"
diff: 普及+/提高
pid: P3063
tag: ['图论', '2012', 'USACO', '最短路']
---
# [USACO12DEC] Milk Routing S
## 题目描述

Farmer John's farm has an outdated network of M pipes (1 <= M <= 500) for pumping milk from the barn to his milk storage tank.  He wants to remove and update most of these over the next year, but he wants to leave exactly one path worth of pipes intact, so that he can still pump milk from the barn to the storage tank.

The pipe network is described by N junction points (1 <= N <= 500), each of which can serve as the endpoint of a set of pipes.  Junction point 1 is the barn, and junction point N is the storage tank.  Each of the M bi-directional pipes runs between a pair of junction points, and has an associated latency (the amount of time it takes milk to reach one end of the pipe from the other) and capacity (the amount of milk per unit time that can be pumped through the pipe in steady state).  Multiple pipes can connect between the same pair of junction points.

For a path of pipes connecting from the barn to the tank, the latency of the path is the sum of the latencies of the pipes along the path, and the capacity of the path is the minimum of the capacities of the pipes along the path (since this is the "bottleneck" constraining the overall rate at which milk can be pumped through the path).  If FJ wants to send a total of X units of milk through a path of pipes with latency L and capacity C, the time this takes is therefore L + X/C.

Given the structure of FJ's pipe network, please help him select a single path from the barn to the storage tank that will allow him to pump X units of milk in a minimum amount of total time.



## 输入格式

\* Line 1: Three space-separated integers: N M X (1 <= X <= 1,000,000).

\* Lines 2..1+M: Each line describes a pipe using 4 integers: I J L C. I and J (1 <= I,J <= N) are the junction points at both ends of the pipe.  L and C (1 <= L,C <= 1,000,000) give the latency and capacity of the pipe.


第1行：三个空格分隔的整数:N M X(1<=X<=1000000)。


第2行到第M+1行：每一行描述一条管道，有4个整数：I J L C。I和J(1<=I,J<=N)是这条管道连接的两个点。L和C(1<=L，C<=1000000)是这条管道的延迟和容量。

## 输出格式

\* Line 1: The minimum amount of time it will take FJ to send milk along a single path, rounded down to the nearest integer.

第1行:约翰沿着一条路径送牛奶花费的最少的时间，向下取整到最近的整数。

## 样例

### 样例输入 #1
```
3 3 15 
1 2 10 3 
3 2 10 2 
1 3 14 1 

```
### 样例输出 #1
```
27 

```
## 提示

FJ wants to send 15 units of milk through his pipe network.  Pipe #1 connects junction point 1 (the barn) to junction point 2, and has a latency of 10 and a capacity of 3.  Pipes #2 and #3 are similarly defined.


The path 1->3 takes 14 + 15/1 = 29 units of time.  The path 1->2->3 takes 20 + 15/2 = 27.5 units of time, and is therefore optimal.


约翰想要通过管网运送15个单位的牛奶。管道1连接节点1（谷仓）和节点2，延迟为10，容量为3。管道2和管道3也以相似的方式来定义。


路径1->3花费14+15/1=29个单位的时间。路径1->2->3花费20+15/2=27.5个单位的时间，用时最少。

## 题目翻译

农民约翰的农场有一套老旧的管网，管网由M条管道(1<=M<=500)构成，用于将牛奶从谷仓运到储奶罐。 他想在明年移除和更新大部分管道，但他想原封不动地保留一条完整的路径，这样他仍然可以把牛奶从谷仓输送到储罐。


管网由N个节点(1<=N<=500)组成，每个点都可以作为一组管道的端点。结点1是谷仓，结点N是储罐。M条双向管道中的每一条都连接一对节点，并且都有一个延迟值(牛奶达到管的另一端的用时)和容量值(单位时间内可以稳定通过管道的牛奶量)。多条管道可以连接同一对节点。


对于一条连接谷仓与储罐的路径，路径的延迟等于沿途所有管道的延迟之和，路径的容量等于沿途管道最小的容量(因为这是制约牛奶运送的“瓶颈”)。如果约翰通过一条延迟为L、容量为C的管道运送X个单位的牛奶，需要的时间为L+X/C。


给出约翰的管网结构，请帮助他选择一条路径，使得他从谷仓到储罐运送X个单位牛奶的总时间最少。



---

---
title: "[USACO13FEB] Tractor S"
layout: "post"
diff: 普及+/提高
pid: P3073
tag: ['搜索', '2013', '二分', 'USACO', '并查集', '排序', '生成树']
---
# [USACO13FEB] Tractor S
## 题目描述

One of Farmer John's fields is particularly hilly, and he wants to purchase a new tractor to drive around on it.  The field is described by an N x N grid of non-negative integer elevations (1 <= N <= 500).  A tractor capable of moving from one grid cell to an adjacent cell (one step north, east, south, or west) of height difference D costs exactly D units of money.

FJ would like to pay enough for his tractor so that, starting from some grid cell in his field, he can successfully drive the tractor around to visit at least half the grid cells in the field (if the number of total cells in the field is odd, he wants to visit at least half the cells rounded up).  Please help him compute the minimum cost necessary for buying a tractor capable of this task.

## 输入格式

\* Line 1: The value of N.

\* Lines 2..1+N: Each line contains N space-separated non-negative integers (each at most 1 million) specifying a row of FJ's field.





## 输出格式

\* Line 1: The minimum cost of a tractor that is capable of driving around at least half of FJ's field.



## 样例

### 样例输入 #1
```
5 
0 0 0 3 3 
0 0 0 0 3 
0 9 9 3 3 
9 9 9 3 3 
9 9 9 9 3 

```
### 样例输出 #1
```
3 

```
## 题目翻译

题目描述

FJ有块农田太崎岖了，他要买一辆新拖拉机才能在这里巡视。这块农田由N x N个格子的非负整数表示高度(1<=N<=500)。拖拉机从当前格子走到相邻格子（东、南、西、北四个方向）的代价为高度差D，则FJ驶过这两个格子的拖拉机最少也要值D块钱。

FJ愿意花足够的钱买一辆新的拖拉机使得他能以最小的高度差走遍所有格子的一半(如果格子总数是奇数，那么一半的值为四舍五入的值)。因为FJ很懒，所以他找到你帮他编程计算他最小需要花多少钱买到符合这些要求的拖拉机。

输入输出格式

输入格式：

第一行为一个整数N

第2到N+1行每行包含N个非负整数（不超过1,000,000），表示当前格子的高度。

输出格式：

共一行，表示FJ买拖拉机要花的最小价钱。


---

---
title: "[USACO13MAR] The Cow Run G/S"
layout: "post"
diff: 普及+/提高
pid: P3080
tag: ['2013', 'USACO']
---
# [USACO13MAR] The Cow Run G/S
## 题目描述

Farmer John has forgotten to repair a hole in the fence on his farm, and his N cows (1 <= N <= 1,000) have escaped and gone on a rampage! Each minute a cow is outside the fence, she causes one dollar worth of damage. FJ must visit each cow to install a halter that will calm the cow and stop the damage.

Fortunately, the cows are positioned at distinct locations along a straight line on a road outside the farm. FJ knows the location P\_i of each cow i (-500,000 <= P\_i <= 500,000, P\_i != 0) relative to the gate (position 0) where FJ starts.

FJ moves at one unit of distance per minute and can install a halter instantly. Please determine the order that FJ should visit the cows so he can minimize the total cost of the damage; you should compute the minimum total damage cost in this case.

农夫约翰的牧场围栏上出现了一个洞，有 $N$（$1\le N\le 1000$）只牛从这个洞逃出了牧场。这些出逃的奶牛很狂躁，他们在外面到处搞破坏，每分钟每头牛都会给约翰带来 $1$ 美元的损失。约翰必须用缰绳套住所有的牛，以停止他们搞破坏。

幸运的是，奶牛们都在牧场外一条笔直的公路上，牧场的大门恰好位于公里的 $0$ 点处。约翰知道每头牛距离牧场大门的距离 $P_i$（$-5\times10^5\le P_i\le5\times 10^5$，$P_i\ne0$）。

约翰从农场大门出发，每分钟移动一个单位距离，每到一头牛所在的地点，约翰就会给它套上缰绳，套缰绳不花时间。按怎样的顺序去给牛套缰绳才能使约翰损失的费用最少？
## 输入格式

\* Line 1: The number of cows, N.

\* Lines 2..N+1: Line i+1 contains the integer P\_i.

## 输出格式

\* Line 1: The minimum total cost of the damage.

## 样例

### 样例输入 #1
```
4 
-2 
-12 
3 
7 

```
### 样例输出 #1
```
50 

```
## 提示

Four cows placed in positions: -2, -12, 3, and 7.


The optimal visit order is -2, 3, 7, -12. FJ arrives at position -2 in 2 minutes for a total of 2 dollars in damage for that cow.

He then travels to position 3 (distance: 5) where the cumulative damage is 2 + 5 = 7 dollars for that cow.

He spends 4 more minutes to get to 7 at a cost of 7 + 4 = 11 dollars for that cow.

Finally, he spends 19 minutes to go to -12 with a cost of 11 + 19 = 30 dollars.

The total damage is 2 + 7 + 11 + 30 = 50 dollars. 




---

---
title: "[USACO13NOV] Crowded Cows S"
layout: "post"
diff: 普及+/提高
pid: P3088
tag: ['2013', 'USACO', '单调队列', '队列']
---
# [USACO13NOV] Crowded Cows S
## 题目描述

Farmer John's N cows (1 <= N <= 50,000) are grazing along a one-dimensional fence.  Cow i is standing at location x(i) and has height h(i) (1 <= x(i),h(i) <= 1,000,000,000).

A cow feels "crowded" if there is another cow at least twice her height within distance D on her left, and also another cow at least twice her height within distance D on her right (1 <= D <= 1,000,000,000).  Since crowded cows produce less milk, Farmer John would like to count the number of such cows.  Please help him.

FJ有 $N(1\le N\le50000)$ 头奶牛沿着一维的栅栏吃草，第 $i$ 头奶牛在目标点 $x_i$ ，它的身高是 $h_i (1 \le x_i,h_i\le10^9)$。

当一头奶牛左边 $D(1\le D\le10^9)$ 距离内且右边 $D$ 距离内有身高至少是它的两倍的奶牛，它就会觉得拥挤。

请计算觉得拥挤的奶牛的数量。

## 输入格式

\* Line 1: Two integers, N and D.

\* Lines 2..1+N: Line i+1 contains the integers x(i) and h(i).  The locations of all N cows are distinct.

第一行两个整数 $N,D$。

接下来 $N$ ，每行两个整数 $x_i,h_i$。保证 $x_i$ 互不相同。
## 输出格式

\* Line 1: The number of crowded cows.

一行一个整数，表示觉得拥挤的奶牛的数量。
## 样例

### 样例输入 #1
```
6 4 
10 3 
6 2 
5 3 
9 7 
3 6 
11 2 

```
### 样例输出 #1
```
2 

```
## 提示

There are 6 cows, with a distance threshold of 4 for feeling crowded.  Cow #1 lives at position x=10 and has height h=3, and so on.


The cows at positions x=5 and x=6 are both crowded. 




---

---
title: "[USACO13NOV] Empty Stalls G"
layout: "post"
diff: 普及+/提高
pid: P3090
tag: ['动态规划 DP', '2013', 'USACO']
---
# [USACO13NOV] Empty Stalls G
## 题目描述

Farmer John's new barn consists of a huge circle of N stalls (2 <= N <= 3,000,000), numbered 0..N-1, with stall N-1 being adjacent to stall 0.

At the end of each day, FJ's cows arrive back at the barn one by one, each with a preferred stall they would like to occupy.  However, if a cow's preferred stall is already occupied by another cow, she scans forward sequentially from this stall until she finds the first unoccupied stall, which she then claims.  If she scans past stall N-1, she continues scanning from stall 0.

Given the preferred stall of each cow, please determine the smallest index of a stall that remains unoccupied after all the cows have returned to the barn.  Notice that the answer to this question does not depend on the order in which the cows return to the barn.

In order to avoid issues with reading huge amounts of input, the input to this problem is specified in a concise format using K lines (1 <= K <= 10,000) each of the form:

X Y A B

One of these lines specifies the preferred stall for XY total cows: X cows prefer each of the stalls f(1) .. f(Y), where f(i) = (Ai + B) mod N.  The values of A and B lie in the range 0...1,000,000,000.

Do not forget the standard memory limit of 64MB for all problems.

约翰的谷仓中有N(2 <= N <=3,000,000)个房间，编号0到N-1，这些房间排布成环状,编号0的和编号N-1的相邻。

每天傍晚，奶牛们一只一只排队回到谷仓，每头奶牛都有一个喜欢的房间，但是，如果它喜欢的房间已被其他奶牛占了，它会向前挨个探索其他房间（如果它探索过了N-1号房间，它会继续探索0号房间，以此继续下去）直到探到第一个没有被占用的房间，这时它会宣布占用这个房间。

告诉你每头奶牛喜欢的房间，当所有奶牛都找到房间后，剩下的没被占用的房间中，编号最小的是哪个。很明显，问题的答案与奶牛进入谷仓的顺序无关。


为避免输入内容过多。本题的输入数据采用一种简洁的方式：一共K(1 <= K <=10,000)行，每行格式如下：

X Y A B

表示有Y批奶牛，每批X头，也就是总共X\*Y只奶牛喜欢的房间号。Y批奶牛编号1到Y，第i批X头奶牛喜欢的房间号为(A\*i+B) Mod N.

A和B的取值范围为0...1,000,000,000

注意，只有64M的空间。

## 输入格式

\* Line 1: Two space-separated integers: N and K.

\* Lines 2..1+K: Each line contains integers X Y A B, interpreted as above.  The total number of cows specified by all these lines will be at most N-1.  Cows can be added to the same stall by several of these lines.

## 输出格式

\* Line 1: The minimum index of an unoccupied stall.

## 样例

### 样例输入 #1
```
10 3 
3 2 2 4 
2 1 0 1 
1 1 1 7 

```
### 样例输出 #1
```
5 

```
## 提示

There are 10 stalls in the barn, numbered 0..9.  The second line of input states that 3 cows prefer stall (2\*1+4) mod 10 = 6, and 3 cows prefer stall (2\*2+4) mod 10 = 8.  The third line states that 2 cows prefer stall (0\*1+1) mod 10 = 1.  Line four specifies that 1 cow prefers stall (1\*1+7) mod 10 = 8 (so a total of 4 cows prefer this stall).


All stalls will end up occupied except stall 5. 




---

---
title: "[USACO15JAN] Meeting Time S"
layout: "post"
diff: 普及+/提高
pid: P3116
tag: ['动态规划 DP', '2015', 'USACO', '拓扑排序']
---
# [USACO15JAN] Meeting Time S
## 题目描述

Bessie and her sister Elsie want to travel from the barn to their favorite field, such that they leave at exactly the same time from the barn, and also arrive at exactly the same time at their favorite field.

The farm is a collection of N fields (1 <= N <= 100) numbered 1..N, where field 1 contains the barn and field N is the favorite field. The farm is built on the side of a hill, with field X being higher in elevation than field Y if X < Y.  An assortment of M paths connect pairs of fields.  However, since each path is rather steep, it can only be followed in a downhill direction. For example, a path connecting field 5 with field 8 could be followed in the 5 -> 8 direction but not the other way, since this would be uphill.  Each pair of fields is connected by at most one path, so M <= N(N-1)/2.

It might take Bessie and Elsie different amounts of time to follow a path; for example, Bessie might take 10 units of time, and Elsie 20. Moreover, Bessie and Elsie only consume time when traveling on paths between fields -- since they are in a hurry, they always travel through a field in essentially zero time, never waiting around anywhere.

Please help determine the shortest amount of time Bessie and Elsie must take in order to reach their favorite field at exactly the same moment.

## 输入格式

The first input line contains N and M, separated by a space.

Each of the following M lines describes a path using four integers A B C D, where A and B (with A < B) are the fields connected by the path, C is the time required for Bessie to follow the path, and D is the time required for Elsie to follow the path.  Both C and D are in the range 1..100.

## 输出格式

A single integer, giving the minimum time required for Bessie and Elsie to travel to their favorite field and arrive at the same moment.

If this is impossible, or if there is no way for Bessie or Elsie to reach the favorite field at all, output the word IMPOSSIBLE on a single line.

## 样例

### 样例输入 #1
```
3 3 
1 3 1 2 
1 2 1 2 
2 3 1 2 

```
### 样例输出 #1
```
2 
```
## 提示

SOLUTION NOTES:

Bessie is twice as fast as Elsie on each path, but if Bessie takes the path 1->2->3 and Elsie takes the path 1->3 they will arrive at the same time.


## 题目翻译

### 题目描述

$\texttt{Bessie}$ 和她的妹妹 $\texttt{Elsie}$ 想从粮仓去她们最喜欢的田地，也就是能够使她们一起从粮仓离开，并且能同一时间到达的田地。

这个农场是由 $N$ 块 $(1\leq N\leq 100)$ 编号为 $1\cdots N$ 的田地构成的，第一块田地就是粮仓，并且第 $N$ 块田地是她们最喜欢的田地。

这个农场建在山的一边，所以，如果 $X < Y$ 的话则满足第 $X$ 块田地的高度要高于第 $Y$ 块田地的高度。在这之中，有 $M$ 条交错纵横的路径将不同的田地连接起来。

不过，显而易见的是，因为每条路都太陡了，所以这些小路只能沿着从高到低的方向走。例如，一条连接第 $5$ 块田地和 $8$ 块田地的小路只能沿着 $5\to 8$ 的方向走，而不能沿着其他方向，因为那样会成为上坡路。每两块田地最多只能有一条路径相连接，所以一定有 $M \leq \dfrac{N(N-1)}{2}$。

有可能的是，$\texttt{Bessie}$ 和 $\texttt{Elsie}$ 两个人走同一条小路会耗费不同的时间；比如，通过同一条小路，$\texttt{Bessie}$ 可能会耗费 $10$ 个单位的时间，而 $\texttt{Elsie}$ 会耗费 $20$ 个单位的时间。

此外，$\texttt{Bessie}$ 和 $\texttt{Elsie}$ 只会在通过连接两块田地的小路时耗费时间——因为她们太匆忙了，在穿过田地时不会耗费任何时间，也从来不在任何地方停下来等待。

现在，请你判断出，能够满足使 $\texttt{Bessie}$ 和 $\texttt{Elsie}$ 同时出发并且同时到达她们喜欢的田地的最短的时间。

### 输入格式

第一行输入 $N$ 和 $M$，中间用空格分开。

接下来的 $M$ 行，每行有四个整数 $A,B,C,D$，其中，$A$ 和$B(A<B)$ 代表着两块用这条小路连接的田地，$C$ 代表 $\texttt{Bessie}$ 通过这条小路的时间，而 $D$ 代表 $\texttt{Elsie}$ 通过这条小路的时间。$C$ 和 $D$ 均在 $1\cdots100$ 的范围之内。

### 输出格式

一个整数，输出的是能够使两人同时出发并且同时到达目的地的最短时间，如果没有满足条件的答案，则输出 `IMPOSSIBLE`。

### 说明与提示

$\texttt{Bessie}$ 在每一条路都比 $\texttt{Elsie}$ 快两倍。

如果 $\texttt{Bessie}$ 经过 $1\to 2\to 3$ 的路线，$\texttt{Elsie}$ 经过 $1\to 3$ 的路线，他们可以同时到达。


---

---
title: "[USACO15DEC] Max Flow P"
layout: "post"
diff: 普及+/提高
pid: P3128
tag: ['2015', 'USACO', '最近公共祖先 LCA', '树链剖分', '差分']
---
# [USACO15DEC] Max Flow P
## 题目描述

Farmer John has installed a new system of $N-1$ pipes to transport milk between the $N$ stalls in his barn ($2 \leq N \leq 50,000$), conveniently numbered $1 \ldots N$. Each pipe connects a pair of stalls, and all stalls are connected to each-other via paths of pipes.

FJ is pumping milk between $K$ pairs of stalls ($1 \leq K \leq 100,000$). For the $i$th such pair,  you are told two stalls $s_i$ and $t_i$, endpoints of a path along which milk is being pumped at a unit rate. FJ is concerned that some stalls might end up overwhelmed with all the milk being pumped through them, since a stall can serve as a waypoint along many of the $K$ paths along which milk is being pumped. Please help him determine the maximum amount of milk being pumped through any stall. If milk is being pumped along a path from $s_i$ to $t_i$, then it counts as being pumped through the endpoint stalls $s_i$ and $t_i$, as well as through every stall along the path between them.
## 输入格式

The first line of the input contains $N$ and $K$.

The next $N-1$ lines each contain two integers $x$ and $y$ ($x \ne y$) describing a pipe between stalls $x$ and $y$.

The next $K$ lines each contain two integers $s$ and $t$ describing the endpoint stalls of a path through which milk is being pumped.

## 输出格式

An integer specifying the maximum amount of milk pumped through any stall in the barn.
## 样例

### 样例输入 #1
```
5 10
3 4
1 5
4 2
5 4
5 4
5 4
3 5
4 3
4 3
1 3
3 5
5 4
1 5
3 4
```
### 样例输出 #1
```
9
```
## 提示

$2 \le N \le 5 \times 10^4,1 \le K \le 10^5$
## 题目翻译

### 题目描述

Farmer John 在他的谷仓中安装了 $N-1$ 条管道，用于在 $N$ 个牛棚之间运输牛奶（$2 \leq N \leq 50,000$），牛棚方便地编号为 $1 \ldots N$。每条管道连接一对牛棚，所有牛棚通过这些管道相互连接。

FJ 正在 $K$ 对牛棚之间泵送牛奶（$1 \leq K \leq 100,000$）。对于第 $i$ 对牛棚，你被告知两个牛棚 $s_i$ 和 $t_i$，这是牛奶以单位速率泵送的路径的端点。FJ 担心某些牛棚可能会因为过多的牛奶通过它们而不堪重负，因为一个牛棚可能会作为许多泵送路径的中转站。请帮助他确定通过任何一个牛棚的最大牛奶量。如果牛奶沿着从 $s_i$ 到 $t_i$ 的路径泵送，那么它将被计入端点牛棚 $s_i$ 和 $t_i$，以及它们之间路径上的所有牛棚。

### 输入格式

输入的第一行包含 $N$ 和 $K$。

接下来的 $N-1$ 行每行包含两个整数 $x$ 和 $y$（$x \ne y$），描述连接牛棚 $x$ 和 $y$ 的管道。

接下来的 $K$ 行每行包含两个整数 $s$ 和 $t$，描述牛奶泵送路径的端点牛棚。

### 输出格式

输出一个整数，表示通过谷仓中任何一个牛棚的最大牛奶量。

### 说明/提示

$2 \le N \le 5 \times 10^4,1 \le K \le 10^5$。


---

---
title: "[USACO15DEC] Counting Haybale P"
layout: "post"
diff: 普及+/提高
pid: P3130
tag: ['2015', '线段树', 'USACO']
---
# [USACO15DEC] Counting Haybale P
## 题目描述

Farmer John is trying to hire contractors to help rearrange his farm, but so far all of them have quit when they saw the complicated sequence of instructions FJ wanted them to follow.  Left to complete the project by himself, he realizes that indeed, he has made the project perhaps more  complicated than necessary.  Please help him follow his instructions to  complete the farm upgrade.

FJ's farm consists of $N$ fields in a row, conveniently numbered $1 \ldots N$. In each field there can be any number of haybales.  Farmer John's instructions contain three types of entries:

1) Given a contiguous interval of fields, add a new haybale to each field.

2) Given a contiguous interval of fields, determine the minimum number of haybales in a field within that interval.

3) Given a contiguous interval of fields, count the total number of haybales  inside that interval.
## 输入格式

The first line contains two positive integers, $N$ ($1 \leq N \leq 200,000$) and $Q$ ($1 \leq Q \leq 100,000$).

The next line contains $N$ nonnegative integers, each at most 100,000, indicating how many haybales are initially in each field.

Each of the next $Q$ lines contains a single uppercase letter, either M, P or S, followed by either two positive integers $A$ and $B$ ($1 \leq A \leq B \leq N$), or three positive integers $A$, $B$, and $C$ ($1 \leq A \leq B \leq N$; $1 \leq C \leq 100,000$).  There will be three positive integers if and only if the uppercase letter is P.

If the letter is M, print the minimum number of haybales in the interval of fields from $A \ldots B$.

If the letter is P, put $C$ new haybales in each field in the interval of fields from $A \ldots B$.

If the letter is S, print the total number of haybales found within interval of fields from $A \ldots B$.
## 输出格式

A line in the output should appear in response to every 'M' or 'S' entry in FJ's instructions.
## 样例

### 样例输入 #1
```
4 5
3 1 2 4
M 3 4
S 1 3
P 2 3 1
M 3 4
S 1 3
```
### 样例输出 #1
```
2
6
3
8
```
## 题目翻译

### 题目描述

Farmer John 正在尝试雇佣承包商来帮助他重新安排农场，但到目前为止，所有承包商在看到 FJ 希望他们遵循的复杂指令序列后都辞职了。FJ 不得不自己完成这个项目，他意识到自己可能把项目搞得比必要的还要复杂。请帮助他按照指令完成农场的升级。

FJ 的农场由一排 $N$ 个田地组成，编号为 $1 \ldots N$。每个田地里可以有任意数量的干草堆。Farmer John 的指令包含三种类型的条目：

1) 给定一个连续的田地区间，向每个田地添加一个新的干草堆。

2) 给定一个连续的田地区间，确定该区间内田地中干草堆的最小数量。

3) 给定一个连续的田地区间，计算该区间内干草堆的总数。

### 输入格式

第一行包含两个正整数，$N$（$1 \leq N \leq 200,000$）和 $Q$（$1 \leq Q \leq 100,000$）。

第二行包含 $N$ 个非负整数，每个整数最多为 $100,000$，表示每个田地中初始的干草堆数量。

接下来的 $Q$ 行每行包含一个大写字母，可能是 M、P 或 S，后跟两个正整数 $A$ 和 $B$（$1 \leq A \leq B \leq N$），或者三个正整数 $A$、$B$ 和 $C$（$1 \leq A \leq B \leq N$；$1 \leq C \leq 100,000$）。只有当大写字母是 P 时，才会有三个正整数。

如果字母是 M，输出从 $A \ldots B$ 的田地区间内干草堆的最小数量。

如果字母是 P，向从 $A \ldots B$ 的田地区间内的每个田地添加 $C$ 个新的干草堆。

如果字母是 S，输出从 $A \ldots B$ 的田地区间内干草堆的总数。

### 输出格式

对于 FJ 指令中的每一个 'M' 或 'S' 条目，输出一行相应的结果。


---

---
title: "[USACO16JAN] Lights Out G"
layout: "post"
diff: 普及+/提高
pid: P3134
tag: ['2016', 'USACO', '哈希 hashing']
---
# [USACO16JAN] Lights Out G
## 题目描述

Farmer John has installed a fancy new milking machine in his barn, but it draws so much power that it occasionally causes the power to go out! This happens so often that Bessie has memorized a map of the barn, making it easier for her to find the exit of the barn in the dark. She is curious though about the impact of power loss on her ability to exit the barn quickly. For example, she wonders how much farther she might need to walk find the exit in the dark.


The barn is described by a simple (non self-intersecting) polygon with integer  vertices $(x_1, y_1) \ldots (x_n, y_n)$ listed in clockwise order.  Its edges alternate between horizontal (parallel to the x-axis) and vertical (parallel to the y-axis); the first edge can be of either type. The exit is located at

$(x_1, y_1)$.  Bessie starts inside the barn located at some vertex  $(x_i, y_i)$ for $i > 1$.  She can walk only around the perimeter of the barn, either clockwise or counterclockwise, Her goal is to travel a minimum distance to reach the exit. This is relatively easy to do with the lights on, of course, since she will travel either  clockwise or counterclockwise from her current location to the  exit -- whichever direction is shorter.


One day, the lights go out, causing Bessie to panic and forget which vertex she is standing at.  Fortunately, she still remembers the exact map of the barn, so she can possibly figure out her position by walking around and using her sense of touch.  Whenever she is standing at a vertex (including at her initial vertex), she can feel the exact interior angle at that vertex, and she can tell if that vertex is the exit.  When she walks along an edge of the barn, she can determine the exact length of the edge after walking along the entire edge.  Bessie decides on the following strategy: she will move clockwise around the perimeter of the barn until she has felt enough angles and edges to deduce the vertex at which she is currently located.  At that point, she can easily figure out how to get to the exit by traveling a minimum amount of remaining distance, either by continuing to move clockwise or by switching direction and moving counter-clockwise.


Please help Bessie determine the largest amount by which her travel distance will increase in the worst case (over all possibilities for her starting vertex) for travel in the dark versus in a lit barn.

## 输入格式

The first line of the input contains $N$ ($4 \leq N \leq 200$).  Each of the next $N$ lines contains two integers, describing the points $(x_i, y_i)$ in clockwise order around the barn.  These integers are in the range $-100,000 \ldots 100,000$.

## 输出格式

Output the largest amount that Bessie's travel distance will increase in the

worst case starting position using the strategy in the problem statement.

## 样例

### 样例输入 #1
```
4
0 0
0 10
1 10
1 0
```
### 样例输出 #1
```
2
```
## 提示

In this example, Bessie can feel that she is initially standing at a 90-degree angle, but she cannot tell if she is initially standing at vertex 2, 3, or 4.

After taking a step along one edge in the clockwise direction, Bessie either reaches the exit or can uniquely determine her location based on the length of this edge. The distances she obtains are:

If starting at vertex 2: she travels 12 units in the dark (1 unit to reach vertex 3, then 11 units to continue to the exit). She only needs to travel 10 units in a lit barn. This is an extra distance of 2 for this vertex.

If starting at vertex 3: she travels 11 units in both cases.

If starting at vertex 4: she travels 1 unit in both cases.

The worst-case difference over all starting points is therefore 12 - 10 = 2.  That is, Bessie can guarantee that using her strategy, no matter where she starts, she will travel at most 2 extra units of distance farther in the dark than in the light.

## 题目翻译

### 题目描述

Farmer John 在他的谷仓里安装了一个非常不错的新挤奶机，但是这台挤奶机耗电太多了，有时候会让谷仓直接停电！这种事发生的太频繁了，以至于 Bessie 直接把谷仓的地图背过了，以便于可以在黑暗中找到谷仓的出口。她对于停电对于她快速离开谷仓的能力的影响非常好奇。比如说，她想知道她在黑暗中需要走多远来找到谷仓的出口。

谷仓里的路可以被描述为是一个简单的用几个顶点来表示的多边形，这些顶点可以按照顺时针被表示为 $(x_1, y_1) \cdots (x_n, y_n)$（保证这些顶点连成的线没有交叉的情况）。这些点构成的边在水平轴（平行于 $x$ 轴）和竖直轴（平行于 $y$ 轴）之间交替出现。第一条边可以是任意一种类型。谷仓出口在坐标 $(x_1, y_1)$ 。Bessie 从谷仓内任意一个点 $(x_i, y_i)$ 开始走。她只可以沿着这些边走，要不然是顺时针，要不然就是逆时针，她的目标就是以最短距离抵达出口。当然，如果灯亮着的话这个事还算相对简单，因为她要不然顺时针要不然逆时针走，无所谓哪个方向的路程更短一点。

一天，谷仓突然停电了，导致 Bessie 受到惊吓、忘记了她站在哪个顶点。幸亏她还记得谷仓的准确地图，所以她可以四处走走，用她的触觉来弄清楚她的位置。不管什么时候，只要她站在一个顶点，那么她就可以感受到她在这个点的朝向角度，弄清楚这个点是不是出口。当她沿着谷仓的一个边走完的时候，她可以算出精确的边长。Bessie 决定用这么一个策略：她会顺时针沿着谷仓周围的边走，直到她知道了足够的角度和边、可以推断出她目前在的是哪个顶点。在那个顶点，她就可以轻易地弄清楚怎样以最短距离到达出口（要不然继续沿着顺时针走，要不然倒回去沿着逆时针走）。

请帮助 Bessie 算出在起点可以是任何一个顶点情况下，在最坏的情况下，她在黑暗中和亮着灯的时候到达出口的距离的差值（即找到差值的最大值）。

### 输入格式

第一行包括一个数字 $N (4 \leqslant N \leqslant 200)$ ，接下来 $N$ 行，每行包括两个数字，沿着顺时针表示顶点 $(x_i, y_i)$，$x_i, y_i \in [-10^5, 10^5]$ 。

### 输出格式

输出 Bessie 在最坏的情况下，她在黑暗中和亮着灯的时候到达出口的距离的差值（即找到差值的最大值）。

### 说明/提示

在这个样例中，Bessie 开始可以感觉到她沿着 $90 \degree$ 角站着，但是她辨别不出来她是在 $2, 3, 4$ 中的哪一个顶点。

在走了一条边以后，Bessie 要不然到了出口要不然就可以根据她走过的距离推断出她的位置。情况如下：

如果她从 $2$ 号点开始走，她需要在黑暗中走 $12$ 个单位，包括一个单位到达第三个点、十一个单位离开谷仓。同时，如果亮着灯，她可以只走 $10$ 个单位就离开谷仓。差值是 $2$ 。

如果从 $3$ 号点开始，她两种情况都要走 $11$ 个单位。

如果从 $4$ 号点开始，她两种情况都要走 $1$ 个单位。

所以最坏情况差值是 $2$ 。


---

---
title: "[USACO16FEB] Circular Barn S"
layout: "post"
diff: 普及+/提高
pid: P3137
tag: ['贪心', '2016', 'USACO', '枚举']
---
# [USACO16FEB] Circular Barn S
## 题目背景

*本题与 [金组同名题目](/problem/P6170) 在题意上一致，唯一的差别是数据范围。*
## 题目描述

作为当代建筑的爱好者，Farmer John 建造了一个圆形新谷仓，谷仓内部 $n$ 个房间排成环形（$3 \leq n \leq 1000$），按顺时针顺序编号为 $1\ldots n$，每个房间都有通往与其相邻的左右房间的门，还有一扇门通往外面。

现在 FJ 有 $n$ 头奶牛，他的目标是让每个房间恰好有一头奶牛。然而不幸的是，现在奶牛们随意呆在某个房间里，第 $i$ 个房间里有 $c_i$ 头奶牛。保证 $\sum c_i =n$。

FJ 决定采用这样的方法来解决这个问题：让某些奶牛**顺时针**穿过某些房间到达指定的位置。如果一头奶牛穿过了 $d$ 扇门，他消耗的能量为 $d^2$。你需要帮 FJ 算出所有奶牛消耗的能量和最小值是多少。
## 输入格式

第一行一个整数 $n$，接下来 $n$ 行，第 $i$ 行一个整数 $c_i$。
## 输出格式

输出所有奶牛最小消耗能量和。
## 样例

### 样例输入 #1
```
10
1
0
0
2
0
0
1
2
2
2
```
### 样例输出 #1
```
33
```


---

---
title: "[USACO16FEB] Circular Barn Revisited G"
layout: "post"
diff: 普及+/提高
pid: P3140
tag: ['动态规划 DP', '2016', 'USACO']
---
# [USACO16FEB] Circular Barn Revisited G
## 题目描述

After the last debacle involving Farmer John's circular barn, one would think he had learned his lesson about non-traditional architecture.  However, he thinks he can still make his circular barn (from the preceding problem) function properly by allowing multiple cows into each room.  To recap, the barn consists of a ring of $n$ rooms,  numbered clockwise from $1 \ldots n$ around the perimeter of the barn ($3 \leq n \leq 100$).  Each room has doors to its two neighboring rooms, and also a door opening to the exterior of the barn.

Farmer John wants exactly $r_i$ cows to end up in room $i$ ($1 \leq r_i \leq 1,000,000$). To herd the cows into the barn in an orderly fashion, he plans to unlock $k$ exterior doors ($1 \leq k \leq 7$), allowing the cows to enter through only those doors. Each cow then walks clockwise through the rooms until she reaches a suitable destination.  Farmer John wants to unlock the exterior doors that will cause his cows to collectively walk a minimum total amount of distance after entering the barn (they can initially line up however they like outside the $k$ unlocked doors; this does not contribute to the total distance in question).  Please determine the minimum total distance his cows will need to walk, if he chooses the best $k$ such doors to unlock.
## 输入格式

The first line of input contains $n$ and $k$.  Each of the remaining $n$ lines contain $r_1 \ldots r_n$.

## 输出格式

Please write out the minimum amount of distance the cows need to travel.

## 样例

### 样例输入 #1
```
6 2
2
5
4
2
6
2
```
### 样例输出 #1
```
14
```
## 提示

Farmer John can unlock doors 2 and 5.  11 cows enter at door 2 and walk a total distance of 8 to get to rooms 2, 3, and 4.  10 cows enter at door 5 and walk a total distance of 6 to get to rooms 5, 6 and 1.

## 题目翻译

### 题目描述

在上一次涉及 Farmer John 的圆形谷仓的惨败之后，人们可能会认为他已经吸取了关于非传统建筑的教训。然而，他认为通过允许每间房间进入多头奶牛，仍然可以让他那个圆形谷仓（来自之前的问题）正常运作。回顾一下，谷仓由 $n$ 个房间组成，这些房间顺时针编号为 $1 \ldots n$，围绕谷仓的周边排列（$3 \leq n \leq 100$）。每个房间都有通往两个相邻房间的门，还有一扇门通向谷仓的外部。

Farmer John 希望最终有恰好 $r_i$ 头奶牛进入房间 $i$（$1 \leq r_i \leq 1,000,000$）。为了让奶牛有序地进入谷仓，他计划解锁 $k$ 扇外部门（$1 \leq k \leq 7$），只允许奶牛通过这些门进入。每头奶牛随后顺时针穿过房间，直到到达合适的目的地。Farmer John 希望解锁那些能让他的奶牛在进入谷仓后总共行走的距离最小的外部门（它们最初可以在 $k$ 扇解锁的门外任意排列；这不会计入总距离）。请确定如果他选择最佳的 $k$ 扇门解锁，他的奶牛需要行走的最小总距离。

### 输入格式

输入的第一行包含 $n$ 和 $k$。接下来的 $n$ 行每行包含 $r_1 \ldots r_n$。

### 输出格式

请输出奶牛需要行走的最小距离。

### 说明/提示

Farmer John 可以解锁门 2 和门 5。11 头奶牛从门 2 进入，总共行走 8 的距离到达房间 2、3 和 4。10 头奶牛从门 5 进入，总共行走 6 的距离到达房间 5、6 和 1。


---

---
title: "[USACO16OPEN] Splitting the Field G"
layout: "post"
diff: 普及+/提高
pid: P3145
tag: ['2016', 'USACO', '枚举', '排序', 'ST 表']
---
# [USACO16OPEN] Splitting the Field G
## 题目描述

Farmer John's $N$ cows ($3 \leq N \leq 50,000$) are all located at distinct positions in his two-dimensional field.  FJ wants to enclose all of the cows with a rectangular fence whose sides are parallel to the x and y axes, and hewants this fence to be as small as possible so that it contains every cow (cowson the boundary are allowed).

FJ is unfortunately on a tight budget due to low milk production last quarter.He would therefore like to enclose a smaller area to reduce maintenance costs,and the only way he can see to do this is by building two enclosures instead of one.  Please help him compute how much less area he needs to enclose, in total,by using two enclosures instead of one. Like the original enclosure, the two enclosures must collectively contain all the cows (with cows on boundaries allowed), and they must have sides parallel to the x and y axes.  The two enclosures are not allowed to overlap -- not even on their boundaries. Note that enclosures of zero area are legal, for example if an enclosure has zero width and/or zero height.
## 输入格式

The first line of input contains $N$.  The next $N$ lines each contain two integers specifying the location of a cow. Cow locations are positive integers in the range $1 \ldots 1,000,000,000$.
## 输出格式

Write a single integer specifying amount of total area FJ can save by using two enclosures instead of one.
## 样例

### 样例输入 #1
```
6
4 2
8 10
1 1
9 12
14 7
2 3
```
### 样例输出 #1
```
107
```
## 题目翻译

### 题目描述

Farmer John 的 $N$ 头奶牛（$3 \leq N \leq 50,000$）位于他二维牧场的不同位置。FJ 想要用一个与 x 轴和 y 轴平行的矩形围栏将所有奶牛围住，并且他希望这个围栏尽可能小，以便它包含每一头奶牛（允许奶牛位于边界上）。

由于上季度牛奶产量低，FJ 的预算紧张。因此，他希望围住更小的区域以减少维护成本，而他唯一能想到的方法就是建造两个围栏而不是一个。请帮助他计算使用两个围栏而不是一个围栏总共可以减少多少面积。与原始围栏一样，这两个围栏必须共同包含所有奶牛（允许奶牛位于边界上），并且它们的边必须与 $x$ 轴和 $y$ 轴平行。这两个围栏不允许重叠——即使在它们的边界上也不行。注意，零面积的围栏是合法的，例如如果一个围栏的宽度和/或高度为零。

### 输入格式

输入的第一行包含 $N$。接下来的 $N$ 行每行包含两个整数，指定一头奶牛的位置。奶牛的位置是 $1 \ldots 1,000,000,000$ 范围内的正整数。

### 输出格式

输出一个整数，表示 FJ 通过使用两个围栏而不是一个围栏总共可以减少的面积。


---

---
title: "[USACO16OPEN] 248 G"
layout: "post"
diff: 普及+/提高
pid: P3146
tag: ['动态规划 DP', '贪心', '2016', 'USACO', '区间 DP']
---
# [USACO16OPEN] 248 G
## 题目描述

Bessie likes downloading games to play on her cell phone, even though she  doesfind the small touch screen rather cumbersome to use with her large hooves.

She is particularly intrigued by the current game she is playing.The game starts with a sequence of $N$ positive integers ($2 \leq N\leq 248$), each in the range $1 \ldots 40$. In one move, Bessie cantake two adjacent numbers with equal values and replace them a singlenumber of value one greater (e.g., she might replace two adjacent 7s with an 8).  The goal is to maximize the value of the largest numberpresent in the sequence at the end of the game.  Please help Bessiescore as highly as possible!

## 输入格式

The first line of input contains $N$, and the next $N$ lines give the sequence of $N$ numbers at the start of the game.

## 输出格式

Please output the largest integer Bessie can generate.

## 样例

### 样例输入 #1
```
4
1
1
1
2
```
### 样例输出 #1
```
3
```
## 提示

In this example shown here, Bessie first merges the second and third 1s to obtain the sequence 1 2 2, and then she merges the 2s into a 3. Note that it is not optimal to join the first two 1s.

## 题目翻译

### 题目描述

贝西喜欢在手机上下载游戏来玩，尽管她确实觉得对于自己巨大的蹄子来说，小小的触摸屏用起来相当笨拙。

她对当前正在玩的这个游戏特别感兴趣。游戏开始时给定一个包含 $N$ 个正整数的序列（$2 \leq N \leq 248$），每个数的范围在 $1 \ldots 40$ 之间。在一次操作中，贝西可以选择两个相邻且相等的数，将它们替换为一个比原数大 1 的数（例如，她可以将两个相邻的 7 替换为一个 8）。游戏的目标是最大化最终序列中的最大数值。请帮助贝西获得尽可能高的分数！

### 输入格式

第一行输入包含 $N$，接下来的 $N$ 行给出游戏开始时序列的 $N$ 个数字。

### 输出格式

请输出贝西能生成的最大整数。

### 说明/提示

在示例中，贝西首先合并第二个和第三个 1，得到序列 1 2 2，然后将两个 2 合并为 3。注意，合并前两个 1 并不是最优策略。


---

---
title: "[USACO17JAN] Balanced Photo G"
layout: "post"
diff: 普及+/提高
pid: P3608
tag: ['2017', 'USACO', '树状数组', '枚举', '前缀和']
---
# [USACO17JAN] Balanced Photo G
## 题目描述

Farmer John is arranging his $N$ cows in a line to take a photo ($1 \leq N \leq 100,000$). The height of the $i$th cow in sequence is $h_i$, and the heights of all cows are distinct.

As with all photographs of his cows, FJ wants this one to come out looking as nice as possible. He decides that cow $i$ looks "unbalanced" if $L_i$ and $R_i$ differ by more than factor of 2, where $L_i$ and $R_i$ are the number of cows taller than $i$ on her left and right, respectively. That is, $i$ is unbalanced if the larger of $L_i$ and $R_i$ is strictly more than twice the smaller of these two numbers. FJ is hoping that not too many of his cows are unbalanced.

Please help FJ compute the total number of unbalanced cows.


## 输入格式

The first line of input contains $N$.  The next $N$ lines contain $h_1 \ldots h_N$, each a nonnegative integer at most 1,000,000,000.


## 输出格式

Please output a count of the number of cows that are unbalanced.


## 样例

### 样例输入 #1
```
7
34
6
23
0
5
99
2
```
### 样例输出 #1
```
3
```
## 题目翻译

### 题目描述

FJ 正在安排他的 $N$ 头奶牛站成一排来拍照（$1\le N \le 10^5$）。序列中的第 $i$ 头奶牛的高度是 $h_i$，且序列中所有的奶牛的身高都不同。

就像他的所有牛的照片一样，FJ希望这张照片看上去尽可能好。他认为，如果 $L_i$ 和 $R_i$ 的数目相差 $1$ 倍以上，第 $i$ 头奶牛就是不平衡的（$L_i$ 和 $R_i$ 分别代表第 $i$ 头奶牛左右两边比她高的奶牛的数量）。也就是说，如果 $L_i$ 和 $R_i$ 中的较大数大于较小数的 $2$ 倍，第 $i$ 头奶牛就是不平衡的。FJ 不希望他有太多的奶牛不平衡。

请帮助 FJ 计算不平衡的奶牛数量。

### 输入格式

第一行一个整数 $N$。

接下 $N$ 行包括 $H_1$ 到 $H_n$，每行一个不超过 $10^9$ 的非负整数。

### 输出格式

请输出不平衡的奶牛数量。


---

---
title: "[USACO17JAN] Hoof, Paper, Scissor G"
layout: "post"
diff: 普及+/提高
pid: P3609
tag: ['模拟', '搜索', '2017', 'USACO', '枚举', '记忆化搜索']
---
# [USACO17JAN] Hoof, Paper, Scissor G
## 题目背景

*本题与 [银组同名题目](/problem/P6120) 在题意上一致，唯一的差别在于对变手势次数的限制。*

## 题目描述

你可能玩过“石头，剪刀，布”，这个游戏在奶牛中同样流行，不过它的名字变成了“蹄子，剪刀，布”。

“蹄子，剪刀，布”和“石头，剪刀，布”的规则十分类似，两只奶牛数到三，然后出一个代表蹄子，剪刀或布的手势。蹄子胜过剪刀，剪刀胜过布，布胜过蹄子。特别地，如果两只奶牛的手势相同，则视为平局。

现在 FJ 和 Bassie 要进行 $N$ 轮对抗。Bassie 已经预测了 FJ 每一轮要出的手势。然而 Bassie 很懒，她最多只想变换 $K$ 次手势。

现在请你帮 Bassie 求出她最多能赢多少轮。
## 输入格式

第一行输入两个整数 $N,K$（$1 \leq N \leq 10^5$，$0 \leq K \leq 20$）。

接下来 $N$ 行，每行一个字母，代表 FJ 这一轮出的手势。`H` 代表蹄子（Hoof），`S` 代表剪刀（Scissors），`P` 代表布（Paper）。
## 输出格式

输出一个整数，代表 Bassie 在最多变换 $K$ 次手势的前提下最多赢多少轮。
## 样例

### 样例输入 #1
```
5 1
P
P
H
P
S
```
### 样例输出 #1
```
4

```


---

---
title: "[USACO17JAN] Cow Dance Show S"
layout: "post"
diff: 普及+/提高
pid: P3611
tag: ['模拟', '2017', '线段树', '二分', 'USACO', '优先队列', '队列']
---
# [USACO17JAN] Cow Dance Show S
## 题目描述

After several months of rehearsal, the cows are just about ready to put on their annual dance performance; this year they are performing the famous bovine ballet "Cowpelia".

The only aspect of the show that remains to be determined is the size of the stage. A stage of size $K$ can support $K$ cows dancing simultaneously. The $N$ cows in the herd ($1 \leq N \leq 10,000$) are conveniently numbered $1 \ldots N$ in the order in which they must appear in the dance. Each cow $i$ plans to dance for a specific duration of time $d(i)$. Initially, cows $1 \ldots K$ appear on stage and start dancing. When the first of these cows completes her part, she leaves the stage and cow $K+1$ immediately starts dancing, and so on, so there are always $K$ cows dancing (until the end of the show, when we start to run out of cows). The show ends when the last cow completes her dancing part, at time $T$.

Clearly, the larger the value of $K$, the smaller the value of $T$. Since the show cannot last too long, you are given as input an upper bound $T_{max}$ specifying the largest possible value of $T$. Subject to this constraint, please determine the smallest possible value of $K$.


## 输入格式

The first line of input contains $N$ and $T_{max}$, where $T_{max}$ is an integer of value at most 1 million.

The next $N$ lines give the durations $d(1) \ldots d(N)$ of the dancing parts for cows $1 \ldots N$. Each $d(i)$ value is an integer in the range $1 \ldots 100,000$.

It is guaranteed that if $K=N$, the show will finish in time.


## 输出格式

Print out the smallest possible value of $K$ such that the dance performance will take no more than $T_{max}$ units of time.


## 样例

### 样例输入 #1
```
5 8
4
7
8
6
4
```
### 样例输出 #1
```
4

```
## 题目翻译

### 题目描述

经过几个月的排练，奶牛们基本准备好展出她们的年度舞蹈表演。今年她们要表演的是著名的奶牛芭蕾——“cowpelia”。

表演唯一有待决定的是舞台的尺寸。一个大小为 $K$ 的舞台可以支持 $K$ 头牛同时在舞台上跳舞。在牛群中的 $N$ 头牛按照她们必须出现在舞蹈中的顺序方便地编号为 $1,2,\dots,N$。第 $i$ 头牛计划跳 $d_i$ 的特定持续时间。
一开始，第 $1,2,\dots,K$ 头牛出现在舞台上并开始跳舞。当这些牛中的某一头牛首先完成了她的部分，她会马上离开舞台并且第 $K+1$ 头牛会出现在舞台上并开始跳舞。所以，舞台上总有 $K$ 头奶牛在跳舞（直到表演的尾声，奶牛不够的时候）。当最后一头奶牛完成了她的舞蹈部分，表演结束，共花了 $T$ 个单位时间。

显然，$K$ 的值越大，$T$ 就越小。由于表演不能拖太长，你得知了指定 $T$ 的最大可能值的上限 $T_{max}$。请根据这个约束，确定 $K$ 的最小值。

### 输入格式

第一行包括 $N$ 和 $T_{max}$ 两个整数。

接下来的 $N$ 行，第 $i$ 行给出了第 $i$ 头牛跳舞的持续时间 $d_i$。第 $i$ 行包括一个整数 $d_i$。

保证 $K=N$ 时表演会按时完成。

### 输出格式

输出在表演时间不大于 $T_{max}$ 时的 $K$ 的最小可能值。

### 提示说明

对于 $100\%$ 的数据，$1 \le N \le 10^4$，$T_{max} \le 10^6$，$1 \le d_i \le 10^5$。


---

---
title: "[USACO17FEB] Why Did the Cow Cross the Road I S"
layout: "post"
diff: 普及+/提高
pid: P3661
tag: ['贪心', '2017', 'USACO', '排序']
---
# [USACO17FEB] Why Did the Cow Cross the Road I S
## 题目描述

Farmer John's cows are trying to learn to cross the road effectively. Remembering the old "why did the chicken cross the road?" joke, they figure the chickens must be experts on crossing the road, and go off in search of chickens to help them.

As it turns out, chickens are very busy creatures and have limited time to help the cows. There are $C$ chickens on the farm ($1 \leq C \leq 20,000$), conveniently numbered $1 \ldots C$, and each chicken $i$ is only willing to help a cow at precisely time $T_i$. The cows, never in a hurry, have more flexibility in their schedules. There are $N$ cows on the farm ($1 \leq N \leq 20,000$), conveniently numbered $1 \ldots N$, where cow $j$ is able to cross the road between time $A_j$ and time $B_j$. Figuring the "buddy system" is the best way to proceed, each cow $j$ would ideally like to find a chicken $i$ to help her cross the road; in order for their schedules to be compatible, $i$ and $j$ must satisfy $A_j \leq T_i \leq B_j$.

If each cow can be paired with at most one chicken and each chicken with at most one cow, please help compute the maximum number of cow-chicken pairs that can be constructed.
## 输入格式

The first line of input contains $C$ and $N$. The next $C$ lines contain $T_1 \ldots T_C$, and the next $N$ lines contain $A_j$ and $B_j$ ($A_j \leq B_j$) for $j = 1 \ldots N$. The $A$'s, $B$'s, and $T$'s are all non-negative integers (not necessarily distinct) of size at most 1,000,000,000
## 输出格式

Please compute the maximum possible number of cow-chicken pairs.

## 样例

### 样例输入 #1
```
5 4
7
8
6
2
9
2 5
4 9
0 3
8 13
```
### 样例输出 #1
```
3
```
## 题目翻译

### 题目描述

Farmer John 的奶牛们正在学习如何有效地过马路。回想起古老的“鸡为什么要过马路？”笑话，他们认为鸡一定是过马路的专家，于是去寻找鸡来帮助它们。

事实上，鸡是非常忙碌的生物，它们只有有限的时间来帮助奶牛。农场上有 $C$ 只鸡（$1 \leq C \leq 20,000$），方便地用编号 $1 \ldots C$ 标识，每只鸡 $i$ 只愿意在确切的时间 $T_i$ 帮助一头奶牛。奶牛们从不着急，它们的日程安排更加灵活。农场上有 $N$ 头奶牛（$1 \leq N \leq 20,000$），方便地用编号 $1 \ldots N$ 标识，其中奶牛 $j$ 能够在时间 $A_j$ 到时间 $B_j$ 之间过马路。考虑到“伙伴系统”是最好的方式，每头奶牛 $j$ 理想情况下希望找到一只鸡 $i$ 来帮助她过马路；为了使它们的日程安排兼容，$i$ 和 $j$ 必须满足 $A_j \leq T_i \leq B_j$。

如果每头奶牛最多只能与一只鸡配对，每只鸡也最多只能与一头奶牛配对，请计算可以构建的最大奶牛-鸡配对数。

### 输入格式

输入的第一行包含 $C$ 和 $N$。接下来的 $C$ 行包含 $T_1 \ldots T_C$，接下来的 $N$ 行包含 $A_j$ 和 $B_j$（$A_j \leq B_j$），其中 $j = 1 \ldots N$。$A$、$B$ 和 $T$ 都是不超过 1,000,000,000 的非负整数（不一定互不相同）。

### 输出格式

请计算可能的奶牛-鸡配对的最大数量。


---

---
title: "[USACO17FEB] Why Did the Cow Cross the Road III S"
layout: "post"
diff: 普及+/提高
pid: P3663
tag: ['2017', 'USACO', '广度优先搜索 BFS', '深度优先搜索 DFS', '连通块']
---
# [USACO17FEB] Why Did the Cow Cross the Road III S
## 题目描述

Why did the cow cross the road? Well, one reason is that Farmer John's farm simply has a lot of roads, making it impossible for his cows to travel around without crossing many of them.

FJ's farm is arranged as an $N \times N$ square grid of fields ($2 \leq N \leq 100$), Certain pairs of adjacent fields (e.g., north-south or east-west) are separated by roads, and a tall fence runs around the external perimeter of the entire grid, preventing cows from leaving the farm. Cows can move freely from any field to any other adjacent field (north, east, south, or west), although they prefer not to cross roads unless absolutely necessary.

There are $K$ cows ($1 \leq K \leq 100, K \leq N^2$) on FJ's farm, each located in a different field. A pair of cows is said to be "distant" if, in order for one cow to visit the other, it is necessary to cross at least one road. Please help FJ count the number of distant pairs of cows.
## 输入格式

The first line of input contains $N$, $K$, and $R$. The next $R$ lines describe $R$ roads that exist between pairs of adjacent fields. Each line is of the form $r$ $c$ $r'$ $c'$ (integers in the range $1 \ldots N$), indicating a road between the field in (row $r$, column $c$) and the adjacent field in (row $r'$, column $c'$). The final $K$ lines indicate the locations of the $K$ cows, each specified in terms of a row and column.
## 输出格式

Print the number of pairs of cows that are distant.
## 样例

### 样例输入 #1
```
3 3 3
2 2 2 3
3 3 3 2
3 3 2 3
3 3
2 2
2 3
```
### 样例输出 #1
```
2
```
## 题目翻译

### 题目描述

奶牛为什么要过马路？其中一个原因是 Farmer John 的农场有很多道路，使得他的奶牛在四处走动时不可避免地要穿过许多道路。

FJ 的农场被安排成一个 $N \times N$ 的方形网格田地（$2 \leq N \leq 100$），某些相邻的田地（例如南北向或东西向）被道路分隔，整个网格的外部有一圈高高的围栏，防止奶牛离开农场。奶牛可以从任何田地自由移动到相邻的田地（北、东、南或西），尽管它们除非绝对必要，否则不愿意穿过道路。

农场上有 $K$ 头奶牛（$1 \leq K \leq 100, K \leq N^2$），每头奶牛位于不同的田地。如果一头奶牛要拜访另一头奶牛时必须至少穿过一条道路，那么这对奶牛被称为“远距离”对。请帮助 FJ 计算远距离奶牛对的数量。

### 输入格式

输入的第一行包含 $N$、$K$ 和 $R$。接下来的 $R$ 行描述了 $R$ 条存在于相邻田地之间的道路。每行的格式为 $r$ $c$ $r'$ $c'$（范围为 $1 \ldots N$ 的整数），表示位于（行 $r$，列 $c$）的田地与相邻的（行 $r'$，列 $c'$）的田地之间有一条道路。最后的 $K$ 行表示 $K$ 头奶牛的位置，每行用行和列指定。

### 输出格式

输出远距离奶牛对的数量。


---

---
title: "[USACO17OPEN] Where's Bessie? S"
layout: "post"
diff: 普及+/提高
pid: P3671
tag: ['搜索', '2017', 'USACO', '枚举', '连通块']
---
# [USACO17OPEN] Where's Bessie? S
## 题目描述

Always known for being quite tech-savy, Farmer John is testing out his new automated drone-mounted cow locator camera, which supposedly can take a picture of his field and automatically figure out the location of cows. Unfortunately, the camera does not include a very good algorithm for finding cows, so FJ needs your help developing a better one.


The overhead image of his farm taken by the camera is described by an $N \times N$ grid of characters, each in the range $A \ldots Z$, representing one of 26 possible colors. Farmer John figures the best way to define a potential cow location (PCL) is as follows: A PCL is a rectangular sub-grid (possibly the entire image) with sides parallel to the image sides, not contained within any other PCL (so no smaller subset of a PCL is also a PCL).  Furthermore, a PCL must satisfy the following property: focusing on just the contents of the rectangle and ignoring the rest of the image, exactly two colors must be present, one forming a contiguous region and one forming two or more contiguous regions.



```cpp
AAAAA
ABABA
AAABB
```



For example, a rectangle with contents would constitute a PCL, since the A's form a single contiguous region and the B's form more than one contiguous region. The interpretation is a cow of color A with spots of color B. 

A region is "contiguous" if you can traverse the entire region by moving repeatedly from one cell in the region to another cell in the region taking steps up, down, left, or right. 

Given the image returned by FJ's camera, please count the number of PCLs.

## 输入格式

The first line of input contains $N$, the size of the grid ($1 \leq N \leq 20$).

The next $N$ lines describe the image, each consisting of $N$ characters.

## 输出格式

Print a count of the number of PCLs in the image.

## 样例

### 样例输入 #1
```
4
ABBC
BBBC
AABB
ABBC
```
### 样例输出 #1
```
2
```
## 提示

In this example, the two PCLs are the rectangles with contents

```cpp
ABB
BBB
AAB
ABB
```


and

```
BC
BC
BB
BC
```
## 题目翻译

## 题目描述

Farmer John 一直以精通技术而闻名，他正在测试他的新型无人机搭载的奶牛定位相机。这款相机据说可以拍摄他的田地并自动确定奶牛的位置。不幸的是，相机的算法并不擅长寻找奶牛，因此 Farmer John 需要你的帮助来开发一个更好的算法。

相机拍摄的农场俯视图由一个 $N \times N$ 的字符网格描述，每个字符在 $A \ldots Z$ 范围内，代表 26 种可能的颜色之一。Farmer John 认为，定义潜在奶牛位置（PCL）的最佳方式如下：一个 PCL 是一个矩形子网格（可能是整个图像），其边与图像的边平行，并且不包含在任何其他 PCL 中（因此 PCL 的较小子集不能也是 PCL）。此外，PCL 必须满足以下属性：仅关注矩形内的内容并忽略图像的其余部分，必须恰好存在两种颜色，其中一种颜色形成一个连续区域，另一种颜色形成两个或更多连续区域。

例如，一个矩形的内容如下：

```
AAAAA  
ABABA  
AAABB  
```

这将构成一个 PCL，因为 A 形成一个连续区域，而 B 形成多个连续区域。解释为一只颜色为 A 的奶牛带有颜色为 B 的斑点。

一个区域是“连续的”，如果可以通过向上、向下、向左或向右移动，从一个区域中的单元格反复移动到另一个区域中的单元格来遍历整个区域。

给定 Farmer John 的相机返回的图像，请计算 PCL 的数量。

## 输入格式

输入的第一行包含 $N$，表示网格的大小（$1 \leq N \leq 20$）。

接下来的 $N$ 行描述图像，每行包含 $N$ 个字符。

## 输出格式

输出图像中 PCL 的数量。

## 说明/提示

在这个例子中，两个 PCL 分别是内容如下的矩形：

```
ABB  
BBB  
AAB  
ABB
```

和

```
BC  
BC  
BB  
BC  
```


---

---
title: "[USACO17DEC] Barn Painting G"
layout: "post"
diff: 普及+/提高
pid: P4084
tag: ['动态规划 DP', '2017', 'USACO', '树形 DP']
---
# [USACO17DEC] Barn Painting G
## 题目描述

Farmer John has a large farm with $N$ barns ($1 \le N \le 10^5$), some of which are already painted and some not yet painted. Farmer John wants to paint these remaining barns so that all the barns are painted, but he only has three paint colors available. Moreover, his prize cow Bessie becomes confused if two barns that are directly reachable from one another are the same color, so he wants to make sure this situation does not happen.

It is guaranteed that the connections between the $N$ barns do not form any 'cycles'. That is, between any two barns, there is at most one sequence of connections that will lead from one to the other.


How many ways can Farmer John paint the remaining yet-uncolored barns?

## 输入格式

The first line contains two integers $N$ and $K$ ($0 \le K \le N$), respectively the number of barns on the farm and the number of barns that have already been painted.


The next $N-1$ lines each contain two integers $x$ and $y$ ($1 \le x, y \le N, x \neq y$) describing a path directly connecting barns $x$ and $y$.


The next $K$ lines each contain two integers $b$ and $c$ ($1 \le b \le N$, $1 \le c \le 3$) indicating that barn $b$ is painted with color $c$.

## 输出格式

Compute the number of valid ways to paint the remaining barns, modulo $10^9 + 7$, such that no two barns which are directly connected are the same color.

## 样例

### 样例输入 #1
```
4 1
1 2
1 3
1 4
4 3
```
### 样例输出 #1
```
8
```
## 题目翻译

### 题目描述

Farmer John 有一个大农场，农场上有 $N$ 个谷仓（$1 \le N \le 10^5$），其中一些已经涂色，另一些尚未涂色。Farmer John 想要为这些剩余的谷仓涂色，使得所有谷仓都被涂色，但他只有三种可用的油漆颜色。此外，他的获奖奶牛 Bessie 如果发现两个直接相连的谷仓颜色相同，会感到困惑，因此他希望确保这种情况不会发生。

保证 $N$ 个谷仓之间的连接不会形成任何“环”。也就是说，任意两个谷仓之间最多只有一条连接路径。

Farmer John 有多少种方式可以为剩余的未涂色谷仓涂色？

### 输入格式

第一行包含两个整数 $N$ 和 $K$（$0 \le K \le N$），分别表示农场上的谷仓数量和已经涂色的谷仓数量。

接下来的 $N-1$ 行每行包含两个整数 $x$ 和 $y$（$1 \le x, y \le N, x \neq y$），描述直接连接谷仓 $x$ 和 $y$ 的路径。

接下来的 $K$ 行每行包含两个整数 $b$ 和 $c$（$1 \le b \le N$, $1 \le c \le 3$），表示谷仓 $b$ 已经被涂成颜色 $c$。

### 输出格式

计算为剩余谷仓涂色的有效方式数量，模 $10^9 + 7$，要求任何两个直接相连的谷仓颜色不同。


---

---
title: "[USACO17DEC] Haybale Feast G"
layout: "post"
diff: 普及+/提高
pid: P4085
tag: ['2017', '线段树', 'USACO', '前缀和', 'ST 表', '双指针 two-pointer']
---
# [USACO17DEC] Haybale Feast G
## 题目描述

Farmer John is preparing a delicious meal for his cows! In his barn, he has $N$ haybales ($1 \le N \le 100,000$). The $i$th haybale has a certain flavor $F_i$ ($1 \le F_i \le 10^9$) and a certain spiciness $S_i$ ($1 \le S_i \le 10^9$).

The meal will consist of a single course, being a contiguous interval containing one or more consecutive haybales (Farmer John cannot change the order of the haybales). The total flavor of the meal is the sum of the flavors in the interval. The spiciness of the meal is the maximum spiciness of all haybales in the interval.


Farmer John would like to determine the minimum spiciness his single-course meal could achieve, given that it must have a total flavor of at least $M$ ($1 \le M \le 10^{18}$).

## 输入格式

The first line contains the integers $N$ and $M$, the number of haybales and the minimum total flavor the meal must have, respectively. The next $N$ lines describe the $N$ haybales with two integers per line, first the flavor $F$ and then the spiciness $S$.

## 输出格式

Please output the minimum spiciness in a single course meal that satisfies the minimum flavor requirement. There will always be at least one single-course meal that satisfies the flavor requirement.

## 样例

### 样例输入 #1
```
5 10
4 10
6 15
3 5
4 9
3 6
```
### 样例输出 #1
```
9
```
## 题目翻译

### 题目描述

农夫约翰正在为他的奶牛准备一顿美味的晚餐！在他的谷仓里，他有 $N$ 个干草捆 $(1 \le N \le 10^5)$ 。第 $i$ 个干草捆有一定的风味 $F_i(1 \le F_i \le 10^9)$ 和一定的辣度 $S_i(1 \le S_i \le 10^9)$ 。

这顿饭将由一道菜组成，是一个连续的区间，包含一个或多个连续的干草捆(农夫约翰不能改变干草捆的顺序)。这顿饭的总体的风味是这段区间里风味的总和。这顿饭的总体辣度是区间中所有草包的最大辣度。

农夫约翰想确定他的这道菜所能达到的最小辣度，但是这道菜的总风味必须至少为 $M(1 \le M \le 10^{18})$ 。

### 输入格式

第一行包含两个整数 $N$ 和 $M$ ，分别是干草包的数量和这顿饭必须有的最小风味之和。

接下来的 $N$ 行，每行两个整数描述这 $N$ 个草包，首先是风味 $F_i$，然后是辣度 $S_i$。

### 输出格式

请输出这道菜中在满足最低风味时的最低辣度。保证至少有一顿单道菜的饭能满足风味的要求。


---

---
title: "[USACO18JAN] Rental Service S"
layout: "post"
diff: 普及+/提高
pid: P4181
tag: ['贪心', '2018', 'USACO', '排序']
---
# [USACO18JAN] Rental Service S
## 题目描述

Farmer John realizes that the income he receives from milk production is insufficient to fund the growth of his farm, so to earn some extra money, he launches a cow-rental service, which he calls "USACOW" (pronounced "Use-a-cow").

Farmer John has $N$ cows ($1 \leq N \leq 100,000$), each capable of producing some amount of milk every day. The $M$ stores near FJ's farm ($1 \leq M \leq 100,000$) each offer to buy a certain amount of milk at a certain price. Moreover, Farmer John's $R$ ($1 \leq R \leq 100,000$) neighboring farmers are each interested in renting a cow at a certain price.


Farmer John has to choose whether each cow should be milked or rented to a nearby farmer. Help him find the maximum amount of money he can make per day.

## 输入格式

The first line in the input contains $N$, $M$, and $R$. The next $N$ lines each contain an integer $c_i$ ($1 \leq c_i \leq 1,000,000$), indicating that Farmer John's $i$th cow can produce $c_i$ gallons of milk every day. The next $M$ lines each contain two integers $q_i$ and $p_i$ ($1 \leq q_i, p_i \leq 1,000,000$), indicating that the $i$th store is willing to buy up to $q_i$ gallons of milk for $p_i$ cents per gallon. Keep in mind that Farmer John can sell any amount of milk between zero and $q_i$ gallons to a given store. The next $R$ lines each contain an integer $r_i$ ($1 \leq r_i \leq 1,000,000$), indicating that one of Farmer John's neighbors wants to rent a cow for $r_i$ cents per day.

## 输出格式

The output should consist of one line containing the maximum profit Farmer John can make per day by milking or renting out each of his cows. Note that the output might be too large to fit into a standard 32-bit integer, so you may need to use a larger integer type like a "long long" in C/C++.

## 样例

### 样例输入 #1
```
5 3 4
6
2
4
7
1
10 25
2 10
15 15
250
80
100
40
```
### 样例输出 #1
```
725

```
## 提示

Farmer John should milk cows #1 and #4, to produce 13 gallons of milk. He should completely fill the order for 10 gallons, earning 250 cents, and sell the remaining three gallons at 15 cents each, for a total of 295 cents of milk profits.


Then, he should rent out the other three cows for 250, 80, and 100 cents, to earn 430 more cents. (He should leave the request for a 40-cent rental unfilled.) This is a total of 725 cents of daily profit.

## 题目翻译

### 题目描述

Farmer John 意识到牛奶生产的收入不足以支持农场的扩展，因此为了赚取额外收入，他推出了一项奶牛租赁服务，称为“USACOW”（发音为“Use-a-cow”）。

Farmer John 有 $N$ 头奶牛（$1 \leq N \leq 100,000$），每头奶牛每天可以生产一定量的牛奶。附近的 $M$ 家商店（$1 \leq M \leq 100,000$）每家都愿意以一定价格购买一定量的牛奶。此外，Farmer John 的 $R$ 个邻居（$1 \leq R \leq 100,000$）每家都愿意以一定价格租赁一头奶牛。

Farmer John 需要决定每头奶牛是用于产奶还是租给附近的农民。请帮助他计算每天可以赚取的最大金额。

### 输入格式

输入的第一行包含 $N$、$M$ 和 $R$。接下来的 $N$ 行每行包含一个整数 $c_i$（$1 \leq c_i \leq 1,000,000$），表示 Farmer John 的第 $i$ 头奶牛每天可以生产 $c_i$ 加仑牛奶。接下来的 $M$ 行每行包含两个整数 $q_i$ 和 $p_i$（$1 \leq q_i, p_i \leq 1,000,000$），表示第 $i$ 家商店愿意以每加仑 $p_i$ 美分的价格购买最多 $q_i$ 加仑牛奶。请注意，Farmer John 可以向每家商店出售任意数量的牛奶，范围从 $0$ 到 $q_i$ 加仑。接下来的 $R$ 行每行包含一个整数 $r_i$（$1 \leq r_i \leq 1,000,000$），表示 Farmer John 的一个邻居愿意以每天 $r_i$ 美分的价格租赁一头奶牛。

### 输出格式

输出应包含一行，表示 Farmer John 通过产奶或租赁奶牛每天可以获得的最大利润。请注意，输出可能超过标准 32 位整数的范围，因此可能需要使用更大的整数类型，例如 C/C++ 中的 `long long`。

### 提示

Farmer John 应该让奶牛 #1 和 #4 产奶，每天生产 $13$ 加仑牛奶。他应该完全满足 $10$ 加仑的订单，赚取 $250$ 美分，并以每加仑 $15$ 美分的价格出售剩余的 $3$ 加仑，总共赚取 $295$ 美分的牛奶利润。

然后，他应该将其他三头奶牛分别以 $250$、$80$ 和 $100$ 美分的价格租出，赚取额外的 $430$ 美分。（他应该忽略 $40$ 美分的租赁请求。）这样，他每天的总利润为 $725$ 美分。


---

---
title: "[USACO18FEB] Snow Boots S"
layout: "post"
diff: 普及+/提高
pid: P4265
tag: ['动态规划 DP', '2018', 'USACO', '枚举']
---
# [USACO18FEB] Snow Boots S
## 题目描述

It's winter on the farm, and that means snow! There are $N$ tiles on the path from the farmhouse to the barn, conveniently numbered $1 \dots N$, and tile $i$ is covered in $f_i$ feet of snow.
Farmer John starts off on tile $1$ and must reach tile $N$ to wake up the cows. Tile $1$ is sheltered by the farmhouse roof, and tile $N$ is sheltered by the barn roof, so neither of these tiles has any snow. But to step on the other tiles, Farmer John needs to wear boots!

In his foul-weather backpack, Farmer John has $B$ pairs of boots, numbered $1 \dots B$. Some pairs are more heavy-duty than others, and some pairs are more agile than others. In particular, pair $i$ lets FJ step in snow at most $s_i$ feet deep, and lets FJ move at most $d_i$ forward in each step.

Unfortunately, the boots are packed in such a way that Farmer John can only access the topmost pair at any given time. So at any time, Farmer John can either put on the topmost pair of boots (discarding his old pair) or discard the topmost pair of boots (making a new pair of boots accessible).

Farmer John can only change boots while standing on a tile. If that tile has $f$ feet of snow, both the boots he takes off AND the boots he puts on must be able to withstand at least $f$ feet of snow. Intermediate pairs of boots which he discards without wearing do not need to satisfy this restriction.

Help Farmer John minimize waste, by determining the minimum number of pairs of boots he needs to discard in order to reach the barn. You may assume that Farmer John is initially not wearing any boots.
## 输入格式

The first line contains two space-separated integers $N$ and $B$ ($2 \leq N,B \leq 250$).
The second line contains $N$ space-separated integers. The $i$th integer is $f_i$, giving the depth of snow on tile $i$ ($0 \leq f_i \leq 10^9$). It's guaranteed that $f_1 = f_N = 0$.

The next $B$ lines contain two space-separated integers each. The first integer on line $i+2$ is $s_i$, the maximum depth of snow in which pair $i$ can step. The second integer on line $i+2$ is $d_i$, the maximum step size for pair $i$. It's guaranteed that $0 \leq s_i \leq 10^9$ and $1 \leq d_i \leq N-1$.

The boots are described in top-to-bottom order, so pair $1$ is the topmost pair in FJ's backpack, and so forth.
## 输出格式

The output should consist of a single integer, giving the minimum number of boots Farmer John needs to discard. It's guaranteed that it will be possible for FJ to make it to the barn.
## 样例

### 样例输入 #1
```
10 4
0 2 8 3 6 7 5 1 4 0
2 3
4 2
3 4
7 1
```
### 样例输出 #1
```
2

```
## 提示

Problem credits: Brian Dean and Dhruv Rohatgi
## 题目翻译

### 题目描述

农场的冬天到了，这意味着下雪了！从农舍到谷仓的路上有 $N$ 块地砖，方便地编号为 $1 \dots N$，第 $i$ 块地砖上覆盖了 $f_i$ 英尺的雪。

Farmer John 从第 $1$ 块地砖出发，必须到达第 $N$ 块地砖去叫醒奶牛。第 $1$ 块地砖被农舍的屋顶遮蔽，第 $N$ 块地砖被谷仓的屋顶遮蔽，因此这两块地砖上没有雪。但要踩在其他地砖上，Farmer John 需要穿靴子！

在他的恶劣天气背包中，Farmer John 有 $B$ 双靴子，编号为 $1 \dots B$。有些靴子比其他靴子更耐用，有些靴子比其他靴子更灵活。具体来说，第 $i$ 双靴子允许 Farmer John 在最多 $s_i$ 英尺深的雪中行走，并且每步最多可以移动 $d_i$ 块地砖。

不幸的是，靴子的打包方式使得 Farmer John 在任何时候只能访问最上面的一双靴子。因此，Farmer John 可以随时穿上最上面的一双靴子（丢弃旧靴子）或丢弃最上面的一双靴子（使下一双靴子可访问）。

Farmer John 只能在地砖上更换靴子。如果该地砖上有 $f$ 英尺的雪，那么他脱下的靴子和穿上的靴子都必须能够承受至少 $f$ 英尺的雪。他丢弃但未穿过的中间靴子不需要满足此限制。

请帮助 Farmer John 最小化浪费，确定他到达谷仓需要丢弃的最少靴子对数。假设 Farmer John 最初没有穿任何靴子。

### 输入格式

第一行包含两个以空格分隔的整数 $N$ 和 $B$（$2 \leq N, B \leq 250$）。

第二行包含 $N$ 个以空格分隔的整数。第 $i$ 个整数是 $f_i$，表示第 $i$ 块地砖上的雪的深度（$0 \leq f_i \leq 10^9$）。保证 $f_1 = f_N = 0$。

接下来的 $B$ 行每行包含两个以空格分隔的整数。第 $i+2$ 行的第一个整数是 $s_i$，表示第 $i$ 双靴子可以承受的最大雪深。第二个整数是 $d_i$，表示第 $i$ 双靴子的最大步长。保证 $0 \leq s_i \leq 10^9$ 且 $1 \leq d_i \leq N-1$。

靴子按从上到下的顺序描述，因此第 $1$ 双靴子是背包中最上面的一双，依此类推。

### 输出格式

输出应包含一个整数，表示 Farmer John 需要丢弃的最少靴子对数。保证 Farmer John 能够到达谷仓。

### 提示

题目来源：Brian Dean 和 Dhruv Rohatgi


---

---
title: "[USACO18FEB] Taming the Herd G"
layout: "post"
diff: 普及+/提高
pid: P4267
tag: ['动态规划 DP', '2018', 'USACO', '枚举']
---
# [USACO18FEB] Taming the Herd G
## 题目描述

Early in the morning, Farmer John woke up to the sound of splintering wood. It was the cows, and they were breaking out of the barn again!
Farmer John was sick and tired of the cows' morning breakouts, and he decided enough was enough: it was time to get tough. He nailed to the barn wall a counter tracking the number of days since the last breakout. So if a breakout occurred in the morning, the counter would be $0$ that day; if the most recent breakout was $3$ days ago, the counter would read $3$. Farmer John meticulously logged the counter every day.

The end of the year has come, and Farmer John is ready to do some accounting. The cows will pay, he says! But something about his log doesn't look quite right...

Farmer John wants to find out how many breakouts have occurred since he started his log. However, he suspects that the cows have tampered with his log, and all he knows for sure is that he started his log on the day of a breakout. Please help him determine, for each number of breakouts that might have occurred since he started the log, the minimum number of log entries that must have been tampered with.
## 输入格式

The first line contains a single integer $N$ ($1 \leq N \leq 100$), denoting the number of days since Farmer John started logging the cow breakout counter.
The second line contains $N$ space-separated integers. The $i$th integer is a non-negative integer $a_i$ (at most $100$), indicating that on day $i$ the counter was at $a_i$, unless the cows tampered with that day's log entry.
## 输出格式

The output should consist of $N$ integers, one per line. The $i$th integer should be the minimum over all possible breakout sequences with $i$ breakouts, of the number of log entries that are inconsistent with that sequence.
## 样例

### 样例输入 #1
```
6
1 1 2 0 0 1
```
### 样例输出 #1
```
4
2
1
2
3
4
```
## 提示

If there was only 1 breakout, then the correct log would look like 0 1 2 3 4 5, which is 4 entries different from the given log.

If there were 2 breakouts, then the correct log might look like 0 1 2 3 0 1, which is 2 entries different from the given log. In this case, the breakouts occurred on the first and fifth days.

If there were 3 breakouts, then the correct log might look like 0 1 2 0 0 1, which is just 1 entry different from the given log. In this case, the breakouts occurred on the first, fourth, and fifth days.

And so on.

Problem credits: Brian Dean and Dhruv Rohatgi
## 题目翻译

### 题目描述

清晨，Farmer John 被木头碎裂的声音吵醒。原来是奶牛们又一次从谷仓里逃出来了！
Farmer John 对奶牛们的清晨逃跑行为感到厌烦，他决定受够了：是时候采取强硬措施了。他在谷仓的墙上钉了一个计数器，用于记录自上次逃跑以来的天数。因此，如果某天早上发生了逃跑，计数器当天会显示 $0$；如果最近一次逃跑发生在 $3$ 天前，计数器会显示 $3$。Farmer John 每天都会仔细记录计数器的值。

年末到了，Farmer John 准备进行一些统计。他说，奶牛们要为此付出代价！但他发现他的记录似乎有些不对劲……

Farmer John 想知道自从他开始记录以来发生了多少次逃跑。然而，他怀疑奶牛们篡改了他的记录，他唯一能确定的是他开始记录的那天发生了一次逃跑。请帮助他确定，对于可能发生的逃跑次数，记录中必须被篡改的最小条目数。

### 输入格式

第一行包含一个整数 $N$（$1 \leq N \leq 100$），表示 Farmer John 开始记录奶牛逃跑计数器以来的天数。
第二行包含 $N$ 个以空格分隔的整数。第 $i$ 个整数是一个非负整数 $a_i$（最多 $100$），表示第 $i$ 天计数器的值为 $a_i$，除非奶牛篡改了那天的记录。

### 输出格式

输出应包含 $N$ 个整数，每行一个。第 $i$ 个整数应表示在所有可能的逃跑序列中，发生 $i$ 次逃跑时，与序列不一致的记录条目的最小数量。

### 提示

如果只有 $1$ 次逃跑，那么正确的记录应该是 `0 1 2 3 4 5`，这与给定的记录有 $4$ 个条目不同。

如果有 $2$ 次逃跑，那么正确的记录可能是 `0 1 2 3 0 1`，这与给定的记录有 $2$ 个条目不同。在这种情况下，逃跑发生在第 $1$ 天和第 $5$ 天。

如果有 $3$ 次逃跑，那么正确的记录可能是 `0 1 2 0 0 1`，这与给定的记录只有 $1$ 个条目不同。在这种情况下，逃跑发生在第 $1$ 天、第 $4$ 天和第 $5$ 天。

以此类推。

题目来源：Brian Dean 和 Dhruv Rohatgi


---

---
title: "[USACO15DEC] High Card Low Card G"
layout: "post"
diff: 普及+/提高
pid: P4816
tag: ['贪心', '2015', 'USACO', '枚举', '排序']
---
# [USACO15DEC] High Card Low Card G
## 题目描述

Bessie the cow is a huge fan of card games, which is quite surprising, given her lack of opposable thumbs. Unfortunately, none of the other cows in the herd are good opponents. They are so bad, in fact, that they always play in a completely predictable fashion! Nonetheless, it can still be a challenge for Bessie to figure out how to win.

Bessie and her friend Elsie are currently playing a simple card game where they take a deck of $2N$ cards, conveniently numbered $1…2N$, and divide them into $N$ cards for Bessie and $N$ cards for Elsie. The two then play $N$ rounds, where in each round Bessie and Elsie both play a single card. In the first $N/2$ rounds, the player with the highest card earns a point, and in the last $N/2$ rounds, the rules switch and the player who plays the lowest card wins a point.

Given that Bessie can predict the order in which Elsie will play her cards, please determine the maximum number of points Bessie can win. 
## 输入格式

The first line of input contains the value of $N$ ($2 ≤ N ≤ 50,000$; N will be even).

The next $N$ lines contain the cards that Elsie will play in each of the successive rounds of the game. Note that it is easy to determine Bessie's cards from this information. 
## 输出格式

 Output a single line giving the maximum number of points Bessie can score. 
## 样例

### 样例输入 #1
```
4
1
8
4
3

```
### 样例输出 #1
```
2
```
## 提示

Here, Bessie must have cards 2, 5, and 6, and 7 in her hand, and she can use these to win at most 2 points, by saving her '2' card until one of the hands in the second half of the game.

Problem credits: Brian Dean 
## 题目翻译

### 题目描述

奶牛 Bessie 是卡牌游戏的狂热爱好者，尽管她没有对生拇指，但这并不影响她的热情。遗憾的是，她的同伴们在卡牌游戏方面水平堪忧，甚至出牌顺序都完全可预测！尽管如此，Bessie 仍需精心策划才能获胜。

Bessie 和她的朋友 Elsie 正在玩一个简单的卡牌游戏。她们使用一副包含 $2N$ 张卡牌的牌组（编号为 $1 \ldots 2N$），并将牌分成各 $N$ 张。随后进行 $N$ 轮比赛：每轮双方各打出一张牌。在前 $N/2$ 轮中，打出较大数字的玩家得 1 分；在后 $N/2$ 轮中，规则反转，打出较小数字的玩家得 1 分。

已知 Bessie 可以预知 Elsie 每轮出牌的顺序，请计算 Bessie 能够获得的最大分数。

### 输入格式

第一行输入包含整数 $N$（$2 \leq N \leq 50,000$，且 $N$ 为偶数）。

接下来 $N$ 行按顺序给出 Elsie 在每轮比赛中将打出的卡牌。注意根据这些信息可以推断出 Bessie 手中的卡牌。

### 输出格式

输出一行，包含 Bessie 能够获得的最大分数。

### 说明/提示

在此样例中，Bessie 手中的卡牌为 $2$、$5$、$6$ 和 $7$。她可以通过在比赛后半段保留 $2$ 这张牌，从而最多获得 2 分。

题目提供者：Brian Dean


---

---
title: "[USACO05DEC] Layout G"
layout: "post"
diff: 普及+/提高
pid: P4878
tag: ['2005', 'USACO', '最短路', '差分约束', '差分']
---
# [USACO05DEC] Layout G
## 题目背景

14组数据，前10组为原数据，后4组为hack数据
## 题目描述

Like everyone else, cows like to stand close to their friends when queuing for feed. FJ has N (2 <= N <= 1,000) cows numbered 1..N standing along a straight line waiting for feed. The cows are standing in the same order as they are numbered, and since they can be rather pushy, it is possible that two or more cows can line up at exactly the same location (that is, if we think of each cow as being located at some coordinate on a number line, then it is possible for two or more cows to share the same coordinate). 

Some cows like each other and want to be within a certain distance of each other in line. Some really dislike each other and want to be separated by at least a certain distance. A list of ML (1 <= ML <= 10,000) constraints describes which cows like each other and the maximum distance by which they may be separated; a subsequent list of MD constraints (1 <= MD <= 10,000) tells which cows dislike each other and the minimum distance by which they must be separated. 

Your job is to compute, if possible, the maximum possible distance between cow 1 and cow N that satisfies the distance constraints.
## 输入格式

Line 1: Three space-separated integers: N, ML, and MD. 

Lines 2..ML+1: Each line contains three space-separated positive integers: A, B, and D, with 1 <= A < B <= N. Cows A and B must be at most D (1 <= D <= 1,000,000) apart. 

Lines ML+2..ML+MD+1: Each line contains three space-separated positive integers: A, B, and D, with 1 <= A < B <= N. Cows A and B must be at least D (1 <= D <= 1,000,000) apart.
## 输出格式

Line 1: A single integer. If no line-up is possible, output -1. If cows 1 and N can be arbitrarily far apart, output -2. Otherwise output the greatest possible distance between cows 1 and N.

## 样例

### 样例输入 #1
```
4 2 1
1 3 10
2 4 20
2 3 3
```
### 样例输出 #1
```
27
```
## 提示

Explanation of the sample: 

There are 4 cows. Cows #1 and #3 must be no more than 10 units apart, cows #2 and #4 must be no more than 20 units apart, and cows #2 and #3 dislike each other and must be no fewer than 3 units apart. 

The best layout, in terms of coordinates on a number line, is to put cow #1 at 0, cow #2 at 7, cow #3 at 10, and cow #4 at 27.
## 题目翻译

正如其他物种一样，奶牛们也喜欢在排队打饭时与它们的朋友挨在一起。FJ 有编号为 $1\dots N$ 的 $N$ 头奶牛 $(2\le N\le 1000)$。开始时，奶牛们按照编号顺序来排队。奶牛们很笨拙，因此可能有多头奶牛在同一位置上。

有些奶牛是好基友，它们希望彼此之间的距离小于等于某个数。有些奶牛是情敌，它们希望彼此之间的距离大于等于某个数。

给出 $M_L$ 对好基友的编号，以及它们希望彼此之间的距离小于等于多少；又给出 $M_D$ 对情敌的编号，以及它们希望彼此之间的距离大于等于多少 $(1\le M_L,$ $M_D\le 10^4)$。

请计算：如果满足上述所有条件，$1$ 号奶牛和 $N$ 号奶牛之间的距离最大为多少。

## 输入输出格式

### 输入格式

第一行：三个整数 $N, M_L, M_D$，用空格分隔。

第 $2\dots M_L+1$ 行：每行三个整数 $A, B, D$，用空格分隔，表示 $A$ 号奶牛与 $B$ 号奶牛之间的距离须 $\le D$。保证 $1\le A<B\le N,$ $1\le D\le 10^6$. 

第 $M_L+2\dots M_L+M_D+1$ 行：每行三个整数 $A, B, D$，用空格分隔，表示 $A$ 号奶牛与 $B$ 号奶牛之间的距离须 $\ge D$。保证 $1\le A<B\le N,$ $1\le D\le 10^6$. 

### 输出格式

一行，一个整数。如果没有合法方案，输出 `-1`. 如果有合法方案，但 $1$ 号奶牛可以与 $N$ 号奶牛相距无穷远，输出 `-2`. 否则，输出 $1$ 号奶牛与 $N$ 号奶牛间的最大距离。


---

---
title: "[USACO04OPEN] MooFest G 加强版"
layout: "post"
diff: 普及+/提高
pid: P5094
tag: ['2004', 'USACO', '树状数组']
---
# [USACO04OPEN] MooFest G 加强版
## 题目描述

每一年，约翰的 $ N $ 只奶牛参加奶牛狂欢节。这是一个全世界奶牛都参加的大联欢。狂欢节包括很多有趣的活动，比如干草堆叠大赛、跳牛栏大赛，奶牛之间有时还相互扎屁股取乐。当然，她们会排成一列嚎叫，来欢庆她们的节日。奶牛们的叫声实在刺耳，以致于每只奶牛的听力都受到不同程度的损伤。现在告诉你奶牛 $ i $ 的听力为 $ v_i $ ，这表示如果奶牛 $ j $ 想说点什么让她听到，必须用高于 $ v_i \times dis(i,j) $ 的音量。因此，如果奶牛 $ i $ 和 $ j $ 想相互交谈，她们的音量必须不小于 $ \max (v_i,v_j) \times dis(i,j) $。其中 $ dis(i,j) $ 表示她们间的距离。

现在 $ N $ 只奶牛都站在一条直线上了，每只奶牛还有一个坐标 $ x_i $。如果每对奶牛都在交谈，并且使用最小音量，那所有 $ N(N-1)/2 $ 对奶牛间谈话的音量之和为多少？
## 输入格式

第 $1$ 行输入一个整数 $ N $ 。

接下来 $ N $ 行，每行输入两个数 $ v_i $ 和 $ x_i $ ，分别代表第 $ i $ 头奶牛的听力和坐标。
## 输出格式

输出一个数，代表这 $ N(N-1)/2 $ 对奶牛谈话时的音量之和。
## 样例

### 样例输入 #1
```
4
3 1
2 5
2 6
4 3
```
### 样例输出 #1
```
57
```
## 提示

### 数据范围

因为原数据下 $O(N^2)$ 算法可以通过，所以新添加了一些增强数据。

原数据作为子任务 $1$，新添加的数据作为子任务 $2$。

- 子任务 $1$（$1$ 分）：$1 \leq N,V_i,x_i \leq 2 \times 10^4$。
- 子任务 $2$（$99$ 分）：$1 \leq N,V_i,x_i \leq 5 \times 10^4$。


---

---
title: "[USACO12OPEN] Bookshelf S"
layout: "post"
diff: 普及+/提高
pid: P5095
tag: ['2012', 'USACO']
---
# [USACO12OPEN] Bookshelf S
## 题目描述

Farmer John 闲来无事的时候总喜欢坐下来看书。这些年来，他一共收集了 $N$ 本书（$1 \leq N \leq 2000$），他打算搭一个新的书架来装这些书。

每本书都有个宽度 $w_i$ 和高度 $h_i$，书必须按顺序来摆放（即同一层书架摆的书必须是连续的一个区间）。每层书架的总宽度不能超过 $L$（$1 \leq L \leq 10^9$），每层书架的高度等于这一层最高的书的高度，整个书架的高度等于每层书架的高度之和。

现在请你帮 FJ 求出书架高度的最小值。
## 输入格式

第一行两个整数 $N,L$。

接下来 $N$ 行，每行两个整数 $h_i,w_i$（$1 \leq h_i \leq 10^6$，$1 \leq w_i \leq L$）。
## 输出格式

输出一个整数，书架高度最小值。
## 样例

### 样例输入 #1
```
5 10
5 7
9 2
8 5
13 2
3 8
```
### 样例输出 #1
```
21
```
## 提示

第一层放第一本书，第二层放第二，三，四本书，第三层放第五本书，总高度为 $5+13+3=21$，可以证明不存在更优的方案。


---

---
title: "[USACO04OPEN] Cave Cows 1"
layout: "post"
diff: 普及+/提高
pid: P5096
tag: ['2004', 'USACO']
---
# [USACO04OPEN] Cave Cows 1
## 题目描述

很少人知道其实奶牛非常喜欢到洞穴里面去探险。

洞窟里有 $ N $ ( $ 1 \leq N \leq 100 $ )个洞室，由 $ M $ ( $ 1 \leq M \leq 1000 $ )条双向通道连接着它们。每对洞室间至多只有一条双向通道，有 $ K $ ( $ 1 \leq K \leq 14 $ )个洞室，里面放有1捆干草．牛吃1捆干草，体重指数就会增加1。

贪吃的贝茜要到洞窟里面探险，她希望能吃尽量多的干草，但每条通道有一个宽度阈值，如果体重指数超过相应的阈值，贝茜就会被卡住。

她从洞窟1出发，体重指数为0。在洞里溜达一圈后，她要返回洞窟1。

那她最多能吃多少捆干草呢？注意，贝茜经过一个洞室，不一定非要吃掉里面的干草。
## 输入格式

第1行输入 $ N,M,K $ 。

之后 $ K $ 行每行一个整数，表示在这个洞室放有一捆干草；接下来 $ M $ 行每行三个整数，表示一条双向通道的起点终点和宽度阈值。
## 输出格式

最多能吃掉的干草数。
## 样例

### 样例输入 #1
```
6 7 5
1
2
3
4
5
1 2 3
3 6 2
6 2 10
2 4 1
5 1 1
4 5 1
1 6 1
```
### 样例输出 #1
```
4
```


---

---
title: "[USACO04OPEN] Cave Cows 4"
layout: "post"
diff: 普及+/提高
pid: P5099
tag: ['2004', 'USACO']
---
# [USACO04OPEN] Cave Cows 4
## 题目描述

一道竖直的石墙横在贝茜前面，她必须越过去。

石墙可以看成一个xz平面，贝茜开始的时候在(0，0)，只要她到达 $ z=T $ 
 ( $ 1 \leq T \leq 200000 $ )的位置，就算翻越成功。

墙上有 $ N $ ( $ 1 \leq N \leq 50000 $ )块石头突出，成为贝茜的落蹄石。如果两个落蹄石之间x方向和z方向的距离均不超过2，那贝茜就可以攀上另一块落蹄石。

帮助贝茜计算她是否能够翻越石墙，如果可以，最少需要踩多少块落蹄石。
## 输入格式

第1行输入 $ N $ 和 $ T $ 。

接下来 $ N $ 行，每行输入坐标 $ (x,z) $ ，表示一个石头的位置．其中 $ x \leq 10^6 $ ， $ z \leq T $ ，保证 $ (0,0) $ 不会出现。
## 输出格式

如果可以翻越则输出最少需要的落蹄石数（起点不计入），否则输出 $ -1 $ 。
## 样例

### 样例输入 #1
```
5 3
1 2
6 3
4 1
3 2
0 2
```
### 样例输出 #1
```
4
```
## 提示

一种可行的方案是：(0,0) -> (1,2) -> (3,2) -> (4,1) -> (6,3) 。


---

---
title: "[USACO18DEC] Mooyo Mooyo S"
layout: "post"
diff: 普及+/提高
pid: P5121
tag: ['模拟', '搜索', '2018', 'USACO']
---
# [USACO18DEC] Mooyo Mooyo S
## 题目描述

由于手上（更确实的，蹄子上）有大把的空余时间，Farmer John 的农场里的奶牛经常玩电子游戏消磨时光。她们最爱的游戏之一是基于一款流行的电子游戏 Puyo Puyo 的奶牛版；名称当然叫做 Mooyo Mooyo。

Mooyo Mooyo 是在一块又高又窄的棋盘上进行的游戏，高 $N$（$1\le N\le 100$）格，宽 $10$ 格。 这是一个 $N=6$ 的棋盘的例子：

```
0000000000
0000000300
0054000300
1054502230
2211122220
1111111223
```

每个格子或者是空的（用 $0$ 表示），或者是九种颜色之一的干草捆（用字符 $1\dots 9$ 表示）。重力会使得干草捆下落，所以没有干草捆的下方是 $0$。

如果两个格子水平或垂直方向直接相邻，并且为同一种非 $0$ 颜色，那么这两个格子就属于同一个连通区域。任意时刻出现至少 $K$ 个格子构成的连通区域，其中的干草捆就会全部消失，变为 $0$。如果同时出现多个这样的连通区域，它们同时消失。随后，重力可能会导致干草捆向下落入某个变为 $0$ 的格子。由此形成的新的布局中，又可能出现至少 $K$ 个格子构成的连通区域。若如此，它们同样也会消失（如果又有多个这样的区域，则同时消失），然后重力又会使得剩下的方块下落，这一过程持续进行，直到不存在大小至少为 $K$ 的连通区域为止。

给定一块 Mooyo Mooyo 棋盘的状态，输出这些过程发生之后最终的棋盘的图案。


## 输入格式

输入的第一行包含 $N$ 和 $K$（$1\le K\le 10N$）。以下 $N$ 行给出了棋盘的初始状态。
## 输出格式

输出 $N$ 行，描述最终的棋盘状态。
## 样例

### 样例输入 #1
```
6 3
0000000000
0000000300
0054000300
1054502230
2211122220
1111111223
```
### 样例输出 #1
```
0000000000
0000000000
0000000000
0000000000
1054000000
2254500000
```
## 提示

在上面的例子中，如果 $K=3$，那么存在一个大小至少为 $K$ 的颜色 $1$ 的连通区域，同样有一个颜色 $2$ 的连通区域。当它们同时被移除之后，棋盘暂时成为了这样：

```
0000000000
0000000300
0054000300
1054500030
2200000000
0000000003
```

然后，由于重力效果，干草捆下落形成这样的布局：

```
0000000000
0000000000
0000000000
0000000000
1054000300
2254500333
```

再一次地，出现了一个大小至少为 $K$ 地连通区域（颜色 $3$）。移除这个区域就得到了最终的棋盘布局：

```
0000000000
0000000000
0000000000
0000000000
1054000000
2254500000
```


---

---
title: "[USACO18DEC] Teamwork G"
layout: "post"
diff: 普及+/提高
pid: P5124
tag: ['动态规划 DP', '2018', 'USACO', '线性 DP']
---
# [USACO18DEC] Teamwork G
## 题目描述

在 Farmer John 最喜欢的节日里，他想要给他的朋友们赠送一些礼物。由于他并不擅长包装礼物，他想要获得他的奶牛们的帮助。你可能能够想到，奶牛们本身也不是很擅长包装礼物，而 Farmer John 即将得到这一教训。

Farmer John 的 $N$ 头奶牛（$1\le N\le 10^4$）排成一行，方便起见依次编号为 $1\dots N$。奶牛 $i$ 的包装礼物的技能水平为 $s_i$。她们的技能水平可能参差不齐，所以 FJ 决定把她的奶牛们分成小组。每一组可以包含任意不超过 $K$ 头的连续的奶牛（$1\le K\le 10^3$），并且一头奶牛不能属于多于一个小组。由于奶牛们会互相学习，这一组中每一头奶牛的技能水平会变成这一组中水平最高的奶牛的技能水平。

请帮助 FJ 求出，在他合理地安排分组的情况下，可以达到的技能水平之和的最大值。
## 输入格式

输入的第一行包含 $N$ 和 $K$。以下 $N$ 行按照 $N$ 头奶牛的排列顺序依次给出她们的技能水平。技能水平是一个不超过 $10^5$ 的正整数。
## 输出格式

输出 FJ 通过将连续的奶牛进行分组可以达到的最大技能水平和。
## 样例

### 样例输入 #1
```
7 3
1
15
7
9
2
5
10
```
### 样例输出 #1
```
84
```
## 提示

在这个例子中，最优的方案是将前三头奶牛和后三头奶牛分别分为一组，中间的奶牛单独成为一组（注意一组的奶牛数量可以小于 $K$）。这样能够有效地将 $7$ 头奶牛的技能水平提高至 $15$、$15$、$15$、$9$、$10$、$10$、$10$，和为 $84$。


---

---
title: "[USACO05DEC] Knights of Ni S"
layout: "post"
diff: 普及+/提高
pid: P5195
tag: ['2005', 'USACO', '枚举', '广度优先搜索 BFS']
---
# [USACO05DEC] Knights of Ni S
## 题目描述

贝茜遇到了一件很麻烦的事：她无意中闯入了森林里的一座城堡，如果她想回家，就必须穿过这片由骑士们守护着的森林。为了能安全地离开，贝茜不得不按照骑士们的要求，在森林寻找一种特殊的灌木并带一棵给他们。

当然，贝茜想早点离开这可怕的森林，于是她必须尽快完成骑士们给的任务，贝茜随身带着这片森林的地图，地图上的森林被放入了直角坐标系，并按 $x,y $ 轴上的单位长度划分成了 $ W \times H\  ( 1 \leq W,H \leq 1000 )$ 块，贝茜在地图上查出了她自己以及骑士们所在的位置，当然地图上也标注了她所需要的灌木生长的区域。某些区域是不能通过的（比如说沼泽地，悬崖，以及食人兔的聚居地）。在没有找到灌木之前，贝茜不能通过骑士们所在的那个区域，为了确保她自己不会迷路，贝茜只向正北、正东、正南、正西四个方向移动（注意，她不会走对角线）。她要走整整一天，才能从某块区域走到与它相邻的那块区域。

贝茜希望你能帮她计算一下，她最少需要多少天才可脱离这可怕的地方？输入数据保证贝茜一定能完成骑士的任务。
## 输入格式

第一行输入 $2$ 个用空格隔开的整数，即题目中提到的 $ W,H $。

接下来输入贝茜持有的地图，每一行用若干个数字代表地图上对应行的地形。第一行描述了地图最北的那一排土地；最后一行描述的则是最南面的。相邻的数字所对应的区域是相邻的。如果地图的宽小于或等于 $40$，那每一行数字恰好对应了地图上的一排土地。如果地图的宽大于 $40$，那每行只会给出 $40$ 个数字，并且保证除了最后一行的每一行都包含恰好 $40$ 个数字。没有哪一行描述的区域分布在两个不同的行里。

地图上的数字所对应的地形：

- $0$：贝茜可以通过的空地；
- $1$：由于各种原因而不可通行的区域；
- $2$：贝茜现在所在的位置； 
- $3$：骑士们的位置；
- $4$：长着贝茜需要的灌木的土地。
## 输出格式

输出一个正整数，即贝茜最少要花多少天才能完成骑士们给的任务。
## 样例

### 样例输入 #1
```
8 4
4 1 0 0 0 0 1 0
0 0 0 1 0 1 0 0
0 2 1 1 3 0 4 0
0 0 0 4 1 1 1 0

```
### 样例输出 #1
```
11
```
## 提示

这片森林的长为 $8$，宽为 $4$．贝茜的起始位置在第 $3$ 行，离骑士们不远。

贝茜可以按这样的路线完成骑士的任务：北，西，北，南，东，东，北，东，东，南，南。她在森林的西北角得到一株她需要的灌木，然后绕过障碍把它交给在东南方的骑士。


---

---
title: "[USACO19JAN] Cow Poetry G"
layout: "post"
diff: 普及+/提高
pid: P5196
tag: ['动态规划 DP', '数学', '2019', 'USACO']
---
# [USACO19JAN] Cow Poetry G
## 题目背景

USACO19 年一月金组第一题
## 题目描述

不为 Farmer John 所知的是，Bessie 还热衷于资助艺术创作！最近，她开始研究许多伟大的诗人们，而现在，她想要尝试创作一些属于自己的诗歌了。
Bessie 认识 $N$（$1 \leq N \leq 5000$）个单词，她想要将她们写进她的诗。Bessie 已经计算了她认识的每个单词的长度，以音节为单位，并且她将这些单词划分成了不同的“韵部”。每个单词仅与属于同一韵部的其他单词押韵。

Bessie 的每首诗由 $M$ 行组成（$1 \leq M \leq 10^5$），每一行必须由 $K$（$1 \leq K \leq 5000$）个音节构成。此外，Bessie 的诗必须遵循某个指定的押韵模式。

Bessie 想要知道她可以写出多少首符合限制条件的不同的诗。
## 输入格式

输入的第一行包含 $N$、$M$ 和 $K$。

以下 $N$ 行，每行包含两个整数 $s_i$（$1 \leq s_i \leq K$）和 $c_i$（$1 \leq c_i \leq N$）。这表示 Bessie 认识一个长度（以音节为单位）为 $s_i$、属于韵部 $c_i$ 的单词。

最后 $M$ 行描述了 Bessie 想要的押韵模式，每行包含一个大写字母 $e_i$。所有押韵模式等于 $e_i$ 的行必须以同一韵部的单词结尾。不同 $e_i$ 值的行并非必须以不同的韵部的单词结尾。
## 输出格式

输出 Bessie 可以写出的满足这些限制的不同的诗的数量。由于这个数字可能非常大，请计算这个数对 $1,000,000,007$ 取余的结果。
## 样例

### 样例输入 #1
```
3 3 10
3 1
4 1
3 2
A
B
A
```
### 样例输出 #1
```
960
```
## 提示

在这个例子中，Bessie 认识三个单词。前两个单词押韵，长度分别为三个音节和四个音节，最后一个单词长度为三个音节，不与其他单词押韵。她想要写一首三行的诗，每行包含十个音节，并且第一行和最后一行押韵。共有 $960$ 首这样的诗。以下是一首满足要求的诗（其中 $1,2,3$ 分别代表第一个、第二个、第三个单词）：$\text{121 123 321}$。


---

---
title: "[USACO19JAN] Sleepy Cow Sorting G"
layout: "post"
diff: 普及+/提高
pid: P5200
tag: ['2019', 'USACO', '树状数组']
---
# [USACO19JAN] Sleepy Cow Sorting G
## 题目背景

USACO 19年一月月赛金组第二题
## 题目描述

Farmer John正在尝试将他的 $N$ 头奶牛（$1\le N\le 10^5$），方便起见编号为 $1\ldots N$，在她们前往牧草地吃早餐之前排好顺序。

当前，这些奶牛以 $p_1,p_2,p_3,\ldots,p_N$ 的顺序排成一行，Farmer John站在奶牛 $p_1$ 前面。他想要重新排列这些奶牛，使得她们的顺序变为 $1,2,3,\ldots,N$，奶牛 $1$ 在 Farmer John 旁边。

今天奶牛们有些困倦，所以任何时刻都只有直接面向 Farmer John 的奶牛会注意听 Farmer John 的指令。每一次他可以命令这头奶牛沿着队伍向后移动 $k$ 步，$k$ 可以是 $1$ 到 $N−1$ 之间的任意数。她经过的 $k$ 头奶牛会向前移动，腾出空间使得她能够插入到队伍中这些奶牛之后的位置。

例如，假设 $N=4$，奶牛们开始时是这样的顺序：

```plain
 FJ: 4 3 2 1
```

唯一注意 FJ 指令的奶牛是奶牛 $4$。当他命令她向队伍后移动 $2$ 步之后，队伍的顺序会变成：

```plain
 FJ: 3 2 4 1 
```

现在唯一注意 FJ 指令的奶牛是奶牛 $3$，所以第二次他可以给奶牛 $3$ 下命令，如此进行直到奶牛们排好了顺序。

Farmer John 急欲完成排序，这样他就可以回到他的农舍里享用他自己的早餐了。请帮助他求出一个操作序列，使得能够用最少的操作次数将奶牛们排好顺序。
## 输入格式

输入的第一行包含 $N$。第二行包含 $N$ 个空格分隔的整数：$p_1,p_2,p_3,\ldots,p_N$，表示奶牛们的起始顺序。
## 输出格式

输出的第一行包含一个整数 $K$，为将奶牛们排好顺序所需的最小操作次数。

第二行包含 $K$ 个空格分隔的整数，$c_1,c_2,\ldots,c_K$，每个数均在 $1\ldots N−1$ 之间。如果第 $i$ 次操作 FJ 命令面向他的奶牛向队伍后移动 $c_i$ 步，那么 $K$ 次操作过后奶牛们应该排好了顺序。

如果存在多种最优的操作序列，你的程序可以输出其中任何一种（不过实际上是唯一解）。
## 样例

### 样例输入 #1
```
4
1 2 4 3
```
### 样例输出 #1
```
3
2 2 3
```


---

---
title: "[USACO19JAN] Shortcut G"
layout: "post"
diff: 普及+/提高
pid: P5201
tag: ['2019', 'USACO', '最短路']
---
# [USACO19JAN] Shortcut G
## 题目背景

USACO 19 年一月月赛金组第三题
## 题目描述

每天晚上，Farmer John 都会敲响一个巨大的铃铛，召唤他的奶牛们前来牛棚享用晚餐。奶牛们都急切地想要前往牛棚，所以她们都会沿着最短的路径行走。
农场可以描述为 $N$ 块草地（$1 \leq N \leq 10,000$），方便起见编号为 $1 \ldots N$，牛棚位于草地 $1$。草地之间由 $M$ 条双向的小路连接（$N-1 \leq M \leq 50,000$）。每条小路有其通过时间，从每块草地出发都存在一条由一些小路组成的路径可以到达牛棚。

草地 $i$ 中有 $c_i$ 头奶牛。当她们听到晚餐铃时，这些奶牛都沿着一条消耗最少时间的路径前往牛棚。如果有多条路径并列消耗时间最少，奶牛们会选择其中“字典序”最小的路径（也就是说，她们通过在两条路径第一次出现分支的位置优先选择经过编号较小的草地的方式来打破并列关系，所以经过草地 $7$、$3$、$6$、$1$ 的路径会优先于经过 $7$、$5$、$1$ 的路径，如果它们所消耗的时间相同）。

Farmer John 担心牛棚距离某些草地太远。他计算了每头奶牛路上的时间，将所有奶牛消耗的时间相加，称这个和为总移动时间。他想要通过额外添加一条从牛棚（草地 $1$）连接到某块他选择的其他草地的、通过时间为 $T$（$1 \leq T \leq 10,000$）的“近道”来尽可能地减少总移动时间。当一头奶牛在她平时前往牛棚的路上偶然看见这条近道时，如果这条近道能够使她更快地到达牛棚，她就会走这条路。否则，一头奶牛会仍然沿着原来的路径行走，即使使用这条近道可能会减少她的移动时间。

请帮助 Farmer John 求出通过添加一条近道能够达到的总移动时间减少量的最大值。

## 输入格式

输入的第一行包含 $N$、$M$ 和 $T$。以下 $N$ 行包含 $c_1 \ldots c_N$，均为 $0 \ldots 10,000$ 范围内的整数。以下 $M$ 行，每行由三个整数 $a$、$b$ 和 $t$ 描述了一条小路，这条小路连接了草地 $a$ 和 $b$，通过时间为 $t$。所有的通过时间在 $1 \ldots 25,000$ 范围内。
## 输出格式

输出 Farmer John 可以达到的总移动时间的最大减少量。
## 样例

### 样例输入 #1
```
5 6 2
1 2 3 4 5
1 2 5
1 3 3
2 4 3
3 4 5
4 5 2
3 5 7
```
### 样例输出 #1
```
40
```


---

---
title: "[USACO19JAN] Redistricting P"
layout: "post"
diff: 普及+/提高
pid: P5202
tag: ['动态规划 DP', '2019', 'USACO', '优先队列']
---
# [USACO19JAN] Redistricting P
## 题目背景

USACO 19 年一月月赛铂金组第一题。
## 题目描述

奶牛们的特大城市，牛都，要进行重新分区了！——这总是一个在居住在这里的两大主要种族（荷斯坦牛和更赛牛）之间富有争议的政治事件，因为两大种族都想要在牛都政府中保持足够的影响力。

牛都的大都市圈由一列 $n$ 块牧草地组成，每块里有一头奶牛，均为荷斯坦牛 (Holstein) 和更赛牛 (Guernsey) 之一。

牛都政府想要将大都市圈划分为若干个连续的区，使得每个区至少包含一块牧草地且至多包含 $k$ 块牧草地，并且每块牧草地恰好属于一个区。由于政府当前由荷斯坦牛控制，她们想要找到一种分区方式能够最小化更赛牛较多或者均势的区的数量（如果更赛牛的数量与荷斯坦牛的数量相等那么这个区就是均势的）。

有一个关心政治的更赛牛团体想要知道政府的分区计划可能会对她们造成多少损害。帮助她们求出最坏情况，也就是更赛牛较多或是均势的区的最小可能的数量。
## 输入格式

输入的第一行是用空格隔开的两个整数，分别代表牧草地的个数 $n$ 和每个区包含草地的上限 $k$。

输入的第二行是一个长度为 $n$ 的字符串 $s$，$s$ 中只含字符 `H` 和 `G`。若 $s$ 的第 $i$ 个字符是 `H`，则代表第 $i$ 块草地上的奶牛是荷斯坦牛，否则是更赛牛。
## 输出格式

输出一行一个整数，代表更赛牛较多或者优势区的最小可能数量。
## 样例

### 样例输入 #1
```
7 2
HGHGGHG
```
### 样例输出 #1
```
3
```
## 提示

### 样例解释

一种可能的划分方式是 $[1],~[2, 3],~[4, 5],~[6, 7]$。第二、四个区是均势的区，第三个区是更赛牛优势的区。

### 数据范围

对于 $100\%$ 的数据，保证 $1 \leq k \leq n \leq 3 \times 10^5$，$s$ 的长度为 $n$，且只含字符 `H` 和 `G`。


---

---
title: "[USACO19OPEN] Snakes G"
layout: "post"
diff: 普及+/提高
pid: P5424
tag: ['动态规划 DP', '2019', 'USACO']
---
# [USACO19OPEN] Snakes G
## 题目描述

传说，数千年前圣帕特里克消灭了哞尔兰所有的蛇。然而，蛇们现在卷土重来了！圣帕特里克节是在每年的 3 月 17 日，所以 Bessie 要用彻底清除哞尔兰所有的蛇来纪念圣帕特里克。

Bessie装备了一个捕网，用来捕捉 $ N $ 组排成一行的蛇（ $ 1 \leq N \leq 400 $ ）。Bessie 必须按照这些组在这一行中出现的顺序捕捉每一组的所有蛇。每当 Bessie 抓完一组蛇之后，她就会将蛇放在笼子里，然后带着空的捕网开始捕捉下一组。

一个大小为 $ s $ 的捕网意味着 Bessie 可以抓住任意包含 $ g $ 条的一组蛇，其中 $ g \leq s $ 。然而，每当 Bessie 用大小为 $ s $ 的捕网抓住了一组 $ g $ 条蛇，就意味着浪费了 $ s-g $ 的空间。Bessie 可以任意设定捕网的初始大小，并且她可以改变 $ K $ 次捕网大小（ $ 1 \leq K<N $ ）。

请告诉 Bessie 她捕捉完所有组的蛇之后可以达到的总浪费空间的最小值。
## 输入格式

输入的第一行包含 $ N $ 和 $ K $ 。

第二行包含 $ N $ 个整数 $ a_1, \ldots ,a_N $ ，其中 $ a_i $ （ $ 0 \leq a_i \leq 10^6 $ ）为第 $ i $ 组蛇的数量。
## 输出格式

输出一个整数，为 Bessie 抓住所有蛇的总浪费空间的最小值。
## 样例

### 样例输入 #1
```
6 2
7 9 8 2 3 2
```
### 样例输出 #1
```
3
```
## 提示

Bessie 可以设置她的捕网开始时大小为 $7$。当她抓完第一组蛇之后，她将她的捕网的大小调整为 $9$，保持这个大小直到抓完第 $3$ 组蛇，再将捕网大小调整为 $3$。总浪费空间为 $ (7-7)+(9-9)+(9-8)+(3-2)+(3-3)+(3-2)=3 $ 。


---

---
title: "[USACO19OPEN] I Would Walk 500 Miles G"
layout: "post"
diff: 普及+/提高
pid: P5425
tag: ['数学', '2019', 'USACO']
---
# [USACO19OPEN] I Would Walk 500 Miles G
## 题目描述

Farmer John 想要将他的编号为 $ 1 \ldots N $ 的 $ N $ 头奶牛（ $ N \leq 7500 $ ）分为非空的 $ K $ 组（ $ 2 \leq K \leq N $ ），使得任意两头来自不同组的奶牛都需要走一定的距离才能相遇。奶牛 $ x $ 和奶牛 $ y $ （其中 $ 1 \leq x<y \leq N $ ）愿意为了见面走 $ (2019201913x+2019201949y) \mod 2019201997 $ 英里。

给定一个将 $ N $ 头奶牛分为 $ K $ 个非空小组的分组方案，令 $ M $ 为任意两头来自不同组的奶牛愿意为了见面行走的英里数的最小值。为了测试奶牛们相互之间的忠诚度，Farmer John 想要将 $ N $ 头奶牛以最佳的方式分为 $ K $ 组，使得 $ M $ 尽可能大。 
## 输入格式

输入仅有一行，包含 $ N $ 和 $ K $ ，用空格分隔。
## 输出格式

输出最优的 $ M $ 。
## 样例

### 样例输入 #1
```
3 2
```
### 样例输出 #1
```
2019201769
```
## 提示

在这个例子中，奶牛 $1$ 和奶牛 $2$ 愿意为了见面走 $2019201817$ 英里。奶牛 $2$ 和奶牛 $3$ 愿意走 $2019201685$ 英里。奶牛 $1$ 和奶牛 $3$ 愿意走 $2019201769$ 英里。所以，将奶牛 $1$ 单独分为一组，奶牛 $2$ 和奶牛 $3$ 分为一组，$M = \min(2019201817, 2019201769) = 2019201769$（这是我们在这个问题中能够达到的最佳结果）。


---

---
title: "[USACO19OPEN] Left Out S"
layout: "post"
diff: 普及+/提高
pid: P5427
tag: ['数学', '2019', 'USACO', 'Ad-hoc']
---
# [USACO19OPEN] Left Out S
## 题目描述

Farmer John 正在尝试给他的牛群拍照。根据以往的经验，他知道这一工作往往结果不怎么样。

这一次，Farmer John 购买了一台昂贵的无人机，想要拍一张航拍照。为了使照片尽可能好看，他想让他的奶牛们在拍照时都朝向同一个方向。奶牛们现在在一块有围栏的草地上排列成 $N \times N$（$2 \leq N \leq 1000$）的方阵，例如：

```
RLR
RRL
LLR
```

这里，字符 `R` 表示一头朝右的奶牛，字符 `L` 表示一头朝左的奶牛。由于奶牛们都挤在一起，Farmer John 没办法走到某一头奶牛面前让她调转方向。他能做的只有对着某一行或某一列的奶牛喊叫让她们调转方向，使得被叫到的这一行或列内的所有 `L` 变为 `R`，`R` 变为 `L`。Farmer John 可以对任意多的行或列发号施令，也可以对同一行或列多次发令。

就如同 Farmer John 想象的，他发现他不可能让他的奶牛们都朝向同一个方向。他最多能做的是让所有奶牛中除了一头之外都朝向相同的方向。请找出这样的一头奶牛。

## 输入格式

输入的第一行包含 $N$。以下 $N$ 行描述了奶牛方阵的第 $1 \ldots N$ 行，每行包含一个长度为 $N$ 的字符串。
## 输出格式

输出一头奶牛的行列坐标，满足这头奶牛被调转方向的话，Farmer John 就可以使他的所有奶牛都朝向同一个方向。如果不存在这样的奶牛，输出 `-1`。如果存在多头这样的奶牛，输出其中行坐标最小的，如果多头这样的奶牛具有相同的行坐标，输出其中列坐标最小的。
## 样例

### 样例输入 #1
```
3
RLR
RRL
LLR
```
### 样例输出 #1
```
1 1
```
## 提示

在这个例子中，位于第 $1$ 行第 $1$ 列（左上角）的奶牛是那头令人讨厌的奶牛，因为 Farmer John 可以喊叫第 $2$ 行和第 $3$ 列来让所有奶牛都面向左侧，只有这一头奶牛面向右侧。


---

---
title: "[USACO19FEB] The Great Revegetation S"
layout: "post"
diff: 普及+/提高
pid: P5543
tag: ['图论', '2019', 'USACO', '并查集', '图遍历']
---
# [USACO19FEB] The Great Revegetation S
## 题目描述

一场漫长的干旱使农场主约翰的 $N$ 个牧场没有草。然而，随着雨季的到来，是时候“重新种植”了。在农夫约翰的小屋里，他有两个桶，每个桶都有不同类型的草籽。他想在他的每一个牧场种草，在每一个牧场中选择一种类型的草。

作为一名奶农，农场主约翰想确保他能满足他那几头奶牛的特殊饮食需求。他的 $m$ 头奶牛都有两个最喜欢的牧场。他的一些奶牛有一个饮食限制，那就是他们应该只吃一种类型的草，因此农场主约翰希望确保在这类奶牛最喜欢的两个田里种植同一种类型的草。其他的奶牛有一个不同的饮食限制，要求他们吃不同类型的草。对于那些奶牛，农场主约翰当然想确保他们最喜欢的两块田地里有不同的草。


请帮助农场主约翰确定他在他的 $N$ 个牧场上种植草的不同方式的数量。
## 输入格式

输入的第一行包含两个整数 $N$（$2\le N\le10^5$）和 $m$（$1\le m\le10^5$）。

之后 $m$ 行，每行描述了一头奶牛。首先是一个字符 `S` 或 `D`，表示这头奶牛需要相同（`S`）还是不同（`D`）的草类型，然后是两个 $1\sim N$ 的整数，表示这头奶牛喜欢的两块牧场。
## 输出格式

输出农场主约翰在他的 $N$ 个牧场上植草的方式。请用二进制写你的答案。
## 样例

### 样例输入 #1
```
3 2
S 1 2
D 3 2
```
### 样例输出 #1
```
10
```
## 提示

USACO 2019 二月月赛银牌组第三题


---

---
title: "[USACO19DEC] Milk Visits S"
layout: "post"
diff: 普及+/提高
pid: P5836
tag: ['树形数据结构', '2019', 'USACO', '并查集', '最近公共祖先 LCA']
---
# [USACO19DEC] Milk Visits S
## 题目描述

Farmer John 计划建造 $N$ 个农场，用 $N-1$ 条道路连接，构成一棵树（也就是说，所有农场之间都互相可以到达，并且没有环）。每个农场有一头奶牛，品种为更赛牛或荷斯坦牛之一。

Farmer John 的 $M$ 个朋友经常前来拜访他。在朋友 $i$ 拜访之时，Farmer John 会与他的朋友沿着从农场 $A_i$ 到农场 $B_i$ 之间的唯一路径行走（可能有 $A_i = B_i$）。除此之外，他们还可以品尝他们经过的路径上任意一头奶牛的牛奶。由于 Farmer John 的朋友们大多数也是农场主，他们对牛奶有着极强的偏好。他的有些朋友只喝更赛牛的牛奶，其余的只喝荷斯坦牛的牛奶。任何 Farmer John 的朋友只有在他们访问时能喝到他们偏好的牛奶才会高兴。

请求出每个朋友在拜访过后是否会高兴。
## 输入格式

输入的第一行包含两个整数 $N$ 和 $M$。

第二行包含一个长为 $N$ 的字符串。如果第 $i$ 个农场中的奶牛是更赛牛，则字符串中第 $i$ 个字符为 `G`，如果第 $i$ 个农场中的奶牛是荷斯坦牛则为 `H`。

以下 $N-1$ 行，每行包含两个不同的整数 $X$ 和 $Y$（$1 \leq X, Y \leq N$），表示农场 $X$ 与 $Y$ 之间有一条道路。

以下 $M$ 行，每行包含整数 $A_i$，$B_i$，以及一个字符 $C_i$。$A_i$ 和 $B_i$ 表示朋友 $i$ 拜访时行走的路径的端点，$C_i$ 是 `G` 或 `H` 之一，表示第 $i$ 个朋友喜欢更赛牛的牛奶或是荷斯坦牛的牛奶。
## 输出格式

输出一个长为 $M$ 的二进制字符串。如果第 $i$ 个朋友会感到高兴，则字符串的第 $i$ 个字符为 `1`，否则为 `0`。
## 样例

### 样例输入 #1
```
5 5
HHGHG
1 2
2 3
2 4
1 5
1 4 H
1 4 G
1 3 G
1 3 H
5 5 H
```
### 样例输出 #1
```
10110
```
## 提示

在这里，从农场 1 到农场 4 的路径包括农场 1、2 和 4。所有这些农场里都是荷斯坦牛，所以第一个朋友会感到满意，而第二个朋友不会。

关于部分分：

测试点 $1$ 样例。

测试点 $2\sim 5$ 满足 $N\le 10^3$，$M\le 2\cdot 10^3$。

对于 $100\%$ 的数据，$1 \leq N \leq 10^5$，$1 \leq M \leq 10^5$。

供题：Spencer Compton


---

---
title: "[USACO19DEC] Milk Pumping G"
layout: "post"
diff: 普及+/提高
pid: P5837
tag: ['图论', '2019', 'USACO', '最短路']
---
# [USACO19DEC] Milk Pumping G
## 题目描述

Farmer John 最近为了扩张他的牛奶产业帝国而收购了一个新的农场。这一新的农场通过一个管道网络与附近的小镇相连，FJ 想要找出其中最合适的一组管道，将其购买并用来将牛奶从农场输送到小镇。

这个管道网络可以用 $N$ 个接合点（管道的端点）来描述，将其编号为 $1 \ldots N$。接合点 $1$ 表示 FJ 的农场，接合点 $N$ 表示小镇。有 $M$ 条双向的管道，每条连接了两个接合点。使用第 $i$ 条管道需要 FJ 花费 $c_i$ 美元购入，可以支持每秒 $f_i$ 升牛奶的流量。

FJ 想要购买一条管道组成一条单一路径，路径的两端点分别为接合点 $1$ 和 $N$。这条路径的花费等于路径上所有管道的费用之和。路径上的流量等于路径上所有管道的最小流量（因为这是沿这条路径输送牛奶的瓶颈）。FJ 想要最大化路径流量与路径花费之比。保证存在从 $1$ 到 $N$之间的路径。

## 输入格式

输入的第一行包含 $N$ 和 $M$。以下 $M$ 行每行以四个整数描述一条管道：$a$ 和 $b$（管道连接的两个不同的接合点），$c$（管道的花费），以及 $f$（管道的流量）。花费和流量均为范围 $1 \ldots 1000$ 之内的正整数。
## 输出格式

输出 $10^6$ 乘以最优解的值，并向下取整（也就是说，如果这个数本身不是整数，输出小于它的最接近它的整数）。
## 样例

### 样例输入 #1
```
3 2
2 1 2 4
2 3 5 3
```
### 样例输出 #1
```
428571
```
## 提示

在这个例子中，仅由一条路径从 $1$ 到 $N$。 它的流量为 $\min(3,4)=3$，花费为 $2+5=7$。

### 数据范围

测试点 $2\sim 5$ 满足 $N,M\le 100$。

对于 $100\%$ 的数据，$2 \leq N \leq 1000$，$1 \leq M \leq 1000$。

供题：Brian Dean


---

---
title: "[USACO20JAN] Wormhole Sort S"
layout: "post"
diff: 普及+/提高
pid: P6004
tag: ['2020', '二分', 'USACO', '并查集']
---
# [USACO20JAN] Wormhole Sort S
## 题目描述

Farmer John 的奶牛们已经厌倦了他对她们每天早上排好序离开牛棚的要求。她们刚刚完成了量子物理学的博士学位，准备将这一过程搞快点。

今天早上，如同往常一样，Farmer John 的 $N$ 头编号为 $1 \ldots N$ 的奶牛（$1 \leq N \leq 10^5$），分散在牛棚中 $N$ 个编号为 $1 \ldots N$ 的不同位置，奶牛 $i$ 位于位置 $p_i$。但是今天早上还出现了 $M$ 个编号为 $1 \ldots M$ 的虫洞（$1 \leq M \leq 10^5$），其中虫洞 $i$ 双向连接了位置 $a_i$ 和 $b_i$，宽度为 $w_i$（$1\le a_i,b_i\le N, a_i\neq b_i, 1\le w_i\le 10^9$）。

在任何时刻，两头位于一个虫洞两端的奶牛可以选择通过虫洞交换位置。奶牛们需要反复进行这样的交换，直到对于 $1 \leq i \leq N$，奶牛 $i$ 位于位置 $i$。

奶牛们不想被虫洞挤坏。帮助她们最大化被她们用来排序的虫洞宽度的最小值。保证奶牛们有可能排好序。
## 输入格式

输入的第一行包含两个整数 $N$ 和 $M$。

第二行包含 $N$ 个整数 $p_1,p_2,\ldots ,p_N$。保证 $p$ 是 $1 \ldots N$ 的一个排列。

对于 $1$ 到 $M$ 之间的每一个 $i$，第 $i+2$ 行包含整数 $a_i,b_i,w_i$。
## 输出格式

输出一个整数，为在排序过程中奶牛必须挤进的虫洞的最小宽度的最大值。如果奶牛们不需要用任何虫洞来排序，输出 $-1$。
## 样例

### 样例输入 #1
```
4 4
3 2 1 4
1 2 9
1 3 7
2 3 10
2 4 3
```
### 样例输出 #1
```
9
```
### 样例输入 #2
```
4 1
1 2 3 4
4 2 13
```
### 样例输出 #2
```
-1
```
## 提示

### 样例解释 1

以下是一个仅用宽度至少为 9 的虫洞给奶牛排序的可能方案：

- 奶牛 1 和奶牛 2 使用第三个虫洞交换位置。
- 奶牛 1 和奶牛 3 使用第一个虫洞交换位置。
- 奶牛 2 和奶牛 3 使用第三个虫洞交换位置。

### 子任务

- 测试点 $3 \sim 5$ 满足 $N,M \leq 1000$。
- 测试点 $6 \sim 10$ 没有额外限制。


---

---
title: "[USACO20JAN] Time is Mooney G"
layout: "post"
diff: 普及+/提高
pid: P6005
tag: ['动态规划 DP', '2020', 'USACO', '最短路']
---
# [USACO20JAN] Time is Mooney G
## 题目描述

Bessie 正在安排前往牛尼亚的一次出差，那里有 $N$（$2 \leq N \leq 1000$）个编号为 $1 \ldots N$ 的城市，由 $M$（$1 \leq M \leq 2000$）条单向的道路连接。Bessie 每次访问城市 $i$ 都可以赚到 $m_i$ 哞尼（$0 \leq m_i \leq 1000$）。从城市 $1$ 出发，Bessie 想要赚到尽可能多的哞尼，最后回到城市 $1$。为了避免争议，$m_1=0$。

沿着两个城市之间的道路移动需要消耗一天。出差的准备工作十分费钱；旅行 $T$ 天需要花费 $C \times T^2$ 哞尼（$1 \leq C \leq 1000$）。

Bessie 在一次出差中最多可以赚到多少哞尼？注意有可能最优方案是 Bessie 不访问城市 $1$ 之外的任何城市，在这种情况下结果应当为 $0$。
## 输入格式

输入的第一行包含三个整数 $N$、$M$ 和 $C$。

第二行包含 $N$ 个整数 $m_1,m_2,\ldots, m_N$。

以下 $M$ 行每行包含两个空格分隔的整数 $a$ 和 $b$（$a \neq b$），表示从城市 $a$ 到城市 $b$ 的一条单向道路。
## 输出格式

输出一行，包含所求的答案。
## 样例

### 样例输入 #1
```
3 3 1
0 10 20
1 2
2 3
3 1
```
### 样例输出 #1
```
24
```
## 提示

最优的旅行方案是 $1 \to 2 \to 3 \to 1 \to 2 \to 3 \to1$。Bessie 总共赚到了 $10+20+10+20-1 \times 6^2=24$ 哞尼。


---

---
title: "[USACO05JAN] The Wedding Juicer G"
layout: "post"
diff: 普及+/提高
pid: P6063
tag: ['2005', 'USACO']
---
# [USACO05JAN] The Wedding Juicer G
## 题目描述

约翰的奶牛们找到了一份不错的兼职一设计冲压式榨汁机．榨汁机设计如下：

一个 $W \times H$ 的底座（$3\leq W,H \leq 300$），每一个 $1 \times 1$ 的方格上都放有一个高度为 $B$（$1 \leq B \leq 10^9$）的柱子，用来榨汁。假设柱子之间都被完美地粘合了，这样水不会顺着柱子与柱子之间的空隙流走。

但是约翰一直不知道，这么一个榨汁机，到底能装多少果汁？假设榨汁机周围没有任何东西，也就是说，边界上的水都会流走，有些榨汁机则根本不能装下任何的果汁。
## 输入格式

第一行两个整数 $W$ 和 $H$。

接下来 $H$ 行，每行 $W$ 个数字，代表了高度。
## 输出格式

输出最多能装多少果汁。
## 样例

### 样例输入 #1
```
4 5
5 8 7 7
5 2 1 5
7 1 7 1
8 9 6 9
9 8 9 9
```
### 样例输出 #1
```
12
```


---

---
title: "[USACO05JAN] Naptime G"
layout: "post"
diff: 普及+/提高
pid: P6064
tag: ['动态规划 DP', '2005', 'USACO']
---
# [USACO05JAN] Naptime G
## 题目描述

贝茜是一只非常缺觉的奶牛．她的一天被平均分割成 $N$ 段（$3 \leq N \leq 3830$），但是她要用其中的 $B$ 段时间（$2 \leq B \lt N$）睡觉。每段时间都有一个效用值 $U_i$（$0 \leq U_i \leq 2 \times 10^5$），只有当她睡觉的时候，才会发挥效用。

有了闹钟的帮助，贝茜可以选择任意的时间入睡，当然，她只能在时间划分的边界处入睡、醒来。

贝茜想使所有睡觉效用的总和最大。不幸的是，每一段睡眠的第一个时间阶段都是“入睡”阶段，而旦不记入效用值。

时间阶段是不断循环的圆（一天一天是循环的嘛），假如贝茜在时间 $N$ 和时间 $1$ 睡觉，那么她将得到时间 $1$ 的效用值。
## 输入格式

第一行两个整数 $N,B$。

接下来 $N$ 行，每行一个整数，表示第 $i$ 个时段的效用值。
## 输出格式

输出最大效用值。
## 样例

### 样例输入 #1
```
5 3
2
0
3
1
4
```
### 样例输出 #1
```
6
```
## 提示

从第 $4$ 个时段入睡，到第 $1$ 个时段结束醒来。


---

---
title: "[USACO05JAN] Watchcow S"
layout: "post"
diff: 普及+/提高
pid: P6066
tag: ['2005', 'USACO', 'Special Judge']
---
# [USACO05JAN] Watchcow S
## 题目描述

Farmer John 有 $N$ 个农场（$2 \leq N \leq 10^4$），这些农场由 $M$ 条道路连接（$1 \leq M \leq 5 \times 10^4$）。不保证没有重边。

Bassie 从 $1$ 号农场开始巡逻，每条路必须从两个方向各走**恰好一遍**，最后回到 $1$ 号农场。

请输出一条满足上述要求的路径。

保证这样的路径存在。如果有多条路径，任意输出一条即可。
## 输入格式

第一行两个整数 $N,M$。

接下来 $M$ 行，每行两个整数 $u,v$，描述一条 $u$ 到 $v$ 的道路。
## 输出格式

输出经过的农场，一行一个。
## 样例

### 样例输入 #1
```
4 5
1 2
1 4
2 3
2 4
3 4
```
### 样例输出 #1
```
1
2
3
4
2
1
4
3
2
4
1
```


---

---
title: "[USACO06MAR] Milk Team Select G"
layout: "post"
diff: 普及+/提高
pid: P6079
tag: ['2006', 'USACO']
---
# [USACO06MAR] Milk Team Select G
## 题目描述

Farmer John 的 $N(1 \le N \le 500)$ 头奶牛打算参加一场世界级的产奶比赛 （Multistate Milking Match-up，MMM），他们已经摸清了其他队的实力。他们的总产奶量只要大于等于 $X$ 加仑（$1 \leq X \leq 10^6$），就能赢得胜利。

每头奶牛都能为全队贡献一定量的牛奶，数值在 $-10^4$ 到 $10^4$ 加仑之间（为啥有负数？因为有些奶牛会打翻其他奶牛产的牛奶）。

MMM 的目标是通过合作，增进家庭成员间的默契。为了支持比赛精神，奶牛们希望在赢得比赛的前提下，有尽可能多对奶牛间存在直系血缘关系。当然，所有奶牛都是女性，因此这里的直系血缘关系就是母女关系。

现在 FJ 摸清了所有奶牛间的血缘关系，希望算出一个团队在赢得胜利的前提下，最多有多少对奶牛存在血缘关系。注意：如果一个团队由某头奶牛和她的母亲和外祖母组成的话，这个团队只有两对血缘关系（她和她的母亲，她的母亲和外祖母）。
## 输入格式

第一行两个整数 $N,X$。

接下来 $N$ 行，每行两个整数，第一个整数是它能为团队贡献的产奶量，第二个整数为它的母亲的编号，如果她的母亲不在牛群里，这个数字为 $0$。

保证血缘关系不会出现环。
## 输出格式

输出在获胜的前提下，一个团队中最多存在多少血缘关系。

特别地，如果不存在一个团队能获胜，输出 $-1$。
## 样例

### 样例输入 #1
```
5 8
-1 0
3 1
5 1
-3 3
2 0
```
### 样例输出 #1
```
2
```
## 提示

最优的队伍包含 $1,2,3,5$ 这四头奶牛，总产奶量为 $9$ 加仑，共有两对血缘关系（$1,2$ 和 $1,3$）。

虽然 $2,3,5$ 这个组合产奶量更大，但是这个组合里没有血缘关系。


---

---
title: "[USACO05DEC] Barn Expansion G"
layout: "post"
diff: 普及+/提高
pid: P6081
tag: ['2005', 'USACO']
---
# [USACO05DEC] Barn Expansion G
## 题目描述

Farmer John 有 $N$（$1 \leq N \leq 25000$）个矩形牛棚，它们的墙与坐标轴平行，且坐标在 $[0,10^6]$ 范围内。保证任意两个牛棚不重叠，但可能有公共的墙。

由于奶牛数量不断增加，FJ 打算扩张牛棚。一个牛棚是可以扩张的，当且仅当它的墙与其他牛棚的墙没有公共部分。如果两个牛棚有一个公共角，这两个牛棚均不可扩张。

请你求出有多少牛棚是可以扩张的。
## 输入格式

第一行一个整数 $N$。

接下来 $N$ 行，每行四个整数，分别代表牛棚左下角坐标和右上角坐标。
## 输出格式

输出可以扩张的牛棚数量。
## 样例

### 样例输入 #1
```
5
0 2 2 7
3 5 5 8
4 2 6 4
6 1 8 6
0 0 8 1
```
### 样例输出 #1
```
2
```
## 提示

前两个牛棚可以扩张。


---

---
title: "[USACO17FEB] Why Did the Cow Cross the Road II G"
layout: "post"
diff: 普及+/提高
pid: P6119
tag: ['2017', 'USACO']
---
# [USACO17FEB] Why Did the Cow Cross the Road II G
## 题目背景

*本题与 [白金组同名题目](/problem/P3657) 在题意上一致，唯一的差别是数据范围。*
## 题目描述

Farmer John 饲养了 $N$ 种奶牛，编号从 $1$ 到 $N$。一些品种的奶牛和其他奶牛间相处良好，事实证明，如果两个品种的奶牛编号分别为 $a,b$，当 $|a-b| \leq 4$ 时，这两个品种的奶牛能友好相处，否则不能友好相处。

一条长长的道路贯穿整个农场，道路的左侧有 $N$ 个牧场（每个品种的奶牛恰好占据一个牧场），道路的右侧也有 $N$ 个牧场（每个品种的奶牛恰好占据一个牧场）。为了让奶牛们安全穿过马路，Farmer John 希望能在马路上画出一些人行道（牛行道？），要求这些人行道满足如下条件：

1. 人行道从左侧的某个牧场出发，连接到右侧的某个牧场；
2. 人行道连接的两个牧场的奶牛要能友好相处；
3. 人行道不能在道路中间相交；
4. 每个牧场只能与一条人行道相连。

你需要帮 FJ 求出最多能有多少条人行道。
## 输入格式

输入第一行一个整数 $N$（$1 \leq N \leq 1000$）。

接下来 $N$ 行，每行一个整数 $a_i$，代表道路左侧第 $i$ 个牧场的奶牛品种编号。

接下来 $N$ 行，每行一个整数 $b_i$，代表道路右侧第 $i$ 个牧场的奶牛品种编号。
## 输出格式

输出最多能画多少条人行道。
## 样例

### 样例输入 #1
```
6
1
2
3
4
5
6
6
5
4
3
2
1
```
### 样例输出 #1
```
5
```


---

---
title: "[USACO16OPEN] Closing the Farm G"
layout: "post"
diff: 普及+/提高
pid: P6121
tag: ['2016', 'USACO', '并查集']
---
# [USACO16OPEN] Closing the Farm G
## 题目背景

*本题和 [银组同名题目](/problem/P3144) 在题意上一致，唯一的不同是数据范围。*
## 题目描述

FJ 和他的奶牛们正在计划离开小镇做一次长的旅行，同时 FJ 想临时地关掉他的农场以节省一些金钱。

这个农场一共有被用 $M$ 条双向道路连接的 $N$ 个谷仓（$1 \leq N,M \leq 2 \times 10^5$）。为了关闭整个农场，FJ 计划每一次关闭掉一个谷仓。当一个谷仓被关闭了，所有的连接到这个谷仓的道路都会被关闭，而且再也不能够被使用。

FJ 现在正感兴趣于知道在每一个时间（这里的“时间”指在每一次关闭谷仓之前的时间）时他的农场是否是“全连通的”——也就是说从任意的一个开着的谷仓开始，能够到达另外的一个谷仓。注意自从某一个时间之后，可能整个农场都开始不会是“全连通的”。
## 输入格式

输入第一行两个整数 $N,M$。

接下来 $M$ 行，每行两个整数 $u,v$（$1 \leq u,v \leq N$），描述一条连接 $u,v$ 两个农场的路。

最后 $N$ 行每行一个整数，表示第 $i$ 个被关闭的农场编号。
## 输出格式

输出 $N$ 行，每行包含 `YES` 或 `NO`，表示某个时刻农场是否是全连通的。

第一行输出最初的状态，第 $i$ 行（$2 \leq i \leq N$）输出第 $i-1$ 个农场被关闭后的状态。
## 样例

### 样例输入 #1
```
4 3
1 2
2 3
3 4
3
4
1
2
```
### 样例输出 #1
```
YES
NO
YES
YES
```


---

---
title: "[USACO11NOV] Cow Beauty Pageant S"
layout: "post"
diff: 普及+/提高
pid: P6131
tag: ['搜索', '2011', 'USACO']
---
# [USACO11NOV] Cow Beauty Pageant S
## 题目描述

听说最近流行表皮有三个斑点的奶牛，Farmer John 迅速购买了不少这样的奶牛。但流行趋势也在改变，最近改为流行只有一个斑点的奶牛了。

FJ 决定在他的奶牛上涂色，从而把三个斑点合并成一个。牛皮由一个 $N \times M$ 的矩阵来表示，像这样：

```plain
................
..XXXX....XXX...
...XXXX....XX...
.XXXX......XXX..
........XXXXX...
..XXX....XXX....
```

每个 `X` 表示斑点的一部分。如果两个 `X` 在竖直或水平方向上相邻，则它们属于同一个斑点（对角线相邻不算）。因此上面表示的是一头具有三个斑点的奶牛。

FJ 可以通过将一些 `.` 涂成 `X` 来改变牛身上的图案。他希望使用尽可能少的涂料将三个斑点合并为一个斑点。对于上图，下面是一种消耗涂料最少的方案（只涂了 4 个格子，新涂的格将用 `*` 表示）：

```plain
................
..XXXX....XXX...
...XXXX*...XX...
.XXXX..**..XXX..
...*....XXXXX...
..XXX....XXX....
```

现在请你帮 FJ 算出将三个斑点合并为一个斑点最少需要涂多少格子。
## 输入格式

第一行两个整数 $N,M$（$1 \leq N,M \leq 50$）。

接下来 $N$ 行，每行 $M$ 个字符（`*` 或 `X`），描述牛表皮的斑点分布情况。保证这头牛恰好有三个斑点。
## 输出格式

输出将三个斑点合并为一个斑点最少需要涂多少格子。
## 样例

### 样例输入 #1
```
6 16
................
..XXXX....XXX...
...XXXX....XX...
.XXXX......XXX..
........XXXXX...
..XXX....XXX....
```
### 样例输出 #1
```
4
```


---

---
title: "[USACO20FEB] Help Yourself G"
layout: "post"
diff: 普及+/提高
pid: P6146
tag: ['递推', '2020', 'USACO', '组合数学', '前缀和']
---
# [USACO20FEB] Help Yourself G
## 题目描述

在一个数轴上有 $N$ 条线段，第 $i$ 条线段覆盖了从 $l_i$ 到 $r_i$ 的所有实数（包含 $l_i$ 和 $r_i$）。

定义若干条线段的**并**为一个包含了所有被至少一个线段覆盖的点的集合。

定义若干条线段的**复杂度**为这些线段的并形成的连通块的数目。

现在 Bessie 想要求出给定 $N$ 条线段的所有子集（共有 $2^N$ 个）的复杂度之和对 $10^9+7$ 取模的结果。

你也许猜到了，你需要帮 Bessie 解决这个问题。但不幸的是，你猜错了！在这道题中你就是 Bessie，而且没有人来帮助你。一切就靠你自己了！
## 输入格式

第一行一个整数 $N$（$1 \leq N \leq 10^5$）。

接下来 $N$ 行，每行两个整数 $l_i,r_i$，描述一条线段。保证 $1 \leq l_i \lt r_i \leq 2N$，且任意两个端点都不在同一位置上。
## 输出格式

输出所求答案对 $10^9+7$ 取模的结果。
## 样例

### 样例输入 #1
```
3
1 6
2 3
4 5
```
### 样例输出 #1
```
8
```
## 提示

### 样例解释

所有非空子集的复杂度如下所示（显然空集的复杂度为零）：
$$
\{[1,6]\} \implies 1, \{[2,3]\} \implies 1, \{[4,5]\} \implies 1
$$

$$
\{[1,6],[2,3]\} \implies 1, \{[1,6],[4,5]\} \implies 1, \{[2,3],[4,5]\} \implies 2
$$

$$
\{[1,6],[2,3],[4,5]\} \implies 1
$$

故答案为 $1+1+1+1+1+2+1=8$。

### 子任务

- 测试点 $2 \sim 3$ 满足 $N \leq 16$；
- 测试点 $4 \sim 7$ 满足 $N \leq 1000$；
- 测试点 $8 \sim 12$ 没有特殊限制。


---

---
title: "[USACO20FEB] Swapity Swapity Swap S"
layout: "post"
diff: 普及+/提高
pid: P6148
tag: ['数学', '2020', '倍增', 'USACO']
---
# [USACO20FEB] Swapity Swapity Swap S
## 题目描述

Farmer John 的 $N$ 头奶牛（$1\leq N\leq 10^5$）站成一排。对于每一个 $1\leq i\leq N$，从左往右数第 $i$ 头奶牛的编号为 $i$。

Farmer John 想到了一个新的奶牛晨练方案。他给奶牛们 $M$ 对整数 $(L_1,R_1)\ldots (L_M,R_M)$，其中 $1\leq M\leq 100$。他让她们重复以下包含 $M$ 个步骤的过程 $K$（$1\leq K\leq 10^9$）次：

对于从 $1$ 到 $M$ 的每一个 $i$：
- 当前从左往右数在位置 $L_i\ldots R_i$ 的奶牛序列反转她们的顺序。
- 当奶牛们重复这一过程 $K$ 次后，请对每一个 $1\leq i\leq N$ 输出从左往右数第 $i$ 头奶牛的编号。
## 输入格式

输入的第一行包含 $N$，$M$ 和 $K$。对于每一个 $1\leq i\leq M$，第 $i+1$ 行包含 $L_i$ 和 $R_i$，均为范围在 $1\ldots N$ 内的整数，其中 $L_i<R_i$。
## 输出格式

在第 $i$ 行输出指令序列执行了 $K$ 次后奶牛序列中从左往右数第 $i$ 个元素的编号。
## 样例

### 样例输入 #1
```
7 2 2
2 5
3 7
```
### 样例输出 #1
```
1
2
4
3
5
7
6
```
## 提示

#### 样例解释：
初始时，奶牛们的顺序从左往右为 [$1,2,3,4,5,6,7$]。在这一过程的第一步过后，顺序变为 [$1,5,4,3,2,6,7$]。在这一过程的第二步过后，顺序变为 [$1,5,7,6,2,3,4$]。再重复这两个步骤各一次可以得到样例的输出。

#### 子任务：
- 测试点 $2$ 满足 $N=K=100$。
- 测试点 $3$-$5$ 满足 $K\leq 10^3$。
- 测试点 $6$-$10$ 没有额外限制。


---

---
title: "[USACO20FEB] Triangles S"
layout: "post"
diff: 普及+/提高
pid: P6149
tag: ['数学', '2020', 'USACO', '排序']
---
# [USACO20FEB] Triangles S
## 题目描述

Farmer John 想要给他的奶牛们建造一个三角形牧场。

有 $N$（$3\leq N\leq 10^5$）个栅栏柱子分别位于农场的二维平面上不同的点 $(X_1,Y_1)\ldots (X_N,Y_N)$。他可以选择其中三个点组成三角形牧场，只要三角形有一条边与 $x$ 轴平行，且有另一条边与 $y$ 轴平行。

FJ 可以组成的所有可能的牧场的面积之和等于多少？
## 输入格式

第一行包含 $N$。

以下 $N$ 行每行包含两个整数 $X_i$ 和 $Y_i$，均在范围 $−10^4\ldots 10^4$ 之内，描述一个栅栏柱子的位置。
## 输出格式

由于面积之和不一定为整数且可能非常大，输出面积之和的**两倍**模 $10^9+7$ 的余数。
## 样例

### 样例输入 #1
```
4
0 0
0 1
1 0
1 2
```
### 样例输出 #1
```
3
```
## 提示

#### 样例解释：
栅栏木桩 ($0,0$)、($1,0$) 和 ($1,2$) 组成了一个面积为 $1$ 的三角形，($0,0$)、($1,0$) 和 ($0,1$) 组成了一个面积为 $0.5$ 的三角形。所以答案为 $2\times (1+0.5)=3$。

#### 子任务：
- 测试点 $2$ 满足 $N=200$。
- 测试点 $3$-$4$ 满足 $N\leq 5000$。
- 测试点 $5$-$10$ 没有额外限制。


---

---
title: "[USACO20FEB] Clock Tree S"
layout: "post"
diff: 普及+/提高
pid: P6150
tag: ['搜索', '2020', 'USACO', '深度优先搜索 DFS', '图遍历']
---
# [USACO20FEB] Clock Tree S
## 题目描述

Farmer John 的新牛棚的设计十分奇怪：它由编号为 $1\ldots N$ 的 $N$ 间房间（$2\leq N\leq 2\,500$），以及 $N−1$ 条走廊组成。每条走廊连接两间房间，使得每间房间都可以沿着一些走廊到达任意其他房间。

牛棚里的每间房间都装有一个在表盘上印有标准的整数 $1\ldots 12$ 的圆形时钟。然而，这些时钟只有一根指针，并且总是直接指向表盘上的某个数字（它从不指向两个数字之间）。

奶牛 Bessie 想要同步牛棚中的所有时钟，使它们都指向整数 $12$。然而，她头脑稍有些简单，当她在牛棚里行走的时候，每次她进入一间房间，她将房间里的时钟的指针向后拨动一个位置。例如，如果原来时钟指向 $5$，现在它会指向 $6$，如果原来时钟指向 $12$，现在它会指向 $1$。如果 Bessie 进入同一间房间多次，她每次进入都会拨动这间房间的时钟。

请求出 Bessie 可能的出发房间数量，使得她可以在牛棚中走动并使所有时钟指向 $12$。注意 Bessie 并不拨动她出发房间的时钟，但任意时刻她再次进入的时候会拨动它。时钟不会自己走动；时钟只会在 Bessie 进入时被拨动。此外，Bessie 一旦进入了一条走廊，她必须到达走廊的另一端（不允许走到一半折回原来的房间）。
## 输入格式

输入的第一行包含 $N$。下一行包含 $N$ 个整数，均在范围 $1\ldots 12$ 之内，表示每间房间初始时的时钟设置。以下 $N−1$ 行每行用两个整数 $a$ 和 $b$ 描述了一条走廊，两数均在范围 $1\ldots N$ 之内，为该走廊连接的两间房间的编号。
## 输出格式

输出出发房间的数量，使得 Bessie 有可能使所有时钟指向 $12$。
## 样例

### 样例输入 #1
```
4
11 10 11 11
1 2
2 3
2 4
```
### 样例输出 #1
```
1
```
## 提示

#### 样例解释：
在这个例子中，当且仅当 Bessie 从房间 $2$ 出发时她可以使所有房间的时钟指向 $12$（比如，移动到房间 $1$，$2$，$3$，$2$，最后到 $4$）。

#### 子任务：
- 测试点 $2$-$7$ 满足 $N\leq 100$。
- 测试点 $8$-$15$ 没有额外限制。


---

---
title: "[USACO16FEB] Fenced In G"
layout: "post"
diff: 普及+/提高
pid: P6171
tag: ['贪心', '2016', 'USACO', '生成树']
---
# [USACO16FEB] Fenced In G
## 题目背景

*本题和 [白金组同名题目](/problem/P3141) 在题意上一致，唯一的不同是数据范围。*
## 题目描述

Farmer John 意识到他的奶牛最近患上了一种恐惧症（害怕过于开阔的空间）。为了减少放牧的恐惧，FJ 决定在牧场中建一些水平和竖直方向的栅栏来将牧场分成若干个小区域。

整个牧场是一个矩形，两个角的坐标分别为 $(0,0)$ 和 $(A,B)$。FJ 在 $a_1,\ldots ,a_n$ 这 $n$ 个两两不同的位置建造了竖直方向的栅栏，每个栅栏从 $(a_i,0)$ 到 $(a_i,B)$；FJ 在 $b_1,\ldots ,b_m$ 这 $m$ 个两两不同的位置建造了水平方向的栅栏，每个栅栏从 $(0,b_i)$ 到 $(A,b_i)$。竖直方向的栅栏和水平方向的栅栏两两相交，将整个牧场分割成 $(n+1)(m+1)$ 个区域。

不幸的是，FJ 忘记了在栅栏上开门，奶牛都只能被困在一个个的小区域里！他想通过去掉一些栅栏来解决这个问题。他一次可以选择两个相邻的区域，将隔离这两个区域的栅栏去掉。FJ 的目标是让奶牛能够抵达牧场的任意一个地方。

这是一个例子：

```plain
+---+--+
|   |  |
+---+--+
|   |  |
|   |  |
+---+--+
```

去掉一些栅栏后的效果是这样的：

```plain
+---+--+
|      |
+---+  +
|      |
|      |
+---+--+
```

为了降低工程量，FJ 当然希望拆除的栅栏长度最短。
## 输入格式

第一行四个整数 $A,B,n,m$，保证 $1 \leq n,m \leq 2000$，$1 \leq A,B \leq 10^9$。

接下来 $n$ 行，第 $i$ 行一个整数 $a_i$，保证 $0 \lt a_i \lt A$。

接下来 $m$ 行，第 $i$ 行一个整数 $b_i$，保证 $0 \lt b_i \lt B$。
## 输出格式

输出拆除栅栏的最小长度。**答案需要用 64 位带符号整数存储。**
## 样例

### 样例输入 #1
```
15 15 5 2
2
5
10
6
4
11
3
```
### 样例输出 #1
```
44
```


---

---
title: "[USACO10OPEN] Time Travel S"
layout: "post"
diff: 普及+/提高
pid: P6182
tag: ['2010', 'USACO', '可持久化', '栈']
---
# [USACO10OPEN] Time Travel S
## 题目描述

Farmer John 买了台时光机，这使得他可以方便地管理自己的奶牛群。

他现在有 $N$ 个操作（$1 \leq N \leq 8 \times 10^4$），每次操作仅可能是如下三种之一：

1. `a x`：添加一头编号为 $x$ 的奶牛（$1 \leq x \leq 10^6$）。
2. `s`：卖掉最近添加的奶牛（保证此时至少有一头奶牛）。
3. `t x`：回到**第 $x$ 次操作前**的状态（保证第 $x$ 次操作存在）。

你需要在 FJ 执行每次操作后输出他拥有的最新的奶牛的编号。特别地，如果没有奶牛，输出 $-1$。
## 输入格式

第一行一个整数 $N$。

接下来 $N$ 行，每行描述一次操作。
## 输出格式

第 $i$ 行输出第 $i$ 次操作后 FJ 拥有的最新的奶牛的编号。特别地，如果没有奶牛，输出 $-1$。
## 样例

### 样例输入 #1
```
12
a 5
a 3
a 7
s
t 2
a 2
t 4
a 4
s
t 7
s
s
```
### 样例输出 #1
```
5
3
7
3
5
2
7
4
7
2
5
-1
```
## 提示

下面是样例解释，其中拥有的奶牛已经按添加顺序排好。

| 操作编号 | 操作  | 拥有的奶牛 | 输出 |
| -------- | ----- | ---------- | ---- |
| 1        | `a 5` | 5          | 5    |
| 2        | `a 3` | 5,3        | 3    |
| 3        | `a 7` | 5,3,7      | 7    |
| 4        | `s`   | 5,3        | 3    |
| 5        | `t 2` | 5          | 5    |
| 6        | `a 2` | 5,2        | 2    |
| 7        | `t 4` | 5,3,7      | 7    |
| 8        | `a 4` | 5,3,7,4    | 4    |
| 9        | `s`   | 5,3,7      | 7    |
| 10       | `t 7` | 5,2        | 2    |
| 11       | `s`   | 5          | 5    |
| 12       | `s`   | /          | -1   |


---

---
title: "[USACO07FEB] Cow Sorting G"
layout: "post"
diff: 普及+/提高
pid: P6193
tag: ['2007', 'USACO']
---
# [USACO07FEB] Cow Sorting G
## 题目描述

Farmer John 的 $n$（$1 \leq n \leq 10^5$）头牛一字排开。每头奶牛都有一个“脾气暴躁”水平，范围在 $1 \ldots 10^5$，且任意两头奶牛的脾气暴躁值不相同。由于脾气暴躁的奶牛更有可能损坏 FJ 的挤奶设备，因此 FJ 希望对奶牛进行重新排序，以便按照脾气暴躁程度依此提升的顺序排列它们。

在此过程中，任何两头奶牛（不一定相邻）的位置都可以互换。由于脾气暴躁的母牛难以移动，因此 FJ 总共需要 $X + Y$ 单位的时间来交换两只脾气暴躁程度为 $X$ 和 $Y$ 的母牛。请帮助 FJ 计算将奶牛按脾气暴躁程度的升序排序所需的最短时间。
## 输入格式

第一行一个整数：$N$ 。

接下来 $N$ 行每行包含一个整数 $a_i$，代表第 $i$ 头奶牛的脾气暴躁值。
## 输出格式

输出将所有奶牛按按脾气暴躁程度的升序排序所需的最短时间。
## 样例

### 样例输入 #1
```
3 
2 
3 
1
```
### 样例输出 #1
```
7
```


---

---
title: "[USACO07CHN] Summing Sums G"
layout: "post"
diff: 普及+/提高
pid: P6202
tag: ['2007', 'USACO']
---
# [USACO07CHN] Summing Sums G
## 题目描述

$N$ 头奶牛（$1 \leq N \leq 5 \times 10^4$）刚刚学习了不少密码学知识，终于，她们创造出了属于奶牛的加密方法，由于她们经验不足，她们的加密方法很简单：

第 $i$ 头奶牛掌握着密码的第 $i$ 个数字，起始的时候是 $C_i$（$0 \leq C_i \lt 9 \times 10^7$）。加密的时候，第 $i$ 头奶牛会计算其他所有奶牛的数字和，并将这个和对 $98\,765\,431$ 取模。在所有奶牛计算完成后，每头奶牛都会用自己算的数字代替原来的数字。即，

$$
C_{i}'=(\sum_{k=1}^NC_k-C_i) \bmod 98\,765\,431
$$

这样，她们完成了一次加密。

在十一月，奶牛们把这个加密方法告诉了驼鹿卡门。卡门想了一会后，说：“你们的算法还很原始，为了达到加密效果，你们要重复这个加密过程 $T$ 次（$1 \leq T \leq 1\,414\,213\,562$）”。

奶牛们很懒，于是就把这个任务交给了你。
## 输入格式

第一行两个整数 $N,T$。

接下来 $N$ 行，第 $i$ 行一个整数 $C_i$。
## 输出格式

输出 $N$ 行，第 $i$ 行一个整数，代表经过 $T$ 次加密后的 $C_i$。
## 样例

### 样例输入 #1
```
3 4
1
0
4
```
### 样例输出 #1
```
26
25
29

```
## 提示

每次加密后的 $C_i$ 如下：

| 次数 | $C_1$ | $C_2$ | $C_3$ |
| ---- | ----- | ----- | ----- |
| 0    | 1     | 0     | 4     |
| 1    | 4     | 5     | 1     |
| 2    | 6     | 5     | 9     |
| 3    | 14    | 15    | 11    |
| 4    | 26    | 25    | 29    |


---

---
title: "[USACO20OPEN] Haircut G"
layout: "post"
diff: 普及+/提高
pid: P6278
tag: ['2020', '线段树', 'USACO', '树状数组']
---
# [USACO20OPEN] Haircut G
## 题目描述

Farmer John 由于对整理他难以整平的头发感到疲惫，于是决定去理发。他有一排 $N$ 缕头发，第 $i$ 缕头发初始时长度为 $A_i$ 微米（$0\le A_i\le N$）。理想情况下，他想要他的头发在长度上单调递增，所以他定义他的头发的“不良度”为逆序对的数量：满足 $i < j$ 及 $A_i > A_j$ 的二元对 $(i,j)$。  
对于每一个 $j=0,1,\ldots,N-1$，Farmer John 想要知道他所有长度大于 $j$ 的头发的长度均减少到 $j$ 时他的头发的不良度。

-----

（有趣的事实：人类平均确实有大约 $10^5$ 根头发！）
## 输入格式

输入的第一行包含 $N$。  
第二行包含 $A_1,A_2,\ldots,A_N$。
## 输出格式

对于每一个 $j=0,1,\ldots,N-1$，用一行输出 Farmer John 头发的不良度。

-----

  
**注意这个问题涉及到的整数大小可能需要使用 $64$ 位整数型存储（例如，C/C++ 中的“long long”）。**
## 样例

### 样例输入 #1
```
5
5 2 3 3 0
```
### 样例输出 #1
```
0
4
4
5
7
```
## 提示

#### 样例解释：

输出的第四行描述了 Farmer John 的头发长度减少到 $3$ 时的逆序对数量。   
$A=[3,2,3,3,0]$ 有五个逆序对：$A_1>A_2,\,A_1>A_5,\,A_2>A_5,\,A_3>A_5,$ 和 $A_4>A_5$。

----

对于 $100\%$ 的数据，$1\le N\le 10^5$。

共 $13$ 个测试点，其中 $1$ 为样例，其余性质如下：
  
测试点 $2$ 满足 $N\le 100$。  
测试点 $3\sim 5$ 满足 $N\le 5000$。  
测试点 $6\sim 13$ 没有额外限制。  

-----


出题人：Dhruv Rohatgi



---

---
title: "[USACO20DEC] Rectangular Pasture S"
layout: "post"
diff: 普及+/提高
pid: P7149
tag: ['2020', 'USACO', '离散化', 'O2优化', '排序', '前缀和']
---
# [USACO20DEC] Rectangular Pasture S
## 题目描述

Farmer John 最大的牧草地可以被看作是一个由方格组成的巨大的二维方阵（想象一个巨大的棋盘）。现在，有 $N$ 头奶牛正占据某些方格（$1≤N≤2500$）。

Farmer John 想要建造一个可以包围一块矩形区域的栅栏；这个矩形必须四边与 $x$ 轴和 $y$ 轴平行，最少包含一个方格。请帮助他求出他可以包围在这样的区域内的不同的奶牛子集的数量。注意空集应当被计算为答案之一。 
## 输入格式

输入的第一行包含一个整数 $N$。以下 $N$ 行每行包含两个空格分隔的整数，表示一头奶牛所在方格的坐标 $(x,y)$。所有 $x$ 坐标各不相同，所有 $y$ 坐标各不相同。所有 $x$ 与 $y$ 的值均在 $0…10^9$ 范围内。 
## 输出格式

 输出 FJ 可以包围的奶牛的子集数量。可以证明这个数量可以用 64 位有符号整数型存储（例如 C/C++ 中的long long）。 
## 样例

### 样例输入 #1
```
4
0 2
1 0
2 3
3 5
```
### 样例输出 #1
```
13
```
## 提示

共有 $2^4$ 个子集。FJ 不能建造一个栅栏仅包围奶牛 $1$、$2$、$4$，或仅包围奶牛 $2$、$4$，或仅包围奶牛 $1$、$4$，所以答案为 $2^4-3=16-3=13$。 

 - 测试点 2-3 满足 $N≤20$。
 - 测试点 4-6 满足 $N≤100$。
 - 测试点 7-12 满足 $N≤500$。
 - 测试点 13-20 没有额外限制。

供题：Benjamin Qi 


---

---
title: "[USACO20DEC] Stuck in a Rut S"
layout: "post"
diff: 普及+/提高
pid: P7150
tag: ['贪心', '2020', 'USACO', 'O2优化', '排序']
---
# [USACO20DEC] Stuck in a Rut S
## 题目描述

Farmer John 最近扩大了他的农场，从奶牛们的角度看来这个农场相当于是无限大了！奶牛们将农场上放牧的区域想作是一个由正方形方格组成的无限大二维方阵，每个方格中均有美味的草（将每个方格看作是棋盘上的一个方格）。Farmer John 的 $N$ 头奶牛（$1≤N≤1000$）初始时位于不同的方格中，一部分朝向北面，一部分朝向东面。

每一小时，每头奶牛会执行以下二者之一：

 - 如果她当前所在的方格里的草已经被其他奶牛吃掉了，则她会停下（并从这个时刻开始一直保持停止）。
 - 吃完她当前所在的方格中的所有草，并向她朝向的方向移动一个方格。

经过一段时间，每头奶牛的身后会留下一条被啃秃了的轨迹。

如果两头奶牛在一次移动中移动到了同一个有草的方格，她们会分享这个方格中的草，并在下一个小时继续沿她们朝向的方向移动。

当 Farmer John 看到停止吃草的奶牛时会不高兴，他想要知道谁该为他停止吃草的奶牛受到责备。如果奶牛 $b$
停在了之前奶牛 $a$ 吃过草的一个方格，我们就称奶牛 $a$ 阻碍了奶牛 $b$。进一步地，如果奶牛 $a$ 阻碍了奶牛 $b$ 且奶牛 $b$ 阻碍了奶牛 $c$，我们认为奶牛 $a$ 也阻碍了奶牛 $c$（也就是说，「阻碍」关系具有传递性）。每头奶牛受到责备的程度与这头奶牛阻碍的奶牛数量一致。请计算每头奶牛受到责备的数量——也就是说，每头奶牛阻碍的奶牛数量。 
## 输入格式

输入的第一行包含 $N$。以下 $N$ 行，每行描述一头奶牛的起始位置，包含一个字符 N（表示朝向北面） 或 E（表示朝向东面），以及两个非负整数 $x$ 和 $y$（$0≤x≤10^9$，$0≤y≤10^9$）表示方格的坐标。所有 $x$ 坐标各不相同，所有 $y$ 坐标各不相同。

为了使方向和坐标尽可能明确，如果一头奶牛位于方格 $(x,y)$ 并向北移动，她会到达方格 $(x,y+1)$。如果她向东移动，她会到达方格 $(x+1,y)$。 
## 输出格式

输出 $N$ 行。输出的第 $i$ 行包含输入中的第 $i$ 头奶牛受到的责备的数量。 
## 样例

### 样例输入 #1
```
6
E 3 5
N 5 3
E 4 6
E 10 4
N 11 1
E 9 2
```
### 样例输出 #1
```
0
0
1
2
1
0

```
## 提示

在这个样例中，奶牛 3 阻碍了奶牛 2，奶牛 4 阻碍了奶牛 5，奶牛 5 阻碍了奶牛 6。根据传递性，奶牛 4 也阻碍了奶牛 6。 

 - 测试点 2-5 中，所有坐标不超过 $2000$。
 - 测试点 6-10 没有额外限制。

供题：Brian Dean 


---

---
title: "[USACO21JAN] Dance Mooves S"
layout: "post"
diff: 普及+/提高
pid: P7299
tag: ['USACO', '并查集', '2021']
---
# [USACO21JAN] Dance Mooves S
## 题目描述

Farmer John 的奶牛们正在炫耀她们的最新舞步！

最初，所有的 $N$ 头奶牛（$2≤N≤10^5$）站成一行，奶牛 $i$ 排在其中第 $i$ 位。舞步序列给定为 $K$ （$1≤K≤2\times10^5$）个位置对 $(a_1,b_1),(a_2,b_2),…,(a_K,b_K)$。在舞蹈的第 $i=1…K$ 分钟，位置 $a_i$ 与 $b_i$ 上的奶牛交换位置。同样的 $K$ 次交换在第 $K+1…2K$ 分钟发生，在第 $2K+1…3K$ 分钟再次发生，以此类推，无限循环。换言之， 

 - 在第 $1$ 分钟，位置 $a_1$ 与 $b_1$ 上的奶牛交换位置。
 - 在第 $2$ 分钟，位置 $a_2$ 与 $b_2$ 上的奶牛交换位置。
 - ……
 - 在第 $K$ 分钟，位置 $a_K$ 与 $b_K$ 上的奶牛交换位置。
 - 在第 $K+1$ 分钟，位置 $a_1$ 与 $b_1$ 上的奶牛交换位置。
 - 在第 $K+2$ 分钟，位置 $a_2$ 与 $b_2$ 上的奶牛交换位置。
 - 以此类推……

对于每头奶牛，求她在队伍中会占据的不同的位置数量。
## 输入格式

输入的第一行包含 $N$、$K$。以下 $K$ 行分别包含 $(a_1,b_1)…(a_K,b_K)$（$1≤a_i<b_i≤N$）。 
## 输出格式

输出 $N$ 行，第 $i$ 行包含奶牛 $i$ 可以到达的不同的位置数量。 
## 样例

### 样例输入 #1
```
5 4
1 3
1 2
2 3
2 4
```
### 样例输出 #1
```
4
4
3
4
1
```
## 提示

 - 奶牛 $1$ 可以到达位置 $\{1,2,3,4\}$。
 - 奶牛 $2$ 可以到达位置 $\{1,2,3,4\}$。
 - 奶牛 $3$ 可以到达位置 $\{1,2,3\}$。
 - 奶牛 $4$ 可以到达位置 $\{1,2,3,4\}$。
 - 奶牛 $5$ 从未移动，所以她没有离开过位置 $5$。

#### 测试点性质：

 - 测试点 1-5 满足 $N≤100,K≤200$。
 - 测试点 6-10 满足 $N≤2000,K≤4000$。
 - 测试点 11-20 没有额外限制。

供题：Chris Zhang 


---

---
title: "[USACO21JAN] Spaced Out S"
layout: "post"
diff: 普及+/提高
pid: P7301
tag: ['数学', '贪心', 'USACO', '2021']
---
# [USACO21JAN] Spaced Out S
## 题目描述

Farmer John 想要拍摄一张他的奶牛吃草的照片挂在墙上。草地可以用一个 $N$ 行 $N$ 列正方形方格所组成的方阵表示（想象一个 $N \times N$ 的棋盘），其中 $2 \leq N \leq 1000$。在 Farmer John 最近拍摄的照片中，他的奶牛们太过集中于草地上的某个区域。这一次，他想要确保他的奶牛们分散在整个草地上。于是他坚持如下的规则：

 - 没有两头奶牛可以位于同一个方格。
 - 所有 $2 \times 2$ 的子矩阵（共有 $(N-1) \times (N-1)$ 个）必须包含恰好 2 头奶牛。

例如，这一放置方式是合法的：

```
CCC
...
CCC
```

而这一放置方式是不合法的，因为右下的 $2 \times 2$ 正方形区域仅包含 1 头奶牛：

```
C.C
.C.
C..
```

没有其他限制。你可以假设 Farmer John 有无限多的奶牛（根据以往的经验，这种假设似乎是正确的……）。

Farmer John 更希望某些方格中包含奶牛。具体地说，他相信如果方格 $(i, j)$ 中放有一头奶牛，照片的美丽度会增加 $a_{ij}$（$0 \leq a_{ij} \leq 1000$）单位。

求合法的奶牛放置方式的最大总美丽度。

## 输入格式

输入的第一行包含 $N$。以下 $N$ 行每行包含 $N$ 个整数。从上到下第 $i$ 行的第 $j$ 个整数为 $a_{ij}$ 的值。

## 输出格式

输出一个整数，为得到的照片的最大美丽度。

## 样例

### 样例输入 #1
```
4
3 3 1 1
1 1 3 1
3 3 1 1
1 1 3 3
```
### 样例输出 #1
```
22
```
## 提示

在这个样例中，最大美丽度可以在如下放置方式时达到：

```
CC..
..CC
CC..
..CC
```

这种放置方式的美丽度为 $3 + 3 + 3 + 1 + 3 + 3 + 3 + 3 = 22$。

测试点性质：

 - 测试点 2-4 满足 $N \le 4$。
 - 测试点 5-10 满足 $N\le 10$。
 - 测试点 11-20 满足 $N \le 1000$。

供题：Hankai Zhang，Danny Mittal


---

---
title: "[USACO21FEB] Just Green Enough S"
layout: "post"
diff: 普及+/提高
pid: P7410
tag: ['USACO', '2021', 'O2优化', '枚举']
---
# [USACO21FEB] Just Green Enough S
## 题目描述

Farmer John 的草地可以被看作是一个由 $N \times N$ 个正方形方格（$1 \leq N \leq 500$）组成的方阵（想象一个巨大的棋盘）。由于土壤变异性，某些方格中的草可能更绿。每个方格 $(i,j)$ 可以用一个整数绿度值 $G(i,j)$ 来描述，范围为 $1 \ldots 200$。

Farmer John 想要给他的草地的一个子矩阵拍摄一张照片。他希望确保这一子矩阵看上去足够绿，但又不绿得过分，所以他决定拍摄一个 $G$ 的最小值恰好等于 100 的子矩阵。请帮助他求出他可以拍摄多少不同的照片。子矩阵最大可以为整个草地，最小可以仅为一个方格（共有 $N^2(N+1)^2/4$ 个不同的子矩阵——注意该数可能无法用 $32$ 位整数型存储，所以你可能需要使用 $64$ 位整数类型，例如 C++ 中的 long long）。

## 输入格式

输入的第一行包含 $N$。以下 $N$ 行每行包含 $N$ 个整数，表示 $N \times N$ 草地的 $G(i,j)$ 值。
## 输出格式

输出 Farmer John 可以拍摄的不同的照片数量——也就是说，最小绿度值等于 $100$ 的子矩阵数量。

注意这个问题涉及到的整数大小可能需要使用 $64$ 位整数型存储（例如，C/C++ 中的 long long）。
## 样例

### 样例输入 #1
```
3
57 120 87
200 100 150
2 141 135
```
### 样例输出 #1
```
8
```
## 提示

#### 测试点性质：

 - 对于 $50\%$ 的数据，满足 $N\le 200$。
 - 对于另外 $50\%$ 的数据，没有额外限制。

供题：Brian Dean


---

---
title: "[USACO21FEB] Comfortable Cows S"
layout: "post"
diff: 普及+/提高
pid: P7411
tag: ['模拟', '搜索', 'USACO', '2021', 'O2优化']
---
# [USACO21FEB] Comfortable Cows S
## 题目描述

Farmer Nhoj 的草地可以被看作是一个由正方形方格组成的巨大的二维方阵（想象一个巨大的棋盘）。初始时，草地上是空的。

Farmer Nhoj 将会逐一地将 $N$（$1\le N\le 10^5$）头奶牛加入到草地上。第 $i$ 头奶牛将会占据方格 $(x_i,y_i)$，不同于所有已经被其他奶牛占据的方格（$0\le x_i,y_i\le 1000$）。

一头奶牛被称为是「舒适的」，如果它水平或竖直方向上与恰好三头其他奶牛相邻。然而，太舒适的奶牛往往产奶量落后，所以 Farmer Nhoj 想要额外加入一些奶牛直到没有奶牛（包括新加入的奶牛）是舒适的。注意加入的奶牛的 $x$ 和 $y$ 坐标并不一定需要在范围 $0 \ldots 1000$ 内。

对于 $1 \ldots N$ 中的每个 $i$，输出当初始时草地上有奶牛 $1\ldots i$ 时，Farmer Nhoj 为使得没有奶牛舒适，需要加入的奶牛的最小数量。

## 输入格式

输入的第一行包含一个整数 $N$。以下 $N$ 行每行包含两个空格分隔的整数，表示一头奶牛所在的方格坐标 $(x,y)$。
## 输出格式

输出 $N$ 行，对于 $1 \ldots N$ 中的每个 $i$，输出一行，为 Farmer Nhoj 需要加入的奶牛数量。
## 样例

### 样例输入 #1
```
9
0 1
1 0
1 1
1 2
2 1
2 2
3 1
3 2
4 1
```
### 样例输出 #1
```
0
0
0
1
0
0
1
2
4
```
## 提示


对于 $i=4$，Farmer Nhoj 需要在 $(2,1)$ 加入一头奶牛使得位于 $(1,1)$ 的奶牛不再舒适。

对于 $i=9$，Farmer Nhoj 的最优方案是在 $(2,0)$、$(3,0)$、$(2,-1)$ 和 $(2,3)$ 加入奶牛。

供题：Benjamin Qi


---

---
title: "[USACO21OPEN] Maze Tac Toe S"
layout: "post"
diff: 普及+/提高
pid: P7555
tag: ['USACO', '2021', '记忆化搜索', '进制']
---
# [USACO21OPEN] Maze Tac Toe S
## 题目描述

奶牛 Bessie 喜欢玩走迷宫。她同样喜欢玩井字棋（更准确地说，奶牛版的井字棋，马上会进行介绍）。Farmer John 找到了一种全新的方式，可以使她同时玩到这两种游戏！

首先，奶牛井字棋：与在 $3 \times 3$ 棋盘内放置 `X` 和 `O` 不同，奶牛当然是在 $3 \times 3$ 棋盘内放置 `M` 和 `O`。在一方的回合内，玩家可以选择将一个 `M` 或一个 `O` 放在任意一个空格内（这是另一个与标准井字棋的不同之处，标准的井字棋中一名玩家始终放 `X` 而另一名玩家始终放 `O`）。奶牛井字棋的胜利方是首位拼出 `MOO` 的玩家，可以是同行、同列或对角线。倒着拼出也是可以的，例如一名玩家在棋盘的一行内拼出 `OOM` 也可以获胜。如同标准井字棋一样，有可能最后没有玩家取得胜利。奶牛井字棋的一次行动通常用 3 个字符表示，`Mij` 或 `Oij`，其中 $i$ 和 $j$ 在范围 $1 \ldots 3$ 之间，表示放置 `M` 或 `O` 的行与列。

为了给 Bessie 增加一些挑战，Farmer John 设计了一个由 $N \times N$ 个方格组成的正方形迷宫（$3 \leq N \leq 25$）。某些方格，包括所有的边界方格，有巨大的草堆，使得 Bessie 不能移动到这些方格。Bessie 可以沿东南西北四个方向在迷宫内的所有其他方格内自由行动。某些方格内有一张纸，上面写有奶牛井字棋的一次行动。当 Bessie 在迷宫中移动时，任何时刻她停留在这样的方格上，她都必须于迷宫中移动之时在同时进行的奶牛井字棋游戏内做出对应的行动（除非奶牛井字棋中对应的方格已经被填上了，在这种情况下她不进行行动）。在奶牛井字棋游戏内没有与她对阵的玩家，但迷宫中的某些方格可能会不利于她最终拼出 `MOO`。

如果 Bessie 在获胜之时就会立刻停止奶牛井字棋，请求出她可以通过适当的方式在迷宫中移动而完成的不同的胜利状态棋盘数量。
## 输入格式

输入的第一行包含 $N$。

以下 $N$ 行，每行包含 $3N$ 个字符，描述迷宫。每个方格用 3 个字符表示，`###` 代表墙，`...` 代表空格，`BBB` 代表 Bessie 所在的一个非墙方格，或者一个奶牛井字棋的行动，表示 Bessie 必须进行对应行动的一个非墙方格。恰好一个方格为 `BBB`。
## 输出格式

输出 Bessie 可以通过在迷宫中行动并在获胜时立刻停止而产生的不同的胜利状态下的奶牛井字棋盘数量（可能为 $0$）。
## 样例

### 样例输入 #1
```
7
#####################
###O11###...###M13###
###......O22......###
###...######M22######
###BBB###M31###M11###
###...O32...M33O31###
#####################
```
### 样例输出 #1
```
8
```
## 提示

#### 样例说明

在这个样例中，Bessie 最终可能达成 $8$ 种胜利的棋盘状态：

```plain
O.M
.O.
MOM

O..
.O.
.OM

O.M
.O.
.OM

O..
.O.
MOM

O..
...
OOM

..M
.O.
OOM

...
.O.
OOM

...
...
OOM
```

对其中一种情况进行说明：

```plain
O..
...
OOM
```

在这里，Bessie 可以先移动到 `O11` 方格，然后移动到下方并通过 `O32`、`M33` 和 `O31`。此时游戏结束，因为她获得了胜利（例如她不能再前往位于她当前所在的 `O31` 方格北面的 `M11` 方格）。

#### 说明

供题：Brian Dean


---

---
title: "[USACO21DEC] Bracelet Crossings G"
layout: "post"
diff: 普及+/提高
pid: P7989
tag: ['USACO', '2021', '分类讨论']
---
# [USACO21DEC] Bracelet Crossings G
## 题目描述

奶牛 Bessie 喜欢手工艺。在她的空闲时间，她制作了 $N$（$1\le N\le 50$）个手链，编号为 $1 \ldots N$。第 $i$ 个手链涂有颜色 $i$，是 $N$ 种不同的颜色之一。制作完手链后，Bessie 将它们放在桌子上进行展示（我们可以将其视为二维平面）。她精心布置这些手链，以满足以下三个条件：

- 每个手链是一个简单闭合折线——一组顶点（点）依次用线段连接，并且第一个点和最后一个点相同（欢迎查阅维基百科页面了解更多详情：[Polygonal_chain](https://en.wikipedia.org/wiki/Polygonal_chain)，或百度百科：[折线](https://baike.baidu.com/item/%E6%8A%98%E7%BA%BF/486302)），

- 没有手链与自身相交（这对应「简单」折线）；

- 以及没有两条手链相交。

不幸的是，就在 Bessie 如此小心翼翼地布置好手链之后，Farmer John 开着拖拉机经过，桌子晃动起来，导致手链四处移动甚至可能断成了多个（不一定是闭合的或简单的）折线！在那之后，Bessie 还是想检查以上三个条件是否仍然成立。然而，天色已暗，她现在无法看清手链。

幸好 Bessie 有一个手电筒。她选择了 $M$（$1\le M\le 50$）条垂直线 $x=1, x=2, \ldots, x=M$，并且对于每条线，她用手电筒的光沿着那条线从 $y=-\infty$ 扫至 $y=\infty$，按照出现的顺序记录她看到的所有手链的颜色。幸运的是，没有光束穿过任何折线的顶点或同时穿过两条线段。此外，对于每一束光，所有出现的颜色都恰好出现了两次。

你能帮助 Bessie 使用此信息来确定手链是否仍然满足上述所有三个条件吗？
## 输入格式

每个测试用例的输入包含 $T$ 个子测试用例（$1 \leq T \leq 50$），所有子测试用例必须全部回答正确才能通过整个测试用例。相邻的子测试用例之间用空行分隔。

输入的第一行包含 $T$。之后是 $T$ 个子测试用例。

每个子测试用例的第一行包含两个整数 $N$ 和 $M$。此后每个子测试用例还包含 $M$ 行。对 $1$ 到 $M$ 的每一个 $i$，第 $i$ 行包含一个整数 $k_i$（$0\le k_i\le 2N$，$k_i$ 为偶数），然后是 $k_i$ 个整数 $c_{i1}, c_{i2},\ldots, c_{ik_i}$（$c_{ij}\in [1,N]$，每个 $c_{ij}$ 出现零次或两次)。这表示当 Bessie 将手电筒从 $(i,-\infty)$ 扫至 $(i,\infty)$ 时，她按顺序 $c_{i1}, c_{i2},\ldots, c_{ik_i}$ 看到了这些颜色。

## 输出格式

对每个子测试用例，如果有可能使得以上三个条件均满足则输出 YES。否则，输出 NO。
## 样例

### 样例输入 #1
```
5

1 2
2 1 1
2 1 1

1 3
2 1 1
0
2 1 1

2 1
4 1 2 1 2

4 2
6 1 2 2 3 3 1
6 1 2 4 4 2 1

2 2
4 1 1 2 2
4 2 2 1 1
```
### 样例输出 #1
```
YES
NO
NO
YES
NO
```
## 提示

【样例解释】

对于第一个子测试用例，一组可行的手链位置为：

![](https://cdn.luogu.com.cn/upload/image_hosting/q3mohld2.png?x-oss-process=image/resize,m_lfit,h_170,w_225)

对于第四个子测试用例，一组可行的手链位置为：

![](https://cdn.luogu.com.cn/upload/image_hosting/8m2hcgbb.png?x-oss-process=image/resize,m_lfit,h_170,w_225)

【数据范围】

- 测试点 2 满足 $N = 1$。
- 测试点 3-5 满足 $N=2$。
- 测试点 6-8 满足 $M=1$。
- 测试点 9-14 满足 $M=2$。
- 测试点 15-20 没有额外限制。


---

---
title: "[USACO21DEC] Connecting Two Barns S"
layout: "post"
diff: 普及+/提高
pid: P7991
tag: ['二分', 'USACO', '并查集', '2021']
---
# [USACO21DEC] Connecting Two Barns S
## 题目描述

Farmer John 的农场由 $N$ 块田地（$1 \leq N \leq 10^5$）组成，编号为 $1 \ldots N$。在这些田地之间有 $M$ 条双向道路（$0 \leq M \leq 10^5$），每条道路连接两块田地。

农场有两个牛棚，一个在田地 1 中，另一个在田地 $N$ 中。Farmer John 希望确保有一种方式可以沿着一组道路在两个牛棚之间行走。 他愿意建造至多两条新道路来实现这一目标。由于田地的位置因素，在田地 $i$ 和 $j$ 之间建造新道路的花费是 $(i-j)^2$。

请帮助 Farmer John 求出使得牛棚 $1$ 和 $N$ 可以相互到达所需要的最小花费。
## 输入格式

每个测试用例的输入包含 $T$ 个子测试用例（$1\le T\le 20$），所有子测试用例必须全部回答正确才能通过整个测试用例。

输入的第一行包含 $T$，之后是 $T$ 个子测试用例。

每个子测试用例的第一行包含两个整数 $N$ 和 $M$。以下 $M$ 行，每行包含两个整数 $i$ 和 $j$，表示一条连接两个不同田地 $i$ 和 $j$ 的道路。输入保证任何两个田地之间至多只有一条道路，并且所有子测试用例的 $N+M$ 之和不超过 $5 \cdot 10^5$。

## 输出格式

输出 $T$ 行。第 $i$ 行包含一个整数，为第 $i$ 个子测试用例的最小花费。
## 样例

### 样例输入 #1
```
2
5 2
1 2
4 5
5 3
1 2
2 3
4 5
```
### 样例输出 #1
```
2
1

```
## 提示

【样例解释】

- 第一个子测试用例中，最优的方式是用一条道路连接田地 2 和 3，用一条道路连接田地 3 和 4。
- 第二个子测试用例中，最优的方式是用一条道路连接田地 3 和 4。不需要第二条道路。

【数据范围】

- 测试点 2 满足 $N \le 20$。
- 测试点 3-5 满足 $N \le 10^3$。
- 测试点 6-10 没有额外限制。


---

---
title: "[USACO22JAN] Searching for Soulmates S"
layout: "post"
diff: 普及+/提高
pid: P8093
tag: ['数学', '贪心', 'USACO', '2022', '进制']
---
# [USACO22JAN] Searching for Soulmates S
## 题目描述

Farmer John 的每头奶牛都想找到她们的灵魂伴侣——另一头具有相似特点的奶牛，与她们最大程度地相容。每头奶牛的性格由一个整数 $p_i$（$1 \leq p_i \leq 10^{18}$）描述。两头性格相同的奶牛就是灵魂伴侣。奶牛可以通过「改变操作」，对她的性格乘以 $2$，除以 $2$（当 $p_i$ 是偶数时），或者加上 $1$。

Farmer John 最初以任意方式配对了他的奶牛。他很好奇为使每对奶牛成为灵魂伴侣需要进行多少次改变操作。对于每对奶牛，求配对中的第一头奶牛所必须进行的最小改变操作次数，从而可以与第二头奶牛成为灵魂伴侣。
## 输入格式

输入的第一行包含 $N$（$1\le N\le 10$），为奶牛配对的数量。以下 $N$ 行每行描述了一对奶牛，包含两个整数，为她们的性格值。第一个整数是需要被改变与另一头奶牛相匹配的奶牛的性格。
## 输出格式

输出 $N$ 行。对于每一对奶牛，输出第一头奶牛需要进行的最小操作次数，使得她的性格与第二头奶牛相匹配。
## 样例

### 样例输入 #1
```
6
31 13
12 8
25 6
10 24
1 1
997 120
```
### 样例输出 #1
```
8
3
8
3
0
20
```
## 提示

【样例解释】

对于第一个子测试用例，一个最优的操作序列为 $31 \implies 32 \implies 16 \implies 8 \implies 9 \implies 10 \implies 11 \implies 12 \implies 13$。

对于第二个子测试用例，一个最优的操作序列为 $12 \implies 6 \implies 7 \implies 8$.

【数据范围】

- 测试点 1-4 满足 $p_i \le 10^5$。
- 测试点 5-12 没有额外限制。




---

---
title: "[USACO22JAN] Farm Updates G"
layout: "post"
diff: 普及+/提高
pid: P8097
tag: ['搜索', 'USACO', '并查集', '2022']
---
# [USACO22JAN] Farm Updates G
## 题目描述

Farmer John 经营着总共 $N$ 个农场（$1\le N\le 10^5$），编号为 $1\ldots N$。最初，这些农场之间没有道路连接，并且每个农场都在活跃地生产牛奶。

由于经济的动态性，Farmer John 需要根据 $Q$ 次更新操作（$0\le Q\le 2\cdot 10^5$）对他的农场进行改造。更新操作有三种可能的形式：

- `(D x)` 停用一个活跃的农场 $x$，使其不再生产牛奶。

- `(A x y)` 在两个活跃的农场 $x$ 和 $y$ 之间添加一条道路。

- `(R e)` 删除之前添加的第 $e$ 条道路（$e = 1$ 是添加的第一条道路）。

一个农场 $x$ 如果正在活跃地生产牛奶，或者可以通过一系列道路到达另一个活跃的农场，则称之为一个「有关的」农场。对于每个农场 $x$，计算最大的 $i$（$0\le i\le Q$），使得农场 $x$ 在第 $i$ 次更新后是有关的。
## 输入格式

输入的第一行包含 $N$ 和 $Q$。以下 $Q$ 行每行包含如下格式之一的一次更新操作：

```
D x
A x y
R e
```

输入保证对于 R 类更新，$e$ 不超过已经添加的道路的数量，并且没有两次 R 类更新具有相等的 $e$ 值。
## 输出格式

输出 $N$ 行，每行包含一个 $0\ldots Q$ 范围内的整数。
## 样例

### 样例输入 #1
```
5 9
A 1 2
A 2 3
D 1
D 3
A 2 4
D 2
R 2
R 1
R 3
```
### 样例输出 #1
```
7
8
6
9
9
```
## 提示

【样例解释】

在这个例子中，道路以顺序 $(2,3), (1,2), (2,4)$ 被删除。

- 农场 $1$ 在道路 $(1,2)$ 被删除之前是有关的。

- 农场 $2$ 在道路 $(2,4)$ 被删除之前是有关的。

- 农场 $3$ 在道路 $(2,3)$ 被删除之前是有关的。

- 农场 $4$ 和 $5$ 在所有更新结束后仍然是活跃的。所以它们一直保持为有关的，两者的输出均应为 $Q$。

【数据范围】

- 测试点 2-5 满足 $N\le 10^3$，$Q\le 2\cdot 10^3$。

- 测试点 6-20 没有额外限制。



---

---
title: "[USACO22FEB] Redistributing Gifts S"
layout: "post"
diff: 普及+/提高
pid: P8186
tag: ['图论', 'USACO', '2022', '图论建模', 'bitset', 'Floyd 算法']
---
# [USACO22FEB] Redistributing Gifts S
## 题目描述

Farmer John has $N$ gifts labeled $1\cdots N$ for his $N$ cows, also labeled $1\cdots N$ $(1\le N\le 500)$. Each cow has a wishlist, which is a permutation of all $N$ gifts such that the cow prefers gifts that appear earlier in the list over gifts that appear later in the list.

FJ was lazy and just assigned gift $i$ to cow $i$ for all $i$. Now, the cows have gathered amongst themselves and decided to reassign the gifts such that after reassignment, every cow ends up with the same gift as she did originally, or a gift that she prefers over the one she was originally assigned.

For each $i$ from $1$ to $N$, compute the most preferred gift cow $i$ could hope to receive after reassignment.
## 输入格式

The first line contains $N$. The next $N$ lines each contain the preference list of a cow. It is guaranteed that each line forms a permutation of $1\cdots N$.
## 输出格式

Please output $N$ lines, the $i$-th of which contains the most preferred gift cow $i$ could hope to receive after reassignment.
## 样例

### 样例输入 #1
```
4
1 2 3 4
1 3 2 4
1 2 3 4
1 2 3 4
```
### 样例输出 #1
```
1
3
2
4

```
## 提示

【样例解释】

In this example, there are two possible reassignments:

- The original assignment: cow 1 receives gift 1, cow 2 receives gift 2, cow 3 receives gift 3, and cow 4 receives gift 4.
- Cow 1 receives gift 1, cow 2 receives gift 3, cow 3 receives gift 2, and cow 4 receives gift 4.
Observe that both cows 1 and 4 cannot hope to receive better gifts than they were originally assigned. However, both cows 2 and 3 can.

【数据范围】

- Test cases 2-3 satisfy $N\le 8$.

- Test cases 4-11 satisfy no additional constraints.
## 题目翻译

# 题目描述
FJ 有 $N$ 个礼物给他的 $N$ 头奶牛，这 $N$ 个礼物和 $N$ 头奶牛都被标记为 $1 \dotsm N (1 \le N \le 500)$ 。 每头奶牛都有一个愿望单，记录着一个含有 $N$ 个礼物的排列。比起在愿望单中出现更晚的礼物，奶牛更喜欢先出现在愿望单中的礼物。

因为 FJ 太懒了，他直接把 $i$ 号礼物分配给了 $i$ 号奶牛。现在，奶牛们聚在了一起，决定重新分配礼物，以便在重新分配后，每头奶牛都能得到跟原来一样，或是它更喜欢的礼物。

对于每个 $i$ （$i$ 从 $1$ 到 $N$），计算出重新分配后， $i$ 号奶牛可能拿到的最好的礼物（这个奶牛经过重新分配后能拿到的最喜欢的礼物）。

# 输入格式
第一行输入 $N$ 。之后 $N$ 行每行包含一个奶牛的愿望单。保证这 $N$ 行都是 $1 \dotsm N$ 的排列

# 输出格式
输出 $N$ 行，第 $i$ 行输出重新分配后 $i$ 号奶牛可能得到的最好礼物。

# 样例解释
在这个例子中，有两种可能的分配方案
- 最初的方案：一号奶牛得到一号礼物，二号奶牛得到二号礼物，三号奶牛得到三号礼物，四号奶牛得到四号礼物
- 重新分配后的方案：一号奶牛得到一号礼物，二号奶牛得到三号礼物，三号奶牛得到二号礼物，四号奶牛得到四号礼物。可以发现一号和四号奶牛都拿不到比FJ分配的更好的礼物。不过二号和三号都可以。

# 数据范围
- $2 \sim 3$ 号测试点满足 $N \le 8$
- $4 \sim 11$ 号测试点没有别的限制

由 [tzyt](https://www.luogu.com.cn/user/394488) 翻译


---

---
title: "[USACO22FEB] Email Filing S"
layout: "post"
diff: 普及+/提高
pid: P8188
tag: ['模拟', '贪心', '线性数据结构', 'USACO', '2022']
---
# [USACO22FEB] Email Filing S
## 题目描述

Farmer John has fallen behind on organizing his inbox. The way his screen is organized, there is a vertical list of folders on the left side of the screen and a vertical list of emails on the right side of the screen. There are $M$ total folders, numbered $1 \ldots M$ $(1 \le M \le 10^4)$. His inbox currently contains $N$ emails numbered $1\ldots N$ $(1 \le N \le 10^5)$; the $i$th email needs to be filed into folder $f_i$ $(1\le f_i\le M)$. 

FJ's screen is rather small, so he can only view $K$ $(1\le K\le \min(N,M))$ folders and $K$ emails at once.  Initially, his screen starts out displaying folders
$1 \ldots K$ on the left and emails $1 \ldots K$ on the right. To access other folders and emails, he needs to scroll through these respective lists. For example, if he scrolls down one position in the list of folders, his screen will display folders $2 \ldots K+1$, and then scrolling down one position further it will display folders $3 \ldots K+2$.  When FJ drags an email into a folder, the email disappears from the email list, and the emails after the one that disappeared shift up by one position.  For example, if emails $1, 2, 3, 4, 5$ are currently displayed and FJ drags email 3 into its appropriate folder, the email list will now show emails $1, 2, 4, 5, 6$. FJ can only drag an email into the folder to which it needs to be filled.

Unfortunately, the scroll wheel on FJ's mouse is broken, and he can only scroll downwards, not upwards.  The only way he can achieve some semblance of upward scrolling is if he is viewing the last set of $K$ emails in his email list, and
he files one of these.  In this case, the email list will again show the last $K$ emails that haven't yet been filed, effectively scrolling the top email up by one. If there are fewer than $K$ emails remaining, then all of them will be
displayed. 

Please help FJ determine if it is possible to file all of his emails.
## 输入格式

The first line of input contains $T$ $(1≤T≤10)$, the number of subcases in this input, all of which must be solved correctly to solve the input case. The $T$ subcases then follow. For each subcase, the first line of input contains $M,N$ and $K$. The next line contains $f_1\cdots f_N$.

It is guaranteed that the sum of $M$ over all subcases does not exceed $10^4$, and that the sum of $N$ over all subcases does not exceed $10^5$.
## 输出格式

Output $T$ lines, each one either containing either YES or NO, specifying whether FJ can successfully file all his emails in each of the $T$ subcases.
## 样例

### 样例输入 #1
```
6
5 5 1
1 2 3 4 5
5 5 1
1 2 3 5 4
5 5 1
1 2 4 5 3
5 5 2
1 2 4 5 3
3 10 2
1 3 2 1 3 2 1 3 2 1
3 10 1
1 3 2 1 3 2 1 3 2 1
```
### 样例输出 #1
```
YES
YES
NO
YES
YES
NO
```
## 提示

【数据范围】

- In inputs 2-10, the sum of $M$ over all subcases does not exceed $10^3$.
- In inputs 11-12, no additional constraints.
## 题目翻译

### 题目描述

Farmer John 在整理他的收件箱时落后了。他的屏幕布局如下：屏幕左侧是文件夹的垂直列表，右侧是邮件的垂直列表。总共有 $M$ 个文件夹，编号为 $1 \ldots M$（$1 \leq M \leq 10^4$）。他的收件箱目前包含 $N$ 封邮件，编号为 $1 \ldots N$（$1 \leq N \leq 10^5$）；第 $i$ 封邮件需要归档到文件夹 $f_i$（$1 \leq f_i \leq M$）。

FJ 的屏幕很小，因此他一次只能查看 $K$ 个文件夹和 $K$ 封邮件（$1 \leq K \leq \min(N, M)$）。初始时，他的屏幕显示左侧的文件夹 $1 \ldots K$ 和右侧的邮件 $1 \ldots K$。为了访问其他文件夹和邮件，他需要滚动这些列表。例如，如果他在文件夹列表中向下滚动一个位置，屏幕将显示文件夹 $2 \ldots K+1$，再向下滚动一个位置则显示文件夹 $3 \ldots K+2$。当 FJ 将一封邮件拖入文件夹时，该邮件会从邮件列表中消失，其后的邮件会向前移动一个位置。例如，如果当前显示的邮件是 $1, 2, 3, 4, 5$，而 FJ 将邮件 $3$ 拖入其对应的文件夹，邮件列表将显示 $1, 2, 4, 5, 6$。FJ 只能将邮件拖入其需要归档的文件夹。

不幸的是，FJ 的鼠标滚轮坏了，他只能向下滚动，不能向上滚动。唯一能实现类似向上滚动的效果是，当他查看邮件列表的最后 $K$ 封邮件时，如果他归档了其中一封邮件，邮件列表将再次显示尚未归档的最后 $K$ 封邮件，从而将最上面的邮件向上滚动一个位置。如果剩余的邮件少于 $K$ 封，则显示所有剩余的邮件。

请帮助 FJ 判断是否能够归档所有邮件。

### 输入格式

输入的第一行包含 $T$（$1 \leq T \leq 10$），表示输入中的子用例数量，所有子用例都必须正确解决才能解决整个输入用例。接下来的 $T$ 行是每个子用例的输入。对于每个子用例，第一行包含 $M$、$N$ 和 $K$。第二行包含 $f_1 \cdots f_N$。

保证所有子用例的 $M$ 之和不超过 $10^4$，所有子用例的 $N$ 之和不超过 $10^5$。

### 输出格式

输出 $T$ 行，每行包含 `YES` 或 `NO`，表示 FJ 是否能够成功归档所有邮件。

### 数据范围

- 在输入 2-10 中，所有子用例的 $M$ 之和不超过 $10^3$。
- 在输入 11-12 中，没有额外限制。


---

---
title: "[USACO22FEB] Moo Network G"
layout: "post"
diff: 普及+/提高
pid: P8191
tag: ['贪心', 'USACO', '2022', '生成树']
---
# [USACO22FEB] Moo Network G
## 题目描述

Farmer John's $N$ cows $(1≤N≤10^5)$ are spread far apart on his farm and would like to build a communication network so they can more easily exchange electronic text messages (all of which of course contain variations of "moo").

The ith cow is located at a distinct location $(x_i,y_i)$ where $0≤x_i≤10^6$ and $0≤y_i≤10$. The cost of building a communication link between cows $i$ and $j$ is the squared distance between them: $(x_i-x_j)^2+(y_i-y_j)^2$.

Please calculate the minimum cost required to build a communication network across which all the cows can communicate. Two cows can communicate if they are directly connected by a link, or if there is a sequence of links along which their message can travel.

**Note: the time limit for this problem is 4s, twice the default.**
## 输入格式

The first line of input contains $N$, and the next $N$ lines each describe the $x$ and $y$ coordinates of a cow, all integers.
## 输出格式

Please output the minimum cost of a network that will allow all cows to communicate. Note that this cost might be too large to fit into a 32-bit integer and may require use of 64-bit integers (e.g., "long long" integers in C++).
## 样例

### 样例输入 #1
```
10
83 10
77 2
93 4
86 6
49 1
62 7
90 3
63 4
40 10
72 0
```
### 样例输出 #1
```
660
```
## 提示

【数据范围】

- Test cases 2-3 satisfy $N≤1000$.
- Test cases 4-15 satisfy no additional constraints.
## 题目翻译

## 题目描述


农夫约翰有 $N$ 头牛（$1\le N\le10^5$） 它们在农场里分布的极其的远，因此希望你建立一个通讯网络，便于它们更容易地交换电子短信（当然，这些短信都包含 `moo` 的变形体，即数字）

第 $i$ 头牛位于位置 $(x_i，y_i)$ 其中 $0\le x\le 10^6$, $0\le y\le 10$. 在牛 $i$ 与牛 $j$ 之间建立通信链路的成本是它们之间的欧几里德距离的平方，即 $(x_i-x_j)^2+(y_i-y_j)^2$


请聪明的你构建一个所有奶牛都能交流的最低成本的通信网络。如果两头奶牛通过一条链接直接连接或者它们的信息可以沿着一条链接传播，那么认为他们可以通信。

#### 注意 此问题时间限制为4秒

## 输入格式
第一行输入为 $N$，接下来 $N$ 行分别描述奶牛的位置 $(x,y)$ 均为整数
## 输出格式
请输出允许所有奶牛通信的网络的最低成本。请注意，此开销可能太大，无法放入 32 位整数中，并且可能需要使用 64 位整数（例如，C++中的“long long”）。

### 说明/提示 

测试点 2~3 满足 $N\le1000$。

测试点 4~15 没有特殊限制。


---

---
title: "[USACO22OPEN] Photoshoot B"
layout: "post"
diff: 普及+/提高
pid: P8266
tag: ['贪心', 'USACO', '2022']
---
# [USACO22OPEN] Photoshoot B
## 题目描述

迫切希望在郡县集市上赢得最佳奶牛摄影师的 Farmer John 正在尝试为他的 $N$ 头奶牛拍摄一张完美的照片（$2 \leq N \leq 2\cdot 10^5$，$N$ 为偶数）。

Farmer John 拥有两种品种的奶牛：更赛牛（Guernsey）和荷斯坦牛（Holstein）。为了使他的照片尽可能地艺术，他想把他的奶牛排成一排，使得尽可能多的更赛牛处于队列中的偶数位置（队列中的第一个位置是奇数位置，下一个是偶数位置，以此类推）。由于他与他的奶牛缺乏有效的沟通，他可以达到目的的唯一方法是让他的奶牛的偶数长的「前缀」进行反转（一个前缀指的是对于某个位置 $j$，从第一头奶牛到第 $j$ 头奶牛范围内的所有奶牛）。

请计算 Farmer John 达到目的所需要的最小反转次数。

## 输入格式

输入的第一行包含 $N$ 的值。

第二行包含一个长为 $N$ 的字符串，给出初始时所有奶牛从左到右的排列方式。每个 'H' 代表一头荷斯坦牛，每个 'G' 代表一头更赛牛。
## 输出格式

输出一行，包含达到目的所需要的最小反转次数。
## 样例

### 样例输入 #1
```
14
GGGHGHHGHHHGHG
```
### 样例输出 #1
```
1
```
## 提示

【样例解释】

在这个例子中，只需反转由前六头奶牛组成的前缀即可。
```
   GGGHGHHGHHHGHG （反转前）
-> HGHGGGHGHHHGHG （反转后）
```
在反转之前，四头更赛牛处于偶数位置。反转后，六头更赛牛处于偶数位置。不可能使得超过六头更赛牛处于偶数位置。

【测试点性质】

- 测试点 2-6 满足 $N\le 1000$。
- 测试点 7-11 没有额外限制。


---

---
title: "[USACO22OPEN] Visits S"
layout: "post"
diff: 普及+/提高
pid: P8269
tag: ['USACO', '2022', '拓扑排序', '连通块', '强连通分量', '基环树']
---
# [USACO22OPEN] Visits S
## 题目描述

Bessie 的 $N$（$2\le N\le 10^5$）个奶牛伙伴（编号为 $1\cdots N$）每一个都拥有自己的农场。对于每个 $1\le i\le N$，伙伴 i 想要访问伙伴 $a_i$（$a_i\neq i$）。

给定 $1\ldots N$ 的一个排列 $(p_1,p_2,\ldots, p_N)$，访问按以下方式发生。

对于 $1$ 到 $N$ 的每一个 $i$：

- 如果伙伴 $a_{p_i}$ 已经离开了她的农场，则伙伴 $p_i$ 仍然留在她的农场。
- 否则，伙伴 $p_i$ 离开她的农场去访问伙伴 $a_{p_i}$ 的农场。这次访问会产生快乐的哞叫 $v_{p_i}$ 次（$0\le v_{p_i}\le 10^9$）。


对于所有可能的排列 $p$，计算所有访问结束后可能得到的最大哞叫次数。
## 输入格式

输入的第一行包含 $N$。

对于每一个 $1\le i\le N$，第 $i+1$ 行包含两个空格分隔的整数 $a_i$ 和 $v_i$。
## 输出格式

输出一个整数，为所求的答案。

**注意这个问题涉及到的整数可能需要使用 64 位整数型（例如，C/C++ 中的 "long long"）。**
## 样例

### 样例输入 #1
```
4
2 10
3 20
4 30
1 40
```
### 样例输出 #1
```
90
```
## 提示

【样例解释】


如果 $p=(1,4,3,2)$，则

- 伙伴 $1$ 访问伙伴 $2$ 的农场，产生 $10$ 次哞叫。
- 伙伴 $4$ 看到伙伴 $1$ 已经离开了农场，所以无事发生。
- 伙伴 $3$ 访问伙伴 $4$ 的农场，又产生 $30$ 次哞叫。
- 伙伴 $2$ 看到伙伴 $3$ 已经离开了农场，所以无事发生。

这样总计得到了 $10+30=40$ 次哞叫。

另一方面，如果 $p=(2,3,4,1)$，则

- 伙伴 $2$ 访问伙伴 $3$ 的农场，产生 $20$ 次哞叫。
- 伙伴 $3$ 访问伙伴 $4$ 的农场，产生 $30$ 次哞叫。
- 伙伴 $4$ 访问伙伴 $1$ 的农场，产生 $40$ 次哞叫。
- 伙伴 $1$ 看到伙伴 $2$ 已经离开了农场，所以无事发生。

这样总计得到了 $20+30+40=90$ 次哞叫。可以证明这是所有可能的排列 $p$ 中访问结束后得到的最大可能的哞叫次数。


---

---
title: "[USACO22OPEN] COW Operations S"
layout: "post"
diff: 普及+/提高
pid: P8271
tag: ['USACO', '2022', '前缀和']
---
# [USACO22OPEN] COW Operations S
## 题目描述

Bessie 找到了一个长度不超过 $2 \cdot 10^5$ 且仅包含字符 'C'，'O' 和 'W' 的字符串 $s$。她想知道是否可以使用以下操作将该字符串变为单个字母 'C'（她最喜欢的字母）：

1. 选择两个相邻相等的字母并将其删除。

2. 选择一个字母，将其替换为另外两个字母的任一排列。

求出这个字符串本身的答案对 Bessie 而言并不足够，所以她想要知道 $s$ 的 $Q$（$1\le Q\le 2\cdot 10^5$）个子串的答案。

## 输入格式

输入的第一行包含 $s$。

第二行包含 $Q$。

以下 $Q$ 行每行包含两个整数 $l$ 和 $r$（$1\le l\le r\le |s|$，其中 $|s|$ 表示 $s$ 的长度）。

## 输出格式

输出一个长为 $Q$ 的字符串，如果第 $i$ 个子串可以被转变则第 $i$ 个字符为 'Y'，否则为 'N'。
## 样例

### 样例输入 #1
```
COW
6
1 1
1 2
1 3
2 2
2 3
3 3
```
### 样例输出 #1
```
YNNNYN
```
## 提示

【样例解释】

第一个询问的答案是「是」，因为 s 的第一个字符已经等于 'C'。

第五个询问的答案是「是」，因为 s 的第二到第三个字符组成的子串 OW 可以通过两步操作变为 'C'：

```
   OW
-> CWW
-> C
```

这个样例字符串 COW 的其他子串均不能被转变为 'C'。

【测试点性质】

- 测试点 2-4 满足 $|s|\le 5000$ 以及 $Q\le 5000$。
- 测试点 5-11 没有额外限制。


---

---
title: "[USACO22DEC] Barn Tree S"
layout: "post"
diff: 普及+/提高
pid: P8900
tag: ['贪心', 'USACO', '2022', 'Special Judge', '构造']
---
# [USACO22DEC] Barn Tree S
## 题目描述

Farmer John 的农场有 $N$ 个牛棚 $(2 \le N \le 2 \times 10^5)$，编号为 $1 \cdots N$。有 $N−1$ 条道路，每条道路连接两个牛棚，并且从任一牛棚均可通过一些道路到达任一其他牛棚。目前，第 $j$ 个牛棚中有 $h_j$ 个干草捆 $(1 \le h_j \le 10^9)$。 

为使他的奶牛们满意，Farmer John 想移动这些干草，使得每个牛棚都有相同数量的干草捆。他可以选择任何一对由一条道路连接的牛棚，并命令他的农场工人将不超过第一个牛棚中干草捆数量的任意正整数个干草捆从第一个牛棚移动到第二个牛棚。 

请求出一个 Farmer John 可以发出的命令序列，以尽可能少的命令数完成这一任务。输入保证存在符合要求的命令序列。 
## 输入格式

输入的第一行包含整数 $N$。

第二行包含空格分隔的整数 $h_j$，其中 $j=1\cdots N$。

最后 $N−1$ 行每行包含两个空格分隔的牛棚编号 $u_i,v_i$，表示有一条双向道路连接 $u_i$ 和 $v_i$。
## 输出格式

输出命令的最小数量，然后输出该数量的命令序列，每行输出一条命令。

每条命令的格式应为三个空格分隔的正整数：出发牛棚，目标牛棚，以及从出发牛棚移动到目标牛棚的干草捆数量。

如果有多组解，输出任意一组。 
## 样例

### 样例输入 #1
```
4
2 1 4 5
1 2
2 3
2 4
```
### 样例输出 #1
```
3
3 2 1
4 2 2
2 1 1
```
## 提示

### 样例 1 解释

在这个例子中，共有十二个干草捆和四个牛棚，这意味着每个牛棚最后必须有三个干草捆。输出样例中的命令顺序可以用以下的自然语言表述： 

1. 从牛棚 $3$ 到牛棚 $2$，移动 $1$ 个干草捆。
2. 从牛棚 $4$ 到牛棚 $2$，移动 $2$ 个干草捆。
3. 从牛棚 $2$ 到牛棚 $1$，移动 $1$ 个干草捆。

### 测试点性质

- 测试点 $2-8$ 满足 $N \le 5000$。
- 测试点 $7-10$ 满足 $v_i=u_i+1$。
- 测试点 $11-16$ 没有额外限制。


---

---
title: "[USACO22DEC] Circular Barn S"
layout: "post"
diff: 普及+/提高
pid: P8901
tag: ['博弈论', 'USACO', '2022']
---
# [USACO22DEC] Circular Barn S
## 题目描述

Farmer John 和他的死对头 Farmer Nhoj 在一个环形牛棚内玩游戏。牛棚内有 $N(1 \le N \le 10^5)$ 个房间，第 $i$ 个房间初始时内有 $a_i$ 头奶牛 $(1 \le a_i \le 5 \times 10^6)$。游戏玩法如下：

- 两位农夫将总是在同一个房间里。进入一个房间后，每位农夫各执行一次行动，Farmer John 在先。两位农夫在游戏开始时进入房间 $1$。
- 如果当前房间中的奶牛数量为零，则此时执行行动的农夫即失败。否则，执行行动的农夫选择一个整数 $P$，其中 $P$ 为 $1$ 或一个不超过当前房间中奶牛的数量的质数，并从当前房间中移除 $P$ 头奶牛。
- 两位农夫均完成行动之后，两位农夫移动到环形牛棚的下一间房间。也就是说，如果农夫们在房间 $i$，那么他们会移动到房间 $i+1$，除非他们在房间 $N$，在这种情况下他们会移动到房间 $1$。

当两位农夫均采用最优策略时，求获胜的农夫。 
## 输入格式

输入包含 $T$ 个子测试用例。输入的第一行包含 $T(1 \le T \le 1000)$。下面是 $T$ 个子测试用例。

每个子测试用例的第一行包含 $N$，第二行包含 $a_1, \cdots ,a_N$。

输入保证所有 $N$ 之和不超过 $2 \times 10^5$。 
## 输出格式

 对于每一个子测试用例，输出获胜的农夫，为 `Farmer John` 或 `Farmer Nhoj` 之一。
## 样例

### 样例输入 #1
```
5
1
4
1
9
2
2 3
2
7 10
3
4 9 4
```
### 样例输出 #1
```
Farmer Nhoj
Farmer John
Farmer John
Farmer John
Farmer Nhoj
```
## 提示

### 样例 1 解释

对于第一个子测试用例，Farmer John 可以从第一个房间中移除 $1$、$2$ 或 $3$ 头奶牛。无论他移除多少头奶牛，Nhoj 都可以移除剩余的奶牛，迫使 FJ 在他们绕回第一个房间时失败。

对于第二个子测试用例，FJ 可以移除 $5$ 头奶牛，迫使 Nhoj 面对剩下的 $4$ 头奶牛。现在，Nhoj 可以移除 $1$、$2$ 或 $3$ 奶牛。现在的情况类似于第一个子测试用例。

对于第三个和第四个子测试用例，FJ 可以立即移除第一个房间的所有奶牛，使 Nhoj 失败。

对于第五个子测试用例，FJ 可以从第一个房间中移除 $1$
、$2$ 或 $3$ 奶牛，然后 Nhoj 可以随后移除余下的奶牛。当他们绕回第一个房间时，FJ 将会失败。 

### 测试点性质

- 测试点 $2-4$ 满足 $N=1$。
- 测试点 $1,2,5-7$ 满足 $a_i \le 1000$。
- 测试点 $8-20$ 没有额外限制。


---

---
title: "[USACO22DEC] Range Reconstruction S"
layout: "post"
diff: 普及+/提高
pid: P8902
tag: ['USACO', '2022', 'Special Judge', '构造']
---
# [USACO22DEC] Range Reconstruction S
## 题目描述

Bessie 有一个数组 $a_1, \cdots, a_N$，其中 $1 \le N \le 300$ 并对于所有 $i$ 有 $0 \le a_i \le 10^9$。她不会告诉你数组 $a$ 本身，但她会告诉你 $a$ 的每个子数组的全距。也就是说，对于每对索引 $i \le j$，Bessie 告诉你 $r_{i,j}= \max a[i \cdots j]− \min a[i \cdots j]$。给定这些 $r$ 的值，构造一个可以作为 Bessie 的原始数组的数组。你的数组中的数值应在 $[−10^9,10^9]$ 范围内。 
## 输入格式

输入的第一行包含 $N$。

以下 $N$ 行，第 $i$ 行包含整数 $r_{i,i},r_{i,i+1}, \cdots ,r_{i,N}$。

输入保证存在某个数组 $a$，其中的数值在 $[0,10^9]$ 范围内，满足对于所有的 $i \le j$，有 $r_{i,j}= \max a[i \cdots j]−\min a[i\cdots j]$。 
## 输出格式

输出一行，包含 $N$ 个整数 $b_1,b_2, \cdots ,b_N$，在 $[−10^9,10^9]$ 范围内，表示你的数组。这些数需要满足对于所有的 $i \le j$ 有 $r_{i,j}= \max a[i \cdots j]−\min a[i\cdots j]$。 
## 样例

### 样例输入 #1
```
3
0 2 2
0 1
0
```
### 样例输出 #1
```
1 3 2
```
### 样例输入 #2
```
3
0 1 1
0 0
0
```
### 样例输出 #2
```
0 1 1
```
### 样例输入 #3
```
4
0 1 2 2
0 1 1
0 1
0
```
### 样例输出 #3
```
1 2 3 2
```
### 样例输入 #4
```
4
0 1 1 2
0 0 2
0 2
0
```
### 样例输出 #4
```
1 2 2 0
```
## 提示

### 样例 1 解释

例如，$r_{1,3}=\max a[1 \cdots 3]−\min a[1\cdots 3]=3−1=2$。

### 样例 2 解释

这个样例满足子任务 $1$ 的限制。

### 样例 3 解释

这个样例满足子任务 2 的限制。 

### 测试点性质

- 测试点 $5$ 满足 $r_{1,N} \le 1$。
- 测试点 $6-8$ 满足对于所有 $1 \le i<N$ 均有 $r_{i,i+1}=1$。
- 测试点 $9-14$ 没有额外限制。


---

---
title: "[USACO23JAN] Find and Replace S"
layout: "post"
diff: 普及+/提高
pid: P9013
tag: ['USACO', '2023', '图论建模', '基环树']
---
# [USACO23JAN] Find and Replace S
## 题目描述

Bessie is using the latest and greatest innovation in text-editing software, miV! She starts with an input string consisting solely of upper and lowercase English letters and wishes to transform it into some output string. With just one keystroke, miV allows her to replace all occurrences of one English letter $c_1$ in the string with another English letter $c_2$. For example, given the string `aAbBa`, if Bessie selects $c_1$ as `a` and $c_2$ as `B`, the given string transforms into `BAbBB`.

Bessie is a busy cow, so for each of $T
(1 \le T \le 10)$ independent test cases, output the minimum number of keystrokes required to transform her input string into her desired output string. 
## 输入格式

The first line contains $T$, the number of independent test cases.

The following $T$ pairs of lines contain an input and output string of equal length. All characters are upper or lowercase English letters (either `A` through `Z` or `a` through `z`). The sum of the lengths of all strings does not exceed $10^5$. 
## 输出格式

For each test case, output the minimum number of keystrokes required to change the input string into the output string, or $−1$ if it is impossible to do so. 
## 样例

### 样例输入 #1
```
4
abc
abc
BBC
ABC
abc
bbc
ABCD
BACD
```
### 样例输出 #1
```
0
-1
1
3
```
## 提示

### Explanation for Sample 1

The first input string is the same as its output string, so no keystrokes are required.

The second input string cannot be changed into its output string because Bessie cannot change one `B`' to `A` while keeping the other as `B`.

The third input string can be changed into its output string by changing `a` to `b`.

The last input string can be changed into its output string like so: $\texttt{ABCD} \rightarrow \texttt{EBCD} \rightarrow \texttt{EACD} \rightarrow \texttt{BACD}$.

### Scoring

 - Inputs $2-6$: Every string has a length at most $50$.
 - Inputs $7-9$: All strings consist only of lowercase letters `a` through `e`
 - Inputs $10-15$: No additional constraints.
## 题目翻译

### 题目描述

Bessie 正在使用世界上最先进最伟大的文本编辑器：miV！她想将一个仅由大写和小写英文字母组成的字符串转换为一个新的字符串。每一次操作，miV 可以将字符串中所有的字母  $c_1$ 替换成另一种字母 $c_2$。例：对于字符串`aAbBa`, 如果将其中的 `a` 替换成 `B`, 那么字符串会变为`BAbBB`。

Bessie 非常地忙碌, 所以对于给出的 $T
(1 \le T \le 10)$ 组测试数据, 请输出她至少需要多少次操作才能把原字符串转换为新字符串。

### 输入格式

第一行是一个整数 $T$, 表示测试数据的数量。

接下来有 $T$ 对长度相等的字符串。字符串中所有的字符都是大写或小写的字母。字符串的长度不会超过 $10^5$。

### 输出格式

对于每组测试数据，输出转换字符串需要的最小操作数。

如果这不可能做到，输出 $-1$。

### 样例 1 解释

第一组数据：两个字符串相等，所以不需要任何操作。

第二组数据：你不可能在把其中一个 `B` 转换为 `A`的同时保持剩下一个 `B` 不变。

第三组数据：你可以把字符串中所有的 `a` 转换为 `b`。

第四组数据：你可以按 $\texttt{ABCD} \rightarrow \texttt{EBCD} \rightarrow \texttt{EACD} \rightarrow \texttt{BACD}$ 的方式转换。

### 数据范围

 - 对于 $ 40 \% $ 的数据，字符串的长度不超过 $50$。
 - 对于另外 $ 20\% $ 的数据，所有的字符串仅包含从 `a` 到 `e` 的小写字母。
 - 对于 $ 100\% $ 的数据，字符串的长度不超过 $10^5$，$1 \le T \le 10$。


---

---
title: "[USACO23FEB] Bakery S"
layout: "post"
diff: 普及+/提高
pid: P9124
tag: ['数学', '二分', 'USACO', '2023']
---
# [USACO23FEB] Bakery S
## 题目描述

Bessie has opened a bakery!

In her bakery, Bessie has an oven that can produce a cookie in $t_C$
 units of time or a muffin in $t_M$
 units of time $(1\le t_C,t_M\le 10^9)$. Due to space constraints, Bessie can only produce one pastry at a time, so to produce $A$ cookies and $B$ muffins, it takes $A \cdot t_C+B \cdot t_M$ units of time.

Bessie's $N (1\le N\le 100)$ friends would each like to visit the bakery one by one. The $i$-th friend will order $a_i(1 \le a_i \le 10^9)$ cookies and $b_i(1 \le b_i \le 10^9)$ muffins immediately upon entering. Bessie doesn't have space to store pastries, so she only starts making pastries upon receiving an order. Furthermore, Bessie's friends are very busy, so the $i$-th friend is only willing to wait $c_i(a_i+b_i \le c_i \le 2 \cdot 10^{18})$ units of time before getting sad and leaving.

Bessie really does not want her friends to be sad. With one mooney, she can upgrade her oven so that it takes one less unit of time to produce a cookie or one less unit of time to produce a muffin. She can't upgrade her oven a fractional amount of times, but she can choose to upgrade her oven as many times as she needs before her friends arrive, as long as the time needed to produce a cookie and to produce a muffin both remain strictly positive.

For each of $T(1 \le T \le 100)$ test cases, please help Bessie find out the minimum amount of moonies that Bessie must spend so that her bakery can satisfy all of her friends.
## 输入格式

The first line contains $T$, the number of test cases.

Each test case starts with one line containing $N$
, $t_C$, $t_M$. Then, the next $N$ lines each contain three integers $a_i,b_i,c_i$.

Consecutive test cases are separated by newlines. 
## 输出格式

The minimum amount of moonies that Bessie needs to spend for each test case, on separate lines. 
## 样例

### 样例输入 #1
```
2

3 7 9
4 3 18
2 4 19
1 1 6

5 7 3
5 9 45
5 2 31
6 4 28
4 1 8
5 2 22
```
### 样例输出 #1
```
11
6
```
## 提示

### Explanation for Sample 1

In the first test case, Bessie can pay $11$ moonies to decrease the time required to produce a cookie by $4$ and a muffin by $7$, so that her oven produces cookies in $3$ units of time and muffins in $2$ units of time. Then she can satisfy the first friend in $18$ units of time, the second friend in $14$ units of time, and the third friend in $5$ units of time, so none of them will get sad and leave.

In the second test case, Bessie should decrease the time required to produce a cookie by $6$ and a muffin by $0$. 

### SCORING

 - Inputs $2-4$: $N \le 10,t_C,t_M \le 1000$
 - Inputs $5-11$: No additional constraints.
## 题目翻译

### 题目描述

Bessie 开了一家面包店!

在她的面包店里，Bessie 有一个烤箱，可以在 $t_C$ 的时间内生产一块饼干或在 $t_M$ 单位时间内生产一块松糕。
$(1 \le t_C,t_M \le 10^9)$。由于空间限制，Bessie 一次只能生产一种糕点，所以要生产 $A$ 块饼干和 $B$ 块松饼，需要 $A\cdot t_C+B\cdot t_M$ 单位的时间。

Bessie的 $N (1\le N\le 100)$ 朋友都想一个一个地去面包店。第 $i$ 个朋友一进门就会点 $a_i(1 \le a_i \le 10^9)$ 块饼干和 $b_i(1 \le b_i \le 10^9)$ 块松饼。Bessie 没有空间来储存糕点，所以她只有在接到订单后才开始制作糕点。此外，Bessie 的朋友都很忙，所以第 $i$ 个朋友只愿意等 $c_i(a_i+b_i \le c_i \le 2 \cdot 10^{18})$ 个单位的时间，然后就伤心地离开。

Bessie 真的不希望她的朋友们伤心，她可以用一块钱升级她的烤箱，让它少花一个单位的时间来生产一块饼干或少花一个单位的时间来生产一个松饼。她不能将她的烤箱升级到花费小于等于 $0$ 的时间，但她可以选择在她的朋友到来之前将她的烤箱升级多少次，只要生产一块饼干和生产一个松饼所需的时间都严格保持为正数。

对于每一个 $T(1\le T\le 100)$ 的测试案例，请帮助 Bessie 找出她必须花费的最小的钱数量，以便她的面包店能够满足所有的朋友。

### 输入格式

第一行包含 $T$，测试案例的数量。

每个测试用例都以一行开始，包含 $N$
,$t_C$,$t_M$。然后，接下来的 $N$ 行各包含三个整数 $a_i,b_i,c_i$。

测试案例用换行符隔开。

### 输出格式

Bessie 需要为每个测试案例花费的最少钱数，每行一个。

### 样例解释 1

在第一个测试案例中，贝西可以支付 $11$ 元来减少 $4$ 单位生产一块饼干所需的 时间和 $7$ 单位生产一块松饼所需的时间，从而使她的烤箱在 $3$ 单位的时间内生产饼干，在 $2$ 单位的时间内生产松饼。那么她可以在 $18$ 单位的时间内满足第一个朋友，在 $14$ 单位的时间内满足第二个朋友，在 $5$ 单位的时间内满足第三个朋友，所以他们都不会伤心而离开。

在第二个测试案例中，贝西应该把生产一块饼干的时间减少 $6$ 单位，把生产一块松饼的时间减少 $0$ 单位。

### 数据规模与约定

 - 输入 $2-4$：$N\le 10,t_C,t_M \le 1000$
 - 输入 $5-11$，没有额外的约束。
 
翻译 @ \_\_11jiang08\_\_


---

---
title: "[USACO23FEB] Moo Route II S"
layout: "post"
diff: 普及+/提高
pid: P9126
tag: ['图论', 'USACO', '2023', '图论建模', '最短路']
---
# [USACO23FEB] Moo Route II S
## 题目描述

**Note: The time limit for this problem is 4s, twice the default.**

Bessie is on vacation! Due to some recent technological advances, Bessie will travel via technologically sophisticated flights, which can even time travel. Furthermore, there are no issues if two "parallel" versions of Bessie ever meet.

In the country there are $N$ airports numbered $1,2,\cdots ,N$ and $M$ time-traveling flights $(1 \le N,M \le 200000)$. Flight $j$ leaves airport $c_j$ at time $r_j$, and arrives in airport $d_j$ at time $s_j (0 \le rj,sj \le 10^9$, $s_j<r_j$ is possible$)$. In addition, she must leave $a_i$ time for a layover at airport $i (1 \le a_i \le 10^9)$. (That is to say, if Bessie takes a flight arriving in airport $i$ at time $s$, she can then transfer to a flight leaving the airport at time $r$ if $r \ge s+a_i$. The layovers do not affect when Bessie arrives at an airport.)

Bessie starts at city $1$ at time $0$. For each airport from $1$ to $N$, what is the earliest time when Bessie can get to at it? 
## 输入格式

The first line of input contains $N$ and $M$.

The next $M$ lines describe flights. The $j$-th of these lines contains $c_j, r_j, d_j, s_j$ in that order. $(1 \le c_j,d_j \le N, 0 \le r_j,s_j \le 10^9)$

The next line describes airports. It contains $N$
space separated integers, $a_1, \cdots ,a_N$. 
## 输出格式

There are $N$ lines of output. Line $i$ contains the earliest time when Bessie can get to airport $i$, or $-1$ if it is not possible for Bessie to get to that airport. 
## 样例

### 样例输入 #1
```
3 3
1 0 2 10
2 11 2 0
2 1 3 20
10 1 10
```
### 样例输出 #1
```
0
0
20
```
### 样例输入 #2
```
3 3
1 0 2 10
2 10 2 0
2 1 3 20
10 1 10
```
### 样例输出 #2
```
0
10
-1
```
## 提示

### Explanation for Sample 1

Bessie can take the $3$ flights in the listed order, which allows her to arrive at airports $1$ and $2$ at time $0$, and airport $3$ at time $20$.

Note that this route passes through airport $2$ twice, first from time $10-11$ and then from time $0-1$.

### Explanation for Sample 2

In this case, Bessie can take flight $1$, arriving at airport $2$ at time $10$. However, she does not arrive in time to also take flight $2$, since the departure time is $10$ and she cannot make a $1$ time-unit layover. 

### SCORING

 - Inputs $3-5$: $r_j<s_j$ for all $j$, i.e. all flights arrive after they depart.
 - Inputs $6-10$: $N,M \le 5000$
 - Inputs $11-20$: No additional constraints.
## 题目翻译

### 题目描述

注意：本题的时间限制为 4 秒，是默认限制的两倍。

Bessie 正在度假！由于最近的技术进步，Bessie 可以通过先进的航班旅行，这些航班甚至可以进行时间旅行。此外，即使存在多个“平行”的 Bessie 同时出现也不会有任何问题。

在这个国家，有 $N$ 个机场，编号为 $1,2,\cdots,N$，以及 $M$ 条时间旅行航班（$1 \leq N,M \leq 200000$）。第 $j$ 条航班从机场 $c_j$ 在时间 $r_j$ 起飞，并在时间 $s_j$ 抵达机场 $d_j$（$0 \leq r_j,s_j \leq 10^9$，$s_j < r_j$ 是可能的）。此外，Bessie 在机场 $i$ 需要停留 $a_i$ 时间（$1 \leq a_i \leq 10^9$）。也就是说，如果 Bessie 乘坐一趟航班在时间 $s$ 抵达机场 $i$，她可以转乘一趟从该机场出发的航班，只要该航班的起飞时间 $r \geq s + a_i$。需要注意的是，停留时间不会影响 Bessie 抵达某机场的实际时间。

Bessie 从城市 $1$ 出发，起始时间为 $0$。对于从 $1$ 到 $N$ 的每个机场，求出 Bessie 最早可以到达该机场的时间。

### 输入格式

第一行输入包含两个整数 $N$ 和 $M$。

接下来的 $M$ 行描述航班信息。其中第 $j$ 行包含 $c_j, r_j, d_j, s_j$，依次表示航班的起飞机场、起飞时间、降落机场和降落时间。$(1 \leq c_j,d_j \leq N, 0 \leq r_j,s_j \leq 10^9)$

接下来的 $1$ 行描述每个机场的停留时间。该行包含 $N$ 个用空格分隔的整数，分别为 $a_1,\cdots,a_N$。

### 输出格式

输出共 $N$ 行。第 $i$ 行输出 Bessie 最早到达机场 $i$ 的时间；如果无法到达该机场，输出 $-1$。

### 样例 1 的解释

Bessie 可以按照给定的顺序乘坐第 $3$ 班航班，这使她可以在时间 $0$ 到达机场 $1$ 和机场 $2$，以及在时间 $20$ 到达机场 $3$。


注意，这条路线会两次经过机场 $2$，第一次是在时间 $10-11$，第二次是在时间 $0-1$。

### 样例 2 的解释

在这个例子中，Bessie 可以乘坐第 $1$ 班航班，在时间 $10$ 抵达机场 $2$。但是，她无法及时赶上第 $2$ 班航班，因为该航班的起飞时间为 $10$，而她需要至少 $1$ 个时间单位来完成停留。

### 评分标准

 - 测试点 $3-5$：对于每个 $j$，$r_j < s_j$，也就是说所有航班的到达时间晚于起飞时间。
 - 测试点 $6-10$：$N,M \leq 5000$
 - 测试点 $11-20$：无额外限制。


---

---
title: "[USACO23FEB] Equal Sum Subarrays G"
layout: "post"
diff: 普及+/提高
pid: P9127
tag: ['USACO', '2023', '排序', '线性递推']
---
# [USACO23FEB] Equal Sum Subarrays G
## 题目描述

**Note: The time limit for this problem is 3s, 1.5x the default.** 

FJ gave Bessie an array $a$ of length $N(2 \le N \le 500,−10^{15} \le a_i \le 10^{15})$ with all $\dfrac{N(N+1)}{2}$ contiguous subarray sums distinct. For each index $i \in [1,N]$, help Bessie compute the minimum amount it suffices to change ai by so that there are two different contiguous subarrays of a with equal sum. 
## 输入格式

The first line contains $N$.

The next line contains $a_1, \cdots ,a_N$
(the elements of $a$, in order). 
## 输出格式

One line for each index $i \in [1,N]$. 
## 样例

### 样例输入 #1
```
2
2 -3
```
### 样例输出 #1
```
2
3
```
### 样例输入 #2
```
3
3 -10 4
```
### 样例输出 #2
```
1
6
1
```
## 提示

### Explanation for Sample 1

Decreasing $a_1$ by $2$ would result in $a_1+a_2=a_2$. Similarly, increasing $a_2$ by $3$ would result in $a_1+a_2=a_1$. 

### Explanation for Sample 2

Increasing a1 or decreasing $a_3$ by $1$ would result in $a_1=a_3$. Increasing $a_2$ by $6$ would result in $a_1=a_1+a_2+a_3$. 

### SCORING

 - Input $3$: $N \le 40$
 - Input $4$: $N \le 80$
 - Inputs $5-7$: $N \le 200$
 - Inputs 8-16: No additional constraints.
## 题目翻译

### 题目描述

注意：本题的时间限制为 3 秒，为默认时间的 1.5 倍。

FJ 给了 Bessie 一个长度为 $N$ 的数组 $a$（$2 \leq N \leq 500, -10^{15} \leq a_i \leq 10^{15}$），其中所有 $\dfrac{N(N+1)}{2}$ 个连续子数组的和都是不同的。对于每个下标 $i \in [1,N]$，帮助 Bessie 计算最小的改变量，使得数组中存在两个不同的连续子数组的和相等。

### 输入格式

第一行包含一个整数 $N$，表示数组的长度。

第二行包含 $a_1,\cdots,a_N$，即数组 $a$ 的元素，按顺序给出。

### 输出格式

对于每个下标 $i \in [1,N]$，输出一行一个整数，表示改变 $a_i$ 的最小改变量。

### 样例 1 的解释

将 $a_1$ 减少 $2$，可以使得 $a_1+a_2=a_2$。类似地，将 $a_2$ 增加 $3$，可以使得 $a_1+a_2=a_1$。

### 样例 2 的解释

将 $a_1$ 增加 $1$ 或将 $a_3$ 减少 $1$，可以使得 $a_1=a_3$。将 $a_2$ 增加 $6$，可以使得 $a_1=a_1+a_2+a_3$。

### 评分标准

- 测试点 $3$：$N \leq 40$
- 测试点 $4$：$N \leq 80$
- 测试点 $5-7$：$N \leq 200$
- 测试点 $8-16$：无额外限制。


---

---
title: "[USACO23OPEN] FEB B"
layout: "post"
diff: 普及+/提高
pid: P9183
tag: ['数学', '贪心', 'USACO', '2023', '分类讨论']
---
# [USACO23OPEN] FEB B
## 题目描述

Bessie and Elsie are plotting to overthrow Farmer John at last! They plan it out
over $N$ text messages. Their conversation can be
represented by a string $S$ of length $N$ where $S_i$ is either `B` or `E`,
meaning the $i$ th message was sent by Bessie or Elsie, respectively. 

However, Farmer John hears of the plan and attempts to intercept their
conversation. Thus, some letters of $S$ are `F`, meaning Farmer John obfuscated
the message and the sender is unknown.

The  **excitement level** of a non-obfuscated conversation is the number of
times a cow double-sends - that is, the number of occurrences of substring `BB`
or `EE` in $S$. You want to find the excitement level of the original message,
but you don’t know which of Farmer John’s messages were actually Bessie’s
/ Elsie’s. Over all possibilities, output all possible excitement levels of
$S$.
## 输入格式

The first line will consist of one integer $N$.

The next line contains $S$.
## 输出格式

First output $K$, the number of distinct excitement levels possible. On the next
$K$ lines, output the excitement levels, in increasing order.
## 样例

### 样例输入 #1
```
4
BEEF

```
### 样例输出 #1
```
2
1
2

```
### 样例输入 #2
```
9
FEBFEBFEB

```
### 样例输出 #2
```
2
2
3
```
### 样例输入 #3
```
10
BFFFFFEBFE
```
### 样例输出 #3
```
3
2
4
6
```
## 提示

$1\le N\le 2\cdot 10^5$.

- Inputs 4-8: $N\le 10$.
- Inputs 9-20: No additional constraints.
## 题目翻译

### 题目描述
贝西和埃尔希正在密谋最终推翻他们的主人——农夫约翰！他们通过 $N$ 条短信进行计划。他们的对话可以用一个长度为 $N$ 的字符串 $S$ 来表示。     
其中 $S_i$ 是字母 ```B``` 或 ```E```，这意味着第 $i$ 条消息分别由贝西或埃尔希发送的。


然而，农夫约翰听说了这个消息，并试图拦截他们的谈话。因此，字符串 $S$ 的一些字母是 ```F```，这意味着农夫约翰混淆了信息，发件人未知（贝西、埃尔希都有可能）。   
**注：约翰没有发送信息！他只是在干扰奶牛间的通话！**


未混淆对话的兴奋程度是**一只奶牛重复发送信息的次数**。也就是说，子串 ```BB``` 或 ```EE``` 在 $S$ 中出现的次数。你想找到原始信息的兴奋程度，但你不知道约翰的信息中哪一条实际上是贝西或埃尔希的。在所有可能的情况下，**从小到大输出**所有可能的兴奋程度。



### 输入格式
第一行：一个整数 $N$（通话长度）。       
第二行：一个字符串 $S$（通话内容）。


### 输出格式
第一行：输出一个整数 $K$，为**不同**兴奋程度的可能数量。   
随后 $K$ 行：每行一个整数，为每种兴奋程度。**注意按照从小到大的顺序输出。**


### 数据范围
$1 \le N \le 2 \times 10^5$。
- 测试点 4~8：$N \le 10$
- 测试点 9~20：无额外限制。


---

---
title: "[USACO23OPEN] Moo Language B"
layout: "post"
diff: 普及+/提高
pid: P9184
tag: ['模拟', '字符串', '贪心', 'USACO', '2023', 'Special Judge']
---
# [USACO23OPEN] Moo Language B
## 题目背景

Farmer John is interested in better interacting with his fellow cows, so he
decided he will learn the moo language!
## 题目描述

Moo language is actually quite similar to English, but more minimalistic. There
are only four types of words: nouns, transitive verbs, intransitive verbs, and
conjunctions. Every two consecutive words must be separated by a space.  There
are also only two types of punctuation: periods and commas.  When a period or
comma appears after a word, it appears directly after the word, and is then
followed  by a space if another word appears next.

A sentence needs to follow one of the following formats:
- Type 1: noun + intransitive verb.
- Type 2: noun + transitive verb + noun(s). Specifically, at least one noun
must follow the transitive verb, and there must be a comma in front of every 
following noun besides the first following noun.

Two sentences may be joined into a compound sentence if a conjunction is placed
in between them.  The resulting compound sentence cannot be further joined with
other sentences or other compound sentences.  Every sentence (or compound
sentence, if two sentences are joined) must end with a period.

Farmer John has a word bank of $N$ words, $C$ commas, and $P$ periods. He may only use a word or punctuation mark as
many times as it appears in the word bank. Help him output a sequence of
sentences containing the maximum possible number of words.

Each input file contains $T$ independent instances of this
problem.

## 输入格式

The first line contains $T$, the number of instances. Each instance is specified
as follows:

The first line consists of three integers $N, C$ and $P$.

The $N$ following lines will consist of two strings. The first string will be
the word itself that FJ can use (a string of at least $1$ and at most $10$ lowercase
letters), and the second string will be either one of the following: noun,
transitive-verb, intransitive-verb, or conjunction, denoting the type of the
word. It is possible the same word occurs more than once in FJ's word bank, but
it will always have the same type each time it appears.
## 输出格式

In the first line, output the maximum possible number of words.

In the second line, output any sequence of sentences with the maximum possible
number of words. Any valid sequence will be accepted.

**The grader is sensitive to whitespace, so make sure not to output any
extraneous spaces, particularly at the end of each line.**
## 样例

### 样例输入 #1
```
3
1 1 1
bessie noun
10 5 4
bessie noun
taught transitive-verb
flew intransitive-verb
elsie noun
farmer noun
john noun
and conjunction
and conjunction
nhoj noun
mooed intransitive-verb
24 5 4
but conjunction
bessie noun
taught transitive-verb
flew intransitive-verb
elsie noun
farmer noun
john noun
and conjunction
and conjunction
nhoj noun
mooed intransitive-verb
bob noun
impressed transitive-verb
cow noun
impressed transitive-verb
leaped intransitive-verb
elsie noun
bella noun
buttercup noun
pushed transitive-verb
mooed intransitive-verb
envy noun
john noun
nhoj noun

```
### 样例输出 #1
```
0

9
nhoj mooed. farmer taught elsie, bessie and john flew.
23
nhoj mooed. nhoj impressed john, farmer, elsie, bessie and cow impressed bob. bella pushed elsie and buttercup flew. envy mooed but john leaped.
```
## 提示

$1\le T\le 100$，$1 \leq P,C\le N \leq 10^3$.

- Inputs 2-6: $N\le 10$.
- Inputs 7-11: $N\le 100$.
- Inputs 12-16: $N\le 1000$.
- Inputs with remainder 2 when divided by 5: There are no transitive
verbs.
- Inputs with remainder 3 when divided by 5: There are no intransitive
verbs.
- Inputs with remainder 4 when divided by 5: There are no conjunctions.
## 题目翻译

### 题目背景

FJ 对与奶牛更好地互动感兴趣，所以他决定学习 moo 语言！

### 题目描述

moo 语言与英语相似，但更为简单。单词只有四种类型：名词、及物动词、不及物动词和连词，每两个单词之间必须用空格隔开。标点符号仅包含逗号和句号，它会跟在单词后面，若该标点符号后面存在单词，则需要隔一个空格再放单词。

对于每个句子，都需要遵循以下格式中的一条：

1. 名词+不及物动词。
2. 名词+及物动词+名词（可以有多个）。及物动词后面必须有至少一个名词。除及物动词后面的第一个名词外，后面的每个名词前面都必须加一个逗号。

也可以在两个句子之间加一个连词，形成复合句，复合句不能与其他句子用连词连接。每一个句子（包括复合句）都必须以句号结尾。

FJ 的词库中有 $N$ 个单词、$C$ 个逗号和 $P$ 个句号。每个单词的使用次数不能超过这个单词在词库中出现的次数。现在，你要帮他输出几个符合以上要求的句子，使总单词数尽量多。

每个输入文件中共包含 $T$ 组样例。

### 输入格式

第一行输入 $T$，表示样例组数。对于每组样例，格式如下：

第一行输入三个正整数 $N$、$C$ 和 $P$。

在接下来的 $N$ 行，每行输入两个字符串。第一个字符串输入一个 FJ 可以用的单词（全为小写字母，长度为 $1$ 至 $10$），第二个字符串为以下字符串中的任意一个，表示该单词的类型：

- `noun`（名词）；
- `transitive-verb`（及物动词）；
- `intransitive-verb`（不及物动词）；
- `conjunction`（连词）。

同一个单词可能在词库中出现多次，但是每次出现时它们的类型都相同。

### 输出格式

第一行输出组成符合以上要求的句子序列的最大单词数。

在第二行中，输出句子序列，使单词数最多。本题开启 SPJ，任何符合以上要求的句子序列均可通过。

**请不要输出多余的空格，尤其是在每行末尾。**

### 数据范围

$1 \leq T \leq 100$，$1 \leq P, C \leq N \leq 10^3$。

- 输入 2-6：$N \leq 10$。
- 输入 7-11：$N \leq 100$。
- 输入 12-16：$N \leq 1000$。
- 输入编号除以 5 余 2 的测试点：没有及物动词。
- 输入编号除以 5 余 3 的测试点：没有不及物动词。
- 输入编号除以 5 余 4 的测试点：没有连词。

translated by [liyuanchen2021](https://www.luogu.com.cn/user/557680)


---

---
title: "[USACO23OPEN] Rotate and Shift B"
layout: "post"
diff: 普及+/提高
pid: P9185
tag: ['模拟', '数学', 'USACO', '2023']
---
# [USACO23OPEN] Rotate and Shift B
## 题目描述

**Note: The time limit for this problem is 4s, 2x the default.**

To celebrate the start of spring, Farmer John's $N$ cows have invented an intriguing new dance, where they stand in a circle and re-order themselves in a predictable way.

Specifically, there are $N$ positions around the circle, numbered sequentially from $0$ to $N-1$, with position $0$ following position $N-1$.  A cow resides at each position.  The cows are also numbered sequentially from $0$ to $N-1$.  Initially, cow $i$ starts in position $i$.  You are told a set of $K$ positions $0=A_1<A_2<\dots<A_K<N$ that are "active", meaning the cows in these positions are the next to move.

In each minute of the dance, two things happen.  First, the cows in the active positions rotate: the cow at position $A_1$ moves to position $A_2$, the cow at position $A_2$ moves to position $A_3$, and so on, with the cow at position $A_K$ moving to position $A_1$.  All of these $K$ moves happen simultaneously, so the after the rotation is complete, all of the active positions still contain exactly one cow.  Next, the active positions themselves shift:
$A_1$ becomes $A_1+1$, $A_2$ becomes $A_2+1$, and so on (if $A_i = N-1$ for some active position, then $A_i$ circles back around to $0$).

Please calculate the order of the cows after $T$ minutes of the dance.
## 输入格式

The first line contains three integers $N, K$ and $T$.

The second line contains $K$ integers representing the initial set of active positions
$A_1,A_2, \dots, A_K$.  Recall that $A_1 = 0$ and that these are given in increasing order.
## 输出格式

Output the order of the cows after $T$ minutes, starting with the cow in position $0$, separated by
spaces.
## 样例

### 样例输入 #1
```
5 3 4
0 2 3

```
### 样例输出 #1
```
1 2 3 4 0

```
## 提示

For the example above, here are the cow orders and $A$ for the first four timesteps:
```
Initial, T = 0: order = [0 1 2 3 4], A = [0 2 3]
T = 1: order = [3 1 0 2 4]
T = 1: A = [1 3 4]
T = 2: order = [3 4 0 1 2]
T = 2: A = [2 4 0]
T = 3: order = [2 4 3 1 0]
T = 3: A = [3 0 1]
T = 4: order = [1 2 3 4 0]
```

$1 \leq K \leq N \leq 2 \cdot 10^5$, $1\le T\le 10^9$.

- Inputs 2-7: $N \leq 1000, T \leq 10000$.
- Inputs 8-13: No additional constraints.
## 题目翻译

### 题目描述

**注意：本题的时间限制为 4 秒，是默认时间限制的 2 倍。**

为了庆祝春天的到来，Farmer John 的 $N$ 头奶牛发明了一种有趣的舞蹈，她们围成一个圆圈，并以一种可预测的方式重新排列自己。

具体来说，圆圈上有 $N$ 个位置，编号从 $0$ 到 $N-1$，其中位置 $0$ 紧接着位置 $N-1$。每个位置上有一头奶牛。奶牛的编号也从 $0$ 到 $N-1$。初始时，奶牛 $i$ 位于位置 $i$。你会被告知一组 $K$ 个“活跃”位置 $0 = A_1 < A_2 < \dots < A_K < N$，这意味着这些位置上的奶牛是下一批要移动的。

在舞蹈的每一分钟，会发生两件事。首先，活跃位置上的奶牛会旋转：位置 $A_1$ 的奶牛移动到位置 $A_2$，位置 $A_2$ 的奶牛移动到位置 $A_3$，依此类推，位置 $A_K$ 的奶牛移动到位置 $A_1$。所有这些 $K$ 次移动同时发生，因此在旋转完成后，所有活跃位置仍然恰好有一头奶牛。接下来，活跃位置本身会移动：$A_1$ 变为 $A_1 + 1$，$A_2$ 变为 $A_2 + 1$，依此类推（如果某个活跃位置 $A_i = N-1$，则 $A_i$ 会循环回到 $0$）。

请计算舞蹈进行 $T$ 分钟后奶牛的顺序。

### 输入格式

第一行包含三个整数 $N$、$K$ 和 $T$。

第二行包含 $K$ 个整数，表示初始的活跃位置 $A_1, A_2, \dots, A_K$。注意 $A_1 = 0$，并且这些位置是按递增顺序给出的。

### 输出格式

输出 $T$ 分钟后奶牛的顺序，从位置 $0$ 的奶牛开始，用空格分隔。

### 提示

对于上述样例，以下是前四个时间步的奶牛顺序和活跃位置 $A$：
```
初始，T = 0：顺序 = [0 1 2 3 4]，A = [0 2 3]
T = 1：顺序 = [3 1 0 2 4]
T = 1：A = [1 3 4]
T = 2：顺序 = [3 4 0 1 2]
T = 2：A = [2 4 0]
T = 3：顺序 = [2 4 3 1 0]
T = 3：A = [3 0 1]
T = 4：顺序 = [1 2 3 4 0]
```

$1 \leq K \leq N \leq 2 \cdot 10^5$，$1 \leq T \leq 10^9$。

- 输入 2-7：$N \leq 1000$，$T \leq 10000$。
- 输入 8-13：没有额外限制。


---

---
title: "[USACO23OPEN] Milk Sum S"
layout: "post"
diff: 普及+/提高
pid: P9186
tag: ['数学', '二分', 'USACO', '2023', '前缀和']
---
# [USACO23OPEN] Milk Sum S
## 题目描述

**Note: The time limit for this problem is 4s, 2x the default.**

Farmer John's $N$ cows have integer milk production
values $a_1,\dots,a_N$.  That is, the $i$ th cow produces $a_i$ units of milk per
minute.  

Each morning, Farmer John starts with all $N$ cows hooked up to his milking
machine in the barn.  He is required to unhook them one by one, sending them out
for their daily exercise routine.  The first cow he sends out is unhooked after
just 1 minute of milking, the second cow he sends out is unhooked after another
minute of milking, and so on.  Since the first cow (say, cow $x$) only spends
one minute on the milking machine, she contributes only $a_x$ units of total
milk.  The second cow (say, cow $y$) spends two total minutes on the milking
machine, and therefore contributes $2a_y$ units of total milk.  The third cow
(say, cow $z$) contributes $3a_z$ total units, and so on.  Let $T$ represent the
maximum possible amount of milk, in total, that Farmer John can collect, if he
unhooks his cows in an optimal order.

Farmer John is curious how $T$ would be affected if some of the milk production
values in his herd were different.  For each of $Q$ queries,
each specified by two integers $i$ and $j$, please calculate what would be the 
new value of $T$ if $a_i$ were set to $j$.  Note that
each query is considering a temporary potential change independent of all other
queries; that is, $a_i$ reverts back to its original value before the next query
is considered.


## 输入格式

The first line contains $N$. 

The second line contains $a_1\dots a_N$.

The third line contains $Q$.

The next $Q$ lines each contain two space-separated integers $i$ and $j$.
## 输出格式

Please print the value of $T$ for each of the $Q$ queries on separate lines.

## 样例

### 样例输入 #1
```
5
1 10 4 2 6
3
2 1
2 8
4 5

```
### 样例输出 #1
```
55
81
98

```
## 提示

For the first query, $a$ would become $[1,1,4,2,6]$, and
$T =
1 \cdot 1 + 2 \cdot 1 + 3 \cdot 2 + 4 \cdot 4 + 5 \cdot 6 = 55$.

For the second query, $a$ would become $[1,8,4,2,6]$, and
$T =
1 \cdot 1 + 2 \cdot 2 + 3 \cdot 4 + 4 \cdot 6 + 5 \cdot 8 = 81$.

For the third query, $a$ would become $[1,10,4,5,6]$, and
$T =
1 \cdot 1 + 2 \cdot 4 + 3 \cdot 5 + 4 \cdot 6 + 5 \cdot 10 = 98$.

$1\le N\le 1.5\cdot 10^5$, $0 \leq a_i \leq 10^8$,$1\le Q\le 1.5\cdot 10^5$，$0 \leq j \leq 10^8$.

- Inputs 2-4: $N,Q\le 1000$.
- Inputs 5-11: No additional constraints.
## 题目翻译

### 题目描述

**注意：本题的时间限制为 4 秒，是默认时间限制的 2 倍。**

Farmer John 的 $N$ 头奶牛的产奶量为整数 $a_1, \dots, a_N$。也就是说，第 $i$ 头奶牛每分钟产 $a_i$ 单位的牛奶。

每天早上，Farmer John 会将所有 $N$ 头奶牛连接到谷仓的挤奶机上。他需要依次断开连接，将奶牛送去进行日常锻炼。第一头奶牛在挤奶 1 分钟后被断开连接，第二头奶牛在再挤奶 1 分钟后被断开连接，依此类推。由于第一头奶牛（假设是奶牛 $x$）只在挤奶机上停留了 1 分钟，她总共贡献了 $a_x$ 单位的牛奶。第二头奶牛（假设是奶牛 $y$）在挤奶机上停留了总共 2 分钟，因此贡献了 $2a_y$ 单位的牛奶。第三头奶牛（假设是奶牛 $z$）贡献了 $3a_z$ 单位的牛奶，依此类推。设 $T$ 表示 Farmer John 以最优顺序断开奶牛连接时，可以收集到的最大总牛奶量。

Farmer John 很好奇，如果某些奶牛的产奶量发生变化，$T$ 会如何变化。对于每个由两个整数 $i$ 和 $j$ 指定的 $Q$ 个查询，请计算如果将 $a_i$ 设置为 $j$，新的 $T$ 值会是多少。注意，每个查询都是独立的临时变化，即在考虑下一个查询之前，$a_i$ 会恢复为原始值。

### 输入格式

第一行包含 $N$。

第二行包含 $a_1 \dots a_N$。

第三行包含 $Q$。

接下来的 $Q$ 行，每行包含两个用空格分隔的整数 $i$ 和 $j$。

### 输出格式

请为每个查询输出一行，表示对应的 $T$ 值。

### 提示

对于第一个查询，$a$ 将变为 $[1,1,4,2,6]$，此时 $T = 1 \cdot 1 + 2 \cdot 1 + 3 \cdot 2 + 4 \cdot 4 + 5 \cdot 6 = 55$。

对于第二个查询，$a$ 将变为 $[1,8,4,2,6]$，此时 $T = 1 \cdot 1 + 2 \cdot 2 + 3 \cdot 4 + 4 \cdot 6 + 5 \cdot 8 = 81$。

对于第三个查询，$a$ 将变为 $[1,10,4,5,6]$，此时 $T = 1 \cdot 1 + 2 \cdot 4 + 3 \cdot 5 + 4 \cdot 6 + 5 \cdot 10 = 98$。

$1 \leq N \leq 1.5 \cdot 10^5$，$0 \leq a_i \leq 10^8$，$1 \leq Q \leq 1.5 \cdot 10^5$，$0 \leq j \leq 10^8$。

- 输入 2-4：$N, Q \leq 1000$。
- 输入 5-11：没有额外限制。


---

---
title: "[USACO23OPEN] Field Day S"
layout: "post"
diff: 普及+/提高
pid: P9187
tag: ['动态规划 DP', '数学', 'USACO', '2023', '位运算']
---
# [USACO23OPEN] Field Day S
## 题目描述

**Note: The time limit for this problem in Python is 15s.  Other languages have the default time limit of 2s.**

Each of Farmer John's $N$ barns has selected a team of $C$ 
cows to participate in field day. The breed of every cow is
either a Guernsey or a Holstein.  

The difference between two teams is defined to be the number of positions $i$
($1 \leq i \leq C$) at which the breeds of the cows in the $i$ th positions
differ. For every team $t$ from $1 \ldots N$, please compute the maximum
difference between team $t$ and any other team.
## 输入格式

The first line contains $C$ and $N$.

The next $N$ lines each contain a string of length $C$ of `G`s and `H`s.  Each line
corresponds to a team.
## 输出格式

For each team, print the maximum difference.

## 样例

### 样例输入 #1
```
5 3
GHGGH
GHHHH
HGHHG
```
### 样例输出 #1
```
5
3
5
```
## 提示

The first and third teams differ by $5$. The second and third teams differ by
$3$.

$2\le N\le 10^5$, $1\le C\le 18$.

- Inputs 2-5: $C = 10$.
- Inputs 6-9: All answers are at least $C-3$.
- Inputs 10-20: No additional constraints.
## 题目翻译

### 题目描述

**提示：本题的 Python 时限为 15s。其它语言默认 2s。**

Farmer John 的 $N$ 个牛棚都会选出包含 $C$ 只奶牛的队伍去参加户外聚会。所有奶牛的品种都只可能是根西牛（`G`）或荷斯坦奶牛（`H`）。

我们将两个奶牛队伍中，同一位置对应的两头奶牛品种不同的所有位置 $i(1 \leq i \leq C)$ 的个数，定义为的两个奶牛队伍的差异。对于编号 $1...N$ 的每个奶牛队伍 $t$，请计算出 $t$ 和其它所有队伍的差异的最大值。

### 输入格式

第一行包含两个整数 $C$ 与 $N$。

接下来 $N$ 行，每行有一个长度为 $C$ 的，仅包含字母 `G` 和 `H` 的字符串，每行对应一支奶牛队伍。

### 输出格式

对于每个队伍，输出差异最大值。

### 说明/提示

第一个和第三个队伍的差异为 $5$。第二个和第三个队伍的差异为 $3$。

$2 \leq N \leq 10^5,1 \leq C \leq 18$。

- 对于测试点 2-5：$C = 10$。
- 对于测试点 6-9：所有答案最少为 $C - 3$。
- 对于测试点 10-20：没有额外条件。


---

---
title: "[USACO23OPEN] Pareidolia S"
layout: "post"
diff: 普及+/提高
pid: P9188
tag: ['动态规划 DP', 'USACO', '2023']
---
# [USACO23OPEN] Pareidolia S
## 题目背景

**Note: The time limit for this problem is 4s, 2x the default.**

Pareidolia is the phenomenon where your eyes tend to see familiar patterns in
images where none really exist -- for example seeing a face in a cloud.  As you
might imagine, with Farmer John's constant proximity to cows, he often sees
cow-related patterns in everyday objects.  For example, if he looks at the
string "bqessiyexbesszieb", Farmer John's  eyes ignore some of the letters and
all he sees is "bessiebessie".  
## 题目描述

Given a string $s$, let $B(s)$ represent the maximum number of repeated copies
of "bessie" one can form by deleting zero or more of the characters from $s$. 
In the example above, $B(\text{``bqessiyexbesszieb"}) = 2$.

Computing $B(s)$ is an interesting challenge, but Farmer John is interested in
solving a challenge that is even more interesting: Given a string $t$ of length
at most $3\cdot 10^5$ consisting only of characters a-z, compute the sum of
$B(s)$ over all contiguous substrings $s$ of $t$.
## 输入格式

The input consists of a nonempty string of length at most $3\cdot 10^5$ whose
characters are all lowercase English letters.
## 输出格式

Output a single number, the total number of bessies that can be made across all
substrings of the input string.
## 样例

### 样例输入 #1
```
bessiebessie

```
### 样例输出 #1
```
14

```
### 样例输入 #2
```
abcdefghssijebessie

```
### 样例输出 #2
```
28

```
## 提示

For the first sample, twelve substrings contain exactly $1$ "bessie", and $1$ string contains exactly $2$ "bessie"s, so the total is $12\cdot 1+1\cdot 2=14$.

- Inputs 3-5: The string has length at most $5000$.
- Inputs 6-12: No additional constraints.
## 题目翻译

### 题目背景

**注意：本题的时间限制为 4 秒，是默认时间限制的 2 倍。**

Pareidolia 是一种现象，指的是人们倾向于在并不真正存在的地方看到熟悉的图案——例如在云中看到一张脸。可以想象，由于农夫 John 经常与奶牛接触，他常常在日常物品中看到与奶牛相关的图案。例如，如果他看到字符串 "bqessiyexbesszieb"，农夫 John 的眼睛会忽略其中的一些字母，而他看到的只是 "bessiebessie"。

### 题目描述

给定一个字符串 $s$，令 $B(s)$ 表示通过删除 $s$ 中的零个或多个字符后，能够形成的 "bessie" 的最大重复次数。在上面的例子中，$B(\text{``bqessiyexbesszieb"}) = 2$。

计算 $B(s)$ 是一个有趣的挑战，但农夫 John 对解决一个更有趣的挑战感兴趣：给定一个长度不超过 $3 \cdot 10^5$ 的字符串 $t$，且仅由字符 a-z 组成，计算所有连续子串 $s$ 的 $B(s)$ 之和。

### 输入格式

输入由一个非空字符串组成，长度不超过 $3 \cdot 10^5$，且所有字符均为小写英文字母。

### 输出格式

输出一个数字，表示输入字符串的所有子串中能够形成的 "bessie" 的总数。

### 提示

对于第一个样例，有 12 个子串恰好包含 $1$ 个 "bessie"，有 $1$ 个子串恰好包含 $2$ 个 "bessie"，因此总数为 $12 \cdot 1 + 1 \cdot 2 = 14$。

- 输入 3-5：字符串长度不超过 $5000$。
- 输入 6-12：没有额外限制。


---

---
title: "[USACO05OPEN] Lazy Cows G"
layout: "post"
diff: 普及+/提高
pid: P9832
tag: ['2005', 'USACO']
---
# [USACO05OPEN] Lazy Cows G
## 题目描述

地母是这个世界上大地的主宰，在她眼中整个大地呈现两行 $n$ 列的一个状态。在这个大地上如珍珠般散落着各种宝藏，每个宝藏占据一个格子。不过这个消息让天公知道了，他想抢走这些宝藏。地母决定用「无极」牌帆布盖住这些宝藏。

「无极」牌帆布是矩形状的，而且地母现在手头比较紧，她决定用 $k$ 块帆布盖住所有的宝藏。现在希望你求出这 $k$ 块帆布的面积之和的最小值。
## 输入格式

第一行给出三个数，分别代表宝藏的个数 $m$，帆布的张数 $k$，以及整个大地所呈现的列数 $n$，下面 $m$ 行给出两个数，代表每个宝藏所在的位置。
## 输出格式

输出一行一个数，帆布面积之和的最小值。
## 样例

### 样例输入 #1
```
8 2 9
1 2
1 6
1 7
1 8
1 9
2 2
2 3
2 4
```
### 样例输出 #1
```
10
```
## 提示

对于 $100\%$ 的数据，$1 \leq n \leq 1.5 \times 10^7$，$1 \leq k \leq m \leq 10^3$。


---

---
title: "[USACO05OPEN] Expedition G"
layout: "post"
diff: 普及+/提高
pid: P9833
tag: ['2005', 'USACO']
---
# [USACO05OPEN] Expedition G
## 题目描述

一群奶牛抢了一辆卡车决定前往树林里探险，但是由于它们的驾驶技术太糟，油箱在路上给弄破了，所以它们每前进一个单位的路程就会漏掉一个单位的油。

为了修好油箱，奶牛们必须前往最近的城市（不会超过 $10^6$ 单位路程）。  
在当前位置和城市之间有 $n$ 个加油站．奶牛可以在加油站加 $1$ 到 $100$ 单位的油。  

对于人来说，树林是个危险的地方；对奶牛来说，更是这样。  所以，奶牛要尽可能的少停站加油，幸运的是，这辆卡车的油箱非常大，你可以认为它的容量是无穷大的。  
卡车在离城 $l$ 个单位时还有 $p$ 个单位的油，你要算出奶牛们至少要停几站才能到城市，或者奶牛们根本到不了城市。
## 输入格式

第一行，一个整数 $n$。

第二到 $n+1$ 行，每行有两个用空格隔开的整数，描述一个加油站。第一个数表示这个加油站离城市的距离，第二个数表示在这个加油站最多可以加多少油。

第 $n+1$ 行：两个用空格分开的整数 $l$ 和 $p$。
## 输出格式

一个表示卡车到城市最少要停的次数，如果无法到达输出 `-1`。
## 样例

### 样例输入 #1
```
4
4 4
5 2
11 5
15 10
25 10

```
### 样例输出 #1
```
2
```
## 提示

对于 $100\%$ 的数据，$1\leq n\leq 10^4$，$1\leq p\leq 1000000$。


---

---
title: "[USACO05OPEN] Around the world G"
layout: "post"
diff: 普及+/提高
pid: P9834
tag: ['2005', 'USACO']
---
# [USACO05OPEN] Around the world G
## 题目描述

这些年，农夫约翰在国际上交了一大批开农场的朋友。由于他有一段时间没有去见过英国的农夫泰德和荷兰的农夫波尔，所以他想去拜访他们。

他知道每个朋友的农场的经度（是一个从 $0$ 到 $359$ 的整数，我们把地球看成一个圆，经度在此圆上顺时针方向递增）。  

农夫约翰打算乘飞机去拜访他的 $n$ 个朋友（用 $1$ 到 $n$ 来表示）。他知道在这些农场之间有 $m$ 条双向的航线。飞机是沿着地面上最短的路径飞行的（就是圆上的最短弧长）。两个农场之间的航线一定是最短的。

保证如果有两个农场在直径两端，那么它们之间一定不会被某条航线直接连接。

所以任何一次航行都可以被描述成顺时针或是逆时针的．比如说，经度 $30$ 到经度 $35$ 是顺时针的，经度 $350$ 到经度 $10$ 也是顺时针的，而经度 $350$ 到经度 $200$ 是逆时针的。

农夫约翰为了耍酷，决定要经过几个朋友的农场做到环球旅行，他想知道这是否可能，如果可能最少要乘几次飞机。

他想在他最好的朋友（即输入中的第一个）的农场上开始和结束这次旅行。为了保证这是一次环球航行，结束旅行，顺时针经过的路程不能等于逆时针经过的路程。
## 输入格式

第一行两个用空格隔开的整数 $n$ 和 $m$。

第二到 $n+1$ 行：第 $i+1$ 行有一个整数，表示第 $i$ 个农场的经度。第二行是他的最好的朋友的地址。

第 $n+2$ 过程 $n+m+1$ 行：第 $i+n+1$ 行有两个整数，表示这两个农场之间有航线。
## 输出格式

一个整数，表示农夫约翰至少要乘几次飞机才能完成环球旅行。每次农夫约翰从一个农场前往另一个农场算作乘一次飞机。如果不可能做到环球旅行则输出 `-1`。
## 样例

### 样例输入 #1
```
3 3
0
120
240
1 2
2 3
1 3

```
### 样例输出 #1
```
3
```
## 提示

对于 $100\%$ 的数据，$1 \leq n \leq 5 \times 10^3$，$1 \leq m \leq 2.5 \times 10^4$。


---

---
title: "[USACO05OPEN] Landscaping G"
layout: "post"
diff: 普及+/提高
pid: P9835
tag: ['2005', 'USACO']
---
# [USACO05OPEN] Landscaping G
## 题目描述

农夫约翰正在做一次艰难的转型，从养山羊改成养奶牛，他的农场，由于是为养山羊而设计的所以有太多的山，为了养牛就必须将它整平。但是，将山整平是件很花钱的工作，所以他要移走尽可能少的土。

由于农场很细长，所以可以用一个 $n$ 和 $n$ 个整数（范围 $[1,10^6]$）组成的二维的数组来表示，如：

```
1 2 3 3 3 2 1 3 2 2 1 2
```

上述农场的侧面图是这样的：

```
    * * *     *
  * * * * *   * * *   *
* * * * * * * * * * * *
1 2 3 3 3 2 1 3 2 2 1 2
```

一个或是一些连续等高的地面，如果它左边或是右边的海拔都比它低的话，就被称为山顶，上面的例子就有三个山顶。 确定如果要使地图上仅有 $k$ 个山顶，至少要移走多少体积的土（每块地面减少一单位海拔需移走一单位的土）。注意，地面的海拔只能被降低不能被升高。 对于例子，如果要减少到只有 $1$ 个山顶，这需要移走 $2+1+1+1=5$ 个单位的土（`-` 表示移走的土）：

```
    * * *     -
  * * * * *   - - -   -
* * * * * * * * * * * *
1 2 3 3 3 2 1 3 2 2 1 2
```
## 输入格式

第 $1$ 行输入整数 $n$ 和 $k$。

之后 $n$ 行，每行输入一个整数，表示这块地的海拔。
## 输出格式

如果仅能有 $k$ 个山顶至少要移走多少土。
## 样例

### 样例输入 #1
```
12 1
1
2
3
3
3
2
1
3
2
2
1
2

```
### 样例输出 #1
```
5
```
## 提示

对于 $100\%$ 的数据，$1 \leq n \leq 10^3$，$1 \leq k \leq 25$。


---

---
title: "[USACO23DEC] Bovine Acrobatics S"
layout: "post"
diff: 普及+/提高
pid: P9977
tag: ['贪心', 'USACO', '堆', '2023', 'O2优化', '排序']
---
# [USACO23DEC] Bovine Acrobatics S
## 题目描述

Farmer John 决定让他的奶牛表演杂技！首先，FJ 为他的奶牛称重，发现她们有 $N$（$1\le N\le 2\times 10^5$）个不同的体重。具体来说，对于全部的 $i\in [1,N]$，有 $a_i$ 只奶牛的体重为 $w_i$ 单位（$1\le a_i\le 10^9, 1\le w_i\le 10^9$）。

他最出名的节目需要奶牛叠成**平衡的奶牛塔**。一座**奶牛塔**是一些奶牛，每只奶牛站在下一只奶牛身上。一座奶牛塔是**平衡的**，当且仅当每一只被踩着的奶牛，都比**直接**踩在它身上的那只奶牛重至少 $K$（$1\le K\le 10^9$）单位。每只奶牛都可以成为奶牛塔的一部分。

如果 FJ 想要创造最多 $M$（$1 \le M \le 10^9$）座奶牛塔，最多有多少只奶牛可以成为奶牛塔的一部分？
## 输入格式

第一行包含三个空格分隔的整数 $N$，$M$ 和 $K$。

接下来 $N$ 行，每行包含两个空格分隔的整数 $w_i$ 和 $a_i$。保证所有的 $w_i$ 是不同的。
## 输出格式

输出当 FJ 采用最佳方案时，奶牛塔中奶牛的最大数目。
## 样例

### 样例输入 #1
```
3 5 2
9 4
7 6
5 5
```
### 样例输出 #1
```
14
```
### 样例输入 #2
```
3 5 3
5 5
7 6
9 4
```
### 样例输出 #2
```
9
```
## 提示

### 样例解释 1

FJ 可以用体重为 $5,7,9$ 的奶牛创造四座平衡的奶牛塔，再用体重为 $5,7$ 的奶牛创造另一座。

### 样例解释 2

FJ 可以用体重为 $5,9$ 的奶牛创造四座平衡的奶牛塔，再用体重为 $7$ 的一只奶牛创造另一座。或者，他可以用体重为 $5,9$ 的奶牛创造四座平衡的奶牛塔，再用体重为 $5$ 的一只奶牛创造另一座。

### 测试点性质

- 测试点 $3-5$ 满足 $M \le 5000$ 且奶牛的总数不超过 $5000$。
- 测试点 $6-11$ 满足奶牛的总数不超过 $2\cdot 10^5$。
- 测试点 $12-17$ 没有额外限制。



---

---
title: "[USACO23DEC] Target Practice S"
layout: "post"
diff: 普及+/提高
pid: P9979
tag: ['模拟', 'USACO', '2023', 'O2优化', '分类讨论']
---
# [USACO23DEC] Target Practice S
## 题目描述

Bessie 是一只仿生牛。在一条数轴上，她正尝试命中 $T$（$1 \leq T \leq 10^5$）个位于不同位置的靶子。Bessie 在位置 $0$ 开始行动，并遵循一个长度为 $C$（$1 \leq C \leq 10^5$）的命令序列，序列由 `L`、`F` 和 `R` 组成：

- `L`：Bessie 向左移动一个单位距离。
- `R`：Bessie 向右移动一个单位距离。
- `F`：Bessie 开枪。如果有一个靶子在 Bessies 当前的位置，这个靶子将被命中并摧毁。它不可以再次被命中。

如果在 Bessie 开始前，你被允许修改序列中的至多一条命令，Bessie 最多可以命中多少靶子？
## 输入格式

第一行包含 $T$ 和 $C$。

下一行包含 $T$ 个靶子的位置，均为 $[-C,C]$ 范围内的不同整数。

下一行包含长度为 $C$ 的命令序列，仅包含字符 `F`、`L` 和 `R`.
## 输出格式

输出修改至多一个命令后，Bessie 可以命中的靶子的最大数量。
## 样例

### 样例输入 #1
```
3 7
0 -1 1
LFFRFRR
```
### 样例输出 #1
```
3
```
### 样例输入 #2
```
1 5
0
FFFFF
```
### 样例输出 #2
```
1
```
### 样例输入 #3
```
5 6
1 2 3 4 5
FFRFRF
```
### 样例输出 #3
```
3
```
## 提示

### 样例解释 1

如果你对命令序列不做任何修改，Bessie 将命中两个靶子。

| 命令 | 位置 | 命中的靶子数目 |
| :----------- | :----------- | :----------- |
| Start | 0 | 0 |
| L | -1 | 0 |
| F | -1 | 1 |
| F | -1 | 1（无法摧毁靶子超过 1 次） |
| R | 0 | 1 |
| F | 0 | 2 |
| R | 1 | 2 |
| R | 2 | 2 |

如果你将最后一条命令由 `R` 修改为 `F`，Bessie 将命中三个靶子：

| 命令 | 位置 | 命中的靶子数目 |
| :----------- | :----------- | :----------- |
| Start | 0 | 0 |
| L | -1 | 0 |
| F | -1 | 1 |
| F | -1 | 1（无法摧毁靶子超过 1 次） |
| R | 0 | 1 |
| F | 0 | 2 |
| R | 1 | 2 |
| F | 1 | 3 |

### 样例解释 2

如果命令序列不修改，在位置 $0$ 的唯一一个靶子将被命中。

由于一个靶子不能被多次摧毁，答案为 $1$。

### 测试点性质

- 测试点 $4-6$ 满足 $T,C \le 1000$。
- 测试点 $7-15$ 没有额外限制。


---

---
title: "[USACO23DEC] Flight Routes G"
layout: "post"
diff: 普及+/提高
pid: P9980
tag: ['动态规划 DP', 'USACO', '2023', 'O2优化']
---
# [USACO23DEC] Flight Routes G
## 题目描述

Bessie 最近发现她最喜欢的摇滚艺术家 Elsie Swift 正在表演她最新的“时代之旅”音乐会！不幸的是，票卖光的太快了，所以 Bessie 考虑飞往另一个城市参加音乐会。“时代之旅”将在编号为 $1\dots N$ 的 $N$（$2 \le N \le 750$）座城市上演，每对满足 $i<j$ 的城市对 $(i,j)$ 都可能存在从 $i$ 到 $j$ 的一条**单向直飞航班**。

从城市 $a$ 到城市 $b$ 的一条**航线**是一个包含 $k\ge 2$ 座城市的序列 $a=c_1<c_2<\cdots<c_k=b$，使得对于所有的 $1\le i< k$，城市 $c_{i}$ 到城市 $c_{i+1}$ 有**单向直飞航班**。对于所有满足 $i<j$ 的城市对 $(i,j)$，你将被告知它们之间航线数目的奇偶性（$0$ 代表偶数，$1$ 代表奇数）。

在计划她的旅行行程时，Bessie 分心了。现在她想知道，有多少对城市间有**单向直飞航班**。可以证明答案是唯一的。
## 输入格式

第一行包含整数 $N$。

接下来 $N-1$ 行，第 $i$ 行包含 $N-i$ 个整数。第 $i$ 行的第 $j$ 个整数表示从城市 $i$ 到城市 $i+j$ 的航线数目的奇偶性。
## 输出格式

输出有单向直飞航班的城市对数。
## 样例

### 样例输入 #1
```
3
11
1
```
### 样例输出 #1
```
2
```
### 样例输入 #2
```
5
1111
101
01
1
```
### 样例输出 #2
```
6
```
## 提示

### 样例解释 1

有两条单向直飞航班：$1\rightarrow 2$ 和 $2\rightarrow 3$。有城市 $1,2$ 之间、$2,3$ 之间，仅包含一条单向直飞航班的航线各一条。还有城市 $1,3$ 之间的航线一条（$1\rightarrow 2\rightarrow 3$）。

### 样例解释 2

有六条单向直飞航班：$1\rightarrow 2$，$1 \rightarrow 4$，$1\rightarrow 5$，$2\rightarrow 3$，$3\rightarrow 5$，$4\rightarrow 5$。这导致的航线数如下表所示：

| 出发地\目的地 | 1 | 2 | 3 | 4 | 5 |
| :-: | :-: | :-: | :-: | :-:|:-:|
| 1 | 0 | 1 | 1 | 1 | 3 |
| 2 | 0 | 0 | 1 | 0 | 1 |
| 3 | 0 | 0 | 0 | 0 | 1 |
| 4 | 0 | 0 | 0 | 0 | 1 |
| 5 | 0 | 0 | 0 | 0 | 0 |

这与输入是相符的。

### 测试点性质

- 测试点 $3-4$ 满足 $N \le 6$。
- 测试点 $5-12$ 满足 $N \le 100$。
- 测试点 $13-22$ 没有额外限制。


---

---
title: "[USACO23DEC] Minimum Longest Trip G"
layout: "post"
diff: 普及+/提高
pid: P9981
tag: ['动态规划 DP', '倍增', 'USACO', '2023', 'O2优化', '拓扑排序', '哈希 hashing']
---
# [USACO23DEC] Minimum Longest Trip G
## 题目描述

Bessie 正在奶牛大陆上旅行。奶牛大陆由从 $1$ 到 $N$ 编号的 $N$（$2 \le N \le 2\cdot 10^5$）座城市和 $M$（$1 \le M \le 4\cdot 10^5$）条单向道路组成。第 $i$ 条路从城市 $a_i$ 通向城市 $b_i$，标签为 $l_i$。

由城市 $x_0$ 开始的长度为 $k$ 的旅程被定义为一个城市序列 $x_0,x_1,\ldots,x_k$，对于所有的 $0 \le i < k$，存在由城市 $x_i$ 到 $x_{i+1}$ 的路。保证在奶牛大路上不存在长度无限的旅程，不存在两条路连接一对相同的城市。

对于每座城市，Bessie 想知道从它开始的最长旅程。对于一些城市，从它们开始的最长旅程不唯一，Bessie 将选择其中道路标签序列字典序更小的旅程。一个序列比等长的另一个序列字典序更小，当且仅当在它们不同的第一个位置，前者比后者的元素更小。

输出 Bessie 在每座城市选择的旅途的长度和道路标签之和。
## 输入格式

第一行包含 $N$ 和 $M$。

接下来 $M$ 行，每行三个整数 $a_i,b_i,l_i$，代表一条由 $a_i$ 到 $b_i$，标签为 $l_i$ 的单向道路。
## 输出格式

输出 $N$ 行，第 $i$ 行包含由空格分隔的两个整数，表示 Bessie 选择的从城市 $i$ 开始的旅程的长度和道路标签之和。
## 样例

### 样例输入 #1
```
4 5
4 3 10
4 2 10
3 1 10
2 1 10
4 1 10
```
### 样例输出 #1
```
0 0
1 10
1 10
2 20
```
### 样例输入 #2
```
4 5
4 3 4
4 2 2
3 1 5
2 1 10
4 1 1
```
### 样例输出 #2
```
0 0
1 10
1 5
2 12
```
### 样例输入 #3
```
4 5
4 3 2
4 2 2
3 1 5
2 1 10
4 1 1
```
### 样例输出 #3
```
0 0
1 10
1 5
2 7
```
### 样例输入 #4
```
4 5
4 3 2
4 2 2
3 1 10
2 1 5
4 1 1
```
### 样例输出 #4
```
0 0
1 5
1 10
2 7
```
## 提示

### 样例解释 2

在下面的解释中，我们用 $a_i\xrightarrow{l_i} b_i$ 表示由城市 $a_i$ 通往 $b_i$，标签为 $l_i$ 的单向道路。

从城市 $4$ 出发有多条旅程，包含 $4\xrightarrow{4} 3\xrightarrow 5 1$，$4\xrightarrow 1 1$ 和 $4\xrightarrow 2 2\xrightarrow{10} 1$。在这些旅程中，$4\xrightarrow{4} 3\xrightarrow 5 1$ 和 $4\xrightarrow 2 2\xrightarrow{10} 1$ 是最长的。它们的长度均为 $2$，道路标签序列分别为 $[4,5]$ 和 $[2,10]$。$[2,10]$ 是字典序更小的那一个，它的和为 $12$。

### 测试点性质

- 测试点 $5-6$ 满足所有道路的标签相同。
- 测试点 $7-8$ 满足所有道路的标签不相同。
- 测试点 $9-10$ 满足 $N,M \le 5000$。
- 测试点 $11-20$ 没有额外限制。


---

---
title: "[USACO23DEC] Haybale Distribution G"
layout: "post"
diff: 普及+/提高
pid: P9982
tag: ['数学', '二分', 'USACO', '2023', '三分', 'O2优化']
---
# [USACO23DEC] Haybale Distribution G
## 题目描述

Farmer John 正在农场上分发干草堆。

Farmer John 的农场上有 $N$（$1 \le N \le 2\cdot 10^5$）座谷仓，分别位于数轴上的整点 $x_1,\ldots,x_N$（$0 \le x_i \le 10^6$）。Farmer John 正计划将 $N$ 车干草堆运输到整点 $y$（$0 \le y \le 10^6$），然后为每一座谷仓运输一车干草堆。

不幸的是，Farmer John 的运输系统浪费了很多干草堆。具体来说，给出一些 $a_i,b_i$（$1 \le a_i,b_i \le 10^6$），每车干草堆每向左移动一单位距离，$a_i$ 堆干草堆会被浪费；每车干草堆每向右移动一单位距离，$b_i$ 堆干草堆会被浪费。形式化地，一车干草堆从整点 $y$ 运动到位于 $x$ 的谷仓，被浪费的干草堆堆数如下：

$$\begin{cases}a_i\cdot (y-x) & \text{if} \ y>x \\ b_i\cdot(x-y)&\text{if}\ x>y\end{cases}$$

给出 $Q$（$1 \le Q \le 2 \cdot 10^5$）组相互独立的询问，每组询问给出一组 $(a_i,b_i)$ 的值，帮助 Farmer John 计算当按照最佳方案选择 $y$，最少有多少堆干草堆被浪费。
## 输入格式

第一行包含 $N$。

接下来一行包含 $x_1\dots x_N$。

接下来一行包含 $Q$。

接下来 $Q$ 行，每行包含两个整数 $a_i,b_i$。
## 输出格式

输出 $Q$ 行，第 $i$ 行包含第 $i$ 个询问的答案。
## 样例

### 样例输入 #1
```
5
1 4 2 3 10
4
1 1
2 1
1 2
1 4
```
### 样例输出 #1
```
11
13
18
30
```
## 提示

### 样例解释 1

样例中第二个询问，最佳方案为选择 $y=2$，被浪费的干草堆数量为 $2(2-1)+2(2-2)+1(3-2)+1(4-2)+1(10-2)=1+0+1+2+8=13$。

### 测试点性质

- 测试点 $2$ 满足 $N,Q \le 10$。
- 测试点 $3$ 满足 $N,Q \le 500$。
- 测试点 $4-6$ 满足 $N,Q \le 5000$。
- 测试点 $7-16$ 没有额外限制。


---


---
title: "[图论与代数结构 401] 二分图匹配"
layout: "post"
diff: 普及+/提高
pid: B3605
tag: []
---
# [图论与代数结构 401] 二分图匹配
## 题目描述

给定一张左侧有 $nl$ 个点、右侧有 $nr$ 个点、$m$ 条边的二分图，求一组它的最大匹配。
## 输入格式

第一行三个整数 $nl$，$nr$，$m$。

接下来 $m$ 行，每行两个整数 $u_i$，$v_i$，表示有一条左侧第 $u_i$ 个点连向右侧第 $v_i$ 个点的边。

## 输出格式

第一行一个整数表示最大匹配数。
## 样例

### 样例输入 #1
```
2 2 3
1 1
1 2
2 1

```
### 样例输出 #1
```
2
```
### 样例输入 #2
```
2 2 2
1 1
2 1

```
### 样例输出 #2
```
1
```
### 样例输入 #3
```
15 15 30
4 14
6 1
14 7
7 8
1 12
15 8
8 10
6 10
6 2
6 12
5 1
5 14
11 10
9 9
7 12
11 13
5 9
6 9
9 1
5 8
10 13
1 13
10 3
11 7
10 8
9 5
12 13
11 6
12 15
14 4

```
### 样例输出 #3
```
12
```
### 样例输入 #4
```
15 15 40
6 10
3 10
2 2
6 5
1 3
11 7
5 8
14 2
10 5
9 15
15 13
13 14
8 10
9 10
15 1
10 2
7 1
3 8
12 3
12 10
11 4
14 11
4 13
7 11
14 15
7 13
12 7
11 6
12 15
2 9
9 9
6 13
1 9
6 15
4 4
14 12
5 4
14 5
12 9
2 10

```
### 样例输出 #4
```
15
```
### 样例输入 #5
```
15 15 2
14 1
14 2

```
### 样例输出 #5
```
1
```
## 提示

对于所有数据，$1\leq nl,nr\leq 500$，$1\leq m\leq 2.5\times 10^5$。


---

---
title: "[图论与代数结构 701] 强连通分量"
layout: "post"
diff: 普及+/提高
pid: B3609
tag: []
---
# [图论与代数结构 701] 强连通分量
## 题目描述

给定一张 $n$ 个点 $m$ 条边的有向图，求出其所有的强连通分量。

**注意，本题可能存在重边和自环。**
## 输入格式

第一行两个正整数 $n$ ， $m$ ，表示图的点数和边数。

接下来 $m$ 行，每行两个正整数 $u$ 和 $v$ 表示一条边。
## 输出格式

第一行一个整数表示这张图的强连通分量数目。

接下来每行输出一个强连通分量。第一行输出 1 号点所在强连通分量，第二行输出 2 号点所在强连通分量，若已被输出，则改为输出 3 号点所在强连通分量，以此类推。每个强连通分量按节点编号大小输出。

## 样例

### 样例输入 #1
```
6 8
1 2
1 5
2 6
5 6
6 1
5 3
6 4
3 4

```
### 样例输出 #1
```
3
1 2 5 6
3
4

```
## 提示

对于所有数据，$1 \le n \le 10000$，$1 \le m \le 100000$。


---

---
title: "[图论与代数结构 801] 无向图的块"
layout: "post"
diff: 普及+/提高
pid: B3610
tag: []
---
# [图论与代数结构 801] 无向图的块
## 题目描述

在离散数学课程的学习中，大家学习了无向图中”割点“和“块”的定义，现在来检查一下大家的学习情况。

给定一张 $n$ 个点 $m$ 条边的无向图，点的编号从 $1$ 到 $n$ ，可能存在重边和自环，不保证是一张连通图。现在，请你求出这张图所有的块。

注意，我们不把一个没有任何与其相连边的点看成割点；因此，一个单独的点构成的连通块不被看成是块。你可以通过样例理解这个事情。

在输出的时候，我们规定这么一个输出的顺序：首先，对于一个块，我们把该块中所有点按照编号从小到大排序；然后，对于两个块，我们规定，把点按照顺序拿出来排成一个序列，字典序较小的排在前面。这样，我们就可以对所有块规定了一个顺序。最终输出就按照这样的顺序输出。

有关字典序的定义，可以在搜索引擎上查找，或者参考[维基百科_字典序](https://en.wikipedia.org/wiki/Lexicographic_order)。

## 输入格式

第一行两个正整数 $n$ 和 $m$ ，分别表示给定无向图的点数和边数。

接下来 $m$ 行，每行两个正整数 $u$ 和 $v$ 表示一条连接这两个点的无向边。
## 输出格式

第一行一个正整数 $Cnt$ 表示答案，即图中块的个数。

接下来 $Cnt$ 行，第 $i$ 行输出若干个正整数，表示第 $i$ 个块中的所有点。注意同一个块点的编号按照从小到大的顺序输出。按照题目中规定的字典序顺序输出块。

## 样例

### 样例输入 #1
```
7 7
5 6
1 2
3 5
1 4
3 1
4 5
2 5

```
### 样例输出 #1
```
2
1 2 3 4 5
5 6
```
## 提示

本题没有部分分。

对于所有数据，满足 $1\leq n \leq 50000$，$1 \leq m \leq 300000$，保证输入的图合法且满足题目中的限制条件。



---

---
title: "[信息与未来 2017] 加强版密码锁"
layout: "post"
diff: 普及+/提高
pid: B3734
tag: ['2017', '江苏', '信息与未来']
---
# [信息与未来 2017] 加强版密码锁
## 题目描述

乌龟偶然获得了一个宝箱，宝箱上又有一把密码锁。密码锁由  $n$ 个拨盘组成，每个拨盘初始时有一个 $0$ 到
$99$ 之间的整数。向上拨使数字 $x$ 变为 $(x+1) \bmod 100$，
向下拨使数字 $x$ 变为 $(x+99) \bmod 100$。

因为密码锁年久失修，拨盘拨动的次数越多越费力。
如果一个拨盘被拨动 $k$ 次，需要花费 $k^2$ 单位时间。

密码锁只有在所有的拨盘上的数字形成一个从左到
右严格递增的数列时才会解开。乌龟再次请你帮忙，求
解解开密码锁的最少时间。

---

试题中使用的生成数列 $R$ 定义如下：整数 $0\leq R_1\lt 201701$ 在输入中给出。

对于 $i\gt 1,R_i=(R_{i−1}\times 6807+2831)\bmod 201701$。
## 输入格式

两个整数 $n,R_1$，表示拨盘的数量和数列生成的首项。从左向右数第 $i(1\leq i\leq n)$ 个拨盘的初始数字为 $R_i \bmod 100$。
## 输出格式

一个整数，表示解开密码锁的最少时间。
## 样例

### 样例输入 #1
```
10 4
```
### 样例输出 #1
```
3338
```
## 提示

$30\%$ 的数据满足 $n\leq3$，所有数据满足 $1\leq n\leq 100$。
>本题原始满分为 $20\text{pts}$。


---

---
title: "[信息与未来 2021] 三角魔方"
layout: "post"
diff: 普及+/提高
pid: B3761
tag: ['2021', '江苏', '信息与未来']
---
# [信息与未来 2021] 三角魔方
## 题目描述

有一个三角形的魔方，初始时，三角形中按行依次填有 $\tt{A}\sim \tt{P}$ 这 $16$ 个字母。魔方每次可以选
择某个下图箭头所示的方向进行⼀次“旋转”操作。

![](https://cdn.luogu.com.cn/upload/image_hosting/ygm6fmz9.png)

共有 $3$ 种合法的“旋转”方向，分别对应图中左上（红色箭头）、左下（蓝色箭头）、正右（绿色箭头）三个方向，分别记做 $\tt U$、$\tt D$ 和 $\tt R$。

每次“旋转”操作选择该方向上含有一、三、五或七个字母的一行（或列），分别记做 `1`、`3`、`5`、`7`。 将不同的方向和行（或列）组合得到十二种合法的“旋转”操作，例如 `U1`、`D7`、`R3`。

“旋转”操作会将该行/列的所有字母向对应箭头方向循环移动一格，第一个字母变成第二个字母、第二个字母变成第三个字母……最后一个字母变成第一个字母，以此类推，例如：

![](https://cdn.luogu.com.cn/upload/image_hosting/agd4fc52.png)

如果我们将三角形魔方写成“字母三角形”的形式，那么初始状态就是：

```
   A
  BCD
 EFGHI
JKLMNOP
```

如果对初始状态进行两次 `U5` 旋转，将会得到：

```
   A
  GCD
 EMNHI
JKLBFOP
```

现在，你得到了一个魔方旋转机器人，它可以输入⼀个操作序列，然后将这个操作序列重复 $a^b$（$a$ 的 $b$ 次方，即 $a\times a\times \dots\times a$，共 $b$ 个 $a$ 相乘）次。但让机器人旋转魔方实在太耗时了。你能预测出从初始状态开始，执行完机器人的动作后魔方的状态吗？
## 输入格式

第一行输⼊一个字符串，代表了一个操作序列。

第二行输⼊两个整数 $a,b$，代表机器⼈会将操作序列重复 $a^b$ 次。
## 输出格式

输出 $16$ 个字符，为操作序列重复后的魔方的状态，按行依次输出所有字母，例如初始状态输出 `ABCDEFGHIJKLMNOP`。
## 样例

### 样例输入 #1
```
U3R5D7
5 2
```
### 样例输出 #1
```
EJLDHACBFKGIMNOP
```
### 样例输入 #2
```
U3U5U7
105 3
```
### 样例输出 #2
```
ABCDEFGHIJKLMNOP
```
### 样例输入 #3
```
R3R5R7U3U5U7D3D5D7D7
2 128
```
### 样例输出 #3
```
KBPDECGHIJFLMNOA
```
## 提示

对于 $50\%$ 的数据，$b=1$。

对于 $100\%$ 的数据，$1\leq a,b\leq 10^3$。操作序列中“旋转”操作的数量不超过 $100$。

>本题原始满分为 $20\text{pts}$。


---

---
title: "[信息与未来 2024] 图灵完备"
layout: "post"
diff: 普及+/提高
pid: B3981
tag: ['2024', '江苏', 'Special Judge', 'Ad-hoc', '信息与未来']
---
# [信息与未来 2024] 图灵完备
## 题目描述

![](https://cdn.luogu.com.cn/upload/image_hosting/88clj7mw.png)

（你不需要看懂这张图片；但如果你看懂了，会觉得它很有趣。）

JavaScript 是一种功能强大且灵活的编程语言，也是现代 Web 开发的三大支柱之一 (另外两个是 HTML 和 CSS)。灵活的 JavaScript 包含“自动类型转换”的语言特性。例如，JavaScript 认为`[]`（空数组）和 `0` 是可以比较且相等的。自动类型转换带来的一个后果是我们可以只用 `()+[]!` 这 $6$ 个字符编写任意功能的 JavaScript 程序，包括游戏和交互网页。

Dr. X 请你帮他为整数 $n$ 生成一段仅包含 `()+[]!` 字符的 JavaScript 代码,且代码的运行结果恰好为整数 $n$。解决这个题目不需要任何 JavaScript 语言知识。~~压缩包中提供了人工智能实现的 jsexplorer.html 小工具，双击打开可以运行 JavaScript 代码并检查运行结果。~~

~~搬题者注：我没有收到下发的压缩包。~~

搬题者注：感谢 @[Jorisy](/user/400269) 在机房电脑中找到了遗留的 jsexplorer.html。
## 输入格式

输入一个非负整数 $n$，为你需要构造的目标数字。
## 输出格式

输出一行一个 JavaScript 程序，且仅由 `()+[]!` 六个字符构成。在 jsexplorer.html 中执行它可以得到整数 $n$。本题答案不唯一，输出任意不超过 $5000$ 个字符的解即可。
## 样例

### 样例输入 #1
```
0
```
### 样例输出 #1
```
+[]
```
## 提示

对于 $60\%$ 的数据，有 $n \leq 1000$。

对于 $100\%$ 的数据，有 $0 \leq n \leq 10^9$。

输出超过 $5000$ 个字符将被判定为错误。~~注意源代码有  $100\text{KB}$ 的大小限制。~~

搬题者注：这里是洛谷。源代码有 $50\text{KB}$ 的限制。

>本题原始满分为 $15\text{pts}$。


---

---
title: "「HCOI-R1」孤独的 sxz"
layout: "post"
diff: 普及+/提高
pid: P10025
tag: ['洛谷原创', 'O2优化', '洛谷月赛']
---
# 「HCOI-R1」孤独的 sxz
## 题目背景

sxz 不擅长与人交往，于是他平常都喜欢找偏僻的地方坐着。今天，sxz 来到了食堂，他依旧想找一个偏僻的地方坐着，让他与其他所有人的曼哈顿距离之和最大。
## 题目描述

食堂的座位可以看成一个被划分为 $n\times m$ 的格子的矩形，长为 $n$，宽为 $m$，矩形内的每一个格子 $(i, j)(i \in [1, n], j \in [1, m])$ $(i,j$ 为整数$)$ 都是一个座位。

现在，食堂里已经有了 $k$ 个人，其中第 $i(1 \leq i \leq k)$ 个人坐在 $(x_i, y_i)$ 处。sxz 想要找到一个座位，使得该座位与 $k$ 个人的曼哈顿距离之和最大。请你帮他找到这个最大值，剩下的就交给 sxz 吧！

假设 sxz 坐在点 $(a,b)$，那么他和 $k$ 个人的曼哈顿距离之和是 $\sum_{i=1}^{k}|a-x_i|+|b-y_i|$。

**很显然，sxz 不能和 $\bm k$ 个人中的任何一个人坐在同一个地方**。
## 输入格式

第一行包含三个整数 $n, m, k$。

接下来 $k$ 行，第 $i$ 行两个整数描述 $x_i, y_i$。
## 输出格式


仅一行一个整数，描述这个值。注意它可能很大。
## 样例

### 样例输入 #1
```
2 5 3
1 1
1 3
1 4
```
### 样例输出 #1
```
10
```
### 样例输入 #2
```
7 4 9
1 4
2 3
4 1
6 2
7 1
5 2
3 4
1 1
7 4
```
### 样例输出 #2
```
38
```
## 提示

### 样例解释 1

最佳位置为 $(2,5)$，对于 $3$ 个人的曼哈顿距离分别为 $5, 3, 2$。

### 数据规模与约定

**本题采用捆绑测试。**
+ Subtask 0（15 pts）：$n, m \leq 100$。
+ Subtask 1（25 pts）：$n, m \leq 10000$。
+ Subtask 2（20 pts）：$k = 3$。
+ Subtask 3（40 pts）：无特殊限制。

对于所有数据，$1 \leq n, m \leq 10^9$，$1\leq k \leq \min\{4 \times 10^5, n\times m-1\}$，$1 \leq x_i \leq n$，$1 \leq y_i \leq m$，保证所有 $(x_i, y_i)$ 互不相同。


---

---
title: "「HCOI-R1」哀之变化"
layout: "post"
diff: 普及+/提高
pid: P10026
tag: ['洛谷原创', 'O2优化', '洛谷月赛']
---
# 「HCOI-R1」哀之变化
## 题目背景

哀喜欢数字。

她还喜欢变化。
## 题目描述

有一整数 $a$ 初始为 $1$。

哀想让 $a$ 进行恰好 $k$ 次变化，每次从以下两种变化中选择一个：

- $a\gets a - 1$；
- $a\gets a \times 2$。

哀很好奇，经过 **恰好** $k$ 次变化后 $a$ 能否变成 $n$。
## 输入格式

**本题有多组测试数据。**

第一行，一个正整数 $T$，表示测试数据组数。

接下来 $T$ 行，每行两个整数，依次为 $k$ 和 $n$，表示哀的一次询问。
## 输出格式

共 $T$ 行，对于每次询问，若 $a$ 可以变成 $n$，输出 `Yes`，否则输出 `No`。
## 样例

### 样例输入 #1
```
3
2 5
2 4
3 3
```
### 样例输出 #1
```
No
Yes
Yes
```
### 样例输入 #2
```
5
4 869
48 69
8 328
66 114514
168 1919810

```
### 样例输出 #2
```
No
Yes
No
Yes
Yes
```
## 提示

### 样例解释 1

+ 若 $k = 2$，$n = 5$，可以证明无解。
+ 若 $k = 2$，$n = 4$，一种可能的操作方式如下：
	+ 第一步，$a \gets a\times 2 = 2$；
	+ 第二步，$a \gets a\times 2 = 4$。
+ 若 $k = 3$，$n = 3$，一种可能的操作方式如下：
	+ 第一步，$a \gets a\times 2 = 2$；
	+ 第二步，$a \gets a\times 2 = 4$。
	+ 第三步，$a \gets a-1 = 3$。

### 数据规模与约定

**本题采用捆绑测试。**

+ Subtask 0（10 pts）：$T \leq 10$，$k \leq 15$。
+ Subtask 1（25 pts）：$n, k \leq 2\times 10^3$。
+ Subtask 2（65 pts）：无特殊限制。

对于所有数据，$1 \leq T \leq 10^5$，$0 \leq n, k \leq 10^{18}$。


---

---
title: "[GDKOI2024 普及组] 刷野 I"
layout: "post"
diff: 普及+/提高
pid: P10072
tag: ['2024', '广东', 'O2优化']
---
# [GDKOI2024 普及组] 刷野 I
## 题目描述

Zayin 是一个与怪物战斗的巫师，这次他将面临 $n$ 个站成一排的怪物，其中第 $i$ 个怪物的生命值是 $a_i$。

Zayin 率先使用一种攻击方式攻击，攻击过后所有血量小于等于 $0$ 的怪物死亡。在 Zayin 攻击一次后，所有存活的怪物对 Zayin 造成 $1$ 点伤害。以上步骤不断循环，直到 Zayin 击杀所有怪物为止。

Zayin 一共有三种攻击方式：

- 普通攻击: 消耗 $0$ 点能量值，选择一只怪物并使其血量减少一点。

- 天音波: 消耗 $1$ 点能量值，选择一只怪物并使其血量减少两点。

- 天雷破: 消耗 $1$ 点能量值，使所有怪物血量减少一点。

现在 Zayin 一共有 $m$ 点能量，现在他想知道在最优的策略下，击败 $n$ 只怪物所损失的最少血量。
## 输入格式

输入的第一行包含两个正整数 $n, m(1 \leq n, m \leq 10^5)$，$n$ 表示怪物的个数，$m$ 表示 Zayin 拥有的能量值。

输入的第二行包含 $n$ 个非负整数 $a_1, a_2, \dots, a_n(1 \leq a_i \leq 10^9)$，$a_i$ 表示第 $i$ 只怪物的血量。
## 输出格式

一行一个整数表示答案。
## 样例

### 样例输入 #1
```
3 4
2 4 4
```
### 样例输出 #1
```
6
```
## 提示

对于 $30\%$ 的数据，$1 \leq n, m \leq 5$。

对于另外 $15\%$ 的数据，$m = 0$。

对于另外 $15\%$ 的数据，所有 $a_i$ 全部相等。

对于 $100\%$ 的数据，$1 \leq n \leq 10^5$，$0 \leq m \leq 10^5$，$1 \leq a_i \leq 10^9$。


---

---
title: "[GDKOI2024 普及组] 读书"
layout: "post"
diff: 普及+/提高
pid: P10077
tag: ['2024', '广东', 'O2优化']
---
# [GDKOI2024 普及组] 读书
## 题目描述

Zayin 是一个热爱读书的学生。

最近，Zayin 收到了一本有 $n$ 个章节的书，其中每个章节 $i$ 都有一个限制：她必须至少阅读了其他 $a_i$ 个
章节，才能够获取足够的智慧来读懂该章节。

每天，Zayin 都会从头到尾开始阅读这本书。对于她还不能读懂的章节（由于限制）或是已经阅读过的章节，Zayin 会在那天跳过它们。

现在，Zayin 想要知道至少需要多少天才能阅读完所有的 $n$ 个章节。
## 输入格式

第一行包含两个整数 $d, n$，表示测试点编号和章节数。

第二行包含 $n$ 个整数 $a_i (0 \leq a_i < n)$，表示限制。
## 输出格式

输出一行包含一个整数，表示最少需要的天数。

如果 Zayin 无法阅读完所有的 $n$ 个章节，输出 $-1$。
## 样例

### 样例输入 #1
```
1 10
3 4 0 6 1 1 0 8 6 3
```
### 样例输出 #1
```
2
```
## 提示

**本题使用子任务捆绑测试。**

对于所有测试数据，保证 $1 \leq n \leq 5 \times 10^5
, 0 \leq a_i < n$。

- Subtask 1（10%）：$1 ≤ n ≤ 10$，$d = 1$。
- Subtask 2（10%）：$1 ≤ n ≤ 500$，$d = 2$。
- Subtask 3（20%）：$1 ≤ n ≤ 5000$，$3 \leq d \leq 4$。
- Subtask 4（20%）：$1 ≤ n ≤ 10^5$，$5 \leq d \leq 6$。
- Subtask 5（40%）：$1 ≤ n ≤ 5 \times 10^5$，$7 \leq d \leq 10$。


---

---
title: "[ROIR 2022] 网络系统升级计划 (Day 2)"
layout: "post"
diff: 普及+/提高
pid: P10092
tag: ['2022', 'Special Judge', 'ROIR（俄罗斯）']
---
# [ROIR 2022] 网络系统升级计划 (Day 2)
## 题目背景

翻译自 [ROIR 2022 D2T3](https://neerc.ifmo.ru/school/archive/2021-2022/ru-olymp-regional-2022-day2.pdf)。

某国有 $n$ 个城市，从 $1$ 到 $n$ 编号，首都编号为 $1$。

这个国家的计算机网络构建如下：每个城市都有一个连接中心，可以通过有线通信渠道与其他一些中心相连。对于任意两个城市之间存在着一条唯一的通信路径，换句话说，该网络形成一棵树。对于城市 $i(i > 1)$，我们把从城市 $i$ 到首都的路径上第一个城市记为 $p_i$。

计划对网络进行升级，用更先进的光学通信渠道替换一些现有有线渠道。光学通信渠道只能在现有有线通信渠道的位置上铺设。替换连接城市 $i$ 和 $p_i$ 的通信渠道的成本为 $w_i$。由于技术限制，任何连接中心最多可以直接连接到 $k$ 个其它中心。
## 题目描述

通信部希望制定一个升级计划，以提高光学通信渠道的其连通性。因此，需要选择尽可能多的通信渠道进行升级。但是，希望在相同数量的情况下尽量减少升级成本，因此，在相同数量的情况下，选择升级具有最小总成本的通信渠道。

帮助通信部专家选择要升级的通信渠道。
## 输入格式

输入的第一行包含两个整数 $n$ 和 $k$。

接下来的 $n−1$ 行描述了通信渠道，其中第 $i−1$ 行包含两个整数：$p_i$ 和 $w_i$（$1 \le p_i < i, 0 \le w_i \le 10^9$）。
## 输出格式

输出两个整数 $cnt$ 和 $cost$，表示能够升级的最大通信渠道数量和升级这些通信渠道的最小成本。
## 样例

### 样例输入 #1
```
8 2
1 0
1 0
1 0
2 0
2 0
2 0
1 0
```
### 样例输出 #1
```
4 0
```
### 样例输入 #2
```
8 3
1 5
1 2
1 4
2 6
2 7
2 2
1 6
```
### 样例输出 #2
```
6 27
```
## 提示

样例 $1$ 中的网络配置在升级前后如下图所示。需要升级的通信渠道以粗线表示。可以升级的最大通信渠道数量为 $4$。

![](https://cdn.luogu.com.cn/upload/image_hosting/wd46yiot.png)

样例 $2$ 中的网络配置在升级前后如下图所示。需要升级的通信渠道以粗线表示。可以升级的最大通信渠道数量为 $6$。升级通道的成本显示在边（通信渠道）的旁边，最优解决方案中升级通道的总成本为 $27$。

![](https://cdn.luogu.com.cn/upload/image_hosting/z2mnb3ul.png)

本题原题分为 $13$ 个 Subtask，但是洛谷不支持设置 $10$ 个以上的 Subtask。本题原题分为 $321$ 个测试点，但是洛谷不支持设置 $100$ 个以上的测试点。所以本题只保留后 $100$ 个测试点，且不使用捆绑测试。

所有数据均满足 $2 \le n \le 10^5, 1 \le k \le 100$。


---

---
title: "[LMXOI Round 1] Size"
layout: "post"
diff: 普及+/提高
pid: P10114
tag: ['O2优化']
---
# [LMXOI Round 1] Size
## 题目背景

在漆黑的夜晚，魔女带走了 LMX，HQZ 为了拯救 LMX。要完成魔女给出的任务。
## 题目描述

魔女给出一个长度为 $n$ 的序列 $d$，魔女想要求得：

$$\sum\limits_{i=1}^{ n}\sum\limits_{j=1}^{n}{((d_i\oplus d_j)+(d_i \otimes d_j))}$$

其中定义 $\oplus$ 代表二进制下两数相加的和数位上 $1$ 的个数， $\otimes$ 代表二进制下较大减较小的差数位上 $1$ 的个数。
## 输入格式

一行一个整数 $n$ 表示序列的长度。

第二行 $n$ 个非负整数，表示序列 $d$。
## 输出格式

一行一个整数表示答案。
## 样例

### 样例输入 #1
```
2
1 3 
```
### 样例输出 #1
```
7
```
### 样例输入 #2
```
10
114514 19 19 810 1477 44151 15260 369 2010 222
```
### 样例输出 #2
```
1396
```
## 提示

**样例解释 #1**

如下表所示，因此答案为 $1 + 2 + 2 + 2 = 7$。
| $i$ | $j$ | $ans$ |
| :-----: | :-----: | :-------: |
| $1$ | $1$ | $1$ |
| $1$ | $2$ | $2$ |
| $2$ | $1$ | $2$ |
| $2$ | $2$ | $2$ |


对于 $100 \%$ 的数据，保证 $1 \le n\le 2\times 10^6,\sum\limits d_i\le5\times10^7$。 
| 子任务编号 |     $n$     |          特殊性质          | 分值 |
| :--------: | :------------------: | :-------------------------: | :--: |
| Subtask #1 |     $\le 2\times10^6 $     |   $d_i =1$       |  $10$  |
| Subtask #2 |     $\le 5000$     |      无      |  $20$  |
| Subtask #3 | $\le 2\times 10^6$ | $d_i$ 是 $2$ 的次幂 |  $30$  |
| Subtask #4 | $\le 2\times 10^6$ |      无      |  $40$  |


---

---
title: "[DTCPC 2024] Ultra"
layout: "post"
diff: 普及+/提高
pid: P10160
tag: ['2024', '洛谷月赛']
---
# [DTCPC 2024] Ultra
## 题目背景

Tony2 喜欢玩某二字游戏，这一天他在小 C 面前展示他的 $\text{Ultra}$。

但是小 C 不会 $\text{Ultra}$，所以他跑去图图酱一去了。

~~然后图图失败了~~

于是小 C 趁 Tony2 不在的时候偷偷地把他的跳跃键和下冲键交换了（
## 题目描述

Tony2 的操作可以看作下冲和跳跃的组合。

称一个 $\text{Ultra}$ 为一段连续的操作，以下冲开头，然后跳跃和下冲交替，并以下冲结束。由于是 $\text{Ultra}$，所以至少要有一次跳跃。

小 C 每次可以将一个 $\text{Ultra}$ 变成 $\text{uLTRA}$，也就是将这个 $\text{Ultra}$ 的每个下冲变成跳跃，将每个跳跃变成下冲。

小 C 不喜欢 $\text{Ultra}$，所以想要使得下冲次数尽量少。

**形式化题意**

给你一个 $01$ 序列，你可以进行如下操作若干次（或零次）:

- 将序列中形如 $101\cdots01$ 的一个子串（即 $1(01)^k$，$k\ge 1$）替换成**等长**的 $010\cdots10$（即 $0(10)^k$）。

你要操作使得 $1$ 的个数尽可能少，输出最少的 $1$ 的个数。
## 输入格式

一行一个长度为 $n$（$n\le 10^6$） 的字符串表示这个 $01$ 序列。
## 输出格式

输出一个数表示最少的 $1$ 的个数。
## 样例

### 样例输入 #1
```
1010011
```
### 样例输出 #1
```
3
```
## 提示

样例 $1$ 解释：选中该串的前三个字符 $101$，对其操作后该串变为 $0100011$，仅包含 $3$ 个 $1$。容易证明这是最优的。


---

---
title: "水影若深蓝"
layout: "post"
diff: 普及+/提高
pid: P10179
tag: ['洛谷原创', 'Special Judge', 'O2优化', '洛谷月赛']
---
# 水影若深蓝
## 题目背景

![](https://cdn.luogu.com.cn/upload/image_hosting/e2h3lfb4.png)

帆帆爱明日方舟，更爱水月和深蓝之树。但在龙年，他想构建一棵独属于他的深蓝之树。
## 题目描述

在梦里，在朦胧的水影中，帆帆看见了这棵只属于他的深蓝之树。

当一切梦沉寂，他却遗忘了所有，只记得树上有 $n$ 个结点。

真的吗？似乎并没有，有 $m$ 件事情他一直牢记着，第 $i$ 件事情是：节点 $u_i$ 和 $v_i$ 在这棵深蓝之树上唯一的不重复经过某个点的路径恰好有两条边。

那么，你能否帮助帆帆想起来这棵深蓝之树的样子呢，如果有多个可能的，你只需要输出任意一种。

当然，帆帆也是会磨损的，因此当你发现无论如何都找不到满足帆帆这 $m$ 件事情的深蓝之树时，你需要报告无解。

## 输入格式

**本题有多组数据**。

第一行一个正整数 $T$ 表示数据组数。

对于每组数据：

第一行两个非负整数 $n,m$ 表示树上的点数和帆帆记忆中事件个数。

接下来 $m$ 行，每行两个正整数 $u_i,v_i$ 表示一个事件。
## 输出格式

对于每组数据：

- 若不存在符合条件的树，输出 `No`。
- 否则，第一行输出 `Yes`，接下来 $n-1$ 行输出 $n-1$ 对正整数 $(u,v)$，表示你给出的树上的 $n-1$ 条边。

本题采用 `special judge` 评测，也就是说，如果有多种可能的答案，你可以输出任意一种。
## 样例

### 样例输入 #1
```
2
4 2
1 2
3 4
3 3
1 2
2 3
3 1
```
### 样例输出 #1
```
Yes
1 3
2 4
2 3
No
```
## 提示

### 样例 $1$ 解释

对于第一组数据，不难验证给出的树符合条件。

对于第二组数据，可以证明不存在符合条件的树。

### 测试点约束

对于 $100\%$ 的数据，$1\le T\le 10^5$，$n\ge 2$，$m\ge 0$，$1\le \sum n\le 3\times 10^5$，$0\le \sum m\le 3\times 10^5$，$1\le u_i,v_i\le n$，$u_i\neq v_i$。

本题采用捆绑测试。

| 子任务编号 | 特殊限制 | 分值 |
| :--------: | :-------------: | :--: |
| Subtask #1 |     $\sum n,\sum m\le 9$     | $10$ |
| Subtask #2 |    $\sum n,\sum m\le 50$     | $10$ |
| Subtask #3 |    $\sum n,\sum m\le 5000$    | $10$ |
| Subtask #4 |   $v_i=u_i+1$    | $10$ |
| Subtask #5 |   $u_i=1$    | $10$ |
| Subtask #6 |   $u_i\neq 1,v_i\neq 1$    | $10$ |
| Subtask #7 |   $T=1$    | $10$ |
| Subtask #8 |   无    | $30$ |




---

---
title: "[COCI 2023/2024 #4] Roboti"
layout: "post"
diff: 普及+/提高
pid: P10232
tag: ['2023', 'COCI（克罗地亚）']
---
# [COCI 2023/2024 #4] Roboti
## 题目背景

**译自 [COCI 2023/2024 Contest #4](https://hsin.hr/coci/archive/2023_2024) T5「[Roboti](https://hsin.hr/coci/archive/2023_2024/contest4_tasks.pdf)」**
## 题目描述

Kile 是一个桌游爱好者，他最近发现了一个叫做 Robots 的游戏。这个游戏由一个 $n$ 行 $m$ 列的网格和一个机器人组成。位置 $(1, 1)$ 是棋盘的左上角，位置 $(n, m)$ 是右下角。

开始时，机器人位于某个位置 $(x, y)$（第 $x$ 行，第 $y$ 列），玩家可以将其朝上下左右之一的方向进行移动。根据选择的方向，它将沿着该方向移动，直到到达目标格或网格中的特殊格。如果在任何时候机器人想要离开棋盘，它将翻折到另一侧。例如，如果它位于位置 $(n, 3)$ 并希望向下移动，它将到达位置 $(1, 3)$。

棋盘上有三种类型的位置：

- 空格：机器人朝相同的方向继续移动；
- 左转格：当机器人进入此格时，它会左转 $90$ 度并继续移动；
- 右转格：当机器人进入此格时，它会右转 $90$ 度并继续移动。

网格中大部分位置都是空格，只有 $k$ 个位置是左转或右转格。

游戏由 $q$ 轮组成。在第 $i$ 轮中，机器人将被放置在位置 $(a_i, b_i)$。目标是使用最少的转弯次数到达位置 $(c_i, d_i)$，或判定这是不可能的。

在多次玩这个游戏后，Kile 意识到它比起初看起来要更具挑战性。这就是为什么他现在需要你的帮助。帮助他确定每一轮游戏所需的最小转弯次数！

**注意**：如果机器人路径的起点或终点位于左转或右转格上，则该格不起作用。
## 输入格式

第一行包含三个整数 $n,m,k\ (1\le n,m\le 10^6,0\le k\le 10^5)$，分别表示行数，列数和网格中非空格的个数。

接下来 $k$ 行，每行两个整数 $x_i,y_i\ (1\le x_i\le n,1\le y_i\le m)$ 和一个字符 $s_i\ (s_i\in \{\texttt{L},\texttt{R}\})$，分别表示第 $i$ 个特殊格的位置和类别。如果 $s_i$ 是 `L`，则表示这是一个左转格。如果是 `R`，则表示这是一个右转格。

接下来一行一个整数 $q\ (1\le q\le 3\cdot 10^5)$，表示游戏轮数。

接下来 $q$ 行，每行四个整数 $a_i,b_i,c_i,d_i\ (1\le a_i,c_i\le n,1\le b_i,d_i\le m)$，分别表示起始和目标位置。
## 输出格式

输出 $q$ 行，第 $i$ 行输出第 $i$ 轮所需的最小转弯次数，如果无法到达目标，则输出 $-1$。
## 样例

### 样例输入 #1
```
2 2 2
1 1 L
2 2 R
5
1 1 2 2
2 1 1 2
1 1 1 2
2 1 1 1
2 2 2 1

```
### 样例输出 #1
```
-1
1
0
0
0

```
### 样例输入 #2
```
3 3 4
1 1 L
1 3 L
2 1 L
3 3 L
7
1 1 3 3
3 3 2 1
3 1 2 2
2 3 1 2
2 3 3 1
1 2 3 2
3 3 2 2

```
### 样例输出 #2
```
1
2
1
1
1
0
3

```
### 样例输入 #3
```
4 4 8
1 1 R
1 3 L
2 2 R
2 4 L
3 1 L
3 3 L
4 2 L
4 4 L
7
1 2 1 4
2 2 3 4
4 4 3 2
4 1 4 4
4 2 3 1
1 2 2 3
2 4 2 3

```
### 样例输出 #3
```
2
1
1
0
-1
5
0

```
## 提示

### 样例解释 2

第一轮：从 $(1, 1)$ 开始。如果初始机器人向左移动，它将在下一步到达 $(1, 3)$，因为它想要离开棋盘，所以会从另一侧进入。位置 $(1, 3)$ 是一个左转格，所以机器人将朝下方向移动。再经过两步，它将到达目标位置 $(3, 3)$​。

第二轮：从 $(3, 3)$ 开始。如果初始机器人向上移动，它将在两步后到达 $(1, 3)$，在那里由于左转格而向左转。再经过两步，它将到达位置 $(1, 1)$，这也是一个左转格，所以它将向下移动。在下一步中，它将到达目标位置 $(2, 1)$。

### 子任务

| 子任务编号 |       附加限制       | 分值 |
| :--------: | :------------------: | :--: |
|    $1$     |        $k=0$         | $10$  |
|    $2$     | $n,m\le 300,q\le 10$ | $13$ |
|    $3$     |     $n,m\le 300$     | $49$ |
|    $4$     |      无附加限制      | $38$ |


---

---
title: "[GESP样题 八级] 小杨的旅游"
layout: "post"
diff: 普及+/提高
pid: P10289
tag: ['GESP']
---
# [GESP样题 八级] 小杨的旅游
## 题目描述

小杨准备前往 B 国旅游。

B 国有 $n$ 座城市，这 $n$ 座城市依次以 $1$ 至 $n$ 编号。城市之间由 $n-1$ 条双向道路连接，任意两座城市之间均可达（即任意两座城市之间存在可达的路径）。

小杨可以通过双向道路在城市之间移动，通过一条双向道路需要 $1$ 单位时间。

B 国城市中有 $k$ 座城市设有传送门。设有传送门的城市的编号依次为 $b_1,b_2, \cdots ,b_k$。小杨可以从任意一座设有传送门的城市花费 $0$ 单位时间前往另一座设有传送门的城市。

注：如果两座设有传送门的城市之间存在双向道路，那么小杨可以选择通过双向道路移动，也可以选择通过传送门传送。

小杨计划在 B 国旅游 $q$ 次。第 $i$ 次旅游（$1 \le i \le q$），⼩杨计划从编号为 $u_i$ 的城市前往编号为 $v_i$ 的城市，小杨希望你能求出所需要的最短时间。
## 输入格式

第一行包含三个正整数 $n,k,q$，分别表示 B 国的城市数量，设有传送门的城市数量，以及小杨计划在 B 国旅游的次数。  
接下来 $n-1$ 行，每行包含两个正整数 $x_i, y_i$，表示一条双向道路连接的两座城市的编号。  
第 $n + 1$ 行包含 $k$ 个正整数，表示设有传送门的城市的编号。  
接下来 $q$ 行，每行包含两个正整数 $u_i,v_i$，表示小杨第 $i$ 次旅游行程的起点城市编号与终点城市编号。
## 输出格式

输出共 $q$ 行。第 $i$ 行（$1 \leq i \leq q$）输出一个非负整数，表示小杨计划第 $i$ 次旅游从编号为 $u_i$ 的城市前往编号为 $v_i$ 的城市所需要的最短时间。
## 样例

### 样例输入 #1
```
7 2 1
5 7
3 6
2 3
1 5
5 4
1 2
7 4
3 7

```
### 样例输出 #1
```
4
```
### 样例输入 #2
```
5 0 3
2 3
5 1
5 2
1 4
4 5
1 4
4 3

```
### 样例输出 #2
```
2
1
4
```
## 提示

| 子任务 | 分值 | $n \leq $ | $ k \leq $ | $q \leq $ |
|:-: | :-: | :-: | :-: | :-:|
| $1$ | $30$ | $500$ | $500$ | $1$ |
| $2$ | $30$ | $2 \times 10^5$ | $0$ | $2 \times 10^5$ |
| $3$ | $40$ | $2 \times 10^5$ | $2 \times 10^5$ | $2 \times 10^5$ |

对全部的测试数据，$1 \leq n \leq 2 \times 10^5$，$0 \leq k \leq n$，$1 \leq x_i, y_i, u_i, v_i \leq n$，$u_i \neq v_i$。


---

---
title: "[PA 2024] Alchemik Bajtazar"
layout: "post"
diff: 普及+/提高
pid: P10354
tag: ['2024', 'PA（波兰）']
---
# [PA 2024] Alchemik Bajtazar
## 题目背景

PA 2024 2B
## 题目描述

**题目译自 [PA 2024](https://sio2.mimuw.edu.pl/c/pa-2024-1/dashboard/) Runda 2 [Alchemik Bajtazar](https://sio2.mimuw.edu.pl/c/pa-2024-1/p/alc/)**

Byteasar 是一位著名的炼金术士，为了解决材料的嬗变问题，他暂时放下了制造贤者石的尝试。具体来说，Byteasar 想把一种分子转化成另一种。Byteasar 所拥有的分子由 $n$ 个 bytonium 原子组成（在 Byteotia，bytonium 是最常用的化学元素之一，主要用于生产食品和隐形眼镜），这些原子从 $1$ 到 $n$ 编号。某些原子对之间可能存在键，但每对原子之间最多只有一个键。这些分子形成了一个连贯的整体——从每个原子出发，通过一个或多个键就可以到达其他任何原子。

Byteasar 描述了他希望得到的 $n$ 个原子的分子中的键——对于每一对原子，他都知道是否希望它们最终由键连接。目标分子满足同样的条件——它形成一个连贯的整体，每对原子最多由一个键连接。不幸的是，Byteasar 的分子可能与目标分子不同。为了解决这个问题，他可以使用自己的炼金术能力。他可以随时进行两种可能的操作之一：

- Byteasar 可以选择没有键连接的两个不同原子 $a$ 和 $b$，并在它们之间形成键。由于 bytonium 的高度不稳定性，只有当前存在与 $a$ 和 $b$ 都成键的原子 $c$（不同于 $a$ 和 $b$），他才可以这样做。
- Byteasar 可以选择通过键连接的两个不同原子 $a$ 和 $b$，并移除连接它们的键。出于类似的原因，只有当前存在与 $a$ 和 $b$ 都成键的原子 $c$（不同于 $a$ 和 $b$），他才可以这样做。

Byteasar 不想在转化上花费太多时间。请编写一个程序，帮助他将自己的分子转化为目标分子，并在最多 $200\, 000$ 次操作中完成。

注意：原子两两不同，可以区分。
## 输入格式

第一行一个整数 $n\ (2\le n\le 30\,000)$，表示 Byteasar 拥有的分子和目标分子中原子的个数。

第二行一个整数 $m_s\ (n-1 \le m_s \le 50\, 000)$，表示 Byteasar 拥有的分子中的键数。

接下来 $m_s$ 行，每行两个整数。其中第 $i$ 行的整数 $a_i$ 和 $b_i\ (1 \le a_i , b_i \le n, a_i \neq b_i)$ 表示通过键连接的原子编号。可以保证 Byteasar 的分子是一个连贯的整体，并且每两个原子最多只通过一个键相连。

接下来一行一个整数 $m_d\ (n-1\le m_d\le 50\,000)$，表示目标分子中的键数。

接下来 $m_d$ 行包含对这些键的描述，格式与目前已拥有的分子相同。
## 输出格式

输出第一行包含总操作数 $r$。必须保证 $0\le r\le 200\,000$。

接下来每行包含对操作的描述。 如果你想在第 $i$ 次移动中连接原子 $x_i$ 和 $y_i$，第 $i$ 行应该以 `+` 号开头，在一个空格之后输出编号 $x_i$ 和 $y_i$，也用一个空格分隔。 相反，如果想删除连接 $x_i$ 和 $y_i$ 原子的键，则该行应以 `-` 开头，然后类似地，输出编号 $x_i$ 和 $y_i$。

输出的操作序列必须满足题目描述中给出的条件——当选择原子 $x_i$ 和 $y_i$ 时，必须有另一个原子与它们连接。执行一系列动作后，最终的分子必须与目标分子相同，即对于每对原子 $i, j\ (1 \le i < j \le n)$，如果编号为 $i$ 和 $j$ 的原子在目标分子中被一条键连接，最终状态中这对原子也应该被一条键连接。

注意，你不必最小化移动次数，你只需要最多进行 $200\,000$ 次操作即可。可以证明，总可以进行不超过 $200\,000$ 次操作来实现转化。
## 样例

### 样例输入 #1
```
4
3
1 2
3 4
3 2
4
1 4
1 2
2 3
3 4

```
### 样例输出 #1
```
3
+ 1 3
+ 1 4
- 3 1

```
## 提示

请注意，Byteasar 无法立即连接第一个原子与第四个原子，因为当时没有原子与它们两个相连。通过在第一个和第三个原子之间建立临时键，Byteasar 就使该原子成为了第三个原子。


---

---
title: "[PA 2024] Łamigłówka 3"
layout: "post"
diff: 普及+/提高
pid: P10361
tag: ['2024', 'PA（波兰）']
---
# [PA 2024] Łamigłówka 3
## 题目背景

PA 2024 4C
## 题目描述

**题目译自 [PA 2024](https://sio2.mimuw.edu.pl/c/pa-2024-1/dashboard/) Runda 4 [Łamigłówka 3](https://sio2.mimuw.edu.pl/c/pa-2024-1/p/lam/)**

Bytie 喜欢玩手机游戏。然而让他感到恼火的是游戏中经常有其他游戏的广告，并且其中玩游戏的人表现得非常糟糕，广告这样做的目的是让看广告的人感到沮丧，从而产生玩下去的欲望。Bytie 对其中一个广告印象尤为深刻（你可能也看过）。

![lam1.png](https://img.loj.ac.cn/2024/03/24/d2a22d1aa2488.png)

由于可以从任何事物中汲取灵感，Bytie 决定在上述游戏的基础上出道题。他将选择一块大小为 $n\times m$ 的目标图案，游戏在一块 $n\times m$ 的网格上进行，其中没有任何区域被染色。在一次操作中，他可以选择一行或一列，并将这一行（或列）中的**所有方格**（注意，这比上面图片中的游戏更自由，因为在上面的游戏中，重复涂色同一单元格时颜色会混合）重新涂成自己选择的颜色。为了使题目更形式化，他还用大写英文字母标注了所有颜色。你能帮他写一个程序，对于他给出的每个网格，给出正确得到目标图案的操作顺序吗？你可以假设输入中最多可以用 $n+m$ 步操作得到目标图案。
## 输入格式

第一行两个整数 $n$ 和 $m\ (1\le n,m\le 2\,000)$，分别表示网格的行数和列数。

接下来 $n$ 行，每行一个长为 $m$ 的字符串。字符串由大写字母组成，第 $i$ 个字符串的第 $j$ 个字符表示目标图案中第 $i$ 行第 $j$ 列单元格的颜色。

保证给定的目标图案可以通过最多 $n+m$ 次染色操作得到。
## 输出格式

输出第一行包含一个整数 $r\ (1\le r\le n+m)$，表示要进行的操作次数。接下来 $r$ 行描述操作。

为了描述一次操作，首先应输出 `R` 或者 `K`，表示你希望对某行还是某列重新涂色（`R` 表示对某行重新涂色，`K` 表示对某列重新涂色）。接下来空一格，输出你希望重新涂色的行或列的编号，行按从上到下的顺序从 $1$ 到 $n$ 编号，列按从左到右的顺序从 $1$ 到 $m$ 编号。然后再空一格，输出一个大写英文字母，表示你希望对这行或这列重新涂成的颜色。

注意你不需要最小化操作次数——只需要最多操作 $n+m$ 次即可。
## 样例

### 样例输入 #1
```
5 5
AAPAA
APPAA
AAPAA
AAPAA
APPPA

```
### 样例输出 #1
```
10
R 1 Z
K 4 A
K 2 P
R 5 P
R 4 A
R 3 A
R 1 A
K 5 A
K 3 P
K 1 A

```
### 样例输入 #2
```
2 3
AAA
PPP

```
### 样例输出 #2
```
2
R 2 P
R 1 A

```
## 提示

假设 `P` 代表绿色，`A` 代表黄色，`Z` 代表蓝色。样例 1 中的操作序列如下图所示：

![lam2.png](https://img.loj.ac.cn/2024/03/24/7f9371fee9091.png)


---

---
title: "「ALFR Round 1」D 小山的元力"
layout: "post"
diff: 普及+/提高
pid: P10380
tag: ['O2优化']
---
# 「ALFR Round 1」D 小山的元力
## 题目描述

小山有 $n$ 个相同的元素，他想将这 $n$ 个元素分为 $m$ 堆，显然有很多种分法。对于每种分法，定义 $a_i$ 为第 $i$ 堆的元素数量，$b_i=i!\times a_i$（其中 $i!$ 表示 $i$ 的阶乘），以及 $c=\sum\limits_{i=1}^mb_i$。而小山的元力为所有分法的 $c$ 值之和。小山想知道他的元力是多少，由于答案可能很大，所以最终答案应对 $p$ 取模（保证 $p$ 为质数）。
## 输入格式

一行三个整数 $n,m,p$，含义见**题目描述**。
## 输出格式

一个数表示小山的元力。
## 样例

### 样例输入 #1
```
3 2 37
```
### 样例输出 #1
```
18
```
## 提示

### 样例解释

将 $3$ 个元素分为 $2$ 堆的方案为：

1. `0 3`
2. `1 2`
3. `2 1`
4. `3 0`

小山的元力为：$(1!\times0+2!\times3)+(1!\times1+2!\times2)+(1!\times2+2!\times1)+(1!\times3+2!\times0)=18$。

### 数据范围
| 子任务 | 分值 | 限制 |
| :----------: | :----------: | :----------: |
| $0$ | $20$ | $n,m\le5$ |
| $1$ | $80$ | - |

对于 $100\%$ 的数据，$1\le n,m\le10^6$，$1\le p\le10^7$。


---

---
title: "接连不断！"
layout: "post"
diff: 普及+/提高
pid: P10394
tag: ['2024', '洛谷原创', 'O2优化', '洛谷月赛']
---
# 接连不断！
## 题目背景

小青蛙被关进了监狱的小黑屋里，他遭受了接连不断的折磨，无论是肉体上还是精神上。

他的精神萎靡不振，他的身体行动迟缓。

有些东西被暂时的压制了，但这些东西越是被压制，它反弹时威力就越大。

他需要一个契机。
## 题目描述

青蛙有 $m+1$ 个无向图，编号为 $0\sim m$。每个图的点集都是 $V$，点集 $V$ 包含 $n$ 个点，编号为 $0\sim n-1$。起初所有的图都没有边存在。

接下来，在编号为 $x$ 的图中，对于所有在 $[0, n - 1]$ 中的编号 $i$，青蛙会将编号为 $i$ 的点与编号为 $(i\cdot x)\bmod n$ 的点连一条无向边。

他想知道这 $m+1$ 个图中有多少个图是**连通的**，这个问题交给你来回答。

注：
1. $\bmod$ 表示取模，$a\bmod b$ 表示 $a$ 除以 $b$ 得到的余数。
2. 在一张图中，若在点集内任意两个不同的点 $x, y$ 之间存在至少一条路径，则我们称这个图是**连通的**。
## 输入格式

**本题有多组数据**。

第一行一个整数 $T$，表示数据组数。

接下来 $T$ 行，每行两个整数 $n,m$，含义同上。
## 输出格式

共 $T$ 行，每行一个整数表示答案。
## 样例

### 样例输入 #1
```
3
3 2
4 4
5 5
```
### 样例输出 #1
```
1
3
2

```
### 样例输入 #2
```
5
4 3
4 4
4 5
4 6
4 7
```
### 样例输出 #2
```
2
3
3
4
4

```
### 样例输入 #3
```
3
1145 1499
12344 123456
114514 1919810
```
### 样例输出 #3
```
2
41
17
```
## 提示

**【样例 #1 解释】**

询问 1：

| 图的编号 | 边集 | 图是否连通 |
| :------: | :-----------------: | :--------: |
|   $0$    | $(0,0),(1,0),(2,0)$ |     是     |
|   $1$    | $(0,0),(1,1),(2,2)$ |     否     |
|   $2$    | $(0,0),(1,2),(2,1)$ |     否     |

询问 2：

| 图的编号 |    边集    | 图是否连通 |
| :------: | :-----------------------: | :--------: |
|   $0$    | $(0,0),(1,0),(2,0),(3,0)$ |     是     |
|   $1$    | $(0,0),(1,1),(2,2),(3,3)$ |     否     |
|   $2$    | $(0,0),(1,2),(2,0),(3,2)$ |     是     |
|   $3$    | $(0,0),(1,3),(2,2),(3,1)$ |     否     |
|   $4$    | $(0,0),(1,0),(2,0),(3,0)$ |     是     |

询问 3：

| 图的编号 |   边集    | 图是否连通 |
| :------: | :-----------------------: | :--------: |
|   $0$    | $(0,0),(1,0),(2,0),(3,0),(4,0)$ |     是     |
|   $1$    | $(0,0),(1,1),(2,2),(3,3),(4,4)$ |     否     |
|   $2$    | $(0,0),(1,2),(2,4),(3,1),(4,3)$ |     否     |
|   $3$    | $(0,0),(1,3),(2,1),(3,4),(4,2)$ |     否     |
|   $4$    | $(0,0),(1,4),(2,3),(3,2),(4,1)$ |     否     |
|   $5$    | $(0,0),(1,0),(2,0),(3,0),(4,0)$ |     是     |

所以答案分别为 $1, 3, 2$。

---

**【数据规模与约定】**

**本题开启捆绑测试。**

| $\text{Subtask}$ | 数据范围 | 分数 |
| :---: | :---: | :---: |
| $1$ | $n,m\le 200$ | $15$ |
| $2$ | $n,m\le 3000$ | $30$ |
| $3$ | $n,m\le 10^7$ | $15$ |
| $4$ | $n\le 3000,m \le10^{14}$ | $15$ |
| $5$ | $n,m\le 10^{14}$ | $25$ |

- 对于 $100\%$ 的数据，保证 $1\le T\le 5,1\le n,m\le 10^{14}$。



---

---
title: "[蓝桥杯 2023 国 A] 相连的边"
layout: "post"
diff: 普及+/提高
pid: P10418
tag: ['2023', '蓝桥杯国赛']
---
# [蓝桥杯 2023 国 A] 相连的边
## 题目描述

给定一棵包含 $n$ 个结点的树，找出 $3$ 条边使得这三条边的端点仅经过这三条边即可互相到达且三条边的长度和尽可能大。
## 输入格式

输入第一行包含一个整数 $n$ 表示树的结点数。

接下来 $n−1$ 行，每行包含两个整数，用一个空格分隔。其中第 $i$ 行的两个数 $x_i,y_i$，表示编号为 $i+1$ 和 $x_i$ 的结点之间有一条长度为 $y_i$ 的边。
## 输出格式

输出一行，包含一个整数表示满足要求的三条边的长度之和的最大值。
## 样例

### 样例输入 #1
```
5
1 1
2 1
3 7
1 10

```
### 样例输出 #1
```
12

```
## 提示

**【样例解释 1】**

结点 $2$ 和结点 $1$ 的边长为 $1$，结点 $3$ 和结点 $2$ 的边长为 $1$，结点 $4$ 和结点 $3$ 的边长为 $7$，结点 $5$ 和结点 $1$ 的边长为 $10$。

**【评测用例规模与约定】**

对于 $20\%$ 的评测用例，$4\le n\le 300$；  
对于 $40\%$ 的评测用例，$4\le n\le 5000$；  
对于所有评测用例，$4\le n\le 2\times 10^5$，$1\le x_i<i$，$1\le y_i\le 10^9$。


---

---
title: "[XJTUPC 2024] 命令行"
layout: "post"
diff: 普及+/提高
pid: P10526
tag: ['2024', 'O2优化', '高校校赛']
---
# [XJTUPC 2024] 命令行
## 题目描述

有 $n$ 个两两互不相同的仅由小写字符构成的命令字符串 $t_i$ ($1 \leq i \leq n$)，你需要实现一个支持命令补全的命令行。

你的输入区是一个字符串 $s$，他可以接受小写字母 $\text{'a'-'z'}$ 和 $\text{Tab}$ 键 (以 $\text{'T'}$ 表示)，$\text{Enter}$ 键 (以 $\text{'E'}$ 表示)，$\text{Backspace}$ 键 (以 $\text{'B'}$ 表示)。规则如下所述:

1. 当你接受小写字符 $c$，将把 $c$ 追加到输入区字符串 $s$ 的末尾。

1. 当你接受 $\text{Backspace}$ 键，将尝试删除最后一个字符:
   - 如果输入区字符串 $s$ 为空，则不进行任何操作。
   - 如果输入区字符串 $s$ 非空，则丢弃 $s$ 末尾的字符。
1. 当你接受 $\text{Tab}$ 键，将会对 $s$ 进行一次智能补全，补全规则如下: 
	- 设以 $s$ 为前缀的命令字符串集合为 $T$。
   - 如果 $T$ 为空，则不进行任何操作。
   - 如果 $T$ 非空，则把 $s$ 置为 $\text{lcp}(T)$。这里 $\text{lcp}$ 代表最长公共前缀，含义是最长的，是 $T$ 中每一个字符串前缀的字符串。

1. 当你接受 $\text{Enter}$ 键，将会试图执行命令 $s$: 
	- 如果存在命令字符串 $t_i = s$，则输出命令编号 $i$。
   - 如果不存在命令字符串 $t_i = s$，则输出 $-1$。
   - 无论是否执行成功，清空输入区 $s$。
   
给定你接受到的输入串 $p$，你需要输出每个 $\text{Enter}$ 键执行的结果。
## 输入格式

输入第一行为两个整数 $n$ 和 $m$ ($1 \leq n \leq 10^5, 1 \leq m \leq 5 \times 10^6$)，为命令字符串的个数和输入串的长度，由空格隔开。

接下来 $n$ 行，每行一个仅由小写字符构成的字符串 $t_i$，为命令串。保证有 $\sum_{i=1}^{n} |t_i| \leq 10^6$ 且命令串互不相同。

最后一行为字符串 $p$ ($|p|=m$)，为输入串。保证 $p$ 仅由 $\text{\{'a'-'z', 'T', 'B', 'E'\}}$ 组成。
## 输出格式

给定你接受到的输入串 $p$，你需要输出每个 $\text{Enter}$ 键执行的结果。
## 样例

### 样例输入 #1
```
7 40
kill
killall
rm
rmdir
ifconfig
ifdown
ll
kTBlEkTaTEiTcBdTElTExjtuTExjtuBBBBBrTdTE

```
### 样例输出 #1
```
1 2 6 7 -1 4 
```
## 提示

初始时，输入区字符串$s=""$。

输入 $\text{'k'}$ 后，输入区字符串$s="k"$。

输入 $\text{'T'}$ 后，进行智能匹配。此时 $T=\{"kill","killall"\}$，$\text{lcp}(T)="kill"$。故输入区字符串$s="kill"$。

输入 $\text{'B'}$ 后，输入区字符串$s="kil"$。

输入 $\text{'l'}$ 后，输入区字符串$s="kill"$。

输入 $\text{'E'}$ 后，因为 $t_1=s$，所以应该输出 $1$。


---

---
title: "[XJTUPC 2024] 崩坏：星穹铁道"
layout: "post"
diff: 普及+/提高
pid: P10528
tag: ['2024', 'O2优化', '高校校赛']
---
# [XJTUPC 2024] 崩坏：星穹铁道
## 题目背景

![](https://cdn.luogu.com.cn/upload/image_hosting/7urblttd.png)

Corycle 喜欢玩一个由米哈游自主研发的一款回合制战斗游戏------《崩坏：星穹铁道》。这片银河中有名为「星神」的存在，他们造就现实，抹消星辰，在无数「世界」中留下他们的痕迹。你将由此探索新的文明，结识新的伙伴，在无数光怪陆离的「世界」与「世界」之间展开新的冒险。所有你想知道的，都将在群星中找到答案。

## 题目描述

在游戏《崩坏：星穹铁道》中，你的队伍里会有四名角色轮流行动，所有角色共享用于施放战技的战技点。当战斗开始时，你会获得 $k$ 个战技点，且战技点的上限为 $5$ 个。每个角色行动时可选择进行普通攻击或者施放战技，进行普通攻击时会为全队增加一个战技点，当战技点达到上限时也可以进行普通攻击，但是此时不回复战技点。角色施放战技需要消耗一个战技点，当没有战技点时只能进行普通攻击而不可释放技能。

Corycle 想成为星穹铁道高手，为此他需要对自己的配队了如指掌。由于角色有多种职业，同时为了方便对角色类型进行定位，他把角色的行动模式分为了三种类型：

1. 当角色行动时，只会进行普通攻击。

2. 当角色行动时，若有战技点不少于 $1$ 则必定释放技能，否则进行普通攻击。

3. 不对角色的行动进行限制。

现在 Corycle 开始了一场战斗，他想知道当队伍中的四名角色一共行动 $n$ 次时，可能会有多少种不同的行动方案。我们称两个行动方案不同，当且仅当存在至少一个回合中，两个方案里角色行为不同。这个答案可能是一个很大的数，所以请将答案对 $998244353$ 取模。
## 输入格式

输入第一行有两个正整数 $n$ 和 $k$ ($1\le n\le 1\times 10^{18},0\le k\le 5$)，表示总行动次数与初始战技点数，用空格隔开。

第二行有四个用空格隔开的正整数 $a_1,a_2,a_3,a_4$ ($1 \le a_1,a_2,a_3,a_4 \le 3$)，表示四名角色的行动模式类型。

## 输出格式

输出仅一个整数，表示不同的行动方案数。
## 样例

### 样例输入 #1
```
12 1
2 3 2 1

```
### 样例输出 #1
```
1

```
### 样例输入 #2
```
8 5
2 1 1 3

```
### 样例输出 #2
```
4

```


---

---
title: "[XJTUPC 2024] 筛法"
layout: "post"
diff: 普及+/提高
pid: P10532
tag: ['2024', 'O2优化', '高校校赛']
---
# [XJTUPC 2024] 筛法
## 题目描述

在算法竞赛的数论知识中，我们接触过埃拉托斯特尼筛法、线性筛法、莫比乌斯反演、杜教筛、Powerful Number 筛、Min\_25 筛、洲阁筛等算法来帮助我们优化一些求和/连乘的复杂度，那么现在问题来了，今天这道题将会使用到上述的哪个算法呢？

现在给定正整数 $n$，需要你求 

$$
\sum\limits_{i=1}^n\sum\limits_{j=1}^n\lfloor \dfrac{n}{\max(i,j)}\rfloor [i \perp j]
$$

其中 $[i \perp j]$ 表示 $i,j$ 是否互素，即当 $\gcd(i,j)=1$ 时，$[i \perp j]$ 的值为 $1$，其余情况其值为 $0$。 
## 输入格式

输入一行一个正整数 $n$ ($1\le n \le 10^9$)。
## 输出格式

输出一行一个整数，表示这个和式的结果。
## 样例

### 样例输入 #1
```
2
```
### 样例输出 #1
```
4
```


---

---
title: "[ICPC 2024 Xi'an I] Make Them Straight"
layout: "post"
diff: 普及+/提高
pid: P10556
tag: ['2024', 'O2优化', 'ICPC']
---
# [ICPC 2024 Xi'an I] Make Them Straight
## 题目描述

There is a sequence $a$ of non-negative integers of length $n$, the $i$-th element of it is $a_i(1\leq i\leq n)$.

A sequence is defined as 'good' if and only if there exists a non negative integer $k(0\leq k\leq 10^6)$ that satisfies the following condition:

$a_{i}=a_{1}+(i-1)k$ for all $1\leq i\leq n$.

To make this sequence 'good', for each $i(1\leq i\leq n)$, you can do nothing, or pay $b_i$ coin to replace $a_i$ with any non-negative integer.

The question is, what is the minimum cost to make this sequence 'good'.
## 输入格式

The first line contains an integer $n(1\leq n\leq 2\times 10^5)$, described in the statement.

The second line contains $n$ integers $a_1,...,a_n(0\leq a_i\leq 10^6)$.

The third line contains $n$ integers $b_1,...,b_n(0\leq b_i\leq 10^6)$.
## 输出格式

One integer, the answer.
## 样例

### 样例输入 #1
```
5
1 4 3 2 5
1 1 1 1 1
```
### 样例输出 #1
```
2
```
### 样例输入 #2
```
5
1 4 3 2 5
1 9 1 1 1
```
### 样例输出 #2
```
3
```


---

---
title: "[ICPC 2024 Xi'an I] XOR Game"
layout: "post"
diff: 普及+/提高
pid: P10558
tag: ['2024', 'O2优化', 'ICPC']
---
# [ICPC 2024 Xi'an I] XOR Game
## 题目背景

# statement updated:
$z$ is the number of numbers whose values are $0$.
## 题目描述

Alice and Bob are playing a game against each other.

In front of them are a multiset $\{a_i\}$ of non-negative integers and a single integer $x$. Each number in $a$ is $0$ or $2^i(0\le i<k)$ before the game.

This game will be a turn-based game, and Alice will go first. In one person's turn, he or she will choose an integer from $a$. Let this number be $p$. Then this person will choose whether or not to make $x\gets x\oplus p$, then remove $p$ from $a$. Here, operation $\oplus$ means bitwise xor.

Alice wants to make $x$ as big as possible, and Bob wants to make $x$ as small as possible.

You are a bystander who wants to know the final value of $x$. However, the size of $a$ is a huge number. Formally, there are $b_i$ numbers whose values are $2^i$ in $a$ for all $0\le i<k$, and $z$ numbers whose values are $0$. But you still want to challenge this impossible problem.

If Alice and Bob are smart enough, please output the final value of $x$.
## 输入格式

The first line contains two integers $k,z(1\le k\le10^5,0\le z\le 10^9)$.

The next line contains $k$ integers, the $i$ -th integer is $b_{i-1}(0\le b_{i-1}\le10^9)$.
## 输出格式

Output the answer in binary format. Note that you should output exactly $k$ digit from high to low even though this number has leading $0$s.
## 样例

### 样例输入 #1
```
1 0
3
```
### 样例输出 #1
```
1
```
### 样例输入 #2
```
2 0
2 1
```
### 样例输出 #2
```
11
```
### 样例输入 #3
```
2 0
2 2
```
### 样例输出 #3
```
00
```


---

---
title: "[ICPC 2024 Xi'an I] Smart Quality Inspector"
layout: "post"
diff: 普及+/提高
pid: P10561
tag: ['2024', 'O2优化', 'ICPC']
---
# [ICPC 2024 Xi'an I] Smart Quality Inspector
## 题目描述

    
Ella has a factory. One day, her factory is facing a product quality inspection.
    
    
    
Her factory has $N$ production lines. Among the $N$ production lines, $N-K$ of them are qualified, and the other $K$ lines are unqualified. The fine of the $i$ -th$(1\leq i\leq K)$ unqualified line is $i$ Yuan.
    
    
    
There are $M$ quality inspectors here. For the $j$ -th$(1\leq j\leq M)$ quality inspector, he will inspect from the $l_i$ -th line to the $r_i$ -th line and find the unqualified production line with the largest fine among them, then impose this fine on Ella.
    
    
    
Ella does not want to receive so many fines, so she decides to renumber the $N$ production lines to receive the least amount of fines. Please help her.
    
    
    
In simple terms:
    
    
    
You have a sequence $A$ of length $N$, $A=[1,2,3,...,K,0,0,0,...,0]$. Here $N,K$ are given.
    
    
    
There are $M$ pairs of integers, each pair consists of two numbers $l_i,r_i$.
    
    
    
You need to rearrange sequence $A$ to minimize the following:
    
    
    
$$\sum_{i=1}^M \max_{j=l_i}^{r_i} (A_{j})$$
## 输入格式


    
The first line contains three integers $N,K,M(1\leq K\leq N\leq 20,1\leq M\leq 10^5)$, described in the statement.
    
    
    
Then $M$ lines, the $i$ -th line of them contains two integers $l_i,r_i(1\leq l_i\leq r_i\leq N)$.
    
## 输出格式


    
An integer indicates the answer.
## 样例

### 样例输入 #1
```
4 4 3
1 2
3 4
1 4
```
### 样例输出 #1
```
10
```


---

---
title: "[ICPC 2024 Xi'an I] Rubbish Sorting"
layout: "post"
diff: 普及+/提高
pid: P10564
tag: ['2024', 'O2优化', 'ICPC']
---
# [ICPC 2024 Xi'an I] Rubbish Sorting
## 题目描述


Bob has many pieces of rubbish. One day, he wants to sort them.
    
    
    
For every piece of rubbish, its type is expressed as a positive integer.
    
    
    
He has $q$ operations. For each operation, it is one of the following two operations.

- `1 s x` He tells you that the piece of rubbish named $s$ has a type of $x$.
- `2 s` He wants to ask you the type of rubbish $s$.


    
But his memories are not always accurate.
    
    
    
For each operation $2$, $s$ may not have appeared in the previous operation $1$s.
    
    
    
We define the similarity of two strings $s_1$ and $s_2$ as $\sum_{i=1}^{\min\{|s_1|,|s_2|\}} [s_{1,i}=s_{2,i}]$.
    
    
    
Here all the strings' indexes start at $1$.
    
    
    
For a string $s$, its type is the type of string which has the maximum similarity to $s$ among all the strings that have appeared in the previous operations $1$s. Note that if there are multiple strings that all have the maximum similarity to $s$, the type of $s$ is the minimum type of these strings' type.
    
    
    
Now, he wants you to solve this problem.
    
## 输入格式


The first line contains an integer $q(1\le q\le 3\times 10^5)$, which is the number of operations.
    
    
    
Next $q$ lines contain operations, one per line. They correspond to the description given in the statement.
    
    
    
It is guaranteed that for every operation $2$ there is at least one operation $1$ before it.
    
    
    
But some pieces of rubbish will have more than one type, you can consider it as the minimum type you have read.
    
    
    
The rubbish's names only consist of lowercase Latin letters.
    
    
    
$1 \le |s| \le 5, 1 \le x \le 10^9$
## 输出格式


    
For every operation $2$, you should print an integer in a single line that is the rubbish $s$'s type.
    
## 样例

### 样例输入 #1
```
4
1 aaa 1
2 aa
1 ab 2
2 bb
```
### 样例输出 #1
```
1
2
```
### 样例输入 #2
```

```
### 样例输出 #2
```

```


---

---
title: "楼兰图腾"
layout: "post"
diff: 普及+/提高
pid: P10589
tag: []
---
# 楼兰图腾
## 题目描述

在完成了分配任务之后，西部 314 来到了楼兰古城的西部。相传很久以前这片土地上（比楼兰古城还早）生活着两个部落，一个部落崇拜尖刀（`V`），一个部落崇拜铁锹（`∧`），他们分别用 `V` 和 `∧` 的形状来代表各自部落的图腾。

西部 314 在楼兰古城的下面发现了一幅巨大的壁画，壁画上被标记出了 $N$ 个点，经测量发现这 $N$ 个点的水平位置和竖直位置是两两不同的。西部 314 认为这幅壁画所包含的信息与这 $N$ 个点的相对位置有关，因此不妨设坐标分别为 $(1,y_1),(2,y_2),\cdots,(n,y_n)$，其中 $y_1\sim y_n$ 是 $1$ 到 $n$ 的一个排列。

![](https://cdn.luogu.com.cn/upload/image_hosting/u8z4ffl9.png)

如图，图中的 $y_1=1$，$y_2=5$，$y_3=3$，$y_4=2$，$y_5=4$。

西部 314 打算研究这幅壁画中包含着多少个图腾，其中 `V` 图腾的定义如下（注意：图腾的形式只和这三个纵坐标的相对大小排列顺序有关）$1\le i<j<k\le n$ 且 $y_i>y_j$, $y_j<y_k$；

而崇拜 `∧` 的部落的图腾被定义为 $1\le i<j<k\le n$ 且 $y_i<y_j$，$y_j>y_k$；

西部 314 想知道，这 $n$ 个点中两个部落图腾的数目。因此，你需要编写一个程序来求出 `V` 的个数和 `∧` 的个数。
## 输入格式

第一行一个正整数 $n$；

第二行是 $n$ 个正整数，分别代表 $y_1,y_2,\cdots,y_n$。
## 输出格式

输出两个数，中间用空格隔开，依次为 `V` 的个数和 `∧` 的个数
## 样例

### 样例输入 #1
```
5
1 5 3 2 4
```
### 样例输出 #1
```
3 4
```
## 提示

数据范围约定

- 对于 $10\%$ 的数据 $n\le 600$；
- 对于 $40\%$ 的数据 $n\le 5000$；
- 对于 $100\%$ 的数据 $n\le 200000$，答案不超过 $2^{63} - 1$。


---

---
title: "[SNCPC2024] 商路"
layout: "post"
diff: 普及+/提高
pid: P10695
tag: ['2024', 'O2优化', '陕西', 'Ad-hoc', 'XCPC']
---
# [SNCPC2024] 商路
## 题目描述

一个圆周被 $K$ 个点等分，这些点按照顺时针编号为 $1, 2, \cdots, K$。其中点 $a_1, a_2, \cdots, a_n$ 分别建造有一座市场 $M_1, M_2, \cdots, M_n$。

一条从市场 $i$ 出发，目标是市场 $j$ 的商路是有向线段 $M_i M_j$ ($i \neq j$) 且必须满足以下条件：

- 市场 $j$ 必须是距离市场 $i$ 最远的市场（如果有多个距离相同的最远的市场,那么任意一个均可）。
    
- 商路线段 $M_i M_j$ 不能与其他商路线段在起点或者终点以外的地方相交或重合。

最多可以存在多少条商路？
## 输入格式

第一行包含两个整数 $K, n$ ($3 \leq K \leq 10^9, 3\leq n \leq \min(K,10^5) $)，由空格隔开，表示有 $n$ 个市场分布在圆周的 $K$ 等分点上。

第二行包含 $n$ 个整数 $a_1, a_2, \cdots, a_n$ ($1\leq a_1 < a_2 < \cdots < a_{n-1} < a_n \leq K$)，为建有市场的点的编号。
## 输出格式

输出一个整数表示最多可以存在的商路的数量。

## 样例

### 样例输入 #1
```
10 5
1 2 5 6 8

```
### 样例输出 #1
```
2

```
### 样例输入 #2
```
3 3
1 2 3

```
### 样例输出 #2
```
3

```
## 提示



对于第一个样例，其中两种可能的答案如下图所示：

![](https://cdn.luogu.com.cn/upload/image_hosting/ql7evd73.png)

![](https://cdn.luogu.com.cn/upload/image_hosting/ya5u7z3o.png)


---

---
title: "[SNCPC2024] 致命公司"
layout: "post"
diff: 普及+/提高
pid: P10701
tag: ['2024', 'O2优化', '陕西', 'XCPC']
---
# [SNCPC2024] 致命公司
## 题目描述

Shirost 最近沉迷于一款名为《致命公司》的游戏。

在游戏中，玩家将作为“公司”的合同工，从废弃的工业星球收集废料。在探索的过程中，Shirost 将遇到一个名为弹簧头的怪物，弹簧头会在无人注视它时快速移动，但在被注视时则会保持不动。一旦接近，弹簧头就会立刻杀死 Shirost。

现在 Shirost 站在 $n$ 个无限长的通道的交汇点，他知道有 $m$ 个弹簧头，分别会在 $t_i$ 时刻出现在 $x_i$ 号通道距离他 $y_i$ 米远处。

对于每个时刻 $j$，以下三个事件将会依次发生：

1. 在该时刻开始时，满足 $t_i = j$ 的弹簧头会出现在  $x_i$ 号通道距离 Shirost $y_i$ 米远处。

2. Shirost 选择凝视任意一个通道。

3. 该通道内的所有弹簧头无法移动，而其他通道中**已经出现**的弹簧头会向他移动 $k$ 米，如果某个弹簧头到达他所在位置，则他将在时刻 $j$ 死亡。

Shirost 想知道他最晚可以活到哪个时刻。换句话说，如果 Shirost 最晚在时刻 $j$ 死亡，那么你需要输出 $j-1$。如果他不会死亡，则输出 $-1$。
## 输入格式

输入第一行为三个整数 $n,m,k$ ($1 \leq n \leq 5 \times 10^5, 1 \leq m \leq 5 \times 10^5, 1 \leq k \leq 10^{18}$)，由空格隔开，为无限长通道的个数，弹簧头的个数，弹簧头每时刻移动的距离。

接下来 $m$ 行，每行三个整数 $t_i,x_i,y_i$ ($1 \leq t_i \leq 10^{18}, 1 \leq x_i \leq n, 1 \leq y_i \leq 10^{18}$)，由空格隔开，描述弹簧头出现的时刻，出现的通道编号，距离 Shirost 有多远。

## 输出格式

输出仅一行一个整数，表示 Shirost 最晚可以活到哪个时刻。如果他不会死亡，则输出 $-1$。
## 样例

### 样例输入 #1
```
2 3 2
1 1 6
2 2 7
3 1 8

```
### 样例输出 #1
```
6

```
### 样例输入 #2
```
114514 6 1919810
1 1 1
1 1 9
1 4 1
1 5 9
1 1 8
1 4 10

```
### 样例输出 #2
```
0

```
## 提示



Shirost 可以按如下所述行动：
| 时刻 | 凝视的通道 | 弹簧头 $1$ 距离 | 弹簧头 $2$ 距离 |  弹簧头 $3$ 距离 |
| :----------: | :----------: | :----------: | :----------: | :----------: |
| 1 | 1 | 6 |  |  |
| 2 | 1 | 6 | 5 |  |
| 3 | 2 | 4 | 5 | 6 |
| 4 | 1 | 4 | 3 | 6 |
| 5 | 2 | 2 | 3 | 4 |
| 6 | 1 | 2 | 1 | 4 |

在第 $7$ 时刻，无论看哪个通道，Shirost 都会在该时刻内被弹簧头杀死。所以答案是 $6$。


---

---
title: "[SEERC 2020] Reverse Game"
layout: "post"
diff: 普及+/提高
pid: P10737
tag: ['2020', 'ICPC']
---
# [SEERC 2020] Reverse Game
## 题目描述

Alice 和 Bob 在玩一个游戏，规则如下：

- 游戏开始前给定一个字符串 $s$。

- 每次行动，选择 $s$ 的一个子串 $t$，$t$ 只能是 `10`、`100`、`110`、`1010` 中的一个，反转 $t$ 的每个字符，例如 `100` 翻转为 `001`。

- 不能操作者输掉游戏。

Alice 先手，问双方同时采取最优策略的情况下，谁能赢。
## 输入格式

一个仅包含 $01$ 的字符串 $s\ (1 \leq |s| \leq 10^6)$。
## 输出格式

如果 Alice 胜利输出 `Alice`，Bob 胜利输出 `Bob`。
## 样例

### 样例输入 #1
```
010
```
### 样例输出 #1
```
Alice
```
### 样例输入 #2
```
1111
```
### 样例输出 #2
```
Bob
```
### 样例输入 #3
```
1010
```
### 样例输出 #3
```
Bob
```
### 样例输入 #4
```
1010001011001
```
### 样例输出 #4
```
Alice
```
## 提示

对于样例 $1$，选择子串 `10` 进行反转后 Bob 无法操作。


---

---
title: "【MX-S2-T2】 排"
layout: "post"
diff: 普及+/提高
pid: P10811
tag: ['O2优化', '梦熊比赛']
---
# 【MX-S2-T2】 排
## 题目背景

原题链接：<https://oier.team/problems/S2B>。
## 题目描述

有 $n$ 个整数 $a_1,a_2,\ldots,a_n$。$f_0=0,f_i= \left\{
\begin{aligned}
& f_{i-1}   &  \ f_{i-1}\times a_i>0, \\
& f_{i-1}+a_i &  \ f_{i-1}\times a_i\le 0.\\ 
\end{aligned}
\right.
$

重排 $a$ 使得得到的 $f_n$ 最大。
## 输入格式

第一行一个整数 $n$。

第二行 $n$ 个整数 $a_1,\dots,a_n$。
## 输出格式

一行一个整数，表示答案。
## 样例

### 样例输入 #1
```
5
7 5 -4 -6 3
```
### 样例输出 #1
```
6
```
### 样例输入 #2
```
10
573 -1339 899 939 -26 1430 1324 -1150 1640 -45 
```
### 样例输出 #2
```
1625
```
## 提示

**【样例解释 \#1】**

考虑重排为 $-6,-4,5,7,3$，最终的 $f_n$ 为 $6$，可以证明不存在更优的方案。

**【数据范围】**

**本题采用捆绑测试。**

- Subtask 0（6 pts）：$n\le10$。
- Subtask 1（14 pts）：$n\le 20$，$|a_i|\le10$。
- Subtask 2（8 pts）：$a$ 中全为正数或全为负数。
- Subtask 3（19 pts）：$a$ 中有且只有一个正数（注意 $a$ 中可以有 $0$）。
- Subtask 4（29 pts）：$n \le 200$，$|a_i|\le 200$。
- Subtask 5（24 pts）：无特殊限制。

对于所有测试数据，$1 \le n \le 2000$，$|a_i|\le 2000$。


---

---
title: "[EC Final 2020] Namomo Subsequence"
layout: "post"
diff: 普及+/提高
pid: P10816
tag: ['2020', 'O2优化', 'ICPC']
---
# [EC Final 2020] Namomo Subsequence
## 题目描述

``gshfd1jkhaRaadfglkjerVcvuy0gf`` said Prof. Pang. 

To understand Prof. Pang's word, we would like to calculate the number of $\textit{namomo subsequence}$s of it. The word by Prof. Pang is a string $s$ with $n$ characters where each character is either an English letter (lower or upper case) or a digit. The $i$-th character of $s$ is denoted by $s[i]$ ($1\le i\le n$). A subsequence $t$ of $s$ is defined by a list of indices $t_1, \ldots, t_6$ such that $1\le t_1 < t_2 < \ldots < t_6\le n$. Let $compare(c_1, c_2)$ be a function on two characters such that $compare(c_1, c_2)=1$ when $c_1=c_2$ and $compare(c_1, c_2)=0$ otherwise. $t$ is a namomo subsequence of $s$ if and only if for any $1\le i<j\le 6$, $compare(s[t_i], s[t_j]) = compare(namomo[i], namomo[j])$, where $namomo[x]$ represents the $x$-th character of the string ``namomo`` ($1\le x\le 6$). 

Output the number of namomo subsequences of a given string $s$ modulo $998244353$.
## 输入格式

The first line contains a string $s$ with $n$ characters ($6\le n\le 1000000$). $s$ contains only lower case English letters (`a` -- `z`), upper case English letters (`A` -- `Z`) and digits (`0` -- `9`).
## 输出格式

Output one integer -- the answer modulo $998244353$.
## 样例

### 样例输入 #1
```
wohaha
```
### 样例输出 #1
```
1
```
### 样例输入 #2
```
momomo
```
### 样例输出 #2
```
0
```
### 样例输入 #3
```
gshfd1jkhaRaadfglkjerVcvuy0gf
```
### 样例输出 #3
```
73
```
### 样例输入 #4
```
retiredMiFaFa0v0
```
### 样例输出 #4
```
33
```
## 题目翻译

给你一个串 $s$，问你有多少个长度为 $6$ 且形如 $A B C D C D$ 的子序列。 

$6\le |s|\le 10^6$，字符集大小 $62$。


---

---
title: "[EC Final 2020] Rectangle Flip 2"
layout: "post"
diff: 普及+/提高
pid: P10817
tag: ['2020', 'O2优化', 'ICPC']
---
# [EC Final 2020] Rectangle Flip 2
## 题目描述

Prof. Pang enters a trap room in a dungeon. The room can be represented by an $n$ by $m$ chessboard. We use $(i, j)$ ($1\le i\le n$, $1\le j\le m$) to denote the cell at the $i$-th row and $j$-th column. Every second, the floor of one cell breaks apart (so that Prof. Pang can no longer stand on that cell.) After $nm$ seconds, there will be no cell to stand on and Prof. Pang will fall through to the next (deeper and more dangerous) level.

But Prof. Pang knows that calm is the key to overcome any challenge. So instead of being panic, he calculates the number of rectangles such that every cell in it is intact (i.e., not broken) after every second. (A rectangle represented by four integers $a, b, c$ and $d$ ($1\le a\le b\le n, 1\le c\le d\le m$) includes all cells $(i, j)$ such that $a\le i\le b, c\le j\le d$. There are $
\frac{n(n+1)}{2} \times \frac{m(m+1)}{2}$ rectangles in total.)
## 输入格式

The first line contains two integers $n$, $m$ ($1\le n, m\le 500$) separated by a single space. 

The $(i+1)$-th line contains two integers $a$, $b$ separated by a single space representing that the cell $(a, b)$ breaks apart at the $i$-th second. It is guaranteed that each cell appears exactly once in the input. 
## 输出格式

Output $nm$ lines. The $i$-th line should contain the number of rectangles such that every cell in it is intact after the first $i$ cells break apart.
## 样例

### 样例输入 #1
```
2 2
1 1
2 1
1 2
2 2
```
### 样例输出 #1
```
5
3
1
0
```
## 提示

In the example, after the first second, there are $3$ rectangles of area $1$ and $2$ rectangles of area $2$ that satisfy the constraint. So the first line should contain a $5$. After the second second, only cells in the second column remains intact. The answer should be $3$. After the third second, only one cell remains intact. The answer should be $1$. After the fourth second, all cells broke apart so the answer should be $0$. 
## 题目翻译

### 题目描述

庞教授进入了一个地下城的陷阱房间。这个房间可以用一个 $n$ 行 $m$ 列的棋盘来表示。我们用 $(i, j)$ ($1\le i\le n$, $1\le j\le m$) 来表示第 $i$ 行第 $j$ 列的单元格。每秒钟，有一个单元格的地板会破裂（这样庞教授就不能再站在这个单元格上了）。经过 $nm$ 秒后，将没有单元格可供站立，庞教授将跌落到下一个（更深且更危险的）层级。

但庞教授知道冷静是克服任何挑战的关键。因此，他没有惊慌，而是计算了在每秒钟后，所有单元格都完好的矩形的数量（即，每个单元格在矩形中都没有破裂）。一个矩形由四个整数 $a, b, c$ 和 $d$ ($1\le a\le b\le n, 1\le c\le d\le m$) 表示，包含所有 $(i, j)$ 使得 $a\le i\le b, c\le j\le d$。总共有 $
\frac{n(n+1)}{2} \times \frac{m(m+1)}{2}$ 个矩形。

### 输入格式

第一行包含两个整数 $n$, $m$ ($1\le n, m\le 500$)，用空格分隔。

第 $(i+1)$ 行包含两个整数 $a$, $b$，表示在第 $i$ 秒钟单元格 $(a, b)$ 破裂。保证每个单元格在输入中出现恰好一次。

### 输出格式

输出 $nm$ 行。第 $i$ 行应包含在前 $i$ 个单元格破裂之后，每个单元格都完好的矩形的数量。

### 提示

在示例中：在第一秒后，有 $3$ 个面积为 $1$ 的矩形和 $2$ 个面积为 $2$ 的矩形满足条件。因此第一行应该输出 $5$。在第二秒后，仅第二列中的单元格保持完好。答案应该是 $3$。在第三秒后，仅一个单元格保持完好。答案应该是 $1$。在第四秒后，所有单元格都破裂，所以答案应该是 $0$。

翻译者：[Immunoglobules](https://www.luogu.com.cn/user/1066251)


---

---
title: "【MX-J2-T3】Piggy and Trees"
layout: "post"
diff: 普及+/提高
pid: P10842
tag: ['O2优化', '梦熊比赛']
---
# 【MX-J2-T3】Piggy and Trees
## 题目背景

原题链接：<https://oier.team/problems/J2D>。
## 题目描述

给你一棵 $n$ 个结点的树。

定义 $f(u, v, i)$ 为，在所有满足 $^\dagger\text{dis}(u, x) + \text{dis}(v, x) = \text{dis}(u, v)$ 的点 $x$ 中，$\text{dis}(x, i)$ 的最小值。

求 $\sum\limits_{u = 1}^n \sum\limits_{v = u + 1}^n \sum\limits_{i = 1}^n f(u, v, i)$ 对 $10^9 + 7$ 取模的值。

$^\dagger\text{dis}(u, v)$ 为树上 $u, v$ 两点的路径长度。特别地，$\text{dis}(u, u) = 0$。
## 输入格式

第一行包含一个整数 $n$，表示树的结点数。

之后的 $n - 1$ 行中的第 $i$ 行包含两个整数 $u_i, v_i$，表示树上的一条边。
## 输出格式

输出一行一个整数，表示答案。
## 样例

### 样例输入 #1
```
4
1 2
1 3
1 4

```
### 样例输出 #1
```
9

```
### 样例输入 #2
```
6
1 2
2 3
3 4
4 5
5 6

```
### 样例输出 #2
```
70

```
### 样例输入 #3
```
10
1 2
1 3
1 4
2 5
3 6
2 7
4 8
8 9
9 10

```
### 样例输出 #3
```
536

```
## 提示

#### 【样例解释】

在样例 $1$ 中，所有非 $0$ 的 $f(u, v, i)$ 的值为：

- $f(1, 2, 3) = 1$；
- $f(1, 2, 4) = 1$；
- $f(1, 3, 2) = 1$；
- $f(1, 3, 4) = 1$；
- $f(1, 4, 2) = 1$；
- $f(1, 4, 3) = 1$；
- $f(2, 3, 4) = 1$；
- $f(2, 4, 3) = 1$；
- $f(3, 4, 2) = 1$。

#### 【数据范围】

**本题采用捆绑测试且开启子任务依赖。**

| 子任务编号 | 分值 | $n \le$ | 特殊性质 | 子任务依赖 | 
| :-: | :-: | :-: | :-: | :-: |
| $1$ | $8$ | $50$ | 无 | 无 |
| $2$ | $15$ | $400$ | 无 | $1$ |
| $3$ | $24$ | $3000$ | 无 | $1, 2$ |
| $4$ | $17$ | $2 \cdot 10^5$ | $u_i = i, v_i = i + 1$ | 无 |
| $5$ | $36$ | $2 \cdot 10^5$ | 无 | $1, 2, 3, 4$ |

对于所有数据，满足 $2 \le n \le 2 \cdot 10^5$，输入的图是一棵树。


---

---
title: "[JRKSJ R9] 在相思树下 III"
layout: "post"
diff: 普及+/提高
pid: P10878
tag: ['2024', '洛谷原创', 'O2优化']
---
# [JRKSJ R9] 在相思树下 III
## 题目背景

>我知 
>
>再迷恋他也非我能私有
>
>就当神爱世人遥远温柔 
>
>未必要牵手
>
>隔千万光年宇宙献吻 
>
>亦真切感受
>
>不用 
>
>强求 
>
>对号入座那虚构
## 题目描述

给你一个长为 $n$ 的序列 $a_{1\dots n}$，你需要对它进行两种操作共 $n-1$ 次。

对一个长度为 $l$ 的序列 $b_{1\dots l}$ 进行一次操作将会把序列变为一个长为 $l-1$ 的序列 $c_{1\dots l-1}$：

- 操作一中，$\forall i\in[1,l),c_i=\max(b_i,b_{i+1})$；
- 操作二中，$\forall i\in[1,l),c_i=\min(b_i,b_{i+1})$。

给定整数 $m$，你只能进行**至多** $m$ 次操作一。进行 $n-1$ 次操作后序列 $a$ 的长度变为 $1$。你可以任意安排操作的顺序，求最终剩余的数 $a_1$ 的最大值。
## 输入格式

第一行两个整数 $n,m$。

第二行 $n$ 个整数 $a_i$ 表示初始序列。
## 输出格式

一个整数，代表最终剩余的数的最大可能值。
## 样例

### 样例输入 #1
```
4 2
1 2 3 3
```
### 样例输出 #1
```
3
```
## 提示

### 样例解释

一种可能的操作顺序是：
- 进行一次操作一，序列变为 $2,3,3$；
- 进行一次操作二，序列变为 $2,3$；
- 进行一次操作一，序列变为 $3$。

显然最终剩余的数不可能大于 $3$。

### 数据规模与约定

**本题采用捆绑测试。**

| $\mathrm{Subtask}$ | $n\le$ | 特殊性质 | 分数 |
| :----------: | :----------: | :----------: | :----------: |
| $1$ | $10$ |  | $10$ |  
| $2$ | $5000$ |  | $30$ |  
| $3$ | $10^6$ | $\checkmark$ | $20$ |  
| $4$ | $10^6$ |  | $40$ |  

特殊性质：保证 $\forall i\in[1,n],a_i\le10$。

对于所有数据，保证 $1\leq m < n \leq 10^6$，$1 \leq a_i \leq 10^{9}$。


---

---
title: "[COCI 2017/2018 #2] Doktor"
layout: "post"
diff: 普及+/提高
pid: P10883
tag: ['2017', 'Special Judge', 'COCI（克罗地亚）']
---
# [COCI 2017/2018 #2] Doktor
## 题目背景

搬运自 [COCI 2017/2018 Contest #2](https://hsin.hr/coci/archive/2017_2018/) T3「Doktor」，[原题题面](https://hsin.hr/coci/archive/2017_2018/contest2_tasks.pdf)。

Special Judge 由搬题人提供，如果有锅请私信，谢谢。
## 题目描述

> And the Mrs, Ms, says:
>
>"I've been riding horses for fifteen years, and it is impossible to shoe a horse upside down!"
>
> (…)

"Yes, that's upside down" - whispers Domagoj, looking at Mate's hand while playing, for the purposes of this task, a heavily modified version of the card game Hanabi. For the sake of simplicity, Mate is holding $N$ cards in his hands, numbered from $1,2,\dots,N$
 in a certain order. (Each number from $1$ to $N$
appears exactly once.) As when playing the real game, he cannot voluntarily change the card order.

Just so the task is at least somewhat related to the story, Domagoj will point for Mate to a contiguous subarray of cards. (He can point to a single card too, but he will point to at least one card.) Mate will then "rotate" that contiguous subarray and put it back.

(The rotating can be thought of as taking all the cards in the given subarray and rotating all of them for 180 degrees. This means that the first and last card swap places, as well as the second and the second to last card, and so on.)

Like all of us, Domagoj is very fond of fixed points. In other words, cards whose numbers match their position in hand, counting from Domagoj's left side. Therefore, he'd like the number of fixed points to be as great as possible after rotating the given subarray.

Help Domagoj find out which contiguous subarray he needs to point out so that the number of fixed points in Mate's hand after rotating that subarray is maximal.
## 输入格式

 The first line of input contains the positive integer $N (1 \leq N \leq 500000)$, the number of cards in Mate's hand.
 
 The following line contains the numbers on the cards in Mate's hand in the order that Domagoj sees them.
## 输出格式

 You must output a single line containing $A$ and 
$B$, the numbers on the cards that are the beginning and the end of the required contiguous subarray, in that order. If there are multiple options, output any of them.
## 样例

### 样例输入 #1
```
4
3 2 1 4
```
### 样例输出 #1
```
3 1
```
### 样例输入 #2
```
2
1 2
```
### 样例输出 #2
```
1 1
```
### 样例输入 #3
```
7
3 6 5 7 4 1 2 
```
### 样例输出 #3
```
3 2
```
## 提示

In the first test case, after rotating the contiguous subarray that starts with 3 and ends with 1, the cards will be ordered 1 2 3 4, and now all the cards are fixed points. In this example, the given output is the only correct output.

 In the second test case, rotating any subarray consisting of only one card results with the same card order, the one that produces the maximal number of fixed points.
## 题目翻译

有一个长为 $N(N\leq 5\times 10^5)$ 的排列 $a$，其价值定义为 $\sum\limits_{i=1}^N [a_i=i]$。即，排列中满足 $a_i = i$  的 $i(1\leq i \leq n)$ 的个数。

你可以反转某一段区间，求一次操作之后最大的价值。反转指的是将序列前后颠倒，例如反转 `3 2 1 4` 会得到 `4 1 2 3`。

注意，你需要输出的**并不是**最大价值，而是满足操作之后可以取到最大价值的**反转区间的左右端点上原序列中的值**。例如样例 1 中，反转 $[1,3]$ 是最优解，而应当输出原序列中的反转区间的端点下标对应的值 $a_1=3$ 以及 $a_3=1$。

可能有多组解，你可以输出任意一组。


---

---
title: "【MX-S3-T2】「FeOI Round 1」Journey"
layout: "post"
diff: 普及+/提高
pid: P10886
tag: ['梦熊比赛']
---
# 【MX-S3-T2】「FeOI Round 1」Journey
## 题目背景

原题链接：<https://oier.team/problems/S3B>。

---

![](bilibili:BV1pv411C7ti)
## 题目描述

小 W 最近正在学习某编程语言。

这个编程语言有个语句如下：

```
range(a,b,c)
```

这个语句表示一个序列，这个序列是这样的：

$$
[a,a+c,a+2c,\cdots,a+kc]
$$

其中，$k$ 是最大的满足 $a+kc<b$ 的非负整数 $k$。例如 `range(1,7,2)` 表示的序列为 $[1,3,5]$。

小 W 想问你一个问题：给你一个长为 $n$ 的序列 $g$（下标从 $1$ 开始），求出下列式子的值，答案模 $10^9 +7$。

$$
\sum_{a=1}^{n}\sum_{b=a+1}^{n+1}\sum_{c=1}^{n}\sum\limits_{i\in \mathrm{range}(a,b,c)} g_i
$$


## 输入格式

为了加快读入速度，我们采用以下读入方法。

读入共一行五个非负整数 $n,A,B,C,g_n$。

其中 $n$ 为序列 $g$ 的长度，$A,B,C$ 为生成数据的参数，$g_n$ 为序列 $g$ 的第 $n$ 项。

对于序列 $g$ 的第 $i$（$1\leq i < n$）项，满足 $g_i \equiv Ag_{i+1}^2+Bg_{i+1}+C \pmod {10^9 + 7}$。
## 输出格式

共一行一个非负整数，为题目中所求的答案。
## 样例

### 样例输入 #1
```
2 0 1 1 1
```
### 样例输出 #1
```
11
```
### 样例输入 #2
```
9 0 1 0 663
```
### 样例输出 #2
```
422994
```
### 样例输入 #3
```
20 1 0 0 998244353
```
### 样例输出 #3
```
560706529
```
### 样例输入 #4
```
114514 17723 134 1045 233337
```
### 样例输出 #4
```
442762986
```
## 提示

**【样例解释 #1】**

$g=[2,1]$（下标从 $1$ 开始）

令 $ans=\sum\limits_{i\in \mathrm{range}(a,b,c)} g_i$。

当 $a=1,b=2,c=1$ 时，$ans=2$。

当 $a=1,b=2,c=2$ 时，$ans=2$。

当 $a=1,b=3,c=1$ 时，$ans=2+1=3$。

当 $a=1,b=3,c=2$ 时，$ans=2$。

当 $a=2,b=3,c=1$ 时，$ans=1$。

当 $a=2,b=3,c=2$ 时，$ans=1$。

答案为 $\sum ans=2+2+3+2+1+1=11$。

**【样例解释 #2】**

该样例满足特殊性质 A。

**【数据范围】**

对于 $100\%$ 的数据：$1\leq n\leq 2\times 10^7$，$0\leq A,B,C,g_n<10^9 +7$。

| 测试点编号 |       $n=$       | 特殊性质 |
| :--------: | :--------------: | :------: |
|    $1$     |       $1$        |    AB    |
|    $2$     |      $1000$      |    无    |
|    $3$     |      $1000$      |    无    |
|    $4$     |      $5000$      |    无    |
|    $5$     |      $5000$      |    无    |
|    $6$     |      $10^4$      |    A     |
|    $7$     |      $10^5$      |    A     |
|    $8$     |      $10^5$      |    B     |
|    $9$     |      $10^5$      |    无    |
|    $10$    |  $2\times 10^5$  |    A     |
|    $11$    |  $2\times 10^5$  |    B     |
|    $12$    |  $5\times 10^5$  |    无    |
|    $13$    |      $10^6$      |    A     |
|    $14$    |      $10^6$      |    B     |
|    $15$    |  $2\times 10^6$  |    无    |
|    $16$    |  $3\times 10^6$  |    无    |
|    $17$    |  $5\times 10^6$  |    A     |
|    $18$    |      $10^7$      |    A     |
|    $19$    |      $10^7$      |    B     |
|    $20$    | $1.3\times 10^7$ |    无    |
|    $21$    | $1.6\times 10^7$ |    无    |
|    $22$    |  $2\times 10^7$  |    A     |
|    $23$    |  $2\times 10^7$  |    B     |
|    $24$    |  $2\times 10^7$  |    无    |
|    $25$    |  $2\times 10^7$  |    无    |

特殊性质 A：保证所有 $g_i$ 相等。

特殊性质 B：保证只有 $g_n\neq 0$。


---

---
title: "城市化发展委员会"
layout: "post"
diff: 普及+/提高
pid: P10893
tag: ['O2优化']
---
# 城市化发展委员会
## 题目背景

MLE 大帝曾说过：

![](https://cdn.luogu.com.cn/upload/image_hosting/kce8kpx3.png)

所以为了应对这种情况我们设立了**城市化发展委员会**。
## 题目描述

在高中的校园里我们常常能看到随机刷新的小情侣，对于他们之间的情感，对于 OIer 来说还是太过于高深了，即使是退役的 AzureHair 也无法理解这一行为，但是作为自命的城市化发展委员会的常委，他有自己的一套理解方法。

他认为，女生往往对男生十分的严格。一天开始时男生在女生的心里的积分会加 $1$，而如果当天惹女生生气了 $x$ 次，积分就会在此基础上减 $x$。积分会不断累计，一旦小于等于 $0$ 就可能导致去城市化的严重后果。

现在 **威廉** 在和 **珂朵莉** 进行一种城市化行为，**威廉** 在~~纳西妲~~的帮助之下获得了超能力：一是他可以预知到接下来一个周期的积分变化情况，初始的周期长度为 $n$；二是他可以选择从任意一天开始，开始前的日子将会被拼接到最后一天之后。

他从每一天开始都尝试过一次后，发现了 $a$ 个能使得他不被去城市化的起始日期。随后他会将这若干种情况下的序列按照起始日期的先后拼在一起，变成一个长度为原先 $a$ 倍的周期。他如此重复操作 $k$ 次，由于一天天地试太累了，**威廉** 只想知道最后一次操作后有多少个起始日期能让自己不被去城市化，对 $998244353$ 取模。

---

形式化地说，我们称满足前缀和始终大于 $0$ 的数列为 “安全的”。

对于一个长为 $n$ 的数列 $A_i$，根据以下算法构造出数列 $A_{i+1}$，初始时 $A_{i+1}$ 为空。

- 重复执行 $n$ 次：

1. 若 $A_i$ 是安全的，将其整个接到 $A_{i+1}$ 末尾。

2. 将 $A_i$ 循环左移一位，即令 $A_{i_j} ← A_{i_{j+1 \bmod n}}$。

现在给定 $A_0$，**满足其各项均不大于 1**。

从 $A_0$ 开始按上述规则生成数列 $A_1$ 到 $A_{k+1}$，请求出 $A_{k+1}$ 与 $A_k$ 的长度比，这个值只要存在就一定是整数，请输出它对 $998244353$ 取模的值。特别地，如果 $A_k$ 为空，请输出 ```0```。
## 输入格式

普通题意：

共两行，第一行两个整数 $n$ 和 $k$，表示初始的周期长度和操作次数。

第二行 $n$ 个小于等于 1 的整数，表示每天的积分变化。

形式化题意：

共两行，第一行两个整数为 $A_0$ 的长度 $n$ 以及 $k$。

第二行是 $A_0$。
## 输出格式

一行一个整数，表示答案对 $998244353$ 取模的结果。
## 样例

### 样例输入 #1
```
8 0
1 1 -2 1 1 -1 0 1
```
### 样例输出 #1
```
2
```
### 样例输入 #2
```
6 0
1 1 -4 -5 1 -4
```
### 样例输出 #2
```
0
```
## 提示

**【样例解释1】**

对于样例 #1 的数据，初始周期为 ```1 1 -2 1 1 -1 0 1```。从每一天开始得到的序列分别是：

```text
1 1 -2 1 1 -1 0 1
1 -2 1 1 -1 0 1 1
-2 1 1 -1 0 1 1 1
1 1 -1 0 1 1 1 -2
1 -1 0 1 1 1 -2 1
-1 0 1 1 1 -2 1 1 
0 1 1 1 -2 1 1 -1
1 1 1 -2 1 1 -1 0
```

只有从第 4 天和第 8 天开始的序列是满足条件的。

形式化题意：

$A_1=\{1,1,-1,0,1,1,1,-2,1,1,1,-2,1,1,-1,0\}$，长度为 16，因此应输出 2。

**【样例解释2】**

可以证明不存在合法的方案。

喂！样例全都 $k=0$ 是不是太过分了？！

**数据范围：**

对于 $15\%$ 的数据，保证 $1\le n \le 10$，$1\le k \le 5$。

对于另外 $25\%$ 的数据，保证 $k=0$。

对于 $100\%$ 的数据，保证 $1\le n\le 10^6$，$0 \le k \le 10^6$，$-10^9 \le {A_0}_i \le 1$。


---

---
title: "Happybob's Pencil Case (UBC001C)"
layout: "post"
diff: 普及+/提高
pid: P10923
tag: ['O2优化']
---
# Happybob's Pencil Case (UBC001C)
## 题目背景

注：本题无 typo。
## 题目描述

假设教室是一个 $n \times n$ 的 `01` 矩阵，`0` 表示空，`1` 表示有课桌（障碍）。

现在 Cuazyoxi 拿着 Happybob's Pencil Case 在 $(x_1, y_1)$ 处，Happybob 在 $(x_2, y_2)$ 处。

我们定义一次移动为往当前格子的上下左右一格移动。形式化地，假设当前一人（Cuazyoxi 或 Happybob）在 $(x, y)$ 处，如果 $(x + 1, y), (x, y + 1), (x - 1, y), (x, y - 1)$ 当中的某一个存在且不是障碍，则他可以移动到那一格。

每秒，Cuazyoxi 先移动一次或不动，然后 Happybob 移动一次或两次或者不动，每次移动后他们都知道对方的位置。

双方都很聪明。Cuazyoxi 想要让 Happybob 抓到他的时间尽量久，而 Happybob 想要尽早抓到 Cuazyoxi。

问：Cuazyoxi 还能躲避 Happybob 多少秒（Happybob 至少要多少秒后才能和 Cuazyoxi 达到同一个格子）？

## 输入格式

第一行，一个正整数 $n$，表示教室大小。

第二行，四个正整数 $x_1,y_1,x_2,y_2$，表示 Cuazyoxi 与 Happybob 的起点。

接下来 $n$ 行，每行一个长度为 $n$ 的字符串 $S$，这 $n$ 行的字符串构成一个 `01` 矩阵。

## 输出格式

如果 Cuazyoxi 迟早会被抓到，输出他被抓到的时间，否则输出 `inf`。
## 样例

### 样例输入 #1
```
3
1 1 3 3
011
011
000
```
### 样例输出 #1
```
2
```
### 样例输入 #2
```
3
1 1 3 3
011
111
110
```
### 样例输出 #2
```
inf
```
## 提示

**样例说明**

对于样例 $1$，Cuazyoxi 的最优策略显然是呆在原地不动，$2$ 秒后 Happybob 可以抓到他。

对于样例 $2$，无论如何 Happybob 都抓不到 Cuazyoxi。

**数据范围**

$2\le n\le 10$ 且 $1 \le x_1, x_2, y_1, y_2 \le n$。保证 $(x_1,y_1),(x_2,y_2)$ 上的数字是 `0` 且 $x_1\ne x_2$ 或 $y_1\ne y_2$。保证输入的 $n$ 个字符串长度都是 $n$ 且只含字符 `0` 与 `1`（可能只含 `1` 或只含 `0`）。


---

---
title: "Happybob's Pancake (UBC001E)"
layout: "post"
diff: 普及+/提高
pid: P10925
tag: ['O2优化']
---
# Happybob's Pancake (UBC001E)
## 题目描述

Happybob 想做一块煎饼，他决定在一个 $n$ 行 $n$ 列的斜正方形的锅里做一个煎饼，所以煎饼的大小不能超过斜正方形的大小。

由于原料有限，因此 Happybob 的煎饼必须是 $m$ 个长方形覆盖而成的。

Happybob 想知道，他能制作出的最大的煎饼的面积是多少。

---

**形式化题意：**

用 $m$ 个长方形覆盖大小为 $n$ 的斜正方形，最多覆盖多少个格子？

**斜正方形和覆盖的定义见说明/提示**。

## 输入格式

第一行，一个整数 $T$，表示询问数。

接下来 $T$ 行，每行两个整数 $n,m$，表示一次询问。

## 输出格式

$T$ 行，每一行表示一个询问的答案。

## 样例

### 样例输入 #1
```
3
5 1
6 2
8 2
```
### 样例输出 #1
```
9
20
32
```
## 提示

### 样例说明

三次询问的方案是：

![3](https://cdn.luogu.com.cn/upload/image_hosting/m8uup5uc.png)

![4](https://cdn.luogu.com.cn/upload/image_hosting/70a01fpj.png)

![5](https://cdn.luogu.com.cn/upload/image_hosting/lypuap4t.png)

（方案不唯一）

### 数据范围

$1\le T\le 50$，$1\le n\le 2\times 10^9$，$1\le m\le\lceil\dfrac{n}{2}\rceil$。

---

### 形式化定义

**斜正方形的定义：**

更形式化地，建立直角坐标系，定义一个大小为 $n$ 的**斜正方形**的**中心**为原点。

若 $n$ 为奇数，则该**斜正方形**可以描述为所有以 $\big\{(x, y) \big | |x| + |y| \le \lfloor \frac{n}{2} \rfloor \text{ and } x, y \in \Z\big\}$ 中的点为**正方形**中心的边长为 $1$ 的**正方形格子**组成的组合图形。

若 $n$ 为偶数，则该**斜正方形**可以描述为所有以 $\big\{(x, y) \big | |x| + |y| \le \frac{n}{2} \text{ and } (x + \frac{1}{2}), (y + \frac{1}{2}) \in \Z\big\}$ 中的点为**正方形**中心的边长为 $1$ 的**正方形格子**组成的组合图形。

一个 $n=5$ 的斜正方形（淡蓝色为格子中心）：

![1](https://cdn.luogu.com.cn/upload/image_hosting/b633qef0.png)

一个 $n=6$ 的斜正方形（淡蓝色为格子中心）：

![2](https://cdn.luogu.com.cn/upload/image_hosting/bzq2por3.png)

**覆盖方法的定义：**

定义一个长方形 $R$ 覆盖该**斜正方形**，当且仅当 $R$ 为由若干**格子**组成的长方形。

下面是一个覆盖斜正方形的长方形：

![3](https://cdn.luogu.com.cn/upload/image_hosting/7d0jsymo.png)

下面则**不是**覆盖斜正方形的长方形：

![4](https://cdn.luogu.com.cn/upload/image_hosting/2e2374s3.png)

![5](https://cdn.luogu.com.cn/upload/image_hosting/5j8wnvgb.png)

![6](https://cdn.luogu.com.cn/upload/image_hosting/rrxxe2ps.png)

定义一个**格子**被覆盖，当且仅当选择的 $m$ 个覆盖**斜正方形**的长方形中有至少一个完全包含该格子。



---

---
title: "走廊泼水节"
layout: "post"
diff: 普及+/提高
pid: P10928
tag: []
---
# 走廊泼水节
## 题目描述

给定一棵 $N$ 个节点的树，要求增加若干条边，把这棵树扩充为完全图，并满足图的唯一最小生成树仍然是这棵树。

求增加的边的权值总和最小是多少。

**注意：** 树中的所有边权均为整数，且新加的所有边权也必须为整数。
## 输入格式

第一行包含整数 $t$，表示共有 $t$ 组测试数据。

对于每组测试数据，第一行包含整数 $N$。

接下来 $N-1$ 行，每行三个整数 $X,Y,Z$，表示 $X$ 节点与 $Y$ 节点之间存在一条边，长度为 $Z$。
## 输出格式

每组数据输出一个整数，表示权值总和最小值。

每个结果占一行。
## 样例

### 样例输入 #1
```
2
3
1 2 2
1 3 3
4
1 2 3
2 3 4
3 4 5 
```
### 样例输出 #1
```
4
17
```
## 提示

数据保证，$1\leq t\leq 10$，$1 \le N \le 6000$，$1 \le Z \le 100$。


---

---
title: "黑暗城堡"
layout: "post"
diff: 普及+/提高
pid: P10929
tag: []
---
# 黑暗城堡
## 题目描述

在顺利攻破 Lord lsp 的防线之后，lqr 一行人来到了 Lord lsp 的城堡下方。

Lord lsp 黑化之后虽然拥有了强大的超能力，能够用意念力制造建筑物，但是智商水平却没怎么增加。

现在 lqr 已经搞清楚黑暗城堡有 $N$ 个房间，$M$ 条可以制造的双向通道，以及每条通道的长度。

lqr 深知 Lord lsp 的想法，为了避免每次都要琢磨两个房间之间的最短路径，Lord lsp 一定会把城堡修建成树形的。

但是，为了尽量提高自己的移动效率，Lord lsp 一定会使得城堡满足下面的条件：

设 $D[i]$ 为如果所有的通道都被修建，第 $i$ 号房间与第 $1$ 号房间的最短路径长度；而 $S[i]$ 为实际修建的树形城堡中第 $i$ 号房间与第 $1$ 号房间的路径长度；要求对于所有整数 $i$，有 $S[i]=D[i]$ 成立。

为了打败 Lord lsp，lqr 想知道有多少种不同的城堡修建方案。

保证至少存在一种可行的城堡修建方案。

你需要输出答案对 $2^{31}–1$ 取模之后的结果。
## 输入格式

第一行有两个整数 $N$ 和 $M$。

之后 $M$ 行，每行三个整数 $X，Y$ 和 $L$，表示可以修建 $X$ 和 $Y$ 之间的一条长度为 $L$ 的通道。
## 输出格式

一个整数，表示答案对 $2^{31}–1$ 取模之后的结果。

## 样例

### 样例输入 #1
```
3 3
1 2 2
1 3 1
2 3 1
```
### 样例输出 #1
```
2
```
## 提示

数据保证，$2 \le N \le 1000$，$N-1 \le M \le N(N-1)/2$，$1 \le L \le 100$。


---

---
title: "闇の連鎖"
layout: "post"
diff: 普及+/提高
pid: P10931
tag: []
---
# 闇の連鎖
## 题目描述

传说中的暗之连锁被人们称为 Dark。

Dark 是人类内心的黑暗的产物，古今中外的勇者们都试图打倒它。

经过研究，你发现 Dark 呈现无向图的结构，图中有 $N$ 个节点和两类边，一类边被称为主要边，而另一类被称为附加边。

Dark 有 $N - 1$ 条主要边，并且 Dark 的任意两个节点之间都存在一条只由主要边构成的路径。

另外，Dark 还有 $M$ 条附加边。 

你的任务是把 Dark 斩为不连通的两部分。

一开始 Dark 的附加边都处于无敌状态，你只能选择一条主要边切断。

一旦你切断了一条主要边，Dark 就会进入防御模式，主要边会变为无敌的而附加边可以被切断。

但是你的能力只能再切断 Dark 的一条附加边。

现在你想要知道，一共有多少种方案可以击败 Dark。

注意，就算你第一步切断主要边之后就已经把 Dark 斩为两截，你也需要切断一条附加边才算击败了 Dark。
## 输入格式

第一行包含两个整数 $N$ 和 $M$。 

之后 $N - 1$ 行，每行包括两个整数 $A$ 和 $B$，表示 $A$ 和 $B$ 之间有一条主要边。 

之后 $M$ 行以同样的格式给出附加边。
## 输出格式

输出一个整数表示答案。
## 样例

### 样例输入 #1
```
4 1
1 2
2 3
1 4
3 4
```
### 样例输出 #1
```
3
```
## 提示

数据保证，$1\le N \le 100000$，$1\le M \le 200000$，数据保证答案不超过 $2^{31}-1$。


---

---
title: "太鼓达人"
layout: "post"
diff: 普及+/提高
pid: P10950
tag: ['O2优化']
---
# 太鼓达人
## 题目描述

太鼓达人的鼓坏了，现在 vani 来修鼓。

鼓的主要元件是 $M$ 个围成一圈的传感器。

每个传感器都有开和关两种工作状态，分别用 $1$ 和 $0$ 表示。

显然，从不同的位置出发沿顺时针方向连续检查 $K$ 个传感器可以得到 $M$ 个长度为 $K$ 的 $01$ 串。

Vani 知道这 $M$ 个 $01$ 串应该是互不相同的。

而且鼓的设计很精密，$M$ 会取到可能的最大值。

现在 Vani 已经了解到了 $K$ 的值，他希望你求出 $M$ 的值，并给出字典序最小的传感器排布方案。
## 输入格式

一个整数 $K$。
## 输出格式

一个整数和一个二进制串，由一个空格分隔，分别表示可能的最大的 $M$ 以及字典序最小的排布方案。

字符 $0$ 表示关，$1$ 表示开，你输出的串的第一个字和最后一个字是相邻的。
## 样例

### 样例输入 #1
```
3
```
### 样例输出 #1
```
8 00010111
```
## 提示

$2\le K\le 11$。


---

---
title: "LCIS【数据暂时有误】"
layout: "post"
diff: 普及+/提高
pid: P10954
tag: []
---
# LCIS【数据暂时有误】
## 题目描述

熊大妈的奶牛在小沐沐的熏陶下开始研究信息题目。小沐沐先让奶牛研究了最长上升子序列，再让他们研究了最长公共子序列，现在又让他们要研究最长公共上升子序列了。

小沐沐说，对于两个串 $A$，$B$，如果它们都包含一段位置不一定连续的数字，且数字是严格递增的，那么称这一段数字是两个串的公共上升子串，而所有的公共上升子串中最长的就是最长公共上升子串了。
    
奶牛半懂不懂，小沐沐要你来告诉奶牛什么是最长公共上升子串。不过，只要告诉奶牛它的长度就可以了。
## 输入格式

第一行 $N$，表示 $A$，$B$ 的长度。

第二行，串 $A$。

第三行，串 $B$。
## 输出格式

输出长度。
## 样例

### 样例输入 #1
```
4
2 2 1 3
2 1 2 3
```
### 样例输出 #1
```
2
```
## 提示

$1\le N \le 3000$，$A$，$B$ 中的数字不超过 maxlongint


---

---
title: "环路运输"
layout: "post"
diff: 普及+/提高
pid: P10957
tag: []
---
# 环路运输
## 题目描述

在一条环形公路旁均匀地分布着 $N$ 座仓库，编号为 $1 \sim N$，编号为 $i$ 的仓库与编号为 $j$ 的仓库之间的距离定义为 $dist(i,j)=\min⁡(|i-j|,N-|i-j|)$，也就是逆时针或顺时针从 $i$ 到 $j$ 中较近的一种。

每座仓库都存有货物，其中编号为 $i$ 的仓库库存量为 $A_i$。

在 $i$ 和 $j$ 两座仓库之间运送货物需要的代价为 $A_i+A_j+dist(i,j)$。

求在哪两座仓库之间运送货物需要的代价最大。
## 输入格式

第一行包含一个整数 $N$。

第二行包含 $N$ 个整数 $A_1 \sim A_N$。
## 输出格式

输出一个整数，表示最大代价。

## 样例

### 样例输入 #1
```
5
1 8 6 2 5
```
### 样例输出 #1
```
15
```
## 提示

数据保证，$2 \le N \le 10^6$，$1 \le A_i \le 10^7$。


---

---
title: "[IOI 2000] 邮局（原始版）"
layout: "post"
diff: 普及+/提高
pid: P10967
tag: ['2000', 'IOI', 'O2优化']
---
# [IOI 2000] 邮局（原始版）
## 题目描述

高速公路旁边有一些村庄。高速公路表示为整数轴，每个村庄的位置用单个整数坐标标识。没有两个在同样地方的村庄。两个位置之间的距离是其整数坐标差的绝对值。

邮局将建在一些，但不一定是所有的村庄中。为了建立邮局，应选择他们建造的位置，使每个村庄与其最近的邮局之间的距离总和最小。

你要编写一个程序，已知村庄的位置和邮局的数量，计算每个村庄和最近的邮局之间所有距离的最小可能的总和。
## 输入格式

第一行包含两个整数：第一个是村庄 $V$ 的数量，第二个是邮局的数量 $P$。

第二行包含 $V$ 个整数。这些整数是村庄的位置。
## 输出格式

第一行包含一个整数 $S$，它是每个村庄与其最近的邮局之间的所有距离的总和。
## 样例

### 样例输入 #1
```
10 5
1 2 3 6 7 9 11 22 44 50
```
### 样例输出 #1
```
9
```
## 提示

数据保证，$1 \le V \le 300$，$1 \le P \le 30$，$P \le V$，$1 \le X \le 10000$。


---

---
title: "Coins"
layout: "post"
diff: 普及+/提高
pid: P10973
tag: []
---
# Coins
## 题目描述

银国的人们使用硬币。他们有面值分别为 $A_1, A_2, A_3, \dots, A_n$ 的硬币。有一天，托尼打开了他的储蓄罐，发现里面有一些硬币。他决定去附近的商店购买一块非常漂亮的手表。他想要支付准确的价格（不找零），而他知道手表的价格不会超过 $m$ 。但他不知道手表的确切价格。

你需要编写一个程序，读取 $n$、$m$、$A_1, A_2, A_3, \dots, A_n$ 以及对应的数量 $C_1, C_2, C_3, \dots, C_n$ （表示托尼拥有的每种面值的硬币数量），然后计算托尼可以用这些硬币支付的价格数量（从 1 到 $m$ 的所有价格）。
## 输入格式

输入包含多个测试用例（不超过 $25$ 组）。每个测试用例的第一行包含两个整数 $n (1 ≤ n ≤ 100)$ 和 $m (m ≤ 100000)$。第二行包含 $2n$ 个整数，分别表示 $A_1, A_2, A_3, \dots, A_n$ 和 $C_1, C_2, C_3, \dots, C_n (1 ≤ A_i ≤ 100000, 1 ≤ C_i ≤ 1000)$。最后一个测试用例以两个零结尾。

## 输出格式

对于每个测试用例，在单独的一行输出答案。
## 样例

### 样例输入 #1
```
3 10
1 2 4 2 1 1
2 5
1 4 2 1
0 0
```
### 样例输出 #1
```
8
4
```


---

---
title: "统计重复个数"
layout: "post"
diff: 普及+/提高
pid: P10976
tag: []
---
# 统计重复个数
## 题目描述

定义 $str = [s, n]$ 表示 $str$ 由 $n$ 个字符串 $s$ 连接构成。

例如，$str == [\texttt{abc}, 3] == \texttt{abcabcabc}$。
如果可以从 $s_2$ 中删除某些字符使其变为 $s_1$，则称字符串 $s_1$ 可以从字符串 $s_2$ 获得。

例如，根据定义，$s1 = \tt{abc}$ 可以从 $s2 = \tt{ab\red{dbe}c}$ 获得，仅需要删除红色标识的字符。

现在给你两个字符串 $s_1$ 和 $s_2$ 和两个整数 $n_1$ 和 $n_2$。由此构造得到两个字符串，其中 $str_1 = [s_1, n_1]$、$str_2 = [s_2, n_2]$。

请你找出一个最大整数 $m$，以满足 $str = [str_2, m]$ 可以从 $str_1$ 获得。
## 输入格式

本题有多组测试数据。测试数据不超过 $100$ 组。

对于每组测试数据，分为两行：
- 第一行输入字符串 $s_1$ 和整数 $n_1$；
- 第二行输入字符串 $s_2$ 和整数 $n_2$；
## 输出格式

对于每组测试数据，输出整数 $m$ 表示答案。
## 样例

### 样例输入 #1
```
ab 2
acb 4
acb 1
acb 1
```
### 样例输出 #1
```
2
1
```
## 提示

数据保证，$s_1,s_2$ 全为小写字母构成，且 $1\leq |s_1|,|s_2| \leq 100$，$1\leq n_1,n_2\leq 10^6$，每个测试点的测试数据不超过 $100$ 组。


---

---
title: "Yet another ZP problem"
layout: "post"
diff: 普及+/提高
pid: P11055
tag: ['Special Judge', 'O2优化']
---
# Yet another ZP problem
## 题目描述

从左到右排列着 $n$ 个点，编号分别为 $1,2,\dots,n$。

你要在他们之间连一些边，记边集为 $E=\{(x,y)\ |\ 1\leq x<y\leq n\}$。

我们称边集 $E$ 满足限制 $[l,r]$，当且仅当存在 $(x,y)\in E$ 使得 $[x\in[l,r]]+[y\in[l,r]]=1$。

基础地，我们希望对所有 $1\leq i\leq n$ 满足限制 $[i,i]$。

在此基础上，输入还给定了额外的 $m$ 个限制 $[l_i,r_i]$（$1\leq l_i<r_i\leq n$ 并且 $[l_i,r_i]\neq [1,n]$）。

请问 $|E|$ 最小是多少，在此基础上给出一组合法构造。可以证明，合法的 $E$ 总是存在的。

对于形如 $[P]$ 的表达式，当且仅当命题 $P$ 为真时其取值为 $1$，否则取值为 $0$。
## 输入格式

第一行输入两个整数 $n,m$。

接下来 $m$ 行每行两个正整数 $l_i,r_i$。
## 输出格式

第一行输出一个数代表 $|E|$。

接下来 $|E|$ 行，每行两个数 $x,y$ 代表一条边，**注意你需要保证 $1\le x<y\le n$**。
## 样例

### 样例输入 #1
```
4 3
1 2
3 4
1 2
```
### 样例输出 #1
```
2
1 4
2 3
```
## 提示

### 样例解释

对于限制 $[1, 1]$，存在边 $(1, 4)$ 使得 $[1 \in [1, 1]] + [4 \in [1, 1]] = 1$。

对于限制 $[3, 4]$，存在边 $(1, 4)$ 使得 $[1 \in [3, 4]] + [4 \in [3, 4]] = 1$。

对于限制 $[2, 2]$，存在边 $(2, 3)$ 使得 $[2 \in [2, 2]] + [3 \in [2, 2]] = 1$。

### 数据范围

对于所有数据，保证 $3\leq n\leq 10^4$，$0\leq m\leq 10^5$，$1\le l_i<r_i\le n$，$[l_i,r_i]\ne [1,n]$。

| 测试点编号 | 特殊性质 |
| :----------: | :----------: |
| $1\sim 5$ | $n,m\le 5$ |
| $6\sim 7$ | $m=0$ |
| $8\sim 11$ | $r_i<l_{i+1}$ |
| $12\sim 14$ | $l_i=1$ |
| $15\sim 20$ | 无 |

**对于第 $i$ 个测试点，保证 $n$ 的奇偶性与 $i$ 的奇偶性相同，$m$ 的奇偶性与 $\lfloor\frac{i}{2}\rfloor+1$ 的奇偶性相同。**


---

---
title: "【MX-X4-T4】「Jason-1」一步最优"
layout: "post"
diff: 普及+/提高
pid: P11064
tag: ['O2优化', '梦熊比赛']
---
# 【MX-X4-T4】「Jason-1」一步最优
## 题目背景

原题链接：<https://oier.team/problems/X4E>。
## 题目描述

对于如下问题：

- 给定长度为 $n$ 的数列 $a_1, \ldots, a_n$（其中 $a_i$ 可能为负数）以及一个正整数 $m$。
- 你需要选择不超过 $m$ 个数列 $a$ 的下标区间 $[l_j, r_j]$，且确保它们互不相交。
- 你需要最大化选择的区间中的元素之和的总和，即最大化 $\sum_j \sum_{i = l_j}^{r_j} a_i$。

考虑该贪心算法（并不正确）：

- 重复如下过程 $m$ 次：
- 在所有与当前已选择的区间不相交的区间（包括空区间）中，选择一个元素之和最大的区间。
  - **如果有多个元素之和最大的区间，从中任意选择一个。**
  - 注：若选择了空区间，等价于中止过程，即选择的区间数量不超过 $m$ 个。
- 将如上过程中选择的所有非空区间中的元素之和作为答案。

现给定 $n$ 和数列 $a_1, \ldots, a_n$，对于每个 $m \in [1, n]$，请求出该算法可能得到的答案（即区间和的总和）的最大值和最小值。
## 输入格式

**本题输入包含多组数据。**

第一行，一个正整数 $T$，表示数据组数。对于每组数据：

- 第一行，一个正整数 $n$。
- 第二行，$n$ 个整数 $a_1, \ldots, a_n$。
## 输出格式

对于每组数据：

- 第一行，$n$ 个整数，第 $i$ 个整数表示当 $m = i$ 时，该算法能够得到的答案的**最大值**；
- 第二行，$n$ 个整数，第 $i$ 个整数表示当 $m = i$ 时，该算法能够得到的答案的**最小值**。

## 样例

### 样例输入 #1
```
5
5
1 -1 1 -1 1
5
2 -2 2 -1 2
6
3 1 -4 1 -5 9 
13
1 1 -4 5 -1 -4 1 9 1 9 -8 1 0
16
1 -8 2 -7 3 -6 4 -5 5 -4 4 -3 3 -2 2 -1

```
### 样例输出 #1
```
1 2 3 3 3
1 1 1 1 1
3 5 5 5 5
3 3 3 3 3
9 13 14 14 14 14
9 13 14 14 14 14
20 25 27 28 28 28 28 28 28 28 28 28 28
20 22 23 23 23 23 23 23 23 23 23 23 23
5 9 13 16 19 21 23 24 24 24 24 24 24 24 24 24
5 9 12 14 15 15 15 15 15 15 15 15 15 15 15 15

```
## 提示

**【样例解释】**

对于第一组数据，

- 一种取到最大值的方案为，依次选择区间 $[1,1],[3,3],[5,5],\varnothing, \varnothing$；
- 一种取到最小值的方案为，依次选择区间 $[1,5],\varnothing,\varnothing,\varnothing,\varnothing$。

对于第二组数据，

- 一种取到最大值的方案为，依次选择区间 $[3,5],[1,1],\varnothing,\varnothing,\varnothing$；
- 一种取到最小值的方案为，依次选择区间 $[1,5],\varnothing,\varnothing,\varnothing,\varnothing$。

需要注意：在第一次更新时，无法选择区间 $[1,1],[1,3],[3,3]$ 等，因为它们不满足区间和在所有 $S$ 中的区间内最大（即 $= 3$）。在任意一次更新时，都无法选择区间 $[2,2]$，因为其区间和为 $-2$，而 $-2 < 0$（即空区间的区间和）。

对于第三组数据，只有唯一的选择方案，即依次选择区间 $[6,6],[1,2],[4,4],\varnothing,\varnothing,\varnothing$。


**【数据范围】**

**本题采用捆绑测试。**

| 子任务 | $n \le$ | $\sum n \le$ | 分值 |
| :----------: | :----------: | :----------: | :----------: |
| 1 | $10$ | $50$ | $17$ |
| 2 | $100$ | $500$ | $24$ |
| 3 | $2000$ | $10^4$ | $13$ |
| 4 | $10^4$ | $5 \times 10^4$ | $9$ |
| 5 | $10^5$ | $5 \times 10^5$ | $37$ |

对于 $100 \%$ 的数据，$1 \le T \le 10^4$，$1 \le n \le 10^5$，$\sum n \le 5 \times 10^{5}$，$|a_i| \le 10^9$。


---

---
title: "[ROIR 2024] 细菌 (Day 2)"
layout: "post"
diff: 普及+/提高
pid: P11125
tag: ['2024', 'Special Judge', 'ROIR（俄罗斯）']
---
# [ROIR 2024] 细菌 (Day 2)
## 题目背景

翻译自 [ROIR 2024 D2T2](https://neerc.ifmo.ru/school/archive/2023-2024/ru-olymp-regional-2024-day2.pdf)。

生物实验室中正在进行实验。开始时，有 $n$ 个冷冻的细菌，编号从 $1$ 到 $n$。根据实验计划，编号为 $i$ 的细菌将在实验开始后的 $a_i$ 秒进入培养皿。如果有多个细菌的 $a$ 相等，它们会同时进入。

一旦冷冻的细菌进入培养皿，它们会被解冻并开始成熟。编号为 $i$ 的细菌成熟需要 $t_i$ 秒。一旦细菌成熟，它们会开始繁殖：立即分裂成两个成熟的细菌，然后在接下来的每一秒钟，每个成熟细菌都会再次分裂成两个成熟的细菌。
## 题目描述

培养菌落的规模指的是培养皿中细菌的总数。实验的目标是确定多长时间后，培养菌落的规模首次恰好等于 $m$。请帮助科学家确定这个时间秒数，或者判断培养群体的规模是否永远不会恰好等于 $m$。
## 输入格式

第一行给出两个整数 $n$ 和 $m$（$1 \leq n \leq 2 \times 10^5$，$1 \leq m \leq 10^9$），分别表示细菌的数量和期望的培养菌落规模。

第二行给出 $n$ 个整数 $a_1, a_2, \dots, a_n$（$1 \leq a_i \leq 10^9$），表示细菌进入培养皿的时间。

第三行给出 $n$ 个整数 $t_1, t_2, \dots, t_n$（$1 \leq t_i \leq 10^9$），表示冷冻的细菌成熟所需的时间。
## 输出格式

如果培养菌落的规模永远不会等于 $m$，则输出 `-1`。否则，输出在实验开始后多少秒，培养群体的规模首次恰好等于 $m$。
## 样例

### 样例输入 #1
```
4 11
3 5 1 10
2 9 2 13
```
### 样例输出 #1
```
5
```
### 样例输入 #2
```
13 124
5 6 8 8 1 6 4 6 4 7 10 3 9
5 2 10 5 2 1 1 4 8 3 4 1 9
```
### 样例输出 #2
```
8
```
## 提示

下表是样例 $1$ 的实验进展：

| 时间 | 细菌 $1$ | 细菌 $2$ | 细菌 $3$ | 细菌 $4$ | 总数 |
|:------:|:--------:|:--------:|:--------:|:--------:|:------:|
| $0$    | 冷冻   | 冷冻   | 冷冻   | 冷冻   | $0$    |
| $1$    | 冷冻   | 冷冻   | 在培养皿中，成熟中 | 冷冻   | $1$    |
| $2$    | 冷冻   | 冷冻   | 在培养皿中，成熟中 | 冷冻   | $1$    |
| $3$    | 在培养皿中，成熟中 | 冷冻   | 在培养皿中，成熟，$2$ 只细菌 | 冷冻 | $3$    |
| $4$    | 在培养皿中，成熟中 | 冷冻   | 在培养皿中，成熟，$4$ 只细菌 | 冷冻 | $5$    |
| $5$    | 在培养皿中，成熟，$2$ 只细菌 | 在培养皿中，成熟中 | 在培养皿中，成熟，$8$ 只细菌 | 冷冻 | $11$   |

注意：细菌的繁殖过程会导致每秒钟细菌数目翻倍。

| 子任务 | 分值 | 特殊性质 |
| :----------: | :----------: | :----------: |
| $0$ | $0$ | 同样例 |
| $1$ | $13$ | $m\le n,a_i\le10^5,t_i=10^9$ |
| $2$ | $14$ | $a_i=i$，所有 $t_i$ 相等 |
| $3$ | $17$ | $n,a_i,t_i\le3000$ |
| $4$ | $23$ | $a_i=1$ |
| $5$ | $33$ | 无 |

对于 $100\%$ 的数据，$1 \leq n \leq 2 \times 10^5$，$1 \leq m \leq 10^9$，$1 \leq a_i,t_i \leq 10^9$。


---

---
title: "[APC001] F - Extend"
layout: "post"
diff: 普及+/提高
pid: P11141
tag: ['O2优化']
---
# [APC001] F - Extend
## 题目背景

~~**本题输入输出量较大，请酌情使用较快的输入输出方式**~~。已扩大时限从 $1s\to 1.5s$。
## 题目描述

对于一棵有 $n$ 个节点，根为 $k$ 的树，最开始有且仅有一个“可扩展的”节点 $z$，我们有两种扩展形式：

- $\text{I}$ 类扩展：从一个“可扩展的”节点 $u$ 开始扩展，把 $u$ 的子树中所有节点和所有满足与 $u$ 距离 $\leq p$ 且是 $u$ 祖先的节点标记为“可扩展的”。
- $\text{II}$ 类扩展：从一个“可扩展的”节点 $u$ 开始扩展，把所有与 $u$ 深度相等的节点标记为“可扩展的”。

你需要将所有结点都标记为“可扩展的”，求最小进行扩展的次数。
## 输入格式

第一行两个整数 $n,k$。

接下来 $n-1$ 行，每行两个整数 $u,v$，表示存在一条无向边连接 $u,v$。

接下来一行一个整数 $t$，表示询问次数。

接下来 $t$ 行，每行两个整数 $z,p$，意义如上。
## 输出格式

$t$ 行，对于每次询问：

- 若无法将所有节点都标记为“可扩展的”，输出 `-1`。

- 否则一行一个整数，表示答案。
## 样例

### 样例输入 #1
```
3 1
1 2
1 3
2
2 6
2 1
```
### 样例输出 #1
```
2
2
```
### 样例输入 #2
```
4 1
2 1
3 2
4 3
3
2 2
2 5
4 2
```
### 样例输出 #2
```
1
1
2
```
### 样例输入 #3
```
20 11
2 8
16 4
6 7
11 8
10 13
7 10
17 7
15 13
10 14
18 19
1 2
6 3
12 1
1 5
1 4
2 3
9 5
14 20
5 18
15
9 269
1 522
6 327
13 726
14 8
17 2
18 4
15 64
9 5
13 3
18 1
19 664
5 3
20 5
6 4
```
### 样例输出 #3
```
2
2
2
2
2
3
2
2
2
3
5
2
2
3
2
```
## 提示

样例 $1$ 解释：两次询问都可以先对 $2$ 节点进行 $\text{II}$ 类扩展，然后对 $3$ 进行 $\text{I}$ 类扩展。可以保证对于两次询问，这样操作都是最优的。

对于所有数据，$1\leq z,k,u,v\leq n\leq 10^5,1\leq t\leq 2\times 10^6,0\leq p\leq 10^{18}$。


---

---
title: "[ROIR 2018] 电梯 (Day1)"
layout: "post"
diff: 普及+/提高
pid: P11178
tag: ['2018', 'ROIR（俄罗斯）']
---
# [ROIR 2018] 电梯 (Day1)
## 题目描述

**译自 ROI 2018 Regional. Day1 T3.** ***[Лифт](http://neerc.ifmo.ru/school/archive/2017-2018/ru-olymp-regional-2018-day1.pdf)***

某公司有一座大厦，大厦有 $m$ 层，自底向上依次称作 $1\ldots m$ 楼（层）。

有 $n$ 名雇员在大厦中工作，其编号分别为 $1\ldots n$。每天下班时，所有雇员都需坐电梯下到一楼，并离开大厦。已知开始时 $i$ 号雇员位于 $a_i$ 层，该雇员在第 $t_i$ 秒到达该层的电梯口。

每层都有可能有人在等电梯。当一名雇员到达电梯口时，如果这层已经有人摁电梯了，他会等电梯；如果这层没人摁电梯，则他会去摁电梯。摁电梯会给电梯主控发送一个请求信号。

开始时电梯空闲，位于一楼。电梯每秒可以上升 / 下降一层。当第一次有人摁电梯时，电梯会响应该信号，到达对应楼层。如果电梯同时接受到多个信号，则它会响应编号较小的员工的请求信号。

电梯上升至对应楼层时，所有在这层楼等电梯的人都会进入电梯，然后电梯以同样的速度下降，直到电梯到达一楼。对于电梯下降过程中会经过的楼层，如果电梯到达该楼层时该楼层有请求信号，则电梯会在该楼层停，所有在该楼层等电梯的人都会进入电梯。

如果电梯空闲时有至少一个未响应的信号，则电梯会响应最早者。如果有多个最早者，则响应编号最小者。电梯会持续运作，直到 $n$ 名雇员全部到达一楼。

雇员进出电梯的时间忽略不计。每一秒开始时，人们先摁电梯，然后进行对应的行为。（电梯上升 / 下降一层，人们进出电梯，电梯决定响应哪个信号）

请求出每位雇员何时到达一楼。
## 输入格式

- 第一行：$n,m$
- 接下来 $n$ 行，每行两个整数，表示 $t_i,a_i$
## 输出格式

$n$ 行，每行一个整数，表示答案。
## 样例

### 样例输入 #1
```
5 4
2 3
2 4
5 2
5 3
9 3
```
### 样例输出 #1
```
6
12
6
12
12
```
## 提示

### 样例解释

|时刻|1 楼| 2 楼| 3 楼| 4 楼|
|-|-|-|-|-|
|0|$\tt []$|&nbsp;||&nbsp;|
|1|$\tt []$||&nbsp;||
|2|$\tt []↑3$|&nbsp;|$\tt ☺\:\:1$|$\tt ☺\:\:2$|
|3||$\tt []↑3$|$\tt ☺\:\:1$|$\tt ☺\:\:2$|
|4|&nbsp;||$\tt []←☺\:\:1$|$\tt ☺\:\:2$|
|5||$\tt [☺\:\:1]←☺\:\:3$|$\tt ☺\:\:4$|$\tt ☺\:\:2$|
|6|$\tt [☺\:\:1→,☺\:\:3→]↑4$||$\tt ☺\:\:4$|$\tt ☺\:\:2$|
|7||$\tt []↑4$|$\tt ☺\:\:4$|$\tt ☺\:\:2$|
|8|&nbsp;||$\tt []↑4  ☺\:\:4$|$\tt ☺\:\:2$|
|9||&nbsp;|$\tt ☺\:\:4,☺\:\:5$|$\tt []←☺\:\:2$|
|10|&nbsp;||$\tt [☺\:\:2]←☺\:\:4,←☺\:\:5$||
|11||$\tt [☺\:\:2,☺\:\:4,☺\:\:5]$||&nbsp;|
|12|$\tt [☺\:\:2→,☺\:\:4→,☺\:\:5→]$||&nbsp;||

---
|符号|含义|符号|含义|
|-|-|-|-|
|$\tt []↑3$|电梯将上到 3 楼|$\tt []←☺\:\:1$|1 号雇员进入电梯|
|$\tt [☺\:\:1→,☺\:\:3→]$|1 号和 3 号雇员走出电梯|$\tt [☺\:\:1→]↑4$|1 号雇员走出电梯后，电梯准备上到 4 楼|

### 数据范围

对于所有数据，$1 \leqslant n \leqslant 10^5,$ $2 \leqslant m \leqslant 10^9,$ $1 \leqslant t_1 \leqslant t_2 \leqslant \dots \leqslant t_n \leqslant 10^9, 2 \leqslant a_i \leqslant m$.

|子任务 #|分值|$n$|$m$|$t_i$|
|-|-|-|-|-|
|1|15|$n = 1$|$2 \leqslant m \leqslant 100$|$1 \leqslant t_i \leqslant 100$|
|2|30|$1 \leqslant n \leqslant 100$|$2 \leqslant m \leqslant 100$|$1 \leqslant t_i \leqslant 100$|
|3|16|$1 \leqslant n \leqslant 100$&nbsp;|$2 \leqslant m \leqslant 10^9$|$1 \leqslant t_i \leqslant 10^9$|
|4|12|$1 \leqslant n \leqslant 10^5$|$2 \leqslant m \leqslant 10^4$|$1 \leqslant t_i \leqslant 10^4$|
|5|27|$1 \leqslant n \leqslant 10^5$&nbsp;|$2 \leqslant m \leqslant 10^9$|$1 \leqslant t_i \leqslant 10^9$|


---

---
title: "三目运算"
layout: "post"
diff: 普及+/提高
pid: P11186
tag: ['洛谷原创', '洛谷月赛']
---
# 三目运算
## 题目描述

三目运算是一种比较特殊的运算，功能类似于 `if` 语句，其语法格式如下：

`条件?数值1:数值2`，三目运算得到的结果也是数值。当条件成立时得到的结果是数值 1，不成立时得到的结果为数值 2。

例如，`x>5?8:6` 就是一种三目运算表达式（也是分段常数表达式，见下文）。当 $x=7$ 时，该表达式的结果为 $8$，而 $x=3$ 时，该表达式的结果为 $6$。

---

本题中，称满足下列条件中**至少一条**的字符串 $S$ 是**分段常数表达式**：

- 十进制正整数 $a$，如 `243`，是分段常数表达式。
- 如果 $a$ 为一个十进制正整数，$p,q$ 为两个分段常数表达式，则 $\texttt{x>}a\texttt{?}p\texttt{:}q$ 是分段常数表达式。
- 如果 $a$ 为一个十进制正整数，$p,q$ 为两个分段常数表达式，则 $\texttt{x<}a\texttt{?}p\texttt{:}q$ 是分段常数表达式。

（后两条条件中， $x>a$ 和 $x<a$ 是条件，$p,q$ 为数值，该表达式是三目运算表达式。）

例如，`x>154?220:x<37?16:10` 是一个分段常数表达式，因为 `220` 和 `x<37?16:10` 都是分段常数表达式，从而整个表达式由第 2 条规则也是分段常数表达式。

---

给出一个分段常数表达式 $S$，保证出现的正整数均不超过 $m$。

yummy 有 $q$ 个询问，每次给出一个自然数 $x$ 的值，希望你求出分段常数表达式的值。
## 输入格式

输入的第一行有两个正整数 $m,q$，分别表示表达式出现数字的最大可能值和询问个数。

第二行有一个字符串 $S$，表示这个分段常数表达式。

之后有 $q$ 行，每行有一个自然数 $x$，表示一次询问。
## 输出格式

对于每个询问输出一行一个正整数，表示表达式的结果。
## 样例

### 样例输入 #1
```
20 5
x>12?x<15?4:10:x<12?14:7
15
12
14
7
1000000
```
### 样例输出 #1
```
10
7
4
14
10

```
### 样例输入 #2
```
参见 expr/expr2.in
```
### 样例输出 #2
```
参见 expr/expr2.ans
```
### 样例输入 #3
```
参见 expr/expr3.in
```
### 样例输出 #3
```
参见 expr/expr3.ans
```
### 样例输入 #4
```
参见 expr/expr4.in
```
### 样例输出 #4
```
参见 expr/expr4.ans
```
## 提示

【样例 1 解释】

如果我们进行适当的换行和缩进可以得到：

```cpp
x>12?    //如果 x>12
  x<15?  //那么判断 x<15 是否成立
    4    //如果是则得到 4
    :10  //如果不是则得到 10
  :x<12? //否则（如果 x<=12) 判断 x<12 是否成立
    14   //如果是则返回 14
    :7   //如果不是则返回 7
```

按照这个思路模拟即可得到样例输出。

【样例 2 解释】

该样例满足测试点 $6$ 的性质。

【样例 3 解释】

该样例满足测试点 $10$ 的性质。

【样例 4 解释】

该样例满足测试点 $19$ 的性质。

【数据范围】

设 $n$ 为 $S$ 中三目运算符的个数。（选手可以通过 $n$ 来估计 $S$ 的串长。）

对于全体数据，保证 $0\le n\le 10^5$，$1\le m\le 10^5$，$1\le q\le 10^5​$，$1\le x\le 10^9$，且 $S$ 是分段常数表达式。

| 测试点编号  | $n\le$ | $m\le$ | $q\le$ |
|:-:|:-:|:-:|:-:|
| $1$         | $0$    | $10^5$ | $10$   |
| $2$         | $1$   | $10^5$ | $10$   |
| $3\sim 5$   | $100$ | $9$    | $10$   |
| $6\sim 9$   | $100$ | $10^5$ | $10$   |
| $10\sim 12$ | $10^5$ | $9$    | $10$   |
| $13\sim 16$ | $10^5$ | $10^5$ | $10$   |
| $17\sim 18$ | $10^5$ | $9$    | $10^5$ |
| $19\sim 25$ | $10^5$ | $10^5$ | $10^5$ |


---

---
title: "配对序列"
layout: "post"
diff: 普及+/提高
pid: P11187
tag: ['洛谷原创', '洛谷月赛']
---
# 配对序列
## 题目描述

一个序列 $s_1,\ldots s_{2k}$ 是**配对的**，当且仅当：

- 对于任意 $1\le i \le k$，$s_{2i}=s_{2i-1}$。
- 对于任意 $1\le i<k$，$s_{2i}\ne s_{2i+1}$。

注意，配对的序列长度必然为偶数。

例如，$3,3,5,5,2,2$ 是配对的，而 $2,2,2,2,5,5$（$s_2=s_3$ 不满足第二条要求）或者 $1,2,3,3,1,1$（$s_1\ne s_2$ 不满足第一条要求）都不是配对的。

给出一个数列 $a_1,\ldots, a_n$，求所有配对的子序列长度的最大值。
## 输入格式

输入的第一行有一个正整数 $n$，表示序列的长度。

第二行有 $n$ 个正整数 $a_1,\ldots,a_n$，表示这个序列。
## 输出格式

输出一行一个自然数，表示最长的配对子序列长度。特别地，如果不存在非空的配对子序列，那么输出 $0$。
## 样例

### 样例输入 #1
```
8
1 2 2 2 2 1 2 2

```
### 样例输出 #1
```
4

```
### 样例输入 #2
```
11
1 1 4 1 1 2 1000 2 5 5 4

```
### 样例输出 #2
```
6

```
### 样例输入 #3
```
参见 pairing3.in
```
### 样例输出 #3
```
参见 pairing3.out
```
### 样例输入 #4
```
参见 pairing4.in
```
### 样例输出 #4
```
参见 pairing4.out
```
## 提示

【样例 1 解释】

取 $1,1,2,2$ 这个子序列即可。

【样例 2 解释】

取 $1,1,2,2,5,5$ 这个配对子序列即可。

【样例 3 解释】

该样例符合测试点 $3$ 的限制。

【样例 4 解释】

该样例符合测试点 $12$ 的限制。

【数据范围】

对于全体数据，保证 $2\le n\le 5\times 10^5$，$1\le a_i\le 5\times 10^5$。

|测试点编号|$n\le$|$a_i\le$|特殊性质|
|:-:|:-:|:-:|:-:|
|$1\sim 2$|$18$|$5\times 10^5$||
|$3\sim 5$|$500$|$500$||
|$6\sim 7$|$5000$|$5000$||
|$8\sim 9$|$5000$|$5\times 10^5$||
|$10$|$5\times 10^5$|$5\times 10^5$|每个数最多出现 $1$ 次|
|$11$|$5\times 10^5$|$5\times 10^5$|$a_i\le a_{i+1}$ 恒成立|
|$12\sim 14$|$5\times 10^5$|$5\times 10^5$|每个数最多出现 $2$ 次|
|$15\sim 20$|$5\times 10^5$|$5\times 10^5$||


---

---
title: "【MX-S4-T1】「yyOI R2」youyou 的垃圾桶"
layout: "post"
diff: 普及+/提高
pid: P11217
tag: ['O2优化', '梦熊比赛']
---
# 【MX-S4-T1】「yyOI R2」youyou 的垃圾桶
## 题目背景

原题链接：<https://oier.team/problems/S4A>。
## 题目描述

现在有 $n$ 个垃圾桶，它们对 youyou 发起攻击。第 $i$ 个垃圾桶的初始攻击力为正整数 $a_i$。youyou 的初始生命值为正整数 $W$。

定义如下流程为一场战斗：

- 从第 $1$ 个垃圾桶开始，每个垃圾桶依次进行攻击。第 $i$ 个垃圾桶发起攻击时，youyou 的生命值 $W$ 减去 $a_i$，然后本次战斗第 $i$ 个垃圾桶的攻击力 $a_i$ 翻倍。在第 $n$ 个垃圾桶攻击完后，重复执行此流程。

当 $W\le 0$ 时，也即 youyou 死亡时，本场战斗立刻结束。然后重置 youyou 的生命值 $W$ 以及所有垃圾桶的攻击力 $a_i$ 为本场战斗之前的值。

定义本次战斗的评分为受到垃圾桶攻击的次数（不包括恰好使 youyou 死亡的垃圾桶的攻击）。

现在一共要进行 $q$ 场战斗，每场战斗给出三个数 $l,r,d$，表示先对第 $[l,r]$ 只垃圾桶进行强化，使这些垃圾桶的初始攻击力 $a_i$ 增加 $d$，然后进行一场战斗。你需要告诉 youyou 此次战斗的评分。

**每场战斗前对垃圾桶初始攻击力的增加会对之后所有的战斗产生影响。**
## 输入格式

第一行为三个整数 $n,q,W$，分别表示垃圾桶个数、战斗次数、生命值。

第二行为 $n$ 个整数，第 $i$ 个数表示进行所有战斗之前第 $i$ 个垃圾桶的攻击力 $a_i$。

下面 $q$ 行，第 $i$ 行为三个整数 $l,r,d$，表示第 $i$ 场战斗前强化的参数。
## 输出格式

输出共 $q$ 行，第 $i$ 行输出一个数 $s_i$ 表示第 $i$ 次战斗的评分。
## 样例

### 样例输入 #1
```
6 4 75
9 1 4 5 1 4
1 1 1
3 5 3
3 5 1
3 5 3

```
### 样例输出 #1
```
11
9
8
8

```
## 提示

**【样例解释 #1】**

四场战斗前的强化分别是：

- 对 $[1,1]$ 的垃圾桶增加 $1$ 点攻击力。
- 对 $[3,5]$ 的垃圾桶增加 $3$ 点攻击力。
- 对 $[3,5]$ 的垃圾桶增加 $1$ 点攻击力。
- 对 $[3,5]$ 的垃圾桶增加 $3$ 点攻击力。

第一场战斗，垃圾桶的初始攻击力分别为 $10,1,4,5,1,4$。

youyou 首先分别依次受到这些垃圾桶的攻击各一次，此时剩余生命值 $50$。垃圾桶攻击力变为 $20,2,8,10,2,8$。

接着 youyou 受到第一只垃圾桶的攻击，剩余生命值为 $30$。

受到第二只垃圾桶攻击，剩余生命值 $28$。

受到第三只垃圾桶攻击，剩余生命值 $20$。

依次类推，受到第六只垃圾桶攻击时，剩余生命值为 $0$。因为不包括致命攻击，所以共接受了 $6+5=11$ 次攻击。

第二场战斗，垃圾桶的初始攻击力分别为 $10,1,7,8,4,4$。

第三场战斗，垃圾桶的初始攻击力分别为 $10,1,8,9,5,4$。

第四场战斗，垃圾桶的初始攻击力分别为 $10,1,11,12,8,4$。

可以得出第 $2\sim 4$ 场战斗的评分分别为 $9,8,8$。



**【样例 #2】**

见附件中的 ```wxyt/wxyt2.in``` 与 ```wxyt/wxyt2.ans```。

该组样例满足测试点 $1\sim 4$ 的约束条件。

**【样例 #3】**

见附件中的 ```wxyt/wxyt3.in``` 与 ```wxyt/wxyt3.ans```。

该组样例满足测试点 $13\sim 14$ 的约束条件。

**【样例 #4】**

见附件中的 ```wxyt/wxyt4.in``` 与 ```wxyt/wxyt4.ans```。

该组样例满足测试点 $15\sim 20$ 的约束条件。

**【数据范围】**

本题共 $20$ 个测试点，每个 $5$ 分。

| 测试点编号 | $n$ | $q$ |
| :-----------: | :-----------: | :-----------: |
| $1 \sim 4$ | $\le 2 \times 10^5$ | $\le 10$ |  
| $5 \sim 7$ | $\le 2 \times 10^5$ | $\le 10^3$ |
| $8 \sim 10$ | $\le 2 \times 10^5$ | $\le 10^5$ | 
| $11 \sim 12$ | $\le 3 \times 10^3$ | $\le 10^5$ |
| $13 \sim 14$ | $\le 3 \times 10^3$ | $\le10^6$ |
| $15 \sim 20$ | $\le 2 \times 10^5$ | $\le10^6$ |

对于全部数据，保证：$1 \le n \le 2 \times 10^5$，$1 \le q \le 10^6$，$1 \le W \le 10^{18}$，$1 \le a_i \le 10^{6}$，$1 \le l \le r \le n$，$1 \le d \le 2^{15}$。 


---

---
title: "[GDKOI2023 普及组] 小学生数学题"
layout: "post"
diff: 普及+/提高
pid: P11253
tag: ['2023', '广东', 'O2优化']
---
# [GDKOI2023 普及组] 小学生数学题
## 题目描述

Moon 是一名小学生，在做作业时遇到了这样一个问题，对于给定正整数 $n,k$，求出下面表达式的值：

$$\sum_{i=1}^n \frac{i!}{i^k}$$

其中 $i!$ 表示 $i$ 的阶乘运算，即 $i!=1\times 2\times 3\times 4...\times i$。这个式子太难了，所以 Moon 希望得到你的帮助。但是因为 Moon 只学过整数运算，还没有学过实数运算，所以希望你可以帮助他求出这个式子在模 $998244353$ 意义下的值。也就是说，如果最终的结果假如化简成为最简分数 $\frac{p}{q}$，只需要输出 $p\times q^{-1} \bmod 998244353$ 即可，其中 $q^{-1}$ 为 $q$ 在模 $998244353$ 下的逆元。
## 输入格式

第一行两个整数 $n,k$。
## 输出格式

一行，一个整数，代表模 $998244353$ 意义下的答案。
## 样例

### 样例输入 #1
```
5 1 
```
### 样例输出 #1
```
34
```
### 样例输入 #2
```
100 100
```
### 样例输出 #2
```
523011929
```
### 样例输入 #3
```
10000000 10000000
```
### 样例输出 #3
```
686183373
```
## 提示

### 样例解释

样例 $1$ 中，因为 $\frac{i!}{i}=(i-1)!$，所以原式等价于 $\sum_{i=1}^5 (i-1)!=34$。

### 数据范围

对于所有的数据，有 $1\le n,k\le 2 \times 10^7$；

对于 $30 \%$ 的数据，有 $k=1$；

对于另外 $30\%$ 的数据，有 $1\le k \le 3$。


---

---
title: "第一首歌"
layout: "post"
diff: 普及+/提高
pid: P11276
tag: ['Special Judge', 'O2优化']
---
# 第一首歌
## 题目背景

$$
\begin{array}{cr}
\text{在燥热的黑暗中}\\
\text{折叠陈旧的心}\\
\text{不禁开始自我怀疑}\\
\text{布满}\overset{\text{Wrong Answer}}{\text{谬误}}\text{的曾经}\\
&\text{——《第一首歌》}
\end{array}
$$

![](bilibili:62989560)

---

那个绝对不能忘却的人，如今还能在回忆中找到些许线索吗？

她的名字，即使只记得一部分，泠珞也想要请你帮忙还原呢。
## 题目描述

给定一个字符串 $s$，请求出一个最短的字符串 $t$，满足 $s$ 是 $t$ 的**最长** border。

称字符串 $s$ 是字符串 $t$ 的 border，当且仅当 $s$ 是满足以下三者皆成立的字符串：

- $s$ 为 $t$ 的前缀。
- $s$ 为 $t$ 的后缀。
- $s$ 不为 $t$。

如果有多个可能的最短的 $t$，输出任意一个均可。
## 输入格式

一行一个只由小写英文字母组成的的字符串 $s$。
## 输出格式

一行一个只由小写英文字母组成的的字符串 $t$。

如果有多个可能的最短的 $t$，输出任意一个均可。
## 样例

### 样例输入 #1
```
qwq
```
### 样例输出 #1
```
qwqwq
```
### 样例输入 #2
```
lingyu
```
### 样例输出 #2
```
lingyulingyu
```
### 样例输入 #3
```
aaaaaaabaa
```
### 样例输出 #3
```
aaaaaaabaaaaaaabaa
```
## 提示

**【样例 #1 解释】**

$t=\texttt{qwqwq}$ 的最长 border 为 $s=\texttt{qwq}$，且可以证明**不存在**更小的符合要求的 $t$，所以输出是正确的。

$t=\texttt{qwqaqwq}$ 符合条件，但是它不是最短的，所以不是可能的输出。

$t=\texttt{qwqwqwq}$ 不符合条件，因为它的最长 border 为 $\texttt{qwqwq}$。

**【数据范围】**

**本题采用捆绑测试。**

对于 $100\%$ 的数据，$1\le |s|\le 1\times10^6$，$s$ 仅由小写英文字母构成。其中，$|s|$ 表示 $s$ 的长度。 

| 子任务编号 | 分值 | $\vert s\vert\le $ | 特殊性质 |
| :----------: | :----------: | :----------: | :----------: |
| $1$ | $17$ | $4$ | 无 |
| $2$ | $29$ | $3\times10^3$ | 无 |
| $3$ | $11$ | $1\times10^6$ | $s$ 仅由一种字符组成 |
| $4$ | $43$ | $1\times10^6$ | 无 |



---

---
title: "[NOISG 2018 Prelim] Knapsack"
layout: "post"
diff: 普及+/提高
pid: P11297
tag: ['2018', 'NOISG（新加坡）']
---
# [NOISG 2018 Prelim] Knapsack
## 题目背景

翻译自 [NOISG 2018 Prelim B. Knapsack](https://github.com/noisg/sg_noi_archive/tree/master/2018_prelim)。
## 题目描述

你获得了超市的“免费购物”优惠，规则如下：
- 你有一个容量为 $S$ 的购物篮。超市里共有 $n$ 样东西。第 $i$ 样东西的重量 $w_i$，价值为 $v_i$，这样东西共有 $k_i$ 个。
- 你可以向你的购物篮塞入你想买的东西，前提是**这些东西的重量总和不超过购物篮的容量**。

现在，你只想知道，在满足规则的情况下，你最多能带多少价值的东西回去？

**请不要低估本题目的难度，如果你看到这就想写，请查看【数据范围】一栏**。
## 输入格式

第一行两个正整数 $S,n$。

接下来 $n$ 行，每行三个正整数 $v_i,w_i,k_i$。
## 输出格式

一行一个正整数，代表你最多能带多少价值的东西回去。
## 样例

### 样例输入 #1
```
15 5 
4 12 1 
2 1 1 
10 4 1 
1 1 1 
2 2 1
```
### 样例输出 #1
```
15
```
### 样例输入 #2
```
20 3 
5000 15 1 
100 1 3 
50 1 4
```
### 样例输出 #2
```
5400
```
## 提示

### 【样例 #1 解释】
拿第 $2,3,4,5$ 种东西，每种东西拿一个。

此时价值为 $15$，重量为 $8$。

### 【样例 #2 解释】
拿完第 $1,2$ 种东西后拿一个第 $3$ 种东西。

此时价值为 $5400$，重量为 $20$。

### 【数据范围】
| $\text{Subtask}$ | 分值 | $n\leq$ | $k\leq$ |
| :----------: | :----------: | :----------: | :----------: |
| $0$ | $0$ | 样例 | 样例 |
| $1$ | $12$ | $1$ | - |
| $2$ | $17$ | $100$ | $1$ |
| $3$ | $20$ | $100$ | $10$ |
| $4$ | $24$ | $100$ | $10^9$ |
| $5$ | $27$ | $10^5$ | $10^9$ |
| $6$（hack） | $0$ | $10^5$ | $10^9$ |

对于 $100\%$ 的数据：
- $1 \leq w_i \leq S \leq 2000$
- $1 \leq n \leq 10^5$
- $1 \leq v_i \leq 10^6$
- $1 \leq k_i \leq 10^9$


---

---
title: "【MX-S7-T2】「SMOI-R2」Speaker"
layout: "post"
diff: 普及+/提高
pid: P11324
tag: ['O2优化', '梦熊比赛']
---
# 【MX-S7-T2】「SMOI-R2」Speaker
## 题目背景

原题链接：<https://oier.team/problems/S7B>。
## 题目描述

M 国有 $n$ 个城市和 $n - 1$ 条双向道路，城市编号为 $1,2,\dots,n$，**保证这些城市连通**，即**构成了一棵树**。其中，第 $i$ 条道路连接了城市 $u_i$ 和城市 $v_i$，路费为 $w_i$。你是一名演说家，每天都要在 M 国举办三场演讲，每场演讲都会在某一个城市进行。在城市 $i$ 举办一场演讲可以获得 $c_i$ 的收入，**同一天内可以在同一个城市举办多场演讲**。

接下来有 $q$ 天，第 $i$ 天的安排如下：你的第一场演讲必须在城市 $x_i$ 举行，第三场演讲必须在城市 $y_i$ 举行，而第二场演讲所在的城市可以自由选择。设第二场演讲所在的城市为 $z_i$，你需要向交通管理局支付经过 $x_i \to z_i$ 路径以及 $z_i \to y_i$ 路径上所有道路的路费。**注意，一条道路如果被多次经过，每次经过都需要支付相应的路费**。

对于每一天，请计算当天可以获得的最大利润，即**总收入减去总路费的最大值**。**注意，答案可能是负数**。
## 输入格式

第一行，两个正整数 $n,q$。

第二行，$n$ 个非负整数 $c_1,c_2,\dots,c_n$。

接下来 $n - 1$ 行，每行三个非负整数 $u_i,v_i,w_i$，表示第 $i$ 条道路。

接下来 $q$ 行，每行两个正整数 $x_i,y_i$，表示第 $i$ 天的安排。
## 输出格式

$q$ 行，每行一个整数，表示第 $i$ 天的最大利润。
## 样例

### 样例输入 #1
```
4 3
4 6 2 7
1 2 5
2 3 2
2 4 4
1 1
3 4
3 3
```
### 样例输出 #1
```
12
10
6
```
## 提示

**【样例解释 #1】**

+ 第一天选择城市 $1$，答案为 $4 + 4 + 4 - 0 - 0 = 12$。
+ 第二天选择城市 $4$，答案为 $2 + 7 + 7 - 6 - 0 = 10$。
+ 第三天选择城市 $2$，答案为 $2 + 6 + 2 - 2 - 2 = 6$。

**【样例 #2】**

见附件中的 `speaker/speaker2.in` 与 `speaker/speaker2.ans`。

该组样例满足测试点 $7\sim 8$ 的约束条件。

**【样例 #3】**

见附件中的 `speaker/speaker3.in` 与 `speaker/speaker3.ans`。

该组样例满足测试点 $11\sim 13$ 的约束条件。

**【样例 #4】**

见附件中的 `speaker/speaker4.in` 与 `speaker/speaker4.ans`。

该组样例满足测试点 $17\sim 19$ 的约束条件。

**【数据范围】**

对于所有测试数据，保证：$1\le n, q\le 2\times 10^5$，$1\le u_i, v_i \le n$，$0\le w_i, c_i\le 10^9$，所有城市和道路构成了一棵树，$1\le x_i, y_i \le n$。

|测试点编号|$n\le $|$q\le $|特殊性质|
|:-:|:-:|:-:|:-:|
|$1\sim 4$|$400$|$400$|无|
|$5$|$2000$|$2000$|A|
|$6$|$2000$|$2000$|B|
|$7\sim 8$|$2000$|$2000$|无|
|$9$|$2000$|$2\times 10^5$|A|
|$10$|$2000$|$2\times 10^5$|C|
|$11\sim 13$|$2000$|$2\times 10^5$|无|
|$14\sim 15$|$2\times 10^5$|$3$|无|
|$16$|$2\times 10^5$|$2\times 10^5$|A|
|$17\sim 19$|$2\times 10^5$|$2\times 10^5$|C|
|$20\sim 25$|$2\times 10^5$|$2\times 10^5$|无|

- 特殊性质 A：每个城市至多被两条道路连接。
- 特殊性质 B：存在一座城市 $i$（$1\le i\le n$），满足对于所有其他城市 $j$（$1\le j\le n$、$j \ne i$），都存在连接城市 $i$ 与城市 $j$ 的道路。
- 特殊性质 C：对所有 $1 \le i \le q$，都有 $x_i = 1$。


---

---
title: "[NOIP2024] 遗失的赋值"
layout: "post"
diff: 普及+/提高
pid: P11362
tag: ['2024', 'NOIP 提高组', 'O2优化']
---
# [NOIP2024] 遗失的赋值
## 题目描述

小 F 有 $n$ 个变量 $x_1, x_2, \ldots , x_n$。每个变量可以取 $1$ 至 $v$ 的整数取值。

小 F 在这 $n$ 个变量之间添加了 $n - 1$ 条二元限制，其中第 $i$（$1 \leq i \leq n - 1$）条限制为：若 $x_i = a_i$，则要求 $x_{i+1} = b_i$，**且 $a_i$ 与 $b_i$ 为 $1$ 到 $v$ 之间的整数**；当 $x_i \neq a_i$ 时，第 $i$ 条限制对 $x_{i+1}$ 的值不做任何约束。除此之外，小 F 还添加了 $m$ 条一元限制，其中第 $j$（$1 \leq j \leq m$）条限制为：$x_{c_j} = d_j$。

小 F 记住了所有 $c_j$ 和 $d_j$ 的值，但把所有 $a_i$ 和 $b_i$ 的值都忘了。同时小 F 知道：存在给每一个变量赋值的方案同时满足所有这些限制。

现在小 F 想知道，有多少种 $a_i, b_i$（$1 \leq i \leq n - 1$）取值的组合，使得能够确保至少存在一种给每个变量 $x_i$ 赋值的方案可以同时满足所有限制。由于方案数可能很大，小 F 只需要你输出方案数对 $10^9 + 7$ 取模的结果。
## 输入格式

**本题包含多组测试数据**。

输入的第一行包含一个整数 $T$，表示测试数据的组数。

接下来包含 $T$ 组数据，每组数据的格式如下：

第一行包含三个整数 $n, m, v$，分别表示变量个数、一元限制个数和变量的取值上限。

接下来 $m$ 行，第 $j$ 行包含两个整数 $c_j, d_j$，描述一个一元限制。
## 输出格式

对于每组测试数据输出一行，包含一个整数，表示方案数对 $10^9 + 7$ 取模的结果。
## 样例

### 样例输入 #1
```
3
2 1 2
1 1
2 2 2
1 1
2 2
2 2 2
1 1
1 2

```
### 样例输出 #1
```
4
3
0

```
## 提示

**【样例 1 解释】**

- 对于第一组测试数据，所有可能的 $(a_1, b_1)$ 取值的组合 $(1, 1), (1, 2), (2, 1), (2, 2)$ 都满足限制。例如，$(a_1, b_1) = (1, 1)$ 时，$(x_1, x_2) = (1, 1)$ 满足所有限制，而 $(a_1, b_1) = (2, 2)$ 时，$(x_1, x_2) = (1, 1)$ 与 $(x_1, x_2) = (1, 2)$ 均满足所有限制。
- 对于第二组测试数据，只有 $(x_1, x_2) = (1, 2)$ 一种可能的变量赋值，因此只有 $(a_1, b_1) = (1, 1)$ 不满足限制，其余三种赋值均满足限制。
- 对于第三组测试数据，不存在一种变量赋值同时满足 $x_1 = 1$ 和 $x_1 = 2$，因此也不存在满足限制的 $(a_1, b_1)$。

**【样例 2】**

见选手目录下的 `assign/assign2.in` 与 `assign/assign2.ans`。

该样例共有 $10$ 组测试数据，其中第 $i$（$1 \leq i \leq 10$）组测试数据满足数据范围中描述的测试点 $i$ 的限制。

**【样例 3】**

见选手目录下的 `assign/assign3.in` 与 `assign/assign3.ans`。

该样例共有 $10$ 组测试数据，其中第 $i$（$1 \leq i \leq 10$）组测试数据满足数据范围中描述的测试点 $i + 10$ 的限制。

**【数据范围】**

对于所有的测试数据，保证：

- $1 \leq T \leq 10$，
- $1 \leq n \leq 10^9$，$1 \leq m \leq 10^5$，$2 \leq v \leq 10^9$，
- 对于任意的 $j$（$1 \leq j \leq m$），都有 $1 \leq c_j \leq n$，$1 \leq d_j \leq v$。

| 测试点 | $n \leq$ | $m \leq$ | $v \leq$ | 特殊性质 |
| :----------: | :----------: | :----------: | :----------: | :----------: |
| $1, 2$ | $6$ | $6$ | $2$ | 无 |
| $3$ | $9$ | $9$ | $2$ | 无 |
| $4, 5$ | $12$ | $12$ | $2$ | 无 |
| $6$ | $10^3$ | $1$ | $10^3$ | 无 |
| $7$ | $10^5$ | $1$ | $10^5$ | 无 |
| $8,9$ | $10^9$ | $1$ | $10^9$ | 无 |
| $10$ | $10^3$ | $10^3$ | $10^3$ | A |
| $11$ | $10^4$ | $10^4$ | $10^4$ | A |
| $12$ | $10^5$ | $10^5$ | $10^5$ | A |
| $13$ | $10^4$ | $10^3$ | $10^4$ | B |
| $14$ | $10^6$ | $10^4$ | $10^6$ | B |
| $15, 16$ | $10^9$ | $10^5$ | $10^9$ | B |
| $17$ | $10^4$ | $10^3$ | $10^4$ | 无 |
| $18$ | $10^6$ | $10^4$ | $10^6$ | 无 |
| $19, 20$ | $10^9$ | $10^5$ | $10^9$ | 无 |

特殊性质 A：保证 $m = n$，且对于任意的 $j$（$1 \leq j \leq m$），都有 $c_j = j$。

特殊性质 B：保证 $d_j = 1$。


---

---
title: "网瘾竞赛篇之 generals 大法好"
layout: "post"
diff: 普及+/提高
pid: P11467
tag: ['O2优化']
---
# 网瘾竞赛篇之 generals 大法好
## 题目描述

t1e 同学沉迷于打 generals 的 1v1 模式，他将游戏简化为以下内容：

初始时 t1e 有一座城堡，每回合结束时会生产 $x$ 单位的兵力，他的对手也有一座城堡，每回合结束时会生产 $y$ 单位的兵力，初始时（第 $0$ 回合）双方的兵力都为 $0$。

有 $n$ 座其他城堡可以被 t1e 占领，t1e 每个回合开始时可以攻占**最多** $1$ 个城堡，占领第 $i$ 个城堡需要消耗 $a_i$ 单位的兵力，从占领后的下一个回合开始，该城堡每回合结束时为 t1e 生产 $1$ 个单位的兵力。

t1e 同学想知道最早在第多少个回合，他的兵力能超过对手的兵力。

如果永远无法超过，输出 $-1$。
## 输入格式

**本题有多组数据**。

第一行一个正整数 $T$，表示数据组数。

对于每组数据：

第一行输入三个整数，分别代表 $n, x, y$。

第二行 $n$ 个整数代表 $a_i$。
## 输出格式

对于每组数据：

一行一个整数，代表 t1e 的兵力超过对手兵力的最小回合数。

如果永远无法超过，输出 $-1$。
## 样例

### 样例输入 #1
```
4
1 1 1
1
6 1 2
1 1 4 5 1 4
2 1 3
1 1
1 3 2
1
```
### 样例输出 #1
```
4
7
-1
1
```
## 提示

对于第一组数据，t1e 的最优操作过程如下：
| 回合 | 回合结束时 t1e 的兵力      | 回合结束时对手的兵力 |
| :----: | :----------------------------:| :--------------------: |
| 0    | 0                     | 0                    |
| 1    | 1                     | 1                    |
| 2    | 1                     | 2                    |
| 3    | 3                     | 3                    |
| 4    | 5                     | 4                    |

注意：t1e 在第 $2$ 回合开始时占领了 $1$ 号城堡。

$1\le T\le 100$，$1 \le n, \sum n \le 2\times 10^{5}$，$1 \le x, y, a_i \le 10^5$。


---

---
title: "有向树"
layout: "post"
diff: 普及+/提高
pid: P11468
tag: ['O2优化']
---
# 有向树
## 题目描述

给定一棵 $n$ 个结点的树，将树上所有的无向边变成给定方向的有向边，求所有简单路径的长度之和。

有向图中 $a_1$ 到 $a_x$ 的简单路径是形如 $a_1 \rightarrow a_2 \rightarrow a_3\rightarrow \cdots \rightarrow a_x$ 的路径，其中 $a_1,a_2,a_3,\cdots,a_x$ 这 $x$ 个顶点互不相同，其长度为简单路径上的有向边数量。
## 输入格式

第一行一个整数 $n$，表示树上一共有 $n$ 个结点。

接下来 $n - 1$ 行，每行两个整数 $u,v$，表示一条有向边 $u\rightarrow v$。
## 输出格式

一个整数，表示有向树上所有简单路径的长度之和。
## 样例

### 样例输入 #1
```
5
1 2
1 3
1 4
1 5
```
### 样例输出 #1
```
4
```
### 样例输入 #2
```
5
1 2
3 1
4 1
5 1
```
### 样例输出 #2
```
10
```
### 样例输入 #3
```
4
1 2
2 3
3 4
```
### 样例输出 #3
```
10
```
### 样例输入 #4
```
6
1 2
3 2
4 3
5 3
6 3
```
### 样例输出 #4
```
11
```
## 提示

$1 \le n \le 2\times 10^5$，$1\le u, v \le n$，保证输入数据的有向边在看作无向边时，图构成一棵树。


---

---
title: "[ROIR 2017] 力场 (Day 2)"
layout: "post"
diff: 普及+/提高
pid: P11512
tag: ['2017', 'Special Judge', 'ROIR（俄罗斯）']
---
# [ROIR 2017] 力场 (Day 2)
## 题目背景

翻译自 [ROIR 2017 D2T3](https://neerc.ifmo.ru/school/archive/2016-2017/ru-olymp-regional-2017-day2.pdf)。
## 题目描述

在一个物理生物学实验室中，研究者们正在研究通过力场对植物的辐射影响。实验装置包含一个大小为 $10^9 \times 10^9$ 的方形平台，平台上有肥沃的土壤。平台上方放置了一个辐射源。在辐射源与平台之间，可以开启 $n$ 个力场。

力场发生器安装在点 $(0, 0)$ 之上。第 $i$ 个力场是一个矩形，矩形的两条边与平台的边界平行，且矩形的两个对角线顶点坐标分别为 $(0, 0)$ 和 $(x_i, y_i)$。

在实验中，研究者计划通过开启 $k$ 个力场，来研究辐射对植物的影响。研究者需要从给定的 $n$ 个力场中，选择出 $k$ 个力场进行实验。为了最大化实验效果，研究者希望选择的这 $k$ 个力场覆盖平台上的面积尽可能大。

要求编写一个程序，给定 $n,k$ 和 $n$ 个力场的描述，找出选择的 $k$ 个力场，使得它们覆盖的平台区域面积的交最大，并输出该面积。
## 输入格式

第一行输入包含两个整数 $n$ 和 $k$（$1 \leq k \leq n \leq 200000$），分别表示力场的总数量以及需要选择的力场数量。

接下来 $n$ 行，每行包含两个整数 $x_i$ 和 $y_i$（$1 \leq x_i, y_i \leq 10^9$），其中第 $i$ 行输入的数表示第 $i$ 个力场的远离原点的顶点坐标。
## 输出格式

输出一个整数，表示选择 $k$ 个力场能覆盖的最大公共面积。
## 样例

### 样例输入 #1
```
5 3
3 5
2 2
2 5
4 4
5 3
```
### 样例输出 #1
```
9
```
## 提示

### 样例解释

下面的图中，上方是输入的 $5$ 个力场，下方是使总面积最大的最佳的选择 $3$ 个力场的方案。

![](https://cdn.luogu.com.cn/upload/image_hosting/hnxmjucp.png)

### 数据范围

| 子任务 | 分值 | $n$ | 其它特殊性质 |
| :----------: | :----------: | :----------: | :----------: |
| $1$ | $18$ | $1\le n\le20$ |  |
| $2$ | $25$ | $1\le n\le300$ |  |
| $3$ | $20$ | $1\le n\le3000$ |  |
| $4$ | $17$ | $2\le n\le200000$ | $k=2$ |
| $5$ | $20$ | $1\le n\le200000$ |  |


---

---
title: "[NOISG 2023 Finals] Topical"
layout: "post"
diff: 普及+/提高
pid: P11533
tag: ['2023', 'NOISG（新加坡）']
---
# [NOISG 2023 Finals] Topical
## 题目描述

兔子 Benson 正在上飞行员学校！

他需要完成 $n$ 场测试，由 $1\sim n$ 编号。对于每场测试，有 $k$ 个科目。对于每个科目，Benson 有一个能力值 $p_j$。由于 Benson 还是一名新手，他对于每个科目的初始能力值均为 $0$。

对于每场测试的每个科目，均有一个能力值下限 $r_{i, j}$。而为了完成第 $i$ 场测试，需要满足他每个科目的能力值都不低于这个下限。

若成功完成第 $i$ 场测试，他的能力值将获得提升，且第 $j$ 个科目的能力值将提升 $u_{i, j}$。

**形式化地**：初始，对于所有 $j$，有 $p_j=0$。Benson 能完成一场测试，当且仅当对于所有 $j$，都有 $r_{i, j}\leq p_j$；完成该场测试后，对于所有 $j$，$p_j$ 的值将增加 $u_{i, j}$。

他可以任意选择完成测试的顺序，但每场测试只能完成一次。请帮助他计算他最多能完成多少场测试。
## 输入格式

第一行两个正整数 $n, k$，用空格隔开。

接下来 $n$ 行，第 $i$ 行包含 $k$ 个整数 $r_{i, 1}, r_{i, 2}, \cdots, r_{i, k}$，表示完成第 $i$ 场测试的能力值下限。

接下来 $n$ 行，第 $i$ 行包含 $k$ 个整数 $u_{i, 1}, u_{i, 2}, \cdots, u_{i, k}$，表示完成第 $i$ 场测试后能力值的增加量。
## 输出格式

输出一行一个整数，表示 Benson 最多能完成的测试数量。
## 样例

### 样例输入 #1
```
3 3
0 0 0
7 9 2
7 8 9
7 8 2
7 7 7
8 10 9

```
### 样例输出 #1
```
1

```
### 样例输入 #2
```
4 3
5 1 0
0 1 5
0 0 0
7 7 7
0 5 6
1 1 1
8 2 0
8 1 4

```
### 样例输出 #2
```
4

```
### 样例输入 #3
```
5 5
14 11 15 7 15
0 0 0 0 0
9 9 14 2 13
4 3 6 1 0
2 4 7 0 0
5 5 0 0 13
4 4 7 1 0
4 1 0 2 1
2 5 0 2 1
4 0 7 2 12

```
### 样例输出 #3
```
4

```
## 提示

#### 样例 #1 解释

Benson 只能完成第一场测试，其要求为 $[0, 0, 0]$。完成后，他的能力值将变为 $[7, 8, 2]$。此时他不能完成任何一场其余的测试，故答案为 $1$。

#### 数据范围

| Subtask | 分值 | 特殊限制 |
| :-----------: | :-----------: | :-----------: |
| $0$ | $0$ | 样例 |
| $1$ | $12$ | $n=1$ |
| $2$ | $28$ | $n,k\leq 100$ |
| $3$ | $21$ | $k=1$ |
| $4$ | $39$ | 无 |

对于 $100\%$ 的数据：

- $1\leq n, k\leq 10^6$
- $n\cdot k\leq 10^6$
- $0\leq u_{i, j}, r_{i, j}\leq 10^9$，其中 $1\leq i\leq n$ 且 $1\leq j\leq k$。

注：由于洛谷限制，数据不完全按照原题分配子任务。


---

---
title: "[Code+#5] 我有矩阵，你有吗？"
layout: "post"
diff: 普及+/提高
pid: P11543
tag: ['Code+']
---
# [Code+#5] 我有矩阵，你有吗？
## 题目背景

**题目来源：**[link](https://www.gitlink.org.cn/thusaa/codeplus5)。
## 题目描述

企鹅豆豆手里有两个 $01$ 矩阵 $\mathbf{A}$ 和 $\mathbf{B}$。他可以进行两种操作：

1. 选择 $\mathbf{A}$ 矩阵的一行，然后把这一行的 $0$ 变成 $1$，把 $1$ 变成 $0$。
2. 选择 $\mathbf{A}$ 矩阵的一列，然后把这一列的 $0$ 变成 $1$，把 $1$ 变成 $0$。

现在他想知道能不能把 $\mathbf{A}$ 矩阵通过以上操作变成 $\mathbf{B}$ 矩阵。保证 $\mathbf{A}$ 矩阵和 $\mathbf{B}$ 矩阵的大小一致。

## 输入格式

每个测试点只有一组数据。

输入的第一行包含两个正整数 $n$ 和 $m$，表示 $\mathbf{A}$ 矩阵的行数。
接下来 $n$ 行，每行 $m$ 个由空格隔开的整数，表示矩阵 $\mathbf{A}$。保证矩阵中只有 $0$ 或者 $1$。
接下来 $n$ 行，每行 $m$ 个由空格隔开的整数，表示矩阵 $\mathbf{B}$。保证矩阵中只有 $0$ 或者 $1$。

## 输出格式

如果矩阵 $\mathbf{A}$ 通过以上两种操作可以变成矩阵 $\mathbf{B}$，输出 `Koyi`，否则输出 `Budexing`。
## 样例

### 样例输入 #1
```
3 3
1 0 1
1 1 0
0 1 0
1 1 0
0 1 0
1 1 0

```
### 样例输出 #1
```
Koyi
```
### 样例输入 #2
```
6 6
0 0 1 0 0 1
1 0 1 1 0 1
1 0 1 0 0 0
0 1 1 0 1 0
1 0 1 0 0 1
1 1 1 0 1 0
1 1 0 1 0 0
0 1 0 0 0 0
0 1 0 1 0 1
1 0 0 1 1 1
1 0 1 0 1 1
0 0 0 1 1 1

```
### 样例输出 #2
```
Koyi
```
## 提示

**数据范围：**

对于所有数据，$n \le 1000,m \le 1000$。

**样例解释：**

对于样例一，依次对于第一行和第一列分别执行操作 $1$ 和操作 $2$ 即可。



---

---
title: "[ROIR 2016] 奇怪的字符串 (Day 1)"
layout: "post"
diff: 普及+/提高
pid: P11553
tag: ['2016', 'ROIR（俄罗斯）']
---
# [ROIR 2016] 奇怪的字符串 (Day 1)
## 题目背景

翻译自 [ROIR 2016 D1T3](https://neerc.ifmo.ru/school/archive/2015-2016/ru-olymp-regional-2016-day1.pdf)。

注意：本题官方数据行末存在 `\r`。
## 题目描述

考虑一个由小写字母组成的字符串 $ s $，如 $\texttt{abba}$。
- 记 $ W(s) $ 为一个集合，包含了字符串 $ s $ 所有的非空子串。例如，$ W(\texttt{abba}) = \{\texttt{a}, \texttt{b}, \texttt{ab}, \texttt{ba}, \texttt{bb}, \texttt{abb}, \texttt{bba}, \texttt{abba}\} $。
- 记 $ Y(s) $ 为一个集合，包含了字符串 $ s $ 所有的非空子序列。由于任何子串都是子序列，因此 $ Y(s) $ 集合包含了 $ W(s) $，但它还可以包含其他的字符串。例如，$ Y(\texttt{abba}) = W(\texttt{abba}) \cup \{\texttt{aa}, \texttt{aba}\} $。

如果一个字符串 $ s $ 满足 $ W(s) = Y(s) $，那么我们称它是**奇怪的**。例如，字符串 $\texttt{abba}$ 不是奇怪的，而字符串 $\texttt{abb}$ 是奇怪的，因为对于 $\texttt{abb}$，有 $ W(\texttt{abb}) = Y(\texttt{abb}) = \{\texttt{a}, \texttt{b}, \texttt{ab}, \texttt{bb}, \texttt{abb}\} $。

我们称字符串 $s$ 的**奇异度**为它所有不同的奇怪子串的数量，即，$W(s)$ 中奇怪的字符串的数量。例如，字符串 $\texttt{abba}$ 的奇异度为 $7$，因为它的所有除它本身以外的子串都是奇怪的。

给定一个字符串 $s$，你要求出它的奇异度。
## 输入格式

输入一个由小写字母组成的字符串 $s$。
## 输出格式

输出 $s$ 的奇异度。
## 样例

### 样例输入 #1
```
abba
```
### 样例输出 #1
```
7
```
## 提示

| 子任务 | 是否捆绑 | 分值 | 特殊性质 |
| :----------: | :----------: | :----------: | :----------: |
| $1$ | 是 | $29$ | $\vert s\vert\le50$ 且 $s$ 只含 $\tt a$ 和 $\tt b$ |
| $2$ | 是 | $12$ | $\vert s\vert\le50$ |
| $3$ | 是 | $25$ | $\vert s\vert\le1000$ |
| $4$ | 是 | $34$ | $\vert s\vert\le200000$ |


---

---
title: "「chaynOI R1 T3」镍铬合金机器人"
layout: "post"
diff: 普及+/提高
pid: P11570
tag: ['O2优化']
---
# 「chaynOI R1 T3」镍铬合金机器人
## 题目背景

![](https://cdn.luogu.com.cn/upload/image_hosting/wv3r15c6.png)

## 题目描述

给定一个长为 $n$ 的序列 $bot$。

有 $q$ 次询问，每次给出三个数 $l,x,y$，请你求出有多少个以 $l$ 为左端点的区间 $[l,r]$（$l\le r$）使得 $\text{mex}(\{bot_l,bot_{l+1},\cdots,bot_r\})\in[x,y]$。

注：一个可重集合 $S$ 的 $\text{mex}$ 函数 $\text{mex}(S)$ 指的是**最小**的没有在 $S$ 中出现过的**非负整数**，如 $\text{mex}(\{0,1,1,3\}) = 2$。 
## 输入格式

第一行两个正整数 $n,q$，表示序列的长度和询问的次数。

第二行 $n$ 个数，表示序列 $bot$。

接下来 $q$ 行，每行三个整数 $l,x,y$。
## 输出格式

输出共 $q$ 行，每行一个整数，表示答案。


## 样例

### 样例输入 #1
```
4 2
0 1 3 2
1 2 2
2 1 4
```
### 样例输出 #1
```
2
0
```
### 样例输入 #2
```
10 10
0 0 1 1 1 0 0 1 0 1
1 0 0
2 0 1
3 1 2
4 0 1
5 0 2
6 0 1
7 1 1
8 2 2
9 0 0
10 1 2

```
### 样例输出 #2
```
0
1
5
2
6
2
1
2
0
0

```
## 提示

对于 $100\%$ 的数据，$1\le n,q \le 3\times 10^5$，$0\le bot_i < n$，$0\le x \le y \le n$，$1 \le l\le n$。

**本题采用捆绑测试。**

+ Subtask 1(10pts)：$n,q\le 300$。
+ Subtask 2(15pts)：$n,q\le 2000$。
+ Subtask 3(15pts)：$bot_i \le 1$。
+ Subtask 4(20pts)：$x=y$。
+ Subtask 5(40pts)：无特殊限制。


---

---
title: "[CCC 2020] Searching for Strings"
layout: "post"
diff: 普及+/提高
pid: P11582
tag: ['2020', 'CCC（加拿大）']
---
# [CCC 2020] Searching for Strings
## 题目背景

本题译自 [Canadian Computing Competition](https://cemc.uwaterloo.ca/resources/past-contests?contest_category=29) [2020 Senior](https://cemc.uwaterloo.ca/sites/default/files/documents/2020/2020CCCSrProblemSet.html) T3 Searching for Strings。
## 题目描述

计算字符串 $n$ 的不同排列中，作为 $h$ 的子字符串的数量。
## 输入格式

第一行一个字符串 $n(1 \le |n| \le 2\times10^5)$。

第二行一个字符串 $h(1 \le |h| \le 2\times10^5)$。
## 输出格式

输出由一个整数构成，即题目所求。
## 样例

### 样例输入 #1
```
aab
abacabaa
```
### 样例输出 #1
```
2
```
## 提示

**本题采用捆绑测试**。
#### 【样例解析】
仅有排列 `aba` 和 `baa` 作为子字符串出现在了 $h$ 中。
#### 【数据范围】
设 $n$ 长度为 $x$，$h$ 长度为 $y$。
| Subtask | 特殊性质 | 分值 |
| :----------: | :----------: | :----------: |
| 1 | $x\le 8,y\le 200$ | 20 |
| 2 | $x\le 200,y\le 200$ | 14 |
| 3 | $x\le 2000,y\le 2000$ | 14 |
| 4 | 无 | 52 |

注：原题满分为 15 分，其中 Sub1 有 $3$ 分，Sub2 和 Sub3 有 $2$ 分，而 Sub4 有 $8$ 分。本题分数为取近似后得到的结果。


---

---
title: "『Fwb』狼人の杀戮"
layout: "post"
diff: 普及+/提高
pid: P11601
tag: []
---
# 『Fwb』狼人の杀戮
## 题目描述

Fwb 开始玩狼人杀了。

这是一个游戏规则略有不同的简化版的狼人杀，若与现实中狼人杀规则不同，应以题目为准。开局共有 $n$（$n≥2$）位玩家，他们的身份共有以下几种：

- 狼人：在天黑时可以进行选择一位非自己的玩家杀害，可以是其他狼人。
- 平民：在天黑时只能闭眼睡觉，没有任何技能。
- 猎人：若自己存活，在天黑时只能闭眼睡觉；若在此夜被杀死且未被解救，**必须**任意带走一位非自己玩家（带走意义即为杀死）。若带走玩家之后又被救活，则下一次被杀死依旧可以继续带走玩家，且此次带走依然成立。换句话说，带走玩家后再被救活也是合法的。
- 女巫：在天黑时可以进行选择：用解药解救任意一个在今夜死亡的玩家（可以是自己），或用毒药毒死任意存活的玩家（不可以是自己）。特殊的，女巫可以在被杀死后对自己使用解药，但不可以进行其他技能操作。请注意，每一位女巫只有一次解药和一次毒药的机会，且**不可以在同一夜使用**。


在黑夜中，将模拟**各种角色技能的进行**，有如下几种格式：

- $0\ id_1\ id_2$：编号为 $id_1$ 的狼人决定将编号为 $id_2$ 的玩家杀害。
- $1\ id_1\ id_2$：编号为 $id_1$ 的女巫决定将编号为 $id_2$ 的玩家毒死。
- $2\ id_1\ id_2$：编号为 $id_1$ 的女巫决定将编号为 $id_2$ 的玩家救活。
- $3\ id_1\ id_2$：编号为 $id_1$ 的猎人被杀死，决定带走编号为 $id_2$ 的玩家。


在天亮后，将公布昨夜的**死亡情况**，有如下几种格式：

- $x\ id_1\ id_2\ ...\ id_x$：共 $x$ 名编号分别为 $id_1\ id_2\ ...\ id_x$ 的玩家在昨夜被杀害，每两个玩家编号之间用空格隔开。注意，$id_i$ 必须严格单调递增。
- `Safe`：昨夜是平安夜，其中平安夜指没有人死亡即 $x=0$ 的夜晚。
- `Wrong`：昨夜的角色技能输入有误。此夜晚将撤回全部操作。

当出现以下情况时，认为昨夜的角色技能输入有误：

- 编号为 $id$ 的玩家不存在。
- 除女巫使用解药时，编号为 $id$ 的玩家已死亡。
- **同一位**狼人、女巫在同一晚上多次使用技能。
- 猎人未被杀死就使用技能。
- 猎人在被杀死时带走多人。
- 玩家使用了不属于自己的技能。
- 女巫将解药用在了未死亡或非今夜死亡的人身上。
- 狼人杀人、女巫使用毒药、猎人带走玩家时对自己使用技能。

当一夜技能输入有误时，该夜的所有操作均不被执行。

请注意，一个夜晚是有时间顺序的，这个时间顺序决定了输入的合法性。例如，在同一夜晚，女巫先对编号为 $id$ 的玩家使用解药，狼人再杀死编号为 $id$ 的玩家，然后夜晚结束，属于不合法输入。

现在告诉你了在黑夜中，各种角色技能的进行。你需要判断昨夜的死亡情况。
## 输入格式

**本题包含多组测试数据。**

输入的第一行包含两个正整数 $t,n$，分别表示要求模拟这一局游戏进行的**前** $t$ 个夜晚的结果与玩家人数 $n$。

第二行输入 $n$ 个正整数 $a_i$，表示各个玩家的角色。其中狼人用 $1$ 表示，平民用 $2$ 表示，猎人用 $3$ 表示，女巫用 $4$ 表示。

接下来 $t$ 组数据，表示 $t$ 个夜晚，每个夜晚输入的格式如下：

先输入一个正整数 $m$，代表这一夜发生的事件数量。

接下来每 $m$ 行，每行包含 $3$ 个非负整数，输入格式详见【题目描述】中的**各种角色技能的进行**。默认玩家编号为 $1\sim n$，保证 $id$ 在 $1\sim 10^3$ 范围内。
## 输出格式

输出共 $t$ 行。

对于每一次输入的**各种角色技能的进行**，都输出相对应的死亡情况，输出格式详见【题目描述】中的**死亡情况**。
## 样例

### 样例输入 #1
```
3 6
1 2 3 4 2 1
3
0 1 3
3 3 1
1 4 5
2
1 4 2
0 2 4
2
0 6 2
2 4 2
```
### 样例输出 #1
```
3 1 3 5
Wrong
Safe
```
### 样例输入 #2
```
2 3
1 3 4
3
0 1 2
2 3 2
3 2 1
1
0 1 2
```
### 样例输出 #2
```
Wrong
Wrong
```
## 提示

**本题采用捆绑测试。**

#### 【样例 1 解释】
编号为 $1\sim 6$ 的玩家的身份分别是：狼人、平民、猎人、女巫、平民、狼人。

第一夜：

- $1$ 号狼人杀死了 $3$ 号猎人。
- $3$ 号猎人带走了 $1$ 号狼人。
- $4$ 号女巫毒死了 $5$ 号平民。

结果：$3$ 号猎人被 $1$ 号狼人杀死，$1$ 号狼人被 $3$ 号猎人带走，$5$ 号平民被 $4$ 号女巫毒死。此时仅有 $2$ 号平民、$4$ 号女巫和 $6$ 号狼人存活。

第二夜：

- $4$ 号女巫毒死了 $2$ 号平民。
- $2$ 号狼人杀死了 $4$ 号女巫。

结果：$2$ 号是平民且已经死亡，此回合不合法。此时仍有 $2$ 号平民、$4$ 号女巫和 $6$ 号狼人存活。

第三夜：

- $6$ 号狼人杀死了 $2$ 号平民。
- $4$ 号女巫解救了 $2$ 号平民。

结果：$2$ 号平民在被狼人杀死之后被女巫救活，今夜是平安夜。

#### 【样例 2 解释】

第一夜：猎人先被狼人杀死，女巫又救活了猎人，故猎人最终存活，无法带走其他玩家。

第二夜：猎人被狼人杀死，没有人救活他，所以猎人必须带走一名玩家。

#### 【数据范围】

对于 $100\%$ 的数据，$1\le t\le 10$，$2\le n\le 20$，$1\le a_i\le 4$，$1\le m\le 20$。

| 子任务 | $1\le t\le$ | 分值 | 特殊性质 |
| :----------: | :----------: | :----------: | :----------: |
| $1$ | $5$ | $10$ | A、B |
| $2$ | $5$ | $10$ | B |
| $3$ | $5$ | $30$ | 无 |
| $4$ | $10$ | $50$ | 无 |
| $5$ | $10$ | $0$ | C |


特殊性质 A：每一晚一定有人死亡。

特殊性质 B：只存在狼人与平民，不存在输入不合法的情况。

特殊性质 C：本子任务为 Hack 数据，不占分。

**请注意，所有玩家被杀死即生效，而不是等待夜晚结束之后。特殊的，猎人仍有使用技能的权力。**


---

---
title: "【MX-X8-T3】「TAOI-3」地地爱打卡"
layout: "post"
diff: 普及+/提高
pid: P11644
tag: ['O2优化', '梦熊比赛']
---
# 【MX-X8-T3】「TAOI-3」地地爱打卡
## 题目背景

原题链接：<https://oier.team/problems/X8D>。

---

一年前，我在 NOIP 2023 的赛场上，折戟沉沙。

一年后，我从倒下的地方爬起。

THUWC 2025 D1T1，强势狂砍 76 分。

……线段树优化 DP 也太难了。
## 题目描述

小 T 同学非常淡泊于跑步。为了让跑步更加无趣，他决定制作一款叫做《地地爱打卡》的软件，使得用户每地都无法进行跑步打卡。

开发完成后，小 T 同学计划进行试运行，他找了大 Y 同学来帮忙。

这次打卡总共有 $n$ 个节点，编号为 $1 \sim n$，有 $m$ 条连接两个节点的双向道路，**保证图无重边无自环**。大 Y 同学需要从 $s$ 跑到 $t$。

初始时，大 Y 同学的能量值是 $0$。每当大 Y 同学跑过一条道路，小 T 同学就会请他吃一顿饭，使得他的能量值增加 $1$。试运行期间他的**能量值不可以是负数**。

大 Y 同学还有一个快乐值，初始为 $0$，当位于某个节点的时候，大 Y 同学可以让他的快乐值按位异或上他的能量值，同时清空能量值（即，能量值变为 $0$），也可以什么都不做。

现在大 Y 同学想要知道，他是否能够 **最终停留在** 节点 $t$，耗尽所有能量值（即，能量值变为 $0$），并且此时他的快乐值恰好为 $x$？**注意：大 Y 同学到达节点 $\bm t$ 后可以选择不停下而继续移动。**

因为大 Y 同学很爱跑步，所以你要回答 $q$ 组询问，每次询问给出 $s, t, x$，你要告诉大 Y 同学是否能够满足他的要求。
## 输入格式

第一行，三个非负整数 $n, m, q$。

接下来 $m$ 行，每行两个正整数 $u, v$，表示一条连接点 $u$ 和 $v$ 的道路。

接下来 $q$ 行，每行三个非负整数 $s, t, x$，表示一组询问。
## 输出格式

$q$ 行，对于每组询问，如果大 Y 同学能够满足他的要求，输出一行 `tribool`，否则输出一行 `expand`。
## 样例

### 样例输入 #1
```
7 6 4
2 4
5 6
1 2
3 5
3 6
7 1
1 2 1
1 6 3
5 3 5
2 7 7
```
### 样例输出 #1
```
tribool
expand
tribool
expand

```
### 样例输入 #2
```
5 4 4
1 2
2 3
3 4
4 5
1 2 1
1 5 3
5 3 2
1 1 1

```
### 样例输出 #2
```
tribool
expand
tribool
expand

```
## 提示

**【样例解释 #1】**

![](https://cdn.luogu.com.cn/upload/image_hosting/66uc1bzt.png)

如图，对于第一组询问，大 Y 同学从节点 $1$ 出发，经过一条道路到达节点 $2$，此时他的能量值为 $1$。他再进行一次操作，此时能量值变为 $0$，快乐值变为 $1$，满足条件。

对于第二组询问，可以说明不存在合法的方案。

**【数据范围】**

**本题采用捆绑测试。**

- 子任务 1（22 分）：$\max(n, m, q, x) \leq 50$。
- 子任务 2（22 分）：$m = n - 1$ 且图连通。
- 子任务 3（24 分）：$x \leq 1$。
- 子任务 4（32 分）：无特殊限制。

对于所有数据，保证 $2 \leq n \leq 2\times 10^5$，$0 \leq m \leq 3\times 10^5$，$1 \leq q \leq 2\times 10^5$，$1 \leq s, t, u, v \leq n$，$0 \leq x \leq 10^9$，保证给出的无向图无重边无自环。


---

---
title: "[JOI 2025 Final] 勇者比太郎 2 / Bitaro the Brave 2"
layout: "post"
diff: 普及+/提高
pid: P11663
tag: ['2025', 'JOI（日本）']
---
# [JOI 2025 Final] 勇者比太郎 2 / Bitaro the Brave 2
## 题目背景


译自 [第24回日本情報オリンピック 本選](https://contests.ioi-jp.org/joi-ho-2025/index.html) T2。
## 题目描述


比太郎要打怪。

令比太郎初始时的**力量**为 $x$。有 $N$ 个怪物，编号 $1\sim N$。欲打败第 $i$（$1\le i\le N$）个怪物，需要力量 $\ge A_i$。打败第 $i$（$1\le i\le N$）个怪物，会使比太郎的力量增加 $B_i$。

比太郎会用如下的策略打怪：

- 选择整数 $j$（$1\le j\le N$），然后按 $j,j+1,\cdots,N$ 的顺序打怪。
- 如果 $j\ge 2$，回头按顺序打怪物 $1,2,\cdots,j-1$。

在按照策略打完所有的怪物的前提下，求出比太郎初始力量 $x$ 的最小值。

## 输入格式


如下所示：


> $N$\
> $A_1$ $A_2$ $\cdots$ $A_N$\
> $B_1$ $B_2$ $\cdots$ $B_N$

## 输出格式

输出一行一个整数，即比太郎初始力量 $x$ 的最小值。

## 样例

### 样例输入 #1
```
5
1 3 2 8 6
4 3 1 1 2
```
### 样例输出 #1
```
1
```
### 样例输入 #2
```
5
1 6 3 3 2
1 2 1 0 1
```
### 样例输出 #2
```
3
```
### 样例输入 #3
```
10
11 9 8 12 7 7 8 12 9 10
1 1 1 1 1 1 1 1 1 1
```
### 样例输出 #3
```
9
```
### 样例输入 #4
```
7
1125 638 0 37 737 820 1202
23 984 558 350 52 345 580
```
### 样例输出 #4
```
0
```
## 提示


### 样例解释

#### 样例 $1$ 解释

令 $x=1$，然后按照 $1\to 5$ 的顺序打怪。

该样例满足子任务 $1,2,3,5$ 的限制。


#### 样例 $2$ 解释

令 $x=3$，然后先打 $3\to 5$ 的怪，再打 $1\to 2$ 的怪。

该样例满足子任务 $1,2,3,5$ 的限制。


#### 样例 $3$ 解释

该样例满足所有子任务的限制。


#### 样例 $4$ 解释

该样例满足子任务 $1,2,3,5$ 的限制。



### 数据范围

- $2\le N\le 5\times 10^5$。
- $0\le A_i\le 10^9$（$1\le i\le N$）。
- $0\le B_i\le 10^9$（$1\le i\le N$）。
- 输入的值全部是整数。

### 子任务

1. （10pts）$N\le 2,000$，保证答案不大于 $10$。
2. （21pts）$N\le 2,000$。
3. （19pts）保证答案不大于 $10$。
4. （22pts）$B_i=1$（$1\le i\le N$）；
5. （28pts）无额外限制。


---

---
title: "[USACO25JAN] Astral Superposition B"
layout: "post"
diff: 普及+/提高
pid: P11667
tag: ['USACO', '2025']
---
# [USACO25JAN] Astral Superposition B
## 题目描述

**注意：本题的时间限制为 4 秒，通常限制的 2 倍。**

Bessie 正在使用她超酷的望远镜拍摄夜空中所有星星的照片。她的望远镜能够拍摄到一张 $N \times N$（$1 \leq N \leq 1000$）的星星照片，其中每个像素是一颗星星或者空旷的天空。每颗星星可由恰好一个像素表示，并且没有两颗不同的星星位于同一像素内。

一夜之间，一些奇怪的事情发生在了天空中的星星之上。每颗星星要么消失，要么向右移动 $A$ 像素，并且向下移动 $B$ 像素（$0 \leq A,B \leq N$）。如果一颗星星消失或移动超出照片边界，它将不再出现在第二张照片中。

Bessie 在星星移动位置之前和之后拍了照片，但在 Mootoshop 中进行了一些实验后，她不小心将一张照片叠加到了另一张上。现在，她可以在两张照片都是天空的位置看到白色（white）像素，在星星仅存在于恰好一张照片的位置看到灰色（gray）像素，而在两张照片中都有星星的位置看到黑色（black）像素。Bessie 同时记得没有新的星星移动入第二张照片的范围，从而她的第一张照片包含了夜空中所有的星星。

对于 $T$（$1 \leq T \leq 1000$）个独立的测试用例，给定最终的照片，求在移动事件发生之前天空中星星的最小可能数量。如果不存在星星的排列可以产生给定的最终照片，输出 $-1$。
## 输入格式

输入的第一行包含 $T$，以下为 $T$ 个测试用例。

每个测试用例的第一行包含 $N$，$A$，$B$。

以下 $N$ 行，每行表示叠加后的照片的一行。从上到下第 $i$ 行由一个字符串 $c_{i,1}c_{i,2}\dots c_{i,N}$ 表示，其中 $c_{i,j} \in \{\texttt{W,G,B}\}$，分别表示颜色为白色，灰色以及黑色。

输入保证所有测试用例的 $N^2$ 之和不超过 $10^7$。
## 输出格式

对于每一个测试用例，输出移动之前存在的星星的最小数量，或 $-1$ 表示不可能。
## 样例

### 样例输入 #1
```
1
3 0 0
WWB
BBB
GGG
```
### 样例输出 #1
```
7
```
### 样例输入 #2
```
3
5 1 2
GWGWW
WGWWW
WBWGW
WWWWW
WWGWW
3 1 1
WWW
WBW
WWW
3 1 0
GGB
GGW
WWW
```
### 样例输出 #2
```
4
-1
4
```
## 提示

### 样例解释

在样例 #1 中，没有移动发生。第一张照片如下（. 表示天空，* 表示星星）：
```
..*
***
***
```
第二张照片中最下方一行的星星都消失了，如下：

```
..*
***
...
```
这是产生叠加后照片的唯一方式，所以初始时星星的最小可能数量为 $7$。

对于样例 #2，在第一个测试用例中，初始时至少有 $4$ 颗星星。如果我们令 $(r,c)$ 表示从上到下第 $r$ 行和从左到右第 $c$ 列的交点，一种可能性是它们最初位于 $(1,1)$，$(3,2)$，$(2,2)$ 和 $(1,3)$。除了位于 $(2,2)$ 的星星消失之外，其他所有星星都移动了。

在第二个测试用例中，在给定的移动方式下，没有任何初始照片中的星星排列可以产生中间的黑色像素。

在第三个测试用例中，初始时至少有 $4$ 颗星星。一种可能性是它们最初位于 $(1,1)$，$(1,2)$，$(1,3)$ 和 $(2,1)$。在第二张照片中，原先位于 $(1,1)$ 的星星消失了，原先位于 $(1,3)$ 的星星移出了照片边界。其他两颗星星向右移动了 $1$ 像素。

### 子任务

- 测试点 3：$A=B=0$。
- 测试点 4-7：$A=1$，$B=0$，$N\le 10$。
- 测试点 8-9：$A=1$，$B=0$。
- 测试点 10-12：没有额外限制。


---

---
title: "[USACO25JAN] Cow Checkups S"
layout: "post"
diff: 普及+/提高
pid: P11670
tag: ['USACO', '2025']
---
# [USACO25JAN] Cow Checkups S
## 题目描述

Farmer John 的 $N$（$1 \leq N \leq 5 \cdot 10^5$）头奶牛站成一行，奶牛 $1$ 在队伍的最前面，奶牛 $N$ 在队伍的最后面。FJ 的奶牛也有许多不同的品种。他用从 $1$ 到 $N$ 的整数来表示每一品种。队伍从前到后第 $i$ 头奶牛的品种是 $a_i$（$1 \leq a_i \leq N$）。

FJ 正在带他的奶牛们去当地的奶牛医院进行体检。然而，奶牛兽医非常挑剔，仅愿意当队伍中第 $i$ 头奶牛为品种 $b_i$（$1 \leq b_i \leq N$）时对其进行体检。

FJ 很懒惰，不想完全重新排列他的奶牛。他将执行以下操作恰好一次。

- 选择两个整数 $l$ 和 $r$，使得 $1 \leq l \le r \leq N$。反转队伍中第 $l$ 头奶牛到第 $r$ 头奶牛之间的奶牛的顺序。

FJ 想要衡量这种方法有多少效果。求出对于所有 $N(N+1)/2$ 种可能的操作被兽医检查的奶牛数量之和。
## 输入格式

输入的第一行包含 $N$。

第二行包含 $a_1, a_2, \ldots, a_N$。

第三行包含 $b_1, b_2, \ldots, b_N$。
## 输出格式

输出一行，包含对于所有可能的操作被兽医检查的奶牛数量之和。
## 样例

### 样例输入 #1
```
3
1 3 2
3 2 1
```
### 样例输出 #1
```
3
```
### 样例输入 #2
```
3
1 2 3
1 2 3
```
### 样例输出 #2
```
12
```
### 样例输入 #3
```
7
1 3 2 2 1 3 2
3 2 2 1 2 3 1
```
### 样例输出 #3
```
60
```
## 提示

### 样例解释

#### 样例 #1
如果 FJ 选择 $(l=1,r=1)$，$(l=2,r=2)$ 或 $(l=3,r=3)$，则没有奶牛将会被检查。注意这些操作并没有改变奶牛的位置。

以下操作会导致一头奶牛被检查。

- $(l=1,r=2)$：FJ 反转第一头和第二头奶牛的顺序，因此新队伍中每头奶牛的品种将为 $[3,1,2]$。第一头奶牛将会被检查。
- $(l=2,r=3)$：FJ 反转第二头和第三头奶牛的顺序，因此新队伍中每头奶牛的品种将为 $[1,2,3]$。第二头奶牛将会被检查。
- $(l=1,r=3)$：FJ 反转第一头，第二头和第三头奶牛的顺序，因此新队伍中每头奶牛的品种将为 $[2,3,1]$。第三头奶牛将会被检查。

所有六种操作中被检查的奶牛数量之和为 $0+0+0+1+1+1=3$。

#### 样例 #2

有三种导致 $3$ 头奶牛被检查的可能操作：$(l=1,r=1)$，$(l=2,r=2)$ 和 $(l=3,r=3)$。其余每种操作均导致 $1$ 头奶牛被检查。所有六种操作中被检查的奶牛数量之和为 $3+3+3+1+1+1=12$。

### 子任务
- 测试点 4：$N\le 100$。
- 测试点 5：$N\le 5000$。
- 测试点 6-9：$a_i$，$b_i$ 均在范围 $[1,N]$ 内均匀随机生成。
- 测试点 10-15：$a_i$，$b_i$ 均在范围 $[1,2]$ 内均匀随机生成。
- 测试点 16-23：没有额外限制。


---

---
title: "[USACO25JAN] Farmer John's Favorite Operation S"
layout: "post"
diff: 普及+/提高
pid: P11671
tag: ['USACO', '2025']
---
# [USACO25JAN] Farmer John's Favorite Operation S
## 题目描述

又是 Farmer John 的农场上寒冷而无聊的一天。为了打发时间，Farmer John 发明了一种关于在整数数组上进行操作的有趣的休闲活动。

Farmer John 有一个包含 $N$（$1 \leq N \leq 2 \cdot 10^5$）个非负整数的数组 $a$ 和一个整数 $M$（$1 \leq M \leq 10^9$）。然后，FJ 会请 Bessie 给出一个整数 $x$。在一次操作中，FJ 可以选择一个索引 $i$，并对 $a_i$ 加 $1$ 或减 $1$。FJ 的无聊值是他必须执行的最小操作次数，以使得对于所有的 $1 \leq i \leq N$，$a_i-x$ 均可被 $M$ 整除。

对于所有可能的 $x$，输出 FJ 的最小无聊值。
## 输入格式

输入的第一行包含 $T$（$1 \leq T \leq 10$），为需要求解的独立的测试用例数量。

每一个测试用例的第一行包含 $N$ 和 $M$。

第二行包含 $a_1, a_2, ..., a_N$ （$0 \leq a_i \leq 10^9$）。

输入保证所有测试用例的 $N$ 之和不超过 $5 \cdot 10^5$。
## 输出格式

对于每一个测试用例输出一行，包含对于所有可能的 $x$，FJ 的最小无聊值。
## 样例

### 样例输入 #1
```
2
5 9
15 12 18 3 8
3 69
1 988244353 998244853
```
### 样例输出 #1
```
10
21
```
## 提示

### 样例解释

在第一个测试用例中，$x$ 的一个最优选择是 $3$。FJ 可以执行 $10$ 次操作使得 $a = [12, 12, 21, 3, 12]$。

### 子任务

- 测试点 2：$N \le 1000$ 以及 $M \le 1000$。
- 测试点 3：$N\le 1000$。
- 测试点 4-5：$M\le 10^5$。
- 测试点 6-16：没有额外限制。


---

---
title: "[USACO25JAN] Table Recovery S"
layout: "post"
diff: 普及+/提高
pid: P11672
tag: ['USACO', '2025']
---
# [USACO25JAN] Table Recovery S
## 题目描述

Bessie 有一个 $N\times N$（$1\le N\le 1000$）的加法表，其中对于所有 $1\le r,c\le N$，第 $r$ 行第 $c$ 列的方格中的整数为 $r+c$。例如，对于 $N=3$，表格如下所示：

```
2 3 4
3 4 5
4 5 6
```

不幸的是，Elsie 得到了这张表格，并通过执行若干次以下三种类型的操作对表格进行了变换。

1. 交换两行；
2. 交换两列；
3. 选择两个同时存在于表格中的值 $a$ 和 $b$，然后同时将每一个 $a$ 更改为 $b$，每一个 $b$ 更改为 $a$。

Elsie 总是按类型顺序执行操作；也就是说，她首先执行任意数量（可能为零）的类型 $1$ 操作，然后是类型 $2$ 操作，最后是类型 $3$ 操作。

请帮助 Bessie 恢复 Elsie 在执行完所有类型 $1$ 和 $2$ 操作后，但在执行任意类型 $3$ 操作之前，表格的一种可能状态。可能存在多种可能的答案，在这种情况下你应当输出字典序最小的答案。

按字典序比较两个表格时，比较它们在自然顺序（行间从上到下，行内从左到右）下读取时第一个不同的项。
## 输入格式

输入的第一行包含 $N$。

以下 $N$ 行每行包含 $N$ 个整数，表示 Elsie 变换后的 Bessie 的加法表。
## 输出格式

输出所有类型 1 和 2 操作后，类型 3 操作前，表格的字典序最小可能状态。输入保证答案存在。
## 样例

### 样例输入 #1
```
1
2
```
### 样例输出 #1
```
2
```
### 样例输入 #2
```
3
3 4 2
5 2 3
6 3 5
```
### 样例输出 #2
```
4 2 3
5 3 4
6 4 5
```
### 样例输入 #3
```
6
8 10 5 6 7 4
12 11 10 4 8 2
5 4 6 7 9 8
10 2 4 8 5 12
6 8 7 9 3 5
4 12 8 5 6 10
```
### 样例输出 #3
```
7 5 8 9 10 6
4 2 5 6 7 3
8 6 9 10 11 7
5 3 6 7 8 4
9 7 10 11 12 8
6 4 7 8 9 5
```
## 提示

### 样例解释

#### 样例 #1

无论 Elsie 执行什么操作表格均不会改变。

#### 样例 #2

以下是 Elsie 可能执行的一种操作序列。

```text
2 3 4
3 4 5
4 5 6
-> （操作 2：交换列 2 和 3）
2 4 3
3 5 4
4 6 5
-> （操作 2：交换列 1 和 2）
4 2 3
5 3 4
6 4 5
-> （操作 3：交换值 2 和 3）
4 3 2
5 2 4
6 4 5
-> （操作 3：交换值 3 和 4）
3 4 2
5 2 3
6 3 5
```
注意：以下也是经过类型 1 和 2 操作后表格的一种可能状态，但它不是字典序最小的，因为第一行的第二项比正确答案中的要大。
```
4 6 5
3 5 4
2 4 3
```

### 子任务

- 测试点 4-5：$N\le 6$。
- 测试点 6-7：$N\le 8$。
- 测试点 8-11：$N\le 100$。
- 测试点 12-15：没有额外限制。


---

---
title: "[USACO25JAN] Reachable Pairs G"
layout: "post"
diff: 普及+/提高
pid: P11674
tag: ['USACO', '2025']
---
# [USACO25JAN] Reachable Pairs G
## 题目描述

考虑一个无向图，包含 $N$ 个结点，编号为 $1\dots N$，以及 $M$ 条边（$1\le N\le 2\cdot 10^5$，$0\le M\le 4\cdot 10^5$）。给定一个位串 $s_1s_2\dots s_N$。对于每一个 $t\in [1,N]$，在时刻 $t$ 时，

- 如果 $s_t=0$，则从图中移除结点 $t$。
- 如果 $s_t=1$，则从图中移除结点 $t$，并在结点 $t$ 被移除之前的每对邻居之间添加一条边。

注意在这两种情况下，当一个结点从图中被移除时它的所有相邻边也会被移除。

计算在每一个时刻 $1\ldots N$ 之前，可以通过一组边相互到达的结点对数。
## 输入格式

输入的第一行包含 $N$ 和 $M$。

第二行包含长为 $N$ 的位串 $s$。

以下 $M$ 行，每行包含两个整数，表示图中的一条边。
## 输出格式

输出 $N$ 行，为每一个时刻之前所求的对数。

## 样例

### 样例输入 #1
```
3 2
111
1 2
1 3
```
### 样例输出 #1
```
3
1
0
```
### 样例输入 #2
```
3 2
000
1 2
1 3
```
### 样例输出 #2
```
3
0
0
```
### 样例输入 #3
```
7 8
1101101
6 2
1 2
2 3
6 3
1 3
1 7
4 5
2 7
```
### 样例输出 #3
```
11
7
4
2
1
1
0
```
## 提示

样例 1 解释：

在移除之前，所有结点对之间都可以相互到达。结点 $1$ 被移除后，结点 $2$ 和 $3$ 之间添加了一条边，因此它们仍然可以相互到达。

样例 2 解释：

在移除之前，所有结点对之间都可以相互到达。结点 $1$ 被移除后，结点 $2$ 和 $3$ 之间不再可以相互到达。

- 测试点 $4\sim 6$：$N\le 100$。
- 测试点 $7\sim 8$：所有 $s_i$ 均等于 $0$。
- 测试点 $9\sim 11$：所有 $s_i$ 均等于 $1$。
- 测试点 $12\sim 23$：没有额外限制。


---

---
title: "[ROIR 2025] 不完全质数"
layout: "post"
diff: 普及+/提高
pid: P11698
tag: ['2025', 'Special Judge', 'ROIR（俄罗斯）']
---
# [ROIR 2025] 不完全质数
## 题目背景

翻译自 [ROIR 2025 D1T2](https://neerc.ifmo.ru/school/archive/2024-2025/ru-olymp-regional-2025-day1.pdf)。$%标题解析 by GPT：在俄语中，**"простые числа"**（质数）是由**"простой"**（简单的、普通的）和**"число"**（数字、数）构成的短语，表示“质数”这一数学概念。当在 **"простые"** 后加上 **"-оват-"** 后缀（即变为 **"простоватые"**），这个词的含义就发生了变化。**"-оват-"** 是俄语中的一个后缀，用于形容词或名词，通常会带有一种轻微的、不完全的含义，或者带有一种贬义或降低的语气。**"-оват-"** 后缀通常表示某物处于某种状态，但并不是完全符合该状态或标准，带有一些“接近但不完全”的意味。它强调了某种特性，但并不完全具备。例如：- **"молодой"**（年轻的）变成 **"молодоватый"**（有点年轻、不完全年轻）。- **"сильный"**（强的）变成 **"сильноватый"**（有点强，但不完全强）。在这种情况下，**"простоватые"** 由 **"простой"**（简单的）加上 **"-оват-"** 后缀构成，表示“有点简单的”或者“接近简单的”，即“简单但不完全是质数”的意思。所以，**"простоватые числа"** 指的是“接近质数的数字”，即这些数字的数字乘积是质数，但并不完全符合质数的定义。$
## 题目描述

如果一个数字在十进制表示下的各位数字之积是一个质数，则称这个数为“不完全质数”。例如，$12$ 是一个不完全质数，因为 $1 \times 2 = 2$ 是质数；但是 $29$ 不是不完全质数，因为 $2 \times 9 = 18$ 不是质数。

现在，你需要计算出 $[l,r]$ 的不完全质数的数量。
## 输入格式

第一行包含一个整数 $l$（$1 \leq l \leq 10^{100000}$）。  
第二行包含一个整数 $r$（$l \leq r \leq 10^{100000}$）。

请注意：输入中的数字非常大，无法直接存储在大多数编程语言的标准整型数据中，例如 C++。因此，需要以特殊的方式读取输入，例如将其作为字符串读取。
## 输出格式

输出一个整数，表示 $[l,r]$ 的不完全质数的数量。
## 样例

### 样例输入 #1
```
42
179
```
### 样例输出 #1
```
10
```
## 提示

本题使用 Subtask 捆绑测试。数据中 Subtask 0 是样例。

| 子任务 | 分数  | 特殊性质 |
|:------------:|:-------:|:----------:|
| $1  $        |$ 19  $  | $1 \leq l \leq r \leq 10^6$ | 第一错误 |
| $2  $        | $26  $  | $1 \leq l \leq r \leq 10^{18}$ | 第一错误 |
| $3  $        | $12  $  | $l = 1, r = 10^k$，其中 $1 \leq k \leq 10^5$ | 第一错误 |
| $4 $         | $18 $   | $1 \leq l \leq r \leq 10^{1000}$ | 第一、二错误 |
| $5$          | $25$    | 无 | - |


---

---
title: "[ROIR 2025] 不平衡划分"
layout: "post"
diff: 普及+/提高
pid: P11702
tag: ['2025', 'Special Judge', 'ROIR（俄罗斯）']
---
# [ROIR 2025] 不平衡划分
## 题目背景

翻译自 [ROIR 2025 D2T2](https://neerc.ifmo.ru/school/archive/2024-2025/ru-olymp-regional-2025-day2.pdf)。
## 题目描述

给定一个非负整数数组 $[a_1, a_2, \dots, a_n]$。考虑将该数组划分成 $k$ 个非空的连续子段。我们称划分方案的“不平衡度”为这些子段和中的最大值与最小值之差。你需要求出将该数组划分成 $k$ 个子段时的最大不平衡度。

例如，如果数组为 $[2, 1, 3, 4]$，$k=2$，则：
- 划分为 $[2, 1, 3][4]$ 时，不平衡度为 $6 - 4 = 2$；
- 划分为 $[2, 1][3, 4]$ 时，不平衡度为 $7 - 3 = 4$；
- 划分为 $[2][1, 3, 4]$ 时，不平衡度为 $8 - 2 = 6$。

其中最后一种情况的不平衡度最大。
## 输入格式

第一行输入两个整数 $n$ 和 $k$（$2 \le k \le n \le 300000$），分别表示数组的长度和需要划分的子段的数量。

第二行包含 $n$ 个整数 $a_1,a_2,\dots,a_n$（$0 \le a_i \le 10^9$）。
## 输出格式

输出一个整数，即将该数组划分为 $k$ 个子段时的最大不平衡度。
## 样例

### 样例输入 #1
```
4 2
2 1 3 4
```
### 样例输出 #1
```
6

```
### 样例输入 #2
```
5 4
2 1 3 4 1
```
### 样例输出 #2
```
6
```
## 提示

在样例二中，最优划分方案是 $[2][1][3, 4][1]$。其中最大子段和为 $3 + 4 = 7$，最小子段和为 $1$，因此不平衡度为 $7 - 1 = 6$。

本题使用 Subtask 捆绑测试。数据中 Subtask 0 是样例。

| 子任务 | 分数 | 特殊性质 |
|:---:|:---:|:---:|
| $1$ | $11$ | $n \le 15$ | 第一错误 | |
| $2$ | $11$ | $k = 2$ | 第一错误 | |
| $3$ | $21$ | $k = 3$ | 第一错误 | |
| $4$ | $15$ | $n \le 300$ | 1 | 第一错误 |
| $5$ | $21$ | $n \le 3000$ | 1, 4 | 第一错误 |
| $6$ |$ 21 $| 无 | 1-5 | 第一错误 |


---

---
title: "[ROIR 2025] 个人 OI 比赛的原则"
layout: "post"
diff: 普及+/提高
pid: P11703
tag: ['2025', 'Special Judge', 'ROIR（俄罗斯）']
---
# [ROIR 2025] 个人 OI 比赛的原则
## 题目背景

翻译自 [ROIR 2025 D2T3](https://neerc.ifmo.ru/school/archive/2024-2025/ru-olymp-regional-2025-day2.pdf)。
## 题目描述

重温一下个人参加 OI 比赛的原则：每道题都要有分！不能有题目得零分。

让我们模拟一个 OI 比赛的过程。假设比赛中有 $n$ 道题目，第 $i$ 道题目包含 $k_i$ 个子任务，第 $i$ 道题目的第 $j$ 个子任务可以获得 $c_{i, j}$ 分。子任务之间是独立的，因此你可以在每道题中选择任意数量的子任务来解答。但是，你不能一个子任务都不选，因为那样这道题得分就是 $0$ 分，这违反了原则。

你想知道，是否可以在遵守原则的前提下，恰好获得 $s$ 分。
## 输入格式

第一行输入两个整数 $n$ 和 $s$（$1 \leq n \leq 100000$，$1 \leq s \leq 100000$），分别表示比赛中的题目数量和所需的总得分。接下来 $2n$ 行输入题目的描述，每道题目的描述包含两行：

- 第 $i$ 道题目的第一行包含一个整数 $k_i$（$1 \leq k_i \leq 100000$），表示第 $i$ 道题目有多少个子任务。
- 第 $i$ 道题目的第二行包含 $k_i$ 个整数 $c_{i,1}, c_{i,2}, \dots, c_{i,k_i}$（$1 \leq c_{i,j} \leq 100000$），表示各个子任务的分值。

保证 $k_1 + k_2 + \dots + k_n \leq 100000$，且 $(k_1 + k_2 + \dots + k_n) \cdot s \leq 10^7$。
## 输出格式

如果无解，输出 `No`。

否则，第一行输出 `Yes`。接下来，输出每道题目选择的子任务。

对于第 $i$ 道题目，先输出一行一个整数 $m_i$（$1 \leq m_i \leq k_i$），表示你选择的子任务数量。接下来在下一行输出 $m_i$ 个不同的整数 $p_{i, 1}, p_{i, 2}, \dots, p_{i, m_i}$（$1 \leq p_{i, j} \leq k_i$），表示你选择的第 $i$ 道题目的子任务编号。

如果有多个方案可以获得恰好 $s$ 分，可以输出其中任意一个。
## 样例

### 样例输入 #1
```
2 4
1
2
2
3 1
```
### 样例输出 #1
```
No
```
### 样例输入 #2
```
2 4
1
2
2
2 1
```
### 样例输出 #2
```
Yes
1
1
1
1
```
## 提示

本题使用 Subtask 捆绑测试。数据中 Subtask 0 是样例。

| 子任务 | 分数 | 特殊性质 |
| :--: | :--: | :--: |
| $1$ | $8$ | $n = 1$ | — | 第一种错误 |
| $2$ | $10$ | $n = 2$ | — | 第一种错误 |
| $3$ | $6$ | $k_1 + k_2 + \dots + k_n \leq 20$ | — | 第一种错误 |
| $4$ | $6$ | $k_i = 1$ | — | 第一种错误 |
| $5$ | $15$ | $n \cdot s \leq 100000$, $s \leq 1000$ | 第三种错误 | — |
| $6$ | $55$ | 无 | 第1至第5种错误 | — |


---

---
title: "[JOIG 2025] 修学旅行 / School Trip"
layout: "post"
diff: 普及+/提高
pid: P11725
tag: ['2025', 'O2优化', 'JOI（日本）']
---
# [JOIG 2025] 修学旅行 / School Trip
## 题目描述

JOIG 高中有 $3^N$ 名学生，编号从 $1$ 到 $3^N$。

JOIG 高中决定举行一场学校旅行，有两个可能的旅行目的地：阿拉斯加（记为“方案 $\texttt{A}$”）和玻利维亚（记为“方案 $\texttt{B}$”）。学生们决定使用以下的流程确定最终的旅行方案：

- 考虑一个长度为 $3^N$ 的字符串 $S$：如果学生 $i\left(1\le i\le 3^N\right)$ 选择方案 $\texttt{A}$，那么 $S_i$ 为 $\texttt{A}$，否则为 $\texttt{B}$；
- 执行以下操作 $N$ 次：
  - 假设当前 $S$ 的长度为 $X$，考虑一个长度为 $\frac{X}{3}$ 的字符串 $S'$，满足 $S'_j\left(1\le j\le\frac{X}{3}\right)$ 为 $S_{3j-2},S_{3j-1},S_{3j}$ 中出现次数较多的字符（$\texttt{A}$ 或 $\texttt{B}$）；接着将 $S$ 替换为 $S'$；
- 所有操作结束之后，$S$ 将成为一个长度为 $1$ 的字符串（要么为 $\texttt{A}$ 要么为 $\texttt{B}$）；如果 $S$ 为 $\texttt{A}$，那么学校最终选取方案 $\texttt{A}$，否则选取方案 $\texttt{B}$。

初始时，我们使用一个字符串 $T$ 表示每名学生选择哪个方案：如果学生 $i\left(1\le i\le 3^N\right)$ 选择方案 $\texttt{A}$，那么 $T_i$ 为 $\texttt{A}$，否则为 $\texttt{B}$。

之后依次发生了 $Q$ 次事件，第 $k(1\le k\le Q)$ 次事件中，学生 $p_k\left(1\le p_k\le 3^N\right)$ 改变了其选择的方案，即若原来他 / 她选择方案 $\texttt{A}$，那么现在他 / 她选择的方案变为 $\texttt{B}$，反之亦然。

对于 $k=1,2,\ldots,Q$，求出第 $k$ 次事件发生后，按照上述流程，学校会选择哪个旅行方案。
## 输入格式

第一行输入两个整数 $N,Q$。

第二行输入一个字符串 $T$。

接下来 $Q$ 行，每行一个整数 $p_k$。
## 输出格式

输出 $Q$ 行，第 $k(1\le k\le Q)$ 行一个字符串表示第 $k$ 次事件过后学校选择的旅行方案：如果为 $\texttt{A}$，那么学校选择方案 $\texttt{A}$；如果为 $\texttt{B}$，那么学校选择方案 $\texttt{B}$。
## 样例

### 样例输入 #1
```
2 3
ABABBAABB
3
8
4
```
### 样例输出 #1
```
B
B
A
```
### 样例输入 #2
```
2 5
AAAAAAAAA
1
2
7
8
5
```
### 样例输出 #2
```
A
A
A
B
B
```
### 样例输入 #3
```
1 4
AAB
3
1
2
3
```
### 样例输出 #3
```
A
A
B
B
```
### 样例输入 #4
```
3 6
AABABABBABAABABBBBBBAABABAA
4
1
9
3
8
9
```
### 样例输出 #4
```
B
B
B
B
B
A
```
## 提示

#### 【样例解释 #1】

- 在第 $1$ 次事件发生后，确定方案流程中，$S$ 的变化为 $\texttt{ABBBBAABB}\to\texttt{BBB}\to\texttt{B}$，最终选取方案 $\texttt{B}$；
- 在第 $2$ 次事件发生后，确定方案流程中，$S$ 的变化为 $\texttt{ABBBBAAAB}\to\texttt{BBA}\to\texttt{B}$，最终选取方案 $\texttt{B}$；
- 在第 $3$ 次事件发生后，确定方案流程中，$S$ 的变化为 $\texttt{ABBABAAAB}\to\texttt{BAA}\to\texttt{A}$，最终选取方案 $\texttt{A}$。

该样例满足子任务 $2,5$ 的限制。

#### 【样例解释 #2】

该样例满足子任务 $2,4,5$ 的限制。

#### 【样例解释 #3】

该样例满足子任务 $1,2,3,5$ 的限制。

#### 【样例解释 #4】

该样例满足子任务 $2,5$ 的限制。

#### 【数据范围】

- $1\le N\le 12$；
- $1\le Q\le 2\times 10^5$；
- $T$ 是长度为 $N$ 且仅包含大写字母 $\texttt{A}$ 和 $\texttt{B}$ 的字符串；
- $1\le p_k\le 3^N(1\le k\le Q)$。

#### 【子任务】

1. （$8$ 分）$N=1$；
2. （$17$ 分）$Q\le 10$；
3. （$22$ 分）$p_k\le 5(1\le k\le Q)$；
4. （$28$ 分）$T$ 中所有字符均为 $\texttt{A}$ 且之后的修改均满足 $p_k\ne p_l(1\le k<l\le Q)$；
5. （$25$ 分）无附加限制。


---

---
title: "Dynamic Array Problem"
layout: "post"
diff: 普及+/提高
pid: P11743
tag: ['O2优化']
---
# Dynamic Array Problem
## 题目描述

你有一个序列长度为 $n$ 的序列 $a$！初始时序列只有两端有隔板，其他位置没有。

你可以插入任意多个隔板，隔板不重合，且隔板不起到分割序列的作用。插入后，选择至多 $k$ 对 **可以不相邻** 的隔板，将他们之间的序列元素翻转。它们之间的隔板的位置不受影响，只改变元素位置，要求一个元素至多被翻转一次。

如果两个隔板相邻且他们之间的元素下标是 $l$ 到 $r$，则会对总贡献产生的权值为：$\sum\limits_{i=l}^{r} a_i \times (i - l + 1)$。求操作后的总贡献的最大值。

## 输入格式

第一行两个整数 $n$ 和 $k$。

第二行 $n$ 个整数表示最开始的序列 $a$。

## 输出格式

输出一行整数，代表操作后总贡献的最大值。
## 样例

### 样例输入 #1
```
10 1
1 1 5 -4 -7 4 -8 0 -3 2 
```
### 样例输出 #1
```
10
```
## 提示

**【样例解释 $\mathbf 1$】**

序列初始两端各有一个隔板。在序列第 $2$ 个位置，第 $7$ 个位置，第 $8$ 个位置后添加隔板。并将第 $1$ 个位置到第 $7$ 位置中间的元素翻转。最后得到的序列权值为 $10$。可以证明不存在比这更大的权值。

**【样例解释 $\mathbf 2$】**

本题提供大样例，该数据满足 `Subtask 3` 的限制。具体求解不做解释。

---

**【数据规模与约定】**

**本题开启子任务捆绑测试**。本题自动开启 O2 优化。


* Subtask 1（15 pts）：$n\leq 20$。
* Subtask 2（45 pts）：$n\leq 100$。
* Subtask 3（40 pts）：$n\leq 550$。

对于所有测试点满足 $1\leq n \leq 550$，$1\leq k \leq n$，$-10^9 \leq a_i \leq 10^9$。



---

---
title: "[COCI 2024/2025 #5] 塔楼 / Tornjevi"
layout: "post"
diff: 普及+/提高
pid: P11753
tag: ['2025', 'COCI（克罗地亚）']
---
# [COCI 2024/2025 #5] 塔楼 / Tornjevi
## 题目背景

译自 [COCI 2024/2025 #5](https://hsin.hr/coci/) T3。$\texttt{2s,0.5G}$。满分为 $90$。

## 题目描述


给定正整数序列 $h_1,\ldots,h_n$。

对于区间 $[l,r]$，我们称 $i$（$l\le i\le r$）关于 $[l,r]$ 是**好的**，当且仅当：$h_i=\gcd(h_l,h_{l+1},\ldots,h_r)$。

对于 $i$，定义 $f(i)$ 表示：所有 $i$ 关于 $[l,r]$ 是好的区间中，$r-l+1$ 的最大值。

对于 $i=1,2,\ldots,n$，求出 $f(i)$。
## 输入格式


第一行，正整数 $n$。

第二行，$n$ 个正整数 $h_1,h_2,\ldots,h_n$。
## 输出格式

输出 $n$ 个正整数 $f(1),f(2),\ldots,f(n)$。

## 样例

### 样例输入 #1
```
6
3 6 6 6 1 3
```
### 样例输出 #1
```
4 3 3 3 6 1
```
### 样例输入 #2
```
5
10 2 10 15 5
```
### 样例输出 #2
```
1 3 1 1 3
```
## 提示


#### 数据范围

对于 $100\%$ 的数据，保证 $1\le n,h_i\le 10^6$。

| 子任务编号 |  $n\le$ | 特殊性质 | 得分 |  
| :--: | :--: | :--: | :--: |
| $ 1 $    |  $100$  |   | $ 7 $   |  
| $ 2 $    |  $5\times 10^3$  |  | $ 11 $   |  
| $ 3 $    |  $5\times 10^4$  |  | $ 17 $   |  
| $ 4 $    | $10^6$  |  A | $ 29 $   |  
| $ 5 $   |  $10^6$  | | $26$ |

特殊性质 A：$h_i\le 100$。



---

---
title: "[COTS 2013]  集合求解 / BOMBONI"
layout: "post"
diff: 普及+/提高
pid: P11777
tag: ['2013', 'COCI（克罗地亚）']
---
# [COTS 2013]  集合求解 / BOMBONI
## 题目描述

存在若干个集合（集合数量未知，不存在空集），给定 $n$，每个集合中元素 $x$ 满足 $1 \le x \le n$，你现在已知 $M$ 个集合内的元素情况。

定义全集 $U=\{1,2,\dots ,n\}$，这若干个集合间满足两个性质：

- 若集合 $A$ 存在，那么 $\complement_UA$ 也存在。
- 对于当前的两个集合 $A,B$，集合 $C=A \cup B$ 也存在。

希望你求出最小的集合数量，把它对 $10^9+9$ 取模的结果。
## 输入格式

第一行一个整数 $n$。

第二行一个整数 $M$，表示已知的集合数量。

以下 $M$ 行，一行一个整数 $B$，表示当前集合元素数量，随后是 $B$ 个数字，表示集合元素。
## 输出格式

一行一个整数，即最小集合数量对 $10^9+9$ 取模的结果。
## 样例

### 样例输入 #1
```
3 
1 
2 1 2
```
### 样例输出 #1
```
3
```
### 样例输入 #2
```
10 
2 
6 3 4 5 6 7 8 
2 5 6
```
### 样例输出 #2
```
7
```
## 提示

【样例解释】

- 对于第一个样例，集合为 $\{1,2\},\{3\},\{1,2,3\}$。

- 对于第二个样例，另外的 $5$ 个集合为 $\{1, 2, 9, 10\},\{1,2,3,4,7,8,9,10\},\{1,2,3,4,5,6,7,8,9,10\},\{3,4,7,8\},\{1,2,5,6,9,10\}$。

【数据范围与约定】

- 对于 $40\%$ 的数据，满足 $n \le 30$，答案不超过 $5000$。

- 对于 $100 \%$ 的数据，满足 $1\le n \le 2\times 10^5,1\le M \le 50$。


---

---
title: "[JOI 2019 Final] 画展 / Exhibition"
layout: "post"
diff: 普及+/提高
pid: P11789
tag: ['2019', 'JOI（日本）']
---
# [JOI 2019 Final] 画展 / Exhibition
## 题目描述

你将举办一个画展。在展览中，你需要将一些画放入一些画框中并摆放成一排。

展览有 $N$ 幅候选画，编号从 $1$ 到 $N$。画 $i$ 具有大小 $S_i$ 和美观度 $V_i$。

另外，有 $M$ 个候选画框，编号从 $1$ 到 $M$。画框 $j$ 的大小为 $C_j$。

只有大小不超过 $C_j$ 的画才能放入画框 $j$ 中。每个画框中最多只能放一幅画。每幅要展出的画都必须放在一个画框中。

考虑到美观因素，展出的画必须满足以下条件：

  - 对于任意两幅相邻的画，右边的画框大小不小于左边的画框。
   - 对于任意两幅相邻的画，右边的画的美观度不小于左边的画的美观度。

你需要求出你最多能展出多少幅画。
## 输入格式

一行两个整数 $N,M$。

接下来 $N$ 行，每行两个整数 $S_i,V_i$，含义如题所示。

接下来 $M$ 行，每行一个整数 $C_i$，含义如题所示。
## 输出格式

一行一个整数，表示能展示的画的数量。
## 样例

### 样例输入 #1
```
3 4
10 20
5 1
3 5
4
6
10
4
```
### 样例输出 #1
```
2
```
### 样例输入 #2
```
3 2
1 2
1 2
1 2
1
1
```
### 样例输出 #2
```
2
```
### 样例输入 #3
```
4 2
28 1
8 8
6 10
16 9
4
3
```
### 样例输出 #3
```
0
```
### 样例输入 #4
```
8 8
508917604 35617051
501958939 840246141
485338402 32896484
957730250 357542366
904165504 137209882
684085683 775621730
552953629 20004459
125090903 607302990
433255278
979756183
28423637
856448848
276518245
314201319
666094038
149542543
```
### 样例输出 #4
```
3
```
## 提示


【数据范围与约定】

- $ 1\le  N \le 100000 $。
- $ 1 \le M \le 100000 $。
- $ 1\le S_i \le 10^9$。
- $ 1\le V_i,C_j \le 10^9$。

1. 对于 $ 10 \%$ 的数据，$ N \le 10 $，$ M \le 10 $。
2. 对于 $ 40 \%$ 的数据，$ N \le 1000 $，$ M \le 1000 $。
3. 对于 $ 50 \%$ 的数据，无特殊限制。


---

---
title: "[JOI 2017 Final] 焚风现象 / Foehn Phenomena"
layout: "post"
diff: 普及+/提高
pid: P11790
tag: ['2017', 'JOI（日本）']
---
# [JOI 2017 Final] 焚风现象 / Foehn Phenomena
## 题目描述

你知道 $N+1$ 个地点的海拔 $A_i$，编号为 $0 \dots N$，有风从 $0$ 吹向 $N$，想让你求出地点 $N$ 的风的温度，保证 $A_0=0$。

规则：
- 如果 $A_i=A_{i+1}$，风的温度不变。
- 如果 $A_i>A_{i+1}$，由于海拔降低，风的温度会上升 $(A_i-A_{i+1})\times T$ 度。
- 如果 $A_i<A_{i+1}$，由于海拔升高，风的温度会下降 $(A_{i+1}-A_i)\times S$ 度。
## 输入格式

- 第一行输入包括四个被空格隔开的整数 $N,Q,S,T$。这表示 JOI 先生在地点 $N$ 有一所房子，有 $Q$ 次地壳运动，海拔每上升 $1$ 米的话，风的温度会降低 $S$ 度，海拔每下降一米的话,风的温度会上升 $T$ 度。

- 接下来的 $N+1$ 行中第 $i$ 行 $(1\leq i\leq N+1)$ 包含一个整数 $A_{i-1}$，表示地壳运动前地点 $i-1$ 的海拔高度。
- 接下来的 $Q$ 行中第 $j$ 行 $(1\leq j\leq Q)$ 包括三个被空格隔开的整数 $L_j,R_j,X_j$，这表示第 $j$ 天地壳运动使地点 $L_j$ 到地点 $R_j$ 中这些地点的海拔变化了 $X_j$。
## 输出格式

输出 $Q$ 行，第 $j$ 行的输出代表第 $j$ 天地壳运动后 JOI 先生家的风的温度。
（即 $N$ 位置的风的温度。）
## 样例

### 样例输入 #1
```
3 5 1 2
0
4
1
8
1 2 2
1 1 -2
2 3 5
1 2 -1
1 3 5
```
### 样例输出 #1
```
-5
-7
-13
-13
-18
```
### 样例输入 #2
```
2 2 5 5
0
6
-1
1 1 4
1 2 8
```
### 样例输出 #2
```
5
-35
```
### 样例输入 #3
```
7 8 8 13
0
4
-9
4
-2
3
10
-9
1 4 8
3 5 -2
3 3 9
1 7 4
3 5 -1
5 6 3
4 4 9
6 7 -10
```
### 样例输出 #3
```
277
277
322
290
290
290
290
370
```
## 提示

【数据范围与约定】

对于所有数据，均满足：

- $1\le N\le 200000$。
- $1\le Q\le 200000$。
- $1\le S\le 1000000$。
- $1\le T\le 1000000$。
- $-1000000\le A_i\le 1000000(1\le i\le N)$．
- $1\le L_j\le R_j\le N (
1\le j\le Q)$。
- $−1000000\le Xj\le 1000000 (1\le j\le Q)$。

1. Subtask $1$（$30$ pts）：满足 $N,Q \le 2000$。
2. Subtask $1$（$10$ pts）：满足 $S=T$。
3. Subtask $1$（$60$ pts）：无特殊限制。



---

---
title: "「o.OI R1」α+β Problem"
layout: "post"
diff: 普及+/提高
pid: P11864
tag: ['Special Judge', 'O2优化']
---
# 「o.OI R1」α+β Problem
## 题目背景

机器人小 $\alpha$ 喜欢做游戏，机器人小 $\beta$ 喜欢玩游戏。
## 题目描述

现在，它们正在玩一个叫作推箱子的游戏！

机器人小 $\beta$ 为关卡制定了一个用字符串表示的移动路径：

|字符|含义|
| :-----------: | :-----------: | 
|`W`|让机器人前进一格|
|`S`|让机器人后退一格|
|`A`|让机器人左转|
|`D`|让机器人右转|

身为机器人小 $\alpha$，你需要构造一个 $n\times m$ 的地图：

|字符|含义|
| :-----------: | :-----------: | 
|`\|`|机器人无法穿过的墙壁||
|`X`|机器人最开始在的位置|
|`S`|箱子最开始所在的位置|
|`.`|空地|

注意每个位置的东西只能是以上四种之一。

机器人的初始位置是给定的，方向朝上，地图外都是墙。

小 $\beta$ 完成移动后，所有箱子都必须移动过，小 $\alpha$ 需要让这个地图的箱子数最多，且小 $\beta$ 每步操作都合法。

以下给出所有不合法的操作： 

|操作|不合法情况|
| :-----------: | :-----------: | 
|`W`|机器人前方是墙|
|`W`|机器人前方两格都是箱子|
|`W`|机器人前方两格分别是箱子和墙|
|`S`|机器人后方是箱子或墙|

小 $\alpha$ 需要一份程序来完成这份工作。
## 输入格式

**本题有多组数据。**

第一行一个正整数 $T$ 表示数据组数。

对于每组数据：
- 第一行两个整数 $n,m$。
- 第二行三个整数 $x,y,k$。
- 第三行一个长度为 $k$ 的字符串 $s$。

输入的数据含义如下：
- $n$ 和 $m$ 代表需要构造的地图的大小为 $n$ 行 $m$ 列。
- $x$ 和 $y$ 代表机器人的初始位置在从上往下第 $x$ 行从左往右第 $y$ 列。
- $k$ 代表移动路径的长度，$s$ 代表移动路径。

**本题数据量较大，请使用较快的读写方式。**
## 输出格式

对于每组数据，你需要给出一个 $n\times m$ 的地图代表你构造的地图，格式如题目描述所述。

**所有最优的答案都可以得分。**
## 样例

### 样例输入 #1
```
1
3 4
2 2 17
DWSAWDWSSDWAWDWAW
```
### 样例输出 #1
```
..S.
SXS.
..S.
```
### 样例输入 #2
```
1
3 4
3 4 9
WSAWWDWDW
```
### 样例输出 #2
```
|.|.
|SSS
..SX
```
### 样例输入 #3
```
1
3 4
2 1 8
DWASDWAW
```
### 样例输出 #3
```
||.|
XS.|
|.S.
```
### 样例输入 #4
```
2
5 4
5 1 9
WDWAWDWAW
5 19
5 8 12
DDSAADDADADW
```
### 样例输出 #4
```
....
..S.
.SS.
SS..
X...
.........||||||||||
.........||......||
||||||...||......||
||..||...||......||
||||||.X.||||||||||
```
## 提示

部分样例有其他正确答案。

**「数据范围」**

**本题开启 Special Judge 与捆绑测试。**  

一个测试点内，如果对于每组数据你的箱子数是最多的，且方案合法，你才能获得该测试点的分数。 

只有通过一个子任务内的所有测试点才能得到该子任务的分数。

对于所有测试数据，保证：
- $1\leq n,m\leq 2000$，$1\leq \sum nm\leq 4\times 10^6$。
- $1\leq x\leq n$，$1\leq y\leq m$。
- $1\leq k,\sum k\leq 10^6$。
- $s_i\in\{\texttt{W},\texttt{A},\texttt{S},\texttt{D}\}$。
- 小 $\beta$ 的移动在空旷地图下一定合法。

| 子任务 | $n,m$ | $\sum nm$ | $\sum k$ | 特殊性质 | 分值 |
|:-:|:-:|:-:|:-:|:-:|:-:|
|$0$ | $\leq4$ | $\leq 40$ | $\leq100$ | 无 | $10$ |
|$1$ | $=45$ | $=2025$ | $\leq10^3$ | A | $10$ |
|$2$ | $\leq200$ | $\leq 4\times 10^4$ | $\leq10^3$ | 无 | $20$ |
|$3$ | $\leq1000$ | $\leq 2\times 10^6$ | $\leq10^6$ | B | $15$ |
|$4$ | $\leq1000$ | $\leq 2\times 10^6$ | $\leq10^6$ | C | $20$ |
|$5$ | $\leq2000$ | $\leq 4\times 10^6$ | $\leq10^6$ | 无 | $25$ |

- 特殊性质 A：前进和后退的总次数不超过 $20$ 次，且 $x=y=23$。
- 特殊性质 B：$s_i\in\{\texttt{W},\texttt{A},\texttt{D}\}$，且只会朝两个方向前进。
- 特殊性质 C：可放箱子的最大数量为 $0$ 或 $1$。

---

尽管比赛中不会返回，我们仍将告诉你 Special Judge 会返回的对应信息，优先级递减。
- `Error: 1`：出现规定以外的字符。
- `Error: 2`：出生点不在正确的位置。
- `Error: 3`：机器人无法前进。
- `Error: 4`：机器人无法后退。
- `Error: 5`：有箱子没有被推动过。
- `Error: 6`：箱子数不是最多的。
 - `Correct`：测试点通过。


---

---
title: "[威海市赛2024] 找数"
layout: "post"
diff: 普及+/提高
pid: P11870
tag: []
---
# [威海市赛2024] 找数
## 题目描述

喂喂喂？在不在？小威给你下发了一个任务：

给定 $n$ 和 $m$，从 $1 \sim n$ 中随意挑出 $m$ 个数，之后对选出的数排序，称为 $p$。

小威想知道，排序后的序列 $p$ 中，奇数位全为奇数，偶数位全为偶数的方案数，对 $998\ 244\ 353$ 取模。

很不巧，你在他问"在不在？"的时候就回复他了。这下不得不帮他解决问题了 :(
## 输入格式

一行两个整数 $n, m$，含义如上所述。

对于所有数据，满足：$1 \leq m \leq n \leq 10^6$。

## 输出格式

输出一个整数，表示合法方案数对 $998\ 244\ 353$ 取模后的结果。
## 样例

### 样例输入 #1
```
2 1
```
### 样例输出 #1
```
1
```
### 样例输入 #2
```
4 2
```
### 样例输出 #2
```
3
```
### 样例输入 #3
```
8 5
```
### 样例输出 #3
```
6
```


---

---
title: "[威海市赛2024] 异或盒子 1"
layout: "post"
diff: 普及+/提高
pid: P11872
tag: []
---
# [威海市赛2024] 异或盒子 1
## 题目背景

"诶？我当数据结构？真的假的？"
## 题目描述

小威有一个神奇的异或盒子！

盒子中有 $n$ 个元素，每个元素都有一个权值 $v_i$。每当小威念出神秘咒语之时，盒子可以告诉小威，盒子中元素的异或和是多少。

有一天，这个盒子被小海发现了。小海问小威："我能不能向盒子提 $q$ 个要求？我希望改变盒子中某一个元素的权值，或者让所有元素的权值都 $+1$。除此之外，我还想念你那个神秘的咒语！""好啊，没问题啊。"

你可能想问，"那我呢？"

你就是这个神奇的异或盒子！现在请你满足小海的要求吧！
## 输入格式

第一行包含两个整数 $n$ 和 $q$，含义如上所述。

第二行包含 $n$ 个整数 $v_i$。

接下来 $q$ 行，每行首先输入一个整数 $op$，表示要求种类：

- $op = 0$：输入格式为 $op\ x\ p$，表示将 $v_x$ 更改为 $p$；
- $op = 1$：输入格式为 $op$，表示将所有的元素权值 $+1$；
- $op = 2$：输入格式为 $op$，表示查询所有元素的异或和。

对于所有数据，满足：$1 \leq n, q \leq 10^5$，$0 \leq p, v_i \leq 10^5$，$1 \leq x \leq n$。

## 输出格式

对于 $op = 2$ 时，输出一个整数表示所有元素的异或和。
## 样例

### 样例输入 #1
```
5 5
1 1 1 1 1
2
1
2
0 1 3
2
```
### 样例输出 #1
```
1
2
3
```


---

---
title: "[威海市赛2024] 最大拟合"
layout: "post"
diff: 普及+/提高
pid: P11873
tag: ['Special Judge']
---
# [威海市赛2024] 最大拟合
## 题目描述

在某一个平行世界里，小威是 Z 校的 ML 大佬，精通于各种机器学习模型。某一天，他在路上观察到了一只活泼的小狗，小狗的叫声忽高忽低，时断时续。小威很快就意识到了，小狗是不是在按照某种模式发出声音？于是乎在那一刹那，他毫不犹豫地认为，小狗发声的模式也可以通过机器学习获得。但是很遗憾，他只记住了某一段连续的小狗的叫声。如果用 $H$ 代表小狗的清吠，$L$ 代表小狗的低吼，那么这段连续的叫声会被建模成一段 $H$ 和 $L$ 交织的序列……

此外，由于小威认为小狗是一种非常可爱专一但又健忘的动物，因此假定小狗的 attention 机制没有那么强，且在连续叫声中的第 $i$ 个声音只会与第 $i-1$ 和 $i-2$ 个声音有关。为了方便建模，小威认为小狗的每一段连续叫声都会由两声清吠开始。

那么，他的目标是什么呢？虽然他希望能构建出一个能模拟小狗叫声的模型，但是数据少得让他"巧妇难为无米之炊"啊。因此，他觉得，只要能在他记住的唯一的一段连续叫声上最大拟合就可以了。

在数学上，我们假定最后的模型为 $\theta$，可以被视为一个值域为概率的映射，即

$$
\theta: [L, H]^2 \times [L, H, \gamma] \to \mathbb P
$$

其中 $\gamma$ 表示序列的结束标志。例如 $\theta(L, H; L) = 0.6$，表示第 $i - 2$ 个声音是 $L$， 第 $i - 1$ 个声音是 $H$ 的情况下，第 $i$ 个声音是 $L$ 的概率是 $0.6$。

另外，小威把这段包含 $m$ 个声音的叫声序列称为 $s_{[1:m]}$，并把最大拟合目标定义为

$$
\max \prod_{i=3}^{m+1} \theta(s_{i-2}, s_{i-1}; s_{i})
$$

其中，$s_{m+1}$ 不是任何叫声，仅代表叫声序列的结束标志。

由于最终结果可能过小，因此小威只需要你告诉他最大拟合结果的自然对数就好。
## 输入格式

输入包含一行一个字符串 $S$，含义如上所述。长度不超过 $10^5$。

保证长度大于等于 2 且前两位必定为 $H$。
## 输出格式

输出一行一个实数，代表最大拟合的结果的自然对数。

相对误差或绝对误差不超过 $10^{-4}$ 可视为结果正确。
## 样例

### 样例输入 #1
```
HHH

```
### 样例输出 #1
```
-1.38629

```
### 样例输入 #2
```
HHHLHHLLHL

```
### 样例输出 #2
```
-6.59167

```


---

---
title: "[威海市赛2024] 收徒！"
layout: "post"
diff: 普及+/提高
pid: P11876
tag: ['Special Judge']
---
# [威海市赛2024] 收徒！
## 题目描述

小威和小海正在玩《铁斧斧之争》。

小威给小海狠狠上了一课，在这局游戏中获得了第一名。小威很兴奋，大喊："收徒！"小海很不服，给他提了一个问题，并且要求他解决，不然就再也不和他玩了。小威立马同意了。

问题是这样的：在《铁斧斧之争》中，有一个 $H$ 行 $W$ 列的棋盘，令 $(i, j)$ 表示从上往下数第 $i$ 行，从左往右数第 $j$ 列的单元格。在这个棋盘中分布着 $N$ 个棋子，当小威经过 $(R_i, C_i)$ 格时可以获得第 $i$ 个棋子，获得 $1$ 的战斗力。小海想知道，如果小威从 $(1, 1)$ 开始，反复向下或向右移动一个格子，最终到达 $(H, W)$ 时，能最多获得多少战斗力？

小威立马秒了，但小海捂住了他的嘴，继续说：除此之外，我还想知道你是如何获得最多战斗力的，你还要告诉我获得最多战斗力的这条路径。

小威："……"

你能帮帮他吗？
## 输入格式

第一行三个整数 $H, W, N$，含义如上所述；

接下来 $N$ 行，每行两个整数 $R_i, C_i$，含义如上所述。

对于所有数据，满足：

- $2 \leq H, W \leq 2 \times 10^5$；
- $1 \leq N \leq \min(HW - 2, 2 \times 10^5)$；
- $1 \leq R_i \leq H$；
- $1 \leq C_i \leq W$；
- $(R_i, C_i) \neq (1, 1)$；
- $(R_i, C_i) \neq (H, W)$；
- $(R_i, C_i)$ **互不相同**。

## 输出格式

输出两行。

第一行一个整数，表示你能获得的最大战斗力；

第二行一个长度为 $H+W-2$ 的字符串，如果第 $i$ 次移动是向下的，则字符串的第 $i$ 个字符为 `D`；如果第 $i$ 次移动是向右的，则字符串的第 $i$ 个字符为 `R`。

如果有多条路径可以最大化获得的战斗力，则输出任意一条路径即可。

## 样例

### 样例输入 #1
```
3 4 4
1 4
2 1
2 3
3 3
```
### 样例输出 #1
```
3
DRRDR
```
## 提示

对于第一组样例，一种可行的方案如下图所示：

![](https://cdn.luogu.com.cn/upload/image_hosting/80h1dm5w.png)

移动路径为 $(1, 1) \to (2, 1) \to (2, 2) \to (2, 3) \to (3, 3) \to (3, 4)$，可以在 $(2, 1), (2, 3), (3, 3)$ 处得到三个棋子。


---

---
title: "[威海市赛2024] 城堡中的皇后"
layout: "post"
diff: 普及+/提高
pid: P11878
tag: []
---
# [威海市赛2024] 城堡中的皇后
## 题目描述

2024 年 9 月 11-22 日，第 45 届国际象棋奥林匹克团体赛在匈牙利首都布达佩斯举行。小威，作为一个国际象棋爱好者，正在密切关注着这场比赛。

![](https://cdn.luogu.com.cn/upload/image_hosting/pe4k7psf.png)

 _图注：在第五轮比赛中，中国选手韦奕战胜西班牙选手，帮助中国队以 2.5:1.5 的比分战胜西班牙队_ 

现在，小威要向你介绍一些基础的国际象棋知识：

1. 国际象棋棋盘共有 8 行 8 列，**自左向右**以 $a \sim h$ 表示列，**自下而上**以 $1 \sim 8$ 表示行；
2. 每方各有一个国王、一个皇后、两个马、两个象、两个车以及八个兵。初始局面如下：
   ![](https://cdn.luogu.com.cn/upload/image_hosting/jx82759s.png)
3. 国王可以攻击到它同一行、同一列、同一斜线上**一格内**的位置，例如：
   ![](https://cdn.luogu.com.cn/upload/image_hosting/vr3q36zs.png)
   
   *图注：国王的攻击范围，箭头表示它能攻击到的位置*
4. 皇后可以攻击到它同一行、同一列、同一斜线上**任意格内**的位置，例如：
   ![](https://cdn.luogu.com.cn/upload/image_hosting/0rotqghv.png)
   ![](https://cdn.luogu.com.cn/upload/image_hosting/2iwr4258.png)
5. 马可以攻击到形似"L"型的位置，且没有"蹩马脚"限制，例如：
   ![](https://cdn.luogu.com.cn/upload/image_hosting/j13m76k7.png)
6. 象可以攻击到同一斜线上任意格内的位置，例如：
   ![](https://cdn.luogu.com.cn/upload/image_hosting/8rldzs2a.png)
7. 车可以攻击到同一行、同一列上任意格内的位置，例如：
   ![](https://cdn.luogu.com.cn/upload/image_hosting/vga2ifsj.png)
8. 兵可以攻击到前进方向上斜向一格内的位置，例如：
   ![](https://cdn.luogu.com.cn/upload/image_hosting/xo2fdlh3.png)
9. 当王处于对方某个棋子的攻击范围内时，称作被将军（check），例如：
   ![](https://cdn.luogu.com.cn/upload/image_hosting/m3qj07yf.png)
   
   *图注：此时黑方的王处于白方皇后的攻击范围内，黑方被将军*

我们使用 FEN 格式描述一个局面。FEN 格式是一个字符串，其中包含 7 个斜杠（/），将字符串分为 8 个部分 $s_{1..8}$。其中，$s_1$ 对应第 $8$ 行的内容，$s_2$ 对应第 $7$ 行的内容，以此类推。对于 $v = s_i$，$v_1$ 表示第 $a$ 列的内容，$v_2$ 表示第 $b$ 列的内容，以此类推。

请注意，$v$ 的长度不一定等于 8。

我们用 `R` 表示白方的车，`N` 表示白方的马，`B` 表示白方的象，`Q` 表示白方的皇后，`K` 表示白方的王，`P` 表示白方的兵，字符的小写格式对应黑方的棋子。

在字符串中还会出现 $1 \leq i \leq 8$ 的数字，表示出现了连续 $i$ 个没有棋子的空格。

例如，现在有一个局面：
   ![](https://cdn.luogu.com.cn/upload/image_hosting/psnnis20.png)

其对应的 FEN 为 `r1bq1rk1/pppp1ppp/2n2n2/2b1p3/2B1P3/1P3N2/PBPP1PPP/RN1Q1RK1`。

现在，小威给你了一个使用 FEN 描述的局面，请你告诉他，是否有一方处于被将军的状态。

## 输入格式

第一行输入一个正整数 $t$，表示局面个数。

接下来 $t$ 行，每行输入一个符合 FEN 格式的字符串 $s$，表示一个合法的局面。

对于所有数据，满足：$1 \leq t \leq 10$，且局面中不存在双方同时被将军的情况。
## 输出格式

共 $t$ 行。

第 $i$ 行输出第 $i$ 个局面的情况：如果白方被将军，输出 `check`；如果黑方被将军，输出 `CHECK`；如果不存在一方被将军，输出 `none`。
## 样例

### 样例输入 #1
```
9
1nb1n1r1/1r1kp2p/1PpP2p1/6b1/P4NPP/N2R4/R1PPQP2/q1B1KB2
4k1nr/r2pbqpp/2n2B2/pb1p4/p4P2/8/2PPPNPP/R2QKB1R
2b3nr/rp1pb1Qp/4pk2/2p5/P2qPP1P/3B4/RPnP2R1/1NB2KN1
rn3k1r/1pRb1p1p/3b2p1/pB1pp2q/3PP3/P1P1nP2/1PK1Q3/RNB3N1
r1b1kb2/1pppn1p1/p4p1r/4P3/8/1n1P2R1/P1PKP3/RNBQ1B2
r1b3r1/p3bp1p/1p2p1pn/2p1kP2/1PPn3P/P2PpKP1/R3P1B1/1Nq3NR
3qkb1r/p1p1pn1Q/1rn1b3/3PP1p1/1p4p1/NP3P2/P2P2BP/R1B1K1NR
rnb1k1r1/p1qpbp2/2p2pp1/1p2P2Q/1P3PP1/P2P1N1K/2P5/1RB2B1R
r4bnk/ppp1pb2/5QPr/3pP3/q1Pn4/P2p4/1P1P1P1P/1RB1K1NR

```
### 样例输出 #1
```
none
none
CHECK
check
check
check
none
none
CHECK

```
### 样例输入 #2
```
3
r1bqkb2/pp1nnp1r/3Np2p/2p5/1P1P3p/P4P2/2PBP1P1/R2QKBNR
2r4r/2N1nk1n/pp2b2p/2pq1pP1/1PPpP1P1/7P/P2PK3/R1B2BNR
2b1k2r/3r2pp/3b4/1P6/p1B1p3/P3nN1q/1n1P1PR1/1RB2K2

```
### 样例输出 #2
```
CHECK
none
check

```
### 样例输入 #3
```
3
3k4/8/5P2/p3N3/P3N2p/3K4/8/7r
3k4/8/5P2/p3N3/P3N2p/3K4/8/3r4
r1bqkb1r/pppp1Qpp/2n2n2/4p3/2B1P3/8/PPPP1PPP/RNB1K1NR

```
### 样例输出 #3
```
none
check
CHECK

```
## 提示

对于第三组样例，三个局面分别如下所示：
![](https://cdn.luogu.com.cn/upload/image_hosting/c8gdly9e.png)
![](https://cdn.luogu.com.cn/upload/image_hosting/y656nxud.png)
![](https://cdn.luogu.com.cn/upload/image_hosting/uq352kqv.png)


---

---
title: "[PA 2025] 集合 2 / Zbiory 2"
layout: "post"
diff: 普及+/提高
pid: P11912
tag: ['2025', 'Special Judge', 'PA（波兰）']
---
# [PA 2025] 集合 2 / Zbiory 2
## 题目背景

PA 2025 trial round t2.

**请注意本题非同寻常的时空限制。**
## 题目描述

> **问题。**
>
> 给定正整数 $n$ 和非负整数 $m$。定义全集 $U=\{1,2,\ldots,n\}$。
> 
> 构造 $(n+m)$ 个集合 $A_1,A_2,\ldots,A_{n+m}$：
> 
> 1. 对于 $1\le i\le n$，$A_i$ 里的元素为 $U$ 中 $i$ 的倍数。
> 2. 对于 $n+1\le i\le m$，给定参数 $op_i$：
> 
>	- 当 $op_i=1$ 时，给定参数 $x,y$（$x,y\lt n+i$），则 $A_{i} =A_x\cup A_y$；
>    - 当 $op_i=2$ 时，给定参数 $x,y$（$x,y\lt n+i$），则 $A_{i}=A_x\cap A_y$；
>    - 当 $op_i=3$ 时，给定参数 $x$（$x\lt n+i$），则 $A_{i}=U\backslash A_x$（即 $A_i=\{j:j\in U,j\not\in A_x\}$）。
>
> 定义问题的答案为 $A_{n+m}$。

给定正整数 $n$ 和目标集合 $B\subseteq \{1,2,\ldots,n\}$。构造非负整数 $m$ 和一组对应的参数，使得上述问题的答案为 $B$。

你需要保证 $0\le m\le 10^5$。可以证明本题一定有解。

## 输入格式

第一行，两个正整数 $n,k$，其中 $|B|=k$。

第二行，$k$ 个正整数 $B_1,B_2,\ldots,B_k$，描述 $B$ 中的元素。
## 输出格式

输出 $(m+1)$ 行：

第一行，一个非负整数 $m$。

接下来 $m$ 行，第 $i$ 行两个或三个正整数（格式见上），描述集合 $A_{n+i}$ 的生成方式。

你需要保证 $0\le m\le 10^5$，且格式符合【题目描述】中的限制。

## 样例

### 样例输入 #1
```
7 4
1 2 4 6
```
### 样例输出 #1
```
8
1 5 7
2 2 3
3 8
2 10 8
3 3
1 12 12
2 10 13
1 9 14
```
### 样例输入 #2
```
3 1
3
```
### 样例输出 #2
```
0
```
## 提示

- $1\le n\le 5\times 10^4$;
- $B\subseteq \{1,2,\ldots,n\}$。


---

---
title: "[PA 2025] 点兵点将 / Wyliczanka"
layout: "post"
diff: 普及+/提高
pid: P11917
tag: ['2025', 'PA（波兰）']
---
# [PA 2025] 点兵点将 / Wyliczanka
## 题目背景

PA 2025 R2B.


## 题目描述


有 $n$ 个玩具，编号 $1\sim n$，现在要点兵点将。流程如下：

1. 选择一个 $1\le i\le n$，然后指着玩具 $i$
。
2. 选择是否终止点兵点将；
3. 如果不终止，设当前指着的玩具是 $j$。
	- 若 $j=1$，转而指着 $j+1$，然后回到 2；
    - 若 $j=n$，转而指着 $j-1$，然后回到 2；
    - 否则，选择转而指着 $j+1$ 或 $j-1$，然后回到 2。

将每个玩具被指着的次数（包括步骤 1 的一次）记录下来，可以得到一个序列。我们说这个游戏**生成**了这个序列。

给定一个长度为 $n$ 的非负整数序列 $a_1,a_2,\ldots,a_n$。判断是否存在一个合法的游戏生成序列 $a$。

## 输入格式


**本题单个测试点内有多组测试数据。**

第一行，正整数 $T$，表示测试数据组数。

接下来依次描述 $T$ 组数据：

每组数据第一行，正整数 $n$。

每组数据第二行，$n$ 个非负整数 $a_1,a_2,\ldots,a_n$。

保证每组数据存在一个非零的 $a_i$。

## 输出格式

每组数据输出一行：

- 若存在一个游戏生成序列，输出 $\texttt{TAK}$；
- 否则输出 $\texttt{NIE}$。

## 样例

### 样例输入 #1
```
7
3
1 3 1
2
5 7
3
0 1 0
1
2
6
3 3 2 1 0 0
5
1 3 2 2 3
3
1 0 1
```
### 样例输出 #1
```
TAK
NIE
TAK
NIE
TAK
NIE
NIE
```
## 提示


### 样例解释

- 样例 $1$ 解释：依次指着 $2,1,2,3,2$ 即可。
- 样例 $3$ 解释：指着 $1$ 后终止游戏即可。
- 样例 $5$ 解释：依次指着 $1,2,3,4,3,2,1,2,1$ 即可。

### 数据范围

- $1\le T\le 10^5$；
- $1\le n,\sum n\le 10^6$；
- $ 0 \leq a_i \leq 10^9 $；
- 每组数据中，至少有一个非零的 $a_i$。



---

---
title: "[PA 2025] 水族馆 / Akwarium"
layout: "post"
diff: 普及+/提高
pid: P11919
tag: ['2025', 'PA（波兰）']
---
# [PA 2025] 水族馆 / Akwarium
## 题目背景

PA 2025 R3C.

## 题目描述


一个底面尺寸为 $a\times b$，高为 $h$ 的长方体水箱的对角线长度为 $\sqrt{a^2+b^2+h^2}$。这里，$a,b,h$ 均为正整数。

求出有多少个本质不同的水箱满足以下条件：

- $\sqrt{a^2+b^2+h^2}\in \mathbb{Z}$；
- $\sqrt{a^2+b^2+h^2}\le n$。

定义两个水箱 $a_1,b_1,h_1$，$a_2,b_2,h_2$ **本质不同**，当且仅当 $\{a_1,b_1\}\neq \{a_2,b_2\}$ 或者 $h_1\neq h_2$。


## 输入格式

一行一个正整数 $n$。


## 输出格式

一行一个非负整数，表示答案。
## 样例

### 样例输入 #1
```
7
```
### 样例输出 #1
```
7
```
## 提示

### 样例解释

满足条件的水族箱如下：

- 底面形状 $1 \times 2$，高为 $2$，对角线长为 $3$。
- 底面形状 $2 \times 2$，高为 $1$，对角线长为 $3$。
- 底面形状 $2 \times 4$，高为 $4$，对角线长为 $6$。
- 底面形状 $4 \times 4$，高为 $2$，对角线长为 $6$。
- 底面形状 $2 \times 3$，高为 $6$，对角线长为 $7$。
- 底面形状 $2 \times 6$，高为 $3$，对角线长为 $7$。
- 底面形状 $3 \times 6$，高为 $2$，对角线长为 $7$。

### 数据范围

- $1 \leq n \leq 5000$。


---

---
title: "[PA 2025] 显像管 / Migawka"
layout: "post"
diff: 普及+/提高
pid: P11925
tag: ['2025', '提交答案', 'Special Judge', 'PA（波兰）']
---
# [PA 2025] 显像管 / Migawka
## 题目背景

PA 2025 R5C.

可以用 PHP 语言提交答案，也可以提交答案生成器。
## 题目描述

**这是一道提交答案题。**

有一台老旧的黑白电视机，屏幕尺寸为 $100 \times 100$ 像素。每个像素可以是亮着的，也可以是熄灭的。然而，这台电视机有缺陷的，显示的图像一般不会保持太久。

称一个 $2 \times 2$ 的像素块是**错误的**，当且仅当其**只有**（主/副）对角线上的像素是亮的。电视机每秒将**在至少一个**错误块中的像素状态反转（亮变为灭，灭变为亮）。

![](https://cdn.luogu.com.cn/upload/image_hosting/1usrl3xs.png?x-oss-process=image/resize,m_lfit,h_200)

例如，考虑一个 $4 \times 4$ 的电视机屏幕，初始时各像素状态为下图左 $1$ 所示。下图展示了电视机在未来几秒钟的屏幕状态变化。

![](https://cdn.luogu.com.cn/upload/image_hosting/wcgmxgup.png?x-oss-process=image/resize,m_lfit,h_200)

从图中可以看出，第 $3$ 秒的屏幕画面与第 $1$ 秒相同，所以有 $3$ 种不同的画面。

构造初始的像素状态，最大化它能生成的不同画面的数量。（在刚才的例子中，生成了 $3$ 种不同画面）。

## 输入格式

没有输入。
## 输出格式

输出 $100$ 行，第 $i$ 行一个长度为 $100$ 的 $\texttt{01}$ 串 $s_{i,j}$，表示电视机的初始画面（$\texttt{1}$ 代表像素点亮，$\texttt{0}$ 代表像素熄灭）。
## 提示


### 计分方式

设初始画面生成了 $x$ 种不同的画面。

令 $i$ 为最小的非负整数，满足 $(10\cdot i-1)^2\ge x$，则得分为 $\min(100,10\cdot i)$。

### 提示


**光敏性癫痫警告：开发者已尽力确保可视化对癫痫患者是安全的，但请小心使用。**

我们在附件中提供了可视化工具 $\boldsymbol{visualise.py}$。

这是一个 Python 脚本，依赖于 `matplotlib` 和 `numpy` 库（请自行搜索如何安装，可能需要更换镜像源）。

使用以下命令启动可视化工具：

- Linux / MacOS：

	```bash
	python3 visualise.py < mig.txt
	```
- Windows cmd：
	```bash
	py visualise.py < mig.txt
    ```

压缩包还包含了一个示例文件 $\boldsymbol{mig.txt}$。

你可以根据需要自行修改可视化工具。  




---

---
title: "[CrCPC 2024] 搬东西"
layout: "post"
diff: 普及+/提高
pid: P11940
tag: ['2024', 'XCPC']
---
# [CrCPC 2024] 搬东西
## 题目背景

译自 [Natjecanje timova studenata informatičara hrvatskih sveučilišta](https://hsin.hr/studenti2024/) J.
## 题目描述

街道上有 $l$ 家商店，自西向东编号为 $1,2,\ldots,l$。相邻两家商店的距离为 $1$ 米。

有 $n$ 个任务，第 $i$ 个任务要求从商店 $s_i$ 搬东西到商店 $t_i$。

假设一次可以搬无限重的东西，可以**从任意商店出发**，整个任务结束后可以**停在任意商店**，求出路程和的最小值。

## 输入格式

第一行，两个正整数 $l,n$。

接下来 $n$ 行，第 $i$ 行的正整数为 $s_i,t_i$。
## 输出格式

输出一行一个正整数，表示答案。
## 样例

### 样例输入 #1
```
10 6
1 4
3 5
6 7
2 1
9 4
8 5
```
### 样例输出 #1
```
14
```
### 样例输入 #2
```
100 3
11 50
50 49
36 35
```
### 样例输出 #2
```
42
```
## 提示

#### 样例解释

样例 $1$ 解释：

从 $2$ 出发，

- 在 $2\to 1$ 的时候完成第 $4$ 个任务；
- 在 $1\to 9$ 的时候完成第 $1,2,3$ 个任务；
- 在 $9\to 4$ 的时候完成第 $5,6$ 个任务。

总路程为 $|2-1|+|1-9|+|9-4|=14$，可以证明这是最优的方案。

#### 数据范围

- $1\le l\le 10^9$；
- $1\le n\le 10^5$；
- $1\le s_i,t_i\le l$，$s_i\neq t_i$。


---

---
title: "[USACO25OPEN] It's Mooin' Time III B"
layout: "post"
diff: 普及+/提高
pid: P12024
tag: ['USACO', '2025']
---
# [USACO25OPEN] It's Mooin' Time III B
## 题目描述

Elsie 正在试图向 Bessie 描述她最喜欢的 USACO 竞赛，但 Bessie 很难理解为什么 Elsie 这么喜欢它。Elsie 说「现在是哞哞时间！谁想哞哞？请，我只想参加 USACO」。

Bessie 仍然不理解，于是她将 Elsie 的描述转文字得到了一个长为 $N$（$3 \leq N \leq 10^5$）的字符串，包含小写字母字符 $s_1s_2 \ldots s_N$。Elsie 认为一个包含三个字符的字符串 $t$ 是一个哞叫，如果 $t_2 = t_3$ 且 $t_2 \neq t_1$。

一个三元组 $(i, j, k)$ 是合法的，如果 $i < j < k$ 且字符串 $s_i s_j s_k$ 组成一个哞叫。对于该三元组，FJ 执行以下操作计算其值：

- FJ 将字符串 $s$ 在索引 $j$ 处弯曲 90 度
- 该三元组的值是 $\Delta ijk$ 的面积的两倍。

换句话说，该三元组的值等于 $(j-i)(k-j)$。

Bessie 向你进行 $Q$（$1 \leq Q \leq 3 \cdot 10^4$）个查询。在每个查询中，她给你两个整数 $l$ 和 $r$（$1 \leq l \leq r \leq N$，$r-l+1 \ge 3$），并询问满足 $l \leq i$ 和 $k \leq r$ 的所有合法三元组 $(i, j, k)$ 的最大值。如果不存在合法的三元组，输出 $-1$。

注意这个问题涉及到的整数可能需要使用 64 位整数类型（例如，C/C++ 中的 `long long`）。
## 输入格式

输入的第一行包含两个整数 $N$ 和 $Q$。
以下一行包含 $s_1 s_2, \ldots s_N$。

以下 $Q$ 行每行包含两个整数 $l$ 和 $r$，表示每个查询。
## 输出格式

对于每一个查询输出一行，包含对于该查询的答案。
## 样例

### 样例输入 #1
```
12 5
abcabbacabac
1 12
2 7
4 8
2 5
3 10
```
### 样例输出 #1
```
28
6
1
-1
12
```
## 提示

样例解释：对于第一个查询，$(i,j,k)$ 必须满足 $1 \le i < j < k \le 12$。可以证明，对于某个合法的 $(i,j,k)$，$\Delta ijk$ 的最大面积在 $i=1$，$j=8$ 以及 $k=12$ 时取到。注意 $s_1 s_8 s_{12}$ 是字符串 "acc"，根据前述定义是一个哞叫。$\Delta ijk$ 的直角边长为 $7$ 和 $4$，从而它的面积的两倍将等于 $28$。
对于第三个查询，$(i,j,k)$ 必须满足 $4 \le i < j < k \le 8$。可以证明，对于某个合法的 $(i,j,k)$，$\Delta ijk$ 的最大面积在 $i=4$，$j=5$ 以及 $k=6$ 时取到。

对于第四个查询，不存在满足 $2 \le i < j < k \le 5$ 的 $(i,j,k)$ 使得 $s_i s_j s_k$ 是一个哞叫，所以该查询的输出为 $-1$。

- 测试点 $2\sim3$：$N,Q\le 50$。
- 测试点 $4\sim6$：$Q=1$，唯一的询问满足 $l=1$ 且 $r=N$。
- 测试点 $7\sim 11$：没有额外限制。


---

---
title: "[USACO25OPEN] Ski Slope S"
layout: "post"
diff: 普及+/提高
pid: P12027
tag: ['USACO', '2025']
---
# [USACO25OPEN] Ski Slope S
## 题目描述

贝茜要和朋友们一起去滑雪。雪山上有 $N$ 个路标（$1 \leq N \leq 10^5$），按海拔从低到高依次标记为 $1, 2, \ldots, N$（路标 $1$ 位于山脚）。

对于每个路标 $i > 1$，有一条从路标 $i$ 出发，终点为路标 $p_i$（$1 \leq p_i < i$）的滑雪道。这条滑道的难度为 $d_i$（$0 \leq d_i \leq 10^9$），乐趣值为 $e_i$（$0 \leq e_i \leq 10^9$）。

贝茜的 $M$ 个朋友（$1 \leq M \leq 10^5$）每人会进行如下操作：选择一个起始路标 $i$，然后沿着滑道向下滑行（依次经过 $p_i,p_{p_i}$，依此类推），直到抵达路标 $1$。

每位朋友获得的乐趣值等于他们经过的所有滑道的乐趣值之和。每个朋友有不同的技能水平 $s_j$（$0 \leq s_j \leq 10^9$）和勇气值 $c_j$（$0 \leq c_j \leq 10$），这限制他们选择的起始路标必须满足：滑行过程中最多有 $c_j$ 条滑道的难度超过 $s_j$。

请为每位朋友计算他们能获得的最大乐趣值。

## 输入格式

第一行包含 $N$。

接下来 $2$ 到 $N$ 行，每行包含三个整数 $p_i$，$d_i$ 和 $e_i$。

随后一行包含 $M$。

接下来 $M$ 行，每行包含两个整数 $s_j$ 和 $c_j$。

## 输出格式

输出 $M$ 行，每行对应一个朋友的答案。

注意：由于涉及大整数运算，可能需要使用 64 位整数类型（如 C/C++ 中的 `long long`）。

## 样例

### 样例输入 #1
```
4
1 20 200
2 30 300
2 10 100
8
19 0
19 1
19 2
20 0
20 1
20 2
29 0
30 0
```
### 样例输出 #1
```
0
300
500
300
500
500
300
500
```
## 提示

第一位朋友只能选择路标 $1$ 作为起点，因为其他路标都会导致至少经过一条难度超过 $19$ 的滑道。总乐趣值为 $0$。

第二位朋友可以选择路标 $4$，依次滑行至路标 $2$ 和 $1$。总乐趣值为 $100 + 200 = 300$，其中有一条滑道难度超过 $19$。

第三位朋友可以选择路标 $3$，依次滑行至路标 $2$ 和 $1$。总乐趣值为 $300 + 200 = 500$，其中有两条滑道难度超过 $19$。

- 测试点 $2\sim4$：$N, M \leq 1000$。
- 测试点 $5\sim7$：所有 $c_j = 0$。
- 测试点 $8\sim17$：无额外限制。


---

---
title: "[USACO25OPEN] Moo Decomposition G"
layout: "post"
diff: 普及+/提高
pid: P12028
tag: ['USACO', '2025']
---
# [USACO25OPEN] Moo Decomposition G
## 题目描述

给定一个由 $\texttt{M}$ 和 $\texttt{O}$ 组成的长字符串 $S$ 和一个整数 $K \geq 1$。计算将 $S$ 分解为若干子序列的方式数，其中每个子序列形如 $\texttt{MOOO...O}$（恰好包含 $K$ 个 $\texttt{O}$），结果对 $10^9+7$ 取模。

由于字符串非常长，我们不直接给出 $S$。而是给定一个整数 $L$（$1 \leq L \leq 10^{18}$）和一个长度为 $N$ 的字符串 $T$（$1 \leq N \leq 10^6$）。字符串 $S$ 是 $T$ 重复 $L$ 次拼接而成。

## 输入格式

第一行包含 $K$、$N$ 和 $L$。

第二行包含长度为 $N$ 的字符串 $T$，每个字符是 $\texttt{M}$ 或 $\texttt{O}$。

保证 $S$ 的分解方式数不为零。
## 输出格式

输出字符串 $S$ 的分解方式数，对 $10^9+7$ 取模。
## 样例

### 样例输入 #1
```
2 6 1
MOOMOO
```
### 样例输出 #1
```
1
```
### 样例输入 #2
```
2 6 1
MMOOOO
```
### 样例输出 #2
```
6
```
### 样例输入 #3
```
1 4 2
MMOO
```
### 样例输出 #3
```
4
```
### 样例输入 #4
```
1 4 100
MMOO
```
### 样例输出 #4
```
976371285
```
## 提示

样例一解释：唯一分解方式是将前三个字符组成一个 $\texttt{MOO}$，后三个字符组成另一个 $\texttt{MOO}$。

样例二解释：共有六种不同的分解方式（大写字母组成一个 $\texttt{MOO}$，小写字母组成另一个 $\texttt{MOO}$）：
1. $\texttt{MmOOoo}$
2. $\texttt{MmOoOo}$
3. $\texttt{MmOooO}$
4. $\texttt{MmoOOo}$
5. $\texttt{MmoOoO}$
6. $\texttt{MmooOO}$

样例四解释：注意：结果需对 $10^9+7$ 取模。

- 测试点 $5\sim7$：$K=1$，$L=1$。
- 测试点 $8\sim10$：$K=2$，$N \leq 1000$，$L=1$。
- 测试点 $11\sim13$：$K=1$。
- 测试点 $14\sim19$：$L=1$。
- 测试点 $20\sim25$：无额外限制。


---

---
title: "[OOI 2025] Cute Subsequences"
layout: "post"
diff: 普及+/提高
pid: P12076
tag: ['2025']
---
# [OOI 2025] Cute Subsequences
## 题目描述

You are given an array of $n$ positive integers $a_1$, $a_2$, $\ldots$, $a_n$, as well as a positive integer $k$. You need to divide the array into $k$ non-empty subsequences such that each element of the array belongs to exactly one subsequence. A subsequence is a sequence that can be obtained from another sequence by deleting some elements without changing the order of the remaining elements.

Let the $i$-th subsequence contain elements with indices $j_1 < \ldots < j_l$. The $\textit{value}$ of this subsequence is defined as the maximum value of $a_{j_m} + m$ for all $m$ from $1$ to $l$.

The $\textit{cost}$ of dividing the array into $k$ subsequences is the sum of the $\textit{values}$ of these subsequences.

Find the maximum $\textit{cost}$ of the division.
## 输入格式

The first line contains two positive integers $n$ and $k$ ($1 \leq k \leq n \leq 500\,000$) --- the size of the array and the number of subsequences to divide it into.

The second line contains $n$ positive integers $a_1$, $a_2$, $\ldots$, $a_n$ ($1 \leq a_i \leq 10^9$) --- the elements of the array.
## 输出格式

Output the maximum $\textit{cost}$ of dividing the given array into $k$ non-empty subsequences.
## 样例

### 样例输入 #1
```
5 3
3 7 10 1 2
```
### 样例输出 #1
```
24
```
## 提示

**Note**

In the sample test, the array can be divided into $[3, 10]$, $[7]$, $[1, 2]$. Then the answer will be $(10 + 2) + (7 + 1) + (2 + 2) = 12 + 8 + 4 = 24$.

**Scoring**

The tests for this problem consist of six groups. Points for each group are given only if all tests of the group and all tests of the required groups are passed.

| Group | Points | Additional Constraints: $n$ | Additional Constraints: $k$ | Required Groups | Comment                        |
| :---- | :----- | :---------------------------- | :---------------------------- | :-------------- | :----------------------------- |
| 0     | 0      | --                            | --                            | --              | Examples.                      |
| 1     | 14     | $n \le 8$                   | --                            | 0               |                                |
| 2     | 19     | --                            | $k = 2$                     | --              |                                |
| 3     | 17     | --                            | --                            | --              | $a_{i+1} \leq a_i$           |
| 4     | 21     | --                            | --                            | --              | $a_{i+1} \geq a_i - 1$       |
| 5     | 15     | $n \leq 1000$               | --                            | 0, 1            |                                |
| 6     | 14     | --                            | --                            | 0 -- 5          |                                |


---

---
title: "[OOI 2025] Best Runner"
layout: "post"
diff: 普及+/提高
pid: P12078
tag: ['2025']
---
# [OOI 2025] Best Runner
## 样例

### 样例输入 #1
```
5 3 10
4 5 2 7 1
1 2 4
```
### 样例输出 #1
```
4
```
### 样例输入 #2
```
4 2 11
4 5 7 10
2 3
```
### 样例输出 #2
```
2
```


---

---
title: "【MX-X11-T3】「蓬莱人形 Round 1」科学"
layout: "post"
diff: 普及+/提高
pid: P12149
tag: ['O2优化', '梦熊比赛']
---
# 【MX-X11-T3】「蓬莱人形 Round 1」科学
## 题目背景

原题链接：<https://oier.team/problems/X11D>。

---

「少しの眠れぬ夜に」

「この魔法がほのかに灯るなら」

「今がそんなに悪くないって」

「笑える時まで今日もscience!」

## 题目描述

初始你有 $n$ 个 A 类盒子，第 $i$ 个盒子里有 $a_i$ 个颜色为 $i$ 的球，且每个 A 类盒子的大小无限制。还有 $m$ 个 B 类盒子，购买第 $i$ 个 B 类盒子的花费为 $w_i$，且有大小上限 $b_i$。

你可以进行任意次操作，每次选择一个盒子里的一个球，把它放到另一个盒子中，但你要保证**最终**：

- 每个盒子中的球颜色相同。

- 存在序列长度为 $n$ 的盒子序列 $p$（即**盒子 $p_i$ 可以表示任意一个 A 类或 B 类盒子**），满足对于所有 $i\in[1,n]$，颜色为 $i$ 的小球只会出现在第 $i$ 个 A 类盒子或**盒子 $p_i$**。

你要购买若干个 B 类盒子后（可以不购买）进行上述操作使得所有盒子中球的数量的**最大值最小**，并且**在此基础上**最小化购买 B 类盒子的总花费。

**若未特别标注，则「盒子」表示「A 类盒子」与「B 类盒子」的总称。**
## 输入格式

第一行，两个整数 $n,m$。

接下来一行，$n$ 个正整数 $a_1,a_2,\ldots,a_n$。

最后 $m$ 行，每行两个正整数 $b_i,w_i$。
## 输出格式

一行两个整数，分别表示所有盒子中球个数最大值的最小值和在此前提下的最小花费。
## 样例

### 样例输入 #1
```
5 3
5 2 1 3 2 
3 3
1 5
1 4

```
### 样例输出 #1
```
3 3
```
### 样例输入 #2
```
5 5
1 1 7 4 7 
5 2
5 7
1 6
1 5
2 10
```
### 样例输出 #2
```
4 7

```
### 样例输入 #3
```
5 3
1 2 5 4 4 
3 5
4 4
2 1

```
### 样例输出 #3
```
3 10
```
### 样例输入 #4
```
5 3
2 4 3 3 4 
1 1
4 4
5 2

```
### 样例输出 #4
```
3 3
```
## 提示

**【样例解释 #1】**

买第 $1$ 个 B 类盒子 $(3,3)$，并将第 $1$ 个 A 类盒子中的 $2$ 个颜色为 $1$ 的球放到这个 B 类盒子中即可，花费为 $3$。

**【样例解释 #2】**

买第 $1$ 个 B 类盒子 $(5,2)$ 和第 $4$ 个 B 类盒子 $(1,5)$，并将第 $1$ 个 A 类盒子中的 $1$ 个颜色为 $1$ 的球放到第 $4$ 个 B 类盒子，将第 $3$ 个 A 类盒子中的 $3$ 个颜色为 $3$ 的球放到第 $1$ 个 A 类盒子，将第 $5$ 个 A 类盒子中的 $3$ 个颜色为 $5$ 的球放到第 $1$ 个 B 类盒子，所有盒子球数最大值为 $4$，花费为 $7$。

**【数据范围】**

**本题使用子任务捆绑**。

对于所有测试数据，$1 \le n,m \le 2 \times 10^5$，$1\le a_i,b_i,w_i \le 10^9$。

|子任务编号|$n\le$|$m \le$|特殊性质|分值|
|:-:|:-:|:-:|:-:|:-:|
|$1$|$6$|$6$|无|$10$|
|$2$|$2 \times 10^5$|$1$|无|$15$|
|$3$|$2 \times 10^5$|$5$|无|$20$|
|$4$|$2 \times 10^5$|$2 \times 10^5$|保证所有 $a_i,b_i \le 2$|$15$|
|$5$|$2 \times 10^5$|$2 \times 10^5$|无|$40$|


---

---
title: "「YLLOI-R1-T3」一路向北"
layout: "post"
diff: 普及+/提高
pid: P12414
tag: ['洛谷原创', 'O2优化', '洛谷月赛', 'Ad-hoc']
---
# 「YLLOI-R1-T3」一路向北
## 题目背景

![一路向北](bilibili:BV1qg411H7qR)
## 题目描述

给定 $n$ 个队列，每个队列中有 $m$ 个正整数，这些数均小于等于 $n$，第 $i$ 个队列的第 $j$ 个元素为 $a_{i,j}$，$a_{i,1}$ 为队首，$a_{i,m}$ 为队尾。

现在你的手中拿着一个数字 $0$，你要选择一个队列将 $0$ 放到其队尾，并把其队首拿到手中。

接下来你将重复进行一个操作直到再次把 $0$ 拿回手中：

- 设你手中的数字为 $p$，将其放到第 $p$ 个队列的队尾，并把第 $p$ 个队列的队首拿到手中。

现在小 Y 想知道，在无限的时间中，你是否可以不再拿回 $0$？如果可以，则输出 `Yes`，否则输出 `No`。
## 输入格式

**本题有多组测试数据。**

第一行一个整数 $T$，表示数据组数。

对于每组数据：

第一行两个正整数 $n,m$。

接下来 $n$ 行，每行 $m$ 个正整数，第 $i$ 行第 $j$ 个数表示 $a_{i,j}$。
## 输出格式

对于每组数据，输出一行：

在无限的时间中，若你可以不再拿回 $0$，则输出 `Yes`，否则输出 `No`。
## 样例

### 样例输入 #1
```
1
3 2
2 2
3 3
1 1
```
### 样例输出 #1
```
No
```
### 样例输入 #2
```
1
3 2
2 1
3 3
2 2
```
### 样例输出 #2
```
Yes
```
## 提示

#### 【样例解释#1】

以下模拟一开始将 $0$ 放到第 $1$ 个队列的情况。

```
//手中数字：
0
//队列数字：（左边第一个为队首，右边第一个为队尾）
2 2
3 3
1 1
```

```
//手中数字：
2
//队列数字：
2 0
3 3
1 1
```

```
//手中数字：
3
//队列数字：
2 0
3 2
1 1
```

```
//手中数字：
1
//队列数字：
2 0
3 2
1 3
```

```
//手中数字：
2
//队列数字：
0 1
3 2
1 3
```

```
//手中数字：
3
//队列数字：
0 1
2 2
1 3
```

```
//手中数字：
1
//队列数字：
0 1
2 2
3 3
```

```
//手中数字：
0
//队列数字：
1 1
2 2
3 3
```
#### 【样例解释#2】

通过模拟可以发现当且仅当一开始把 $0$ 放到第 $1$ 个队列时，才可以不再拿回 $0$。因为在经过了若干轮后第 $2$ 个队列会被 $2$ 填满，并且手中的数字也是 $2$，所以将在第 $2$ 个队列一直循环。

#### 【数据范围】

**本题采用捆绑测试。**

- Subtask 1（20 pts）：$n\le2$。
- Subtask 2（10 pts）：$\forall a_{i,j}=i$。
- Subtask 3（20 pts）：$n\times m \le 1000$。
- Subtask 4（50 pts）：无特殊限制。

对于全部数据，保证 $1\le T\le 10$，$1\le n\times m\le 10^5$，$1\le a_{i,j}\le n$。


---

---
title: "【MX-X12-T4】「ALFR Round 5」游戏"
layout: "post"
diff: 普及+/提高
pid: P12421
tag: ['交互题', 'Special Judge', 'O2优化', '梦熊比赛']
---
# 【MX-X12-T4】「ALFR Round 5」游戏
## 题目背景

原题链接：<https://oier.team/problems/X12D>。
## 题目描述

**这是一道交互题。**

有一棵 $n$ 个点的树，树的形态给定，树上有一个隐藏点 $s$，你每次可以给出一个点 $u$，交互库选择将 $s$ 向 $u$ 移动一步（若 $s=u$ 则无事发生），或者返回目前 $u$ 到 $s$ 的距离。交互库会告诉你他选择的操作，如果选择的是操作 $2$ 会告诉你距离。你需要在 $m$ 次询问内求出**目前** $s$ 的位置。

每个测试点中有 $T$ 组测试数据。

交互库不自适应，这意味着询问开始前 $s$ 的位置确定，与你的询问无关。

**【交互方式】**

首先输入一个正整数 $T$ 表示测试数据组数。

接下来 $T$ 组数据，每组数据的第一行输入两个正整数 $n,m$ 分别表示树的点数和询问次数限制，接下来 $n-1$ 行每行两个数 $u,v$ 表示树上存在一条连接 $u,v$ 的边。

接着你需要进行交互，询问格式为 `? u`，其中需要满足 $1 \leq u \leq n$，如果你本组数据的询问次数超过 $m$，交互库输出 `-1`，此时你需要立即结束程序否则之后交互库行为未定义。若询问次数未超过限制，交互库输出 `1` 或者 `2 d`，分别表示交互库选择将 $s$ 向 $u$ 移动一步或者告诉你 $s$ 到 $u$ 目前的距离为 $d$。当你确定 $s$ 目前的位置后，输出 `! u` 表示 $s$ 目前在编号为 $u$ 的节点上。如果你的回答是正确的，交互库输出 `1` 并进入下一组测试数据，否则交互库输出 `0`，你需要立即结束程序否则之后交互库行为未定义。

**你需要在你的每次输出后刷新缓冲区。**

你可以使用如下语句来清空缓冲区：

- 对于 C/C++：`fflush(stdout)`；
- 对于 C++：`std::cout << std::flush`；
- 对于 Java：`System.out.flush()`；
- 对于 Python：`stdout.flush()`；
- 对于 Pascal：`flush(output)`；
- 对于其他语言，请自行查阅对应语言的帮助文档。

当你在单个测试点内总询问次数不超过 $\sum m$ 次时，保证交互库占用时间不超过 $1.5$ s，占用空间不超过 $50$ MiB，也就是说你的程序至少可以使用 $1.5$ s 的时间和 $462$ MiB 的空间。
## 输入格式

见【**交互方式**】。
## 输出格式

见【**交互方式**】。
## 样例

### 样例输入 #1
```
1
4 200
1 2
2 4
2 3
1
1
1

```
### 样例输出 #1
```
? 2
? 2
! 2

```
### 样例输入 #2
```
2
5 200
5 1
4 2
2 3
2 1
1
2 1
2 0
1
6 200
6 1
2 1
4 2
4 5
3 2
2 3
2 1
1
1
1
```
### 样例输出 #2
```
? 2
? 2
? 1
! 1
? 6
? 2
? 4
? 4
! 4
```
## 提示

**【样例解释 #1】**

对于样例 $1$，初始有 $s=3$，询问两次点 $2$，第一次交互库返回 $1$，并将 $s$ 向点 $2$ 移动一步，$s=2$，第二次询问交互库返回 $1$，$s=2$，所以 $s$ 不发生变化。此时可以确定 $s=2$，回答 $s=2$ 后，交互库返回 $1$ 表示答案正确。

**【数据范围】**

**本题使用捆绑测试。**

| 子任务编号 | $T \leq $ | $n \leq $ | $m = $ | 特殊性质 | 分值 | 子任务依赖 |
| :-: | :-: | :-: |:-: |:-: | :-: | :-: |
| $1$ | $500$ | $10$ | $200$ | 无 |$5$ | 无 |
| $2$ | $10$ | $1000$ | $3n$ | 无 | $13$ | $1$ |
| $3$ | $10^4$ | $10^5$ | $n-1$ | A | $7$ | 无
| $4$ | $10^4$ | $10^5$ | $n-1$ | B | $10$ | 无
| $5$ | $10^4$ | $10^5$ | $3n$ | C | $14$ | 无 |
| $6$ | $10^4$ | $10^5$ | $2n$ | 无 | $21$ | $1,2,5$ |
| $7$ | $10^4$ | $10^5$ | $n-1$  | 无 |$30$ | $1,2,3,4,5,6$ |

特殊性质 A：树上每个点度数不大于 $2$。

特殊性质 B：树上只有至多一个点度数大于 $1$。

特殊性质 C：树的生成方式为：对于每个 $2 \leq i \leq n$，等概率随机选取 $[1,i)$ 中的一个整数 $x$，将 $x$ 与 $i$ 连边。

对于所有数据，$1 \leq T \leq 10^4$，$1 \leq \sum n \leq 10^5$，$m\geq n-1$。


---

---
title: "【MX-X12-T5】「ALFR Round 5」Another string problem"
layout: "post"
diff: 普及+/提高
pid: P12422
tag: ['O2优化', '梦熊比赛']
---
# 【MX-X12-T5】「ALFR Round 5」Another string problem
## 题目背景

原题链接：<https://oier.team/problems/X12E>。

---

决（け）して逃（に）げない怖（こわ）くはないから

目（め）を开（あ）け弱（よわ）さをかき消（け）すんだ
## 题目描述

我们定义 $S\mid T$ 为：设 $k=\lfloor |T|/|S| \rfloor$，则 $k$ 个 $S$ 连起来在 $T$ 中以子序列出现过。例如 $S=\textsf{ab},T=\textsf{abcab}$，则 $S\mid T$，$T$ 中出现的 $S$ 有 $\underline{\textsf{ab}}\textsf c{\underline{\textsf{ab}}}$。

对于 $t$ 组测试数据，给定一个 $S$ 和正整数 $q$，$q$ 次询问：

- 给定 $T_i$，问是否 $T_i\mid S$。如果 $T_i\mid S$，输出 `Yes`，否则输出 `No`。
## 输入格式

本题有多组测试数据，第一行输入一个整数 $t$，表示数据组数。对于每组数据：

- 第一行，一个字符串 $S$ 和一个正整数 $q$。
- 接下来 $q$ 行，每行一个字符串 $T_i$。

保证 $S,T_i$ 均由小写英文字符（`a` 到 `z`）组成。
## 输出格式

输出 $q$ 行，第 $i$ 行为第 $i$ 组测试数据的答案（`Yes` 或 `No`）。
## 样例

### 样例输入 #1
```
2
abcaabc 2
abc
ab
abaabab 3
ab
aa
aba

```
### 样例输出 #1
```
Yes
No
Yes
No
Yes
```
## 提示

**【样例解释】**

第一组测试数据中，$T=\textsf{abc}$ 时可以在 $S$ 种寻找到 $\textsf{abcabc}$ 作为子序列，具体的，$S$ 种出现的 $T$ 有 $\underline{\textsf{abc}}\textsf a{\underline{\textsf{abc}}}$。而 $T=\textsf{ab}$ 时 $\textsf{ababab}$ 不是 $S$ 的子序列。

第二组测试数据中，第一、三个询问分别有 $\underline{\textsf{ab}}\textsf a{\underline{\textsf{abab}}}$、$\underline{\textsf{aba}} {\underline{\textsf{aba}}}\textsf b$。

**【数据范围】**

**本题使用捆绑测试。**

对于 $100\%$ 的数据，$1 \le t \le 2\times 10^5$，$\lvert S\rvert,q,\lvert T_i\rvert\ge 1$，$\sum \lvert S\rvert\le 2\times 10^5$，$\sum q\le 2\times 10^5$，$\sum \sum \lvert T_i\rvert\le 4\times 10^5$，并且 $|T_i|\le |S|$。$S,T_i$ 均由小写英文字符（`a` 到 `z`）组成。

| 子任务 | $\sum \lvert S\rvert\le$ | 特殊性质 | 分值 |
| :----------: | :----------: | :----------: | :----------: |
| $1$ | $2\times 10^5$ | $\lvert S\rvert\le 10$ | $3$ |
| $2$ | $3\times 10^3$ | 无 | $17$ |
| $3$ | $2\times 10^5$ | 数据随机$^†$ | $2$ | 
| $4$ | $2\times 10^5$ | $S$ 中不同字符最多 $1$ 种 | $8$ |
| $5$ | $2\times 10^5$ | $S$ 中不同字符最多 $2$ 种 | $15$ |
| $6$ | $10^5$ | 无 | $20$ |
| $7$ | $2\times 10^5$ | 无 | $35$ |

$†$：并非完全均匀随机字符，具体见【**子任务 3 数据随机方式**】。

**【子任务 3 数据随机方式】**

下面是造“数据随机”的部分分的代码（因为 `generator` 较长，这里是所有有关片段）：

```cpp
mt19937 rng((unsigned long long) new char);

int rnd_l(int l,int r){
	return rng()%(r-l+1)+l;
}

char rnd(vector<int> v){ // 0~25 权重 
	int sum=0;
	for (auto u : v) sum+=u;
	int r=rng()%(sum)+1,c=0;
	sum=0;
	for (auto u : v){
		if (sum+u>=r) return c+'a';
		c++;
		sum+=u;
	}
}

vector<int> pl;

void rnd_g(){
	string s=rnd_s(pl,n);
	cout<<s<<" "<<q<<endl;
	string t=rnd_s(pl,n);
	vector<int> ct=rnd_v(n,q);
	ct.push_back(n);
	for (int i=1,pr=0; i<=q; i++){
		cout<<t.substr(pr,ct[i-1]-pr)<<endl;
		pr=ct[i-1];
	}
}

vector<int> rnd_v(int fw,int ti){ // 不可重复的划分 
	vector<int> ct;
	ct.push_back(0);
	for (int i=1,cr=0; i<ti; i++){
		ct.push_back(rnd_l(cr+1,fw-(ti-i)));
		cr=ct.back();
	}
	return ct;
}

for (int i=0; i<26; i++) pl.push_back(rnd_l(5,15));
```

需要注意的是，`rnd` 函数并非均匀随机，是按照随机生成的权重 `pl` 随机 $a\sim z$ 的（即 $c$ 的概率为 $\frac{pl_c}{\sum pl_i}$）。`pl` 每一个数据点都会重新生成。

这个代码中，$n=|S|,q$ 是数据范围内给定的数。随机的方式如下：

- $q\in [1,n]$，均匀随机。

- 按照 `rnd` 函数随机生成一个 $S$ 字符串和 $T$ 字符串，长度均为 $n$。

- 按照 `rnd_v` 函数随机一个 $T$ 的分割，一共 $q-1$ 个分割点，分成 $q$ 段，分别为 $T_1\sim T_q$。


---

---
title: "[NOIP 1997 提高组] 棋盘问题"
layout: "post"
diff: 普及+/提高
pid: P1549
tag: ['1997', 'NOIP 提高组', 'Special Judge']
---
# [NOIP 1997 提高组] 棋盘问题
## 题目背景

NOIP1997 提高组第一题

[P5512](https://www.luogu.com.cn/problem/P5512) 为本题数据加强版。

本题实际的数据的范围是 $1\le N\le 5$。不保证存在可以通过原数据范围的非打表做法。
## 题目描述

在 $N \times N$（$1 \le N \le 10$）的棋盘上，填入 $1, 2, \dots, N ^ 2$ 共 $N ^ 2$ 个数，使得任意两个相邻的数之和为素数。

例如：当 $N = 2$ 时，有：

| $1$ | $2$ |
| :-----------: | :-----------: |
| $4$ | $3$ |

其相邻数的和为素数的有：

$1+2,1+4,4+3,2+3$

当 $N=4$ 时，一种可以填写的方案如下：

| $1$ | $2$ | $11$ | $12$ |
| :-----------: | :-----------: | :-----------: | :-----------: |
| $16$ | $15$ | $8$ | $5$ |
| $13$ | $4$ | $9$ | $14$ |
| $6$ | $7$ | $10$ | $3$ |

在这里我们约定：左上角的格子里必须填数字 $1$。
## 输入格式

一个数 $N$。
## 输出格式

如有多种解，则输出第一行、第一列之和为最小的排列方案；若无解，则输出 `NO`。
## 样例

### 样例输入 #1
```
1
```
### 样例输出 #1
```
NO

```
### 样例输入 #2
```
2
```
### 样例输出 #2
```
1 2
4 3
```


---

---
title: "[USACO04DEC] Tree Cutting S"
layout: "post"
diff: 普及+/提高
pid: P1670
tag: ['2004', 'USACO']
---
# [USACO04DEC] Tree Cutting S
## 题目描述

约翰意识到贝茜建设网络花费了他巨额的经费，就把她解雇了。贝茜很愤怒，打算狠狠报复。她打算破坏刚建成的约翰的网络。约翰的网络是树形的，连接着 $N$ 个牛棚。她打算切断某一个牛棚的电源，使和这个牛棚相连的所有电缆全部中断。之后，就会存在若干子网络。为保证破坏够大，每一个子网的牛棚数不得超过总牛棚数的一半，那哪些牛棚值得破坏呢？
## 输入格式

第 $1$ 行：一个整数 $N$。

第 $2$ 到 $N$ 行：每行输入两个整数，表示一条电缆的两个端点。
## 输出格式

按从小到大的顺序，输出所有值得破坏的牛棚。如果没有一个值得破坏，就输出 `NONE`。
## 样例

### 样例输入 #1
```
10
1 2
2 3
3 4
4 5
6 7
7 8
8 9
9 10
3 8
```
### 样例输出 #1
```
3
8

```
## 提示

$1\le N\le 10^4$。


---

---
title: "过河问题"
layout: "post"
diff: 普及+/提高
pid: P1809
tag: ['NOI 导刊']
---
# 过河问题
## 题目描述

有一个大晴天，Oliver 与同学们一共 $N$ 人出游，他们走到一条河的东岸边，想要过河到西岸。而东岸边有一条小船。 

船太小了，一次只能乘坐两人。每个人都有一个渡河时间 $T$，船划到对岸的时间等于船上渡河时间较长的人所用时间。 

现在已知 $N$ 个人的渡河时间 $T$，Oliver 想要你告诉他，他们最少要花费多少时间，才能使所有人都过河。 

注意，只有船在东岸（西岸）的人才能坐上船划到对岸。
## 输入格式

输入文件第一行为人数 $N$，以下有 $N$ 行，每行一个数。 

第 $i+1$ 行的数为第 $i$ 个人的渡河时间。
## 输出格式

输出文件仅包含一个数，表示所有人都渡过河的最少渡河时间。
## 样例

### 样例输入 #1
```
4
6
7
10
15

```
### 样例输出 #1
```
42

```
## 提示

### 数据范围

对于 $40\%$ 的数据满足 $N\le8$。 

对于 $100\%$ 的数据满足 $N\le100000$。


### 样例解释

- 初始：东岸 $\{1,2,3,4\}$，西岸 $\{\}$；
- 第一次：东岸 $\{3,4\}$，西岸 $\{1,2\}$，时间 $7$；
- 第二次：东岸 $\{1,3,4\}$，西岸 $\{2\}$，时间 $6$；
- 第三次：东岸 $\{1\}$，西岸 $\{2,3,4\}$，时间 $15$；
- 第四次：东岸 $\{1,2\}$，西岸 $\{3,4\}$ 时间 $7$；
- 第五次：东岸 $\{\}$，西岸 $\{1,2,3,4\}$ 时间 $7$。

所以总时间为 $7+6+15+7+7=42$，没有比这个更优的方案。


---

---
title: "数页码"
layout: "post"
diff: 普及+/提高
pid: P1836
tag: ['NOI 导刊']
---
# 数页码
## 题目描述

一本书的页码是从 $1\sim n$ 编号的连续整数：$1,2,3,\cdots,n$。请你求出全部页码中所有单个数字的和，例如第 $123$ 页，它的和就是 $ 1+2+3=6$。

## 输入格式

一行一个整数 $n$。

## 输出格式

一行，代表所有单个数字的和。

## 样例

### 样例输入 #1
```
3456789
```
### 样例输出 #1
```
96342015 
```
## 提示

$1\le n\le 10^9$


---

---
title: "阅览室"
layout: "post"
diff: 普及+/提高
pid: P1844
tag: ['NOI 导刊']
---
# 阅览室
## 题目描述

一个阅览室每天都要接待大批读者。阅览室开门时间是 $O$，关门时间是 $T$。每位读者的到达时间都不一样，并且想要阅读的刊物不超过 $5$ 本。

每位读者心里对自己想看的刊物都有一个排位，到达之后他会先去找自己最想看的刊物，如果找不到则去找其次想看的刊物。如果找不到任何他想看的刊物，他会开始等待，直到有一本以上的他想看的刊物被人放回原处。当然，他会先去拿其中自己最想看的刊物。当他看完某一本刊物后，就把它放回原处，接着去找自己没看过的最想看的刊物。如此下去，直到看完所有他想看的刊物为止。

矛盾出现在两个人同时想要拿同一本刊物的时候。阅览室为了避免读者之间出现争执，作了一个规定，读者每次在开始等待时先去服务台做一次登记。如果两个人都同时想要一本刊物，那么先登记的读者将得到这本刊物。如果两个人同时登记，那么先到达阅览室的读者将得到刊物。没得到的人就只能去找其他的刊物看。

阅览室关门时，所有读者都将被强迫离开阅览室，不再允许继续阅读。

现在阅览室想做一个统计调查，你被要求写一个程序来模拟这个过程计算出所有刊物被阅读的总次数。当某个读者开始阅读某本刊物时，该刊物的被阅读次数就加 $1$，无论这本刊物最后有没有被读完。
## 输入格式

输入包含多组测试数据。

每个测试数据开头是两个整数 $T$ 和 $n\ (1 \le n \le 100)$，分别表示图书馆关门时间和读者总数。接下来按照读者的到达时间先后依次给出了每位读者的具体描述。

每个读者描述开头是一个整数 $t\ (0 \le t<T)$，表示该读者到达时间。接下来一行开头是一个整数 $k\ (1 \le k \le 5)$，表示该读者想要看的刊物数目。之后跟着 $2k$ 个整数按照读者想要阅读的刊物的顺序依次给出了刊物的描述。其中第 $2i-1$ 个整数表示刊物的编号 $s\ (0 \le s<1000)$，第 $2i$ 个整数表示该读者读完这本刊物所需的时间。
## 输出格式

对于每个测试数据，在单独一行里输出所有刊物被阅读的总次数。

## 样例

### 样例输入 #1
```
10 4 
1
2 1 4 2 5 
3 
1 2 4 
7 
3 2 2 1 3 3 2 
9 
1 4 2 
```
### 样例输出 #1
```
5
```


---

---
title: "回文串计数"
layout: "post"
diff: 普及+/提高
pid: P1872
tag: []
---
# 回文串计数
## 题目描述

小 $a$ 虽然是一名理科生，但他常常称自己是一名真正的文科生。不知为何，他对于背诵总有一种莫名其妙的热爱，这也促使他走向了以记忆量大而闻名的生物竞赛。然而，他很快发现这并不能满足他热爱背诵的心，但是作为一名强大的 OIER，他找到了这么一个方法——背诵基因序列。然而这实在是太困难了，小啊感觉有些招架不住。

不过他发现，如果他能事先知道这个序列里有多少对互不相交的回文串，他或许可以找到记忆的妙法。为了进一步验证这个想法，小 $a$ 决定选取一个由小写字母构成的字符串 $SS$ 来实验。由于互不相关的回文串实在过多，他很快就数晕了。不过他相信，在你的面前这个问题不过是小菜一碟。

1. 对于字符串 $SS$，设其长度为 Len，那么下文用 $S_i$ 表示 $SS$ 中第 $i$ 个字符（$1 \le i \le Le_n$）。

2. $S[i,j]$ 表示 $SS$ 的一个子串，$S[i,j]=S_i S_{i+1}S_{i+2} \cdots S_{j-2}S_{j-1}S_{j}$，比如当 $SS$ 为 `abcgfd` 时，$S[2,5]$ 就是 `bcgf`，$S[1,5]$ 是 `abcgf`。

3. 当一个串被称为一个回文串当且仅当将这个串反写后与原串相同，如`abcba`。

4. 考虑一个四元组 $(l,r,L,R)$，当 $S[l,r]$ 和 $S[L,R]$ 均为回文串时，且满足 $1 \le l \le r<L \le R \le \text{Len}$ 时，我们称 $S[l,r]$ 和 $S[L,R]$ 为一对互不相交的回文串。即本题所求，也即为这种四元组的个数。两个四元组相同当且仅当对应的 $l,r,L,R$ 都相同。
## 输入格式

输入仅一行，为字符串 $SS$，保证全部由小写字母构成，由换行符标志结束。

$50$ ％的数据满足 $SS$ 的长度不超过 $200$；

$100$ ％的数据满足 $SS$ 的长度不超过 $2000$。
## 输出格式

仅一行，为一个整数，表示互不相关的回文串的对数。

## 样例

### 样例输入 #1
```
aaa
```
### 样例输出 #1
```
5
```
## 提示

【样例数据说明】

SS="aaa"，SS 的任意一个字符串均为回文串，其中总计有 5 对互不相关的回文串：

(1,1,2,2)，(1,1,2,3)，(1,1,3,3)，(1,2,3,3)，(2,2,3,3)。




---

---
title: "[AHOI2009] 跳棋"
layout: "post"
diff: 普及+/提高
pid: P2039
tag: ['2009', '各省省选', '安徽']
---
# [AHOI2009] 跳棋
## 题目描述

在一个 $1$ 行 $N$ 列（$N$ 是奇数）的棋盘上，有 $K$ 个格子是红色的。这种情况下，你有一个跳棋在最左端的格子上。你的目标是将它移动到最右边的格子，在开始移动之间，你可以在棋盘的任意空位上放棋子。在游戏开始后 你只可以随时在一个红色格子上放棋子。棋子的移动规则是：每次只可以选择一个棋子，跳过与之相邻的棋子走到后面的空格上，被它跳过的棋子被吃掉，即从棋盘上移走，如相邻棋子的另一侧有棋子，则不能跳。


请回答以下两个问题：

1. 移动开始前至少要放多少棋子才能完成任务。
2. 如果要使开始前放的棋子数要求尽量少，那么在移动过程中最少需要放多少个棋子才能完成任务。


关于规则的补充说明：

1. 只能往空位上放棋子，不管是移动开始前还是移动过程中。
2. 移动前棋盘最左端的那个原始棋子绝对不能被吃掉。

## 输入格式

第一行一个正奇数 $N$。

第二行有 $N$ 个整数，如果第 $i$ 个整数是 $1$，说明第 $i$ 个格子是红棋，否则为白棋。

数字间用空格分开。

## 输出格式

两行，每行一个整数分别代表第一问和第二问的结果。

## 样例

### 样例输入 #1
```
5
0 0 0 1 0


```
### 样例输出 #1
```
1
1
```
## 提示

在游戏开始前，可以在第二个格子上放上一个棋子，游戏开始后可用最左边的棋子吃掉它，从而移动到第三格。然后由于第四格是个红色的格子，在游戏中可以在那放一个棋子，然后用已经移动第三格的棋子把它吃掉，从而达到终点。

$100\%$ 的数据中，$1\le N\le  1000$，输出中的数字不超过 $10^ {15}$。

$30\%$ 的数据中，$N\le 20$。


Source: [Ahoi2009] checker



---

---
title: "刷墙"
layout: "post"
diff: 普及+/提高
pid: P2070
tag: ['USACO']
---
# 刷墙
## 题目描述

Farmer John已经设计了一种方法来装饰谷仓旁边的长栅栏（把栅栏认为是一根一维的线）。他把一只画刷绑在他最喜爱的奶牛Bessie身上，之后就去喝一杯冰水，而Bessie隔着栅栏来回走，当她走过某个地方，这里的一段栅栏就被刷上了涂料。

Bessie从栅栏上的位置0开始，并且遵循着一个N次移动的次序(1 <= N <= 100,000)。例如“10 L”表示Bessie向左移动了10个单位长度，“15 R”表示Bessie向右移动了15个单位长度。现给出Bessie所有移动的列表，Farmer John想要知道哪些区域的栅栏至少涂了两层涂料（只涂一层涂料的区域可能在大雨中被洗掉）。Bessie在她的行走中最远到达距起始点1,000,000,000个单位长度。

## 输入格式

第1行：一个整型数N。

第2..N+1行：每行描述了Bessie的N次移动中的一次，例如“15 L”。

## 输出格式

1行：被至少涂了两层涂料的区域总数。

## 样例

### 样例输入 #1
```
6

2 R

6 L

1 R

8 L

1 R

2 R
```
### 样例输出 #1
```
6
```
## 提示

【样例解释】

Bessie从位置0开始，向右移动2个单位长度，向左移动6个单位长度，向右移动1个单位长度，向左移动8个单位长度，最后向右移动3个单位长度。

6个单位区域至少被涂了两层涂料，是 [-11,-8], [-4,-3], [0,2]这些区域。



---

---
title: "果汁店的难题"
layout: "post"
diff: 普及+/提高
pid: P2088
tag: []
---
# 果汁店的难题
## 题目描述

炎热的夏天，来上一杯现榨的冰爽果汁想想都是一件惬意的事情！话说小王就看准了这一商机，在学校附近开了这么一家果汁店，但是最近他碰到了一个不大不小的难题：小王的果汁店里准备了 $K$ 台榨汁机，当然每台榨汁机只能榨一种果汁，在某个时段内，一个客人点了某种果汁，如果恰好有某台果汁机榨过这种果汁，那么就直接给客人用这台果汁机接着榨就可以了，但是如果点的是一种新的果汁就需要找一台干净的果汁机来用，问题就出在这，如果这时候还有空的果汁机还好，如果没有的话小王就需要将某台刚才用过的拿去清洗，清洗的话呢就得浪费很多的时间和很多的水，小王是个很有经济头脑的人，他想知道在排队客人需求已知的情况下最少需要清洗多少次果汁机？假定开始时所有果汁机都是干净的，为了方便描述，我们将果汁编号为 $1$ （橙汁）, $2$（苹果汁）， $3$ （葡萄汁）......

[友情提示：本店不售卖混合果汁]
## 输入格式

每组测试数据第一行包括两个整数$K,N$，其中，$K$ 表示小王准备了 $K$ 台干净的榨汁机，$N$ 表示排队等待的有 $N$ 个客人，接下来 $N$ 行，每行一个整数表示一个客人点的果汁种类 $X_i$ 。
## 输出格式

输出在当前的请求序列下，小王最少需要清洗果汁机的次数。
## 样例

### 样例输入 #1
```
2 7
1
2
3
1
3
1
3

```
### 样例输出 #1
```
1

```
## 提示

$1\le K\le 10$，$1\le N\le 100$。

$1\le x_i\le 100$。


---

---
title: "[NOIP 2016 普及组] 魔法阵"
layout: "post"
diff: 普及+/提高
pid: P2119
tag: ['2016', 'NOIP 普及组']
---
# [NOIP 2016 普及组] 魔法阵
## 题目背景

NOIP2016 普及组 T4
## 题目描述

六十年一次的魔法战争就要开始了，大魔法师准备从附近的魔法场中汲取魔法能量。

大魔法师有 $m$ 个魔法物品，编号分别为 $1,2,\ldots,m$。每个物品具有一个魔法值，我们用 $X_i$ 表示编号为 $i$ 的物品的魔法值。每个魔法值 $X_i$ 是不超过 $n$ 的正整数，可能有多个物品的魔法值相同。

大魔法师认为，当且仅当四个编号为 $a,b,c,d$ 的魔法物品满足 $X_a<X_b<X_c<X_d,X_b-X_a=2(X_d-X_c)$，并且 $X_b-X_a<(X_c-X_b)/3$ 时，这四个魔法物品形成了一个魔法阵，他称这四个魔法物品分别为这个魔法阵的 $A$ 物品，$B$ 物品，$C$ 物品，$D$ 物品。

现在，大魔法师想要知道，对于每个魔法物品，作为某个魔法阵的 $A$ 物品出现的次数，作为 $B$ 物品的次数，作为 $C$ 物品的次数，和作为 $D$ 物品的次数。
## 输入格式

第一行包含两个空格隔开的正整数 $n,m$。

接下来 $m$ 行，每行一个正整数，第 $i+1$ 行的正整数表示 $X_i$，即编号为 $i$ 的物品的魔法值。

保证 $1 \le n \le 15000$，$1 \le m \le 40000$，$1 \le X_i \le n$。每个 $X_i$ 是分别在合法范围内等概率随机生成的。
## 输出格式

共 $m$ 行，每行 $4$ 个整数。第 $i$ 行的 $4$ 个整数依次表示编号为 $i$ 的物品作 为 $A,B,C,D$ 物品分别出现的次数。

保证标准输出中的每个数都不会超过 $10^9$。每行相邻的两个数之间用恰好一个空格隔开。

## 样例

### 样例输入 #1
```
30 8
1
24
7
28
5
29
26
24
```
### 样例输出 #1
```
4 0 0 0
0 0 1 0
0 2 0 0
0 0 1 1
1 3 0 0
0 0 0 2
0 0 2 2
0 0 1 0
```
### 样例输入 #2
```
15 15
1 
2 
3 
4 
5
6 
7 
8 
9
10
11
12
13
14
15
```
### 样例输出 #2
```
5 0 0 0
4 0 0 0
3 5 0 0
2 4 0 0
1 3 0 0
0 2 0 0
0 1 0 0
0 0 0 0
0 0 0 0
0 0 1 0
0 0 2 1
0 0 3 2
0 0 4 3
0 0 5 4
0 0 0 5
```
## 提示

【样例解释 $1$】

共有 $5$ 个魔法阵，分别为：

- 物品 $1,3,7,6$，其魔法值分别为 $1,7,26,29$；
- 物品 $1,5,2,7$，其魔法值分别为 $1,5,24,26$；
- 物品 $1,5,7,4$，其魔法值分别为 $1,5,26,28$；
- 物品 $1,5,8,7$，其魔法值分别为 $1,5,24,26$；
- 物品 $5,3,4,6$，其魔法值分别为 $5,7,28,29$。

以物品 $5$ 为例，它作为 $A$ 物品出现了 $1$ 次，作为 $B$ 物品出现了 $3$ 次，没有作为 $C$ 物品或者 $D$ 物品出现，所以这一行输出的四个数依次为 $1,3,0,0$。

此外，如果我们将输出看作一个 $m$ 行 $4$ 列的矩阵，那么每一列上的 $m$ 个数之和都应等于魔法阵的总数。所以，如果你的输出不满足这个性质，那么这个输出一定不正确。你可以通过这个性质在一定程度上检查你的输出的正确性。

【数据规模】

![](https://cdn.luogu.com.cn/upload/image_hosting/nozwrvut.png)


---

---
title: "炉石collection"
layout: "post"
diff: 普及+/提高
pid: P2200
tag: []
---
# 炉石collection
## 题目描述

小 Z 最近沉迷于一个叫做炉石 collection 的游戏。在游戏中，你需要使用排在 $N \times N$ 的矩阵内的卡牌来击败你的敌人。

在这个游戏中，排兵布阵是游戏的一个重要内容，例如“日怒保卫者”和“上古看守者”放在一起可以起到更好的效果。为了游戏的平衡性，同样种类的卡牌最多只能出战 $2$ 张。

在一次激烈的战斗之后，小 Z 想要重新编排他的队伍。在游戏中，小 Z 可以支付 $A$ 枚金币让你任意横向交换卡牌，支付 $B$ 枚金币让你任意纵向交换卡牌。

你只需要支付一次金币就可以进行某种类型的交换任意次，直到你停下并进行另一种类型的交换，此时需要支付另一种类型交换的费用。例如，“横向交换-横向交换-纵向交换-纵向交换-纵向交换-横向交换-纵向交换”总共要支付 $2A + 2B$ 枚金币。

小 Z 想要知道，他最少要支付多少金币把他目前的布置变换成他想要的布置。
## 输入格式

第一行包含三个数字 $N,A,B$，分别表示矩阵的大小，横向交换的费用，纵向交换的费用。

接下来 $N$ 行每行包含 $N$ 个整数，表示开始交换前矩阵内每个位置卡牌的类型。

接下来 $N$ 行每行包含 $N$ 个整数，表示目标矩阵内每个位置卡牌的类型。
## 输出格式

输出最少需要支付多少金币能够把目前的布置变换成他想要的布置。如果不能变换成功，输出 `Fail`。
## 样例

### 样例输入 #1
```
3 16 9
2 5 6
1 1 3
7 8 3
2 5 1
3 3 6
7 8 1
```
### 样例输出 #1
```
34
```
### 样例输入 #2
```
2 193 43
1 2
2 1
1 2
2 3
```
### 样例输出 #2
```
Fail
```
### 样例输入 #3
```
3 10 20
1 2 3
4 5 4
3 2 1
2 1 2
1 5 3
4 3 4
```
### 样例输出 #3
```
30
```
## 提示

对于 $68\%$ 的数据，答案最多只需要支付 $1$ 次费用。

对于 $86\%$ 的数据，答案最多只需要支付 $2$ 次费用。

对于 $100\%$ 的数据，$1 \leq n \leq 300,1 \leq A,B \leq 1000000,1 \leq$ 卡牌类型的标号 $\leq 100000$。


---

---
title: "[HNOI2001] 矩阵乘积"
layout: "post"
diff: 普及+/提高
pid: P2222
tag: ['2001', '各省省选', '湖南']
---
# [HNOI2001] 矩阵乘积
## 题目描述

已知矩阵：

$$A_{m\times n}=\begin{bmatrix}a_{1,1} & a_{1,2} & \cdots & a_{1,n}\\ a_{2,1} & a_{2,2} & \cdots & a_{2,n} \\ \vdots & \vdots & \ddots & \vdots\\ a_{m,1} & a_{m,2} & \cdots &a_{m,n} \end{bmatrix} ,B_{n\times p}=\begin{bmatrix}b_{1,1} & b_{1,2} & \cdots & b_{1,p}\\ b_{2,1} & b_{2,2} & \cdots & b_{2,p} \\ \vdots & \vdots & \ddots & \vdots\\ b_{n,1} & b_{n,2} & \cdots &b_{n,q} \end{bmatrix}$$

当矩阵 $A$ 的列数与矩阵 $B$ 的行数相同时，则 $A$ 与 $B$ 可以相乘，其乘积为一个 $m\times p$ 的矩阵 $D$：

$$D_{m\times p}=\begin{bmatrix} d_{1,1} & d_{1,2} & \cdots & d_{1,p}\\ d_{2,1} & d_{2,2} & \cdots & d_{2,p} \\ \vdots & \vdots & \ddots & \vdots\\ d_{m,1} & d_{m,2} & \cdots & d_{m,p}\end{bmatrix}$$

其中 $d_{i,j}=\sum^n_{k=1} a_{i,k} \times b_{k,j}$，简记为 $D=A\times B$。

现已知三个矩阵 $A,B,C$，这三个矩阵大多数元素为 $0$，我们把这种矩阵称为稀疏矩阵。因此，我们采用三元组 $i,j,a$ 来表示矩阵的第 $i$ 行第 $j$ 列的值为 $a$ 其余未列出的元素均为 $0$；在计算机中，我们仅给出非零元素的三元组，而且使用行优先法给出稀疏矩阵的三元组，首先是第一行按列给出，然后是第二行按列给出……

例如，矩阵：$\begin{bmatrix}1&0&0&0\\0&0&2&-1\\0&1&2&3\\0&0&0&0\end{bmatrix}$ 那么，矩阵的三元组表示为：

```plain
1 1 1
2 3 2
2 4 -1
3 2 1 
3 3 2
3 4 3
```

你的任务就是：计算矩阵 $D=A\times B\times C$。
## 输入格式

第一行为两个正整数 $x,y$，分别表示输出结果所在的行和列。

第二行为四个整数 $m,n,o,p$，表明 $A$ 为$m\times n$ 的矩阵，$B$ 为 $n\times o$ 的矩阵，$C$ 为 $o\times p$ 的矩阵。

第三行以后的每一行有三个整数分别是矩阵的三元组表示法中的一个元素的值，每个矩阵之间有一个空行。表示的顺序是矩阵 $A,B,C$。

## 输出格式

仅一个整数，为 $D$ 的第 $x$ 行第 $y$ 列的元素的值。
## 样例

### 样例输入 #1
```
1 2                       

3 4 2 3

1 1 3

1 4 5

2 2 1

3 1 2



1 2 2

2 1 1

3 1 2

3 2 4



1 2 2

1 3 3

2 1 1

2 2 2


```
### 样例输出 #1
```
12
```
## 提示

#### 数据规模与约定
对于全部的测试点，保证 $1\le m,n,o,p\le 6\times 10^3$，三元数组的总个数不大于 $6\times 10^3$。数据之间用空格分开。


---

---
title: "SAC#1 - Hello World（升级版）"
layout: "post"
diff: 普及+/提高
pid: P2246
tag: ['O2优化']
---
# SAC#1 - Hello World（升级版）
## 题目背景

#T1答案要mod1000000007(10^9+7)，请重新提交，非常抱歉！

一天，智障的pipapi正在看某辣鸡讲义学程序设计。

## 题目描述

在讲义的某一面，他看见了一篇文章。这篇文章由英文字母（大小写均有）、数字、和空白字符（制表/空格/回车）构成。

pipapi想起了他最近刚刚学会写的Hello World程序。他非常好奇，这篇文章中，“HelloWorld”作为子序列到底出现过多少次呢？

由于papapi是个智障，大小写对于他而言毫无区别；因此，“hEllOWorLD”这样的子序列也是可以接受的。O和W之间的空格是也是可以少的；也就是说，“HelloWorld”是可以的。根据标程的意思，就是没有空格，不用考虑空格的情况。

两个子序列相同当且仅当它们每一个字符所在的位置都相同。


由于答案可能很大，请输出结果对1000000007(10^9+7)的余数。

## 输入格式

输入包含若干行。这些行的内容共同构成一篇文章。

文章以EOF（文件结尾）结束。

## 输出格式

输出仅包含一个整数，表示这篇文章中“Hello World”出现的次数。 d

## 样例

### 样例输入 #1
```
HhEeLlLlOoWwOoRrLlDd
```
### 样例输出 #1
```
1536
```
### 样例输入 #2
```
Gou Li Guo Jia Sheng Si Yi
Qi Yin Huo Fu Bi Qu Zhi
River can feed people
Also can race boats
Hall Ellen Ok Words locked 
```
### 样例输出 #2
```
273
```
## 提示

记n为输入的文章的长度（字符数）。

对于20%的数据，n <= 20。

对于50%的数据，n <= 500。

对于所有的数据，15 <= n <= 500000。



---

---
title: "路边的水沟"
layout: "post"
diff: 普及+/提高
pid: P2265
tag: []
---
# 路边的水沟
## 题目背景

某市有一个巨大的水沟网络，可以近似看成一个 $n \times m$ 的矩形网格，网格的每个格点都安装了闸门，我们将从水沟网络右下角的闸门到左上角的闸门的一条路径称为水流。

## 题目描述

现给定水沟网的长和宽，求该水沟网中所有只包含向左和向上移动的水流数量。

## 输入格式

输入共 $1$ 行，包含两个整数 $n$ 和 $m$。
## 输出格式

输出一个数字 $ans$，即水流的数量。由于答案可能很大，请输出答案对 $1000000007$ 取模的结果。

## 样例

### 样例输入 #1
```
3 5
```
### 样例输出 #1
```
56
```
## 提示

对于 $30\%$ 的数据，$1 \leq m,n \leq 10$。

对于 $50\%$ 的数据，$1 \leq m,n \leq 1,000$。

对于 $80\%$ 的数据，$1 \leq m,n \leq 50,000$。

对于 $100\%$ 的数据，$1 \leq m,n \leq 1,000,000$。


---

---
title: "[HNOI2002] 高质量的数据传输"
layout: "post"
diff: 普及+/提高
pid: P2269
tag: ['2002', '各省省选', '湖南']
---
# [HNOI2002] 高质量的数据传输
## 题目描述

![](https://cdn.luogu.com.cn/upload/pic/1325.png)

## 输入格式

输入文件ROUTING.IN

共有2n+1行。

第1行是网络的节点数n，数据要传输的两个结点的序号i，j，其中结点数n不大于200。第2行到第n+1行是时延t的邻接矩阵，其元素tkl的值是第k个结点到第l个结点的边的时延，当其值=-1时表示第k个结点到第l个结点无边。显然该邻接矩阵是对称矩阵。第n+2行到第2n+1行是丢失率p的邻接矩阵，其元素pkl的值是第k个结点到第l个结点的边的丢失率，已精确到小数点后4位，当其值=-1时表示第k个结点到第l个结点无边。显然该邻接矩阵是对称矩阵。

## 输出格式

输出文件ROUTING.OUT

共1行，输出所找出的路径的时延和丢失率（精确到小数点后4位）。

## 样例

### 样例输入 #1
```
3 1 3                       
0 1 5
1 0 2
5 2 0
0 0.1 0.05
0.1 0 0.05
0.05 0.05 0
```
### 样例输出 #1
```
5 0.0500
```


---

---
title: "[HNOI2003] 24点游戏"
layout: "post"
diff: 普及+/提高
pid: P2277
tag: ['2003', '各省省选', '湖南']
---
# [HNOI2003] 24点游戏
## 题目描述

为了培养小孩的计算能力，大人们经常给小孩玩这样的游戏：从一副扑克牌中任意抽出 $4$ 张扑克，要小孩用 `+`、`-`、`*`、`/` 和括号组成一个合法的表达式，并使表达式的值为 $24$ 点。这种游戏就是所谓的“$24$ 点游戏”。

请你编程求出对于给出的任意 $4$ 个正整数 $a$、$b$、$c$、$d$，请你编程求出这 $4$ 个整数能组成多少个值为 $24$ 的不同表达式。

## 输入格式

输入文件共一行，为四个正整数 $a$、$b$、$c$、$d$。（$0 \le a, b, c, d \le 100$）

## 输出格式

输出文件为由 $a$、$b$、$c$、$d$ 组成的值为 $24$ 的表达式个数，如没有，输出 $0$。

## 样例

### 样例输入 #1
```
5 5 5 5

```
### 样例输出 #1
```
1

```


---

---
title: "被 yyh 虐的 mzc"
layout: "post"
diff: 普及+/提高
pid: P2306
tag: []
---
# 被 yyh 虐的 mzc
## 题目背景

mzc 与 djn 第三弹。

## 题目描述

mzc 家很有钱（开玩笑），他家有 $n$ 个男家丁（做过前两弹的都知道）。但这些都不足以挽救他被 yyh 虐的命运。于是他向你们发起了求救。

mzc 要派出男家丁与 yyh 大战，但他只能承载质量为 $m$ 的男家丁，现在他想知道她们（你没有看错）的战斗力之和是否打得过 yyh。
## 输入格式

第一行有三个数 $n,m,k$，$n$ 表示有 $n$ 个男家丁，$m$ 表示能承载 $m$ 表的质量，$k$ 表表示 yyh 表的战斗力。

之后 $n$ 行，每行两个数 $a_i,b_i$，分别表示第 $i$ 个男家丁的质量和战斗力。
## 输出格式

两行，若打得过（大于或等于），输出 `yes`；

若打不过，输出 `no`。

第二行输出最高战斗力。
## 样例

### 样例输入 #1
```
3 100 100
7 10
6 1
1 2

```
### 样例输出 #1
```
no
13

```
## 提示

对于 $20\%$ 的数据，$n \le 1000$。

对于 $100\%$ 的数据，$n,m \le 10^5$，$0\le a_i,b_i \le 10$。

由于 mzc 大大十分着急，所以他只能等待一秒。


---

---
title: "队爷的新书"
layout: "post"
diff: 普及+/提高
pid: P2352
tag: []
---
# 队爷的新书
## 题目描述

队爷即将出版新书，以记录他辉煌的虐题生涯。。。

有 $n$ 家出版社对这本书表示了兴趣，并愿意给队爷支付 $p \in [Min_{pay},Max_{pay}]$ 的报酬来得到这本书的出版权，每家出版社的 $Min_{pay}$ 和 $Max_{pay}$ 是不一样的。

现在队爷希望你帮他找出一个报酬值 $p$，使得他获得的总报酬最多。（每一个 $Min_{pay} \leq p \leq Max_{pay}$ 的出版社都会付给队爷 $p$ 的报酬）。

## 输入格式

第一行为一个整数 $n$。

接下来 $n$ 行，每行 $2$ 个整数 $Min_{payi}$ 和 $Max_{payi}$，为第 $i$ 家出版社愿支付的报酬范围。


## 输出格式

只有一个整数 ans，为最大总报酬。

## 样例

### 样例输入 #1
```
4
1 3
2 4
3 5
4 7
```
### 样例输出 #1
```
12

```
## 提示

【样例解释】

当 $p = 4$ 时，有 $3$ 家出版社会给出报酬，此时最大。

【数据规模与约定】

对于 $20\%$ 的数据，$1 \leq Min_{pay},Max_{pay} \leq 10000$；

对于 $40\%$ 的数据，$1 \leq n \leq 1000,1 \leq Min_{pay},Max_{pay} \leq 10^6$；

对于 $100\%$ 的数据，$1 \leq n \leq 100000,1 \leq Min_{pay},Max_{pay} \leq 10^9$。


---

---
title: "Y的积木"
layout: "post"
diff: 普及+/提高
pid: P2409
tag: []
---
# Y的积木
## 题目背景

Y 是个大建筑师，他总能用最简单的积木拼出最有创意的造型。
## 题目描述

Y 手上有 $n$ 盒积木，每个积木有个重量。现在他想从每盒积木中拿一块积木，放在一起，这一堆积木的重量为每块积木的重量和。现在他想知道重量和最小的 $k$ 种取法的重量分别是多少。（只要任意更换一块积木，就视为一种不同的取法。如果多种取法重量总和一样，我们需要输出多次。）
## 输入格式

第一行输入两个整数，$n,k$，意义如题目所描述。

每组数据接下来的 $n$ 行，第一个整数为 $m_i$，表示第 $i$ 盒积木的数量，在同一行有 $m_i$ 个整数，分别表示每个积木的重量。
## 输出格式

一行，重量最小的 $k$ 种取法的重量，要求对于每个数据，从小到大输出。
## 样例

### 样例输入 #1
```
3 10
4 1 3 4 5
3 1 7 9
4 1 2 3 5

```
### 样例输出 #1
```
3 4 5 5 6 6 7 7 7 7

```
## 提示

#### 数据规模与约定

- 对于 $30\%$ 的数据，$2 \le m_i \le 10$，$1 \le n \le 10$。
- 对于 $50\%$ 的数据，$2 \le m_i \le 50$，$1 \le n \le 50$。
- 对于 $100\%$ 的数据，$2 \le m_i \le 100$，$1 \le n \le 100$，$1 \le k \le 10^4$，每个积木的重量为不超过 $100$ 的正整数，所有 $m_i$ 的积大于等于 $k$。

本题不卡常。


---

---
title: "[SDOI2005] 阶梯教室设备利用"
layout: "post"
diff: 普及+/提高
pid: P2439
tag: ['2005', '各省省选', '山东']
---
# [SDOI2005] 阶梯教室设备利用
## 题目描述

我们现有许多演讲要在阶梯教室中举行。每一个演讲都可以用唯一的起始和终止时间来确定，如果两个演讲时间有部分或全部重复，那么它们是无法同时在阶级教室中举行的。现在我们想要尽最大可能的利用这个教室，也就是说，我们需要在这些演讲中选择一些不重复的演讲来举行使得他们用的总时间尽可能的长。我们假设在某一演讲结束的瞬间我们就可以立即开始另一个演讲。

请写一个程序：

读入所有演讲的起始和终止时间，计算最大的可能演讲总时间。
## 输入格式

第一行包括一个正整数 $n$，为所有的演讲的数目。

以下的 $n$ 行每行含有两个由空格隔开的整数 $p$ 和 $k$。这样的一对整数表示一个演讲由时间 $p$ 开始到时间 $k$ 结束。
## 输出格式

输出唯一的一个整数，为最长的演讲总时间。

## 样例

### 样例输入 #1
```
12

1 2

3 5

0 4

6 8

7 13

4 6

9 10

9 12

11 14

15 19

14 16

18 20


```
### 样例输出 #1
```
16
```
## 提示

### 样例解释

可以选择第 $3$ 个、第 $5$ 个、第 $6$ 个、第 $11$ 个、第 $12$ 个演讲，此时有最长的演讲总时间 $16$。

### 数据范围

$1\le n\le 10^4$，$0\le p<k\le 3\times 10^4$。


---

---
title: "[SDOI2006] 保安站岗"
layout: "post"
diff: 普及+/提高
pid: P2458
tag: ['2006', '各省省选', '山东']
---
# [SDOI2006] 保安站岗
## 题目描述

五一来临，某地下超市为了便于疏通和指挥密集的人员和车辆，以免造成超市内的混乱和拥挤，准备临时从外单位调用部分保安来维持交通秩序。

已知整个地下超市的所有通道呈一棵树的形状；某些通道之间可以互相望见。总经理要求所有通道的每个端点（树的顶点）都要有人全天候看守，在不同的通道端点安排保安所需的费用不同。

一个保安一旦站在某个通道的其中一个端点，那么他除了能看守住他所站的那个端点，也能看到这个通道的另一个端点，所以一个保安可能同时能看守住多个端点（树的结点），因此没有必要在每个通道的端点都安排保安。

编程任务：

请你帮助超市经理策划安排，在能看守全部通道端点的前提下，使得花费的经费最少。

## 输入格式

第 $1$ 行 $n$，表示树中结点的数目。

第 $2$ 行至第 $n+1$ 行，每行描述每个通道端点的信息，依次为：该结点标号 $i$（$0<i \le n$），在该结点安置保安所需的经费 $k$（$ \le 10000$），该边的儿子数 $m$，接下来 $m$ 个数，分别是这个节点的 $m$ 个儿子的标号 $r_1,r_2,\cdots, r_m$。

对于一个 $n$（$0<n \le 1500$）个结点的树，结点标号在 $1$ 到 $n$ 之间，且标号不重复。
## 输出格式

输出一行一个整数，表示最少的经费。


## 样例

### 样例输入 #1
```
6

1 30 3 2 3 4

2 16 2 5 6

3 5 0

4 4 0

5 11 0

6 5 0
```
### 样例输出 #1
```
25
```
## 提示

### 样例解释

![](https://cdn.luogu.com.cn/upload/image_hosting/g013tlmh.png)

在结点 $2,3,4$ 安置 $3$ 个保安能看守所有的 $6$ 个结点，需要的经费最小：$25$。



---

---
title: "[SHOI2001] 排序工作量之新任务"
layout: "post"
diff: 普及+/提高
pid: P2528
tag: ['2001', '各省省选', '上海']
---
# [SHOI2001] 排序工作量之新任务
## 题目描述

假设我们将序列中第 $i$ 件物品的参数定义为 $A_i$，那么排序就是指将 $A_1, \cdots ,A_n$ 从小到大排序。若 $i<j$ 且 $A_i>A_j$ ，则 $(i,j)$ 就为一个“逆序对”。SORT 公司是一个专门为用户提供排序服务的公司，他们的收费标准就是被要求排序物品的“逆序对”的个数，简称“逆序数”。

Grant 是这家公司的排序员，他想知道对于 $n$ 个参数都不同的物品组成的序列集合中，逆序对数为 $t$ 的物品有多少个，并试给出其中一个最小的物品序列。所谓最小，即若有两个物品序列 $(A_1,A_2,\cdots ,A_n)$，$(B_1,B_2,\cdots ,B_n)$，存在 $1 \le i \le n$，使得 $(A_1,A_2,\cdots ,A_{i-1})=(B_1,B_2,\cdots,B_{i-1})$ 且$A_i<B_i$。

## 输入格式

即两个整数 $n$和 $t(1 \le n \le 20,0 \le t \le \dfrac{n\cdot (n-1)}{2})$。

## 输出格式

第一行表示 $n$ 个参数都不通的物品组成的序列集合中，逆序数为 $t$ 的序列个数；

第二行是所求物品参数序列。假设 $n$ 个物品分别为 $1$ 到 $n$。

## 样例

### 样例输入 #1
```
4 3
```
### 样例输出 #1
```
6
1 4 3 2
```


---

---
title: "[AHOI2002] 数的朗读"
layout: "post"
diff: 普及+/提高
pid: P2555
tag: ['2002', '各省省选', '安徽']
---
# [AHOI2002] 数的朗读
## 题目描述

春游时小可可结识了刚回国定居的 Sealock。但是 Sealock 在海外出生，

回国后才开始学习汉语。数的朗读成为 Sealock 的一个难题，小可可下决心

教会 Sealock 如何朗读绝对值小于 10 亿的数。

小可可知道汉语中有如下的读数规则：

⑴首先读符号位， 然后读整数部分， 整数部分之后可能出现小数点， 如果有

小数部分则小数点一定出现、并且读出小数点之后读小数部分；

⑵符号位的读法是：

(2.1)正数，不论正号“+”是否出现，都不必读出符号位；

(2.2)负数的最左边的符号是“-”， 读成“ 负” (以“ F” 来表示“负” )；

⑶整数部分的读法是：

蚌埠， 2002.4.20 AH02SGOI11A1.doc 第1页

2002 年安徽省青少年信息学(计算机)竞赛网上同步赛暨 SGOI 第十一次友谊赛 一试试题

(3.1)如果整数部分不存在或者整数部分全是零则直接读成“零” (以“ 0”

来表示“零” )；

(3.2)否则从整数部分中最左边的非零数字开始读起， 然后以十、 百、 千、

万、亿(分别以“ S”、“ B”、“ Q”、“ W”、“ Y”来表示)等数量单位来拼读整

数部分；

⑷整数部分中：

(4.1)每一个非零数字都必须结合各个相应的数量单位读出来；

(4.2)每一段连续的“零” 只能读成一个“零”， 但是某一段连续的“零”的左侧或者右侧不存在非零数字(这里只考虑整数部分)则这一段“零” 不应该读出来；

⑸如果有小数部分，则首先读“点”(以“ D”来表示“点”)，然后从左至右顺序地读出各个小数位。 在读小数部分的时候不可以使用十、 百、 千、 万、亿等数量单位； 但是小数部分的每一个数字都需要读出来， 连续的零不可以读成一个“零”，而应该分别读出；

⑹如果数中有小数点而没有小数部分，则不应该把小数点读出来。

例如， -0020030004.567 应该读成“ F2Q03W04D567”， 000.89 应该读成“ 0D89”。

请你编写程序帮助小可可把给定的数正确地读出来。

## 输入格式

文件中以一行的形式存放了一个数(不超过 50 个字符)，其绝对值

小于 10 亿。

## 输出格式

以一行的形式输出这个数的正确读法。

## 样例

### 样例输入 #1
```
000.89
```
### 样例输出 #1
```
0D89
```
### 样例输入 #2
```
-0020030004.567
```
### 样例输出 #2
```
F2Q03W04D567
```


---

---
title: "[AHOI2002] Kitty猫基因突变"
layout: "post"
diff: 普及+/提高
pid: P2560
tag: ['2002', '各省省选', '安徽']
---
# [AHOI2002] Kitty猫基因突变
## 题目描述

 ![](https://cdn.luogu.com.cn/upload/pic/1682.png) 

![](https://cdn.luogu.com.cn/upload/pic/1683.png)

## 输入格式

![](https://cdn.luogu.com.cn/upload/pic/1684.png)

## 输出格式

以一行的形式输出评价效果最好的突变方案的评价指标。

## 样例

### 样例输入 #1
```
3 2
11000101
10 10 5 6 3 2 1 2
```
### 样例输出 #1
```
9
```


---

---
title: "老虎的题目"
layout: "post"
diff: 普及+/提高
pid: P2686
tag: []
---
# 老虎的题目
## 题目描述

随着小老虎做题越来越多，现在可做小老师了，小老虎经常帮老师出题供信息学奥赛班的同学测试用。出题确实是一件麻烦事。现在有更麻烦的事了：

小老虎收集到了一大堆的题目，并且按照收集的时间顺序排成一排。每个题目都有自己的题面长度和难度。小老虎想用这些题出好多好多场比赛。但是呢，有要求：

同一场比赛的题目，必须是这一排中，连续的一段，但题目数量不限。

题面长度的总和，不能超过high，也不能低于low。

不允许出现两场比赛，使得其中一场的题目全部在另一场出现过了。（就是说，不同比赛的题目集合不能出现包含和被包含关系）

题目可以在不同比赛中重复使用。


现在，小老虎想知道，在满足以上条件的基础上……对不起，小老虎不是想知道最多出多少场，而是想知道，所有比赛的难度总和最大是多少？（定义一场比赛的难度为本场比赛出现的所有题目的难度和）

## 输入格式

第一行是三个整数，N、low、high。

第二行有N个整数，描述了题面的长度。

第三行有N个整数，描述了题目的难度。

## 输出格式

输出一个整数，所有比赛的最大难度总和。

## 样例

### 样例输入 #1
```
6 4 5
1 3 3 2 2 1
2 3 1 4 5 2

```
### 样例输出 #1
```
21

注：样例中，3场，第一场选1，2两题，第二场选3，4两题，第三场选4，5，6三题。

```
## 提示

对于40%的数据，1 <= N <= 100；

对于100%的数据，1 <= N <= 1000；

单个题目的题面长度和难度都小等于100000；

其余给出的均在longint范围内。



---

---
title: "[USACO4.4] 棋盘游戏Shuttle Puzzle"
layout: "post"
diff: 普及+/提高
pid: P2739
tag: ['USACO']
---
# [USACO4.4] 棋盘游戏Shuttle Puzzle
## 题目描述

大小为3的棋盘游戏里有3个白色棋子，3个黑色棋子，和一个有7个格子一线排开的木盒子。3个白棋子被放在一头，3个黑棋子被放在另一头，中间的格子空着。

初始状态: WWW\_BBB

目标状态: BBB\_WWW

在这个游戏里有两种移动方法是允许的：

你可以把一个棋子移到与它相邻的空格；

你可以把一个棋子跳过一个(仅一个)与它不同色的棋子到达空格。

大小为N的棋盘游戏包括N个白棋子，N个黑棋子，还有有2N+1个格子的木盒子。

这里是3-棋盘游戏的解，包括初始状态，中间状态和目标状态：

WWW BBB

WW WBBB

WWBW BB

WWBWB B

WWB BWB

W BWBWB

WBWBWB
BW WBWB

BWBW WB

BWBWBW
BWBWB W

BWB BWW

B BWBWW

BB WBWW

BBBW WW

BBB WWW

请编一个程序解大小为N的棋盘游戏(1 <= N <= 12)。要求用最少的移动步数实现。

## 输入格式

一个整数N。

## 输出格式

输出用移动的棋子在棋盘的位置(位置从左到右依次为1, 2, ..., 2N+1)表示的变换序列，每个数字之间以空格分隔，每行20个数(除了最后一行)。

输出的解还应当有最小的字典顺序(即如果有多组移动步数最小的解，输出第一个数最小的解；如果还有多组，输出第二个数最小的解；...)。

## 样例

### 样例输入 #1
```
3
```
### 样例输出 #1
```
3 5 6 4 2 1 3 5 7 6 4 2 3 5 4
```
## 提示

题目翻译来自NOCOW。

USACO Training Section 4.3



---

---
title: "[AHOI2016初中组] 游戏"
layout: "post"
diff: 普及+/提高
pid: P2780
tag: ['2016', '安徽']
---
# [AHOI2016初中组] 游戏
## 题目描述

小雪与小可可正在玩一种数字游戏。他们准备了 $n$ 张卡片，每一张卡片上都有一个整数。游戏开始后，小雪会先选择一个不小于 $a$ 且不大于 $b$ 的整数 $t$，并告诉小可可这个数字 $t$ 是多少。之后小可可会挑出恰好 $k$ 张卡片，并将这 $k$ 张卡片上的数字相加，得到的和数记为 $m$。

小雪希望 $t$ 和 $m$ 差的绝对值尽可能大，而小可可却希望 $t$ 和 $m$ 差的绝对值尽可能小。在游戏开始前，他们二人都知道 $n$， $a$， $b$ 和 $k$ 是多少，也知道每一张卡片上的数字是多少。在小雪决定了 $t$ 的大小后，不能再修改，之后才由小可可挑选纸牌。

小雪希望知道，在二人都尝试最优策略的情况下， $t$ 和 $m$ 差的绝对值最大可以有多大？
## 输入格式

输入有两行。

第一行有 4 个整数 $n$， $k$， $a$ 和 $b$，分别满足 $1 \le k \le n \le 250$ 且 $0 \le a \le b \le 75000$。

第二行有 $n$ 个整数，依次为 $x_1$ 到 $x_n$，给出了每一张卡片上的数字。

每一张卡片上的数字 $x_i$ 都满足 $0\le x_i \le 300$。
## 输出格式

输出一行，只有一个整数，表示 $t$ 和 $m$ 差的绝对值最大可以有多大。
## 样例

### 样例输入 #1
```
4 2 58 100
10 10 50 80
```
### 样例输出 #1
```
15
```
### 样例输入 #2
```
8 3 1300 1800
2 0 1 9 1 4 0 5
```
### 样例输出 #2
```
1782
```
## 提示

对于 30% 的数据， $1\le k\le n\le 20$ 且 $0\le a\le b\le   6000$。

对于 80% 的数据， $1\le k\le n\le 65$ 且 $0\le a\le b\le   19650$。

对于 100% 的数据， $1\le k\le n\le 250$ 且 $0\le a\le b\le 75000$。



---

---
title: "宋荣子搭积木"
layout: "post"
diff: 普及+/提高
pid: P2816
tag: ['2016', '山东']
---
# 宋荣子搭积木
## 题目描述

saruka 非常喜欢搭积木，他一共有 $n$ 块积木。而且 saruka 的积木很特殊，只能一块块的竖着摞，可以摞很多列。说过 saruka 的是特殊的积木了，这些积木都非常智能，第 $i$ 块积木有一个情绪值 $x_i$ ，当摞在这块积木上的积木总数超过 $x_i$ 时，这块积木就会很不高兴，发誓以后不会再和 saruka 一起玩耍了。saruka 这么爱玩积木，肯定不会让积木不高兴的，但是 saruka 又希望每块积木都被用上，并且摞的积木列数最少。你能来帮帮 saruka 吗?
## 输入格式

第一行一个整数 $n$，含义如题目描述所示，

第二行有 $n$ 个数 $x_i$，含义如题目描述所示。
## 输出格式

输出一个数字，代表最小的积木列数。
## 样例

### 样例输入 #1
```
3
0 0 3

```
### 样例输出 #1
```
2
```
### 样例输入 #2
```
4
0 0 0 0

```
### 样例输出 #2
```
4
```
## 提示

对于 $100 \%$ 的数据，$1 \le n \le 5000$，$0 \le x_i \le n$。


---

---
title: "[USACO07MAR] Ranking the Cows G"
layout: "post"
diff: 普及+/提高
pid: P2881
tag: ['2007', 'USACO']
---
# [USACO07MAR] Ranking the Cows G
## 题目描述

Each of Farmer John's N cows (1 ≤ N ≤ 1,000) produces milk at a different positive rate, and FJ would like to order his cows according to these rates from the fastest milk producer to the slowest.

FJ has already compared the milk output rate for M (1 ≤ M ≤ 10,000) pairs of cows. He wants to make a list of C additional pairs of cows such that, if he now compares those C pairs, he will definitely be able to deduce the correct ordering of all N cows. Please help him determine the minimum value of C for which such a list is possible.

FJ想按照奶牛产奶的能力给她们排序。现在已知有N头奶牛（1 ≤ N ≤ 1,000）。FJ通过比较，已经知道了M（1 ≤ M ≤ 10,000）对相对关系。每一对关系表示为“X Y”，意指X的产奶能力强于Y。现在FJ想要知道，他至少还要调查多少对关系才能完成整个排序。

## 输入格式

Line 1: Two space-separated integers: N and M


Lines 2..M+1: Two space-separated integers, respectively: X and Y. Both X and Y are in the range 1...N and describe a comparison where cow X was ranked higher than cow Y.

## 输出格式

Line 1: A single integer that is the minimum value of C.

## 样例

### 样例输入 #1
```
5 5
2 1
1 5
2 3
1 4
3 4
```
### 样例输出 #1
```
3
```
## 提示

From the information in the 5 test results, Farmer John knows that since cow 2 > cow 1 > cow 5 and cow 2 > cow 3 > cow 4, cow 2 has the highest rank. However, he needs to know whether cow 1 > cow 3 to determine the cow with the second highest rank. Also, he will need one more question to determine the ordering between cow 4 and cow 5. After that, he will need to know if cow 5 > cow 3 if cow 1 has higher rank than cow 3. He will have to ask three questions in order to be sure he has the rankings: "Is cow 1 > cow 3?  Is cow 4 > cow 5? Is cow 5 > cow 3?"



---

---
title: "[USACO08OCT] Power Failure G"
layout: "post"
diff: 普及+/提高
pid: P2914
tag: ['2008', 'USACO']
---
# [USACO08OCT] Power Failure G
## 题目描述

A vicious thunderstorm has destroyed some of the wires of the farm's electrical power grid! Farmer John has a map of all $N$ ($2\le N \le 1000$) of the powerpoles, which are conveniently numbered $1\ldots N$ and located on integer plane coordinates $(x_i,y_i)$ ($-100000 \le x_i \le 100000, -100000 \le y_i \le 100000$).

Some $W$ ($1 \le W \le 10000$) power wires connect pairs of power poles $P_i$ and $P_j$ ($1 \le Pi \le N, 1 \le Pj \le N$).

He needs to get power from pole $1$ to pole $N$ (which means that some series of wires can traverse from pole $1$ to pole $N$, probably through some intermediate set of poles).

Given the locations of the $N$ poles and the list of remaining power wires, determine the minimum length of power wire required to restore the electrical connection so that electricity can flow from pole $1$ to pole $N$.  No wire can be longer than some real number $M$ ($0.0 < M \le 200000.0$).

As an example, below on the left is a map of the $9$ poles and $3$ wires after the storm. For this task, $M = 2.0$. The best set of wires to add would connect poles $4$ and $6$ and also poles $6$ and $9$.

```cpp
   After the storm              Optimally reconnected
3  . . . 7 9 . . . . .          3  . . . 7 9 . . . . .
                                          /
2  . . 5 6 . . . . . .          2  . . 5 6 . . . . . .
                                        /
1  2-3-4 . 8 . . . . .          1  2-3-4 . 8 . . . . .
   |                               |
0  1 . . . . . . . . .          0  1 . . . . . . . . .

   0 1 2 3 4 5 6 7 8 9             0 1 2 3 4 5 6 7 8 9
```

The total length is then $1.414213562 + 1.414213562 = 2.828427124$.

POINTS: 350

## 输入格式

Line $1$: Two space-separated integers: $N$ and $W$.

Line $2$: A single real number: $M$.

Lines $3\ldots N+2$: Each line contains two space-separated integers: $x_i$ and $y_i$.

Lines $N+3\ldots N+2+W$: Two space-separated integers: $P_i$ and $P_j$.

## 输出格式

Line 1: A single integer on a single line. If restoring connection is impossible, output `-1`. Otherwise, output a single integer that is $1000$ times the total minimum cost to restoreelectricity. Do not perform any rounding; truncate the resulting product.

## 样例

### 样例输入 #1
```
9 3 
2.0 
0 0 
0 1 
1 1 
2 1 
2 2 
3 2 
3 3 
4 1 
4 3 
1 2 
2 3 
3 4 

```
### 样例输出 #1
```
2828 

```
## 提示

Just as in the diagram above.


As above.

## 题目翻译

一场邪恶的暴风雨毁坏了农夫约翰的输电网中的一些电线！农夫约翰有一张包含了所有 $n$（$2\le n\le 1000$）个电能中转点的地图，中转点编号为 $1\ldots n$，第 $i$ 个点的坐标为 $(x_i,y_i)$（$-100000\le x_i\le 100000,-100000\le y_i\le 100000$）。

有 $w$（$1<=w<=10000$）条电线仍然保存着没被暴风雨破坏，每条电线连接着两个电能中转点 $p_i,p_j$（$1\le p_i\le n,1\le p_j\le n$）。

他希望从第一个电能中转点把电导入第 $n$ 个（可能通过一些中间的电能中转点，应当有一组电线连接 $1$ 和 $n$ ）。

给出 $n$ 个电能中转点的坐标和幸存的电线，请确定最少需要架设的电线总长度，但请注意，架设过程中，对于单条电线而言，其长度不应超过$m$（$0.0\le m\le 200000.0$）

给出一个例子，在下面，左边是一个包含 $9$ 个电能中转电和 $3$ 条幸存电线的地图。在这个任务中，规定 $m=2.0$。最佳的架设方案是连接 $6$ 和 $4$，以及 $6$ 和 $9$。

```plain
   After the storm              Optimally reconnected
3  . . . 7 9 . . . . .          3  . . . 7 9 . . . . .
                                          /
2  . . 5 6 . . . . . .          2  . . 5 6 . . . . . .
                                        /
1  2-3-4 . 8 . . . . .          1  2-3-4 . 8 . . . . .
   |                               |
0  1 . . . . . . . . .          0  1 . . . . . . . . .

   0 1 2 3 4 5 6 7 8 9             0 1 2 3 4 5 6 7 8 9
```
总长度是 $1.414213562 + 1.414213562 = 2.828427124$。



---

---
title: "[USACO08DEC] Jigsaw Puzzles S"
layout: "post"
diff: 普及+/提高
pid: P2927
tag: ['2008', 'USACO']
---
# [USACO08DEC] Jigsaw Puzzles S
## 题目描述

The cows have taken up alphabetical jigsaw puzzles. In these puzzles with R (1 <= R <= 10) rows and C (1 <= C <= 10) columns, the edges are not funny-shaped cardboard shapes but rather are letters.

Each piece has a serial number and 4 letters (or borders) that must be aligned as in a regular jigsaw puzzle. The pseudo-letter '0' (the digit 0) will represent a border (and a piece can have several borders if it is a corner piece or even the top of column in a, e.g., 4x1 puzzle).  Below is a set of six pieces (the borders are marked with lines instead of '0's) assembled in one way (of many) that completes the puzzle:

+---+  +---+  +---+

| 1 c  c 3 d  d 5 | 
+-d-+  + a +  +-e-+

+-d-+  +-a-+  +-e-+

| 2 b  b 4 b  b 6 | 
+---+  +---+  +---+

Note that each edge letter of each piece matches the border letter of the piece adjacent to it; the borders appear properly on the top, bottom, and sides.

Pieces are represented by a serial number and a clockwise list of their four edges (where edges are the letters a..z and 0). Pieces might require rotation when placed in the puzzle.

Given a set of pieces, find at least one way to assemble them into a puzzle. Test data for puzzles with larger R and C are easier to solve because they have a more varied set of edge letters.

奶牛们在玩按字母表顺序排列的拼图谜题.每道谜题有R(1≤R≤10)列C(1≤C≤10)行的拼图块,它们边缘是由字母或封闭边界组成,完成后的整副拼图外围是边界线,中间的边界是字母.

每块拼图块都有一个序列号和4个字母或者数字表示边界线(顺序为上右下左),在输入中,数字充当边界线.

拼图可以换位和旋转,完成后的拼图在边缘的块上靠近外围的是边界线,拼图完成后,一块拼图若与另一块相邻,它们的边界字母必须相同,以下是一系列已经成功完成的拼图谜题共6块.

## 输入格式

\* Line 1: Two space-separated integers: R and C

\* Lines 2..R\*C+1: Each line contains five space-separated entities: an integer serial number and four edge identifiers

## 输出格式

\* Lines 1..R\*C: Line R\*(i-1)+j describes the puzzle piece placed a row i, column j with an integer and five space-separated entities: the serial number of the puzzle piece and the four piece edge identifiers in the order top, right, bottom, left.

## 样例

### 样例输入 #1
```
2 3 
1 c d 0 0 
2 0 d b 0 
3 c 0 d a 
4 b a b 0 
5 d 0 0 e 
6 0 0 b e 

```
### 样例输出 #1
```
1 0 c d 0 
3 0 d a c 
5 0 0 e d 
2 d b 0 0 
4 a b 0 b 
6 e 0 0 b 

```
## 提示

Describes the input puzzle although with some of the pieces rotated compared to the sample solution.


As shown in the diagram in the task text. Other solutions (like reflections) are possible; a grading program will check your answer.



---

---
title: "[USACO09DEC] Bobsledding S"
layout: "post"
diff: 普及+/提高
pid: P2968
tag: ['2009', 'USACO']
---
# [USACO09DEC] Bobsledding S
## 题目描述

Bessie has entered a bobsled competition because she hopes her hefty weight will give her an advantage over the L meter course (2 <= L <= 1,000,000,000).

Bessie will push off the starting line at 1 meter per second, but her speed can change while she rides along the course. Near the middle of every meter Bessie travels, she can change her speed either by using gravity to accelerate by one meter per second or by braking to stay at the same speed or decrease her speed by one meter per second.

Naturally, Bessie must negotiate N (1 <= N <= 100,000) turns on the way down the hill. Turn i is located T\_i meters from the course start (1 <= T\_i <= L-1), and she must be enter the corner meter at a speed of at most S\_i meters per second (1 <= S\_i <= 1,000,000,000). Bessie can cross the finish line at any speed she likes.

Help Bessie learn the fastest speed she can attain without exceeding the speed limits on the turns.

Consider this course with the meter markers as integers and the turn speed limits in brackets (e.g., '[3]'):

```cpp

|   1   2   3   4   5   6   7[3]
|---+---+---+---+---+---+---+
|                            \
Start                         + 8    
                               \
                                + 9    
                                 \
                                  + 10       +++ 14 (finish)
                                   \         /
                              11[1] +---+---+
                                        12  13[8]
```
Below is a chart of Bessie's speeds at the beginning of each meter length of the course:

````
Max:                              3               1       8 
Mtrs: 0   1   2   3   4   5   6   7   8   9  10  11  12  13  14 Spd:  1   2   3   4   5   5   4   3   4   3   2   1   2   3   4 
```
Her maximum speed was 5 near the beginning of meter 4. 

贝茜从山顶滑雪到山脚，山顶到山脚距离是L(2<L<10^9)米.贝茜在起点的速度是1米每 秒，但是他的速度是可以改变的，在每一米的速度可以是前一米的速度加1、减1，或者等于前一米 的速度.在滑行的过程中，贝茜会遇到N<=100000)个转弯处，第i个转弯处位于距离出发 Ti米处，为了安全，贝茜到达第i个转弯处的速度不能超过Si(1<Si<10^9)米 每秒.当然贝茜到达终点时的速度没有最大限制.请你计算贝茜在滑雪过程中最大的速度可以是多 少？

## 输入格式

\* Line 1: Two space-separated integers: L and N

\* Lines 2..N+1: Line i+1 describes turn i with two space-separated integers: T\_i and S\_i

## 输出格式

\* Line 1: A single integer, representing the maximum speed which Bessie can attain between the start and the finish line, inclusive.

## 样例

### 样例输入 #1
```
14 3 
7 3 
11 1 
13 8 

```
### 样例输出 #1
```
5 

```


---

---
title: "[USACO10NOV] Candy S"
layout: "post"
diff: 普及+/提高
pid: P2998
tag: ['2010', 'USACO']
---
# [USACO10NOV] Candy S
## 题目描述

Farmer John knows that Bessie loves to eat candy. FJ has N (1 <= N <= 40,000) candies that he wants to give Bessie over some number of days. Each day, Farmer John gives Bessie a choice of how many candies she chooses to eat that day by choosing the number from a master list FJ supplies that has Nopt (1 <= Nopt <= 50) different options, C\_i (1 <= C\_i <= N). She must take exactly C\_i candies, no more, no less.

Farmer John has also disclosed F (1 <= F <= 50) of his favorite numbers, FN\_i (1 <= FN\_i <= N). Whenever the number of candies remaining at the end of the day precisely matches one of these favorite numbers, Bessie has the option to have him add exactly M (1 <= M <= 100) more candies to the candy supply. Bessie might get another option to add M candies several times if adding candies creates another favorite number. In the best circumstances, Bessie can obtain an infinite amount of candy!

When Bessie cannot choose some amount of candy to take (because there is not enough), and the number of candies remaining is not any of FJ's favorite numbers, she cannot have any more candy.

Unfortunately, Bessie cannot think ahead as far as she'd like to, so she needs your help in order to eat as many candies as possible.

By way of example, consider this scenario:

\* Farmer John's basket initially contains 10 candies

\* Bessie can chose to eat either 3 or 5 candies each day

\* Farmer John will add 1 candy any time the remaining number of candies is 2 or 4

Bessie could use this set of choices to maximize the amount of candy she can eat:

```cpp

                  Initial      # Candies   Remaining     Bonus     Final
        Day      # Candies       Eaten      Candies     Candies   Candies

         1          10             3          7            0        7
         2           7             3          4            1        5
         3           5             3          2            1        3
         4           3             3          0            0        0

```

Total candies eaten = 3 + 3 + 3 + 3 = 12. 

农民约翰知道Bessie喜欢吃糖果。约翰有N（1≤N≤40000）的糖果，他想给Bessie几天。每一天，贝茜从一个列表（有nopt（1 <= nopt <= 50）种不同的选择），选择那一天吃掉刚好C\_i（1 <= c\_i <= N）个糖果。


农民约翰也透露F（1≤f≤50）他最喜欢的数字，FN\_i（1 <= FN\_i <= N）。当当天最后剩下的糖果数量精确匹配其中一个喜欢的号码，Bessie可以让他添加恰好M（1 <= M = 100）个糖果。如果加后得到的个数，还是FJ喜欢的数字，就可以继续添加糖果M个（加几次由贝西决定）。在最好的情况下，Bessie可以吃掉无限量的糖果！


当Bessie不能选择一定量的糖（因为没有足够的），或者糖果的剩余数量不是任何约翰最喜欢的号码，她不能有任何更多的糖果。


不幸的是，Bessie想不出她想做的事，所以她需要你的帮助才能吃尽可能多的糖果。

## 输入格式

\* Line 1: Four space-separated integers: N, Nopt, F, and M

\* Lines 2..Nopt+1: Line i+1 contains a single integer: C\_i

\* Lines Nopt+2..Nopt+F+1: Line i+Nopt+1 contains a single integer: FN\_i

1行：四个整数N，Nopt，F和M

2行。nopt + 1：i+ 1行包含一个整数：c\_i

nopt + 2 .. nopt + F + 1 + 1 + nopt行：行包含一个整数：fn\_i

## 输出格式

\* Line 1: A single integer, denoting the maximum amount of candies Bessie can eat, or -1 if  Bessie can eat an infinite amount of candy.

1行：一个整数，表示Bessie最多可以吃几个。如果Bessie可以无限量吃糖输出-1。

## 样例

### 样例输入 #1
```
10 2 2 1 
3 
5 
4 
2 

```
### 样例输出 #1
```
12 

```
## 提示

感谢@ 王彦梓 提供翻译，kkksc03进行了修正。



---

---
title: "[USACO11JAN] Dividing the Gold S"
layout: "post"
diff: 普及+/提高
pid: P3010
tag: ['2011', 'USACO']
---
# [USACO11JAN] Dividing the Gold S
## 题目描述

Bessie and Canmuu found a sack of N (1 <= N <= 250) gold coins that they wish to divide as evenly as possible. Coin i has value v\_i (1 <= V\_i <= 2,000). The cows would like to split the pile as evenly as they can, but that is not always possible. What is the smallest difference between the values of the two piles?

In addition, the Bessie and Canmuu have found that there might be multiple ways to split the piles with that minimum difference. They would also like to know the number of ways to split the coins as fairly as possible. If it isn't possible to split the piles evenly, Bessie will get the higher-valued pile.

By way of example, consider a sack of five coins of values: 2, 1, 8, 4, and 16. Bessie and Canmuu split the coins into two piles, one pile with one coin worth 16, and the other pile with the remaining coins worth 1+2+4+8=15. Therefore the difference is 16-15 = 1.  This is the only way for them to split the coins this way, so the number of ways to split it evenly is just 1.

Note that same-valued coins can be switched among the piles to increase the number of ways to perform an optimal split. Thus, the set of coins {1, 1, 1, 1} has six different ways to split into two optimal partitions, each with two coins.
## 输入格式

\* Line 1: A single integer: N

\* Lines 2..N+1: Line i+1 contains a single integer: V\_i

## 输出格式

\* Line 1: A single integer that is the smallest difference of two partitions.

\* Line 2: A single integer that is the number of ways to split the coins with the minimum difference printed in line 1. Since this number can get quite large, print the remainder when divided by 1,000,000.

## 样例

### 样例输入 #1
```
5 
2 
1 
8 
4 
16 

```
### 样例输出 #1
```
1 
1 

```
## 题目翻译

Bessie 和 Canmuu 发现了一个有 ***N*** 个金币的袋子(1 <= N <= 250) 。第i个金币有一个价值 ***Vi***
(1 <= Vi <= 2000)他们希望尽可能的把这堆金币平均分配，但有时这是不可能的。找出使两堆价值差最小的分配方案。如果不能完全平均分开，Bessie会获得较高价值那一堆。

举例来说 ： 有一袋5个金币。价值分别是 2,1,8,4,16。
Bessie 和Canmuu把金币分成两堆，第一堆是价值16的金币，另一堆是剩下的1+2+4+8 = 15 个金币，因此，差是1，这是最优分配方案下的唯一分法（即差最小的唯一分法），所以方案数为1。


请你找出 **最小的差值** 以及在这个差值下分配的**方案数。**

输入第一行 N

之后每一行有一个Vi代表第i个金币的价值

输出第一行是最小差值，

第二行是分配方案数 ,由于方案数可能很大，输出***ans mod 1e6***的答案

感谢@ToBiChi 提供翻译


---

---
title: "[USACO11FEB] Cowlphabet G"
layout: "post"
diff: 普及+/提高
pid: P3012
tag: ['2011', 'USACO']
---
# [USACO11FEB] Cowlphabet G
## 题目描述

Like all bovines, Farmer John's cows speak the peculiar 'Cow'

language. Like so many languages, each word in this language comprises a sequence of upper and lowercase letters (A-Z and a-z).  A word is valid if and only if each ordered pair of adjacent letters in the word is a valid pair.

Farmer John, ever worried that his cows are plotting against him, recently tried to eavesdrop on their conversation. He overheard one word before the cows noticed his presence. The Cow language is spoken so quickly, and its sounds are so strange, that all that Farmer John was able to perceive was the total number of uppercase letters, U (1 <= U <= 250) and the total number of lowercase

letters, L (1 <= L <= 250) in the word. 

Farmer John knows all P (1 <= P <= 200) valid ordered pairs of adjacent letters.  He wishes to know how many different valid 

words are consistent with his limited data.  However, since

this number may be very large, he only needs the value modulo

97654321.

约翰家的奶牛用别人听不懂的“牛语”联络。牛语采用英文字母，而且区分大小写。牛 语中的语法中，前后字母的衔接非常重要，存在P个基本组合，每个字母之后只能接固定的 几个字母。 约翰担心奶牛正在密谋反对他，于是最近一直在偷听她们的对话。可是牛语太复杂了， 他只模模糊糊地听到了一个单词，并确定了这个单词中有U个大写字母，L个小写字母。约 翰对这个单词很在意，他想知道，有多少牛语词汇拥有U个大写字母，L个小写字母。由于 这个数字太大了，你只要输出答案取 97654321 的余数就可以了。 输入格式 ? ? 第一行：三个用空格隔开的整数：U，L和P，1 ≤ U, L ≤ 250，1 ≤ P ≤ 200 第二行到P + 1行：第i + 1有两个字母Ai和Bi，表示字母Ai后面可以接Bi，没有一对Ai和 Bi是完全相同的

## 输入格式

\* Line 1: Three space-separated integers: U, L and P

\* Lines 2..P+1: Two letters (each of which may be uppercase or lowercase), representing one valid ordered pair of adjacent letters in Cow.

## 输出格式

\* Line 1: A single integer, the number of valid words consistent with Farmer  John's data mod 97654321.

## 样例

### 样例输入 #1
```
2 2 7 
AB 
ab 
BA 
ba 
Aa 
Bb 
bB 

```
### 样例输出 #1
```
7 

```
## 提示

The word Farmer John overheard had 2 uppercase and 2 lowercase letters.  The valid pairs of adjacent letters are AB, ab, BA, ba, Aa, Bb and bB.


The possible words are:

AabB
ABba
abBA
BAab
BbBb
bBAa
bBbB


---

---
title: "[USACO11MAR] Tree Decoration G"
layout: "post"
diff: 普及+/提高
pid: P3018
tag: ['2011', 'USACO']
---
# [USACO11MAR] Tree Decoration G
## 题目描述

Farmer John is decorating his Spring Equinox Tree (like a Christmas tree but popular about three months later). It can be modeled as a rooted mathematical tree with N (1 <= N <= 100,000) elements, labeled 1...N, with element 1 as the root of the tree. Each tree element e > 1 has a parent, P\_e (1 <= P\_e <= N). Element 1 has no parent (denoted '-1' in the input), of course, because it is the root of the tree.

Each element i has a corresponding subtree (potentially of size 1) rooted there. FJ would like to make sure that the subtree corresponding to element i has a total of at least C\_i (0 <= C\_i <= 10,000,000) ornaments scattered among its members. He would also like to minimize the total amount of time it takes him to place all the ornaments (it takes time K\*T\_i to place K ornaments at element i (1 <= T\_i <= 100)).

Help FJ determine the minimum amount of time it takes to place ornaments that satisfy the constraints.  Note that this answer might not fit into a 32-bit integer, but it will fit into a signed 64-bit integer.

For example, consider the tree below where nodes located higher on the display are parents of connected lower nodes (1 is the root):

```cpp
For example, consider the tree below where nodes located higher on
the display are parents of connected lower nodes (1 is the root):

               1 
               |
               2
               |
               5
              / \
             4   3

Suppose that FJ has the following subtree constraints:

                  Minimum ornaments the subtree requires
                    |     Time to install an ornament
       Subtree      |       |
        root   |   C_i  |  T_i
       --------+--------+-------
          1    |    9   |   3
          2    |    2   |   2
          3    |    3   |   2
          4    |    1   |   4
          5    |    3   |   3

Then FJ can place all the ornaments as shown below, for a total
cost of 20:

            1 [0/9(0)]     legend: element# [ornaments here/
            |                      total ornaments in subtree(node install time)]
            2 [3/9(6)]
            |
            5 [0/6(0)]
           / \
 [1/1(4)] 4   3 [5/5(10)]
```
## 输入格式

\* Line 1: A single integer: N

\* Lines 2..N+1: Line i+1 contains three space-separated integers: P\_i, C\_i, and T\_i

## 输出格式

\* Line 1: A single integer: The minimum time to place all the

ornaments

## 样例

### 样例输入 #1
```
5 
-1 9 3 
1 2 2 
5 3 2 
5 1 4 
2 3 3 

```
### 样例输出 #1
```
20 

```
## 题目翻译

给定一颗以 $1$ 为根的有根树，第 $i$ 个结点的父结点为 $P_i$（$P_1=-1$），在第 $i$ 个结点上挂一个装饰物的代价为 $T_i$，每个结点可以挂任意个。现在给定每棵树子树中至少挂的装饰物个数 $C_i$，求满足要求的最少花费。

$1 \leq n \leq 10^5$，$1 \leq T_i \leq 100$，$1 \leq C_i \leq 10^7$，请注意要开 long long。

### 输入格式

第一行一个整数 $n$。

第 $1$ 行至第 $n$ 行，在第 $i+1$ 行有三个整数，分别表示 $P_i$，$C_i$ 和 $T_i$。

### 输出格式

一行一个整数表示最小花费。

### 样例解释
```
样例中给出的树如下：
               1 
               |
               2
               |
               5
              / \
             4   3

给定如下数据：

                  该子树中所需的装饰物个数
                    |     在该节点挂一个装饰物的花费
                    |       |
       结点编号 |   C_i  |  T_i
       --------+--------+-------
          1    |    9   |   3
          2    |    2   |   2
          3    |    3   |   2
          4    |    1   |   4
          5    |    3   |   3

最佳方案如下：

            1 [0/9(0)]
            |
            2 [3/9(6)]
            |
            5 [0/6(0)]
           / \
 [1/1(4)] 4   3 [5/5(10)]

（格式：[在此处挂的装饰物个数/子树中装饰物总数(在此结点花费代价)]）
```


---

---
title: "[USACO10OCT] Soda Machine G"
layout: "post"
diff: 普及+/提高
pid: P3028
tag: ['2010', 'USACO']
---
# [USACO10OCT] Soda Machine G
## 题目描述

To meet the ever-growing demands of his N (1 &amp;lt;= N &amp;lt;= 50,000) cows, Farmer John has bought them a new soda machine. He wants to figure out the perfect place to install the machine.

The field in which the cows graze can be represented as a one-dimensional number line. Cow i grazes in the range A\_i..B\_i (1 &amp;lt;= A\_i &amp;lt;= B\_i; A\_i &amp;lt;= B\_i &amp;lt;= 1,000,000,000) (a range that includes its endpoints), and FJ can place the soda machine at any integer point in the range 1..1,000,000,000.  Since cows are extremely lazy and try to move as little as possible, each cow would like to have the soda machine installed within her grazing range.

Sadly, it is not always possible to satisfy every cow's desires. Thus FJ would like to know the largest number of cows that can be satisfied.

To demonstrate the issue, consider four cows with grazing ranges 3..5, 4..8, 1..2, and 5..10; below is a schematic of their grazing ranges:

```cpp

         1   2   3   4   5   6   7   8   9  10  11  12  13
         |---|---|---|---|---|---|---|---|---|---|---|---|-...
                 aaaaaaaaa
                     bbbbbbbbbbbbbbbbb
         ccccc           ddddddddddddddddddddd
```
As can be seen, the first, second and fourth cows share the point 5, but the third cow's grazing range is disjoint.  Thus, a maximum of 3 cows can have the soda machine within their grazing range.


有N个人要去膜拜JZ，他们不知道JZ会出现在哪里，因此每个人有一个活动范围，只要JZ出现在这个范围内就能被膜拜，

伟大的JZ当然希望膜拜他的人越多越好，但是JZ不能分身，因此只能选择一个位置出现，他最多可以被多少人膜拜呢，

这个简单的问题JZ当然交给你了

## 输入格式

\* Line 1: A single integer: N

\* Lines 2..N+1: Line i+1 contains two space-separated integers: A\_i and B\_i

## 输出格式

\* Line 1: A single integer representing the largest number of cows whose grazing intervals can all contain the soda machine.

## 样例

### 样例输入 #1
```
4 
3 5 
4 8 
1 2 
5 10 

```
### 样例输出 #1
```
3 

```
## 提示

If the soda machine is placed at location 5, cows 1, 2, and 4 can be satisfied. It is impossible to satisfy all four cows.

## 题目翻译

**为了满足fj所有的N(1<=n<=50000)头奶牛的需求，fj新买了一台汽水机。他想找到一个最完美的位置来安放它。**

**奶牛的牧场可以被表示为一个一维数轴，第i个奶牛被放牧的区间是[Ai...Bi]（包含端点），fj可以把汽水机放在[1..1,000,000,000]。**

**因为奶牛们都懒得要死，她们想尽可能的少移动。她们希望汽水机被放在自己的放牧区间内。**

**遗憾的是，fj并不总能满足所有奶牛的要求，所以他想请你帮忙算出他能满足的奶牛数目**


---

---
title: "[USACO12MAR] Landscaping S"
layout: "post"
diff: 普及+/提高
pid: P3049
tag: ['2012', 'USACO']
---
# [USACO12MAR] Landscaping S
## 题目背景

*本题与 [2016 年公开赛白金组同名题目](/problem/P2748) 在题意上一致，唯一的差别是数据范围。*
## 题目描述

Farmer John 打算修建一座花园，他需要移动不少泥土。

花园由 $N$ 个花坛组成（$1 \leq N \leq 100$），其中花坛 $i$ 包含 $A_i$ 单位的泥土。FJ 希望花坛 $i$ 包含 $B_i$ 单位的泥土，保证 $0 \leq A_i,B_i \leq 10$。

为了达到这个目标，他可以做这几件事情：

- 购买一单位的泥土，放在指定的花坛中，费用为 $X$。
- 从任意一个花坛中移走一单位泥土，费用为 $Y$。
- 从花坛 $i$ 运送一单位泥土到花坛 $j$，费用为 $Z|i-j|$。

请你帮 FJ 计算移动泥土的最小开销。
## 输入格式

第一行四个整数 $N,X,Y,Z$（$0 \leq X,Y,Z \leq 1000$）。

接下来 $N$ 行，第 $i$ 行两个整数 $A_i,B_i$。
## 输出格式

输出移动泥土的最小开销。
## 样例

### 样例输入 #1
```
4 100 200 1 
1 4 
2 3 
3 2 
4 0 

```
### 样例输出 #1
```
210 

```
## 提示

按下面的方案，最小花费为 $210$，可以证明不存在开销更小的方案。

- 移除 $4$ 号花坛的一单位泥土，花费 $200$。
- 将 $4$ 号花坛的三单位泥土移到 $1$ 号花坛，花费 $3 \times 3=9$。
- 将 $3$ 号花坛的一单位泥土移到 $2$ 号花坛，花费 $1 \times 1=1$。


---

---
title: "[USACO12OPEN] Running Laps S"
layout: "post"
diff: 普及+/提高
pid: P3054
tag: ['2012', 'USACO']
---
# [USACO12OPEN] Running Laps S
## 题目描述

Bored with horse racing, Farmer John decides to investigate the feasibility of cow racing as a sport.  He sets up his N cows (1 <= N <= 100,000) to run a race of L laps around a circular track of length C.  The cows all start at the same point on the track and run at different speeds, with the race ending when the fastest cow has run the total distance of LC.

FJ notices several occurrences of one cow overtaking another, and wonders how many times this sort of "crossing event" happens during the entire race.  More specifically, a crossing event is defined by a pair of cows (x,y) and a time t (less than or equal to the ending time of the race), where cow x crosses in front of cow y at time t.  Please help FJ count the total number of crossing events during the entire race.

有n头牛要在长为c的跑道上跑l圈，每头牛有一个速度s\_i. 某头牛跑完时，所有的牛都停下来，问此之前发生了多少次超越。

## 输入格式

\* Line 1: Three space-separated integers: N, L, and C.  (1 <= L,C <= 25,000).

\* Lines 2..1+N: Line i+1 contains the speed of cow i, an integer in the range 1..1,000,000.

## 输出格式

\* Line 1: The total number of crossing events during the entire race.

## 样例

### 样例输入 #1
```
4 2 100 
20 
100 
70 
1 

```
### 样例输出 #1
```
4 

```
## 提示

There are 4 cows running 2 laps on a circular track of length 100.  The speeds of the cows are 20, 100, 70, and 1.


The race lasts 2 units of time, since this is the time it takes the fastest cow (cow 2) to finish.  Within that time, there are 4 crossing events: cow 2 overtakes cows 1 and 4, and cow 3 overtakes cows 1 and 4.

## 题目翻译

# 题目描述
 农夫约翰让他的 n （1 <= n <= 100,000） 头牛在长度为 c 的跑道上进行跑 l 圈的比赛，所有牛从同一起点，以不同的速度开始跑。直到当跑得最快的那一头牛跑完 l 圈时，所有牛才同时停下。

  约翰发现在跑圈过程中发生了几次“超越事件”。其定义是：在比赛结束前某时刻，奶牛 x 已经超越了奶牛 y **整整一圈**，则称做一次“超越事件”。（注： **至少一圈** ，超越了1/2圈，或者超越了1/4圈等等都不算。且对于同一对奶牛（x，y）不会重复计算次数。）

 约翰想知道比赛过程中发生了多少次“超越事件”。

 （注：可能原文章表达有误或某些其他原因，各种翻译方式过来的题意都有问题，给人误导很大，这里是根据题目数据和样例解释写的正确的题意，而不是原文）

## 输入格式：
第一行：三个整数：n，l，c（1 <= l,c <= 25,000)

第二行到第 n+1 行：每行一个整数 vi ，表示奶牛i的速度（1 <= vi <= 1,000,000）

## 输出格式：
第一行：一个整数，表示总共发生的“超越事件”的次数

感谢@远藤沙椰 提供的翻译


---

---
title: "[USACO12NOV] Distant Pastures S"
layout: "post"
diff: 普及+/提高
pid: P3057
tag: ['2012', 'USACO']
---
# [USACO12NOV] Distant Pastures S
## 题目描述

Farmer John's farm is made up of an N x N grid of pastures, where each pasture contains one of two different types of grass.  To specify these two types of grass, we use the characters ( and ), so for example FJ's farm might look like the following grid:

(()) 
)()( 
)((( 
))))
When Bessie the cow travels around the farm, it takes her A units of time to move from a pasture to an adjacent pasture (one step north, south, east, or west) with the same grass type, or B units of time to move to an adjacent pasture with a different grass type.  Whenever Bessie travels from one pasture to a distant pasture, she always uses a sequence of steps that takes the minimum amount of time.  Please compute the greatest amount of time Bessie will ever need to take while traveling between some pair of pastures on the farm.

给出一个n\*n的括号矩阵，从一个点走到相邻的同字符点需付出A的代价，到不同字符点需付出B的代价。求所有点对之间最短路的最大值。

## 输入格式

\* Line 1: Three integers: N (1 <= N <= 30), A (0 <= A <= 1,000,000), and B (0 <= B <= 1,000,000).

\* Lines 1..N+1: Each line contains a string of parentheses of length N.  Collectively, these N lines form an N x N grid of

parentheses.

## 输出格式

\* Line 1: A single integer specifying the maximum amount of time Bessie can spend traveling between a pair of pastures (given that she always follows a route that takes a minimum amount of time).

## 样例

### 样例输入 #1
```
3 1 2 
((( 
()( 
(() 

```
### 样例输出 #1
```
5 

```
## 提示

It takes Bessie 5 units of time to travel between the upper-left corner and the lower-right corner of the grid.  No other pair of pastures causes her to travel for more time than this.



---

---
title: "[USACO12NOV] Balanced Cow Breeds G/S"
layout: "post"
diff: 普及+/提高
pid: P3058
tag: ['2012', 'USACO']
---
# [USACO12NOV] Balanced Cow Breeds G/S
## 题目描述

Farmer John usually brands his cows with a circular mark, but his branding iron is broken, so he instead must settle for branding each cow with a mark in the shape of a parenthesis -- (.  He has two breeds of cows on his farm: Holsteins and Guernseys.  He brands each of his cows with a

parenthesis-shaped mark.  Depending on which direction the cow is facing, this might look like either a left parenthesis or a right parenthesis.

FJ's N cows are all standing in a row, each facing an arbitrary direction, so the marks on the cows look like a string of parentheses of length N. Looking at this lineup, FJ sees a remarkable pattern: if he scans from left to right through just the Holsteins (in the order they appear in the sequence), this gives a balanced string of parentheses; moreover, the same is true for the Guernseys!  To see if this is truly a rare event, please help FJ compute the number of possible ways he could assign breeds to his N cows so that this property holds.

There are several ways to define what it means for a string of parentheses to be "balanced".  Perhaps the simplest definition is that there must be the same total number of ('s and )'s, and for any prefix of the string, there must be at least as many ('s as )'s.  For example, the following strings are all balanced:

() 
(()) 
()(()()) 

while these are not:

)( 
())( 
((()))) 

给一个只有左右括号的字符串，然后用 `H`、`G` 两种字符来标记这个序列，所有标记 `H` 的括号可以组成一个正确的括号序列，所有 `G` 标记的括号也组成一个正确的括号序列，然后输出这种标记方案的总数 $\operatorname{mod} 2012$ 的值。
## 输入格式

\* Line 1: A string of parentheses of length N (1 <= N <= 1000).

## 输出格式

\* Line 1: A single integer, specifying the number of ways FJ can assign breeds to cows so that the Holsteins form a balanced subsequence of parentheses, and likewise for the Guernseys. Since the answer might be a very large number, please print the remainder of this number when divided by 2012 (i.e., print the number mod 2012).  Breed assignments involving only one breed type are valid.

## 样例

### 样例输入 #1
```
(()) 

```
### 样例输出 #1
```
6 

```
## 提示

The following breed assignments work:

(()) 
HHHH
(()) 
GGGG
(()) 
HGGH
(()) 
GHHG
(()) 
HGHG
(()) 
GHGH
 
感谢@CREEPER\_ 提供翻译



---

---
title: "[USACO13MAR] The Cow Run G/S"
layout: "post"
diff: 普及+/提高
pid: P3080
tag: ['2013', 'USACO']
---
# [USACO13MAR] The Cow Run G/S
## 题目描述

Farmer John has forgotten to repair a hole in the fence on his farm, and his N cows (1 <= N <= 1,000) have escaped and gone on a rampage! Each minute a cow is outside the fence, she causes one dollar worth of damage. FJ must visit each cow to install a halter that will calm the cow and stop the damage.

Fortunately, the cows are positioned at distinct locations along a straight line on a road outside the farm. FJ knows the location P\_i of each cow i (-500,000 <= P\_i <= 500,000, P\_i != 0) relative to the gate (position 0) where FJ starts.

FJ moves at one unit of distance per minute and can install a halter instantly. Please determine the order that FJ should visit the cows so he can minimize the total cost of the damage; you should compute the minimum total damage cost in this case.

农夫约翰的牧场围栏上出现了一个洞，有 $N$（$1\le N\le 1000$）只牛从这个洞逃出了牧场。这些出逃的奶牛很狂躁，他们在外面到处搞破坏，每分钟每头牛都会给约翰带来 $1$ 美元的损失。约翰必须用缰绳套住所有的牛，以停止他们搞破坏。

幸运的是，奶牛们都在牧场外一条笔直的公路上，牧场的大门恰好位于公里的 $0$ 点处。约翰知道每头牛距离牧场大门的距离 $P_i$（$-5\times10^5\le P_i\le5\times 10^5$，$P_i\ne0$）。

约翰从农场大门出发，每分钟移动一个单位距离，每到一头牛所在的地点，约翰就会给它套上缰绳，套缰绳不花时间。按怎样的顺序去给牛套缰绳才能使约翰损失的费用最少？
## 输入格式

\* Line 1: The number of cows, N.

\* Lines 2..N+1: Line i+1 contains the integer P\_i.

## 输出格式

\* Line 1: The minimum total cost of the damage.

## 样例

### 样例输入 #1
```
4 
-2 
-12 
3 
7 

```
### 样例输出 #1
```
50 

```
## 提示

Four cows placed in positions: -2, -12, 3, and 7.


The optimal visit order is -2, 3, 7, -12. FJ arrives at position -2 in 2 minutes for a total of 2 dollars in damage for that cow.

He then travels to position 3 (distance: 5) where the cumulative damage is 2 + 5 = 7 dollars for that cow.

He spends 4 more minutes to get to 7 at a cost of 7 + 4 = 11 dollars for that cow.

Finally, he spends 19 minutes to go to -12 with a cost of 11 + 19 = 30 dollars.

The total damage is 2 + 7 + 11 + 30 = 50 dollars. 




---

---
title: "Cool loves maids"
layout: "post"
diff: 普及+/提高
pid: P3361
tag: ['洛谷原创']
---
# Cool loves maids
## 题目背景

Cool 非常喜欢妹子，以至于 Cool 在百度上有一个非常神奇的 ID 【雾】。
## 题目描述

Cool 现在搞清楚了女生宿舍的地形。女生宿舍是由很多栋楼构成的，它们可以被抽象成 $20\times 20$ 的方格。

Cool 的妹子们所处的地方可以被表示为实数类型的坐标。当一个妹子 $(x,y)$ 在楼 $(i,j)$ 中，当且仅当 $i \le x<i+1$，$j \le y<j+1$，$i,j\in \Z$。两个妹子之间有距离，当且仅当一个妹子所在的楼的横纵坐标均小于另一个妹子所在的楼，此时她们之间的距离为她们自身坐标的曼哈顿距离。

现在 Cool 要搞一个大统计：求 $n$ 个妹子之间所有距离之和。
## 输入格式

为了避免输入文件过大无法上传在读入方面消耗过多时间，本题采取数据生成方案。

输入包含两行：

- 第一行，一个整数 $n$；
- 第二行，包含 $6$ 个整数 $\mathrm{rxa},\mathrm{rxc},\mathrm{rya},\mathrm{ryc},\mathrm{rza},\mathrm{rzc}$。

所有的实数都采用如下方式生成：

1. 初始化 $x=y=z=0$；
2. 重复以下过程：  
   - $x=(y\times \mathrm{rxa}+\mathrm{rxc})\bmod \mathrm{rp}$；
   - $y=(z\times \mathrm{rya}+\mathrm{ryc})\bmod \mathrm{rp}$；
   - $z=(x\times \mathrm{rza}+\mathrm{rzc})\bmod \mathrm{rp}$。

每次得到的实数即为 $(x\bmod 20)+(y\bmod 10)\div 10+(z\bmod 10)\div 100$。$\mathrm{rp}=2333333$。

第 $i$ 个妹子将以第 $2i-1$ 个生成实数为横坐标，第 $2i$ 个生成实数为纵坐标。
## 输出格式

输出包含一行一个实数，表示 $n$ 个妹子之间所有距离之和的平均值，保留 $5$ 位小数。

## 样例

### 样例输入 #1
```
6
3 5 7 11 13 17
```
### 样例输出 #1
```
17.52167
```
## 提示

### 数据范围及约定

对于全部数据，保证 $1\le n\le 5\times 10^6$。


---

---
title: "[POI 2006] MIS-Teddies"
layout: "post"
diff: 普及+/提高
pid: P3448
tag: ['2006', 'POI（波兰）']
---
# [POI 2006] MIS-Teddies
## 题目描述

Byteoian 是一家专业生产儿童玩具的公司。他们生产的玩具质量上乘，广受好评。

但最近，有人发现他们生产的泰迪熊存在致命缺陷。总共有四种泰迪熊型号：$A1$，$A2$，$B1$，$B2$，一旦将三个字母相同或数字相同的泰迪熊放在一块，就会对泰迪熊造成致命损坏。

如果一种摆放泰迪熊的方案中不存在连续三个字母相同或数字相同的泰迪熊，则称这种摆放方案是**安全的**。

现在你收集了一些泰迪熊，你想要知道有多少种安全的摆放泰迪熊的方案。由于安全的方案可能较多，请输出方案数对 $1\,000\,000$ 取模的结果。
## 输入格式

输入包含四个整数：$n_{A1},n_{A2},n_{B1},n_{B2}$，分别代表 $A1$ 型，$A2$ 型，$B1$ 型，$B2$ 型泰迪熊的数量。
## 输出格式

输出一个整数，即安全摆放泰迪熊的方案数对 $1\,000\,000$ 取模的结果。
## 样例

### 样例输入 #1
```
0 1 2 1
```
### 样例输出 #1
```
6
```
## 提示

$0 \leq n_{A1},n_{A2},n_{B1},n_{B2} \leq 38$。


---

---
title: "[POI 2013] LAN-Colorful Chain"
layout: "post"
diff: 普及+/提高
pid: P3560
tag: ['2013', 'POI（波兰）']
---
# [POI 2013] LAN-Colorful Chain
## 题目描述

Little Bytie loves to play with colorful chains.

He already has quite an impressive collection, and some of them he likes    more than the others.

Each chain consists of a certain number of colorful links.

Byteasar has noticed that Bytie's sense of aesthetics is very precise.

It turns out that Bytie finds a contiguous fragment of a chain nice if    it contains exactly    ![](http://main.edu.pl/images/OI20/lan-en-tex.1.png) links of color ![](http://main.edu.pl/images/OI20/lan-en-tex.2.png) links of color ![](http://main.edu.pl/images/OI20/lan-en-tex.3.png) links of color ![](http://main.edu.pl/images/OI20/lan-en-tex.4.png),    and moreover it contains no links of other colors.

A chain's appeal is its number of (contiguous) fragments that are nice.

By trial and error, Byteasar has determined the values ![](http://main.edu.pl/images/OI20/lan-en-tex.5.png) and ![](http://main.edu.pl/images/OI20/lan-en-tex.6.png).

Now he would like to buy a new chain, and therefore asks you to write a program to aid him in shopping.

给定一个长度为 $n$ 的序列 $a$ 和 $m$ 个条件（每个条件中包含键 $c_i$ 和值 $l_i$），要求找出满足下列条件的子串的数量并输出：

 + 条件中存在键 $c_i$ 的，要求子串中 $c_i$ 恰好出现 $l_i$ 次。

 + 条件中不存在键 $c_i$ 的，要求子串中不出现 $c_i$。

先输入 $n$ 和 $m$，再输入 $m$ 个条件的 $l_i$，然后输入 $m$ 个条件的 $c_i$，最后输入 $a_i$。
## 输入格式

The first line of the standard input gives two integers, ![](http://main.edu.pl/images/OI20/lan-en-tex.7.png) and ![](http://main.edu.pl/images/OI20/lan-en-tex.8.png)      (![](http://main.edu.pl/images/OI20/lan-en-tex.9.png)), separated by a single space.

These are the length of the chain and the length of a nice fragment's description.

The second line gives ![](http://main.edu.pl/images/OI20/lan-en-tex.10.png) integers, ![](http://main.edu.pl/images/OI20/lan-en-tex.11.png) (![](http://main.edu.pl/images/OI20/lan-en-tex.12.png)),      separated by single spaces.

The third line gives ![](http://main.edu.pl/images/OI20/lan-en-tex.13.png) integers, ![](http://main.edu.pl/images/OI20/lan-en-tex.14.png)      (![](http://main.edu.pl/images/OI20/lan-en-tex.15.png), ![](http://main.edu.pl/images/OI20/lan-en-tex.16.png) for ![](http://main.edu.pl/images/OI20/lan-en-tex.17.png)), also separated by single spaces.

The sequences ![](http://main.edu.pl/images/OI20/lan-en-tex.18.png) and ![](http://main.edu.pl/images/OI20/lan-en-tex.19.png) define a nice fragment of a chain - it has to contain exactly ![](http://main.edu.pl/images/OI20/lan-en-tex.20.png) links of color ![](http://main.edu.pl/images/OI20/lan-en-tex.21.png).

The fourth line gives ![](http://main.edu.pl/images/OI20/lan-en-tex.22.png) integers, ![](http://main.edu.pl/images/OI20/lan-en-tex.23.png) (![](http://main.edu.pl/images/OI20/lan-en-tex.24.png)),      separated by single spaces, that are the colors of successive links of      the chain.

In tests worth 50% of total points the constraint ![](http://main.edu.pl/images/OI20/lan-en-tex.25.png) holds in addition.

## 输出格式

Your program is to print a single integer, the number of nice contiguous    fragments in the chain, to the first and only line of the standard output.

## 样例

### 样例输入 #1
```
7 3
2 1 1
1 2 3
4 2 1 3 1 2 5

```
### 样例输出 #1
```
2

```
## 提示



### 数据范围：

对于 $100\%$ 的数据，$1\leq m\leq n \leq 10^6$，$1\leq a_i,b_i,c_i\leq n$。


---

---
title: "语言普查"
layout: "post"
diff: 普及+/提高
pid: P3752
tag: ['洛谷原创']
---
# 语言普查
## 题目背景

Yugo国的人民在进行一次人口普查，由于Yugo国是典型的多民族国家，所以拥有许多种语言。

## 题目描述

“Kiaosmaonsnai Assi fi wais

"Kjamqosoaksi mais pas?"

"Oci! Asia olo mnai naso!"

"2333在说什么啊根本听不懂。。。”

这是Yugo国的日常。。。

Yugo国有许多不同的种族，这些不同的种族不同的语言，但是主席扔给了你几本字典，这样，你就知道他们在说什么语了。你的任务就是判断他们在说什么语并填上户口本（？）。

## 输入格式

第一行输入N（1≤N≤100），不同语种的数量。

下一个N行依次包含该语言的名称，后跟该语言中的一个或多个单词，词和词之间用空格隔开。

后面跟一个空行。

之后许多（<1000）行，你需要确定合适的语言。语句是不间断的字符串的大写或小写字母，出现“\" 、"-"或“‘”视为一个单词。没有一个单词会出现在两种或以上语言中。

每行短于256个字符。最多会有1000行的示例文本。

每个示例文本将包含至少一个来自一种语言的单词。示例文本不包含来自多种族语言的单词。示例文本可能包含附加标点符号"." "," "?" "!" ";""("")"、空格和换行，这些符号作为分隔符分隔单词。示例文本可能包含在上面没出现过的单词。

单词匹配不区分大小写。

## 输出格式

输出每行对应的语言。

## 样例

### 样例输入 #1
```
4
Qzrian yy ghy qzr
Yugoslavian mihailova petrozavodsk saint-petersburg
Suissvia yugoslavia korse mais kohnin
Mohaian Jzm Wallace Zhangbaohua djh 

yy,qzr and ghy are i don't know
mihailova saZk amOmlio
mais c'est pas Ca
wallace is good

```
### 样例输出 #1
```
Qzrian
Yugoslavian
Suissvia
Mohaian


```


---

---
title: "国事访问"
layout: "post"
diff: 普及+/提高
pid: P3753
tag: ['洛谷原创']
---
# 国事访问
## 题目背景

这是战火纷飞的2333年，世界被分为XC联盟和WJ联盟，两个联盟互相开火。

## 题目描述

这是战火纷飞的2333年，世界被分为XC联盟和WJ联盟，两个联盟互相开火。Q国总统ZR想到Yugo国进行十分紧急的国事访问，但不能坐飞机，只能坐车。由于路上有许多不同的国家而且有些无政府国，所以有许多路是坏的。路没有从自己通向自己的（作死吗。。。）。你需要确定一条具体的路线，并且由于WJ联盟的人随时可能过来，你需要把这条路线经过的所有城市周围的其他路都毁掉。你是上帝视角，你需要帮助ZR总统到达Yugo，你可以毁掉一些原本是好的路，也可以把坏的路修好，但不能新修路。给你一份地图，地图上，ZR国坐落在1城，Yugo首都在n城。帮助ZR总统尽快到达Yugo，你可以获得ZR总统在WJ联邦银行的30亿存款和1000万人的军队，和ZR总统一起瓜分地球（以上是诈骗内容。。。）。

## 输入格式

第一行，n，m，（2<=n<=1000,0<=m<=1000），n是Yugo首都，m是公路数量。

第2至m+1行，a，b，c，a是公路起始城市，b是公路结束城市，c是路的情况（1：能通行/0：不能通行）。

## 输出格式

第一行，k，需要改变路状态的最小数量。

## 样例

### 样例输入 #1
```
4 4
1 2 1
1 3 0
2 3 1
3 4 1
```
### 样例输出 #1
```
3

```
## 提示

把 1 2 1 路径变成不可用

把 1 3 0 路径变成可用

把 2 3 1 路径变成不可用

即可


---

---
title: "[TJOI2007] 圆"
layout: "post"
diff: 普及+/提高
pid: P3844
tag: ['2007', '各省省选', '天津']
---
# [TJOI2007] 圆
## 题目描述

平面上有 n 个圆，任意两个不同的圆之间只有相离（可以外切）和包含（可以内切）两

种关系。初始时整个平面是黑色的，我们按照输入给定的顺序在平面上画出这些圆，我们画

一个圆的时候，把这个圆覆盖的区域全部反色，即如果区域中的一个点原来是黑色，则将它

涂为白色；如果这个点原来是白色，则将它涂成黑色。

按照这个步骤把所有的圆都画出来后，请输出平面上的所有白色区域的面积之和。

## 输入格式

输入文件的第一行有一个整数 n，表示圆的个数。以下 n 行，每行用三个整数 x, y 和 r

描述一个圆，表示圆心(x, y)和半径 r。在平面上画圆的顺序和输入给定的顺序相同。

## 输出格式

你只需要向输出文件输入一个实数，精确到小数点后两位，表示平面上白色区域面积之

和。
## 样例

### 样例输入 #1
```
3
0 0 5
0 1 2
10 10 1
```
### 样例输出 #1
```
69.12
```
## 提示

100%的数据中，n ≤ 100，对于所有的圆，|x|, |y|, r ≤ 1 000。



---

---
title: "[TJOI2009] 火星人的手机"
layout: "post"
diff: 普及+/提高
pid: P3860
tag: ['2009', '各省省选', '天津']
---
# [TJOI2009] 火星人的手机
## 题目背景

你应火星人之邀为他们设计一款新型的手机。我们知道在标准的地球人手机上，数字键共有 $10$ 个，$26$ 个字母 `a`…`z` 分别与某个数字键相关联，并且一个数字键上的若干字母必须是字母表中连续的一段。比如下图是地球手机的一个标准方案：

![](https://cdn.luogu.com.cn/upload/pic/6103.png)

## 题目描述

我们要输入一个字母，必须连续按它所在的数字键若干次，次数即为这个字母在这个键的第几个位置。例如在上图的方案中，若我们要输入 `C`，就需要按三次数字键 `2`；若要输入 `M`，需按一次数字键 `6`。

火星人手机的构造与地球人手机类似，上面有 $M$ 个火星数字键，你需要把火星文的 $N$ 个字母放置在这 $M$ 个键上。（同样要求一个数字键上必须是连续的若干个火星字母）现在给定一段火星文中各个字母的出现次数，你设计的手机必须使得输入这段文字所需的按键次数最少。

## 输入格式

输入文件的第一行包括两个数字 $N$ 和 $M$，分别表示火星文字母数和火星手机的按键数。接下来有 $N$ 行，每行包含一个数字，依次表示每个字母在文章中的出现次数。这个次数不超过 $1000$。

## 输出格式

输出文件的第一行包括一个数字，表示最少的按键次数。

接下来的 $M$ 行表示一种设计方案：每行包含一个数，依次表示每个数字键上有几个火星字母。（这些数字可以为 $0$）

如果有多种方案可以得到最少的按键次数，你需要输出第一个数字键上包含字母最少的方案；如果仍有多种方案，你需要在其中选择第二个数字键上字母最少的方案；依此类推。

## 样例

### 样例输入 #1
```
3 2
100
200
300

```
### 样例输出 #1
```
800
2
1

```
## 提示

### 数据范围及约定

对于 $100\%$ 的数据，$1\le N \le 500$，$1 \le M \le 100$。



---

---
title: "SAC E#1 - 一道神题 Sequence1"
layout: "post"
diff: 普及+/提高
pid: P3929
tag: ['洛谷原创', '洛谷月赛']
---
# SAC E#1 - 一道神题 Sequence1
## 题目背景

小强和阿米巴是好朋友。

## 题目描述

小强很喜欢数列。有一天，他心血来潮，写下了一个数列。

阿米巴也很喜欢数列。但是他只喜欢其中一种：波动数列。

一个长度为 $n$ 的波动数列满足对于任何 $i\ (1 \le i < n)$，均满足以下两个条件至少一个：

- $a_{2i-1} \le a_{2i}$ 且 $a_{2i} \ge a_{2i+1}$（若存在）。
- $a_{2i-1} \ge a_{2i}$ 且 $a_{2i} \le a_{2i+1}$（若存在）。

阿米巴把他的喜好告诉了小强。小强便打算稍作修改，以让这个数列成为波动数列。他想知道，能否通过仅修改一个数（或不修改），使得原数列变成波动数列。

## 输入格式

输入包含多组数据。

每组数据包含两行：

- 第一行一个整数 $n$ 表示数列的长度。
- 接下来一行，$n$ 个整数，表示一个数列。

## 输出格式

对于每一组输入，输出一行 `Yes` 或 `No`，含义如题目所示。

## 样例

### 样例输入 #1
```
5
1 2 3 2 1
5
1 2 3 4 5

```
### 样例输出 #1
```
Yes
No
```
## 提示

### 数据范围及约定

- 对于 $30\%$ 的数据，$1\le n \le 10$。
- 对于另外 $30\%$ 的数据，$1\le m \le 1000$。
- 对于 $100\%$ 的数据，$1\le n \le 10^5$，$m \le 10^9$。

其中 $m = \max|a_i|$（数列中绝对值的最大值）



---

---
title: "[PA 2014] Bohater"
layout: "post"
diff: 普及+/提高
pid: P4025
tag: ['2014', 'Special Judge', 'PA（波兰）']
---
# [PA 2014] Bohater
## 题目描述

在一款电脑游戏中，你需要打败 $n$ 只怪物（从 $1$ 到 $n$ 编号）。

为了打败第 $i$ 只怪物，你需要消耗 $d_i$ 点生命值，但怪物死后会掉落血药，使你恢复 $a_i$ 点生命值。

任何时候你的生命值都不能降到 $0$（或 $0$ 以下）。

请问是否存在一种打怪顺序，使得你可以打完这 $n$ 只怪物而不死掉。
## 输入格式

第一行两个整数 $n,z$，分别表示怪物的数量和你的初始生命值。

接下来 $n$ 行，每行两个整数 $d_i,a_i$。
## 输出格式

第一行为 `TAK`（是）或 `NIE`（否），表示是否存在这样的顺序。

如果第一行为 `TAK`，则第二行为空格隔开的 $1\sim n$ 的排列，表示合法的顺序。

如果答案有很多，你可以输出其中任意一个。（**本题使用 SPJ**）
## 样例

### 样例输入 #1
```
3 5
3 1
4 8
8 3
```
### 样例输出 #1
```
TAK
2 3 1 
```
## 提示

对于 $100\%$ 的数据，$1\le n,z\le 10^5$，$0\le d_i,a_i\le 10^5$。


---

---
title: "[Code+#2] 化学狂暴"
layout: "post"
diff: 普及+/提高
pid: P4029
tag: ['Code+']
---
# [Code+#2] 化学狂暴
## 题目背景

在那遥远的钦钦草原，住着 Yazid 和 YJQQQAQ，他们都是炼金术士。


一般而言，题目背景总是没有用的，但这道题是个例外。在这里，我们将严谨地介绍钦钦草原世界化学学科的一些基本知识。如果你对这些内容感到枯燥乏味，你也可以跳过这个部分，直接阅读题目描述中的简述并结合样例来帮助你更快地理解题目。


钦钦草原的世界里共有 $26$ 种元素，分别用大写字母A至Z表示。


钦钦草原世界中的物质由元素构成，对于任意的物质，每种元素的出现次数都是非负整数，且至少有 $1$ 种物质的出现次数为正整数，我们把每种元素在物质中的出现次数称作该元素在该物质中的下标。我们可以按A到Z的顺序写下每种元素及其下标来描述一个物质。这是一个例子：`A0B0C0D0E0F0G0H0I0J1K0L0M0N0O0P0Q1R0S0T0U0V0W0X0Y2Z0`。这个例子描述了一种 J、Q 各出现 $1$ 次，Y 出现 $2$ 次的物质。


然而，这种描述方法实在是太麻烦了，于是钦钦草原世界中的炼金术士们便尝试简化物质的描述。对于某种物质，我们定义“虚无元素”表示在该物质中下标为 $0$ 的元素，“单一元素”表示在该物质中下标为 $1$ 的元素。针对这两个定义，炼金术士们提出了两种化简方式：


省略“虚无元素”：将“虚无元素”的字母和下标省略。如上面的物质可以通过该操作化简为：`J1Q1Y2`。

省略“单一元素”的下标：将“单一元素”的下标省略。如上面的物质可以通过该操作化简为：`A0B0C0D0E0F0G0H0I0JK0L0M0N0O0P0QR0S0T0U0V0W0X0Y2Z0`。


特别地，对于同时省略了“虚无元素”和“单一元素”下标的表示，我们把它叫做该物质的“最简式”。如上面物质的“最简式”即为：`JQY2`。


由于钦钦草原世界的化学研究仍处于起步阶段，因此对于任意的物质，所有元素下标均为不超过 $9$ 的非负整数。


化学方程式是描述化学反应的式子。一个化学方程式包含恰好一个等号（=），等号两边是由加号（+）连接的若干物质。形象地说，它的形式是这样的：

```
物质+物质+…+物质=物质+物质+…+物质
```
除了需要满足上述格式外，元素守恒也是不可忽视的。这表示等号两边所有元素在各物质中的出现次数总和必须相等。比如，这就是一个合法的（格式正确、元素守恒的）化学方程式：

```
JQY2+J2=J3QY2
```
需要特别注意的是，在化学方程式的书写中，未被化至“最简式”的元素也是可以被接受的。例如，下面的化学方程式也是合法的：

```
JQY2+J2=JQY
```
而下面这个化学方程式就不是合法的了，因为它并没有满足元素守恒。

```
JQY2+J2=JQY
```
钦钦草原化学学科的基本知识就介绍到这。祝各位选手武运昌隆！

## 题目描述

所谓化学方程式，即是用加号（+）和等号（=）连接一些化学物质的式子。保证一个化学方程式中含有恰好一个等号（=）。化学物质由一些元素（用大写字母A至Z表示）加上下标（保证下标为不超过 $9$ 的非负整数）连接而成的。例如：`JQY2`、`A0J1QY2` 等。书写时需要保证字典序越小的字母排在越前面。


需要注意的是，像 `A0J1QY2` 这样的物质书写同样是合法的，虽然事实上它和 `JQY2` 是等价的。我们把下标为 $1$ 的元素称为“单一元素”，把下标为 $0$ 的元素称为“虚无元素”。在书写一种物质时，我们既可以省去“单一元素”的下标，又可以直接省去“虚无元素”。特别地，我们把用这两种规则省略至最简的书写称为该物质的“最简式”。例如，`JQY2` 就是 `A0J1Q1Y2` 的最简式。


既然称之为“方程式”，元素守恒就是必须的了。对于一个化学方程式，元素守恒指的是指等号两边所有元素的下标之和相等。比如，这个化学方程式就是元素守恒的：

```
JQY2+J2=J3QY2
```
而这个化学方程式就是不合法的，因为它不满足元素守恒：

```
JQY2+J2=JQY
```
作为一名资深炼金术士，Yazid 自然是整日沉迷在化学狂暴中。某一天，Yazid 写下了 $n$ 个化学方程式，并把它们放在一边，为后续的研究做着准备。


然而，见习炼金术士 YJQQQAQ 不慎打翻了一瓶绿色的试剂，导致 Yazid 写下的所有化学方程式中，都有恰好 $1$ 个物质被绿色液体弄得模糊不清了。


暴怒的 Yazid 狠狠地把 YJQQQAQ 批判了一番，并要求他将所有模糊不清的物质重新写出来。除此之外，作为惩罚，无论原来 Yazid 如何书写这些物质，YJQQQAQ 都必须将它们以“最简式”的形式写出。


如果不能完成这些任务，Yazid 就会把他从钦钦草原放逐。面对这么多的化学方程式，弱小、无助的 YJQQQAQ 手足无措，于是他找到了钦钦草原最擅长编程的你，请你帮他完成任务。
## 输入格式

从标准输入读入数据。


第一行 $2$ 个整数 $n,m$，分别表示化学方程式的数目和Yazid的书写习惯。其中，书写习惯 $m$ 是 $0$ 到 $3$ 之间的整数，对于不同的 $m$，Yazid 书写物质的方式不同（这一信息可能对你解决部分测试点有帮助）：


如果 $m=0$，则 Yazid 在书写方程式时一定会将所有物质化为“最简式”；

如果 $m=1$，则 Yazid 在书写方程式时一定会将所有物质的“虚无元素”省略，且不会存在“单一元素”的下标被省略；

如果 $m=2$，则 Yazid 在书写方程式时一定会将所有物质“单一元素”的下标省略，且不会存在“虚无元素”被省略；

如果 $m=3$，则 Yazid 在书写方程式时一定不会省略“单一元素”的下标，也一定不会省略“虚无元素”。


接下来 $n$ 行，每行一个字符串，描述一个被污染的化学方程式。其中，被污染的物质用?表示，保证对于每一个方程式都会存在恰好 $1$ 个?。


数据保证化学方程式严格按照题目背景和题目描述中的格式，且不存在多余的空格或其他字符。
## 输出格式

输出到标准输出。


输出 $n$ 行，每行一个字符串，表示化为“最简式”的?所表示的物质。特别地，对于无解的情况（即?表示的物质超出钦钦草原世界化学学科的研究范围），请输出 `No Solution`。
## 样例

### 样例输入 #1
```
3 0
A=?
?=A+B
C+O2=?
```
### 样例输出 #1
```
A
AB
CO2
```
### 样例输入 #2
```
3 1
A1=?
A1+?=B1
C1+O2=?
```
### 样例输出 #2
```
A
No Solution
CO2
```
### 样例输入 #3
```
1 2
A0B0C0D0E0F0G0H0I0JK0L0M0N0O0P0QR0S0T0U0V0W0X0Y2Z0=?
```
### 样例输出 #3
```
JQY2
```
### 样例输入 #4
```
2 3
?=A0B0C0D0E0F0G0H0I0J1K0L0M0N0O0P0Q1R0S0T0U0V0W0X0Y2Z0
A0B0C0D0E0F0G0H0I0J1K0L0M0N0O0P0Q1R0S0T0U0V0W0X0Y2Z0+A0B0C0D0E0F0G0H0I0J1K0L0M0N0O0P0Q1R0S0T0U0V0W0X0Y2Z0=?
```
### 样例输出 #4
```
JQY2
J2Q2Y4
```
## 提示

|测试点编号|m|?在方程式最左端|等号左边不含+|等号右边不含+|
|:-:|:-:|:-:|:-:|:-:|
|1|0|Yes|Yes|Yes|
|2|1|Yes|Yes|Yes|
|3|2|Yes|Yes|Yes|
|4|3|Yes|Yes|Yes|
|5|0|Yes|Yes||
|6|1|Yes|Yes||
|7|2|Yes|Yes||
|8|3|Yes|Yes||
|9|0|Yes||Yes|
|10|1|Yes||Yes|
|11|2|Yes||Yes|
|12|3|Yes||Yes|
|13|0||||
|14|1||||
|15|2||||
|16|3||||
|17|0||||
|18|1||||
|19|2||||
|20|3|||

如表格中“?在方程式的最左端”为 `Yes`，则表示该测试点保证每个字符串的第一个字符均为?；否则无特殊保证。


如表格中“等号左边不含+”为 `Yes`，则表示该测试点保证等号左边没有加号（+），即等号左边只有一种物质；否则无特殊保证。


如表格中“等号右边不含+”为 `Yes`，则表示该测试点保证等号右边没有加号（+），即等号右边只有一种物质；否则无特殊保证。


对于所有的测试点，保证 $n\leq 100$，保证每个方程式中等式两边的加号+都不超过 $5$ 个，这也意味着每行字符串（每个化学方程式）的长度不超过 $635$。


来自 CodePlus 2017 12 月赛，清华大学计算机科学与技术系学生算法与竞赛协会 荣誉出品。

Credit：idea/王聿中 命题/王聿中 验题/陈宇

Git Repo：[https://git.thusaac.org/publish/CodePlus201712](https://git.thusaac.org/publish/CodePlus201712)

感谢腾讯公司对此次比赛的支持。

感谢 @[ChampionCyan](https://www.luogu.com.cn/user/1036180) 提供了修复后的题面。


---

---
title: "[Code+#2] 可做题1"
layout: "post"
diff: 普及+/提高
pid: P4030
tag: ['Code+']
---
# [Code+#2] 可做题1
## 题目背景

“codeplus比赛的时候在做什么？有没有空？能来解决停机问题吗？”qmqmqm这样问sublinekelzrip。


当然，sublinekelzrip并不会停机问题，所以qmqmqm改为提出了另一个题目，现在请你帮助sublinekelzrip解决这个题目。

## 题目描述

这个问题是这样的：


对于任何一个$n$阶方阵，若任意从其中选择$n$个不同行不同列的位置，其上的权值之和均相等，则我们称这个矩阵是巧妙的。注意对于$n=1$的任何矩阵都是巧妙的。 例如矩阵：

```cpp
1 2 3
4 5 6
7 8 9
```
是巧妙的，因为$1+5+9=1+6+8=2+4+9=2+6+7=3+5+7=3+4+8=15$。

而矩阵：

```cpp
1 2
2 1
```
不巧妙，因为$1+1 \neq 2+2$。

现在有一个$n \times m$大小的矩阵$M$以及$T$个询问，每次询问其一个子方阵是否是巧妙的。

## 输入格式

从标准输入读入数据。


输入第一行包含三个正整数$n,m,T$。


之后$n$行每行$m$个空格分割的非负整数，表示矩阵$M$。


之后$T$行每行$3$个正整数$x,y,k$,表示询问第$x$行第$y$列为左上角的$k$阶方阵是否是巧妙的。保证这个矩阵完全位于$M$之中。

## 输出格式

输出到标准输出。


输出包含$T$行每行一个字符Y或者N。Y表示被询问的方阵是巧妙的，N表示不是。

## 样例

### 样例输入 #1
```
3 3 4
1 1 1
1 1 1
1 1 2
1 1 2
1 1 3
2 2 2
2 1 2
```
### 样例输出 #1
```
Y
N
N
Y
```
## 提示

 ![](https://cdn.luogu.com.cn/upload/pic/12654.png) 

对于所有的数据，$0 \leq M_{ij} \leq 10^9$，$1 \leq x \leq n$，$1 \leq y \leq m$。


来自 CodePlus 2017 12 月赛，清华大学计算机科学与技术系学生算法与竞赛协会 荣誉出品。

Credit：idea/卢政荣 命题/卢政荣 验题/吕时清，王聿中

Git Repo：https://git.thusaac.org/publish/CodePlus201712

感谢腾讯公司对此次比赛的支持。



---

---
title: "[BalticOI 2003] Gem 气垫车"
layout: "post"
diff: 普及+/提高
pid: P4395
tag: ['2003', 'BalticOI（波罗的海）']
---
# [BalticOI 2003] Gem 气垫车
## 题目描述

给出一棵树，要求你为树上的结点标上权值，权值可以是任意的正整数 

唯一的限制条件是相邻的两个结点不能标上相同的权值，要求一种方案，使得整棵树的总价值最小。
## 输入格式

先给出一个数字 $N$ 代表树上有 $N$ 个点，$N \le 10000$。

下面 $N-1$ 行，代表两个点相连。
## 输出格式

最小的总权值。


## 样例

### 样例输入 #1
```
10 
7 5 
1 2 
1 7 
8 9 
4 1 
9 7 
5 6 
10 2 
9 3
```
### 样例输出 #1
```
14
```
## 提示

本题已经添加数据，但考虑到题目年代较为久远（毕竟是 2003 年的 BOI 了）以及洛谷神速评测姬，将此题时限修改为 500ms。


---

---
title: "[IOI 2007] Miners 矿工配餐"
layout: "post"
diff: 普及+/提高
pid: P4401
tag: ['2007', 'IOI']
---
# [IOI 2007] Miners 矿工配餐
## 题目描述

现有两个煤矿，每个煤矿都雇用一组矿工。采煤工作很辛苦，所以矿工们需要良好饮食。每当一辆食品车到达煤矿时，矿工们便会产出一定数量的煤。

有三种类型的食品车：肉车，鱼车和面包车。
矿工们喜欢变化的食谱。如果提供的食品能够不断变化，他们的产煤量将会增加。每当一个新的食品车到达煤矿时，矿工们就会比较这种新的食品和前两次（或者少于两次，如果前面运送食品的次数不足两次）的食品，并且：

- 如果这几次食品车都是同一类型的食品，则矿工们产出一个单位的煤。
- 如果这几次食品车中有两种不同类型的食品，则矿工们产出两个单位的煤。
- 如果这几次食品车中有三种不同类型的食品，则矿工们产出三个单位的煤。

预先已知食品车的类型及其被配送的顺序。通过确定哪车食品送到哪个煤矿可以影响产煤量。食品车不能被拆分，每个食品车必须被全部送到一个或另一个煤矿。两个煤矿也并不要求接收相同数量的食品车（事实上，也允许将所有食品车都送到一个煤矿）。

给出食品车的类型及其被配送的顺序，要求你写一个程序，确定哪个食品车应被送到煤矿 $1$，哪个食品车应被送到煤矿 $2$，以使得两个煤矿的产煤量的总和最大。
## 输入格式

输入的第一行包含一个整数 $N (1 ≤ N ≤ 100 000)$,  表示食品车的数目。

第二行包含一个由 $N$ 个字符组成的字符串，按照配送顺序依次表示食品车配送的食品的类型。每个字符是以下三个大写字母之一：`M`（表示肉类），`F`（表示鱼类）或 `B`（表示面包）。
## 输出格式

输出一个整数，表示最大的总产煤量。
## 样例

### 样例输入 #1
```
6
MBMFFB
```
### 样例输出 #1
```
12
```
### 样例输入 #2
```
16
MMBMBBBBMMMMMBMB
```
### 样例输出 #2
```
29
```
## 提示

在样例 $1$ 中，可以按照如下的顺序运送食品车：煤矿 $1$，煤矿 $1$，煤矿 $2$，煤矿 $2$，煤矿 $1$，煤矿 $2$，依次产生的产煤量为 $1, 2, 1, 2, 3$ 和 $3$ 个单位，一共是 $12$ 个单位。

还有其它运送方式也能产生上述最大总和的产煤量。


---

---
title: "[COCI 2011/2012 #5] BLOKOVI"
layout: "post"
diff: 普及+/提高
pid: P4594
tag: ['2011', 'COCI（克罗地亚）']
---
# [COCI 2011/2012 #5] BLOKOVI
## 题目描述

平面直角坐标系种有 $N$ 个质量为 $m_{i}$ ，长为 $2$，高为 $h$ 的矩形，使得：

* 矩形的边缘与坐标轴平行；
* 矩形的下层与 $y$坐标不重合，且为以下值：$0,h,2h,3h,\dots,(N-1)h$；
* 最低的矩形左下角的坐标为 $(-2,0)$，右下角与原点重合。

![](https://cdn.luogu.com.cn/upload/image_hosting/rjzp667k.png)

定义一个矩阵的 X 中心是其下边的中点的 X 坐标。一个或多个矩形的 X 中心是其 X 中心的加权平均值。它的计算方法为：

$$
Xbarycetre=\frac{\sum_{i}m_{i}\times Xcentre(i)}{\sum_{i}m_{i}}
$$

其中 `Xbarycetre` 表示一个或多个矩形的 X 中心，`Xcentre` 表示一个矩阵的 X 中心。

换句话说，其值为每个矩形的质量乘以它的 X 中心之积除以矩形的总质量。

对于每一个矩形，如果它**上面的矩形**的 X 中心与其的 X 中心的距离小于等于 $1$，则称这些矩形组成的排列是稳定的。

例如，左图的排列是不稳定的，因为上面两个矩形的 X 中心到下面的矩形的X中心的距离大于 $1$。而右图的排列是稳定的。

给出所有矩形的质量，求其可以组成的稳定排列中的矩形的最大 X 坐标。

你不能改变矩形的顺序，它们从**基本**低到高给出。
## 输入格式

第一行，一个整数 $N$，表示矩形的数量。

接着 $N$ 行，每行一个整数 $m_{i}$，表示第 $i$ 个矩形的质量。
## 输出格式

一行，一个小数，表示答案，答案在 $0.000001$ 的误差内均为正确。
## 样例

### 样例输入 #1
```
2 
1 
1

```
### 样例输出 #1
```
1.00000000
```
### 样例输入 #2
```
3
1 
1 
1

```
### 样例输出 #2
```
1.50000000
```
### 样例输入 #3
```
3 
1 
1 
9

```
### 样例输出 #3
```
1.90000000
```
## 提示

有 $30\%$ 的数据，矩形的质量从大到小给出。

$2\le N\le 3\times 10^{5}$，$1\le m_{i}\le 10^{4}$。

题目译自 [COCI 2011/2012 #5 T5](https://hsin.hr/coci/archive/2011_2012/contest5_tasks.pdf)。


---

---
title: "[COCI 2012/2013 #6] JEDAN"
layout: "post"
diff: 普及+/提高
pid: P4622
tag: ['2012', 'COCI（克罗地亚）']
---
# [COCI 2012/2013 #6] JEDAN
## 题目背景

COCI
## 题目描述

有$N$个数排成一行(数值代表高度)，最初所有的数都为零，你可以选择连续的一段等高的数，将它们都增加$1$(除了开头和结尾那个数)如下图表示了两次操作:

![](https://cdn.luogu.com.cn/upload/pic/19412.png)

现在有一些数字看不清了，我们用$-1$表示，请你根据留下的数字，推出有多少
种可能的方案。使得留下的数字正好满足上面的操作方法。

## 输入格式

第一行一个正整数$N$表示数的个数。
接下来一行$N$个数，依次表示每一个数的大小，$-1$表示看不清楚，你可以用任
意满足条件的数代替。第$i$个数用$h_i$表示
## 输出格式

一个数，表示所有可能的方案对$1000000007$ 求余的值。
## 样例

### 样例输入 #1
```
3
-1 2 -1
```
### 样例输出 #1
```
0
```
### 样例输入 #2
```
3
-1 -1 -1
```
### 样例输出 #2
```
2
```
### 样例输入 #3
```
6
-1 -1 -1 2 -1 -1
```
### 样例输出 #3
```
3
```
## 提示

- $(1≤N≤10000)$
- $(-1 ≤ h_i ≤10 000)$


---

---
title: "[COCI 2017/2018 #5] Karte"
layout: "post"
diff: 普及+/提高
pid: P4650
tag: ['2017', 'Special Judge', 'COCI（克罗地亚）']
---
# [COCI 2017/2018 #5] Karte
## 题目描述

有$N$ 张牌叠在一起，第 $i$ 张牌上，有一个数字 $a_i$ 表示它下面**至少**有 $a_i$ 张牌上的信息是错误的，若它下面确实有至少 $a_i$ 张牌的信息是错误的，那这张牌的信息就是正确的，否则这张牌的信息就是错误的。（我们认为最下面的牌的后面有 $0$ 张错误的）

现在需要你重新调整牌的顺序，使得正好有 $K$ 张牌上的信息是错误的。
## 输入格式

第一行两个正整数 $N$ 和 $K$ $( 1 ≤ N≤ 5×10^5,0 ≤ K≤ N )$表示牌的张数和要求的错误信息的个数。
接下来 $N$ 行，每行一个数，表示对应的 $a_i$ $(0 ≤ a_i≤ 5×10^5 )$
## 输出格式

如果调整方案不存在，输出$-1$。否则输出由顶部到底部 $N$ 张牌对应的 $a_i$，若有多种方案，输出任意一种即可。
## 样例

### 样例输入 #1
```
4 2
1 2 2 3

```
### 样例输出 #1
```
2 3 1 2
```
### 样例输入 #2
```
5 3
2 1 3 0 3

```
### 样例输出 #2
```
3 3 0 1 2
```
### 样例输入 #3
```
6 4
0 2 5 2 0 1

```
### 样例输出 #3
```
-1
```
## 提示

$30\%$的数据 $N≤ 16$。

另有$40\%$的数据 $N≤ 2000$。

**样例 2 说明：**

第 $5$ 张牌上写的是$2$，但是其后面只有 $0$ 张错误，所以它是错误的。

第 $4$ 张牌上写的是$1$，其后面有 $1$ 张错误（第五张），所以它是正确的。

第 $3$ 张牌上写的是$0$，其后面有 $1$ 张错误（第五张），所以它是正确的。

第 $2$ 张牌上写的是$3$，但是其后面只有 $1$ 张错误（第五张），所以它是错误的。

第 $1$ 张牌上写的是$3$，但是其后面只有 $2$ 张错误（第五张，第二张），所以它是错误的。

因此总共有 $3$ 张是错误的。


---

---
title: "[BalticOI 2005] Maze"
layout: "post"
diff: 普及+/提高
pid: P4651
tag: ['2005', 'BalticOI（波罗的海）']
---
# [BalticOI 2005] Maze
## 题目描述

给出一个平行四边形的长与高. 给出入口与出口,对于四边形的每条边都有一种Color,非黑即白. 你要找出一条路径,走过的边黑白交替,且长度最短
## 输入格式

第一行给出平行四边形的长与高.且值在[1,500] 第二行给出入口,出口坐标. 下面的字符矩阵代表这个平行四边形每条边的Color
## 输出格式

输出路径的最少长度
## 样例

### 样例输入 #1
```
2 1
0 0 2 1
bb
nwwnw
bn
```
### 样例输出 #1
```
6
```
### 样例输入 #2
```
5 4
0 2 5 2
nnbnn
nnnwwbwnnnn
nbbbn
nnwbwwbwwnn
bwwww
nnbwbbwwbnn
nwwwn
nnnnbwbbnnn
nnwnn
```
### 样例输出 #2
```
22
```
## 提示

对于第一个数据:

(0, 0) -> (1, 0) -> (0, 1) -> (1, 1) -> (1, 0) ->(2, 0) -> (2, 1)

![](https://cdn.luogu.com.cn/upload/image_hosting/a7qxcn67.png)  

对于第二个数据:

(0, 2) -> (1, 2) -> (1, 1) -> (2, 1) -> (2, 0) ->

(3, 0) -> (3, 1) -> (3, 2) -> (4, 1) -> (3, 1) ->

(3, 0) -> (2, 0) -> (2, 1) -> (1, 1) -> (1, 2) ->

(1, 3) -> (2, 3) -> (2, 4) -> (3, 4) -> (3, 3) ->

(4, 3) -> (4, 2) -> (5, 2)

![](https://cdn.luogu.com.cn/upload/image_hosting/8d0gue8n.png)


---

---
title: "[CEOI 2017] Sure Bet"
layout: "post"
diff: 普及+/提高
pid: P4653
tag: ['2017', 'CEOI（中欧）']
---
# [CEOI 2017] Sure Bet
## 题目描述

现在有 $n$ 个A类灯泡和 $n$ 个B类灯泡，每个灯泡都有各自的权值。

我们将这些灯泡分为 $n$ 组，每组包含一个来自A类的灯泡和一个来自B类的灯泡。

你可以从中选取任意个灯泡，每选取一个灯泡需要花费 $1$ 的代价。

在你选取完之后，系统会随机在A类和B类中选择一个类型，并点亮那一类的所有灯泡。你选取的每个点亮的灯泡会给你带来等于它权值的收益。

现在请你合理选取灯泡，以最大化可能的最小收益。你只需要求出来这个收益即可。
## 输入格式

第一行一个正整数 $n$ ，表示灯泡的组数。

接下来 $n$ 行每行两个空格隔开的实数 $A_i,B_i$​​。分别表示属于这组的A灯泡和B灯泡的权值。输入的实数不会超过四位小数。
## 输出格式

输出最大化的最小可能收益，请输出到小数点后恰好四位。
## 样例

### 样例输入 #1
```
4
1.4 3.7
1.2 2
1.6 1.4
1.9 1.5
```
### 样例输出 #1
```
0.5000
```
## 提示

**样例解释**

最优策略是选择第一组的B灯泡和第三组的A灯泡和第四组的A灯泡：

-    如果B类灯泡被点亮，收益是 $3.7-3=0.7$。
-    如果A类灯泡被点亮，收益是 $1.6+1.9-3=0.5$ 。

最小可能收益是 $0.5$。

**数据范围**

对于所有测试点，有 $1.0\le A_i,B_i\le 1000.0$，$0\le n\le 10^5$。


---

---
title: "[CEOI 2017] Palindromic Partitions"
layout: "post"
diff: 普及+/提高
pid: P4656
tag: ['2017', 'CEOI（中欧）']
---
# [CEOI 2017] Palindromic Partitions
## 题目描述

给出一个只包含小写字母字符串，要求你将它划分成尽可能多的小块，使得这些小块构成回文串。

例如：对于字符串 ``abcab``，将他分成 ``ab`` ``c`` ``ab`` 或者 ``abcab`` 就是构成回文串的划分方法，``abc`` ``ab`` 则不是。
## 输入格式

第一行输入一个整数 $T$ 表示数据组数。

接下来的 $T$ 行，每行输入一个字符串，代表你需要处理的字符串，保证该字符串只包含小写字母。
## 输出格式

输出 $T$ 行，对于每个输入的字符串，输出一行包含一个整数 $x$，表示该字符串最多能分解成 $x$ 个小块，使得这些小块构成回文串。
## 样例

### 样例输入 #1
```
4
bonobo
deleted
racecar
racecars
```
### 样例输出 #1
```
3
5
7
1
```
## 提示

对于 $100\%$ 的数据，有 $1\le T\le 10$。设 $L$ 为单个字符串的长度，则 $1\le L\le 10^6$​​。


---

---
title: "[CERC2014] Bricks"
layout: "post"
diff: 普及+/提高
pid: P4763
tag: ['2014']
---
# [CERC2014] Bricks
## 题目描述

You are given a sequence of white $(W)$ and black $(B)$ bricks. The goal is to partition it into some number of non-empty, contiguous blocks, each one having the same ratio of white and black bricks.

Of course one can always “partition” the sequence into one single block (which is not very interesting). We want, however, to have as many blocks as possible. Consider for example the following sequences and its partitions:

   - $BWWWBB = BW + WWBB$ (ratio 1:1),
   - $WWWBBBWWWWWWWWWB = WWWB + BBWWWWWW + WWWB$ (ratio 3:1).

Note that both of these partitions are optimal with respect to the number of blocks.

## 输入格式

The first line of input contains the number of test cases $T$. The descriptions of the test cases follow:

Each test case starts with one line containing an integer $n(1 \le n \le 10^5)$ which is the length of the description of a sequence. Each of the following $n$ lines consists of an integer $k(1 \le k \le 10^9)$ and one of the characters $W$ or $B$, meaning that $k$ bricks of the given color follow next in the sequence. It is guaranteed that the total length of the brick sequence does not exceed $10^9$.
## 输出格式

For each test case, output a single line containing the largest possible number of blocks.

## 样例

### 样例输入 #1
```
3
3
1 B
3 W
2 B
4
3 W
3 B
9 W
1 B
2
2 W
3 W
```
### 样例输出 #1
```
2
3
5
```
## 题目翻译

题目描述  
给你一个由'B'和'W'组成的序列，将其按分成最多的区间且每个区间的'B':'W'的值相等  

输入输出格式  

输入格式：  
多组数据，第一行一个整数T表示数据组数  
每组数据的第一行为一个整数n，接下来n行，每行一个整数k和一个字符（'B'或'W'）表示在上一个序列后有一个长度为k的'B'或'W'的序列，序列的总长度不超过10^9  

输出格式：
共T行，每行一个整数表示能分成的最多的区间数  


---

---
title: "[CEOI 2015] 卡尔文球锦标赛 (Day1)"
layout: "post"
diff: 普及+/提高
pid: P4798
tag: ['2015', 'CEOI（中欧）']
---
# [CEOI 2015] 卡尔文球锦标赛 (Day1)
## 题目描述

**译自 [CEOI2015](https://ceoi2015.fi.muni.cz/tasks.php) Day1 T2「[Calvinball championship](https://ceoi2015.fi.muni.cz/day1/eng/day1task2-eng.pdf)」**

一场卡尔文球比赛会有 $n$ 名选手参与，他们的编号分别为 $1\dots n$，分为若干个非空的球队。我们规定球队之间按照每个球队编号最小的选手的编号排序，并且以从 1 开始的连续整数编号。

举个栗子，譬如 1 号选手自己成一队，2, 3 和 5 号选手成一队，4 和 6 号选手成一队。

>\> $\ \texttt{1}$  
>\> $\ \texttt{2 3 5}$  
>\> $\ \texttt{4 6}$

那么 1 号选手的球队就是 1 号球队，2 号选手的球队就是 2 号球队，4 号选手的球队就是 3 号球队。

>\> $\ \texttt{1|1}$  
>\> $\ \texttt{2|2 3 5}$  
>\> $\ \texttt{3|4 6}$

每个人每天会选择不同的球队，我们可以在记录时省略选手的编号，仅记录每个位置对应选手所属球队编号的序列（上述例子为 `1 2 2 3 2 3`），因为每天的选手是一样的。当可能的选择方案全部被使用过后，锦标赛就结束了。

由于选择方案十分多，选择困难症患者纷纷表示力不从心。今年，我们决定根据记录的序列的字典序来选择方案。因此，第一天，所有人都在一个队 `1 1 1 1 1`；第二天，所有人都与 6 号针锋相对 `1 1 1 1 1 2`……在最后一天，所有人互相打响战争 `1 2 3 4 5 6`。

对于给定的球队记录，请你算出将会在未来的哪一天使用该记录。输出这个数字对 $1\ 000\ 007$ 取余的结果。
## 输入格式

第一行，一个正整数 $n(1 \leq n \leq 10\ 000)$。

第二行，$n$ 个以空格分隔的正整数，表示任务所给的球队记录。
## 输出格式

输出一个正整数，表示任务所给的球队记录将会被使用的天数对 $1\ 000\ 007$ 取余的结果。第一天的天数为 1。
## 样例

### 样例输入 #1
```
3
1 2 2
```
### 样例输出 #1
```
4
```
## 提示

请注意，三人比赛中可能的选择有 `1 1 1` `1 1 2` `1 2 1` `1 2 2` 和 `1 2 3`。

### 数据范围与提示

|数据点|$1-3$|$4-5$|$6-7$|$8-10$|
|-|:-:|:-:|:-:|:-:|
|$n\le$|$14$|$100$|$1\ 000$|$10\ 000$|


---

---
title: "帕秋莉的魔法"
layout: "post"
diff: 普及+/提高
pid: P4912
tag: []
---
# 帕秋莉的魔法
## 题目背景

帕秋莉是一个有哮喘病的魔法使。
## 题目描述

众所周知，不同的魔法会需要念不同长度咒语 $a_i$ 但也会产生不同的威力 $b_i$。同时，在发动过一个魔法后也会对接下来发动的一个魔法产生影响 $w_{i,j}$（即在用完第 $i$ 种魔法后第 $j$ 种魔法的威力会变为 $b_j + w_{i.j}$，而且只会影响到下一个魔法）。
（当然也可能有魔法会减少咒语长度或者产生治愈的效果的魔法，魔法不可重复使用）

帕秋莉现在知道使用每种魔法后对接下来一种魔法的影响，以及每种魔法需要念的咒语长度和产生的威力，同时，由于编号大的魔法比编号小的魔法高级，所以一个魔法只有在编号不大于自己的魔法后使用才能保证魔法的连续性），现在她想知道念出长度为 $m$ 的咒语最大能产生多少威力。(以免下次在战斗中又因为哮喘病发作而惨败)

(编号顺序即给出的顺序)
## 输入格式

第一行：两个正整数 $n,m$，表示一共有 $n$ 种魔法，念出长度为 $m$ 的咒语。

接下来的 $n$ 行：每行两个整数 $a_i,b_i$，表示咒语的长度以及魔法的威力。

接下来的 $n$ 行：每行 $n$ 个整数，第 $i$ 行，第 $j$ 列，代表第 $i$ 种魔法在第 $j$ 种魔法后使用产生的附加值 $w_{i,j}$。
## 输出格式

一个整数，表示最大能产生的威力。
（如果无论如何都无法组成长度为 $m$ 的咒语，则输出 `-1`）
## 样例

### 样例输入 #1
```
2 5
3 3
2 2
1 2
3 4
```
### 样例输出 #1
```
7
```
### 样例输入 #2
```
2 6
3 3
2 2
1 2
3 4
```
### 样例输出 #2
```
-1
```
## 提示

对于 $20\%$ 的数据，保证 $a_i = 1$。

对于另外 $20\%$ 的数据，保证所有数字均为正整数。

对于 $100\%$ 的数据，$1 \le n \le 50,  |a_i|,|b_i|, |w_{i,j}|\le 50, |m| \le 2500$，保证运算过程中的数字大小均在 int 范围内(废话...)。


---

---
title: "[COCI 2017/2018 #6] Mate"
layout: "post"
diff: 普及+/提高
pid: P4958
tag: ['2017', 'COCI（克罗地亚）']
---
# [COCI 2017/2018 #6] Mate
## 题目描述

Little Mate got an array of lowercase letters from the English alphabet as a present from his
parents. In order to have at least some use of such a clever present, he decided to use it for
finding rhymes when writing his next song.

To find a specific rhyme, Mate wants to select a word of length D that ends with an array of
characters XY, i.e. where the next to last letter is X, and the last Y. Mate’s process of
selecting a word is by first crossing out some letters in a given sequence, and then merging
the letters he didn’t cross out into a single word. He wants to know in how many different
ways he can cross out the letters so that he meets the given conditions.

The selection of two words is considered distinct if the sets of positions of the crossed-out
letters are different.

## 输入格式

The first line of input contains an array of lowercase letters of the English alphabet S (2 ≤ |S|
≤ 2000).

The second line of input contains the integer Q (1 ≤ Q ≤ 500 000), the number of different
rhymes for which Mate needs to select words.

Each of the following Q lines contains the integer D (2 ≤ D ≤ |S|) and an array of lowercase
letters of the English alphabet XY from the task.
## 输出格式

The $i^{th}$ out of Q lines must contain the required number of ways for the $i^{th}$ rhyme. Since that number can be quite large, output only the value **modulo 1 000 000 007​**.
## 样例

### 样例输入 #1
```
banana
3
2 na
3 ba
4 nn
```
### 样例输出 #1
```
3
0
1
```
### 样例输入 #2
```
malimateodmameitate
3
10 ot
7 aa
3 me
```
### 样例输出 #2
```
2
464
56
```
## 提示

In test cases worth 40% of total points, it will hold |S| ≤ 50.

In test cases worth an additional 40% of total points, it will hold |S| ≤ 200.

**Clarification of the first test case:**

Word of length 2 that ends with “na” can be obtained in the following ways:

~~b a n a~~$\ $**n a**​, ~~b a~~$\ $**n a**$\ $~~​n a~~, ~~b a~~$\ $**n**​ ~~a n~~$\ $**a**
## 题目翻译

给定一个字符串 $S$，一共有 $Q$ 个询问，每一个询问给定一个数字 $N$ 和 两个字符 $A$ 和 $B$，问你在 $S$ 中有多少长度为 $N$ 的子串为 $A, B$ 结尾，其中 $A$ 为倒数第二个字符，$B$ 为最后一个字符。注意，选取的字母可以不连续。


---

---
title: "[COCI 2017/2018 #7] Dostavljač"
layout: "post"
diff: 普及+/提高
pid: P5054
tag: ['2017', 'COCI（克罗地亚）']
---
# [COCI 2017/2018 #7] Dostavljač
## 题目描述

Ever since Krešo started growing chili peppers, N restaurants all over Croatia showed
interest in his peppers so they could enrich their dishes with real spice. Because of high
demand, Krešo decided to start working as a delivery guy of chili peppers.

The restaurants are denoted with numbers from 1 to N and are mutually connected with N -
1 roads such that traveling between any two restaurants is possible. Krešo begins his
journey in the restaurant denoted with 1. In one unit of time, he can either drive to the
adjacent restaurant or deliver the peppers to the current restaurant. For each restaurant, we
know the required amount of peppers $A_i$.

Since delivering goods is tiring, Krešo decided to spend a total of M units of time on delivery
and travel, after which he plans to take a break.

Determine the maximal amount of peppers Krešo can deliver in the given timeframe. You
can assume that Krešo always carries an unlimited supply of peppers.
## 输入格式

The first line of input contains two integers N and M (1 ≤ N, M ≤ 500), the number of
restaurants and the time Krešo plans to spend delivering peppers.

The second line of input contains N integers $A_i$
(1 ≤ $A_i$ ≤ $10^6$
), the required amount of peppers
for restaurants denoted with i (1 ≤ i ≤ N).

Each of the following N - 1 lines contains two integers U and V (1 ≤ U, V ≤ N, U ≠ V) that
represent the road between restaurants U and V.
## 输出格式

You must output the maximal amount of peppers Krešo can deliver in the given timeframe.

## 样例

### 样例输入 #1
```
3 5
9 2 5
1 2
1 3

```
### 样例输出 #1
```
14
```
### 样例输入 #2
```
4 5
1 1 1 2
1 2
2 3
3 4

```
### 样例输出 #2
```
3
```
### 样例输入 #3
```
5 10
1 3 5 2 4
5 2
3 1
2 3
4 2
```
### 样例输出 #3
```
15
```
## 提示

**Clarification of the first test case:**

In the first step, Krešo will deliver the peppers to restaurant 1.

In the second step, Krešo will travel to restaurant 3.

In the third step, Krešo will deliver the peppers to restaurant 3.

He is left with 2 units of time, in which he can drive to restaurant 2, but he lacks one unit of time to
deliver the peppers to that restaurant.
## 题目翻译

自从 Krešo 开始种植辣椒以来，克罗地亚各地的 $N$ 家餐馆都对他的辣椒感兴趣，因此他们可以用真正的香料来丰富他们的菜肴。由于需求量很大，Krešo 决定开始作为辣椒的送货员。

餐馆用从 $1$ 到 $N$ 的数字表示，并且与 $N - 1$ 个道路相互连接，使得可以在任何两个餐馆之间旅行。Krešo 在 $1$ 号餐厅开始他的旅程。在一个单位的时间里，他可以开车到相邻的餐厅或将辣椒送到现在的餐馆。对于每家餐厅，我们都知道所需的辣椒数量 $A_i$。

由于交付货物很累，Krešo 决定在交付和旅行上花费总共 $M$ 个单位的时间，之后他计划休息一下。

确定 Krešo 在给定时间范围内可以提供的最大辣椒数量。你可以假设 Krešo 总是带有无限量的辣椒。

### 输入格式

第一行输入包含两个整数 $N$ 和 $M$（$1 \le N, M \le 500$），餐馆数量和 Krešo 计划用于交付辣椒的时间。

第二行输入包含 $N$ 个整数 $A_i$（$1 \le A_i \le 10^6$），用 $i$ 表示的餐馆所需的辣椒数量（$1 \le i \le N$）。

以下 $N - 1$ 行中的每一行包含两个整数 $U$ 和 $V$（$1 \le U, V \le N$，$U \ne V$），其表示餐馆 $U$ 和 $V$ 之间的道路。

### 输出格式

您必须输出 Krešo 在给定时间范围内可以提供的最大量的辣椒。



---

---
title: "[USACO12OPEN] Bookshelf S"
layout: "post"
diff: 普及+/提高
pid: P5095
tag: ['2012', 'USACO']
---
# [USACO12OPEN] Bookshelf S
## 题目描述

Farmer John 闲来无事的时候总喜欢坐下来看书。这些年来，他一共收集了 $N$ 本书（$1 \leq N \leq 2000$），他打算搭一个新的书架来装这些书。

每本书都有个宽度 $w_i$ 和高度 $h_i$，书必须按顺序来摆放（即同一层书架摆的书必须是连续的一个区间）。每层书架的总宽度不能超过 $L$（$1 \leq L \leq 10^9$），每层书架的高度等于这一层最高的书的高度，整个书架的高度等于每层书架的高度之和。

现在请你帮 FJ 求出书架高度的最小值。
## 输入格式

第一行两个整数 $N,L$。

接下来 $N$ 行，每行两个整数 $h_i,w_i$（$1 \leq h_i \leq 10^6$，$1 \leq w_i \leq L$）。
## 输出格式

输出一个整数，书架高度最小值。
## 样例

### 样例输入 #1
```
5 10
5 7
9 2
8 5
13 2
3 8
```
### 样例输出 #1
```
21
```
## 提示

第一层放第一本书，第二层放第二，三，四本书，第三层放第五本书，总高度为 $5+13+3=21$，可以证明不存在更优的方案。


---

---
title: "[USACO04OPEN] Cave Cows 1"
layout: "post"
diff: 普及+/提高
pid: P5096
tag: ['2004', 'USACO']
---
# [USACO04OPEN] Cave Cows 1
## 题目描述

很少人知道其实奶牛非常喜欢到洞穴里面去探险。

洞窟里有 $ N $ ( $ 1 \leq N \leq 100 $ )个洞室，由 $ M $ ( $ 1 \leq M \leq 1000 $ )条双向通道连接着它们。每对洞室间至多只有一条双向通道，有 $ K $ ( $ 1 \leq K \leq 14 $ )个洞室，里面放有1捆干草．牛吃1捆干草，体重指数就会增加1。

贪吃的贝茜要到洞窟里面探险，她希望能吃尽量多的干草，但每条通道有一个宽度阈值，如果体重指数超过相应的阈值，贝茜就会被卡住。

她从洞窟1出发，体重指数为0。在洞里溜达一圈后，她要返回洞窟1。

那她最多能吃多少捆干草呢？注意，贝茜经过一个洞室，不一定非要吃掉里面的干草。
## 输入格式

第1行输入 $ N,M,K $ 。

之后 $ K $ 行每行一个整数，表示在这个洞室放有一捆干草；接下来 $ M $ 行每行三个整数，表示一条双向通道的起点终点和宽度阈值。
## 输出格式

最多能吃掉的干草数。
## 样例

### 样例输入 #1
```
6 7 5
1
2
3
4
5
1 2 3
3 6 2
6 2 10
2 4 1
5 1 1
4 5 1
1 6 1
```
### 样例输出 #1
```
4
```


---

---
title: "[USACO04OPEN] Cave Cows 4"
layout: "post"
diff: 普及+/提高
pid: P5099
tag: ['2004', 'USACO']
---
# [USACO04OPEN] Cave Cows 4
## 题目描述

一道竖直的石墙横在贝茜前面，她必须越过去。

石墙可以看成一个xz平面，贝茜开始的时候在(0，0)，只要她到达 $ z=T $ 
 ( $ 1 \leq T \leq 200000 $ )的位置，就算翻越成功。

墙上有 $ N $ ( $ 1 \leq N \leq 50000 $ )块石头突出，成为贝茜的落蹄石。如果两个落蹄石之间x方向和z方向的距离均不超过2，那贝茜就可以攀上另一块落蹄石。

帮助贝茜计算她是否能够翻越石墙，如果可以，最少需要踩多少块落蹄石。
## 输入格式

第1行输入 $ N $ 和 $ T $ 。

接下来 $ N $ 行，每行输入坐标 $ (x,z) $ ，表示一个石头的位置．其中 $ x \leq 10^6 $ ， $ z \leq T $ ，保证 $ (0,0) $ 不会出现。
## 输出格式

如果可以翻越则输出最少需要的落蹄石数（起点不计入），否则输出 $ -1 $ 。
## 样例

### 样例输入 #1
```
5 3
1 2
6 3
4 1
3 2
0 2
```
### 样例输出 #1
```
4
```
## 提示

一种可行的方案是：(0,0) -> (1,2) -> (3,2) -> (4,1) -> (6,3) 。


---

---
title: "红包发红包"
layout: "post"
diff: 普及+/提高
pid: P5104
tag: []
---
# 红包发红包
## 题目背景

红包（redbag）发明了一个抢红包的系统。
## 题目描述

这个抢红包系统是这样的：假如现在有 $w$ 元，那么你抢红包能抢到的钱就是 $[0,w]$ 等概率均匀随机出的一个实数 $x$。

现在红包发了一个 $w$ 元的红包，有 $n$ 个人来抢。那么请问第 $k$ 个人期望抢到多少钱？

输出答案对 $10^9+7$ 取模后的结果。

## 输入格式

一行三个整数，$w,n,k$。
## 输出格式

第 $k$ 个人期望抢到的钱数对 $10^9+7$ 取模后的结果。

补充：期望可能是分数，关于分数取模，可以问度娘。

## 样例

### 样例输入 #1
```
2 1 1
```
### 样例输出 #1
```
1
```
## 提示

注意红包发明的抢红包系统和微信的抢红包系统不一样，红包发明的抢红包系统中的钱不一定是整数分。

- 对于 $30\%$ 的数据，$k=1$
- 另有 $30\%$ 的数据，期望值取模前为整数，$k\le 10$。

对于全部数据，$0< w< (10^9+7)$，$n\le 10^{18},k\le n$。


---

---
title: "圆点"
layout: "post"
diff: 普及+/提高
pid: P5174
tag: []
---
# 圆点
## 题目背景

中考了，Pg看着数学卷子的压轴题，陷入了沉思……

题解：https://blog.csdn.net/kkkksc03/article/details/85008125
## 题目描述

众所周知，平面中的每一个整点都**有且仅有**一个圆心在原点的圆穿过，我们定义这个整点的权值为穿过它的圆的**半径的平方**。

现在有一个圆心在原点的圆，半径为$\sqrt{R}$。你要求出这个圆所包含的所有整点的权值**和**。

由于答案可能过大，对$10^9+7$取模。

## 输入格式

一个数字$R$。
## 输出格式

一行，仅有一个数字。
## 样例

### 样例输入 #1
```
3
```
### 样例输出 #1
```
12
```
### 样例输入 #2
```
100

```
### 样例输出 #2
```
16012
```
### 样例输入 #3
```
1234567

```
### 样例输出 #3
```
205275050
```
## 提示

样例1 解释：

共包含了$9$个整点。分别为$(0,0),(0,1),(1,1),(1,0),(1,-1),(0,-1),(-1,-1),(-1,0),(-1,1)$。

权值分别为$\ 0,1,2,1,2,1,2,1,2$，总和为12。

--------
   
对于50%的数据，$R \le 10^{6}.$

对于100%的数据，$R \le 10^{14}.$



---

---
title: "[COCI 2009/2010 #1] GENIJALAC"
layout: "post"
diff: 普及+/提高
pid: P5181
tag: ['2009', 'COCI（克罗地亚）']
---
# [COCI 2009/2010 #1] GENIJALAC
## 题目描述

 **译自 [COCI 2009.10](http://hsin.hr/coci/archive/2009_2010/) T5「[GENIJALAC](http://hsin.hr/coci/archive/2009_2010/contest1_tasks.pdf)」**

Mirko 发明了一台打乱机。机器接受一个 $N$ 列、无限行的纸带作为输入和输出。这 $N$ 列依次编号为 $1\ldots N$。

开始时，只有纸带的第一行写了数，其下方的每一行都是空白的。  
在纸带的第一行中，每列有一个整数，第 $i$ 列上写了整数 $i$。  
另外，Mirko 给出了一个打乱排列，这是一个长度为 $N$ 的排列 $s_1,$ $s_2,$ $\ldots,$ $s_N$。

有一个行指针，开始时指向首行。  
每次运行该机器时，机器会将当前行（行指针所指向的行）位于第 $i$ 列的数放到下一行的第 $s_i$ 列上，$N$ 个数都放好后，指针将下移一行。

Mirko 运行了该机器无限次。现在 Mirko 将纸带的前 $C$ 列和后 $D$ 列剪掉了，我们称之为新的纸带。

试问：在新纸带的第 $A\sim B$ 行中，有多少行与新纸带的首行相同。
## 输入格式

第一行五个整数 $N, A, B, C, D$。  
第二行 $N$ 个整数 $s_1,$ $s_2,$ $\ldots,$ $s_N$。
## 输出格式

一行，一个整数，表示在新纸带的第 $A\sim B$ 行中，有多少行与新纸带的首行相同。
## 样例

### 样例输入 #1
```
4 1 5 0 1
1 3 4 2
```
### 样例输出 #1
```
2
```
### 样例输入 #2
```
7 3 8 1 2
2 3 1 6 4 7 5
```
### 样例输出 #2
```
0
```
### 样例输入 #3
```
6 2 11 3 0
6 3 5 4 2 1
```
### 样例输出 #3
```
1
```
## 提示

#### 样例说明 1
```plain
+-----+
|1 2 3|4 <--
|1 3 4|2
|1 4 2|3
|1 2 3|4 <--
|1 3 4|2
+-----+
 1 4 2 3
 1 2 3 4
```

#### 样例说明 2
```plain
1 2 3 4 5 6 7
2 3 1 6 4 7 5
 +-------+
3|1 2 7 6|5 4
1|2 3 5 7|4 6
2|3 1 4 5|6 7
3|1 2 6 4|7 5
1|2 3 7 6|5 4
2|3 1 5 7|4 6
 +-------+
3 1 2 4 5 6 7
1 2 3 6 4 7 5
```

#### 样例说明 3
```plain
1 2 3 4 5 6
     +-----+
6 3 5|4 2 1|
1 5 2|4 3 6|
6 2 3|4 5 1|
1 3 5|4 2 6|
6 5 2|4 3 1|
1 2 3|4 5 6| <--
6 3 5|4 2 1|
1 5 2|4 3 6|
6 2 3|4 5 1|
1 3 5|4 2 6|
     +-----+
```

#### 数据范围与提示
对于 $40\%$ 的数据，$A,$ $B,$ $C,$ $D,$ $N\le 2000$。  
对于所有数据，$1\le N\le 5\times 10^5,$ $1\le A, B\le 10^{12},$ $0\le C,$ $D\le N,$ $C+D\le N$。


---

---
title: "棋盘覆盖"
layout: "post"
diff: 普及+/提高
pid: P5182
tag: []
---
# 棋盘覆盖
## 题目描述

给定一个 $N$ 行 $N$ 列的棋盘，已知某些格子禁止放置。

求最多能往棋盘上放多少块的长度为 $2$、宽度为 $1$ 的骨牌，骨牌的边界与格线重合（骨牌占用两个格子），并且任意两张骨牌都不重叠。
## 输入格式

第一行包含两个整数 $N$ 和 $t$，其中 $t$ 为禁止放置的格子的数量。

接下来 $t$ 行每行包含两个整数 $x$ 和 $y$，表示位于第 $x$ 行第 $y$ 列的格子禁止放置，行列数从 $1$ 开始。
## 输出格式

输出一个整数，表示结果。
## 样例

### 样例输入 #1
```
8 0
```
### 样例输出 #1
```
32
```
## 提示

$1 \le N \le 100$，$0 \le t \le 100$


---

---
title: "[COCI 2009/2010 #4] OGRADA"
layout: "post"
diff: 普及+/提高
pid: P5186
tag: ['2009', 'COCI（克罗地亚）']
---
# [COCI 2009/2010 #4] OGRADA
## 题目描述

 **译自 [COCI 2010.02](http://hsin.hr/coci/archive/2009_2010/) T4「[OGRADA](http://hsin.hr/coci/archive/2009_2010/contest4_tasks.pdf)」**

Matija 的栅栏由 $N$ 条木板组成，从左到右依次编号为 $1\ldots N$。$i$ 号木板的高度为 $h_i$，每条木板的宽度是 $1\ \rm{cm}$。

Matija 想用一个宽度为 $X\ \rm{cm}$ 的滚筒刷来刷木板。使用滚筒刷时，要保证刷子**完全**接触栅栏（不能一部分接触一部分不接触）；另外，还要保证滚筒平行于地面。因此，每次涂色时，Matija 会在栅栏上选择连续的 $x$ 条木板，然后从下往上「刷」，一直刷到这 $x$ 条木板中最矮者的高度。

根据上述规则，有可能有一些木板没法用滚筒刷来刷，Matija 不得不用牙刷来「涂」剩下的部分。因此，请帮他求出他最少只需用牙刷「涂」多少平方厘米。他还想知道，在满足「涂」的面积最少的情况下，他最少要用滚筒刷「刷」多少次。
## 输入格式

第一行：$N,X$。  
第二行：$h_1\ldots h_N$。
## 输出格式

两行。  
第一行有一个整数，表示 Matija 最少需用牙刷涂多少平方厘米。  
第二行有一个整数，表示最少要用滚筒刷「刷」多少次。
## 样例

### 样例输入 #1
```
5 3
5 3 4 4 5
```
### 样例输出 #1
```
3
2
```
### 样例输入 #2
```
10 3
3 3 3 3 3 3 3 3 3 3
```
### 样例输出 #2
```
0
4
```
### 样例输入 #3
```
7 4
1 2 3 4 3 2 1
```
### 样例输出 #3
```
4
4
```
## 提示

#### 样例说明 1
![pp.png](https://i.loli.net/2018/12/30/5c289875b3356.png)

#### 数据范围与提示
$1\le N\le 10^6,$ $1\le X\le 10^5,$ $1\le h_i\le 10^6$.


---

---
title: "DLS 采花"
layout: "post"
diff: 普及+/提高
pid: P5216
tag: []
---
# DLS 采花
## 题目背景

超水的签到题
## 题目描述

DLS 有 $N$ 个花田，每个花田里有 $a_i$ 朵花。

DLS 喜欢稀奇古怪的花田，他希望重新排列花田，然后去采花。  
但 DLS 采花又有一个癖好：他会从左往右采花。  
若当前采到第 $i$ 个花田，在之前有一个花田的花的数量，是第 $i$ 个花田的花的数量的因子的话，那么 DLS 不会采这个花田的花。

现在，DLS 想知道对于所有排列花田的方案，他能够采到的花的数量的和是多少。  
由于答案会比较大，请对 $998244353$ 取模。
## 输入格式

第一行一个正整数 $N$。  
第二行是一个长度为 $N$ 的序列 $a$。

## 输出格式

共一行，表示所有方案中采花的数量和对 $998244353$ 取模的结果。
## 样例

### 样例输入 #1
```
4
2 3 6 3

```
### 样例输出 #1
```
156
```
## 提示

|数据百分比|限制|
|-|-|
|$50\%$|$N \le 9$|
|$80\%$|$N \le 1000$|
|$100\%$|$N \le 10^5,a_i \le 10^5$|


---

---
title: "回忆京都"
layout: "post"
diff: 普及+/提高
pid: P5239
tag: ['洛谷月赛']
---
# 回忆京都
## 题目背景

第十五届东方人气投票 音乐部门 106名 

第四次国内不知道东方的人对东方原曲的投票调查 51名

回忆京都副歌我tm吹爆，东方文花帖我tm吹爆！
## 题目描述

射命丸文在取材中发现了一个好玩的东西，叫做组合数。

组合数的定义如下：从$n$个不同元素中，任取$m(m \leq n)$个元素并成一组，叫做从$n$个不同元素中取出$m$个元素的一个组合。所有组合的数量，就是组合数。

组合数的计算公式如下：$C^m_n=\dfrac{n!}{m! \times (n-m)!}$，其中保证$m \leq n$，表示在$n$个元素中选出$m$个元素的组合数。

为了方便理解，举一个例子：在th16.5秘封噩梦日记的第三周目中，每一天的战斗都有$4$个角色两两组合出场，那么很显然就有$C^2_4=6$种组合方式。

关于这方面的更详细解释，请看样例说明。

由于她对新事物都存在着好奇，因此她想要知道$C^m_n$是多少。这对她来说是个很简单的事情，因此她看了一眼就秒了，因此她决定求出下列式子：

$\sum_{i=1}^n \sum_{j=1}^m C^i_j$，其中当$i>j$的时候，钦定$C^i_j$为$0$

她也很快就算出来了，不过对自己的答案不是很充满信心，因此你决定帮助她。然而没事找事的她一下子算了$q$次对于不同的$n,m$的结果，因此这只能劳烦你了。由于你不打算真正地帮助她，你无需把答案对$998244353$取模，也无需对$64123$取模，只要告诉她对$19260817$取模之后的答案即可。
## 输入格式

第一行输入一个$q$，表示有$q$次询问。

第二行开始，一共$q$行，每行两个数字$n,m$，意思如题所示。
## 输出格式

一共$q$行，对于每一个询问，都输出一个答案。
## 样例

### 样例输入 #1
```
5
2 3
1 4
4 3
2 5
3 5
```
### 样例输出 #1
```
10
10
11
35
50
```
## 提示

![](https://i.loli.net/2018/12/15/5c148dbe83f11.jpg)

关于组合数的样例说明。

例如有蕾米莉亚 芙兰朵露 圣白莲 丰聪耳神子在这一天组合出场，会有六种情况：

1、蕾米莉亚x芙兰朵露 $\text{\color{white}背德组}$

2、丰聪耳神子x圣白莲 $\text{\color{white}宗教组}$

3、蕾米莉亚x丰聪耳神子

4、芙兰朵露x丰聪耳神子

5、蕾米莉亚x圣白莲

6、芙兰朵露x圣白莲


---

---
title: "[LnOI2019SP] 快速多项式变换(FPT)"
layout: "post"
diff: 普及+/提高
pid: P5248
tag: ['Special Judge', 'O2优化']
---
# [LnOI2019SP] 快速多项式变换(FPT)
## 题目背景

![avartar](https://cdn.luogu.com.cn/upload/pic/52800.png)
## 题目描述

这是一道构造题。

诗乃在心中想了一个$n+1$项的多项式$f(x)$。第$i$项次数为$i$，系数为$a_i$：

$$f(x)=a_0+a_1x+a_2x^2+a_3x^3+ \cdots +a_nx^n$$

给定$m$以及$f(m)$的值（即当$x=m$时此多项式的值），请构造多项式，满足任意$0 \leq a_i < m$且$a_i$为非负整数。

设你构造的多项式项数为$n$，则必须满足$1 ≤ n ≤ 100$且最高项系数不为零。
## 输入格式

两个整数，$m$、$f(m)$。
## 输出格式

第一行输出正整数$n$，表示多项式的项数。

第二行依次输出$n$个非负整数（$a_0$至$a_{n-1}$），每个非负整数之间用**一个**空格隔开。
## 样例

### 样例输入 #1
```
10 10
```
### 样例输出 #1
```
2
0 1
```
## 提示

对于20%的数据， $ 2 ≤ m ≤ 5. $

对于100%的数据，
 $ 2 ≤ m,f(m) ≤ 10^{18}.$

所有数据的时间限制为 $1000ms$，空间限制为 $256MB$，可开启O2优化。


---

---
title: "[JSOI2013] 丢番图"
layout: "post"
diff: 普及+/提高
pid: P5253
tag: ['2013', 'O2优化']
---
# [JSOI2013] 丢番图
## 题目背景

丢番图是亚历山大时期埃及著名的数学家。他是最早研究整数系数不定方程的数学家之一。

为了纪念他，这些方程一般被称作丢番图方程。最著名的丢番图方程之一是

$$x^n+y^n=z^n$$

费马提出，对于 $n>2$, $x,y,z$ 没有正整数解。这被称为“费马大定理”，它的证明直到最近才被安德鲁·怀尔斯（AndrewWiles）证明。
## 题目描述

考虑如下的丢番图方程：

$$\frac{1}{x}~+~\frac{1}{y}~=~\frac{1}{n}~,(x,y,n~\in~N^+)$$

小G对下面这个问题十分感兴趣：对于一个给定的正整数 $n$，有多少种本质不同的解满足上面的方程？例如 $n=4$，有三种本质不同 ($x~\leq~y$)的解：

> $\frac{1}{5}+\frac{1}{20}~=~\frac{1}{4}$
>
> $\frac{1}{6}+\frac{1}{12}~=~\frac{1}{4}$
>
> $\frac{1}{8}+\frac{1}{8}~=~\frac{1}{4}$

显然，对于更大的 $n$，没有意义去列举所有本质不同的解。你能否帮助小G快速地求出对于给定 $n$，满足上面方程的本质不同的解的个数？
## 输入格式

一行，仅一个整数 $n$。
## 输出格式

一行一个整数代表答案。
## 样例

### 样例输入 #1
```
4
```
### 样例输出 #1
```
3
```
## 提示

#### 数据规模与约定

对于全部的测试点，保证 $1\leq n \leq 10^{14}$。


---

---
title: "[SNOI2019] 字符串"
layout: "post"
diff: 普及+/提高
pid: P5329
tag: ['2019', '各省省选', '陕西']
---
# [SNOI2019] 字符串
## 题目描述

给出一个长度为$n$的由小写字母组成的字符串$a$，设其中第$i$个字符为$a_i(1≤i≤n)$ 。

设删掉第$i$个字符之后得到的字符串为$s_i$，请按照字典序对$s_1,s_2,……,s_n$从小到大排序。若两个字符串相等，则认为编号小的字符串字典序更小。
## 输入格式

第一行一个整数$n$。

第二行一个长为$n$的由小写字母组成的字符串$a$。
## 输出格式

输出一行$n$个整数$k_1,k_2,……,k_n$，用空格隔开。表示$s_{k_1}<s_{k_2}<……<s_{k_n}$。
## 样例

### 样例输入 #1
```
7
aabaaab
```
### 样例输出 #1
```
3 7 4 5 6 1 2
```
## 提示

对于所有数据，$1≤n≤10^6$。

对于10%的数据，$1≤n≤2000$；

对于另外20%的数据，$1≤n≤10^5$且任意两个相邻字符$a_i,a_{i+1}$不相等；

对于另外30%的数据，$1≤n≤10^5$；

对于余下40%的数据，无特殊限制。


---

---
title: "[TJOI2019] 大中锋的游乐场"
layout: "post"
diff: 普及+/提高
pid: P5340
tag: ['2019', '各省省选', 'O2优化', '天津']
---
# [TJOI2019] 大中锋的游乐场
## 题目描述

大中锋正在一个游乐场里玩耍。游乐场里有 $n$ 个娱乐设施，娱乐设施之间相互有共 $m$ 条道路相连，经过每一条路都需要花费一定的时间。为了方便游客，每一个娱乐设施旁都会配有一个小卖部，一部分小卖部会销售可乐，另一部分会销售汉堡。

由于大中锋十分贪吃，所以每当他走到一个娱乐设施，他都会先去购买一杯可乐或一个汉堡，并把它们吃掉。但如果大中锋吃掉的汉堡数量比他喝掉的可乐数量多于 $k$ ，那他就会感到很渴；如果喝掉的可乐数量比吃掉的汉堡数量多于 $k$ ，那他就会感到很饿。

现在大中锋正在第 $a$ 个娱乐设施，他想前往第 $b$ 个娱乐设施，但在他前进的路途中他不希望自己很渴或很饿。大中锋想知道自己在路上少花费多少时间。但由于大中锋很懒惰，他不想思考这个问题。你能帮助他解决这个问题吗？

注意：大中锋非常贪吃，所以他到达每个点的第一件事是去吃(或者喝)，才考虑其他的事情，所以在起始点和终点他都会去买汉堡(可乐)，你也需要保证在这两个点他不会感到很饿或者很渴。
## 输入格式

输入的第一行是一个整数 $T$ 表示数据组数数，对于每组数据的格式如下：

第一行有三个整数，分别代表游乐场的娱乐设施个数 $n$，游乐场的道路数 $m$ ， 以及给出的参数 $k$，其含义见【题目描述】。

第二行有 $n$ 个整数，第 $i$ 个整数 $a_i$ 代表编号为 $i$ 的娱乐设施旁的小卖部销售的物品，$1$ 表示可乐，$2$ 表示汉堡。

第 $3$ 到第 $(m + 2)$ 行，每行三个整数 $u, v, w$，代表从第 $u$ 个娱乐设施到第 $v$ 个娱乐设施有存在一条双向道路，通过该道路需要花费时间 $w$。

第 $m + 3$ 行有两个整数 $s, t$ ，代表大中锋想从娱乐设施 $s$ 前往娱乐设施 $t$。
## 输出格式

对于每组数据输出一行一个整数表示答案。如果无解，请输出 $-1$。
## 样例

### 样例输入 #1
```
1
2 1 1
1 1
1 2 1
1 2
```
### 样例输出 #1
```
-1
```
### 样例输入 #2
```
1
2 1 2
1 1
1 2 1
1 2
```
### 样例输出 #2
```
1
```
## 提示

#### 数据规模与约定

- 对于 $30\%$ 的数据，保证 $n\leq 50,m\leq 1000$。
- 对于 $100\%$ 的数据，保证 $1 \leq n\leq 10000$，$1 \leq m\leq 100000$，$1 \leq k\leq 10$，$1 \leq a_i \leq 2$，$1 \leq u, v,s, t \leq n$，$1 \leq w \leq 10000$。

对于所有数据，保证 $1 \leq T \leq 10$ ，且每个测试点的大数据不超过 $2$ 个。

#### 题目补充说明

- 路径不一定是简单路径。
- 大中锋可以多次经过一个节点，同时每次都会取得汉堡/可乐。


---

---
title: "[PKUSC2018] 真实排名"
layout: "post"
diff: 普及+/提高
pid: P5368
tag: ['2018']
---
# [PKUSC2018] 真实排名
## 题目描述

小 C 是某知名比赛的组织者，该比赛一共有 $n$ 名选手参加，每个选手的成绩是一个非负整数，定义一个选手的排名是：成绩不小于他的选手的数量（包括他自己）。例如如果 $3$ 位选手的成绩分别是 $[1 , 2 ,2]$ ，那么他们的排名分别是 $[3,2,2]$ 。

拥有上帝视角的你知道所有选手的实力，所以在考试前就精准地估计了每个人的成绩，设你估计的第 $i$ 个选手的成绩为$A_i$，且由于你是上帝视角，所以如果不发生任何意外的话，你估计的成绩就是选手的最终成绩。

但是在比赛当天发生了不可抗的事故（例如遭受到了外星人的攻击），导致有一些选手的成绩变成了最终成绩的两倍，即便是有上帝视角的你也不知道具体是哪些选手的成绩翻倍了，唯一知道的信息是这样的选手恰好有 $k$ 个。

现在你需要计算，经过了不可抗事故后，对于第 $i$ 位选手，有多少种情况满足他的排名没有改变。

由于答案可能过大，所以你只需要输出答案对 $998244353$ 取模的值即可。

## 输入格式

第一行两个正整数 $n,k$。

第二行 $n$ 个非负整数 $A_1, A _ 2, \cdots, A_n$。

## 输出格式

输出 $n$ 行，第 $i$ 行一个非负整数 $ans_i$，表示经过不可抗事故后，第 $i$ 位选手的排名没有发生改变的情况数。

## 样例

### 样例输入 #1
```
3 2
1 2 3
```
### 样例输出 #1
```
3
1
2
```
## 提示

- 对于 $10\%$ 的数据，有 $1\leq n\leq 15$；
- 对于 $35\%$ 的数据，有 $1\leq n\leq 10^3$；
- 另有 $10\%$ 的数据，满足每个人的成绩都互不相同；
- 另有 $10\%$ 的数据，满足 $0\leq A_i\leq 10^5$；
- 另有 $10\%$ 的数据，满足 $k=85$，$0\leq A_i\leq 600$；
- 对于$100\%$的数据，有$1\leq k < n\leq 10^5$，$0\leq A_i\leq 10^9$。



---

---
title: "X龙珠"
layout: "post"
diff: 普及+/提高
pid: P5462
tag: ['洛谷月赛']
---
# X龙珠
## 题目描述

“X龙珠”是一款益智小游戏。游戏中有 $n(2|n)$ 个编号互不相同龙珠按照给定的顺序排成一个队列，每个龙珠上面都有一个编号。每次操作时，选择并取出龙珠队列中**相邻**的两个龙珠，放到目标队列的末尾（目标队列最开始是空的，且这两个龙珠的前后顺序不变），然后去除原龙珠队列的空隙。反复多次，直到原龙珠队列为空。可见，因为决策不一样导致目标队列顺序不一样。现在请求出所有方案中、目标队列字典序最大的方案。只需要给出目标队列即可。

例如，当原龙珠队列是 [1,3,2,4] 时，可以先取出 3 和 2，此时目标队列是 [3,2]，原龙珠队列是 [1,4]；再将剩下两个龙珠放入目标队列，得到目标队列是 [3,2,1,4]
## 输入格式

第一行，一个整数 $n$。

接下来一行，每行 $n$ 个整数，表示原龙珠队列的编号。
## 输出格式

一行，$n$ 个整数。
## 样例

### 样例输入 #1
```
4 
3 1 4 2
```
### 样例输出 #1
```
4 2 3 1
```
### 样例输入 #2
```
6 
6 5 4 1 3 2
```
### 样例输出 #2
```
6 5 4 1 3 2
```
## 提示

对于 20% 的数据，$n\le10$。  
对于 60% 的数据，$n\le10^3$。  
对于 100% 的数据，$n\le10^5$，龙珠编号不超过 n。



---

---
title: "小鱼比可爱（加强版）"
layout: "post"
diff: 普及+/提高
pid: P5463
tag: ['洛谷月赛']
---
# 小鱼比可爱（加强版）
## 题目描述

人比人，气死人；鱼比鱼，难死鱼。小鱼最近参加了一个“比可爱”比赛，比的是每只鱼的可爱程度。参赛的鱼被从左到右排成一排，头都朝向左边，然后每只鱼会得到一个整数数值，表示这只鱼的可爱程度，很显然整数越大，表示这只鱼越可爱，而且任意两只鱼的可爱程度可能一样。由于所有的鱼头都朝向左边，所以每只鱼只能看见在它左边的鱼的可爱程度，它们心里都在计算，在自己的眼力范围内有多少只鱼不如自己可爱呢。请你帮这些可爱但是鱼脑不够用的小鱼们计算一下。

和之前的要求不一样，比赛组委会关心的是这个排列的“总得意值”。一共有 $n$ 只小鱼，总共有 $\frac{n(n+1)}2$ 个不同的区间。每个区间的得意值等于这个区间中符合“左边的一只鱼的可爱值比右边的一只鱼可爱值更大”的对数（其实就是区间逆序对数啦）。总得意值就是所有区间的“得意值”的和。现在要求输出“总得意值”是多少。
## 输入格式

第一行输入一个整数 $n$，表示鱼的数目。

第二行内输入 $n$ 个整数 $a_1,a_2,\cdots,a_n$，用空格间隔，依次表示从左到右每只小鱼的可爱程度。
## 输出格式

输出一个整数表示答案。
## 样例

### 样例输入 #1
```
8
1 9 2 6 0 8 1 7
```
### 样例输出 #1
```
106
```
### 样例输入 #2
```
10
1 10 8 5 6 2 3 9 4 7
```
### 样例输出 #2
```
270
```
### 样例输入 #3
```
20
6 0 4 5 8 8 0 6 6 1 0 4 6 6 0 0 7 2 0 5
```
### 样例输出 #3
```
3481
```
## 提示

测试点　　　|$n$　　　　|$a_i$　　　　|是否有重复数字 　
:-:|:-:|:-:|:-:
$1$|$1$|无特殊限制|否
$2$|$10$|无特殊限制|否
$3$|$10$|无特殊限制|是
$4$|$1000$|$\le10$|是
$5$|$1000$|无特殊限制|否
$6$|$1000$|无特殊限制|是
$7$|$10^5$|$\le100$|是
$8$|$3\times 10^5$|无特殊限制|否
$9$|$5\times 10^5$|无特殊限制|是
$10$|$10^6$|无特殊限制|是

对于 $100\%$ 的数据，$n \le 10^6$，$a_i\le 10^9$，所有数字均为非负整数。


---

---
title: "[Celeste-B] Golden Feather"
layout: "post"
diff: 普及+/提高
pid: P5560
tag: []
---
# [Celeste-B] Golden Feather
## 题目背景

> 就是这样，Madeline。

> 保持呼吸。你能行。
## 题目描述

“你的呼吸让那片羽毛一直飘着。”

“平稳缓慢地呼吸，吸气，吐气。”

“看吧，每次都是这么轻松。”

随着 Madeline 的呼吸，羽毛上下移动着。

通过 Madeline 的观察，她还发现，羽毛似乎遵循这一种神奇的运动轨迹。

在每一轮呼吸中，羽毛会在特定的地方停止，这些地方都是有魔力的，具体来说，第 $i$ 个停留处的魔力是 $(i+1)^2-1$。

并且，在一轮呼吸停止时，羽毛会渗透出一些能量，只要能用这些能量沟通这些停止的地方，Madeline 就能运用羽毛的力量飞翔。更具体的，由于同性相斥，两个地方魔力的相似程度越高就越难被沟通，沟通两个地方所需要的能量为这两个地方魔力的 $gcd$。

在一轮一轮的呼吸中，Madeline 已经无暇算出最少需要的能量，由于羽毛渗透出的能量不多，你能帮帮她算出最少需要多少能量来沟通这些羽毛停止的地方吗？
## 输入格式

第一行一个正整数 $T$，表示呼吸轮数。

接下来 $T$ 行一行一个正整数 $n$，表示该轮呼吸中羽毛停止的地方个数。
## 输出格式

输出 $T$ 行，一行一个整数，最少需要的能量。
## 样例

### 样例输入 #1
```
4
1
2
3
9

```
### 样例输出 #1
```
0
1
2
8
```
## 提示

n=3 的样例解释如下图

![T1_2.png](https://i.loli.net/2019/09/14/PtflkNCE8b3iKzB.png)
![T1.png](https://i.loli.net/2019/09/14/AIYlMZgonL7thfu.png)

对于 $5\%$ 的数据，$n \leq 3$

对于 $10\%$ 的数据，$n \leq 1000$

对于 $50\%$ 的数据，$n \leq 10^6$,$T \leq 10$

对于 $100\%$ 的数据，$n \leq 10^{18}$,$T \leq 100$


---

---
title: "[PA 2014] Fiolki"
layout: "post"
diff: 普及+/提高
pid: P5578
tag: ['2014', 'PA（波兰）']
---
# [PA 2014] Fiolki
## 题目描述

化学家吉丽想要配置一种神奇的药水来拯救世界。

吉丽有 $n$ 种不同的液体物质，和 $n$ 个药瓶（均从 $1$ 到 $n$ 编号）。初始时，第 $i$ 个瓶内装着 $g_i$ 克的第 $i$ 种物质。

吉丽需要执行一定的步骤来配置药水，第 $i$ 个步骤是将第 $a_i$ 个瓶子内的所有液体倒入第 $b_i$ 个瓶子，此后第 $a_i$ 个瓶子不会再被用到。瓶子的容量可以视作是无限的。

吉丽知道某几对液体物质在一起时会发生反应产生沉淀，具体反应是 $1$ 克 $c_i$ 物质和 $1$ 克 $d_i$ 物质生成 $2$ 克沉淀，一直进行直到某一反应物耗尽。生成的沉淀不会和任何物质反应。

当有多于一对可以发生反应的物质在一起时，吉丽知道它们的反应顺序。每次倾倒完后，吉丽会等到反应结束后再执行下一步骤。

吉丽想知道配置过程中总共产生多少沉淀。
## 输入格式

第一行三个整数 $n,m,k$，分别表示药瓶的个数（即物质的种数），操作步数，可以发生的反应数量。

第二行有 $n$ 个整数 $g_1,g_2,…,g_n$，表示初始时每个瓶内物质的质量。

接下来 $m$ 行，每行两个整数 $a_i,b_i$，表示第 $i$ 个步骤。保证 $a_i$ 在以后的步骤中不再出现。

接下来 $k$ 行，每行是一对可以发生反应的物质 $c_i,d_i$，按照反应的优先顺序给出。同一个反应不会重复出现。
## 输出格式

输出总共产生的沉淀质量。
## 样例

### 样例输入 #1
```
3 2 1
2 3 4
1 2
3 2
2 3
```
### 样例输出 #1
```
6
```
## 提示

对于 $100\%$ 的数据，$0\le m<n\le 2\times 10^5$，$0\le k\le 5\times 10^5$，$1\le g_i\le 10^9$，$1\le a_i,b_i,c_i,d_i\le n$，$a_i\ne b_i$，$c_i\ne d_i$。


---

---
title: "「SWTR-1」Ethan and Sets"
layout: "post"
diff: 普及+/提高
pid: P5583
tag: ['2019', 'Special Judge']
---
# 「SWTR-1」Ethan and Sets
## 题目描述

$\mathrm{Ethan}$ 有 $n$ 个数字集合，每个集合有如下属性：

编号：第 $i$ 个集合编号为 $i$。

大小：第 $i$ 个集合大小为 $num_i$。

魔力：第 $i$ 个集合魔力为 $t_i$。

数字：第 $i$ 个集合中含有数字 $c_{i,1},c_{i,2},\dots,c_{i,num_i}$。

在 $\mathrm{Ethan}$ 的世界中，一共只有 $m+1$ 个数：$0$ 到 $m$。

$\mathrm{Ethan}$ 对数字有奇特的感情，在这 $m+1$ 个数中，有 $d$ 个数是他喜欢的，分别是 $p_1,p_2,\dots,p_d$ ，剩下 $m-d+1$ 个是他不喜欢的。

现在 $\mathrm{Ethan}$ 要删除一些集合，准确来说，他要选择一段区间 $[L,R]$，**删除所有编号在这个区间以外的集合**。

- 他想要使得在剩余的集合中，包含**所有**他喜欢的数。

- 并且在剩余的集合中，他**不喜欢的数的个数尽可能小**（注：这里的个数是指出现的次数，即如果 $1$ 是 $\mathrm{Ethan}$ 不喜欢的数，并且剩余的集合中出现了 $3$ 个 $1$，那么算 $3$ 个不喜欢的数）。

- 如果有多个满足条件的区间，他想要使得剩余集合的**魔力之和尽可能大**。

求出满足要求的 $[L,R]$，如果无解输出 $-1$，如果有多解，输出任意一解。
## 输入格式

第一行三个整数 $n,m,d$。

第二行 $d$ 个整数 $p_1,p_2,\dots,p_d$。

第三行至第 $n+2$ 行：每行先是两个整数 $t_i,num_i$，随后 $num_i$ 个整数 $c_{i,1},c_{i,2},\dots,c_{i,num_i}$。
## 输出格式

一行，如果无解输出 $-1$，否则输出两个整数 $L,R$。
## 样例

### 样例输入 #1
```
5 7 4
1 3 4 5
3 3 4 6 5
4 2 1 5
2 3 1 7 3
5 2 2 4
6 6 3 5 4 6 1 7
```
### 样例输出 #1
```
2 4
```
### 样例输入 #2
```
2 3 2
1 2
4 1 1
4 2 1 3
```
### 样例输出 #2
```
-1
```
### 样例输入 #3
```
4 3 2
1 2
1 1 3
1 2 1 2
1 1 2
1 3 1 2 3
```
### 样例输出 #3
```
2 3
```
## 提示

---

### 样例解释：

在样例 $1$ 中，$\mathrm{Ethan}$  可以选择 $[2,4]$，这样在剩余的集合中包含了所有他喜欢的数，且只有 $2$ 个他不喜欢的数在这些集合中出现。

在样例 $2$ 中，不存在合法的解。

---

### 数据范围：

本题使用 subtask。

subtask 1，$1 \leq n,m \leq 100$，$20\%$。

subtask 2，$1 \leq n,m \leq 500$，$30\%$。

subtask 3，$1 \leq n \leq 3000, 1 \leq m \leq 1000, 1 \leq t_i \leq 10^9$，$50\%$。


---

---
title: "[CSP-J2019 江西] 道路拆除"
layout: "post"
diff: 普及+/提高
pid: P5683
tag: ['2019', 'CSP-J 入门级']
---
# [CSP-J2019 江西] 道路拆除
## 题目描述

A 国有 $n$ 座城市，从 $1 \sim n$ 编号。$1$ 号城市是 A 国的首都。城市间由 $m$ 条双向道路连通，通过每一条道路所花费的时间均为 $1$ 单位时间。  

现在 A 国打算拆除一些不实用的道路以减小维护的开支，但 A 国也需要保证主要线路不受影响。因此 A 国希望道路拆除完毕后，利用剩余未被拆除的道路，从 A 国首都出发，能到达 $s_1$ 号与 $s_2$ 号城市，且所要花费的最短时间分别不超过 $t_1$ 与 $t_2$（注意这是两个独立的条件，互相之间没有关联，即不需要先到 $s_1$ 再到 $s_2$）。

A 国想请你帮他们算算，在满足上述条件的情况下，他们最多能拆除多少条道路。 若上述条件永远无法满足，则输出 $-1$。
## 输入格式

第一行两个正整数 $n,m$，表示城市数与道路数。  

接下来 $m$ 行，每行两个正整数 $x,y$，表示一条连接 $x$ 号点与 $y$ 号点的道路。

最后一行四个整数，分别为 $s_1,t_1,s_2,t_2$。
## 输出格式

仅一行一个整数，表示答案。
## 样例

### 样例输入 #1
```
5 6
1 2
2 3
1 3
3 4
4 5
3 5
5 3 4 3
```
### 样例输出 #1
```
3
```
### 样例输入 #2
```
3 2
1 2
2 3
2 2 3 1
```
### 样例输出 #2
```
-1
```
## 提示

【数据范围】  
对于 $30\%$ 的数据，$n,m \le 15$；   
另有 $20\%$ 的数据，$n \le 100$，$m = n-1$；   
另有 $30\%$ 的数据，$s_1 = s_2$；  
对于 $100\%$ 的数据，$2 \le n,m \le 3000$，$1\le x,y \le n$，$2 \le s_1,s_2 \le n$，$0 \le t_1,t_2 \le n$。  

【样例 $1$ 解释】  
拆除 $(1,2),(2,3),(3,4)$ 三条边。  
注意：不需要令首都与除了 $s_1,s_2$ 外的点在拆除之后依然连通。

【样例 $2$ 解释】  
即使一条边都不拆除，首都到 $3$ 号点的最短时间也都达到了 $2$ 单位时间。

testdata by @DYH060310 


---

---
title: "[CSP-S2019 江西] 网格图"
layout: "post"
diff: 普及+/提高
pid: P5687
tag: ['2019', 'CSP-S 提高级']
---
# [CSP-S2019 江西] 网格图
## 题目背景

JXCSP-S T3
## 题目描述

给定一个 $n\times m$ 的网格图，行从 $1\sim n$ 编号，列从 $1\sim m$ 编号，每个点可用它所在的行编号 $r$ 与所在的列编号 $c$ 表示为 $(r, c)$。

点 $(i,j)$ 与 $(i,j+1)$ 间连有一条权值为 $a_i$ 的边，其中 $1\le i\le n, 1\le j<m$。

点 $(i, j)$ 与 $(i+1,j)$ 间连有一条权值为 $b_j$ 的边，其中 $1\le i< n, 1\le j \le m$。

请你求出这个网格图的最小生成树。
## 输入格式

第一行两个正整数 $n, m$ 表示行数与列数。

第二行 $n$ 个正整数表示 $a_i$。

第三行 $m$ 个正整数表示 $b_j$。
## 输出格式

仅一行一个整数表示答案。
## 样例

### 样例输入 #1
```
3 3
2 4 3
1 3 2
```
### 样例输出 #1
```
16
```
## 提示

#### 【输入输出样例 1 说明】
最小生成树中的边包括：第一行上的所有边，第一列、第二列、第三列上的所有边。

#### 【数据规模与约定】

对于 $20\%$ 的数据，$n, m\le 3$，$a_i, b_j \le 10$；

对于 $40\%$ 的数据，$n, m\le 20$，$a_i, b_j\le 100$；

对于 $64\%$ 的数据，$n, m\le 300$，$a_i, b_j\le 1000$；

对于 $100\%$ 的数据：$3\le n, m \le 3\times 10^5$，$1 \le a_i, b_j\le 10^5$。 


---

---
title: "[NOI2002] 机器人M号"
layout: "post"
diff: 普及+/提高
pid: P5746
tag: ['2002', 'NOI', 'Special Judge']
---
# [NOI2002] 机器人M号
## 题目描述

3030 年，Macsy 正在火星部署一批机器人。

第 $1$ 秒，他把机器人 $1$ 号运到了火星，机器人 $1$ 号可以制造其他的机器人。

第 $2$ 秒，机器人 $1$ 号造出了第一个机器人——机器人 $2$ 号。

第 $3$ 秒，机器人 $1$ 号造出了另一个机器人——机器人 $3$ 号。

之后每一秒，机器人 $1$ 号都可以造出一个新的机器人。第 $m$ 秒造出的机器人编号为 $m$。我们可以称它为机器人 $m$ 号，或者 $m$ 号机器人。

机器人造出来后，马上开始工作。$m$ 号机器人，每 $m$ 秒会休息一次。比如 $3$ 号机器人，会在第 $6$，$9$，$12$，$\ldots$ 秒休息，而其它时间都在工作。

机器人休息时，它的记忆将会被移植到当时出生的机器人的脑中。比如 $6$ 号机器人出生时，$2$，$3$ 号机器人正在休息，因此，$6$ 号机器人会收到第 $2$，$3$ 号机器人的记忆副本。我们称第 $2$，$3$ 号机器人是 $6$ 号机器人的老师。

如果两个机器人没有师徒关系，且没有共同的老师，则称这两个机器人的知识是互相独立的。**注意：$1$ 号机器人与其他所有机器人的知识独立（因为只有 $1$ 号才会造机器人），它也不是任何机器人的老师。**

一个机器人的**独立数**，是指所有编号比它小且与它知识互相独立的机器人的个数。比如 $1$ 号机器人的独立数为 $0$，$2$ 号机器人的独立数为 $1$（$1$ 号机器人与它知识互相独立），$6$ 号机器人的独立数为 $2$（$1$，$5$ 号机器人与它知识互相独立，$2$，$3$ 号机器人都是它的老师，而 $4$ 号机器人与它有共同的老师——$2$ 号机器人）。

新造出来的机器人有 $3$ 种不同的职业。对于编号为 $m$ 的机器人，如果能把 $m$ 分解成偶数个不同奇素数的积，则它是政客，例如编号 $15$；否则，如果 $m$ 本身就是奇素数或者能把 $m$ 分解成奇数个不同奇素数的积，则它是军人，例如编号 $3$，编号 $165$。其它编号的机器人都是学者，例如编号 $2$, 编号 $6$, 编号 $9$。

第 $m$ 秒诞生的机器人 $m$ 号，想知道它和它的老师中，所有政客的独立数之和，所有军人的独立数之和，以及所有学者的独立数之和。可机器人 $m$ 号忙于工作没时间计算，你能够帮助它吗？

为了方便你的计算，Macsy 已经帮你做了 $m$ 的素因子分解。为了输出方便，只要求输出总和除以 $10000$ 的余数。
## 输入格式

输入的第一行是一个正整数 $k$，$k$ 是 $m$ 的不同的素因子个数。

以下 $k$ 行，每行两个整数，$p_i$, $e_i$,表示 $m$ 的第 $i$ 个素因子和它的指数 $(i=1,2,\ldots,k)$。$p_1,p_2,\ldots,p_k$ 是不同的素数，$\prod_{i=1}^kp_i^{e_i}$。所有素因子按照从小到大排列，即 $p_1<p_2<\ldots<p_k$。
## 输出格式

输出包括三行。

- 第一行是机器人 $m$ 号和它的老师中，所有政客的独立数之和除以 $10000$ 的余数。
- 第二行是机器人 $m$ 号和它的老师中，所有军人的独立数之和除以 $10000$ 的余数。
- 第三行是机器人 $m$ 号和它的老师中，所有学者的独立数之和除以 $10000$ 的余数。
## 样例

### 样例输入 #1
```
3
2 1
3 2
5 1
```
### 样例输出 #1
```
8
6
75
```
## 提示

#### 样例解释
$m = 2\times 3^2\times 5=90$。$90$ 号机器人有 $10$ 个老师，加上它自己共 $11$ 个。其中政客只有 $15$ 号；军人有 $3$ 号和 $5$ 号；学者有 $8$ 个，它们的编号分别是：$2,6,9,10,18,30,45,90$。

#### 数据范围
对于全部的数据，$1\le k\le 1000$，$2\le p_i<10,000$，$1\le e_i\le 1,000,000$。

#### 评分规则

你在一个测试点的得分与你正确解决的问题数 $x$ 有关。

请注意：**对每一行，即使不会解决该问题，也请在该行输出一个数字，否则 checker 将无法正确评分。**

| $x$  | 得分 |
| :--: | :--: |
|  3   |  10  |
|  2   |  7   |
|  1   |  4   |
|  0   |  0   |


---

---
title: "[NOI1999] 01串"
layout: "post"
diff: 普及+/提高
pid: P5751
tag: ['1999', 'NOI']
---
# [NOI1999] 01串
## 题目描述

给定 $7$ 个整数 $N , A_0 , B_0 , L_0 , A_1 , B_1 , L_1 $，要求设计一个01串$ S=s_1 s_2 … s_i … s_N $，满足：
1.	$ s_i = 0 $ 或 $ s_i = 1 $， $ 1 \leq i \leq N $；
2.	对于 $S$ 的任何连续的长度为 $L_0$ 的子串 $s_j s_{j+1} … s_{j+L0-1}  $ ($1 \leq j \leq N-L_0+1 $) ， $0$ 的个数大于等于 $A_0$ 且小于等于 $B_0$ ;
3.	对于 $S$ 的任何连续的长度为 $L_1$ 的子串 $s_j s_{j+1} …  s_{j+L1-1} $ ($ 1 \leq  j  \leq N-L_1+1 $) ， $1$ 的个数大于等于 $A_1$ 且小于等于 $B_1$ ;

例如， $ N = 6 ,  A_0 = 1 ,  B_0 = 2  ,  L_0 = 3 ,  A_1 = 1 ,  B_1 = 1 ,  L_1 = 2 $，则存在一个满足上述所有条件的 $01$ 串 $ S = 010101 $ 。

## 输入格式

仅一行，有 $7$ 个整数，依次表示 $N , A_0 , B_0 , L_0 , A_1 , B_1 , L_1 $ （$3 \leq N \leq 1000$，$1 \leq  A_0 \leq B_0 \leq L_0 \leq N$，$1 \leq A_1 \leq B_1 \leq L_1 \leq N$），相邻两个整数之间用一个空格分隔。
## 输出格式

仅一行，若不存在满足所有条件的 $01$ 串，则输出一个整数 `-1`，否则输出满足所有条件的 $01$ 串中 $1$ 的个数的最大值。
## 样例

### 样例输入 #1
```
6 1 2 3 1 1 2

```
### 样例输出 #1
```
3

```


---

---
title: "[NOI1999] 棋盘分割"
layout: "post"
diff: 普及+/提高
pid: P5752
tag: ['1999', 'NOI', 'Special Judge']
---
# [NOI1999] 棋盘分割
## 题目描述

将一个 8 $\times$ 8 的棋盘进行如下分割：将原棋盘割下一块矩形棋盘并使剩下部分也是矩形，再将剩下的部分继续如此分割，这样割了 $(n-1)$ 次后，连同最后剩下的矩形棋盘共有 $n$ 块矩形棋盘。 (每次切割都只能沿着棋盘格子的边进行)


![](https://cdn.luogu.com.cn/upload/image_hosting/ivf3ggl3.png)


原棋盘上每一格有一个分值，一块矩形棋盘的总分为其所含各格分值之和。现在需要把棋盘按上述规则分割成 $n$ 块矩形棋盘，并使各矩形棋盘总分的均方差最小。


均方差 $\sigma = \sqrt{ \frac{ \sum_{i=1}^n (x_i - \bar x)^2 } { n }}$                ，其中平均值 $\bar x = \frac{\sum_{i=1}^n x_i}{n}$ ,  $x_i$ 为第 $i$ 块矩形棋盘的分。


请编程对给出的棋盘及 $n$ ，求出 $\sigma$ 的最小值。

## 输入格式

第一行为一个整数 $n$ ($ 1 < n< 15 $)。


第二行至第九行每行为 $8$ 个小于 $100$ 的非负整数，表示棋盘上相应格子的分值。每行相邻两数之间用一个空格分隔。

## 输出格式

仅一个数，为 $\sigma$ （四舍五入精确到小数点后三位）。
## 样例

### 样例输入 #1
```
3
1 1 1 1 1 1 1 3
1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 1
1 1 1 1 1 1 1 0
1 1 1 1 1 1 0 3

```
### 样例输出 #1
```
1.633

```


---

---
title: "[NOI2000] 程序分析器"
layout: "post"
diff: 普及+/提高
pid: P5756
tag: ['2000', 'NOI']
---
# [NOI2000] 程序分析器
## 题目描述

Tiny Basm语言(简称为TB语言)的巴科斯-瑙尔范式(BNF)为：

![](https://cdn.luogu.com.cn/upload/image_hosting/37ipxplt.png)

错误语句示例(在输入文件中不会出现任何错误语句)：

- `10A+1.5`（不符合累加语句的定义，所加的不是整数）
- `20A?`（不符合输出语句的定义，多加了一个空格）
- `30IFA=BGO10`（不符合条件语句的定义，不应变量=变量）

$\\$

TB程序的执行：
-	程序从行号最小的一条语句开始执行，在未遇到条件语句时按行号由小至大顺序执行。
-	所有变量在程序执行前被自动初始化为 $0$。
-	累加语句将语句中变量的值加上语句中的整数送回该变量。
-	输出语句将语句中变量的值在监视器上显示出来。
-	执行条件语句时，当且仅当该语句中的变量与紧跟在等号后面的整数值相等，后面的转移语句才被执行。该语句中的所有整数值至多为 $4$ 位。
-	转移语句被执行后，程序将转去执行 $\tt GO$ 后面指定的行号的语句。
-	当程序执行结束语句后，结束整个程序的执行。
-	假设该系统能处理任意大小的整数，而不会发生溢出。


请编程，对于给定的 TB 语言程序 $P$，求该程序所执行的语句数（执行条件语句不论是否成功转移，仅记为执行一条语句）。
## 输入格式

- 为一个TB语言程序 $P$ ，语句数不超过 $100$ 行。
- $P$ 中每条语句的长度不超过 $20$ 个字符。
- $P$ 中转移语句里 $\tt GO$ 后面的行号一定有对应的语句。
- $P$ 中可能有多个不同行号的结束语句。
- $P$ 中行号最大的语句一定是结束语句。
- $P$ 中的行号都不大于 $3000$。
- 输入文件不一定是按行号递增顺序给出 $P$ 的。

## 输出格式

-	有且仅有一行：

如果程序能够正常结束，输出该程序所执行的语句数；

如果程序不能正常结束，输出 $-1$。

## 样例

### 样例输入 #1
```
10 A+1
20 IF A=5 GO 60
60 END
30 A+2
40 A?
50 GO 20

```
### 样例输出 #1
```
11

```
## 提示

**样例说明**

执行语句行号按顺序为 $10→20→30→40→50→20→30→40→50→20→60$。

共 $11$ 条语句被执行。



---

---
title: "[NOI1997] 积木游戏"
layout: "post"
diff: 普及+/提高
pid: P5760
tag: ['1997', 'NOI']
---
# [NOI1997] 积木游戏
## 题目描述

SERCOI 最近设计了一种积木游戏。每个游戏者有 $N$ 块编号依次为 $1 ，2，…，N$ 的长方体积木。对于每块积木,它的三条不同的边分别称为"a 边"、"b 边"和"c 边"，如下图所示：

![](https://cdn.luogu.com.cn/upload/image_hosting/jfd5li1k.png)

游戏规则如下：
1. 从 $N$ 块积木中选出若干块，并将它们分成 $M$ （$ 1 \le M \le N $） 堆，称为第 $1$ 堆，第 $2$ 堆…，第 $M$ 堆。每堆至少有 $1$ 块积木，并且第 $K$ 堆中任意一块积木的编号要大于第 $K+1$ 堆中任意一块积木的编号($ 2 \le K \le M $)。

2.  对于每一堆积木,游戏者要将它们垂直摞成一根柱子,并要求满足下面两个条件：

$\qquad$ 1)除最顶上的一块积木外，任意一块积木的上表面同且仅同另一块积木的下表面接触，并且要求下面的积木的上表面能包含上面的积木的下表面，也就是说，要求下面的积木的上表面的两对边的长度分别大于等于上面的积木的两对边的长度。

$\qquad$ 2)对于任意两块上下表面相接触的积木，下面的积木的编号要小于上面的积木的编号。

最后，根据每人所摞成的 $M$ 根柱子的高度之和来决出胜负。

请你编一程序，寻找一种摞积木的方案，使得你所摞成的 $M$ 根柱子的高度之和最大。

## 输入格式

一行有两个正整数 $N$ 和 $M$ （$ 1 \le M \le N \le 100 $），分别表
示积木总数和要求摞成的柱子数。这两个数之间用一个空格符隔开。

接下来 $N$ 行依次是编号从 $1$ 到 $N$ 的 $N$ 个积木的尺寸，每行有三个 $1$ 至 $1000$ 之间的整数，分别表示该积木 a 边, b 边和  c 边的长度。
同一行相邻两个数之间用一个空格符隔开。

## 输出格式

只有一行，为一个整数，表示 $M$ 根柱子的高度之和的最大值。
## 样例

### 样例输入 #1
```
4 2
10 5 5
8 7 7
2 2 2
6 6 6

```
### 样例输出 #1
```
24

```


---

---
title: "[NOI1999] 内存分配"
layout: "post"
diff: 普及+/提高
pid: P5763
tag: ['1999', 'NOI']
---
# [NOI1999] 内存分配
## 题目描述

内存是计算机重要的资源之一，程序运行的过程中必须对内存进行分配。

经典的内存分配过程是这样进行的：
1. 内存以内存单元为基本单位，每个内存单元用一个固定的整数作为标识，称为地址。地址从 $0$ 开始连续排列，地址相邻的内存单元被认为是逻辑上连续的。我们把从地址 $i$ 开始的 $s$ 个连续的内存单元称为首地址为 $i$ 长度为 $s$ 的地址片。 
2. 运行过程中有若干进程需要占用内存，对于每个进程有一个申请时刻 $T$ ，需要内存单元数 $M$ 及运行时间 $P$。在运行时间 $P$ 内（即 $T$ 时刻开始，$T+P$ 时刻结束），这 $M$ 个被占用的内存单元不能再被其他进程使用。 
3. 假设在 $T$ 时刻有一个进程申请 $M$ 个单元，且运行时间为 $P$ ，则：

$\qquad$ 1)	若 $T$ 时刻内存中存在长度为 $M$ 的空闲地址片，则系统将这 $M$ 个空闲单元分配给该进程。若存在多个长度为 $M$ 个空闲地址片，则系统将首地址最小的那个空闲地址片分配给该进程。 

$\qquad$ 2)    如果 $T$ 时刻不存在长度为 $M$ 的空闲地址片，则该进程被放入一个等待队列。对于处于等待队列队头的进程，只要在任一时刻，存在长度为 $M$ 的空闲地址片，系统马上将该进程取出队列，并为它分配内存单元。注意，在进行内存分配处理过程中，处于等待队列队头的进程的处理优先级最高，队列中的其它进程不能先于队头进程被处理。 

现在给出一系列描述进程的数据，请编写一程序模拟系统分配内存的过程。

## 输入格式

第一行是一个数 $N$ ，表示总内存单元数（即地址范围从 $0$ 到 $N-1$ ）
从第二行开始每行描述一个进程的三个整数 $T、M、P$ （$ M \le N$）。

**数据已按 $T$ 从小到大排序。**

最后一行用`000`表示结束。

输入文件最多 $10000$ 行，且所有数据都小于 $10^9$。

输入文件中同一行相邻两项之间用一个或多个空格隔开。

## 输出格式

共两行。

第一行是全部进程都运行完毕的时刻。

第二行是被放入过等待队列的进程总数。

## 样例

### 样例输入 #1
```
10
1 3 10
2 4 3
3 4 4
4 1 4
5 3 4
0 0 0

```
### 样例输出 #1
```
12
2

```


---

---
title: "[SEERC 2019] Projection"
layout: "post"
diff: 普及+/提高
pid: P5802
tag: ['2019', 'ICPC']
---
# [SEERC 2019] Projection
## 题目描述

![TensorFlow](https://cdn.luogu.com.cn/upload/image_hosting/gdl3vztm.png)

你是一个 TensorFlow 的死忠粉，因此，你想要从两个投影图形来还原出 TensorFlow 的图标。

假定你有一个 3D 空间，尺寸为 $n \times m \times h$，以及两个投影图形（一个 $n \times m$ 的矩阵和一个 $n \times h$ 的矩阵，矩阵里的元素都为 $0$ 或 $1$）。你需要计算出一些 $1 \times 1 \times 1$ 的小正方体的集合，使得这些正方体放入 3D 空间后构成的立体的正投影（光照立体正面在立体后侧形成的投影）和右投影（光照立体左面在立体右侧形成的投影）与题目给定的投影图形一致。如果无解，输出 $-1$。如果有解，你需要计算出两个满足条件的集合，一个包含的小正方体数量最少，另一个最多。假定正方体的摆放不受重力影响（即小正方体在 3D 空间中可以随意放置，悬空也不需要支撑）。规定矩阵中的 $1$ 代表有阴影遮住，$0$ 代表无阴影遮住。

如果有多解，你需要输出字典序最小的解。一个解 $a$ 字典序比解 $b$ 小，当且仅当对于两个解中第一对不相同的数字，$a$ 中的数字小于 $b$ 中的。

例如，解 $[(0, 0, 0), (1, 1, 1)]$ 比解 $[(1, 1, 1), (0, 0, 0)]$ 字典序更小。
## 输入格式

第一行包含三个整数 $n, m, h \ (1 \leq n,m,h \leq 100)$，代表 3D 空间的尺寸。

接下来的 $n$ 行中，每一行包含 $m$ 个字符 $0$ 或 $1$，其中 $1$ 代表有阴影遮住，$0$ 代表无阴影遮住。这 $n \times m$ 个字符描述了一个正投影。

接下来的 $n$ 行中，每一行包含 $h$ 个字符，格式同上。这 $n \times h$ 个字符描述了一个右投影。
## 输出格式

如果无解，仅在第一行输出 $-1$ 即可。

如果有解，第一行输出一个整数 $k_{max}$，代表满足题目要求的解中小正方体个数的最大值。

接下来 $k_{max}$ 行中每行输出三个整数 $x, y, z \ (0 \leq x < n, 0 \leq y < m, 0 \leq z < h)$，代表小正方体最多的解中字典序最小的解的 $k_{max}$ 个小正方体的放置位置。

接下来一行输出一个整数 $k_{min}$，代表满足题目要求的解中小正方体个数的最小值。

接下来 $k_{min}$ 行中每行输出三个整数 $x, y, z \ (0 \leq x < n, 0 \leq y < m, 0 \leq z < h)$，代表小正方体最少的解中字典序最小的解的 $k_{min}$ 个小正方体的放置位置。
## 样例

### 样例输入 #1
```
5 3 3
111
010
010
010
010
111
100
110
100
100
```
### 样例输出 #1
```
14
0 0 0
0 0 1
0 0 2
0 1 0
0 1 1
0 1 2
0 2 0
0 2 1
0 2 2
1 1 0
2 1 0
2 1 1
3 1 0
4 1 0
8
0 0 0
0 1 1
0 2 2
1 1 0
2 1 0
2 1 1
3 1 0
4 1 0
```
### 样例输入 #2
```
2 2 2
00
00
11
11
```
### 样例输出 #2
```
-1
```
### 样例输入 #3
```
2 3 2
101
011
10
11
```
### 样例输出 #3
```
6
0 0 0
0 2 0
1 1 0
1 1 1
1 2 0
1 2 1
4
0 0 0
0 2 0
1 1 0
1 2 1
```
## 提示

一个放置在 $(x, y, z)$ 的小正方体会在正投影的 $(x, y)$ 位置产生一个有阴影遮住的区域，并在右投影的 $(x, z)$ 位置产生一个有阴影遮住的区域。

坐标从 $0$ 开始编号。


---

---
title: "[IOI 2011] ricehub"
layout: "post"
diff: 普及+/提高
pid: P5844
tag: ['2011', 'IOI']
---
# [IOI 2011] ricehub
## 题目描述

乡间有一条笔直而长的路称为“米道”。沿着这条米道上$R$  块稻田，每块稻田的坐标均为一个 $1$ 到 $L$ 之间(含 $1$ 和 $L$ )的整数。这些稻田按照坐标以不减的顺序给出，即对于 $0 \le i < R$，稻田 $i$ 的坐标 $X[i]$ 满足 $1 \le X[0] \le \cdots \le X[R-1] \le L$。

注意：可能有多块稻田位于同一个坐标上。

我们计划建造一个米仓用于储存尽可能多的稻米。和稻田一样，米仓将建在米道上，其坐标也是一个 $1$ 到 $L$ 之间的整数（含 $1$ 和 $L$）。这个米仓可以建在满足上述条件的任一个位置上，包括那些原来已有一个或多个稻田存在的位置。

在收获季节，每一块稻田刚好出产一滿货车的稻米。为了将这些稻米运到米仓，需要雇用一位货车司机来运米。司机的收费是每一满货车运送一个单位的距离收取 $1$ 元。換言之，将稻米从特定的稻田运到米仓的费用在数值上等于稻田坐标与米仓坐标之差的绝对值。

不幸的是，今年预算有限，我们至多只能花费 $B$ 元运费。你的任务是要帮我们找出一个建造米仓的位置，可以收集到尽可能多的稻米。
## 输入格式

第一行 三个整数 $R,L,B$；

接下来 $R$ 行 每行一个整数 表示 $X[i]$。
## 输出格式

一个整数，表示最多稻米数
## 样例

### 样例输入 #1
```
5 20 6
1
2
10
12
14
```
### 样例输出 #1
```
3
```
## 提示

对于 $100\%$ 的数据，$1 \le R \le 10^5$，$1 \le L \le 10^9$，$ 0 \le B \le 2 \times 10^{15}$。


---

---
title: "[IOI 2005] mea"
layout: "post"
diff: 普及+/提高
pid: P5847
tag: ['2005', 'IOI']
---
# [IOI 2005] mea
## 题目描述

考虑一个非递减的整数序列 $S_1,\cdots,S_{n+1}$ ($S_i \le S{i+1}$，$1 \le i \le n$)。 序列 $M_1 \cdots M_n$ 是定义在序列 $S$ 的基础上，关系式为 $M_i = \frac{S_i + S_{i+1}}{2  }$（$1 \le i < n$）, 序列 $M$ 叫做序列 $S$ 的平均数序列。


例如序列 $1,2,2,4$ 的平均数序列为 $1.5,2,3$. 注意到平均数序列中的元素可能为小数。但是本题的任务只是处理平均数序列都为整数的情况。 

给出一个 $n$ 个数字的非递减的整数序列 $M_1,M_2,\cdots,M_n$。请你计算出：序列 $S_1,\cdots,S_{n+1}$ 的平均序列是 $M_1,\cdots,M_n$。 求满足以上条件的序列 $S$ 的总个数。

任务：从标准输入文件中读入一个非递减的整数序列。计算出平均序列是给出序列的整数序列的总个数。把计算结果写到标准输出文件中。
## 输入格式

输入文件的第一行包含一个整数 $n$ （$ 2 \le n \le 5 \times 10^6$）。

接下来的 $n$ 行包含了这个给出的整数序列 $M_1,\cdots,M_n$。第 $i+1$ 行包含一个整数 $M_i$ ( $1 \le m_i \le 10^9$)。
## 输出格式

输出文件仅一行，即所求答案。
## 样例

### 样例输入 #1
```
3
2
5
9

```
### 样例输出 #1
```
4

```
## 提示

**样例说明**

一共存在 $4$ 种序列，它们的平均数序列都是 $2,3,9$。这四种序列如下：
- $2,2,8,10$
- $1,3,7,11$
- $0,4,6,12$
- $-1,5,5,13$

**数据范围**

对于 $50\%$ 的数据，$2 \le n \le 1000$，$1 \le M_i \le 2 \times 10^4$；

对于 $100\%$ 的数据，$2 \le n \le 5 \times 10^6$，$1 \le M_i \le 10^9$。


---

---
title: "奖品"
layout: "post"
diff: 普及+/提高
pid: P5878
tag: ['NOI 导刊']
---
# 奖品
## 题目描述

学校刚开完运动会，准备为尽可能多的同学评奖，并为每个人颁发一份奖品。一份奖品包括 $N$ 个物品，如：$5$ 支铅笔、$10$ 本练习薄等。每份奖品完全一样。虽然学校的保管室里还有一些办去年运动会后剩余的物品。在商店里，每种物品都有很多，但是，只有两种包装：大盒或小盒，并且不拆开买。

现在的问题是，充分利用这 $M$ 元钱，最多可准备多少分这样的奖品？

## 输入格式

第一行两个整数：$N,M$。

下面有 $N$ 行，每行有六个正整数 $x,y,sm,pm,sv,pv$，分别表示一种物品的相关数据：

* $x$，一份奖品中，这种物品需要的件数。
* $y$，这种物品去年剩余的件数。
* $sm$，这种物品小包装的件数。
* $pm$，这种物品小包装的一盒价格。
* $sv$，这种物品大包装里的件数。
* $pv$，这种物品大包装的一盒价格。

## 输出格式

一个整数，最多可准备的礼品份数。
## 样例

### 样例输入 #1
```
2 100
10 8 10 10 13 11
12 20 6 10 17 24

```
### 样例输出 #1
```
5
```
### 样例输入 #2
```
3 65
10 5 7 10 13 14
10 5 8 11 14 15
10 5 9 12 15 16

```
### 样例输出 #2
```
2
```
## 提示

对于全部的数据，满足：

$1 \le N \le 100$，$1 \le M \le 10^5$。

$10 \le x, pm \le 100$，$1 \le y, sm \le 100$，$sm < sv \le 100$，$pm<pv\le 100$。


---

---
title: "放棋子"
layout: "post"
diff: 普及+/提高
pid: P5879
tag: ['NOI 导刊']
---
# 放棋子
## 题目描述

小虎刚刚上了幼儿园，老师让他做一个家庭作业：首先画 $3$ 行格子，第一行有三个格子，第二行有 $2$ 个格子，第三行有 $1$ 个格子。每行的格子从左到右可以放棋子，但要求除第一行外，每行放的棋子数不能超过上一行的棋子。第一行的棋子数不能为 $0$，但剩下行可以为空。玩了一会儿，小虎对哥哥大虎说：”这个作业有很多种摆放法，我想找到，但我不知道有多少种方案，你能帮助我吗？”

大虎是学校信息学集训队的，立刻想到用计算机来解决这个问题，并很快有了解答：$13$。

第二天他把问题拿到学校，并说如果第一行有 $N$ 个格子，第二行有 $N-1$ 个格子，……，第 $N$ 行有 $1$ 个格子，怎么办？现在请你一块来帮助他解决这个难题。
## 输入格式

仅一行，一个正整数 $N$。
## 输出格式

一行，方案总数。
## 样例

### 样例输入 #1
```
2
```
### 样例输出 #1
```
4
```
### 样例输入 #2
```
3
```
### 样例输出 #2
```
13
```
## 提示

样例 1 说明：$N=2$ 时，有如下 $4$ 种摆放棋子法（`*` 表示棋子，`_` 表示空格）：
|  方案数| 1 | 2 | 3 | 4 |
| :----------- | :----------- | :----------- | :----------- | :----------- |
| **第一行** | `*_` | `**` | `*_` | `**` |
| **第二行** | `_` | `_` | `*` | `*` |


对于 $30\%$ 数据：$1\le N\le 12$。

对于 $50\%$ 数据：$1\le N\le 30$。

对于 $100\%$ 数据：$1\le N\le 100$。



---

---
title: "[IOI 2014] game 游戏"
layout: "post"
diff: 普及+/提高
pid: P5884
tag: ['2014', 'IOI', 'Special Judge']
---
# [IOI 2014] game 游戏
## 题目描述

健佳是一个喜欢做游戏的小男生。当有人问问题时，他更喜欢通过玩游戏的方式作答，而不是直接回答。健佳碰到了他的朋友梅玉，跟她讲了台湾的航空网。在台湾有 $n$ 个城市（编号为 $0,\cdots,n−1$），其中有些城市之间有航线。每个航线连接两个城市，并且是双向的。

梅玉问健佳，是否任意两个城市之间都可以坐飞机互达（直接或间接），健佳不想直接回答，而是要通过做游戏的方式来告诉她。梅玉可以问"城市 $u$ 和 $v$ 之间有直接航线吗？"，健佳会立刻直接回答该问题。梅玉会询问每对城市恰好一次，因此总计会有 $r = \frac{n (n−1)}{2}$ 个问题。如果由前 $i$（$i<r$）个问题的答案可以推断出整个航空网是否连通，也就是说，是否任意一对城市之间都可以坐飞机互达（直接或间接），梅玉就获胜。否则意味着她需要知道全部 $r$ 个回答，此时健佳获胜。

为了让游戏更好玩，他们俩同意，健佳可以不要管台湾的真实航空网，而是可以随着游戏的进展而编造航空网，也就是根据梅玉此前的提问来决定此后如何作答。你的任务是，通过决定健佳如何回答，来帮助他赢得游戏。
## 输入格式

- 第 $1$ 行：一个正整数 $n$，代表城市数量。
- 余下 $r$ 行：每行包含两个整数 $u$ 和 $v$，表示对城市 $u$ 和 $v$ 的提问。
## 输出格式

- 共 $r$ 行，对于每次梅玉的提问，你必须回答在城市 $v$ 和 $u$ 之间是否有直接航线。具体而言，返回值 $1$ 表示有，$0$ 表示没有。
## 样例

### 样例输入 #1
```
4
0 3
1 0
0 2
3 1
1 2
2 3

```
### 样例输出 #1
```
0
1
0
1
0
1

```
## 提示

**子任务及数据规模**

| 子任务 | 分值 | $n$ |
| :----------: | :----------: | :----------: |
| $1$ | $15$ | $n=4$ |
| $2$ | $27$ | $4 \le n \le 80$ |
| $3$ | $58$ | $4 \le n \le 1500$ |



---

---
title: "[IOI 2013] dreaming 梦想"
layout: "post"
diff: 普及+/提高
pid: P5895
tag: ['2013', 'IOI']
---
# [IOI 2013] dreaming 梦想
## 题目描述

天地之初，IOI 尚在遥远的梦想之中。

Serpent(水蛇) 生活的地方有 $N$ 个水坑，编号为 $0，\cdots，N - 1$，有 $M$ 条双向小路连接
这些水坑。每两个水坑之间至多有一条路径（路径包含一条或多条小路）相互连接，有些水坑之间根本无法互通(即 $M ≤ N-1$ )。Serpent 走过每条小路需要一个固定的天数，不同的小路需要的天数可能不同。

Serpent 的朋友袋鼠希望新修 $N - M - 1$ 条小路，让Serpent 可以在任何两个水坑间游走。袋鼠可以在任意两个水坑之间修路，Serpent 通过每条新路的时间都是 $L$ 天。

袋鼠希望找到一种修路方式使得修路之后 Serpent 在每两个水坑之间游走的最长时间最短。

**举例说明**

![](https://cdn.luogu.com.cn/upload/image_hosting/3ahroenu.png)


上图中有 $12$ 个水坑 $8$ 条小路 ($N = 12 , M = 8$)。假如 $L = 2$，即 Serpent 通过任何一条新路都需要 $2$ 天。那么，袋鼠可以修建 $3$ 条新路：
- 水坑 $1$ 和水坑 $2$ 之间；
- 水坑 $1$ 和水坑 $6$ 之间；
- 水坑 $4$ 和水坑 $10$ 之间。

![](https://cdn.luogu.com.cn/upload/image_hosting/udp17aas.png)

上图显示了修路后的最终状态。从水坑 $0$ 走到水坑 $11$ 的时间最长，需要 $18$ 天。这是最佳结果，无论袋鼠如何选择修路方式，总会存在一些水坑对，Serpent 需要 $18$ 天或者更长时间从其中一个走到另一个。
## 输入格式

- 第 $1$ 行: $N$ 表示水坑的数目，$M$ 表示原本存在的小路的数目，$L$ 表示 Serpent 通过新修的路径的时间。
- 第 $2,\cdots, M + 1$ 行: $A[i]$，$B[i]$，$T[i]$。$A$，$B$，$T$ 分别为三个包含 $M$ 个元素的数组，分别表示每条小路的两个端点和通过这条小路的时间。例如，第 $i$ 条小路连接水坑 $A[i-1]$ 和水坑 $B[i-1]$，通过这条小路的时间是 $T[i-1]$ 天。


例如：题目中的例子应该表示为以下格式

```
12 8 2
0 8 4
8 2 2
2 7 4
5 11 3
5 1 7
1 3 1
1 9 5
10 6 3
```
## 输出格式

如上所述，表示游走于两个距离最远的水坑之间所需的时间
## 样例

### 样例输入 #1
```
12 8 2
0 8 4
8 2 2
2 7 4
5 11 3
5 1 7
1 3 1
1 9 5
10 6 3

```
### 样例输出 #1
```
18

```
## 提示

对于 $100\%$ 的数据，$1 \le N \le 10^5$，$0 \le M \le N-1$，$0 \le A[i],B[i] \le N-1$，$1 \le T[i] \le 10^4$，$1 \le L \le 10^4$。


---

---
title: "[POI 2004] MOS"
layout: "post"
diff: 普及+/提高
pid: P5914
tag: ['2004', 'POI（波兰）']
---
# [POI 2004] MOS
## 题目背景

一个夜晚一些旅行者想要过桥。
## 题目描述

他们只有一个火把。
- 火把的亮光最多允许两个旅行者同时过桥。
- 没有火把或者多于 $2$ 个人则不能过桥。

每个旅行者过桥都需要特定的时间，两个旅行者同时过桥时时间应该算较慢的那个。现在我们想知道所有旅行者最少要花费多少时间才能全部过桥?
## 输入格式

第一行一个数 $n$ 表示旅行者的总数。

接下来 $n$ 行表示所有旅行者的过桥时间，时间从小到大排列。
## 输出格式

输出一个数表示最少过桥时间。
## 样例

### 样例输入 #1
```
4
6
7
10
15
```
### 样例输出 #1
```
42
```
## 提示

对于 $100\%$ 的数据，$1\le n\le10^5$，过桥时间均不超过 $10^9$。

注：数据中 $n\ge 2$。


---

---
title: "[IOI 1995] 铺放矩形块"
layout: "post"
diff: 普及+/提高
pid: P5917
tag: ['2001', 'IOI']
---
# [IOI 1995] 铺放矩形块
## 题目描述

给定 $ 4 $ 个矩形块，找出一个最小的封闭矩形将这 $ 4 $ 个矩形块放入，但不得相互重叠。所谓最小矩形指该矩形面积最小。

所有 $ 4 $ 个矩形块的边都与封闭矩形的边相平行。

可能存在满足条件且有着同样面积的各种不同的封闭矩形， 你应该输出所有这些封闭矩形的边长。

## 输入格式

输入文件共有 $ 4 $ 行。每一行用两个正整数来表示一个给定的矩形块的两个边长。矩形块的每条边的边长范围最小是 $ 1 $，最大是 $ 50 $。
## 输出格式

输出文件的总行数为解的总数加 $ 1 $。第一行是一个整数， 代表封闭矩形的最小面积（子任务 $ A $）。接下来的每一行都表示一个解，由数 $ P $ 和数$ Q $ 来表示，并且 $ P \leq Q $（子任务 $ B $）。这些行必须根据 $ P $ 的大小按升序排列，$ P $ 小的行在前，大的在后。且所有行都应是不同的。
## 样例

### 样例输入 #1
```
1 2
2 3
3 4
4 5
```
### 样例输出 #1
```
40
4 10
5 8
```


---

---
title: "[IOI 2004] Phidias 菲迪亚斯神"
layout: "post"
diff: 普及+/提高
pid: P5924
tag: ['2004', 'IOI']
---
# [IOI 2004] Phidias 菲迪亚斯神
## 题目背景

有名的希腊雕刻神菲迪亚斯正在为他下一座雄伟的雕像作准备。
## 题目描述

为了这座雕像他需要大小为 $W_1\times H_1,W_2\times H_2, ...,W_N \times H_N$ 的矩形大理石板。

最近菲迪亚斯获得一块矩形大理石块。菲迪亚斯想把这块石板切成所需要的大小。

石板或是石板所切割出的部分都可以由垂直(或水平)方向纵贯(或是横贯)加以切割到底成为两块矩形石板，同时切割出的这两块矩形石板都必须具有整数的宽度与高度。

石板只能以此种方法加以切割，同时石板不能粘合成较大石板。

因为石板具有花纹，所以石板也不能旋转。

如果菲迪亚斯切割出一块 $A\times B$ 的石板，则此石板不能被当成 $B\times A$ 的石板使用，除非 $A$ 等于 $B$。对每一种所需石板大小菲迪亚斯可切割出零或更多块石板。如果当所有的切割完成时，一块产生出的石板并不是任何所需要的大小，则此石板成为废料。

菲迪亚斯想知道如何切割最初的石板，才能让所产生的废料最少。

例如，下图中的原始石板宽度为 $21$ 且高度为 $11$，而所需石板大小为 $10\times4,6\times 2, 7\times5$ 及 $15\times 10$, 则最小废料总面积为 $10$。下图同时画出最小废料总面积为 $10$ 的切割方法：

![](https://cdn.luogu.com.cn/upload/image_hosting/s48ydewh.png)

你的工作是写一个程序由给定的原始石板大小及所需要的各种石板大小计算出最小的废料总面积。
## 输入格式

第一行为两个整数。

第一个整数 $W$ 为原始石板的宽度，第二个整数 $H$ 为原始石板的高度。

第二行为一个整数 $N$，代表所需石板种类数目。以下 $N$ 行为各种所需石板的大小。

每一行为两个整数，第一个整数为所需石板宽度 $W_i$，第二个整数为所需石板宽度 $H_i$ 。

## 输出格式

为一行且仅包含一个整数，代表最小废料总面积。
## 样例

### 样例输入 #1
```
21 11
4
10 4
6 2
7 5
15 10
```
### 样例输出 #1
```
10
```
## 提示

对于 $100\%$ 的数据，$1\le W,H\le600$，$0\le N\le 200$，$1 \le W_i \le W$，$1 \le H_i \le H$。




---

---
title: "[POI 1999] 地图"
layout: "post"
diff: 普及+/提高
pid: P5929
tag: ['1999', 'POI（波兰）']
---
# [POI 1999] 地图
## 题目背景

一个人口统计办公室要绘制一张地图。
## 题目描述

由于技术的原因只能使用少量的颜色。两个有相同或相近人口的区域在地图应用相同的颜色。例如一种颜色 $k$，则 $A(k)$ 是相应的数，则有：
- 在用颜色$k$的区域中至少有一半的区域的人口不大于 $A(k)$。
- 在用颜色$k$的区域中至少有一半的区域的人口不小于 $A(k)$。

区域颜色误差是该区域的人口与 $A(k)$ 差的绝对值。累计误差是所有区域颜色误差的总和。我们要求出一种最佳的染色方案，使得累计误差最小。
## 输入格式

第一行有一个整数 $n$，表示区域数。

在第二行中的数 $m$ 表示颜色数。

在接下来的  $n$ 行中每行有一个非负整数，表示一个区域的人口。

人口都不超过 $2^{30}$。
## 输出格式

输出一个整数，表示最小的累计误差。
## 样例

### 样例输入 #1
```
11
3
21
14
6
18
10
2
15
12
3
2
2
```
### 样例输出 #1
```
15
```
## 提示

对于 $100\%$ 的数据，$10< n <3000$，$2 \le m \le 10$。


---

---
title: "[POI 1999] 降水"
layout: "post"
diff: 普及+/提高
pid: P5930
tag: ['1999', 'POI（波兰）']
---
# [POI 1999] 降水
## 题目背景

遥远的地方有一块土地。
## 题目描述

它被划分成 $N\times M$ 个正方形小块，每块面积是一平方英寸，第 $i$ 行第 $j$ 列的小块可以表示成 $P(i,j)$ 。这块土地高低不平，每一小块地 $P(i,j)$ 都有自己的高度 $H(i,j)$ （单位是英寸）。

一场倾盆大雨后，这块地由于地势高低不同，许多低洼地方都积存了不少降水。假如你已经知道这块土地的详细信息，你能求出它最多能积存多少立方英寸的降水么？
## 输入格式

输入文件第一行有两个数 $N,M$，表示土地的规模是 $N\times M$ 平方英寸。

以下有 $N$ 行，每行有 $M$ 个整数，表示每块地的高低（每个整数在 $[1,10000]$ 内，以英寸为单位）。
## 输出格式

输出只有一行一个数，表示土地中最多能积存多少立方英寸的水。
## 样例

### 样例输入 #1
```
3 6
3 3 4 4 4 2
3 1 3 2 1 4
7 3 1 6 4 1
```
### 样例输出 #1
```
5
```
## 提示

对于 $100\%$ 的数据， $1\le N, M \le 100$。


---

---
title: "[POI 1999] 多边形之战"
layout: "post"
diff: 普及+/提高
pid: P5932
tag: ['1999', 'POI（波兰）']
---
# [POI 1999] 多边形之战
## 题目背景

多边形之战是一个双人游戏。
## 题目描述

游戏在一个有 $n$ 个顶点的凸多边形上进行，这个凸多边形的 $n-3$ 条对角线将多边形分成 $n-2$ 个三角形，这 $n-3$ 条对角线在多边形的顶点相交。

三角形中的一个被染成黑色，其余是白色。双方轮流进行游戏，当轮到一方时，他必须沿着画好的对角线，从多边形上切下一个三角形。切下黑色三角形的一方获胜。

- 注：如果连接一个多边形中任意两点的线段都完全包含于这个多边形，则称这个多边形为凸多边形。
## 输入格式

第一行是一个整数 $n$。表示多边形的顶点数，多边形的顶点从 $0$ 到 $n-1$ 顺时针标号。

接着的 $n-2$ 行描述组成多边形的三角形。第 $i+1$ 行， $1 \le i \le n-2$，有三个空格分隔的非负整数 $a, b, c$，它们是第 $i$ 个三角形的顶点编号，第一个给出的三角形是黑色的。
## 输出格式

唯一一行应包含一个单词：

- `TAK`，表示先走的一方有必胜策略。
- `NIE`，表示先走的一方没有必胜策略。
## 样例

### 样例输入 #1
```
6

0 1 2

2 4 3

4 2 0

0 5 4
```
### 样例输出 #1
```
TAK
```
## 提示

对于 $100\%$ 的数据， $4 \le n \le 50000$。


---

---
title: "[POI 1998] 折线"
layout: "post"
diff: 普及+/提高
pid: P5939
tag: ['1998', 'POI（波兰）']
---
# [POI 1998] 折线
## 题目描述

给定二维直角坐标系。

我们要求一条折线只能从左边到右边一笔画过去，并且折线的每一段和 $x$ 轴的夹角在 $[-45°, 45°]$ 之间。

一条满足上述要求的折线被称为：平直折线。

给定坐标系上的 $n$ 个格点，最少需要画多少条平直折线才能覆盖所有的点呢？
## 输入格式

第一行一个正整数 $n$，表示点的数目。

接下来的 $n$ 行为每个点的坐标 $(x, y)$ 。
## 输出格式

最少需要多少条平直折线。
## 样例

### 样例输入 #1
```
5
2 3
3 4
4 5
1 6
12 27
```
### 样例输出 #1
```
3
```
## 提示

对于 $100\%$ 的数据，$1\le n\le30000$，$0\le x,y\le 30000$。


---

---
title: "[POI 2002] 最大的园地"
layout: "post"
diff: 普及+/提高
pid: P5943
tag: ['2002', 'POI（波兰）']
---
# [POI 2002] 最大的园地
## 题目描述

在一个 $n\times n$ 的正方形内找到最大的由 `0` 组成的矩形，输出它的面积。
## 输入格式

输入的第一行为一个整数 $n$。

接下来的 $n$ 行，每行 $n$ 个数，描述这个正方形。
## 输出格式

输出其中最大的由 `0` 组成的矩形的面积。
## 样例

### 样例输入 #1
```
5
0 1 0 1 0
0 0 0 0 0
0 0 0 0 1
1 0 0 0 0
0 1 0 0 0
```
### 样例输出 #1
```
9
```
## 提示

对于 $100\%$ 的数据，$1\le n\le 2000$。


---

---
title: "[POI 2003] Chocolate"
layout: "post"
diff: 普及+/提高
pid: P5948
tag: ['2003', 'POI（波兰）']
---
# [POI 2003] Chocolate
## 题目描述

有一块 $n\times m$ 的矩形巧克力，准备将它切成 $n\times m$ 块。

巧克力上共有 $n-1$ 条横线和 $m-1$ 条竖线，你每次可以沿着其中的一条横线或竖线将巧克力切开，无论切割的长短，沿着每条横线切一次的代价依次为 $y_1,y_2,…,y_{n-1}$，而沿竖线切割的代价依次为 $x_1,x_2,…,x_{m-1}$。

例如，对于下图 $6\times4$的巧克力：

![](https://cdn.luogu.com.cn/upload/image_hosting/s0j2oloj.png)


我们先沿着三条横线切割，需要 $3$ 刀，得到 $4$ 条巧克力，然后再将这 $4$ 条巧克力沿竖线切割，每条都需要 $5$ 刀，则最终所花费的代价为 $y_1+y_2+y_3+4\times (x_1+x_2+x_3+x_4+x_5)$。

当然，上述简单切法不见得是最优切法，那么怎样切割该块巧克力，花费的代价最少呢？
## 输入格式

第一行为两个整数 $n$ 和 $m$。

接下来 $n-1$ 行，每行一个整数，分别代表 $x_1,x_2,…,x_{n-1}$。

接下来 $m-1$ 行，每行一个整数，分别代表 $y_1,y_2,…,y_{m-1}$。
## 输出格式

输出一整数，为切割巧克力的最小代价。
## 样例

### 样例输入 #1
```
6 4
2
1
3
1
4
4
1
2
```
### 样例输出 #1
```
42

```
## 提示

对于 $100\%$ 的数据，$1\le n\le 10000$，$1\le m\le 10000$。


---

---
title: "[POI 2018] Plan metra"
layout: "post"
diff: 普及+/提高
pid: P5959
tag: ['2018', 'POI（波兰）', 'Special Judge']
---
# [POI 2018] Plan metra
## 题目描述

有一棵 $n$ 个点的无根树，每条边有一个正整数权值，表示长度，定义两点距离为在树上的最短路径的长度。

已知 $2$ 到 $ n-1$ 每个点在树上与 $1$ 和 $n$ 的距离，请根据这些信息还原出这棵树。
## 输入格式

第一行包含一个正整数 $n$，表示点数。

第二行包含 $n-2$ 个正整数 $d(1,2),d(1,3),...,d(1,n-1)$，分别表示每个点到 $1$ 的距离。

第三行包含 $n-2$ 个正整数 $d(n,2),d(n,3),...,d(n,n-1)$，分别表示每个点到 $n$ 的距离。
## 输出格式

若无解，输出 `NIE`。

否则第一行输出`TAK`，接下来 $n-1$ 行每行三个正整数 $u,v,c$，表示存在一条长度为 $c$ 的连接 $u$ 和 $v$ 两点的树边。

若有多组解，输出任意一组即可。

**本题使用 Special Judge。**
## 样例

### 样例输入 #1
```
7
6 6 2 2 1
5 3 5 1 4
```
### 样例输出 #1
```
TAK
1 5 2
5 7 1
5 2 4
7 3 3
1 4 2
1 6 1
```
## 提示

对于 $100\%$ 的数据，$2\le n\le 500000$，$1\le d\le 1000000$，$1\le u,v\le n$，$1\le c\le1000000$。


---

---
title: "[POI 2017] Reprezentacje ró?nicowe"
layout: "post"
diff: 普及+/提高
pid: P5968
tag: ['2017', 'POI（波兰）']
---
# [POI 2017] Reprezentacje ró?nicowe
## 题目描述

给定一个数列 $a$：
- 当 $n\le 2$ 时，$a_n=n$。
- 当 $n>2$，且 $n$ 是奇数时， $a_n=2\times a_{n-1}$。
- 当 $n>2$，且 $n$ 是偶数时，$a_n=a_{n-1}+r_{n-1}$。

其中 $r_{n-1}= \operatorname{mex}(|a_i-a_j|)(1\le i\le j\le n-1)$， $\operatorname{mex} \left\{ S\right\}$ 表示最小的不在 $S$ 集合里面的非负整数。

数列 $a$ 的前若干项依次为：

$1,2,4,8,16,21,42,51,102,112,224,235,470,486,972,990,1980$。

可以证明，对于任意正整数 $x$，只存在唯一一对整数 $(p,q)$ 满足 $x=a_p-a_q$，定义为 $\operatorname{repr}(x)$。

比如 $\operatorname{repr}(17)=(6,3)$，$\operatorname{repr}(18)=(16,15)$。
现有 $n$ 个询问，每次给定一个正整数 $x$，请求出 $\operatorname{repr}(x)$。
## 输入格式

第一行包含一个正整数 $n$。

接下来 $n$ 行，每行一个正整数 $x$，表示一个询问。
## 输出格式

输出 $n$ 行，每行两个正整数 $ p,q$，依次回答每个询问。
## 样例

### 样例输入 #1
```
2
17
18
```
### 样例输出 #1
```
6 3
16 15
```
## 提示

对于 $100\%$ 的数据，$1\le n\le 10^5$，$1\le x\le 10^9$。


---

---
title: "[CEOI 2008] Dominance"
layout: "post"
diff: 普及+/提高
pid: P5976
tag: ['2008', 'CEOI（中欧）']
---
# [CEOI 2008] Dominance
## 题目描述

给出一个宽为 $W$，高为 $H$ 的矩形 。
 
在它上面有两种点， $black$ 及 $white$。 每个点都有自己的辐射范围。对于其它的点如果它受到白点的辐射多于黑色的，则为白点，反之亦然，如果相同的话则中立。

现给出白点及黑色的坐标及各自的辐射范围，问最后白色点一共有多少个，黑色点共有多少个 。
## 输入格式

第一行给出 $W$ 和 $H$，左下角坐标为 $(0,0)$, 右上角为 $(W-1,H-1)$。  

第二行给出数字 $N$，代表有多少个点。 

接下来 $N$ 行，每行先给出点的属性，再给出坐标，再给出辐射范围(在$[0, 5\times 10^8)$)
## 输出格式

两个数，分别代表白色点有多少个，黑色点有多少个 。
## 样例

### 样例输入 #1
```
10 10
3
W 3 6 3
B 6 4 2
W 3 3 2
```
### 样例输出 #1
```
30 9
```
## 提示

对于 $100\%$ 的数据，$1 \le  W,H \le 10^9$，$0 \le  N \le  3\times 10^3$。


-----

### 样例解释：

![](https://cdn.luogu.com.cn/upload/image_hosting/hfu3bgfx.png)


---

---
title: "[CEOI 2018] Global warming"
layout: "post"
diff: 普及+/提高
pid: P5978
tag: ['2018', 'CEOI（中欧）']
---
# [CEOI 2018] Global warming
## 题目描述

给定 $n$，你可以将任意 $a_l$ 至 $a_r$($1\le l\le r\le n$)每一个元素加上一个 $d$($-x\le d\le x$), 求 $a$ 数组的最大严格上升子序列长度。
## 输入格式

第一行两个整数 $n,x$。

第二行 $n$ 个整数表示 $a_1$ 至 $a_n$。
## 输出格式

一个数,即 $a$ 数组的最大严格上升子序列长度。
## 样例

### 样例输入 #1
```
8 10
7 3 5 12 2 7 3 4
```
### 样例输出 #1
```
5
```
## 提示

对于 $100\%$ 的数据，$1\le n\le 2\times 10^5$。


---

---
title: "[PA 2019] Herbata"
layout: "post"
diff: 普及+/提高
pid: P5980
tag: ['2019', 'PA（波兰）']
---
# [PA 2019] Herbata
## 题目描述

你有无穷多个容量无限的杯子以及 $n$ 杯水，第 $i$ 杯水的体积为 $l_i$，温度为 $a_i$。

你可以做无限次操作，每次操作是下面两种操作之一：
1. 选择一杯水，假设它的体积为 $V$，温度为 $T$，那么你可以将其倒入若干个空杯中，使得每一杯的水的温度都为 $T$，且体积之和等于 $V$，注意体积可以是任意非负实数。

2. 选择两杯水，假设一杯的体积为 $V_a$，温度为 $T_a$，另一杯的体积为 $V_b$，温度为 $T_b$，那么你可以将这两杯水混合为一杯体积为 $V_a+V_b$，温度为 $\dfrac{V_a*T_a+V_b*T_b}{V_a+V_b}$的水。

你的目标进行若干次操作，使得操作完毕后，对于所有的 $i(1\le i\le n)$ 都有第 $i$ 杯水的体积等于 $l_i$，温度等于 $b_i$。请写一个程序判断是否有解。
## 输入格式

第一行包含一个正整数 $T$，表示测试数据的组数。
每组测试数据第一行包含一个正整数 $n$。
接下来 $n$ 行，每行三个正整数 $l_i,a_i,b_i$。

## 输出格式

对于每组数据输出一行，如果有解，输出 `TAK`，否则输出 `NIE`。
## 样例

### 样例输入 #1
```
5
2
2 1 4
2 5 2
2
1 4 3
1 5 4
2
1 5 7
1 7 5
2
1 4 1
1 2 5
3
2 6 4
1 2 3
3 4 5
```
### 样例输出 #1
```
TAK
NIE
TAK
NIE
TAK
```
## 提示

对于 $100\%$ 的数据，$1\le T\le 10^5$，$1\le n\le 10^5$，$1\le l_i,a_i,b_i\le 10^6$，输入数据保证所有的 $n$ 加起来不超过 $10^6$。


---

---
title: "[PA 2014] Kuglarz"
layout: "post"
diff: 普及+/提高
pid: P5994
tag: ['2014', 'PA（波兰）']
---
# [PA 2014] Kuglarz
## 题目描述

魔术师的桌子上有 $n$ 个杯子排成一行，编号为 $1,2,…,n$，其中某些杯子底下藏有一个小球，如果你准确地猜出是哪些杯子，你就可以获得奖品。

花费 $c_{ij}$ 元，魔术师就会告诉你杯子 $i,i+1,…,j$ 底下藏有球的总数的奇偶性。

采取最优的询问策略，你至少需要花费多少元，才能保证猜出哪些杯子底下藏着球？
## 输入格式

第一行一个整数 $n$。

第 $i+1$ 行（$1\le i\le n$）有 $n+1-i$ 个整数，表示每一种询问所需的花费。

其中 $c_{ij}$（对区间 $[i,j]$ 进行询问的费用，$1\le i\le j\le n$）为第 $i+1$ 行第 $j+1-i$ 个数。
## 输出格式

输出一个整数，表示最少花费。
## 样例

### 样例输入 #1
```
5
1 2 3 4 5
4 3 2 1
3 4 5
2 1
5
```
### 样例输出 #1
```
7
```
## 提示

对于 $100\%$ 的数据，$1\le n\le 2\times 10^3$，$1\le c_{ij}\le 10^9$。


---

---
title: "[PA 2014] Pakowanie"
layout: "post"
diff: 普及+/提高
pid: P5997
tag: ['2014', 'PA（波兰）']
---
# [PA 2014] Pakowanie
## 题目描述

你有 $n$ 个物品和 $m$ 个包。物品有重量，且不可被分割；包也有各自的容量。要把所有物品装入包中，至少需要几个包？
## 输入格式

第一行两个整数 $n,m$，表示物品和包的数量。

第二行有 $n$ 个整数 $a_1,a_2,…,a_n$，分别表示物品的重量。

第三行有 $m$个整数 $c_1,c_2,…,c_m$，分别表示包的容量。
## 输出格式

如果能够装下，输出一个整数表示最少使用包的数目。

若不能全部装下，则输出 `NIE`。
## 样例

### 样例输入 #1
```
4 3
4 2 10 3
11 18 9
```
### 样例输出 #1
```
2
```
## 提示

对于 $100\%$ 的数据，$1\le n\le 24$，$1\le m\le 100$，$1\le a_i\le 10^8$，$1\le c_i\le 10^8$。


---

---
title: "[CSGRound3] 游戏"
layout: "post"
diff: 普及+/提高
pid: P6015
tag: ['洛谷月赛']
---
# [CSGRound3] 游戏
## 题目背景

小 Y 和小 Z 是一对好朋友，他们在玩一个游戏。**游戏只有一个回合**。
## 题目描述

有一个牌堆，一共有 $n$ 张牌，第 $i$ 张牌上有一个数 $a_i$，其中第一张牌是堆顶。

小 Z 先取牌，他可以从堆顶开始取连续若干张牌（**可以取 $0$ 张**），取完的牌拿在手上，也就是不在牌堆里了。

然后小 Y 取牌，同样，她也可以从堆顶开始取连续若干张牌（**可以取 $0$ 张**）。

如果一个人手上的牌的数字和大于 $X$，那么他的分数就是 $0$，否则分数就是数字和。

分数高的人获胜，**如果一样高，则无人获胜**。

小 Z 为了获胜，使用了透视挂，即他知道牌堆里每张牌上写的数。

现在问你对于满足 $1 \leq X \leq K$ 的所有整数 $X$，哪些可以使得小 Z 有必胜策略，即小 Z 取完后，不管小 Y 怎么取都一定会**输**。
## 输入格式

第一行一个整数 $n$，表示牌堆里有几张牌。

第二行 $n$ 个整数 $a_{1\dots n}$，表示每张牌上写的数。

第三行一个正整数 $K$，含义见题目描述。
## 输出格式

第一行一个整数，表示满足要求的 $X$ 的个数。

第二行从小到大依次输出满足要求的 $X$，用空格隔开。
## 样例

### 样例输入 #1
```
5
1 4 3 2 2
5

```
### 样例输出 #1
```
3
1 2 3

```
## 提示

**【样例解释】**

$X=1,2,3$ 时，小 Z 取一张牌，小 Y 不管怎么取都是零分。

$X=4$ 时，小 Z 如果取 $1$ 张，那么小 Y 取 $1$ 张小 Y 就赢了；否则小 Z 只能是零分。

$X=5$ 时，小 Z 如果取 $1$ 张，那么小 Y 取 $1$ 张小 Y 就赢了；小 Z 如果取了 $2$ 张，小 Y 也取 $2$ 张，平局；否则小 Z 只能是零分。

---

**【数据范围】**

**本题采用捆绑测试。**

- Subtask 1（3 points）：$n = 1$。
- Subtask 2（14 points）：$K= 1$。
- Subtask 3（20 points）：$n,K \le 100$。
- Subtask 4（33 points）：$n , K \le 3333$。
- Subtask 5（30 points）：无特殊限制。

对于 $100\%$ 的数据，$1\leq n,K \leq 10^6$，$1\leq a_i \leq K$。




---

---
title: "[加油武汉] 体温调查"
layout: "post"
diff: 普及+/提高
pid: P6058
tag: ['洛谷月赛']
---
# [加油武汉] 体温调查
## 题目背景

在疫情扩散后，疾控中心的医护人员对来自武汉的人员进行了家庭访问，对体温进行测量。医护人员从疾控中心出发，按照一定顺序对所有家庭进行访问，然后汇总数据。 

家庭列表上记录着类似于`A街道B小区C号楼D户`一样的住址，按照字典顺序排列，因此每个区域中的家庭在列表中总是相邻的。医护人员在访问完某个区域（比如B1小区）的所有家庭后，需要将数据送至上一层（比如A街道）的管理机构中，然后继续访问（比如B2小区）中的家庭。

也就是说，医护人员的移动路径类似一颗**树**，其中树根代表疾控中心，树叶代表家庭，而中间的结点代表一层一层的管理区域。结点的孩子代表下一层的区域（或者家庭），是有序的。从根到某个家庭的路径上所有的点正好组成了这个家庭的地址。 

![](https://cdn.luogu.com.cn/upload/image_hosting/6zfh4ofj.png)

如图，4家的地址分别为（按顺序）
- A1-B1-C1-Z1
- A1-B1-C1-Z2
- A1-B1-Z3
- A2-B2-C3-Z4

箭头仅代表归属关系，所有路均可双向通行。

本质上，题目给出的树就是住址构成的 **字典树**/**Trie树** 。
## 题目描述

给出一颗树，根结点编号为$1$。有一名医护人员从根出发，沿着树边移动，去每个叶子采集信息，最后返回根。他的采集顺序是固定的，每当走到一个结点$u$，他会先走向编号最小的孩子，并访问完其中所有的家庭并回到$u$，然后再走向编号第二小的孩子，依此直到访问完$u$子树中所有的家庭返回上一层。可以发现访问叶子的顺序也正好是家庭住址列表上的顺序。

沿着树边移动需要一定时间，为了节约时间，可以将家庭列表分成连续的$k$段，并让$k$个医护人员同时从根出发，每人访问一个区间中的家庭然后返回。请你计算出统计完所有家庭的体温所需要的最短时间。
## 输入格式

第一行两个整数$n, k$，分别表示树中的结点数和医护人员数。

接下来$n-1$行，每行三个整数$u, v, w$，表示一条从$u$到$v$，经过花费时间$w$的边。
## 输出格式

一行一个整数，表示统计完所有家庭的最短时间。
## 样例

### 样例输入 #1
```
11 2
1 2 2
1 3 3
2 4 1
3 5 2
4 6 2
4 7 3
5 8 1
6 9 3
6 10 25
8 11 4

```
### 样例输出 #1
```
66
```
## 提示

对 $30\%$ 的数据，$1 \le n \le 20$

对另外 $10 \%$ 的数据，$k = 1$

对另外 $20 \%$ 的数据，$k = 2$

对 $100\%$ 的数据，$1 \le n \le 2*10^5, 1 \le k \le m, 1 \le u, v \le n, 0 \le w \le 10^9$，$m$为叶子数。

### 样例说明
图示见题目背景。

第一个人的路径为RT->Z1->Z2->RT，耗时66。

第二个人的路径为RT->Z3->Z4->RT，耗时32。

让一个人访问Z2，另一个人访问Z1、Z3、Z4的方案是不合法的。


---

---
title: "[USACO05JAN] The Wedding Juicer G"
layout: "post"
diff: 普及+/提高
pid: P6063
tag: ['2005', 'USACO']
---
# [USACO05JAN] The Wedding Juicer G
## 题目描述

约翰的奶牛们找到了一份不错的兼职一设计冲压式榨汁机．榨汁机设计如下：

一个 $W \times H$ 的底座（$3\leq W,H \leq 300$），每一个 $1 \times 1$ 的方格上都放有一个高度为 $B$（$1 \leq B \leq 10^9$）的柱子，用来榨汁。假设柱子之间都被完美地粘合了，这样水不会顺着柱子与柱子之间的空隙流走。

但是约翰一直不知道，这么一个榨汁机，到底能装多少果汁？假设榨汁机周围没有任何东西，也就是说，边界上的水都会流走，有些榨汁机则根本不能装下任何的果汁。
## 输入格式

第一行两个整数 $W$ 和 $H$。

接下来 $H$ 行，每行 $W$ 个数字，代表了高度。
## 输出格式

输出最多能装多少果汁。
## 样例

### 样例输入 #1
```
4 5
5 8 7 7
5 2 1 5
7 1 7 1
8 9 6 9
9 8 9 9
```
### 样例输出 #1
```
12
```


---

---
title: "[USACO05JAN] Watchcow S"
layout: "post"
diff: 普及+/提高
pid: P6066
tag: ['2005', 'USACO', 'Special Judge']
---
# [USACO05JAN] Watchcow S
## 题目描述

Farmer John 有 $N$ 个农场（$2 \leq N \leq 10^4$），这些农场由 $M$ 条道路连接（$1 \leq M \leq 5 \times 10^4$）。不保证没有重边。

Bassie 从 $1$ 号农场开始巡逻，每条路必须从两个方向各走**恰好一遍**，最后回到 $1$ 号农场。

请输出一条满足上述要求的路径。

保证这样的路径存在。如果有多条路径，任意输出一条即可。
## 输入格式

第一行两个整数 $N,M$。

接下来 $M$ 行，每行两个整数 $u,v$，描述一条 $u$ 到 $v$ 的道路。
## 输出格式

输出经过的农场，一行一个。
## 样例

### 样例输入 #1
```
4 5
1 2
1 4
2 3
2 4
3 4
```
### 样例输出 #1
```
1
2
3
4
2
1
4
3
2
4
1
```


---

---
title: "[USACO06MAR] Milk Team Select G"
layout: "post"
diff: 普及+/提高
pid: P6079
tag: ['2006', 'USACO']
---
# [USACO06MAR] Milk Team Select G
## 题目描述

Farmer John 的 $N(1 \le N \le 500)$ 头奶牛打算参加一场世界级的产奶比赛 （Multistate Milking Match-up，MMM），他们已经摸清了其他队的实力。他们的总产奶量只要大于等于 $X$ 加仑（$1 \leq X \leq 10^6$），就能赢得胜利。

每头奶牛都能为全队贡献一定量的牛奶，数值在 $-10^4$ 到 $10^4$ 加仑之间（为啥有负数？因为有些奶牛会打翻其他奶牛产的牛奶）。

MMM 的目标是通过合作，增进家庭成员间的默契。为了支持比赛精神，奶牛们希望在赢得比赛的前提下，有尽可能多对奶牛间存在直系血缘关系。当然，所有奶牛都是女性，因此这里的直系血缘关系就是母女关系。

现在 FJ 摸清了所有奶牛间的血缘关系，希望算出一个团队在赢得胜利的前提下，最多有多少对奶牛存在血缘关系。注意：如果一个团队由某头奶牛和她的母亲和外祖母组成的话，这个团队只有两对血缘关系（她和她的母亲，她的母亲和外祖母）。
## 输入格式

第一行两个整数 $N,X$。

接下来 $N$ 行，每行两个整数，第一个整数是它能为团队贡献的产奶量，第二个整数为它的母亲的编号，如果她的母亲不在牛群里，这个数字为 $0$。

保证血缘关系不会出现环。
## 输出格式

输出在获胜的前提下，一个团队中最多存在多少血缘关系。

特别地，如果不存在一个团队能获胜，输出 $-1$。
## 样例

### 样例输入 #1
```
5 8
-1 0
3 1
5 1
-3 3
2 0
```
### 样例输出 #1
```
2
```
## 提示

最优的队伍包含 $1,2,3,5$ 这四头奶牛，总产奶量为 $9$ 加仑，共有两对血缘关系（$1,2$ 和 $1,3$）。

虽然 $2,3,5$ 这个组合产奶量更大，但是这个组合里没有血缘关系。


---

---
title: "[USACO05DEC] Barn Expansion G"
layout: "post"
diff: 普及+/提高
pid: P6081
tag: ['2005', 'USACO']
---
# [USACO05DEC] Barn Expansion G
## 题目描述

Farmer John 有 $N$（$1 \leq N \leq 25000$）个矩形牛棚，它们的墙与坐标轴平行，且坐标在 $[0,10^6]$ 范围内。保证任意两个牛棚不重叠，但可能有公共的墙。

由于奶牛数量不断增加，FJ 打算扩张牛棚。一个牛棚是可以扩张的，当且仅当它的墙与其他牛棚的墙没有公共部分。如果两个牛棚有一个公共角，这两个牛棚均不可扩张。

请你求出有多少牛棚是可以扩张的。
## 输入格式

第一行一个整数 $N$。

接下来 $N$ 行，每行四个整数，分别代表牛棚左下角坐标和右上角坐标。
## 输出格式

输出可以扩张的牛棚数量。
## 样例

### 样例输入 #1
```
5
0 2 2 7
3 5 5 8
4 2 6 4
6 1 8 6
0 0 8 1
```
### 样例输出 #1
```
2
```
## 提示

前两个牛棚可以扩张。


---

---
title: "[EER2] 直接自然溢出啥事没有"
layout: "post"
diff: 普及+/提高
pid: P6103
tag: ['O2优化', '洛谷月赛']
---
# [EER2] 直接自然溢出啥事没有
## 题目背景

![](https://cdn.luogu.com.cn/upload/image_hosting/hu0gfpdv.png)
## 题目描述

给定一个整数 $n$，问有多少个长度为 $n$ 的字符串，满足这个字符串是一个“程序片段”。

具体定义如下：

单个分号 `;` 是一个“语句”。

空串 ` ` 是一个“程序片段”。

如果字符串 `A` 是“程序片段”，字符串 `B` 是“语句”，则 `AB` 是“程序片段”。

如果字符串 `A` 是“程序片段”，则 `{A}` 是“语句块”。

如果字符串 `A` 是“语句块”，则 `A` 是“语句”，`[]A` 和 `[]()A` 都是“函数”。

如果字符串 `A` 是“函数”，则 `(A)` 是“函数”，`A` 和 `A()` 都是“值”。

如果字符串 `A` 是“值”，则 `(A)` 是“值”，`A;` 是“语句”。

**注意：`A` 是 `B` 并不代表 `B` 是 `A`**。
## 输入格式

一行，一个整数 $n$。
## 输出格式

一行，一个整数，表示答案对 $18\,446\,744\,073\,709\,551\,616$（$2^{64}$） 取模的结果。
## 样例

### 样例输入 #1
```
4
```
### 样例输出 #1
```
9
```
### 样例输入 #2
```
7
```
### 样例输出 #2
```
140
```
## 提示

### 样例一解释

合法的“程序片段”有：`;;;;`，`;;{}`，`;{;}`，`;{};`，`{;;}`，`{;};`，`{{}}`，`{};;`，`{}{}`。

注意：本题采用**捆绑测试**，只有当你通过一个 subtask 中的所有测试点后，你才能拿到这个 subtask 的分数。

子任务 1（$20$ 分）：$n\leq 10$。

子任务 2（$20$ 分）：$n\leq 100$。

子任务 3（$20$ 分）：$n\leq 2500$。

子任务 4（$40$ 分）：没有特殊限制。

对于 $100\%$ 的数据，$0\leq n\leq 10^4$。


---

---
title: "[USACO17FEB] Why Did the Cow Cross the Road II G"
layout: "post"
diff: 普及+/提高
pid: P6119
tag: ['2017', 'USACO']
---
# [USACO17FEB] Why Did the Cow Cross the Road II G
## 题目背景

*本题与 [白金组同名题目](/problem/P3657) 在题意上一致，唯一的差别是数据范围。*
## 题目描述

Farmer John 饲养了 $N$ 种奶牛，编号从 $1$ 到 $N$。一些品种的奶牛和其他奶牛间相处良好，事实证明，如果两个品种的奶牛编号分别为 $a,b$，当 $|a-b| \leq 4$ 时，这两个品种的奶牛能友好相处，否则不能友好相处。

一条长长的道路贯穿整个农场，道路的左侧有 $N$ 个牧场（每个品种的奶牛恰好占据一个牧场），道路的右侧也有 $N$ 个牧场（每个品种的奶牛恰好占据一个牧场）。为了让奶牛们安全穿过马路，Farmer John 希望能在马路上画出一些人行道（牛行道？），要求这些人行道满足如下条件：

1. 人行道从左侧的某个牧场出发，连接到右侧的某个牧场；
2. 人行道连接的两个牧场的奶牛要能友好相处；
3. 人行道不能在道路中间相交；
4. 每个牧场只能与一条人行道相连。

你需要帮 FJ 求出最多能有多少条人行道。
## 输入格式

输入第一行一个整数 $N$（$1 \leq N \leq 1000$）。

接下来 $N$ 行，每行一个整数 $a_i$，代表道路左侧第 $i$ 个牧场的奶牛品种编号。

接下来 $N$ 行，每行一个整数 $b_i$，代表道路右侧第 $i$ 个牧场的奶牛品种编号。
## 输出格式

输出最多能画多少条人行道。
## 样例

### 样例输入 #1
```
6
1
2
3
4
5
6
6
5
4
3
2
1
```
### 样例输出 #1
```
5
```


---

---
title: "[USACO07FEB] Cow Sorting G"
layout: "post"
diff: 普及+/提高
pid: P6193
tag: ['2007', 'USACO']
---
# [USACO07FEB] Cow Sorting G
## 题目描述

Farmer John 的 $n$（$1 \leq n \leq 10^5$）头牛一字排开。每头奶牛都有一个“脾气暴躁”水平，范围在 $1 \ldots 10^5$，且任意两头奶牛的脾气暴躁值不相同。由于脾气暴躁的奶牛更有可能损坏 FJ 的挤奶设备，因此 FJ 希望对奶牛进行重新排序，以便按照脾气暴躁程度依此提升的顺序排列它们。

在此过程中，任何两头奶牛（不一定相邻）的位置都可以互换。由于脾气暴躁的母牛难以移动，因此 FJ 总共需要 $X + Y$ 单位的时间来交换两只脾气暴躁程度为 $X$ 和 $Y$ 的母牛。请帮助 FJ 计算将奶牛按脾气暴躁程度的升序排序所需的最短时间。
## 输入格式

第一行一个整数：$N$ 。

接下来 $N$ 行每行包含一个整数 $a_i$，代表第 $i$ 头奶牛的脾气暴躁值。
## 输出格式

输出将所有奶牛按按脾气暴躁程度的升序排序所需的最短时间。
## 样例

### 样例输入 #1
```
3 
2 
3 
1
```
### 样例输出 #1
```
7
```


---

---
title: "[EER1] 代价"
layout: "post"
diff: 普及+/提高
pid: P6196
tag: ['洛谷月赛']
---
# [EER1] 代价
## 题目背景

> 个人的遭遇，命运的多舛都使我被迫成熟，这一切的代价都当是日后活下去的力量。
——  三毛

小 Z 喜欢玩数字游戏。
## 题目描述

给出一个长度为 $n+2$ 的序列 $a_i$，其中第 $1$ 个数和第 $n+2$ 个数固定为 $1$。你每次可以选择序列中间的一个数删除（不能是第一个和最后一个），删除位置 $p$ 上的数的代价为 $a_{p-1} \times a_p \times a_{p+1}$。你需要执行这个操作直到无法操作为止。求最小的代价和。
## 输入格式

第一行一个正整数 $n$。

第二行 $n$ 个正整数，第 $i$ 个数表示 $a_{i+1}$。
## 输出格式

一行一个正整数，表示最小的代价和。
## 样例

### 样例输入 #1
```
3
1 2 3
```
### 样例输出 #1
```
9

```
### 样例输入 #2
```
4
19 26 8 17
```
### 样例输出 #2
```
846
```
### 样例输入 #3
```
6
1 1 1 1 1 1
```
### 样例输出 #3
```
6
```
## 提示

样例一解释：

先删除 $3$，代价为 $6$，再删除 $2$，代价为 $2$，再删除 $1$，代价为 $1$。

总代价为 $6+2+1=9$。

---

**本题采用捆绑测试。**

对于 $100\%$ 的测试点：$1 \leq n \leq 10^6$，$1 \leq a_i \leq 10^4$。

本题共 $6$ 个子任务，各子任务的分值及约定如下：

子任务 $1$（$1$ 分）：$a_i = 1$。

子任务 $2$（$14$ 分）：$1 \leq n \leq 10$。

子任务 $3$（$5$ 分）：$1 \leq a_i \leq 2$。

子任务 $4$（$14$ 分）：$1 \leq n \leq 40$。

子任务 $5$（$26$ 分）：$1 \leq n \leq 500$。

子任务 $6$（$40$ 分）：无特殊限制。

#### 特别感谢

idea：smrsky

solu：CYJian

data：iostream


---

---
title: "[USACO07CHN] Summing Sums G"
layout: "post"
diff: 普及+/提高
pid: P6202
tag: ['2007', 'USACO']
---
# [USACO07CHN] Summing Sums G
## 题目描述

$N$ 头奶牛（$1 \leq N \leq 5 \times 10^4$）刚刚学习了不少密码学知识，终于，她们创造出了属于奶牛的加密方法，由于她们经验不足，她们的加密方法很简单：

第 $i$ 头奶牛掌握着密码的第 $i$ 个数字，起始的时候是 $C_i$（$0 \leq C_i \lt 9 \times 10^7$）。加密的时候，第 $i$ 头奶牛会计算其他所有奶牛的数字和，并将这个和对 $98\,765\,431$ 取模。在所有奶牛计算完成后，每头奶牛都会用自己算的数字代替原来的数字。即，

$$
C_{i}'=(\sum_{k=1}^NC_k-C_i) \bmod 98\,765\,431
$$

这样，她们完成了一次加密。

在十一月，奶牛们把这个加密方法告诉了驼鹿卡门。卡门想了一会后，说：“你们的算法还很原始，为了达到加密效果，你们要重复这个加密过程 $T$ 次（$1 \leq T \leq 1\,414\,213\,562$）”。

奶牛们很懒，于是就把这个任务交给了你。
## 输入格式

第一行两个整数 $N,T$。

接下来 $N$ 行，第 $i$ 行一个整数 $C_i$。
## 输出格式

输出 $N$ 行，第 $i$ 行一个整数，代表经过 $T$ 次加密后的 $C_i$。
## 样例

### 样例输入 #1
```
3 4
1
0
4
```
### 样例输出 #1
```
26
25
29

```
## 提示

每次加密后的 $C_i$ 如下：

| 次数 | $C_1$ | $C_2$ | $C_3$ |
| ---- | ----- | ----- | ----- |
| 0    | 1     | 0     | 4     |
| 1    | 4     | 5     | 1     |
| 2    | 6     | 5     | 9     |
| 3    | 14    | 15    | 11    |
| 4    | 26    | 25    | 29    |


---

---
title: "[COCI 2019/2020 #6] Trener"
layout: "post"
diff: 普及+/提高
pid: P6221
tag: ['2019', 'COCI（克罗地亚）']
---
# [COCI 2019/2020 #6] Trener
## 题目背景

题目翻译来自 [LOJ3270](https://loj.ac/problem/3270)。
## 题目描述

**译自 [COCI 2019/2020 Contest #6](https://hsin.hr/coci/archive/2019_2020/) T5.** ***[Trener](https://hsin.hr/coci/archive/2019_2020/contest6_tasks.pdf)***

我们已经知道了学生们喜欢睡觉。Patrik 是这一记录的保持者。在最后一个梦中，他发现自己成为了他最喜欢的球队的队长。

为了参加一场比赛，他把自己的所有球员分为 $N$ 组，每组 $K$ 名球员，对于第 $i$ 组的球员，他们的姓氏长度都为 $i$。

现在，他要开始规划上场的球员组合了。一个组合有 $N$ 名球员，并且组委会对上场的球队还有有以下要求：

- 所有球员的姓氏长度必须不同。

- 所有球员的姓氏必须为其他姓氏比他长一个字符的球员的连续子序列。

Patrik 想知道，自己最多能把这些球员分为多少支可以上场的队伍。答案对 $10^9+7$ 取模。
## 输入格式

输入第一行为两个整数 $N,K$。

接下来的 $N$ 行，每行 $K$ 个字符串，为球员的姓氏，保证第 $i$ 行的字符串长度为 $i$。
## 输出格式

输出一行一个整数为最多分出的队伍支数，答案对 $10^9+7$ 取模。
## 样例

### 样例输入 #1
```
3 2
a b
ab bd
abc abd
```
### 样例输出 #1
```
5
```
### 样例输入 #2
```
3 3
a b c
aa ab ac
aaa aab aca
```
### 样例输出 #2
```
6
```
### 样例输入 #3
```
3 1
a
bc
def
```
### 样例输出 #3
```
0
```
## 提示

#### 样例 $1$ 说明：
可以分为如下队伍：

`(a, ab, abc), (a, ab,abd), (b, ab, abc), (b, ab, abd), (b, bd, abd)`。

----

#### 数据范围：

对于 $100\%$ 的数据，$1\le N\le 50$，$1\leq K\leq 1500$。

|任务编号|特殊限制|分值|
|:-:|:-:|:-:|:-:|
|$0$|为样例|$0$|
|$1$|$N=5,K=10$|$20$|
|$2$|$N=50,K=100$|$30$|
|$3$|无特殊限制。|$50$|


---

---
title: "神帖"
layout: "post"
diff: 普及+/提高
pid: P6249
tag: []
---
# 神帖
## 题目背景

zrl 的生日在 3.14。出生在神帖迭起的日子，他的快乐自然很多。这不，他又要收取来着神帖的馈赠了。
## 题目描述

神帖分布在讨论区的一些页面上，每个页面最多有一个神帖。假设他正在浏览的页面设为 $0$ 号页面。向左一页为 $-1$ 号页面，向右一页为 $1$ 号页面，以此类推。第 $i$ 个神帖在 $x_i$ 号页面上，并且有特定的封禁的时间 $t_i$ 和快乐值 $v_i$，超过了这个时间 $t_i$ 浏览就不能得到他的快乐值了。zrl 向左或向右翻一页需要 $1$ 单位时间，浏览神帖不需要时间。问：zrl 最多能得到多少快乐值。

注：在 $t_i$ 个单位时间浏览第 $i$ 个神贴仍能得到 $v_i$ 的快乐值。

**另注：每个神帖的快乐值最多只能得到一次。**
## 输入格式

第一行一个整数 $n$，表示神帖数量。

接下来 $n$ 行，每行三个整数，分别表示第 $i$ 个神帖的 $x_i$，$v_i$，$t_i$。
## 输出格式

一个整数，为 zrl 能得到的最多的快乐值。
## 样例

### 样例输入 #1
```
5
-5 1 5
-3 1 5
-1 1 5
1 1 5
3 2 5

```
### 样例输出 #1
```
4
```
### 样例输入 #2
```
5
-5 2 5
-3 1 5
-1 1 5
1 0 5
3 4 5

```
### 样例输出 #2
```
5
```
### 样例输入 #3
```
5
1 1 1
2 1 2
3 1 3
4 1 5
-5 5 5

```
### 样例输出 #3
```
5
```
## 提示

#### 样例解释：

样例 1：$0 \rightarrow -1 \rightarrow 0 \rightarrow 1 \rightarrow 2 \rightarrow 3$  
样例 2：$0 \rightarrow -1 \rightarrow 0 \rightarrow 1 \rightarrow 2 \rightarrow 3$  
样例 3：$0 \rightarrow -1 \rightarrow -2 \rightarrow -3 \rightarrow -4 \rightarrow -5$ 

---

#### 数据范围：

| 测试点 | 特殊性质 |
| :-----------: | :-----------: |
| $1-2$ | $x_i \ge 0$ |
| $3-4$ | $0 \le t_i \le 20$ |
| $5-6$ | $n \le 20$ |
| $7$ | $-10 \le x_i \le 10$ |
| $8-9$ | $t_i=$\|$x_i$\| |
| $10-13$ | 所有 $t_i$ 均相等 |
| $14-17$ | $n \le 60$ |
| $17-22$ | 无 |

对于 $100\%$ 的数据，$n \le 200$，$-500 \le x_i \le 500$，$0 \le v_i \le 10^9$，$0\le t_i \le 500$。

Hint：新增两组 Hack 数据，贪心/模拟已经过不去了。


---

---
title: "[ICPC 2019 WF] Azulejos"
layout: "post"
diff: 普及+/提高
pid: P6251
tag: ['2019', 'Special Judge', 'O2优化', 'ICPC']
---
# [ICPC 2019 WF] Azulejos
## 题目背景

### Warning: If you submit a malicious program, you will be banned.
### 警告：恶意提交本题将被封号。

## 题目描述

Ceramic artists Maria and João are opening a small azulejo store in Porto. Azulejos are the beautiful ceramic tiles for which Portugal is famous. Maria and João want to create an attractive window display, but, due to limited space in their shop, they must arrange their tile samples in two rows on a single shelf. Each of João's tiles has exactly one of Maria's tiles in front of it and each of Maria's tiles has exactly one of João's tiles behind it. These hand-crafted tiles are of many different sizes, and it is important that each tile in the back row is taller than the tile in front of it so that both are visible to passers-by. For the convenience of shoppers, tiles in each row are arranged in non-decreasing order of price from left to right. Tiles of the same price may be arranged in any order subject to the visibility condition stated above.

Your task is to find an ordering of the tiles in each row that satisfies these constraints, or determine that no such ordering exists.
## 输入格式

The first line of input contains an integer $n$ ($1 \leq n \leq 5 \times 10^5$), the number of tiles in each row. The next four lines contain $n$ integers each; the first pair of lines represents the back row of tiles and the second pair of lines represents the front row. Tiles in each row are numbered from $1$ to $n$ according to their ordering in the input. The first line in each pair contains $n$ integers $p_1, \dots , p_n$ ($1 \leq p_i \leq 10^9$ for each $i$), where $p_i$ is the price of tile number $i$ in that row. The second line in each pair contains $n$ integers $h_1, \dots , h_n$ ($1 \leq h_i \leq 10^9$ for each $i$), where $h_i$ is the height of tile number $i$ in that row.
## 输出格式

If there is a valid ordering, output it as two lines of $n$ integers, each consisting of a permutation of the tile numbers from $1$ to $n$. The first line represents the ordering of the tiles in the back row and the second
represents the ordering of the tiles in the front row. If more than one pair of permutations satisfies the constraints, any such pair will be accepted. If no ordering exists, output `impossible`.
## 样例

### 样例输入 #1
```
4
3 2 1 2
2 3 4 3
2 1 2 1
2 2 1 3
```
### 样例输出 #1
```
3 2 4 1
4 2 1 3
```
### 样例输入 #2
```
2
1 2
2 3
2 8
2 1
```
### 样例输出 #2
```
impossible
```
## 提示

Source: ICPC 2019 World Finals.
## 题目翻译

给你两种瓷砖 $a,b$，每种瓷砖有 $n$ 块，每块瓷砖有两个属性：高度 $h$ 和价值 $p$。

现在要求你把这些瓷砖重新排成两行（$2\times n$）。前一行放瓷砖 $b$，后一行放瓷砖 $a$。

要求从左到右 $p$ 递增（单调不减），对于任意一个位置 $i$，后面的瓷砖要比前面的瓷砖高。

求一种方案或输出无解。

$n\le 5\times 10^5$


---

---
title: "[ICPC 2019 WF] Dead-End Detector"
layout: "post"
diff: 普及+/提高
pid: P6255
tag: ['2019', 'O2优化', 'ICPC']
---
# [ICPC 2019 WF] Dead-End Detector
## 题目背景

### Warning: If you submit a malicious program, you will be banned.
### 警告：恶意提交本题将被封号。

## 题目描述

The council of your home town has decided to improve road sign placement,especially for dead ends. They have given you a road map, and you must determine where to put up signs to mark the dead ends. They want you to use as few signs as possible.

The road map is a collection of locations connected by two-way streets. The following rule describes how to obtain a complete placement of dead-end signs. Consider a street $S$ connecting a location $x$ with another location. The $x$-entrance of $S$ gets a dead-end sign if, after entering $S$ from $x$, it is not possible to come back to $x$ without making a U-turn. A U-turn is a 180-degree turn immediately reversing the direction.

To save costs, you have decided not to install redundant dead-end signs, as specified by the following rule. Consider a street $S$ with a dead-end sign at its $x$-entrance and another street $T$ with a dead-end sign at its $y$-entrance. If, after entering $S$ from $x$, it is possible to go to $y$ and enter $T$ without making a U-turn, the dead-end sign at the $y$-entrance of $T$ is redundant. See Figure E.1 for examples.

![](https://cdn.luogu.com.cn/upload/image_hosting/33rn5okp.png)

Figure E.1: Illustration of sample inputs, indicating where non-redundant dead-end signs are placed.

## 输入格式

The first line of input contains two integers $n$ and $m$, where $n$ $(1 \leq n \leq 5\times10^5)$ is the number of locations and $m$ $(0 \leq m \leq 5 \times 10^5)$ is the number of streets. Each of the following $m$ lines contains two integers $v$ and $w$ $(1 \leq v \lt w \leq n)$ indicating that there is a two-way street connecting locations $v$ and $w$. All location pairs in the input are distinct.
## 输出格式

On the first line, output $k$, the number of dead-end signs installed. On each of the next $k$ lines, output two integers $v$ and $w$ marking that a dead-end sign should be installed at the $v$-entrance of a street connecting locations $v$ and $w$. The lines describing dead-end signs must be sorted in ascending order of $v$-locations,breaking ties in ascending order of $w$-locations.
## 样例

### 样例输入 #1
```
6 5
1 2
1 3
2 3
4 5
5 6

```
### 样例输出 #1
```
2
4 5
6 5
```
### 样例输入 #2
```
8 8
1 2
1 3
2 3
3 4
1 5
1 6
6 7
6 8

```
### 样例输出 #2
```
3
1 5
1 6
3 4

```
## 提示

Source: ICPC World Finals 2019 Problem E.
## 题目翻译

有一张 $n$ 个点 $m$ 条边的简单无向图。

如果走过一条边 $u→v$ 后，不掉头无法返回到 u，这条边就是对 $u$ 来说的“死路”。

你需要对每个死路标记路标，但是有的路标是多余的。

如果从一个死路 $u→v$ 开始可以不掉头地走到另一个死路 $u' → v'$，那么后者 $u' → v'$ 就是多余的。

最后问要标记多少路标，输出每对 $u→v$，按照 $u$ 为第一关键字，$v$ 为第二关键字排序。

第一行输入 $n$ , $m$ ，后 $m$ 行每行两个整数 $u$ , $v$ 。

输出的第一行是要标记的路标数 $k$ ，然后 $k$ 行每行一对题目所说的死路 ： $u→v$ （不要输出“$→$”）。


---

---
title: "[COCI 2007/2008 #2] TURBO"
layout: "post"
diff: 普及+/提高
pid: P6339
tag: ['2007', 'COCI（克罗地亚）']
---
# [COCI 2007/2008 #2] TURBO
## 题目描述

给定一个长度为 $n$ 的 $1\sim n$ 的排列，你需要对其进行从小到大的排序，排序的规则如下：

- 第一个阶段，将数字 $1$  通过与和它相邻的数字的交换来放置到 $1$ 号下标上。
- 第二个阶段，将数字 $n$ 进行如上同样的操作来放置到 $n$ 号下标上。
- 第三个阶段，将数字 $2$ 进行如上同样的操作来放置到 $2$ 号下标上。
- 第四个阶段，将数字 $n-1$ 进行如上同样的操作来放置到 $n-1$ 号下标上。

以此类推。

对于每一个阶段，输出交换的次数。

## 输入格式

输入第一行为一个整数 $n$。

接下来的 $n$ 行，每行一个整数。描述了一个 $1\sim n$ 的排列。
## 输出格式

输出共 $n$ 行，对于每个阶段，输出交换的次数。
## 样例

### 样例输入 #1
```
3
2
1
3
```
### 样例输出 #1
```
1
0
0
```
### 样例输入 #2
```
5
5
4
3
2
1
```
### 样例输出 #2
```
4
3
2
1
0
```
### 样例输入 #3
```
7
5
4
3
7
1
2
6
```
### 样例输出 #3
```
4
2
3
0
2
1
0
```
## 提示

#### 数据规模与约定

- 对于 $70\%$ 的数据，保证 $n<100$。
- 对于 $100\%$ 的数据，保证 $1\le n\le 10^5$。
#### 说明

**题目译自 [COCI2007-2008](https://hsin.hr/coci/archive/2007_2008/) [CONTEST #2](https://hsin.hr/coci/archive/2007_2008/contest2_tasks.pdf) *T4 TURBO***。


---

---
title: "[COCI 2007/2008 #3] CUDAK"
layout: "post"
diff: 普及+/提高
pid: P6356
tag: ['2007', 'COCI（克罗地亚）']
---
# [COCI 2007/2008 #3] CUDAK
## 题目描述

求出在区间 $[A,B]$ 中有多少个整数的各位数字之和是 $S$。并请找出最小的那个整数。
## 输入格式

输入一行三个整数 $A,B,S$。


## 输出格式

输出共两行，第一行为整数的个数，第二行为最小的整数。

输入数据保证至少有一个这样的数。
## 样例

### 样例输入 #1
```
1 9 5
```
### 样例输出 #1
```
1
5
```
### 样例输入 #2
```
1 100 10
```
### 样例输出 #2
```
9
19
```
### 样例输入 #3
```
11111 99999 24
```
### 样例输出 #3
```
5445
11499
```
## 提示

#### 数据规模与约定

对于 $100\%$ 的数据，保证 $1\le A,B\le 10^{15}$，$1\le S\le 135$。
#### 说明

**题目译自 [COCI2007-2008](https://hsin.hr/coci/archive/2007_2008/) [CONTEST #3](https://hsin.hr/coci/archive/2007_2008/contest3_tasks.pdf) *T5 CUDAK***。


---

---
title: "[COCI 2007/2008 #3] REDOKS"
layout: "post"
diff: 普及+/提高
pid: P6357
tag: ['2007', 'COCI（克罗地亚）']
---
# [COCI 2007/2008 #3] REDOKS
## 题目描述

给定一串长度为 $n$ 的数字，数字为 $0\sim 9$ 之间的任意一个，下标从 $1$ 记起。

然后进行 $m$ 次区间查询，每次查找区间 $[A,B]$ 的区间和，并在查询结束后将区间里的每一个数都 $+1$。特殊地，如果 $+1$ 前的数字为 $9$，那么 $+1$ 之后就变成了 $0$。

请输出每次查询的区间和。
## 输入格式

输入第一行包含两个整数 $n,m$。

第二行 $n$ 个数字字符，字符间无空格。

接下来的 $m$ 行，每行两个整数 $A,B$，表示查询区间 $[A,B]$。
## 输出格式

输出共 $m$ 行，每行为一次查询的区间和。
## 样例

### 样例输入 #1
```
4 3
1234
1 4
1 4
1 4
```
### 样例输出 #1
```
10
14
18
```
### 样例输入 #2
```
4 4
1234
1 1
1 2
1 3
1 4
```
### 样例输出 #2
```
1
4
9
16
```
### 样例输入 #3
```
7 5
9081337
1 3
3 7
1 3
3 7
1 3
```
### 样例输出 #3
```
17
23
1
19
5
```
## 提示

#### 数据规模与约定

对于 $100\%$ 的数据，保证 $1\le n\le 2.5\times 10^5$，$1\le m\le 10^5$，$1\le A,B\le n$。
#### 说明

**题目译自 [COCI2007-2008](https://hsin.hr/coci/archive/2007_2008/) [CONTEST #3](https://hsin.hr/coci/archive/2007_2008/contest3_tasks.pdf) *T6 REDOKS***。


---

---
title: "[CEOI 2018] Cloud computing"
layout: "post"
diff: 普及+/提高
pid: P6359
tag: ['2018', 'CEOI（中欧）']
---
# [CEOI 2018] Cloud computing
## 题目背景

译自 CEOI2018 Day1 T1. [Cloud Computing](https://ceoi2018.pl/wp-content/uploads/2018/08/clo.pdf)。
## 题目描述

Johnny 创立了 Bytecomp，一家提供云计算能力的公司。这样的公司通常拥有许多快速的计算机，可以让客户在上面进行计算。

Johnny 仍然没有购买任何机器。他去了一家计算机商店，收到了一个包含所有 $n$ 台可用的计算机的清单。每台计算机都可以用三个属性描述：处理器内核数 $c_i$，时钟频率 $f_i$ 和价格 $v_i$。这样的计算机包含 $c_i$ 个独立的内核，所以他们可以被分配不同的任务。

当客户订购资源时，她会指定所需的内核数 $C_j$ 和最小的时钟频率 $F_j$。订单还包含客户愿意支付的价格 $V_j$。如果接受订单，Bytecomp 需要提供客户所需计算能力的独占访问权。Johnny 需要选择 $C_j$ 个核心（可能来自不同的计算机），且它们的时钟频率至少为 $F_j$，这些核心不能被分配给其它订单。

帮助 Johnny 赚尽可能多的钱：接受一个最优的订单子集，选择所有计算机的一个子集来满足所有接受了的订单。你的目标是最大化利润，即为客户提供计算能力的收入与购买计算机的成本之差。
## 输入格式

标准输入的第一行包含一个整数 $n$，表示商店中可用计算机的数量。

接下来 $n$ 行，每行描述一台计算机，包含三个空格隔开的整数 $c_i, f_i, v_i$，分别表示内核数，时钟频率和价格。

接下来一行一个整数 $m$，表示客户的订单数量。

接下来 $m$ 行，每行描述一个订单，包含三个空格隔开的整数 $C_j, F_j, V_j$，分别表示需要的核心数，最低的允许的时钟频率以及预算。
## 输出格式

标准输出唯一的一行包含一个整数，表示能够得到的最大利润。
## 样例

### 样例输入 #1
```
4
4 2200 700
2 1800 10
20 2550 9999
4 2000 750
3
1 1500 300
6 1900 1500
3 2400 4550
```
### 样例输出 #1
```
350
```
## 提示

#### 样例解释

一共有四台可用的计算机和三个订单。

最佳方案是购买两台价格为 $700$ 和 $750$（总计 $1450$）的四内核的计算机，然后接受前两个订单获得 $300+1500=1800$ 的收益。

我们获得了四个时钟频率为 $2000$ 的内核，和四个时钟频率为 $2200$ 的内核。可以将其中六个分配给第二个订单（需要 $1900$ 的时钟频率），再将其中一个分配给第一个订单（需要 $1500$ 的时钟频率），剩下一个核心不使用，这是允许的。

总利润为 $1800-1450=350$。

#### 数据规模与约定

对于 $100\%$ 的数据，$1\le n\le 2\times 10^3,\ 1\le c_i,C_i\le 50,\ 1\le f_i,F_i,v_i,V_i\le 10^9$。

所有测试数据被划分成若干个有附加限制的子任务，每个子任务中包含若干测试点。

| 子任务 | 附加限制 | 分值 |
| :--: | :---: | :--: |
| $1$ | $n \le 15$ | $18$ |
| $2$ | $m \le 15$ | $18$ |
| $3$ | $n,m \le 100$，$c_i = C_j = 1$ | $18$ |
| $4$ | $f_i = F_j = 1$ | $18$ |
| $5$ | $v_i = V_j = 1$ | $18$ |
| $6$ | 无附加限制 | $10$ |


---

---
title: "[CEOI 2018] Lottery"
layout: "post"
diff: 普及+/提高
pid: P6360
tag: ['2018', 'CEOI（中欧）']
---
# [CEOI 2018] Lottery
## 题目背景

译自 CEOI2018 Day1 T3. [Lottery](https://ceoi2018.pl/wp-content/uploads/2018/08/lot.pdf)。
## 题目描述

**请注意特殊的内存限制。**

长期以来，你一直是 Bytelotto 的忠实粉丝，但你的家人一直告诉你所有这样的游戏都是在浪费钱。你觉得这肯定是因为他们缺少技巧。你有一个很棒的计划，每个人都将很快看到你赢得游戏。

游戏类型很多，你对其中之一感兴趣：Bitlotto。游戏规则很简单，每天随机抽取一个数字作为中奖数字。你记下了连续 $n$ 天的中奖数字 $a_1, a_2, \ldots, a_n$。你确信这当中存在某种规律，尤其是连续 $l$ 天的区间中。你的家人仍然不相信你，所以说服他们的唯一方法是可靠的数学。

一共有 $n-l+1$ 个长度为 $l$ 的区间。第 $i$ 个区间从 $i$ 开始，因此它包含元素 $a_i, a_{i+1}, \ldots, a_{i+l-1}$。定义两个区间的距离为他们对应位置上的数字不相等的数量。形式化地说，第 $x$ 个区间与第 $y$ 个区间的距离为满足 $a_{x+i}\ne a_{y+i}$ 的位置 $i\ (0\le i < l)$ 的数量。然后我们定义两个区间是 $k$-相似的当且仅当这两个区间的距离不超过 $k$。

现在给出连续 $n$ 天的中奖数字和 $q$ 个询问，每个询问给出一个整数 $k_j$，你需要对序列中的每个长度为 $l$ 的区间，求出与该区间 $k_j$-相似的区间个数（不包括本身）。
## 输入格式

标准输入的第一行包含两个整数 $n,l$，分别表示天数和你需要分析的区间长度。

第二行包含 $n$ 个空格隔开的整数 $a_1, a_2, \ldots, a_n$，$a_i$ 表示第 $i$ 天的中奖数字。

第三行包含一个整数 $q$，表示询问次数。

接下来 $q$ 行，每行包含一个整数 $k_j$，表示第 $j$ 个询问的相似参数。
## 输出格式

输出 $q$ 行，第 $j$ 行包含 $n-l+1$ 个空格隔开的整数，表示第 $j$ 个询问的答案。一行中的第 $i$ 个数表示与第 $i$ 个区间 $k_j$-相似的不包括本身的区间数量。
## 样例

### 样例输入 #1
```
6 2
1 2 1 3 2 1
2
1
2
```
### 样例输出 #1
```
2 1 1 1 1
4 4 4 4 4
```
## 提示

#### 样例解释

整个序列有五个长度为 $2$ 的区间：

- 第一个区间包含 $1$ $2$；
- 第二个区间包含 $2$ $1$；
- 第三个区间包含 $1$ $3$；
- 第四个区间包含 $3$ $2$；
- 第五个区间包含 $2$ $1$。

共有两个询问。

第一个询问 $k=1$。第一个和第三个区间——$1$ $2$ 和 $1$ $3$——只有第二个位置不同，所以他们的距离为 $1$。类似地，第一个和第四个区间——$1$ $2$ 和 $3$ $2$——只有第一个位置不同，所以他们的距离为 $1$。与第一个区间 $1$-相似的区间只有这两个，所以第一个数输出 $2$。

第二个询问 $k=2$，所有区间都是 $2$-相似的。

#### 数据规模与约定

对于 $100\%$ 的数据，$1\le n\le 10^4,\ 1\le a_i\le 10^9,\ 1\le q\le 100,\ 0\le k_j\le l$。

所有测试数据被划分成若干个有附加限制的子任务，每个子任务中包含若干测试点。

| 子任务 | 附加限制 | 分值 |
| :--------: | :------------: | :--: |
|    $1$     |  $n \le 300$  | $25$ |
|    $2$     | $n \le 2000$  | $20$ |
|    $3$     | $q=1, k_1=0$ | $20$ |
|    $4$     |     $q=1$      | $15$ |
|    $5$     |   无附加限制   | $20$ |


---

---
title: "[传智杯 #2 初赛] 特殊的翻转"
layout: "post"
diff: 普及+/提高
pid: P6366
tag: ['传智杯']
---
# [传智杯 #2 初赛] 特殊的翻转
## 题目描述

k 老师在研究一段病毒程序的代码。这段代码是由一段长度不超过 $10^6$ 的十六进制字符（也就是 `0` 到 `9` 和 `A` 到 `F`）组成的信息。现在 k 老师要将其转换为二进制的 0/1 串（这个时候需要确保最高位是 1）。然后对这个 0/1 串进行“翻转”操作。

对于每次“翻转”操作，k 老师可以选择这个 0/1 串中的其中一位，将这一位和这一位相邻的两位，一共三位，分别进行“翻转”（也就是 0 变 1，1 变 0）。如果指定的这一位是序列的开头或者结尾，那么翻转这一位和存在的相邻位即可。

k 老师想知道，如何用最少的“翻转”步骤，将这个 0/1 串变为全 0 的串。
## 输入格式

一个十六进制的字符串，由 `0` 到 `9` 和 `A` 到 `F` 构成。
## 输出格式

最少能将其变为全 0 串需要的“翻转”步骤次数。如果无论如何都不能将其变为全 0 串，则输出 `No`。
## 样例

### 样例输入 #1
```
15
```
### 样例输出 #1
```
3
```
### 样例输入 #2
```
FF
```
### 样例输出 #2
```
3
```
### 样例输入 #3
```
10
```
### 样例输出 #3
```
No
```
## 提示

样例解释：

十六进制的 15 对应二进制的 10101，翻转第 1/3/5 位，就可以全部变为 0。

十六进制的 FF 对应二进制的 11111111，翻转第 2/5/8 位，就可以全部变为 0。

十六进制的 10 对应二进制的 10000，无法全变为 0。



---

---
title: "[COCI 2007/2008 #4] POKLON"
layout: "post"
diff: 普及+/提高
pid: P6390
tag: ['2007', 'COCI（克罗地亚）']
---
# [COCI 2007/2008 #4] POKLON
## 题目描述

给定 $n$ 个区间，Mirko 想要构造一些区间，满足后续的区间是前面区间的子区间，且区间里的每个数都包含在给定的区间里。
## 输入格式

输入第一行为一个整数 $n$。

接下来的 $n$ 行，每行两个整数 $[A,B]$，表示一个给定的区间。
## 输出格式

输出第一行为一个整数 $k$，表示可以构造出的区间数。

接下来的 $k$ 行，每行两个整数，依次表示构造的区间。
## 样例

### 样例输入 #1
```
3
3 4
2 5
1 6
```
### 样例输出 #1
```
3
1 6
2 5
3 4
```
### 样例输入 #2
```
5
10 30
20 40
30 50
10 60
30 40
```
### 样例输出 #2
```
3
10 60
30 50
30 40
```
### 样例输入 #3
```
6
1 4
1 5
1 6
1 7
2 5
3 5
```
### 样例输出 #3
```
5
1 7
1 6
1 5
2 5
3 5
```
## 提示

#### 数据规模与约定

对于 $100\%$ 的数据，保证 $1\le n\le 10^5$，$1\le A<B\le 10^6$。
#### 说明

**题目译自 [COCI2007-2008](https://hsin.hr/coci/archive/2007_2008/) [CONTEST #4](https://hsin.hr/coci/archive/2007_2008/contest4_tasks.pdf) *T5 POKLON***。


---

---
title: "[COCI 2014/2015 #2] BOB"
layout: "post"
diff: 普及+/提高
pid: P6404
tag: ['2014', 'O2优化', 'COCI（克罗地亚）']
---
# [COCI 2014/2015 #2] BOB
## 题目描述

Bob 是一位著名的建设者。他买了地，想盖房子。不幸的是，问题是土地的地形，土地不同地方的海拔不一定一样。

这块地呈长方形，宽 $n$ 米，长 $m$ 米。它可以分为 $n\times m$ 个方格（见图片）。Bob 的房子将被塑造成一个长方形，它的边与土地的边平行，其顶点与正方形的顶点重合。Bob 的房子所覆盖的所有土地必须具有相同的高度，以防倒塌。

![](https://cdn.luogu.com.cn/upload/image_hosting/aedp5fq2.png)

请计算出 Bob 建房的方法数。

**形式化地**，求出一个矩阵中所有元素均相等的子矩阵个数。
## 输入格式

第一行输入包含整数 $n$ 和 $m$。

以下 $n$ 行中的每一行都包含 $m$ 个整数 $a_{i,j}$，分别是每平方土地的海拔高度。

**由于输入量很大，请使用更快的输入方法。**
## 输出格式

仅一行，即 Bob 建房的方法数。
## 样例

### 样例输入 #1
```
5 3
2 2 2
2 2 1
1 1 1
2 1 2
1 2 1
```
### 样例输出 #1
```
27
```
### 样例输入 #2
```
4 3
1 1 1
1 1 1
2 2 2
2 2 2
```
### 样例输出 #2
```
36
```
## 提示

#### 样例 1 说明

一些可能的房屋位置是分别以 $(0,0)-(1,1),(0,0)-(0,2)$ （高度为 $2$）$(2,0)-(2,2),(1,2)-(2,2)$（高度为 $1$）为左上角顶点和右下角顶点的矩形。括号中的第一个数字表示行号，第二个数字表示列号（坐标以 $0$ 开始）。

#### 数据规模与约定

- 对于 $20\%$ 的数据，有 $1\le n,m\le 50$。
- 对于 $60\%$ 的数据，有 $1\le n,m\le 500$。
- 对于 $100\%$ 的数据，有 $1\le n,m\le 10^3$。

对于所有合法的 $a_{i,j}$，都有 $1\le a_{i,j}\le 10^9$。

#### 说明

**题目译自 [COCI2014-2015](https://hsin.hr/coci/archive/2014_2015/) [CONTEST #2](https://hsin.hr/coci/archive/2014_2015/contest2_tasks.pdf) _T4 BOB_。**


---

---
title: "[COCI 2014/2015 #1] MAFIJA"
layout: "post"
diff: 普及+/提高
pid: P6417
tag: ['2014', 'COCI（克罗地亚）']
---
# [COCI 2014/2015 #1] MAFIJA
## 题目描述

有 $n$ 个人，其中有一些人是平民，有一些人是坏蛋。

现在，平民们想揪出所有的坏蛋，于是 $n$ 个人都指认了一个人是坏蛋。

如果一个人是平民，他会随便乱指认，否则，他会指认一个平民。

求出最多的坏蛋个数。
## 输入格式

第一行一个整数 $n$。

接下来 $n$ 行，每行一个整数 $k$，第 $i$ 行表示第 $i$ 个人指认了第 $k$ 个人。
## 输出格式

仅一行一个整数，表示最多的坏蛋个数。
## 样例

### 样例输入 #1
```
3
2
1
1

```
### 样例输出 #1
```
2
```
### 样例输入 #2
```
3
2
3
1

```
### 样例输出 #2
```
1

```
### 样例输入 #3
```
7
3
3
4
5
6
4
4
```
### 样例输出 #3
```
4
```
## 提示

#### 样例解释
#### 样例输入输出 1 解释
坏蛋可以是第 $2$ 个人和第 $3$ 个人。
#### 样例输入输出 2 解释
坏蛋可能是所有人，但是只能是其中的一个人，因为再多一个坏蛋的话会有坏蛋指控坏蛋的情况发生。

#### 数据范围与限制
- 对于 $40$ 分的数据，保证 $n\le 15$。
- 对于 $80$ 分的数据，保证 $n\le 2\times 10^4$。
- 对于 $100\%$ 的数据，保证 $1\le n\le 5\times 10^5$，$1\le k\le n$。

#### 说明
**本题总分 $120$ 分。**

本题译自 [Croatian Open Competition in Informatics 2014/2015](https://hsin.hr/coci/archive/2014_2015) [Contest #1](https://hsin.hr/coci/archive/2014_2015/contest1_tasks.pdf) T4 MAFIJA。


---

---
title: "[COCI 2011/2012 #6] PASTELE"
layout: "post"
diff: 普及+/提高
pid: P6441
tag: ['2011', 'Special Judge', 'COCI（克罗地亚）']
---
# [COCI 2011/2012 #6] PASTELE
## 题目背景

## 警告：滥用本题评测将被封号。

Mirko 收到了一份礼物。


## 题目描述

这份礼物共包含 $n$ 支蜡笔。每只蜡笔的颜色由色光三原色组成：红、绿、蓝。分别用参数 $R_i,G_i,B_i$ 表示。这只蜡笔的颜色就由这三个参数来决定。

对于两支蜡笔 $i,j$，我们定义它们之间的差异值为 $\max(|R_i-R_j|,|G_i-G_j|,|B_i-B_j|)$。定义一些蜡笔的色彩值为这些蜡笔中任意两支蜡笔差异值的最大值。

给出这 $n$ 支蜡笔的特征值，请找出 $k$ 支蜡笔，使得色彩值最小。
## 输入格式

输入第一行为两个整数 $n,k$。

接下来的 $n$ 行，每行三个整数 $R_i,G_i,B_i$，表示第 $i$ 支蜡笔的颜色参数。
## 输出格式

输出第一行为一个整数，表示 $k$ 支蜡笔的色彩值的最小值。

接下来的 $k$ 行，每行三个整数，描述这 $k$ 支蜡笔都由哪些蜡笔组成。

**由于方案的组成可能不唯一，本题使用SPJ**。
## 样例

### 样例输入 #1
```
2 2
1 3 2
2 6 4
```
### 样例输出 #1
```
3
1 3 2
2 6 4
```
### 样例输入 #2
```
3 2
3 3 4
1 6 4
1 1 2
```
### 样例输出 #2
```
2
3 3 4
1 1 2
```
### 样例输入 #3
```
5 3
6 6 4
6 2 7
3 1 3
4 1 5
6 2 6
```
### 样例输出 #3
```
2
6 2 7
4 1 5
6 2 6
```
## 提示

#### 数据规模与约定

- 对于 $50\%$ 的数据，保证 $R_i,G_i,B_i\le 20$；
- 对于另 $30\%$ 的数据，保证 $R_i,G_i,B_i\le 50$；
- 对于 $100\%$ 的数据，保证 $2\le k\le n\le 10^5$，$0\le R_i,G_i,B_i\le 256$，$0\le k_i\le m$。

#### 提示

请注意常数因子对程序效率造成的影响。

#### 说明

**题目译自 [COCI2011-2012](https://hsin.hr/coci/archive/2011_2012/) [CONTEST #6](https://hsin.hr/coci/archive/2011_2012/contest6_tasks.pdf) *T5 PASTELE***。


---

---
title: "[COCI 2008/2009 #4] SLIKAR"
layout: "post"
diff: 普及+/提高
pid: P6451
tag: ['2008', 'COCI（克罗地亚）']
---
# [COCI 2008/2009 #4] SLIKAR
## 题目背景

Josip 是一个奇怪的画家。
## 题目描述

他想画一幅由 $n\times n$ 个像素点组成的画。其中 $n$ 是 $2$ 的幂次（如 $1,2,4,8,16,\dots$）。每个像素点将会被着色为黑色或者白色。Josip 目前已经知道他的理想画作了。

他将按照如下步骤作画：

- 如果整幅画是一个像素点，那么他将依照自己的目标把这个像素点涂成黑色或者白色。

- 否则，他会将正方形分为四个更小的正方形，然后：

1. 从中选择一个正方形全部涂成白色。
1. 再从剩下的三个正方形中选择一个全部涂成黑色。
1. 把剩下的两个正方形当成一幅新的画作，重复上述步骤。

很快他就发现把心目中的画作完完整整的画出来是不可能的。所以，他希望你来编写一个程序，使得画出的一幅画与他心目中的理想画作的差异尽量小。

两张画作之间的差异为颜色不同的像素点的数目。
## 输入格式

输入第一行为一个整数 $n$，表示画作的边长。

接下来的 $n$ 行，每行 $n$ 个为 $0$ 或 $1$ 的数字，表示理想状态当前像素点为黑色或者白色。
## 输出格式

输出第一行一个整数，表示最小的差异值。

接下来的 $n$ 行，每行 $n$ 个为 $0$ 或 $1$ 的数字，表示实际上当前像素的颜色。

**注意：染色的方案可能有多种，输出任意一种即可，本题使用SPJ**。
## 样例

### 样例输入 #1
```
4
0001
0001
0011
1110
```
### 样例输出 #1
```
1
0001
0001
0011
1111
```
### 样例输入 #2
```
4
1111
1111
1111
1111
```
### 样例输出 #2
```
6
0011
0011
0111
1101
```
### 样例输入 #3
```
8
01010001
10100011
01010111
10101111
01010111
10100011
01010001
10100000
```
### 样例输出 #3
```
16
00000001
00000011
00000111
00001111
11110111
11110011
11110001
11110000
```
## 提示

#### 数据规模与约定

- 对于 $50\%$ 的数据，$n\le 8$；
- 对于 $100\%$ 的数据，$1\le n\le 512$。

#### 说明

**题目译自 [COCI2008-2009](https://hsin.hr/coci/archive/2008_2009/) [CONTEST #4](https://hsin.hr/coci/archive/2008_2009/contest4_tasks.pdf) *T4 SLIKAR***。


---

---
title: "[COCI 2006/2007 #5] IVANA"
layout: "post"
diff: 普及+/提高
pid: P6457
tag: ['2006', 'COCI（克罗地亚）']
---
# [COCI 2006/2007 #5] IVANA
## 题目描述

给定 $n$ 个整数排成一圈，两位玩家进行如下的取数规则：

- 第一次取数的玩家可以取任意一个数；
- 第二次取数的玩家只能从上一次取得数的左右两边相邻的两个数中取一个；
- 第三次取数的玩家可以从之前所有取过的任意一个数的左右两边相邻的两个数中取一个；

其中，与第一个数和第 $n$ 个数相邻的只有一个数。

两位玩家轮流取数。在所有的数都被取完之后，取得奇数多的玩家胜利。

请你找出，先手玩家有多少种不同的开局方法，使得自己能够赢得比赛。
## 输入格式

输入第一行一个整数 $n$ ,表示数字的数量。

第二行 $n$ 个数，表示具体的数字。
## 输出格式

输出一行一个整数，表示先手玩家赢得比赛的开局种类数。
## 样例

### 样例输入 #1
```
3
3 1 5
```
### 样例输出 #1
```
3
```
### 样例输入 #2
```
4
1 2 3 4
```
### 样例输出 #2
```
2
```
### 样例输入 #3
```
8
4 10 5 2 9 8 1 7
```
### 样例输出 #3
```
5
```
## 提示

#### 数据规模与约定

对于 $100\%$ 的数据，保证 $1\le n\le 100$，读入的数字都在 $1\sim 1000$ 之间。

#### 说明

**题目译自 [COCI2006-2007](https://hsin.hr/coci/archive/2006_2007/) [CONTEST #5](https://hsin.hr/coci/archive/2006_2007/contest5_tasks.pdf) *T5 IVANA***。


---

---
title: "[COCI 2008/2009 #6] CUSKIJA"
layout: "post"
diff: 普及+/提高
pid: P6470
tag: ['2008', 'Special Judge', 'COCI（克罗地亚）']
---
# [COCI 2008/2009 #6] CUSKIJA
## 题目描述

给定一个长度为 $n$ 的序列 $a$，请将其重新排序，新序列中任意相邻两个数之和都不能被 $3$ 整除。
## 输入格式

第一行有一个整数，表示序列的长度 $n$。

第二行有 $n$ 个整数，第 $i$ 个整数表示序列的第 $i$ 个元素 $a_i$。
## 输出格式

**本题存在 Special Judge**。

- 如果存在解，请在第一行输出一行一个字符串 `Yes`，并在第二行输出 $n$ 个整数，第 $i$ 个整数表示新序列的第 $i$ 个元素。
- 如果无解，请只输出一行一个字符串 `No`。
## 样例

### 样例输入 #1
```
3
1 2 3

```
### 样例输出 #1
```
Yes
2 3 1
```
### 样例输入 #2
```
5
4 6 3 9 8

```
### 样例输出 #2
```
Yes
3 4 6 8 9
```
### 样例输入 #3
```
6
3 7 6 4 2 8

```
### 样例输出 #3
```
Yes
3 7 4 6 2 8

```
### 样例输入 #4
```
3
3 12 9

```
### 样例输出 #4
```
No
```
## 提示

#### 数据规模与约定

对于全部的测试点，保证 $1 \leq n \leq 10^4$，$1 \leq a_i \leq 10^6$。

#### 【说明】

**题目译自 [COCI2008-2009](https://hsin.hr/coci/archive/2008_2009/) [CONTEST #6](https://hsin.hr/coci/archive/2008_2009/contest6_tasks.pdf) *T4 CUSKIJA***，翻译与 SPJ 均来自 @[一扶苏一](https://www.luogu.com.cn/user/65363)。为了 SPJ 判定方便，输出格式较原题略有修改。


---

---
title: "[COCI 2010/2011 #6] ABECEDA"
layout: "post"
diff: 普及+/提高
pid: P6491
tag: ['2010', 'O2优化', 'COCI（克罗地亚）']
---
# [COCI 2010/2011 #6] ABECEDA
## 题目描述

人们发现一份字典序未知的单词表。其中共包含 $n$ 个单词。

虽然不知道具体的字典序，但大家已知这些单词在单词表上是按照字典序排列的。

你需要求出这份单词表所依照哪种字典序。
## 输入格式

输入第一行一个整数 $n$，表示单词数。

接下来的 $n$ 行，每行一个字符串，描述一个单词。
## 输出格式

输出一行：

- 如果有唯一的字典序，则按照你求出的字典序依次输出字母；
- 如果答案不存在，则输出 `!`；
- 如果存在多种可能的字典序，则输出 `?`。
## 样例

### 样例输入 #1
```
5
ula
uka
klua
kula
al
```
### 样例输出 #1
```
luka
```
### 样例输入 #2
```
4
jaja
baba
baja
beba
```
### 样例输出 #2
```
!
```
### 样例输入 #3
```
3
marko
darko
zarko
```
### 样例输出 #3
```
?
```
## 提示

#### 样例 1 解释

根据第一列的字母可知，`a` `k` `u` 这三个字母的字典序是 `u` `k` `a`。再观察第二列可知，`l` 排在 `u` 之前。所以最终的字典序为 `luka`，且是唯一解。

#### 数据规模与约定

对于 $100\%$ 的数据，保证 $1\le n\le 100$，所有的单词仅包含小写字母且最多包含 $10$ 个。

#### 说明

**题目译自 [COCI2010-2011](https://hsin.hr/coci/archive/2010_2011/) [CONTEST #6](https://hsin.hr/coci/archive/2010_2011/contest6_tasks.pdf) *T4 ABECEDA***。


---

---
title: "[COCI 2010/2011 #6] STEP"
layout: "post"
diff: 普及+/提高
pid: P6492
tag: ['2010', 'O2优化', 'COCI（克罗地亚）']
---
# [COCI 2010/2011 #6] STEP
## 题目描述

给定一个长度为 $n$ 的字符序列 $a$，初始时序列中全部都是字符 `L`。

有 $q$ 次修改，每次给定一个 $x$，若 $a_x$ 为 `L`，则将 $a_x$ 修改成 `R`，否则将 $a_x$ 修改成 `L`。

对于一个只含字符 `L`，`R` 的字符串 $s$，若其中不存在连续的 `L` 和 `R`，则称 $s$ 满足要求。

每次修改后，请输出当前序列 $a$ 中最长的满足要求的连续子串的长度。
## 输入格式

第一行有两个整数，分别表示序列的长度 $n$ 和修改操作的次数 $q$。

接下来 $q$ 行，每行一个整数，表示本次修改的位置 $x$。
## 输出格式

对于每次修改操作，输出一行一个整数表示修改 $a$ 中最长的满足要求的子串的长度。
## 样例

### 样例输入 #1
```
6 2
2
4

```
### 样例输出 #1
```
3
5
```
### 样例输入 #2
```
6 5
4
1
1
2
6

```
### 样例输出 #2
```
3
3
3
5
6
```
## 提示

#### 数据规模与约定

对于全部的测试点，保证 $1 \leq n, q \leq 2 \times 10^5$，$1 \leq x \leq n$。

#### 说明

**题目译自 [COCI2010-2011](https://hsin.hr/coci/archive/2010_2011/) [CONTEST #6](https://hsin.hr/coci/archive/2010_2011/contest6_tasks.pdf) *T5 STEP***，翻译来自 @[一扶苏一](https://www.luogu.com.cn/user/65363)。


---

---
title: "[QkOI#R1] Quark and Flying Pigs"
layout: "post"
diff: 普及+/提高
pid: P6512
tag: []
---
# [QkOI#R1] Quark and Flying Pigs
## 题目描述

给定一个 $n$ 个点 $m$ 条边的边带权简单连通无向图，在 $0$ 时刻你在点 $1$ 上。

假设当前是 $t$ 时刻，你在点 $v$ 上，你可以选择两种操作：

- 仍停留在点 $v$ 上，操作后到 $t+1$ 时刻。
- 选择一条边 $(a,b,w)$ 满足 $a=v$ 或 $b=v$，则你到这条边连接的另一个点上，操作后到 $t+w$ 时刻。

有 $k$ 条信息，每一条信息形如 $(t_i,v_i)$ 表示在 $t_i$ 时刻，点 $v_i$ 上会出现一只飞猪，其编号为 $i$，若该时刻你在 $v_i$ 上，则你捕获到了 $i$ 号飞猪。

现在你需要求出你能捕获到的飞猪数量的最大值。


## 输入格式

第一行为三个正整数 $n,m,k$。

接下来 $m$ 行每行三个正整数 $a_i,b_i,w_i$。

接下来 $k$ 行每行两个正整数 $t_i,v_i$。
## 输出格式

一行一个整数，为你能捕获到的飞猪数量的最大值。
## 样例

### 样例输入 #1
```
2 1 5
1 2 2
1 2
2 2
3 2
5 1
7 2

```
### 样例输出 #1
```
4
```
## 提示

### 样例解释

最优方案如下：

$0$ 时刻，选择移动到节点 $2$，时间来到 $2$ 时刻。  
$2$ 时刻，捕获到第 $2$ 只飞猪，选择停留在节点 $2$，时间来到 $3$ 时刻。  
$3$ 时刻，捕获到第 $3$ 只飞猪，选择移动到节点 $1$，时间来到 $5$ 时刻。  
$5$ 时刻，捕获到第 $4$ 只飞猪，选择移动到节点 $2$，时间来到 $7$ 时刻。  
$7$ 时刻，捕获到第 $5$ 只飞猪。

### 数据范围

对于 $20\%$ 的数据，$n,m,k\le 7$。  
对于 $100\%$ 的数据，$2\le n\le 200$，$1\le m\le \frac{n(n-1)}{2}$，$1\le k\le 5000$，$1\le a_i,b_i,v_i\le n$，$1\le w_i\le 1000$，$1\le t_i\le 10^9$。


---

---
title: "[CEOI 2010] tower (day2)"
layout: "post"
diff: 普及+/提高
pid: P6522
tag: ['2010', 'O2优化', 'CEOI（中欧）']
---
# [CEOI 2010] tower (day2)
## 题目背景

古巴比伦人决定建造一座塔。
## 题目描述

这座塔共有 $n$ 层，每层由一个边长为 $a_i$ 的立方体石块构成。一个石块 $i$ 能够直接放在石块 $j$ 上当且仅当 $a_i  \leq a_j+D$，其中 $D$ 为一个给定的常数。

你需要求出如果使用全部的石块，有多少种不同的搭建方案。输出答案 $\bmod\ 10^9+9$ 的结果。

**注意：即使两个石块的边长相同，也看做不同的石块。**

## 输入格式

输入第一行两个整数 $n,D$。

第二行 $n$ 个整数 $a_1,\dots,a_n$，表示每个立方体石块的边长。 
## 输出格式

输出一行一个整数，表示方案总数 $\bmod\ 10^9+9$ 的结果。
## 样例

### 样例输入 #1
```
4 1
1 2 3 100
```
### 样例输出 #1
```
4
```
### 样例输入 #2
```
6 9
10 20 20 10 10 20
```
### 样例输出 #2
```
36
```
## 提示

#### 【样例解释】

#### 样例 1 解释

首先把边长为 $100$ 的石块放在底部，其余的石块可以任意顺序放置，除了以下两种情况：`2,1,3` `1,3,2`。

#### 样例 2 解释

首先不允许在 $10$ 上面放 $20$。

所以就把 $20$ 一堆放在底下，$10$ 一堆放在上面。

即 $(3!)\times (3!)=36$。

#### 【数据规模与约定】

- 对于 $10\%$ 的数据，保证 $n\le 10$；
- 对于 $30\%$ 的数据，保证方案数不超过 $10^6$；
- 对于 $45\%$ 的数据，保证 $n\le 20$；
- 对于 $70\%$ 的数据，保证 $n\le 70$；
- 对于 $100\%$ 的数据，保证 $2\le n\le 6.2\times 10^5$，输入中所有数字为不超过 $10^9$ 的正整数。


#### 【说明】

**题目译自 [CEOI 2010](http://ceoi2010.ics.upjs.sk/Contest/Tasks) day 2 *[T3 tower](https://people.ksp.sk/~misof/ceoi2010/tow-eng.pdf)***。

翻译版权为题目提供者 @[ShineEternal](https://www.luogu.com.cn/user/45475) 所有，未经许可禁止转载。




---

---
title: "[COCI 2013/2014 #1] LOPOV"
layout: "post"
diff: 普及+/提高
pid: P6538
tag: ['2013', 'COCI（克罗地亚）']
---
# [COCI 2013/2014 #1] LOPOV
## 题目背景

有一些物品和一个小偷。
## 题目描述

有 $N$ 件物品，每件物品有质量 $M_i$ 和价值 $V_i$。

Mirko 有 $K$ 个袋子，每袋可容纳的最大质量为 $C_i$。

每袋仅能放一个物品，问最多可以带走多少价值的物品？
## 输入格式

第一行包含两个正整数 $N$ 和 $K$。

接下来 $N$ 行中的每行包含两个正整数 $M_i$ 和 $V_i$。

接下来 $K$ 行中的每行包含一个正整数 $C_i$。
## 输出格式

输出一行，能拿走的最大物品总价值。
## 样例

### 样例输入 #1
```
2 1
5 10
100 100
11 
```
### 样例输出 #1
```
10
```
### 样例输入 #2
```
3 2
1 65
5 23
2 99
10
2
```
### 样例输出 #2
```
164
```
## 提示

#### 【数据规模与约定】
- $1\le N,K\le 3\times 10^5$。
- $1\le M_i,V_i\le 10^6$。
- $1\le C_i\le 10^8$。

#### 样例 2 解释
Mirko 将第一件物品放在第二袋中，将第三件物品放在第一袋中。

-------
#### 【说明】
**题目译自 [COCI2013-2014](https://hsin.hr/coci/archive/2013_2014/) [CONTEST #1](https://hsin.hr/coci/archive/2013_2014/contest1_tasks.pdf)  _T4 LOPOV_。**


---

---
title: "「SWTR-5」Sequence"
layout: "post"
diff: 普及+/提高
pid: P6650
tag: ['O2优化']
---
# 「SWTR-5」Sequence
## 题目描述

小 A 有一个长度为 $n$ 的序列 $a_1,a_2,\cdots,a_n$。他可以选择一个区间 $[l,r]$ 满足其最大值与最小值的差不超过 $k$。

他还需找出 $m$ 个**互不相同的整数** $p_1,p_2,\cdots,p_m$，满足：

- $m$ 为正整数。
- $\prod\limits_{i=l}^ra_i=\prod\limits_{i=1}^mp_i$。即选择区间的乘积等于这 $m$ 个数的乘积。
- $p_i$ 为一个质数的正整数次幂。

这 $m$ 个数的约数个数之和就是小 A 的得分。帮他求出得分的最大值。
## 输入格式

第一行两个整数 $n,k$。

第二行 $n$ 个整数 $a_1,a_2,\cdots,a_n$ 表示这个序列。
## 输出格式

一行一个整数表示答案。
## 样例

### 样例输入 #1
```
4 2
6 4 2 3
```
### 样例输出 #1
```
7
```
### 样例输入 #2
```
5 3
8 6 9 6 4
```
### 样例输出 #2
```
13
```
### 样例输入 #3
```
17 17
29 38 9 10 16 5 1 10 27 20 11 9 15 11 2 3 10 

```
### 样例输出 #3
```
17
```
## 提示

「样例说明」

样例 $1$：选择区间 $[1,2]$，再选择 $p_1=2$，$p_2=3$，$p_3=4$，可以达到最大值 $7$，方案不唯一。

样例 $2$：选择区间 $[1,4]$，再选择 $p_1=4$，$p_2=8$，$p_3=3$，$p_4=27$，可以达到最大值 $13$。

「数据范围与约定」

**本题采用捆绑测试**。

- Subtask 1（1 points）：$n=1$ 且 $a_1$ 为质数。
- Subtask 2（9 points）：$n=1$。
- Subtask 3（20 points）：$n\leq 10$，$a_i \leq 20$。
- Subtask 4（13 points）：$n\leq 200$，$a_i \leq 200$。
- Subtask 5（17 points）：$n\leq 2\times 10^3$。
- Subtask 6（15 points）：$a_i$ 为质数。
- Subtask 7（25 points）：无特殊限制。

对于 $100\%$ 的数据：$1 \leq n \leq 10^5$，$2 \leq a_i \leq 10^5$，$0 \leq k \leq 10^5$。

---

「题目来源」

[Sweet Round 05](https://www.luogu.com.cn/contest/28195) B。    
idea & solution：[ET2006](https://www.luogu.com.cn/user/115194)。


---

---
title: "论如何玩转 Excel 表格"
layout: "post"
diff: 普及+/提高
pid: P6687
tag: ['洛谷月赛']
---
# 论如何玩转 Excel 表格
## 题目描述

有一个 $2 \times n$ 的表格，表格内不重不漏地填有 $1 \sim 2 \times n$ 这些数字。你可以进行若干次操作，每次操作可以选择一个 $2 \times 2$ 的正方形区域，然后旋转 $180\degree$。

给出现在的状态以及目标状态。问是否可以达到目标状态。如果能，最少操作次数是多少。
## 输入格式

第一行一个正整数 $n$。

接下来两行，每行 $n$ 个正整数表示表格现在的状态。

接下来两行，每行 $n$ 个正整数表示目标状态。
## 输出格式

若无解，输出一行 `dldsgay!!1`。

否则，输出一个整数，表示最少的操作次数。
## 样例

### 样例输入 #1
```
1
1
2
2
1

```
### 样例输出 #1
```
dldsgay!!1

```
### 样例输入 #2
```
2
1 2
3 4
4 3
2 1

```
### 样例输出 #2
```
1

```
### 样例输入 #3
```
2
1 2
3 4
1 2
4 3

```
### 样例输出 #3
```
dldsgay!!1

```
### 样例输入 #4
```
3
1 6 2
4 3 5
2 4 3
5 1 6

```
### 样例输出 #4
```
2

```
## 提示

#### 子任务

本题采用捆绑测试。

对于 $100\%$ 的数据：$1 \leq n \leq 10^6$。

本题共 $10$ 个子任务，各子任务的分值和限制如下：

子任务 $1$（$1$ 分）：保证输出一定为 `dldsgay!!1`。  
子任务 $2$（$1$ 分）：保证目标状态与现在状态一致。  
子任务 $3$（$4$ 分）：$n=1$。  
子任务 $4$（$5$ 分）：$n=2$。  
子任务 $5$（$14$ 分）：$1 \leq n \leq 20$。  
子任务 $6$（$19$ 分）：$1 \leq n \leq 100$。  
子任务 $7$（$19$ 分）：$1 \leq n \leq 1000$。  
子任务 $8$（$8$ 分）：保证目标状态第一行依次为 $1 \sim n$，第二行依次为  $n + 1 \sim 2n$。  
子任务 $9$（$10$ 分）：保证不存在无解情况。  
子任务 $10$（$19$ 分）：无特殊限制。


---

---
title: "[BalticOI 2020] 图 (Day2)"
layout: "post"
diff: 普及+/提高
pid: P6696
tag: ['2020', 'Special Judge', 'BalticOI（波罗的海）']
---
# [BalticOI 2020] 图 (Day2)
## 题目描述

你有一个无向图，每条边都有一种颜色：红或者黑。

你要做的就是为每个节点配一个实数点权，使得：

- 对于每条黑色边，两个端点的点权之和为 $1$
- 对于每条红色边，两个端点的点权之和为 $2$
- 所有点权的绝对值之和是最小的

求一种点权的分配方案。
## 输入格式

第一行两个整数 $N,M$ 代表点数和边数。     
所有点的编号为 $1$ 到 $N$。         
接下来 $M$ 行每行三个整数 $a,b,c$ 描述一条边端点为 $a$ 和 $b$，如果 $c$ 是 $1$ 那么这条边是黑色边，如果 $c$ 是 $2$ 那么这条边是红色边。
## 输出格式

如果有解，首先第一行输出 `YES`，然后第二行 $N$ 个整数代表可能的一组点权。       
多组解输出任意一组即可。        
如果无解，一行一个字符串 `NO`。
## 样例

### 样例输入 #1
```
4 4
1 2 1
2 3 2
1 3 2
3 4 1
```
### 样例输出 #1
```
YES
0.5 0.5 1.5 -0.5

```
### 样例输入 #2
```
2 1
1 2 1

```
### 样例输出 #2
```
YES
0.3 0.7
```
### 样例输入 #3
```
3 2
1 2 2
2 3 2

```
### 样例输出 #3
```
YES
0 2 0
```
### 样例输入 #4
```
3 4
1 2 2
2 2 1
2 1 1
1 2 2

```
### 样例输出 #4
```
NO
```
## 提示

#### 评测方式

您的输出被评判为正确，当且仅当：

- 每条边所连两点的点权和与该边要求的点权间的误差不超过 $10^{-6}$。
- 所有点权的绝对值之和与标准答案误差不超过 $10^{-6}$。

#### 数据规模与约定

**本题采用捆绑测试。**

- Subtask 1（5 pts）：$N \le 5$，$M \le 14$。     
- Subtask 2（12 pts）：$N \le 100$。
- Subtask 3（17 pts）：$N \le 1000$。
- Subtask 4（24 pts）：$N \le 10^4$。
- Subtask 5（42 pts）：无特殊限制。

对于 $100\%$ 的数据，$1 \le N \le 10^5$，$0 \le M \le 2 \times 10^5$。

**本题使用 Special Judge。**


---

---
title: "[COCI 2010/2011 #7]  KUGLICE"
layout: "post"
diff: 普及+/提高
pid: P6706
tag: ['2010', 'COCI（克罗地亚）']
---
# [COCI 2010/2011 #7]  KUGLICE
## 题目背景

Mirko 和 Slavko 喜欢玩弹珠。 在一个激动人心的星期五，Mirko 发明了一个关于弹珠的游戏，他想向 Slavko 展示。

在游戏中，Mirko 构造了一个有向图，其中每个点出度不超过 $1$。然后他在其中一个点上放了一个弹珠，只要弹珠在某个顶点 $X$ 上，弹珠就会移动到由一条边连接的相邻顶点（没有就算了）。弹珠的运动一直持续到弹珠到达一个没有出度的点为止。弹珠也有可能因没有出度为 $0$ 的点而无限遍历图。为了确保 Slavko 能理解游戏规则，Mirko 会问一系列问题。

询问类型如下:

1. `1 X`：除非弹珠卡在一个循环，求弹珠被放在 $X$ 后最后的终止点序号。

2. `2 X`：删除顶点 $X$ 的出边。（保证存在）

注意：查询有序。
## 题目描述

给定一个有向图，其中每个点出度为 $0$ 或 $1$。

有如下询问：

1. `1 X`：给定弹珠起始点 $X$，求弹珠运动的终止点。

2. `2 X`：删除 $X$ 点出边。（保证存在）

弹珠运动规则：

从初始点沿着出边走直到一点出度为 $0$。
## 输入格式

第一行一个正整数 $n$，指图中顶点数。

第二行 $n$ 个正整数，其中第 $i$ 个数表示 $i$
的出边指向点序号，若 $0$ 则指不存在。

下面一行一个正整数 $Q$，指查询数目。

下面 $Q$ 行每行包含一个上述格式的查询。
## 输出格式

对于每个类型 $1$ 的查询，按照顺序，每行输出弹珠停止点序号。

如果弹珠永不停止，则输出 $\texttt{CIKLUS}$。
## 样例

### 样例输入 #1
```
3
2 3 1
7
1 1
1 2
2 1
1 2
1 1
2 2
1 2
```
### 样例输出 #1
```
CIKLUS
CIKLUS
1
1
2
```
### 样例输入 #2
```
5
0 3 5 3 4
6
1 1
1 2
2 4
1 2
2 3
1 2
```
### 样例输出 #2
```
1
CIKLUS
4
3
```
## 提示

#### 数据规模及约定

对于 $100\%$ 的数据 $1 \le n,Q \le 3 \times 10^5$。

#### 说明

本题满分 $120$ 分。

译自 [COCI2010-2011](https://hsin.hr/coci/archive/2010_2011/) [CONTEST #7](https://hsin.hr/coci/archive/2010_2011/contest7_tasks.pdf) T5 KUGLICE。


---

---
title: "[CCC 2020]  Swapping Seats"
layout: "post"
diff: 普及+/提高
pid: P6709
tag: ['2020', 'CCC（加拿大）']
---
# [CCC 2020]  Swapping Seats
## 题目描述

有 $N$ 个人坐在一张**圆**桌旁。

共有三个派别，每一个人属于一个派别。

现在，您想使属于同一派别的人坐到一起。

您可以每次将两个人交换位置，输出最小的交换次数。
## 输入格式

仅一行一个长度为 $N$ 的字符串 $s$，为顺时针所有人的派别。

如果 $s_i$ 为 `A`，则说明第 $i$ 个人为第一个派别的，以此类推。
## 输出格式

仅一行一个整数，表示最小的交换次数。
## 样例

### 样例输入 #1
```
BABCBCACCA
```
### 样例输出 #1
```
2
```
## 提示

#### 样例解释
$\texttt{BABCBCACCA}\to\texttt{AABCBCBCCA}\to\texttt{AABBBCCCCA}$。

#### 子任务
**本题采用捆绑测试，且本题的 Subtask 分数有微调。**
- Subtask 1（$26$ 分）：$s_i\in\{$`A`$,$`B`$\}$ 且 $N\le 5\times 10^3$。
- Subtask 2（$27$ 分）：$s_i\in\{$`A`$,$`B`$\}$。
- Subtask 3（$27$ 分）：$N\le 5\times 10^3$。
- Subtask 4（$20$ 分）：无特殊限制。

对于 $100\%$ 的数据，保证 $s_i\in\{$`A`$,$`B`$,$`C`$\}$，$1\le N\le 10^6$。

#### 说明
本题译自 [Canadian Computing Competition](https://cemc.uwaterloo.ca/resources/past-contests?contest_category=29) [2020 Senior](https://cemc.uwaterloo.ca/sites/default/files/documents/2020/seniorEF.pdf) T4 Swapping Seats。


---

---
title: "[CEOI 2020] 花式围栏"
layout: "post"
diff: 普及+/提高
pid: P6801
tag: ['2020', 'CEOI（中欧）']
---
# [CEOI 2020] 花式围栏
## 题目背景

0.1s，32MB
## 题目描述

众所周知，Balázs 拥有整个城镇中最漂亮的围栏。围栏由 $N$ 个部分组成，每个部分均为矩形，且相邻的两个部分间均紧密相连。第 $i$ 部分矩形的高度为 $h_i$，宽度为 $w_i$，我们需要找到满足如下条件的花式矩形：

- 矩形的每条边均是水平的或竖直的，且每条边的长度为整数。
- 矩形与地面的距离为整数。
- 矩形与围栏第一部分的左侧边的距离为整数。
- 矩形完整包含在围栏中。

现在你需要求出花式矩形的总数。因为这个数字可能很大，请输出其对 $10^9+7$ 取模后的结果。
## 输入格式

输入第一行包含一个整数 $N$，代表围栏由 $N$ 部分组成。

第二行 $N$ 个整数，第 $i$ 个整数为第 $i$ 个矩形的高度 $h_i$。

第三行 $N$ 个整数，第 $i$ 个整数为第 $i$ 个矩形的宽度 $w_i$。
## 输出格式

输出花式矩形数对 $10^9+7$ 取模后的结果。
## 样例

### 样例输入 #1
```
2
1 2
1 2
```
### 样例输出 #1
```
12
```
## 提示

### 样例解释 1

围栏形状如下所示：

![](https://cdn.luogu.com.cn/upload/image_hosting/o0w99om5.png)

形状如下的矩形有 $5$ 个：

![](https://cdn.luogu.com.cn/upload/image_hosting/qvrh1vbs.png)

形状如下的矩形有 $3$ 个：

![](https://cdn.luogu.com.cn/upload/image_hosting/hx15etpn.png)

形状如下的矩形有 $1$ 个：

![](https://cdn.luogu.com.cn/upload/image_hosting/s01bhzfn.png)

形状如下的矩形有 $2$ 个：

![](https://cdn.luogu.com.cn/upload/image_hosting/ee3kec7y.png)

形状如下的矩形有 $1$ 个：

![](https://cdn.luogu.com.cn/upload/image_hosting/n26e8gyi.png)

### 样例 2

见附加文件。

### 子任务

所有测试点均满足：$1 \leq N \leq 10^5$，$1 \leq h_i,w_i \leq 10^9$。

各子任务的约束条件如下：

| 子任务编号 | 分值 | 约束                                                         |
| ---------- | ---- | ------------------------------------------------------------ |
| $1$        | $0$  | 样例                                                         |
| $2$        | $12$ | $N \leq 50$，且 $\forall i \in [1,N]$，$h_i \leq 50$ 且 $w_i=1$ |
| $3$        | $13$ | $\forall i \in [1,N]$，$h_i=1$ 或 $h_i=2$                    |
| $4$        | $15$ | 所有的 $h_i$ 均相等                                          |
| $5$        | $15$ | $\forall i \in [1,N-1]$，$h_i \leq h_{i+1}$                  |
| $6$        | $18$ | $N \leq 1000$                                                |
| $7$        | $27$ | 无特殊约束                                                   |


---

---
title: "[COCI 2019/2020 #5] Zapina"
layout: "post"
diff: 普及+/提高
pid: P6870
tag: ['2019', 'COCI（克罗地亚）']
---
# [COCI 2019/2020 #5] Zapina
## 题目描述

有 $n$ 个**不同的**人和 $n$ 道**不同的**题。

第 $i$ 个人开心当且仅当他被分配到 $i$ 道题。

求让至少一个人开心的分配方案数。
## 输入格式

一个正整数：$n$。
## 输出格式

一个数字：你的答案$\bmod 10^9+7$。
## 样例

### 样例输入 #1
```
1

```
### 样例输出 #1
```
1
```
### 样例输入 #2
```
2

```
### 样例输出 #2
```
3
```
### 样例输入 #3
```
314

```
### 样例输出 #3
```
192940893
```
## 提示

### 数据范围

**本题捆绑测试。**

- 对于 $22 pts$ 的数据，$2\leq n\leq 7$。
- 对于另外 $33 pts$ 的数据，$1\leq n\leq 20$。
- 对于所有的数据，$1\leq n\leq 350$。

### 样例#2解释

有以下 $3$ 种方案：

- 第一题給第一个人，第二题給第二个人。

- 第二题給第一个人，第一题給第二个人。

- 两题都给第二个人。

### 说明

**题目译自 [COCI2019-2020](https://hsin.hr/coci/archive/2019_2020/) [CONTEST #5](https://hsin.hr/coci/archive/2019_2020/contest5_tasks.pdf)  _T5 Zapina_** ，译者 [90693](/user/90693)。


---

---
title: "[ICPC 2015 WF] Keyboarding"
layout: "post"
diff: 普及+/提高
pid: P6909
tag: ['2015', 'ICPC']
---
# [ICPC 2015 WF] Keyboarding
## 题目描述

How many keystrokes are necessary to type a text message? You may think that it is equal to the number of characters in the text, but this is correct only if one keystroke generates one character. With pocket-size devices, the possibilities for typing text are often limited. Some devices provide only a few buttons, significantly fewer than the number of letters in the alphabet. For such devices, several strokes may be needed to type a single character. One mechanism to deal with these limitations is a virtual keyboard displayed on a screen, with a cursor that can be moved from key to key to select characters. Four arrow buttons control the movement of the cursor, and when the cursor is positioned over an appropriate key, pressing the fifth button selects the corresponding character and appends it to the end of the text. To terminate the text, the user must navigate to and select the Enter key. This provides users with an arbitrary set of characters and enables them to type text of any length with only five hardware buttons.

In this problem, you are given a virtual keyboard layout and your task is to determine the minimal number of strokes needed to type a given text, where pressing any of the five hardware buttons constitutes a stroke. The keys are arranged in a rectangular grid, such that each virtual key occupies one or more connected unit squares of the grid. The cursor starts in the upper left corner of the keyboard and moves in the four cardinal directions, in such a way that it always skips to the next unit square in that direction that belongs to a different key. If there is no such unit square, the cursor does not move.

![](https://cdn.luogu.com.cn/upload/image_hosting/3cxjl2y4.png)

   Figure 1: Sample Input 1. An example virtual keyboard and hardware buttons. 

Figure 1, illustrating Sample Input 1, shows a possible way to type CONTEST using 30 strokes on an example virtual keyboard. The red dots represent the virtual keys where the select button was pressed.
## 输入格式

The first line of the input contains two integers $r$ and $c$ ($1 \leq r, c \leq 50$), giving the number of rows and columns of the virtual keyboard grid. The virtual keyboard is specified in the next $r$ lines, each of which contains $c$ characters. The possible values of these characters are uppercase letters, digits, a dash, and an asterisk (representing Enter). There is only one key corresponding to any given character. Each key is made up of one or more grid squares, which will always form a connected region. The last line of the input contains the text to be typed. This text is a non-empty string of at most $10\, 000$ of the available characters other than the asterisk.
## 输出格式

Display the minimal number of strokes necessary to type the whole text, including the Enter key at the end. It is guaranteed that the text can be typed.
## 样例

### 样例输入 #1
```
4 7
ABCDEFG
HIJKLMN
OPQRSTU
VWXYZ**
CONTEST

```
### 样例输出 #1
```
30

```
### 样例输入 #2
```
5 20
12233445566778899000
QQWWEERRTTYYUUIIOOPP
-AASSDDFFGGHHJJKKLL*
--ZZXXCCVVBBNNMM--**
--------------------
ACM-ICPC-WORLD-FINALS-2015

```
### 样例输出 #2
```
160

```
### 样例输入 #3
```
2 19
ABCDEFGHIJKLMNOPQZY
X*****************Y
AZAZ

```
### 样例输出 #3
```
19

```
### 样例输入 #4
```
6 4
AXYB
BBBB
KLMB
OPQB
DEFB
GHI*
AB

```
### 样例输出 #4
```
7

```
## 提示

Time limit: 3000 ms, Memory limit: 1048576 kB. 

 International Collegiate Programming Contest (ACM-ICPC) World Finals 2015
## 题目翻译

给定一个 $r$ 行 $c$ 列的在电视上的「虚拟键盘」，通过「上，下，左，右，选择」共 $5$ 个控制键，你可以移动电视屏幕上的光标来打印文本。一开始，光标在键盘的左上角，每次按方向键，光标总是跳到下一个在该方向上与当前位置的字符不同的字符，若不存在则不移动。每次按选择键，则将光标所在位置的字符打印出来。  
现在求打印给定文本（要在结尾打印换行符）的最少按键次数。


---

---
title: "[ICPC 2016 WF] Ceiling Function"
layout: "post"
diff: 普及+/提高
pid: P6919
tag: ['2016', 'ICPC']
---
# [ICPC 2016 WF] Ceiling Function
## 题目描述

Advanced Ceiling Manufacturers (ACM) is analyzing the properties of its new series of Incredibly Collapse-Proof Ceilings (ICPCs). An ICPC consists of $n$ layers of material, each with a different value of collapse resistance (measured as a positive integer). The analysis ACM wants to run will take the collapse-resistance values of the layers, store them in a binary search tree, and check whether the shape of this tree in any way correlates with the quality of the whole construction. Because, well, why should it not?

To be precise, ACM takes the collapse-resistance values for the layers, ordered from the top layer to the bottom layer, and inserts them one-by-one into a tree. The rules for inserting a value $v$ are:

If the tree is empty, make $v$ the root of the tree.

If the tree is not empty, compare $v$ with the root of the tree. If $v$ is smaller, insert $v$ into the left subtree of the root, otherwise insert $v$ into the right subtree.

ACM has a set of ceiling prototypes it wants to analyze by trying to collapse them. It wants to take each group of ceiling prototypes that have trees of the same shape and analyze them together.

For example, assume ACM is considering five ceiling prototypes with three layers each, as described by Sample Input 1 and shown in Figure 1. Notice that the first prototype’s top layer has collapse-resistance value 2, the middle layer has value 7, and the bottom layer has value 1. The second prototype has layers with collapse-resistance values of 3, 1, and 4 – and yet these two prototypes induce the same tree shape, so ACM will analyze them together.

Given a set of prototypes, your task is to determine how many different tree shapes they induce.

![](https://cdn.luogu.com.cn/upload/image_hosting/xvdteesl.png)

   Figure 1: The four tree shapes induced by the ceiling prototypes in Sample Input 1. 
## 输入格式

The first line of the input contains two integers $n$ ($1 \le n \le 50$), which is the number of ceiling prototypes to analyze, and $k$ ($1 \le k \le 20$), which is the number of layers in each of the prototypes.

The next $n$ lines describe the ceiling prototypes. Each of these lines contains $k$ distinct integers (between $1$ and $10^6$, inclusive), which are the collapse-resistance values of the layers in a ceiling prototype, ordered from top to bottom.
## 输出格式

Display the number of different tree shapes.
## 样例

### 样例输入 #1
```
5 3
2 7 1
3 1 4
1 5 9
2 6 5
9 7 3

```
### 样例输出 #1
```
4

```
### 样例输入 #2
```
3 4
3 1 2 40000
3 4 2 1
33 42 17 23

```
### 样例输出 #2
```
2

```
## 提示

Time limit: 5000 ms, Memory limit: 1048576 kB. 

 International Collegiate Programming Contest (ACM-ICPC) World Finals 2016
## 题目翻译

给出 $n$ 组数，每组 $k$ 个，求这些数每组分别按顺序插入构成的不同二叉搜索树的数量。


---

---
title: "[ICPC 2017 WF] Posterize"
layout: "post"
diff: 普及+/提高
pid: P6934
tag: ['2017', 'ICPC']
---
# [ICPC 2017 WF] Posterize
## 题目描述



![](https://onlinejudgeimages.s3-ap-northeast-1.amazonaws.com/problem/14638/1.png)

Pixels in a digital picture can be represented with three integers in the range $0$ to $255$ that indicate the intensity of the red, green, and blue colors. To compress an image or to create an artistic effect, many photo-editing tools include a `posterize` operation which works as follows. Each color channel is examined separately; this problem focuses only on the red channel. Rather than allow all integers from $0$ to $255$ for the red channel, a posterized image allows at most $k$ integers from this range. Each pixel's original red intensity is replaced with the nearest of the allowed integers. The photo-editing tool selects a set of $k$ integers that minimizes the sum of the squared errors introduced across all pixels in the original image. If there are $n$ pixels that have original red values $r_{1},$ . . . , $r_{n},$ and $k$ allowed integers $v_{1},$ . . . , $v_{k},$ the sum of squared errors is defined as

$$\sum\limits_{i=1}^n \min\limits_{1 \le j \le k}(r_i-v_j)^2$$

Your task is to compute the minimum achievable sum of squared errors, given parameter $k$ and a description of the red intensities of an image's pixels.


## 输入格式



The first line of the input contains two integers $d (1 \le d \le 256)$ , the number of distinct red values that occur in the original image, and $k (1 \le k \le d)$ , the number of distinct red values allowed in the posterized image. The remaining $d$ lines indicate the number of pixels of the image having various red values. Each such line contains two integers $r (0 \le r \le 255)$ and $p (1 \le p \le 2^{26}),$ where $r$ is a red intensity value and $p$ is the number of pixels having red intensity $r$ . Those $d$ lines are given in increasing order of red value.


## 输出格式



Display the sum of the squared errors for an optimally chosen set of $k$ allowed integer values.


## 样例

### 样例输入 #1
```
2 1
50 20000
150 10000

```
### 样例输出 #1
```
66670000

```
### 样例输入 #2
```
2 2
50 20000
150 10000

```
### 样例输出 #2
```
0

```
### 样例输入 #3
```
4 2
0 30000
25 30000
50 30000
255 30000

```
### 样例输出 #3
```
37500000

```
## 提示

Time limit: 2 s, Memory limit: 512 MB. 


## 题目翻译

给定 $d$ 类元素，第 $i$ 类元素的取值为 $r_i$，且有 $p_i$ 个，按照这些信息可以将这些元素排列在一个长度为 $n=\sum p_i$ 的序列里，现在你要做的是规划一个长度为 $k$ 的序列 $v_i$，使得按照如下定义的序列误差最小：

$$\sum\limits_{i=1}^n \min\limits_{1 \le j \le k}(r_i-v_j)^2$$

求最小序列误差。

$1 \le k \le d \le 256$，$0 \le r \le 255$，$1 \le p \le 2^{26}$。

翻译者：一只书虫仔


---

---
title: "[ICPC 2018 WF] Go with the Flow"
layout: "post"
diff: 普及+/提高
pid: P6946
tag: ['2018', 'ICPC']
---
# [ICPC 2018 WF] Go with the Flow
## 题目描述



In typesetting, a `river` is a string of spaces formed by gaps between words that extends down several lines of text. For instance, Figure F.1 shows several examples of rivers highlighted in red (text is intentionally blurred to make the rivers more visible).

![](https://onlinejudgeimages.s3-ap-northeast-1.amazonaws.com/problem/15694/1.png)

Figure F.1 : Examples of rivers in typeset text.

Celebrated river authority Flo Ng wants her new book on rivers of the world to include the longest typographic rivers possible. She plans to set the text in a mono-spaced font (all letters and spaces have equal width) in a left-aligned column of some fixed width, with exactly one space separating words on each line (the text is not aligned on the right). For Flo, a `river` is defined as a sequence of spaces lying in consecutive lines in which the position of each space in the sequence (except the first) differs by at most $1$ from the position of the space in the line above it. Trailing white space cannot appear in a river. Words must be packed as tightly as possible on lines; no words may be split across lines. The line width used must be at least as long as the longest word in the text. For instance, Figure F.2 shows the same text set with two different line widths.

![](https://onlinejudgeimages.s3-ap-northeast-1.amazonaws.com/problem/15694/2.png)

Figure F.2 : Longest rivers $( \times )$ for two different line widths.

Given a text, you have been tasked with determining the line width that produces the longest river of spaces for that text.


## 输入格式



The first line of input contains an integer $n (2 \le n \le 2 500)$ specifying the number of words in the text. The following lines of input contain the words of text. Each word consists only of lowercase and uppercase letters, and words on the same line are separated by a single space. No word exceeds $80$ characters.


## 输出格式



Display the line width for which the input text contains the longest possible river, followed by the length of the longest river. If more than one line width yields this maximum, display the shortest such line width.


## 样例

### 样例输入 #1
```
21
The Yangtze is the third longest
river in Asia and the longest in
the world to flow
entirely in one country

```
### 样例输出 #1
```
15 5

```
### 样例输入 #2
```
25
When two or more rivers meet at
a confluence other than the sea
the resulting merged river takes
the name of one of those rivers

```
### 样例输出 #2
```
21 6

```
## 提示

Time limit: 12 s, Memory limit: 1024 MB. 


## 题目翻译

#### 题目描述
在字体排印学中，“川流”是由单词之间的间隙组成的连续几列的空格。如图所示为几个用红色高亮标出的“川流”（文本被有意模糊处理来凸显川流）：

![img](https://onlinejudgeimages.s3-ap-northeast-1.amazonaws.com/problem/15694/1.png)

知名川流机构 Flo Ng 希望他在新的关于世界河流的书上出现尽可能长的川流。他会使用一种单一字宽的字体（每个字母和空格都具有相同的宽度）且左对齐，单词之间恰用一个空格分隔。对 Flo 来说，一条“川流”指的是连续几行里的空格，且相邻空格在行里出现的位置的距离不超过 $1$。川流不能包含末尾的空格。每行的单词都必须尽可能地紧凑，但不能有单词被拆到两行里。行宽至少不能短于文本中最长的一个单词。下图是同一个文本使用不同行宽的一个例子。

![img](https://onlinejudgeimages.s3-ap-northeast-1.amazonaws.com/problem/15694/2.png)

给定文本，你需要求出一个行宽使得该文本最长的川流尽可能长。

#### 输入格式
第一行有一个整数 $n(2≤n≤2500)$ 表示文本的单词个数。接下来几行为该文本的单词。每个单词都只包含大写和小写字母，且长度不超过 $80$ 个字符。

#### 输出格式
输出两个整数，分别表示使得文本出现最长的川流的行宽以及川流的长度。如果有多个行款达到川流长度的最大值，输出最小的行宽。


---

---
title: "[ICPC 2018 WF] Wireless is the New Fiber"
layout: "post"
diff: 普及+/提高
pid: P6951
tag: ['2018', 'Special Judge', 'ICPC']
---
# [ICPC 2018 WF] Wireless is the New Fiber
## 题目描述



A new type of unbounded-bandwidth wireless communication has just been tested and proved to be a suitable replacement for the existing, fiber-based communications network, which is struggling to keep up with traffic growth. You have been charged with deciding the layout of the new communications network. The current communications network consists of a set of nodes (which route messages), and links of fiber, each of which connects two different nodes. For each pair of nodes, there exists at least one way (but possibly more, for bandwidth purposes) to travel along the fiber between the two.

The new communications network will not have any fiber. Instead, it will have wireless links, each connecting two nodes. These links have unbounded bandwidth but are expensive, so it has been decided that as few of these links will be built as possible to provide connectivity; for each pair of nodes there should be exactly one way to travel between them along the wireless links. Moreover, you discovered that the nodes have each been built with a particular number of connections in mind. For each node, if it will be connected to a different number of links than it is today, it will have to be reorganized, and that is costly.

Your task is to design the new network so that it has precisely one path between each pair of nodes while minimizing the number of nodes that do not have the same number of connections as in the original network. Figure K.1 shows the original network and a solution for Sample Input $1$ .

![](https://onlinejudgeimages.s3-ap-northeast-1.amazonaws.com/problem/15699/1.png)

Figure K.1 : Illustration of Sample Input $1$ .


## 输入格式



The input begins with a line containing two integers $n (2 \le n \le 10^{4})$ and $m (1 \le m \le 10^{5}),$ denoting the number of nodes and the number of fiber links in the existing network. The nodes are numbered from $0$ to $n − 1$ . Each of the next $m$ lines contains two distinct integers $a_{i}$ and $b_{i},$ denoting the fact that the $i^{th}$ fiber link connects nodes numbered $a_{i}$ and $b_{i}.$ It is guaranteed that for each pair of nodes there exists at least one path connecting the two nodes. Any pair of nodes may have more than one fiber link connecting them.


## 输出格式



Display the smallest number of nodes for which the number of connected links needs to change. Starting on the next line, display a system of connections in the same format as the input. That is, display a line containing the number of nodes (this will be the same as in the input) and the number of wireless links, and then on subsequent lines descriptions of the links. If more than one layout is possible, any valid layout will be accepted.


## 样例

### 样例输入 #1
```
7 11
0 1
0 2
0 5
0 6
1 3
2 4
1 2
1 2
1 5
2 6
5 6

```
### 样例输出 #1
```
3
7 6
0 1
0 2
0 5
0 6
3 6
4 6

```
### 样例输入 #2
```
4 3
0 1
2 1
2 3

```
### 样例输出 #2
```
0
4 3
2 1
1 3
0 2

```
## 提示

Time limit: 2 s, Memory limit: 1024 MB. 

SPJ provider: @[shenyouran](/user/137367).
## 题目翻译

给你一张 $n$ 个点 $m$ 条边的无向连通图，用这 $n$ 个点重新构建一棵树使得有尽可能少的节点度数发生改变，求一种方案。


---

---
title: "[NEERC 2017] Box"
layout: "post"
diff: 普及+/提高
pid: P6953
tag: ['2017', 'ICPC']
---
# [NEERC 2017] Box
## 题目描述



Bella is working in a factory that produces boxes. All boxes are in a shape of rectangular parallelepipeds. A net of the corresponding parallelepiped is cut out of a flat rectangular piece of cardboard of size $w$ *h . This net is a polygon with sides parallel to the sides of the rectangle of the cardboard. The net is bent along several lines and is connected along the edges of the resulting parallelepiped to form a box. The net is bent only along the edges of the resulting box.

![](https://onlinejudgeimages.s3-ap-northeast-1.amazonaws.com/problem/15284/1.png)

![](https://onlinejudgeimages.s3-ap-northeast-1.amazonaws.com/problem/15284/2.png)

The first example

The third example

Bella is a software developer and her task is to check whether it is possible to make a box of size $a \times b \times c$ out of a cardboard of size $w \times h$ . Bella did write a program and boxes are being produced. Can you do the same?


## 输入格式



The first line contains three integers a , $b$ , and $c$ -- the dimensions of the box.

The second line contains two integers $w$ and $h$ -- the width and the height of the cardboard.

All integers are positive and do not exceed $10^{8}.$


## 输出格式



Print `Yes` if it is possible to cut a box a $ \times b \times c$ out of a cardboard of size $w \times h$ . Print `No` otherwise.


## 样例

### 样例输入 #1
```
1 2 3
6 5

```
### 样例输出 #1
```
Yes

```
### 样例输入 #2
```
1 2 3
5 5

```
### 样例输出 #2
```
No

```
### 样例输入 #3
```
1 1 1
10 2

```
### 样例输出 #3
```
Yes

```
## 提示

Time limit: 3 s, Memory limit: 512 MB. 


## 题目翻译

给出一个长方体的长、宽、高（分别是 $a, b, c$），问：能否在一张长为 $w$，宽为 $h$ 的纸上裁出这个长方体的某一个侧面展开图。

如果可以，请输出 `Yes`，否则输出 `No`。


---

---
title: "[NEERC 2017] Designing the Toy"
layout: "post"
diff: 普及+/提高
pid: P6955
tag: ['2017', 'Special Judge', 'ICPC']
---
# [NEERC 2017] Designing the Toy
## 题目描述



You are the main toy producer in the city. Recently you bought a $3D-printer$ that provides you with an unprecedented opportunity for designing new fancy toys for children.

In a package with the $3D-printer$ there is a booklet containing several examples of what can be created with it. One of the examples is a figure that looks like a triangle, like a circle, or like a square depending on which of its sides you are looking at.

Unfortunately, it turned out that the booklet describes the most recent version of your printer. Your printer is only able to create figures that consist of voxels (three-dimensional pixels), i.e . figures that look like a union of a unit-length cubes that are the cells of a three-dimensional grid. Thus, you are not able to print any `smooth` figures (like a sphere, for example) with it. On the other hand, important feature of your model is its ability to create figures whose parts are not even connected with each other by putting wires of a negligible thickness between them.

You like the idea of the figure in the booklet, so you decided to improve upon this idea. Instead of specifying shapes of figure projections from different perspectives, you would specify their areas. In this problem, a voxel is defined by a triple of integers $(x , y , z)$ , which corresponds to a unit cube [x , $x + 1] \times $ [y , $y + 1] \times $ [z , $z + 1].$

![](https://onlinejudgeimages.s3-ap-northeast-1.amazonaws.com/problem/15286/1.png)

You are given three positive integers a , $b$ and $c$ . Your task is to find a description of a figure $F$ consisting of one or more voxels, for which the area of its orthogonal projection onto the plane Oxy is a , the area of its orthogonal projection onto the plane Oxz is $b$ , and the area of its orthogonal projection onto the plane Oyz is $c$ , or to determine that it is impossible.


## 输入格式



The only line of the input contains three integers a , $b$ , and $c (1 \le $ a , $b , c \le 100)$ -- the desired area of orthogonal projections onto the planes Oxy, Oxz, and Oyz correspondingly.


## 输出格式



If it is impossible to find the desired figure, print only the integer $−1$ .

Otherwise, in the first line print the integer $n$ , defining the number of voxels in the figure. Then print $n$ triples $x , y , z (−100 \le x , y , z \le 100)$ defining the voxels of the figure. Voxels may be printed in any order, but no voxel may be repeated twice.

The number of voxels $n$ should not exceed $10^{6}.$

Any figure with the requested projection areas is accepted.


## 样例

### 样例输入 #1
```
4 3 5

```
### 样例输出 #1
```
6
0 0 0
0 1 0
0 2 0
0 2 2
1 2 2
0 0 2

```
### 样例输入 #2
```
100 1 1

```
### 样例输出 #2
```
-1

```
## 提示

Time limit: 3 s, Memory limit: 512 MB. 


## 题目翻译

## 题目描述

你是这里的玩具生产大佬。最近你买了一台 3D 打印机，它给你提供了一个~~大赚一笔~~创造新玩具的机会。

你的打印机只能打印由一个个单位方块（棱长为 $1$ 的正方体）构成的几何体。因此，你不能打印出任何“光滑”的几何体（比如球体）。另外，这台打印机打印的几何体可以有完全不相连甚至浮空的部分。

建立空间直角坐标系。一个 $[x , x + 1] $ $\times $ $[y , y + 1]$ $\times $ $[z , z + 1]$ 的方块用整数三元组 $(x , y , z)$ 表示。

现在你想指定打印出的几何体在平面 $Oxy$，平面 $Oxz$ 和平面 $Oyz$ 上的投影面积。

![](https://cdn.luogu.com.cn/upload/image_hosting/udemly1h.png)

给出三个正整数 $a,b,c$，依次表示几何体在平面 $Oxy$，平面 $Oxz$ 和平面 $Oyz$ 上的投影面积。判断该集合体是否存在，若存在，找到满足条件的几何体。

## 输入格式

一行，包含 $3$ 个正整数 $a,b,c$ $(1 \le a , b , c \le 100)$。

## 输出格式

如果所求几何体不存在，输出 `-1` 。

否则，输出的第一行包含一个整数 $n$，表示图中方块的数量。

接下来 $n$ 行，每行 $3$ 个整数 $x,y,z$ 表示每个方块的位置。方块可以按任意顺序输出，但不能重复。

$n$ 的值不应超过 $10^{6}$。

任何满足条件的几何体都算作正确。

## 提示

时间限制：3s，内存限制：512MB。

Translated by Georiky


---

---
title: "[NEERC 2016] Abbreviation"
layout: "post"
diff: 普及+/提高
pid: P6964
tag: ['2016', 'ICPC']
---
# [NEERC 2016] Abbreviation
## 题目描述



An abbreviation (from Latin brevis, meaning short) is a shortened form of a word or phrase. In this problem you must write an automated tool that replaces a sequence of capitalized words with the corresponding abbreviation that consists of the first upper case letters only, followed by a full definition in parenthesis. See sample input and output.

Let us make some formal definitions. A word in a text is a maximally long sequence of lower and upper case English letters. A capitalized word is a word that consists of an upper case letter followed by one or more lower case letters. For example, `Ab`, `Abc`, `Abcd`, and `Abcde` are all capitalized words, while `ab`, `A`, `AB`, `ABc` and `AbC` are not.

An abbreviatable sequence of words is a sequence of two or more capitalized words that are separated by exactly one space, no line breaks or punctuation are allowed inside it.

An abbreviation of an abbreviatable sequence of words is a sequence of the first (upper case) letters of each word, followed by a single space, an opening parenthesis, the original abbreviatable sequence, and a closing parenthesis.


## 输入格式



The input file consists of up to $1 000$ lines of text with up to $120$ characters on each line. Each line consists of spaces, upper and lower case letters, commas or dots. There are no leading or trailing spaces on lines and there are no empty lines. There is at least one line in the input file.


## 输出格式



Write to the output file the original text with every abbreviatable sequence of words replaced with the corresponding abbreviation.


## 样例

### 样例输入 #1
```
This is ACM North Eastern European Regional Contest,
sponsored by International Business Machines.
The. Best. Contest. Ever.
A Great Opportunity for all contestants.

```
### 样例输出 #1
```
This is ACM NEERC (North Eastern European Regional Contest),
sponsored by IBM (International Business Machines).
The. Best. Contest. Ever.
A GO (Great Opportunity) for all contestants.

```
### 样例输入 #2
```
ab Ab A Abc AB Abcd ABc Abcde AbC

```
### 样例输出 #2
```
ab Ab A Abc AB Abcd ABc Abcde AbC

```
### 样例输入 #3
```
Oh  No  Extra Spaces.And,Punctuation Ruin Everything

```
### 样例输出 #3
```
Oh  No  ES (Extra Spaces).And,PRE (Punctuation Ruin Everything)

```
## 提示

Time limit: 1 s, Memory limit: 512 MB. 


## 题目翻译

### 题目描述
定义 word 为一个首字母大写、长度大于 1 、 其他位为小写字母的单词，如 `Ab`、 `Abc`、 `Abcd`、 和 `Abcde`，但 `ab`、`A`、 `AB`、 `ABc` 和 `AbC`。

定义一个 word 串为一个有大于 1 个 word 、每两个 word 中有且只有一个空格的串，如 `International Business Machines`。

现给你若干行，如遇到 word 串则让他变为缩写，缩写方式为：先提取首字母（大写），再加空格和 `(` ，再把全称写出来，最后加上 `)` ，如: `International Business Machines` 可缩写为 `IBM (International Business Machines)` 。

### 输入格式
若干行（不超过 1000 行）由大小写字母、标点和空格组成的的字符串（每行不超过 120 个字符）。

### 输出格式
缩写后的若干行字符串（无法缩写的不用缩写）。

#### translate by:`ddgtang`


---

---
title: "[NEERC 2013] Bonus Cards"
layout: "post"
diff: 普及+/提高
pid: P6997
tag: ['2013', 'Special Judge', 'ICPC']
---
# [NEERC 2013] Bonus Cards
## 题目描述



Dmitry loves programming competitions very much. The Finals of the famed Champions League are taking place in Dmitry's home city, so he wants to visit the competition. The competition is very popular, but most tickets to the competition are reserved for VIPs and for sponsors.

For the general public tickets to the Champions League Finals are distributed in the following way. Spectators, that want to see the competition, submit their request that states the payment method they want to use to pay for their ticket. Suppose there are $n$ seats available. Several draw round are conducted. In each round every request that is not yet fulfilled receives some number of slots depending on the payment method. Then one of those slots is selected uniformly at random. The request to which this slot belongs is considered fulfilled and does not take part in subsequent drawing rounds. Draw ends after $n$ rounds or when there are no more unfulfilled requests, whichever occurs first. An International Card Processing Corporation (ICPC) is a sponsor of the Champions League. Those who chose ICPC card as a payment method receive two slots in each draw round, while users of other payment methods receive only one.

Dmitry has a card from ICPC, but he also has a card from Advanced Credit Merchandise $(ACM),$ which offers him a bonus on all his spendings. His brother Petr works in a company that conducts draw to distribute tickets, so he told Dmitry in advance how many people had already decided to use ICPC card and how many had decided to use other methods. Now Dmitry want to know the probabilities he would get a ticket if he would use his ICPC card or if he would use his ACM card, so that he can make an informed choice. His request is going to be in addition to the number of requests Petr had told him about.

Can you help?


## 输入格式



The first and the only line of the input contains $3$ integer numbers -- the number of seats available for a draw $n (1 \le n \le 3000)$ , the number of requests with ICPC card as a payment method a , and the number of requests with other payment methods $b (0 \le $ a , $b \le 10^{9}).$


## 输出格式



On the first line output the probability of getting a ticket using ICPC card. On the second line output the probability of getting a ticket using ACM card. Answers should have an absolute error of no more than $10^{-9}.$


## 样例

### 样例输入 #1
```
1 1 2

```
### 样例输出 #1
```
0.3333333333333333
0.2

```
### 样例输入 #2
```
10 10 10

```
### 样例输出 #2
```
0.5870875690480144
0.3640355515319861

```
## 提示

Time limit: 1 s, Memory limit: 128 MB. 


## 题目翻译

一个比赛有 $n$ 张比赛门票，门票用随机抽选的方式决定。有 $a$ 个人参与一类抽选，$b$ 个人参与二类抽选，其中一类抽选选中的概率是二类抽选的两倍。共进行 $n$ 次抽选，第 $i$ 次随机抽选在前 $i-1$ 次没有选出的名额中选出一个人。也就是说，这个人获得了比赛门票，接下来第 $i+1$ 到 $n$ 次的抽选集合不包括他。

Dmitry 现在如果要参加门票抽选，请你求出他分别参与一类抽选名额和二类抽选名额时，能够获得比赛门票的概率。（$a,b$ 个人不包括 Dmitry）


---

---
title: "[NEERC 2013] Kabaleo Lite"
layout: "post"
diff: 普及+/提高
pid: P7006
tag: ['2013', 'Special Judge', 'ICPC']
---
# [NEERC 2013] Kabaleo Lite
## 题目描述



Kabaleo Lite is a board game. The board consists of several stacks of conical chips of various colors. Only the color of the top chip of the stack is visible.

Each player has a unique target color and a set of colored chips. The target color is hidden from other players, while the set of chips is visible to them. On his turn, player selects one of his chips and puts it on one of the board stacks, thus recoloring it to the color of the chosen chip.

After the last turn, the number of visible board chips of each color is calculated. The winning color is the color that occurs the maximum times. The player (if any) that has this color as his target color, wins the game. If there is no such player or if there are two or more colors that occur the maximum times, the game ends in a draw.

You are playing your last chip in the Kabaleo Lite game. Other players also have one chip left. You want to determine all possible moves that lead you to winning the game. You do not know the target colors of other players and you cannot predict their moves, so your move must guarantee your victory regardless of moves of your opponents.


## 输入格式



The first line contains four integers $n , p , c$ and $h$ -- the number of stacks on the board $(1 \le n \le 10^{6}),$ the number of players $(1 \le p \le 10^{6}),$ the number of chips' colors $(p \le c \le 10^{6}),$ and your hidden color $(1 \le h \le c)$ .

The second line contains $n$ integers $b_{i}$ -- the color of the visible board chip for each stack on the board $(1 \le b_{i} \le c)$ .

The third line contains $p$ integers $l_{i}$ -- the color of the last chip for each player $(1 \le l_{i} \le c)$ . The players are numbered from one (you) to $n$ in the order of their turns.


## 输出格式



The first line must contain $w$ -- the number of winning moves.

The second line must contain $w$ distinct numbers $m_{i}$ -- the numbers of the stacks on which your chip should be put to win. Stacks are numbered starting from $1$ in the order that their visible colors are given in the input file. You can output their numbers in any order on this line.

Remember, that your move should be winning regardless of the moves of all other players.


## 样例

### 样例输入 #1
```
6 3 4 2
2 1 2 3 2 2
2 1 1

```
### 样例输出 #1
```
1
2

```
## 提示

Time limit: 1 s, Memory limit: 128 MB. 


## 题目翻译

有一种棋盘游戏：棋盘上有 $n$ 个格子，每个格子上可以堆叠若干个有颜色的筹码，只有每个格子中最上方的筹码的颜色是可见的。

参加游戏的每个玩家都有各自不同的一个目标颜色，以及一些彩色筹码。每个人只知道自己的目标颜色，但各自拥有的筹码颜色和数量都是公开的。每个回合中，所有玩家轮流在棋盘上选一个格子放置筹码，同时覆盖下方的筹码。游戏结束后，数出棋盘上可见筹码数最多的颜色，以该颜色为目标颜色的玩家即获胜。若该颜色不是任何玩家的目标颜色，或者棋盘上出现最多的颜色不唯一，则游戏平局。

现在，一局游戏进行到了最后，你和其他所有玩家都只剩最后一个筹码。现在恰好轮到你操作，在不知道其他人的目标颜色的前提下，你想知道你一共有哪些操作可以保证必胜。

### 输入格式

第一行 $4$ 个整数 $n,p,c,h$，分别表示棋盘格数、玩家数、筹码颜色总数和你的目标颜色；

第二行 $n$ 个整数 $b_i$，表示棋盘上现有的筹码颜色，棋盘格编号从 $1$ 开始；

第三行 $p$ 个整数 $l_i$，表示每个玩家的最后一枚筹码的颜色，玩家编号从你开始。

### 输出格式

第一行 $1$ 个整数 $w$，表示你有多少种必胜操作。

第二行 $w$ 个整数 $m_i$，表示你应该把筹码放在哪个格子上。顺序不限。

数据范围见原题。


---

---
title: "[CERC2013] Crane"
layout: "post"
diff: 普及+/提高
pid: P7015
tag: ['2013', 'Special Judge', 'ICPC']
---
# [CERC2013] Crane
## 题目描述



There are $n$ crates waiting to be loaded onto a ship. The crates are numbered $1 , 2 , \cdots , n$ , the numbers determining the order of loading. Unfortunately, someone messed up the transit and the crates are standing in a row in an arbitrary order. As there is only limited space in the dock area, you must sort the crates by swapping some of them.

You are given a crane that works in the following way: you select a connected interval of crates of even length. The crane then exchanges the first half of the interval with the second half. The order inside both halves remains unchanged. Determine the sequence of crane moves that reorders the crates properly.

The crane's software has a bug: the move counter is a $9-based$ (not $10-based,$ as you might think) integer with at most $6$ digits. Therefore, the crane stops working (and has to be serviced) after $9^{6} = 531441$ moves. Your solution must fit within this limit.


## 输入格式



The first line of input contains the number of test cases $T$ . The descriptions of the test cases follow:

Each test case starts with an integer $n , 1 \le n \le 10 000$ , denoting the number of crates. In the next line a permutation of numbers ${1 , 2 , \cdots $ , n} follows.


## 输出格式



For each test case print a single line containing $m -$ the number of swaps $-$ followed by $m$ lines describing the swaps in the order in which they should be performed. A single swap is described by two numbers $-$ the indices of the first and the last element in the interval to be exchanged. Do not follow the crane's strange software design $-$ use standard decimal numeral system.


## 样例

### 样例输入 #1
```
2
6
5 4 6 3 2 1
5
1 2 3 4 5

```
### 样例输出 #1
```
5
1 2
4 5
5 6
4 5
1 6
0

```
## 提示

Time limit: 4 s, Memory limit: 128 MB. 


## 题目翻译

有 $n$ 个箱子等着装上船。箱子的编号是 $a_1,a_2,\cdots,a_n$。你的工作是通过若干次交换，将它们从小到大排列。你每次可以选择一个区间，将它的前半部分与后半部分交换，两半内部的顺序保持不变。你最多可以交换 $531441$ 次。 

### 输入格式

第一行输入包含数据组数 $T$。

接下来 $2\times T$ 行，表示 $T$ 组数据。每组数据的第一行为 $n\ (1 \leq n \leq 10000)$，表示箱子的数量。第二行为 $n$ 个正整数$a_1,a_2,\cdots,a_n $ ，表示箱子的编号。

### 输出格式

对于每组数据，首先输出一个数 $m$ ，表示交换的次数。 然后输出 $m$ 行，按照顺序描述每一次交换。对于每次交换，输出要交换的区间中第一个元素和最后一个元素的下标。


---

---
title: "[CERC2013] Digraphs"
layout: "post"
diff: 普及+/提高
pid: P7017
tag: ['2013', 'Special Judge', 'ICPC']
---
# [CERC2013] Digraphs
## 题目描述

A digraph is a graph with orientation... oh, sorry, not this time. Let's stop being nerds for a minute and talk about languages (human languages, not PHP).

Digraphs are pairs of characters that represent one phoneme (sound). For example, "ch" in English (as in "church") is a single consonant sound. The languages of Central Europe are fond of digraphs: Hungarian "sz", Czech "ch" and Polish "rz" are fine examples of them.

Digraphs are very annoying for people who do not use them natively. We will make up a letter-puzzle specifically for those people. Given a list of digraphs, construct a biggest possible square of lower case English letters such that its rows and columns do not contain any of these digraphs. This means that no two consecutive letters (read from top to bottom or from left to right) can form a digraph.

## 输入格式


The first line of input contains the number of test cases $T$ . The descriptions of the test cases follow:

Each test case starts with an integer $n , 0 \le n \le 676$ , denoting the number of forbidden digraphs. The $n$ following lines contain the digraphs.

## 输出格式

For each test case print a square of the largest possible size which does not contain any of the digraphs. If it is possible to construct a square of size $20 \times 20$ or bigger, print only a $20 \times 20$ square.

Warning: Part of the example test data below was omitted for clarity. You can access full sample tests at your workstation. 
## 样例

### 样例输入 #1
```
2
628
aa
az
ba
bb
bc
bd
be
bf
bg
bh
bi
bj
bk
bl
bm
bn
bo
bp
bq
br
bs
bt
bu
bv
bw
bx
by
ca
cb
cc
cd
ce
cf
cg
ch
ci
cj
ck
cl
cm
cn
co
cp
cq
cr
cs
ct
cu
cv
cw
cx
cy
da
db
dc
dd
de
df
dg
dh
di
dj
dk
dl
dm
dn
do
dp
dq
dr
ds
dt
du
dv
dw
dx
dy
ea
eb
ec
ed
ee
ef
eg
eh
ei
ej
ek
el
em
en
eo
ep
eq
er
es
et
eu
ev
ew
ex
ey
fa
fb
fc
fd
fe
ff
fg
fh
fi
fj
fk
fl
fm
fn
fo
fp
fq
fr
fs
ft
fu
fv
fw
fx
fy
ga
gb
gc
gd
ge
gf
gg
gh
gi
gj
gk
gl
gm
gn
go
gp
gq
gr
gs
gt
gu
gv
gw
gx
gy
ha
hb
hc
hd
he
hf
hg
hh
hi
hj
hk
hl
hm
hn
ho
hp
hq
hr
hs
ht
hu
hv
hw
hx
hy
ia
ib
ic
id
ie
if
ig
ih
ii
ij
ik
il
im
in
io
ip
iq
ir
is
it
iu
iv
iw
ix
iy
ja
jb
jc
jd
je
jf
jg
jh
ji
jj
jk
jl
jm
jn
jo
jp
jq
jr
js
jt
ju
jv
jw
jx
jy
ka
kb
kc
kd
ke
kf
kg
kh
ki
kj
kk
kl
km
kn
ko
kp
kq
kr
ks
kt
ku
kv
kw
kx
ky
la
lb
lc
ld
le
lf
lg
lh
li
lj
lk
ll
lm
ln
lo
lp
lq
lr
ls
lt
lu
lv
lw
lx
ly
ma
mb
mc
md
me
mf
mg
mh
mi
mj
mk
ml
mm
mn
mo
mp
mq
mr
ms
mt
mu
mv
mw
mx
my
na
nb
nc
nd
ne
nf
ng
nh
ni
nj
nk
nl
nm
nn
no
np
nq
nr
ns
nt
nu
nv
nw
nx
ny
oa
ob
oc
od
oe
of
og
oh
oi
oj
ok
ol
om
on
oo
op
oq
or
os
ot
ou
ov
ow
ox
oy
pa
pb
pc
pd
pe
pf
pg
ph
pi
pj
pk
pl
pm
pn
po
pp
pq
pr
ps
pt
pu
pv
pw
px
py
qa
qb
qc
qd
qe
qf
qg
qh
qi
qj
qk
ql
qm
qn
qo
qp
qq
qr
qs
qt
qu
qv
qw
qx
qy
ra
rb
rc
rd
re
rf
rg
rh
ri
rj
rk
rl
rm
rn
ro
rp
rq
rr
rs
rt
ru
rv
rw
rx
ry
sa
sb
sc
sd
se
sf
sg
sh
si
sj
sk
sl
sm
sn
so
sp
sq
sr
ss
st
su
sv
sw
sx
sy
ta
tb
tc
td
te
tf
tg
th
ti
tj
tk
tl
tm
tn
to
tp
tq
tr
ts
tt
tu
tv
tw
tx
ty
ua
ub
uc
ud
ue
uf
ug
uh
ui
uj
uk
ul
um
un
uo
up
uq
ur
us
ut
uu
uv
uw
ux
uy
va
vb
vc
vd
ve
vf
vg
vh
vi
vj
vk
vl
vm
vn
vo
vp
vq
vr
vs
vt
vu
vv
vw
vx
vy
wa
wb
wc
wd
we
wf
wg
wh
wi
wj
wk
wl
wm
wn
wo
wp
wq
wr
ws
wt
wu
wv
ww
wx
wy
xa
xb
xc
xd
xe
xf
xg
xh
xi
xj
xk
xl
xm
xn
xo
xp
xq
xr
xs
xt
xu
xv
xw
xx
xy
ya
yb
yc
yd
ye
yf
yg
yh
yi
yj
yk
yl
ym
yn
yo
yp
yq
yr
ys
yt
yu
yv
yw
yx
yy
za
zb
zc
zd
ze
zf
zg
zh
zi
zj
zk
zl
zm
zn
zo
zp
zq
zr
zs
zt
zu
zv
zw
zx
zy
zz
2
aa
bb

```
### 样例输出 #1
```
aw
wz
abababababababababab
babababababababababa
abababababababababab
babababababababababa
abababababababababab
babababababababababa
abababababababababab
babababababababababa
abababababababababab
babababababababababa
abababababababababab
babababababababababa
abababababababababab
babababababababababa
abababababababababab
babababababababababa
abababababababababab
babababababababababa
abababababababababab
babababababababababa

```
## 提示

Time limit: 2 s, Memory limit: 128 MB. 


## 题目翻译

## 题目描述

有一些有向字母对，构造一个尽量大（最大$20\times20$）的方阵，使得这个方阵中任意两个相邻字母对（从左到右或从上到下）都不是这些有向字母对中的一个。

## 输入格式

第一行一个整数$T$，表示数据组数。

每组数据第一行一个整数$n$($0 \le n \le 676$)，表示有向字母对数。

接下来$n$行，每行$2$个小写字母，表示一组有向字母对。

## 输出格式

对于每组数据，输出一个尽量大的方阵，不包含任何一个有向字母对（如果可以构造比$20\times20$规模更大的方阵，只需要$20\times20$规模就够了）。

如果有多组解，输出任意一组即可。


---

---
title: "[NWRRC 2017] Consonant Fencity"
layout: "post"
diff: 普及+/提高
pid: P7021
tag: ['2017', 'Special Judge', 'ICPC']
---
# [NWRRC 2017] Consonant Fencity
## 题目描述



There are two kinds of sounds in spoken languages: vowels and consonants. Vowel is a sound, produced with an open vocal tract; and consonant is pronounced in such a way that the breath is at least partly obstructed. For example, letters a and $o$ are used to express vowel sounds, while letters $b$ and $p$ are the consonants (e.g . bad, pot).

a vowel (e.g . silly) or as a consonant (e.g . yellow). The letter $w$ , usually used as a consonant (e.g . wet) could produce a vowel after another vowel (e.g . growth) in English, and in some languages (e.g . Welsh) it could be even the only vowel in a word.

In this task, we consider $y$ and $w$ as vowels, so there are seven vowels in English alphabet: a , $e , i , o , u , w$ and $y$ , all other letters are consonants.

Let's define the consonant fencity of a string as the number of pairs of consecutive letters in the string which both are consonants and have different cases (lowercase letter followed by uppercase or vice versa). For example, the consonant fencity of a string CoNsoNaNts is $2$ , the consonant fencity of a string dEsTrUcTiOn is $3$ and the consonant fencity of string StRenGtH is $5$ .

You will be given a string consisting of lowercase English letters. Your task is to change the case of some letters in such a way that all equal letters will be of the same case (that means, no letter can occur in resulting string as both lowercase and uppercase), and the consonant fencity of resulting string is maximal.


## 输入格式



The only line of the input contains non-empty original string consisting of no more than $10^{6}$ lowercase English letters.


## 输出格式



Output the only line: the input string changed to have maximum consonant fencity.


## 样例

### 样例输入 #1
```
consonants

```
### 样例输出 #1
```
CoNsoNaNts

```
### 样例输入 #2
```
destruction

```
### 样例输出 #2
```
dEsTrUcTiOn

```
### 样例输入 #3
```
strength

```
### 样例输出 #3
```
StRenGtH

```
## 提示

Time limit: 3 s, Memory limit: 512 MB. 


## 题目翻译

定义**非**辅音字母为 ``a`` ``e`` ``i`` ``o`` ``u`` ``w`` ``y``。

定义一个字符串的价值是连续两个大小写不同的辅音的个数。

给定一个小写字符串，试图改变若干个字母的大小写使得这个字符串的价值最大。

输出更改后的字符串。多解任意输出。



---

---
title: "[NWRRC 2017] Equal Numbers"
layout: "post"
diff: 普及+/提高
pid: P7023
tag: ['2017', 'ICPC']
---
# [NWRRC 2017] Equal Numbers
## 题目描述



You are given a list of $n$ integers $a_{1},$ . . . , $a_{n}.$ You can perform the following operation: choose some $a_{i}$ and multiply it by any positive integer.

Your task is to compute the minimum number of different integers that could be on the list after $k$ operations for all $0 \le k \le n$ .


## 输入格式



The first line of the input contains single integer $n (1 \le n \le 3·10^{5}).$ The second line of the input contains $n$ integers $a_{i} (1 \le a_{i} \le 10^{6}).$


## 输出格式



Output a single line that contains $n + 1$ integers. The i-th integer should be the minimum possible number of different integers in the list after $i − 1$ operations.


## 样例

### 样例输入 #1
```
6
3 4 1 2 1 2

```
### 样例输出 #1
```
4 4 3 3 2 2 1

```
## 提示

Time limit: 3 s, Memory limit: 512 MB. 


## 题目翻译

给定一个长度为 $n$ 的数列 $a_1,a_2,a_3,...,a_n$，每次操作，你可以让某个被选定的数乘上任意一个正整数。

现在。对于所有的 $k\in[0,n]$，求出经过 $k$ 次操作后数列里面不同的数的数量能够达到的最小值。

Translated by Eason_AC  
2020.11.15


---

---
title: "[NWRRC 2016] CodeCoder vs TopForces"
layout: "post"
diff: 普及+/提高
pid: P7033
tag: ['2016', 'ICPC']
---
# [NWRRC 2016] CodeCoder vs TopForces
## 题目描述



Competitive programming is very popular in Byteland. In fact, every Bytelandian citizen is registered at two programming sites -- CodeCoder and TopForces. Each site maintains its own proprietary rating system. Each citizen has a unique integer rating at each site that approximates their skill. Greater rating corresponds to better skill.

People of Byteland are naturally optimistic. Citizen A thinks that he has a chance to beat citizen B in a programming competition if there exists a sequence of Bytelandian citizens $A = P_{0}, P_{1},...,P_{k} = B$ for some $k \ge 1$ such that for each $i (0 \le i < k) , P_{i}$ has higher rating than $P_{i+1}$ at one or both sites.

Each Bytelandian citizen wants to know how many other citizens they can possibly beat in a programming competition.


## 输入格式



The first line of the input contains an integer $n$ -- the number of citizens $(1 \le n \le 100 000)$ . $The following n$ lines contain information about ratings. The i-th of them contains two integers $CC_{i} and TF_{i}$ -- ratings of the i-th citizen at CodeCoder and TopForces $(1 \le CC_{i}, TF_{i} \le 10^{6}).$ All the ratings at each site are distinct.


## 输出格式



For each citizen $i$ output an integer $b_{i}$ -- how many other citizens they can possibly beat in a programming competition. Each $b_{i}$ should be printed in a separate line, in the order the citizens are given in the input.


## 样例

### 样例输入 #1
```
4
2 3
3 2
1 1
4 5

```
### 样例输出 #1
```
2
2
0
3

```
## 提示

Time limit: 2 s, Memory limit: 256 MB. 


## 题目翻译

- 有 $n$ 个人，每个人有两个能力值 $CC_i$ 和 $TF_i$。第 $i$ 个人能打败第 $j$ 个人当且仅当 $CC_i >CC_j$ 或 $TF_i>TF_j$。

- 强的关系具有传递性，也就是说 $i$ 比 $j$ 强，$j$ 比 $k$ 强，那么 $i$ 比 $k$ 强。 求出每个人最多可以打败的人的个数。

- $n \leq10^5$，$CC_i,TF_i \leq10^6$，数据保证 $CC_i$ 两两不同、$TT_i$ 两两不同。


---

---
title: "[NWRRC 2016] Java2016"
layout: "post"
diff: 普及+/提高
pid: P7040
tag: ['2016', 'Special Judge', 'ICPC']
---
# [NWRRC 2016] Java2016
## 题目描述



John likes to learn esoteric programming languages. Recently he discovered the probabilistic $\textit{programming language}$ Java2K. Built-in functions of Java2K have only a certain probability to do whatever you $\textit{intend them}$ to do.

The Java2K programming is very hard, so John designed a much simpler language for training: Java2016. $\textit{Built-in}$ operators of Java2016 are deterministic, while their operands are random. Each value in $\textit{Java2016 is}$ a positive integer in the range $0 \cdots 255$ , inclusive.

Java2016 supports six operators of three precedencies:

$$\begin{aligned}{\langle \mathrm{expression}\rangle}&\quad::=\quad{\langle \mathrm{expression}\rangle}\operatorname{`\texttt{min}\text'}{\langle \mathrm{sum}\rangle}\mid{\langle \mathrm{expression}\rangle}\operatorname{`\texttt{max}\text'}{\langle \mathrm{sum}\rangle}\mid {\langle \mathrm{sum}\rangle}\\{\langle \mathrm{sum}\rangle}&\quad::=\quad{\langle \mathrm{sum}\rangle}\operatorname{`\texttt{+}\text'}{\langle \mathrm{term}\rangle}\mid{\langle \mathrm{sum}\rangle}\operatorname{`\texttt{-}\text'}{\langle \mathrm{term}\rangle}\mid{\langle \mathrm{term}\rangle}\\{\langle \mathrm{term}\rangle}&\quad::=\quad{\langle \mathrm{term}\rangle}\operatorname{`\texttt{*}\text'}{\langle \mathrm{factor}\rangle}\mid {\langle \mathrm{term}\rangle}\operatorname{`\texttt{/}\text'}{\langle \mathrm{factor}\rangle}\mid {\langle \mathrm{factor}\rangle}\\{\langle \mathrm{factor}\rangle}&\quad::=\quad\operatorname{`\texttt{(}\text'}{\langle \mathrm{expression}\rangle}\operatorname{`\texttt{)}\text'}\mid `\texttt{?}\text'\mid {\langle \mathrm{macro}\rangle}\end{aligned}$$

Minimum $(\textit{`min'})$ and maximum $((\textit{`max'}))$ operators are defined as usual. Addition $(\text{`+'}),$ subtraction $(\text{`--'}) and$ multiplication $(\text{`}\times\text{'})$ are defined modulo $256$ . The result of the division $(\text{`}/\text{'})$ is rounded towards zero. $\textit{If}$ the divider is zero, the program crashes. The argument of the operator is a result of another $\textit{operator, evenly}$ distributed random value $(\text{`}?\text{'})$, or macro substitution.

For instance, the probability that $\text{`?/?/?'}$ is evaluated to zero is $98.2\%$, while the probability of $the crash$ is $0.8\%$.

The Java2016 program consists of zero or more macro definitions, followed by the resulting expression. $ Each$ macro definition has a form of

$$\begin{aligned}{\langle \mathrm{macrodef}\rangle}&\quad::=\quad{\langle \mathrm{macro}\rangle}\operatorname{`\texttt{=}\text'}{\langle \mathrm{expression}\rangle}\\{\langle \mathrm{macro}\rangle}&\quad::=\quad\operatorname{`\texttt{a}\text'}\ldots\operatorname{`\texttt{z}\text'}\end{aligned}$$


The macro should be defined before the first use. It may not be redefined. The macro is expanded to $its definitio_n$ on each use. For instance,

```plain
a = ? max ?
(a max $a) / a
```

is expanded to `((? max ?) max (? max ?)) / (? max ?)`.

John is going to add probabilistic constants to Java2016, so for each possible constant value he needs $a progra_m$ that successfully evaluates to this value with at least one-half probability. Crashes are $\textit{counted toward}$ failures.


## 输入格式



The input contains a single integer $c$ -- the target constant $(0 \le c \le 255)$ .


## 输出格式



Output a Java2016 program that successfully evaluates to constant $c$ with probability no less than $1/2$ . $ The$ total length of the program should not exceed $256$ characters (excluding spaces).


## 样例

### 样例输入 #1
```
0

```
### 样例输出 #1
```
? /?/ ?

```
### 样例输入 #2
```
1

```
### 样例输出 #2
```
a = ? max ?
(a max a) / a

```
## 提示

Time limit: 2 s, Memory limit: 512 MB. 


## 题目翻译

John 喜欢学习深奥的编程语言。最近，他发现了概率编程语言 Java2K。Java2K 的内置函数只有一定的概率去执行你想让它们做的事情。

Java2K 编程非常困难，因此 John 设计了一种简单得多的语言用于训练：Java2016。Java2016 的内置运算符是确定性的，而它们的操作数是随机的。Java2016 中的每个值都是 $0$ 到 $255$ (包含 $0$ 和 $255$) 中的整数。

Java2016 支持分为三个优先级的六种运算符：

$$\begin{aligned}{\langle \mathrm{expression}\rangle}&\quad::=\quad{\langle \mathrm{expression}\rangle}\operatorname{`\texttt{min}\text'}{\langle \mathrm{sum}\rangle}\mid{\langle \mathrm{expression}\rangle}\operatorname{`\texttt{max}\text'}{\langle \mathrm{sum}\rangle}\mid {\langle \mathrm{sum}\rangle}\\{\langle \mathrm{sum}\rangle}&\quad::=\quad{\langle \mathrm{sum}\rangle}\operatorname{`\texttt{+}\text'}{\langle \mathrm{term}\rangle}\mid{\langle \mathrm{sum}\rangle}\operatorname{`\texttt{-}\text'}{\langle \mathrm{term}\rangle}\mid{\langle \mathrm{term}\rangle}\\{\langle \mathrm{term}\rangle}&\quad::=\quad{\langle \mathrm{term}\rangle}\operatorname{`\texttt{*}\text'}{\langle \mathrm{factor}\rangle}\mid {\langle \mathrm{term}\rangle}\operatorname{`\texttt{/}\text'}{\langle \mathrm{factor}\rangle}\mid {\langle \mathrm{factor}\rangle}\\{\langle \mathrm{factor}\rangle}&\quad::=\quad\operatorname{`\texttt{(}\text'}{\langle \mathrm{expression}\rangle}\operatorname{`\texttt{)}\text'}\mid `\texttt{?}\text'\mid {\langle \mathrm{macro}\rangle}\end{aligned}$$

最小 ($\operatorname{`\texttt{min}\text'}$) 和最大 ($\operatorname{`\texttt{max}\text'}$) 运算符的定义和通常一样。加法 ($\operatorname{`\texttt{+}\text'}$)、减法 ($\operatorname{`\texttt{-}\text'}$) 和乘法 ($\operatorname{`\texttt{*}\text'}$) 是在模 $256$ 的意义下定义的。除法 ($`\operatorname{\texttt{/}\text'}$) 的结果向 $0$ 取整。如果除数是 $0$，程序就会崩溃。运算符的参数是另一个运算符的结果、均匀分布的随机数 ($\operatorname{`\texttt{?}\text'}$) 或宏代换的结果。

例如，$``\texttt{?/?/?}\text{''}$ 有 $98.2\%$ 的概率计算得到 $0$，而崩溃的概率为 $0.8\%$。

Java2016 程序由零个或多个宏定义以及随后的结果表达式组成。每条宏定义都形如

$$\begin{aligned}{\langle \mathrm{macrodef}\rangle}&\quad::=\quad{\langle \mathrm{macro}\rangle}\operatorname{`\texttt{=}\text'}{\langle \mathrm{expression}\rangle}\\{\langle \mathrm{macro}\rangle}&\quad::=\quad\operatorname{`\texttt{a}\text'}\ldots\operatorname{`\texttt{z}\text'}\end{aligned}$$

宏必须在第一次使用前被定义。宏不能被重复定义。宏在每次使用时都会被展开成它的定义。例如，

$$\texttt{a = ?  max ?}\\\texttt{(a max a) / a}$$

会被展开成 $``\texttt{((? max ?) max (? max ?)) / (? max ?)}\text{''}$。

John 将要把概率常量加入 Java2016，因此对每个可能的常量，他需要一个程序能以至少一半的概率成功计算出这个值。崩溃被算作失败。

#### 输入

输入包含一个整数 $c$ ($0\le c\le 255$)，表示目标常量。

#### 输出

输出一个 Java2016 程序，它需要能够以至少 $1/2$ 的概率成功计算出常量 $c$。程序的总长度不应超过 $256$ 个字符 (空格不计算在内)。


---

---
title: "[NWRRC 2015] Black and White"
layout: "post"
diff: 普及+/提高
pid: P7049
tag: ['2015', 'Special Judge', 'ICPC']
---
# [NWRRC 2015] Black and White
## 题目描述



The jury has a great artistic idea -- to create a rectangular panel out of a huge pile of black and white squares of the same size. The panel should have exactly $b 4-connected$ areas made of black tiles, and $w 4-connected$ areas made of white tiles.

Remember, a $4-connected$ area of some color is a maximal set of the panel tiles such that:

any two tiles of the area share the same color;

for any two tiles of the area there is a tile sequence connecting them, such that any two consecutive tiles of the sequence share a common side.

In addition to the artistic idea, the jury has already developed a program that produces design of the panel. But since this problem is about art, any new solution is extremely important for the jury.


## 输入格式



The only line of the input file contains two integers $b$ and $w$ -- number of black and white areas $(1 \le b , w \le 1000)$ .


## 输出格式



The first line of the output file should contain the picture sizes $r$ and $c$ -- the number of rows and columns $(1 \le r , c \le 100 000)$ . This line should be followed by $r$ lines of $c$ symbols each. Each symbol should be either $‘@'$ (for black tile) or $‘. '$ (for white one). There should be no more than $100 000$ tiles in the panel.


## 样例

### 样例输入 #1
```
2 3

```
### 样例输出 #1
```
6 7
@@@@@@@
@.@@@@@
@@...@@
@@@@@@@
.......
@@@@@@@

```
## 提示

Time limit: 2 s, Memory limit: 256 MB. 


## 题目翻译

给定正整数 $b,w$，请你构造出一个黑白矩阵，使得矩阵内恰有 $b$ 个黑色连通块和 $w$ 个白色连通块。

输出的第一行包含两个整数 $r,c$，表示你构造出的矩阵的行数和列数。接下来是一个 $r\times c$ 的矩阵，表示你构造出的黑白矩阵。其中 ```@``` 代表黑色，```.``` 代表白色。

数据范围：$1\le b,w\le 1000$

你的矩阵应满足：$1\le r,c\le 100000$ 且 $r\times c\le100000$


---

---
title: "[NWRRC 2015] Journey to the “The World’s Start”"
layout: "post"
diff: 普及+/提高
pid: P7057
tag: ['2015', 'ICPC']
---
# [NWRRC 2015] Journey to the “The World’s Start”
## 题目描述



Jerry Prince is the fourth grade student and he goes to New-Lodnon to visit the most popular amusement park `The World's Start`.

An airport he arrives at is next to the first stop of the metro line. This line has $n$ stops and `The World's Start` is on the last of them. The metro of New-Lodnon is pretty fast so you may assume that you can get from a stop to the next one in just one minute.

Jerry needs a travel card to use the metro. Each travel card has a range $r$ and a price $p$ . With a travel card of range $r$ Jerry may travel no more than $r$ stops at once. Therefore, if Jerry enters metro at the stop $i$ he should exit on one of the stops from $i − r$ to $i + r$ inclusive. It takes $d_{i}$ minutes to exit and reenter metro at i-th stop. There is no time required to enter the first stop or exit the last one.

Jerry is not very rich but he has some spare time, so he decided to buy the cheapest travel card that will allow him to travel from the first metro stop to the last one in no more than $t$ minutes.


## 输入格式



The first line of the input file contains two integers $n$ and $t$ -- the number of stops and the maximum possible time $(2 \le n \le 50 000$ ; $n - 1 \le t \le 10^{9}).$

The second line contains $n - 1$ integers $p_{r}$ -- the prices of travel cards with range $r = 1$ . . . $n − 1 (1 \le p_{r} \le 100 000)$

The third line contains $n - 2$ integers $d_{i}$ -- the number of minutes required to reenter metro at stop $i = 2$ . . . $n - 1 (1 \le d_{i} \le 10^{5}).$


## 输出格式



Output a single integer $p$ -- the lowest possible price of one travel card that allows Jerry to travel from the first to the last stop in no more than $t$ minutes.


## 样例

### 样例输入 #1
```
4 4
1 2 3
1 4

```
### 样例输出 #1
```
2

```
## 提示

Time limit: 2 s, Memory limit: 256 MB. 


## 题目翻译

杰瑞在一条地铁线路上，这条线有$n$个站，世界的起点在最后一个，地铁很快，你可以在一分钟内从一个站点到达下一个站点。

杰瑞需要一张旅行卡才能乘地铁。每张旅行卡都有一个范围$r$和价格$p$。使用范围为$r$的旅行卡，他一次就只能最多旅行$r$站。因此，如果他在第二站进入地铁，他应该在$i−r$到$i+r$的其中一站下车。它需要$d[i]$在第一站下车或者重新进入地铁，不需要时间进入第一站或离开最后一站。

杰瑞不是很富有，但他有一些空闲时间，所以他决定买一张最便宜的旅行卡，这样他就可以在不超过$t$分钟的时间内从地铁的第一站坐到到最后一站。


---

---
title: "[NWRRC 2014] Joy of Flight"
layout: "post"
diff: 普及+/提高
pid: P7069
tag: ['2014', 'Special Judge', 'ICPC']
---
# [NWRRC 2014] Joy of Flight
## 题目描述

Jacob likes to play with his radio-controlled aircraft. The weather today is pretty windy and Jacob has to plan flight carefully. He has a weather forecast — the speed and direction of the wind for every second of the planned flight.

The plane may have airspeed up to $v_{\max}$ units per second in any direction. The wind blows away plane in the following way: if airspeed speed of the plane is $(v_x, v_y)$ and the wind speed is $(w_x, w_y)$, the plane moves by $(v_x+w_x, v_y+w_y)$ each second.

![](https://cdn.luogu.com.cn/upload/image_hosting/2uyb1zpd.png)

Jacob has a fuel for exactly $k$ seconds, and he wants to learn, whether the plane is able to fly from start to finish in this time. If it is possible he needs to know the flight plan: the position of the plane after every second of flight.
## 输入格式

The first line of the input file contains four integers $S_x, S_y, F_x, F_y$ — coordinates of start and finish ($−10 000 ≤ S_x, S_y, F_x, F_y ≤ 10 000$).

The second line contains three integers $n, k$ and $v_{\max}$ — the number of wind condition changes, duration of Jacob’s flight in seconds and maximum aircraft speed ($1 ≤ n, k, v_{\max} ≤ 10 000$).

The following $n$ lines contain the wind conditions description. The $i$-th of these lines contains integers $t_i, w_{x_i}$ and $w_{y_i}$ — starting at time $t_i$ the wind will blow by vector $(w_{x_i}, w_{y_i})$ each second ($0 = t_1 < ··· < t_i < t_{i+1} < ··· < k; \sqrt{w_{x_i}^2 + w_{y_i}^2} ≤ v_{\max}$).
## 输出格式

The first line must contain `Yes` if Jacob’s plane is able to fly from start to finish in k seconds, and `No` otherwise.

If it can to do that, the following $k$ lines must contain the flight plan. The $i$-th of these lines must contain two floating point numbers $x$ and $y$ — the coordinates of the position ($P_i$) of the plane after $i$-th second of the flight.

The plan is correct if for every $1 ≤ i ≤ k$ it is possible to fly in one second from $P_{i−1}$ to some point $Q_i$, such that distance between $Q_i$ and $P_i$ doesn’t exceed $10^{−5}$, where $P_0 = S$. Moreover the distance between $P_k$ and $F$ should not exceed $10^{-5}$ as well.
## 样例

### 样例输入 #1
```
1 1 7 4
2 3 10
0 1 2
2 2 0
```
### 样例输出 #1
```
Yes
3 2.5
5 2.5
7 4
```
## 提示

Time limit: 2 s, Memory limit: 256 MB.
## 题目翻译

## 简述

大意就是一架飞机要从起点飞到终点，飞机有最大空速，飞行最大时间，给出风速的变化和风如何影响飞机飞行，求出飞机是否能到达终点，如果能就输出飞机的位置变化。

## 题目描述

雅各布（Jacob）喜欢玩他的无线电摇制飞机。今天的风很大，雅各布必须小心地计划飞行。他有一个天气预报——飞行计划中每秒钟的风速和风向。

飞机每秒在任何方向的空速最大都可以达到 $v_{max}$ 。风吹动飞机的方式如下：如果飞机的空速是 $(v_x,v_y)$ 并且风速是 $(w_x,w_y)$ ，那么飞机每秒将移动 $(v_x+w_x,v_y+w_y)$ 。

![P7069-1](https://cdn.luogu.com.cn/upload/image_hosting/2uyb1zpd.png)

雅各布（Jacob）有一种刚好能使用$k$秒的燃料，他想知道，飞机是否能在这段时间内从起点飞到终点。如果可能的话，他需要知道飞行计划：每飞行一秒后飞机的位置。

## 输入格式

输入文件的第一行有四个整数 $S_x,S_y,F_x,F_y$ ，代表起始位置 $(-10000 \le S_x,S_y,F_x,F_y \le 10000)$ 。

第二行有三个整数 $n,k 和 v_{max}$ ——风况变化的次数，雅各布（Jacob）飞行持续的时间（以秒为单位）和飞机最大空速。

剩下的 $n$ 行是对风向的描述，第 $i$ 行有三个整数 $t_i,w_{xi} 和 w_{yi}$ ——从时间 $t_i$ 开始，风速为每秒 $(w_{xi},w_{yi})$ （一个向量） $(0=t_1< \cdots <t_i<t_{i+1}< \cdots <k; \sqrt{{w^2_{xi}}+{w^2_{yi}}} \le v_{max})$ 。

## 输出格式

如果 $k$ 秒内雅各布（Jacob）的飞机能从起点飞到终点则应输出 `Yes` ，否则输出 `No` 。

如果它能飞到，接下来的 $k$ 行必须包括飞行计划。第 $i$ 行必须包括两个浮点数 $x$ 和 $y$ （保留几位貌似没说）——飞行了第 $i$ 秒的平面位置 $(P_i)$ 。

如果对于每个 $1 \le i \le k$ 都能在一秒内从点 $P_{i-1}$ 飞到某个点 $Q_i$ ，使得 $Q_i$ 和 $P_i$ 间距离不超过 $10^{-5}$ ，其中 $P_0=S$ ，那么这个计划就是正确的。此外 $P_k$ 和 $F$ 间的距离也应不超过 $10^{-5}$ 。

## 说明/提示

时间限制： $2s$ ；内存限制： $256MB$ 

by XYY1411

2020/12/08


---

---
title: "数上的树"
layout: "post"
diff: 普及+/提高
pid: P7091
tag: ['O2优化']
---
# 数上的树
## 题目背景

**本题自动开启 O2 优化，时间限制 2s。**
## 题目描述

您需要构造一棵二叉树，根节点权值为 $n$，每个节点都有 $2$ 个或 $0$ 个儿子，且满足如下限制：

若该点有两个儿子，该点权值需等于两个儿子的权值之积。

若该点没有儿子，则该节点权值需为质数。

同时会给出 $m$ 条限制 $a_i$，表示树上的权值不能出现 $a_i$。

您构造的二叉树需要使：令 $k$ 为节点数， $\sum\limits_{i=1}^k\sum\limits_{j=i}^kval_{lca(i,j)}$ 最小，其中 $val_i$ 表示第 $i$ 个点的权值，$lca(i,j)$ 表示 $i,j$ 的最近公共祖先。
## 输入格式

第一行两个正整数 $n,m$。

之后一行 $m$ 个数 $a_i$。
## 输出格式

一行一个数，表示最小的 $\sum\limits_{i=1}^k\sum\limits_{j=i}^kval_{lca(i,j)}$。

无解输出 `-1`。
## 样例

### 样例输入 #1
```
4 0
```
### 样例输出 #1
```
20
```
### 样例输入 #2
```
12 1
4
```
### 样例输出 #2
```
127
```
### 样例输入 #3
```
192 1
2
```
### 样例输出 #3
```
-1
```
## 提示

样例解释：

样例 $1$：最优方案如下：

![](https://cdn.luogu.com.cn/upload/image_hosting/2dcec565.png?x-oss-process=image/resize,m_lfit,h_170,w_225)

其中，黑色数字代表权值，红色数字代表标号（您不需要对树标号，这里的标号只是为了更方便解释样例）。

$ans=val_{lca(1,1)}+val_{lca(1,2)}+val_{lca(1,3)}+val_{lca(2,2)}+val_{lca(2,3)}+val_{lca(3,3)}$

$~~~~~~~~=val_1+val_1+val_1+val_2+val_1+val_3$

$~~~~~~~~=4+4+4+2+4+2=20$

Subtask 1（5 分）： $n\leq 20$。

Subtask 2（12 分）：$n\leq 10^6$。

Subtask 3（28 分）：$n\leq 10^{12}$。

Subtask 4（20 分）：$m=0$。

Subtask 5（35 分）：$n\leq 10^{15}$。

对于所有数据 $2\leq n\leq 10^{15}$，$0\leq m\leq \min(n,10^5)$，$2\leq a_i\leq n$， 且答案不超过 $4\times 10^{18}$。


---

---
title: "小 L 的零食"
layout: "post"
diff: 普及+/提高
pid: P7132
tag: ['O2优化']
---
# 小 L 的零食
## 题目背景

小 L 很喜欢吃零食。
## 题目描述

**提交时自动开启 O2 优化**。

小 L 现在想把一些零食放在一个盒子里。但是零食没放稳就会摔坏，所以小 L 希望求出**有多少种稳定的堆放零食的方法**。

零食都可以抽象成一个 $1\times1$ 的正方形，而盒子的底部可以看成长度为 $n$ 的一维线段。准确地说，零食被分为 $n$ 堆，从左到右地放在盒子里面，依次记为第 $1,2,\ldots,n$ 堆。我们认为每一堆的高度 $h_i$ 是这一堆零食的数量，且任意一堆都可以不包含任何零食。

我们定义第 $i$ 堆零食是稳定的，当且仅当：

- $h_i\le m$，即这一堆零食高度不超过 $m$。
- 在满足上一条的同时，满足以下两条之一或同时满足：
  - $i=1$ 或 $i=n$，此时有一侧是盒子内壁所以这一堆不会倒下；
  - $\color{red}\max\{h_{i-1},h_{i+1}\}\ge h_i-d_i$，此时它两侧的两堆零食有一堆足够高可以支撑这一堆不倒下。

我们定义一种稳定的堆放零食的方法，是一个长度为 $n$ 的 $h_i$ 的序列，满足按这个序列堆放出来的零食每一堆都是稳定的。

显然盒子里最多放下 $n\times m$ 个零食，我们认为小 L 的零食数量不少于 $n\times m$，并且不必将所有零食全部放进盒子。额外地，我们认为**每一个零食都是完全一样的**。
## 输入格式

总共包括 $2$ 行。

第一行包含两个正整数 $n,m$。

第二行包含 $n$ 个整数 $d_1,d_2\ldots,d_n$，意义如【题目描述】中红色部分所示。

每行的两个数字间由单个空格隔开，数据在 Windows 下生成。**行末不保证没有多余空格**。
## 输出格式

一行一个整数，表示有多少种稳定的堆放零食的方法，**结果对 $998244353$ 取模**。
## 样例

### 样例输入 #1
```
3 3
3 1 1 
```
### 样例输出 #1
```
59
```
### 样例输入 #2
```
10 13
12 13 1 4 5 9 7 0 3 8 
```
### 样例输出 #2
```
851695394
```
## 提示

本题采用如下计分策略：    
**subtask $1$**（#$1$~#$8$）：$10\%$，$n,m\le5$；  
**subtask $2$**（#$9$~#$12$）：$30\%$，$n,m\le5\times10^2$；  
**subtask $3$**（#$13$~#$16$）：$20\%$，$n,m\le3\times10^3$；  
**subtask $4$**（#$17$~#$24$）：$40\%$，$n,m\le7\times10^3$。  
对于 $100\%$ 的数据：$1\le n,m\le7\times10^3$，$0\le d_i\le m$。**你必须通过一个 subtask 内所有测试点，才被认为通过该 subtask。**

**本题开启子任务依赖。**


---

---
title: "[COCI 2020/2021 #2] Sjekira"
layout: "post"
diff: 普及+/提高
pid: P7162
tag: ['2020', 'O2优化', 'COCI（克罗地亚）']
---
# [COCI 2020/2021 #2] Sjekira
## 题目描述

有一棵 $n$ 个结点的树，每个结点有一个权值，删除一条边的费用为该边连接子树中结点权值最大值之和。问以任意顺序删除树中所有边的最小花费。
## 输入格式

第一行一个整数 $n$，表示结点数。  
第二行 $n$ 个整数 $t_1, t_2, \ldots , t_n$，其中第 $i$ 个数表示结点 $i$ 的权值。  
接下来 $n-1$ 行，每行两个整数 $x, y$，表示 $x$ 和 $y$ 之间有一条边。
## 输出格式

输出一个数，代表最小花费。
## 样例

### 样例输入 #1
```
3
1 2 3
1 2
2 3
```
### 样例输出 #1
```
8
```
### 样例输入 #2
```
4
2 2 3 2
1 3
3 2
4 3
```
### 样例输出 #2
```
15
```
### 样例输入 #3
```
5
5 2 3 1 4
2 1
3 1
2 4
2 5
```
### 样例输出 #3
```
26
```
## 提示

**【样例解释 #1】**

先删 $(2,3)$，再删 $(1,2)$，花费为 $5+3=8$。

**【数据范围】**

对于 $100\%$ 的数据，$1 \leq n \leq 100,000$，$1 \leq t_i \leq 10^9$。

Subtask #1（$10$ pts）：$n \leq 10$。  
Subtask #2（$10$ pts）：$i$ 与 $i-1$ 有边直接相连。  
Subtask #3（$30$ pts）：$n \leq 1000$。  
Subtask #4（$50$ pts）：无附加限制。

**【说明】**

译自 [Croatian Open Competition in Informatics 2020 ~ 2021 Round 2 D Sjekira](https://hsin.hr/coci/contest2_tasks.pdf)。


---

---
title: "[COCI 2020/2021 #3] Sateliti"
layout: "post"
diff: 普及+/提高
pid: P7170
tag: ['2020', 'COCI（克罗地亚）']
---
# [COCI 2020/2021 #3] Sateliti
## 题目背景

为了得到进一步的探索进展，阿雷西博望远镜将拍下土星的卫星。研究团队必须区分卫星图像并将它们按卫星分组，但由于卫星从不同角度拍摄，因此并不容易。
## 题目描述

捕捉到的图像可以以一个 $n \times m$ 的矩阵呈现，其中 `*` 表示火山，而 `.` 表示平地。我们认为两个图像属于同一颗卫星，当且它们能**环形地互相通过向上下或左右平移得到**。

科研工作者想要找到**字典序最小**的与给定图像属于同一颗卫星的图像。我们把图像的所有行依次连接组成字符串，再判断字符串的字典序即可。
## 输入格式

第一行包含两个整数 $n,m$，表示图像的规模。

接下来的 $n$ 行，每行输入 $m$ 个字符，表示图像所对应的矩阵。
## 输出格式

输出共 $n$ 行，每行有 $m$ 个字符，表示满足要求的字典序最小的图像。
## 样例

### 样例输入 #1
```
3 3
.**
*..
.*.
```
### 样例输出 #1
```
**.
..*
*..
```
### 样例输入 #2
```
3 4
....
..*.
....
```
### 样例输出 #2
```
*...
....
....
```
### 样例输入 #3
```
3 5
.**..
.***.
..**.
```
### 样例输出 #3
```
***..
.**..
**...
```
## 提示

**【样例解释 #1】**

所有可能的情况：

![](https://cdn.luogu.com.cn/upload/image_hosting/ftrlc0tx.png)

**【数据范围】**

| Subtask | 分值 | 数据范围及约定 |
| :----------: | :----------: | :----------: |
| $1$ | $10$ | $1 \le n,m \le 50$ |
| $2$ | $40$ | $1 \le n,m \le 300$ |
| $3$ | $60$ | 无 |

对于 $100\%$ 的数据，$1 \le n,m \le 1000$。

**【说明】**

**本题分值按 COCI 原题设置，满分 $110$。**

**题目译自 [COCI2020-2021](https://hsin.hr/coci/) [CONTEST #3](https://hsin.hr/coci/contest3_tasks.pdf)  _T3 Sateliti_。**


---

---
title: "[BalticOI 2004] RECTANGLES"
layout: "post"
diff: 普及+/提高
pid: P7181
tag: ['2004', 'Special Judge', 'BalticOI（波罗的海）']
---
# [BalticOI 2004] RECTANGLES
## 题目描述

平面上有 $n$ 个矩形。矩形边平行于坐标轴。这些长方形可以重叠、重合或相互分离。它们的顶点坐标 $(x,y)$ 中，$x,y$ 都是非负整数，横坐标不超过 $x_{\max}$，纵坐标不超过 $y_{\max}$。

$A$ 点位于 $(0,0)$，若 $C(x_{\max},0),D(0,y_{\max}),E(x_{\max},y_{\max})$，则 $B$ 点位于线段 $CE$ 或 $DE$ 上。

线段 $AB$ 可能与矩形相交（即使只与一个矩形**顶点**相交，也视为相交）。

你需要找到一个 $B$，使与线段 $AB$ 相交的矩形尽可能**多**。
## 输入格式

第一行三个整数 $x_{\max},y_{\max},n$。

接下来 $n$ 行，每行四个整数，分别表示第 $i$ 个矩形的左下角坐标与右上角坐标。
## 输出格式

一行三个整数，分别为：

- 最多的相交矩形数。
- 此时 $B$ 点坐标。

如果有多种方案，输出**任意一种**。
## 样例

### 样例输入 #1
```
22 14 8
1 8 7 11
18 10 20 12
17 1 19 7
12 2 16 3
16 7 19 9
8 4 12 11
7 4 9 6
10 5 11 6
```
### 样例输出 #1
```
5 22 12
```
## 提示

#### 样例 1 说明

![](https://cdn.luogu.com.cn/upload/image_hosting/n987wmyr.png)

输出也可以为 `5 22 11`。

#### 数据规模与约定

对于 $100\%$ 的数据，有 $1\le n\le 10^4$，$0\le x_{\max},y_{\max}\le 10^9$。

#### 说明

译自 [BalticOI 2004 Day2 B RECTANGLES](https://boi.cses.fi/files/boi2004_day2.pdf)

#### 特别感谢

感谢 @[tiger2005](https://www.luogu.com.cn/user/60864) 提供的 SPJ！


---

---
title: "[COCI 2007/2008 #6] GEORGE"
layout: "post"
diff: 普及+/提高
pid: P7192
tag: ['2007', 'COCI（克罗地亚）']
---
# [COCI 2007/2008 #6] GEORGE
## 题目背景

T 先生来 Luka 所在的小镇玩，因为 T 先生是一个大人物，警察会对他将走过的路实行交通管制。

Luka 在镇上是一名送货的卡车司机。但是由于一些路正在进行交通管制，他无法及时交货，还因此差点丢掉了他的工作。
## 题目描述

Luka 知道 T 先生游玩的路线，并且他想要知道最短的交货时间。

该城市由若干十字路口和连接它们的道路连接，并且 Luka 知道他需要在某条路段上开多长时间（T 先生需要同样的时间以开过该路段）。

例如，如果 T 先生在第 $10$ 分钟进入一条路，并且需要 $5$ 分钟离开这条路，那么该街道将在第 $10 \sim 14$ 分钟时被封锁。Luka可以在第 $9$ 分钟或更早的时候，也可以在第 $15$ 分钟及以后进入该道路。

编写一个程序，计算 Luka 在 T 先生到达城市后 $k$ 分钟开始开车的最短时间。
## 输入格式

第一行两个正整数 $n, m$，分别表示十字路口数和街道数。 十字路口编号为 $1$ 到 $n$。

第二行四个正整数 $a, b, k, g$，分别表示：
- $a$：Luka 起点的路口。
- $b$：Luka 必须到达的十字路口。
- $k$：T 先生和 Luka 之间的出发时间差。
- $g$：T 先生路上的十字路口数。

第三行 $g$ 个整数，表示 T 先生路上依次经过的十字路口。保证存在对应的街道，每条街道只能走一次。

接下来 $m$ 行，每行三个整数 $a, b, l$，表示在坐标 $(a, b)$ 处有一条街道，开过去的时间为 $l$。
## 输出格式

一行，输出 Luka 送货需要的最短时间（单位：分）。
## 样例

### 样例输入 #1
```
6 5
1 6 20 4
5 3 2 4
1 2 2
2 3 8
2 4 3
3 6 10
3 5 15 

```
### 样例输出 #1
```
21
```
### 样例输入 #2
```
8 9
1 5 5 5
1 2 3 4 5
1 2 8
2 7 4
2 3 10
6 7 40
3 6 5
6 8 3
4 8 4
4 5 5
3 4 23 

```
### 样例输出 #2
```
40
```
## 提示

#### 数据规模及约定

对于 $100\%$ 的数据，$2 \le n \le 10^3$，$2 \le m \le 10^4$，$1 \le a, b \le n$，$0 \le k \le 10^3$，$ 0 \le g \le 10^3$。

#### 说明
- 本题满分 $60$ 分。
- 本题默认开启 O2 优化开关。
- 题目译自 [COCI2007-2008](https://hsin.hr/coci/archive/2007_2008/) [CONTEST #6](https://hsin.hr/coci/archive/2007_2008/contest6_tasks.pdf) T4 GEORGE，译者 @[tearing](https://www.luogu.com.cn/user/219791)。


---

---
title: "[COCI 2020/2021 #3] Vlak"
layout: "post"
diff: 普及+/提高
pid: P7210
tag: ['2020', 'COCI（克罗地亚）']
---
# [COCI 2020/2021 #3] Vlak
## 题目描述

Nina 和 Emilija 在纸上做游戏。刚开始，纸是空白的。在一个回合里，一个玩家将一个字母加入到纸上一个单词的末尾。接着，二者交替顺序。规定 Nina 为先手。

玩家们选择字母时必须遵循这样的原则：每一次添加字母**后**的单词必须是该玩家最喜爱歌曲中某个单词的前缀。如果某个玩家无法继续执行它的回合，那么她就输了。

如果两位玩家选择的策略都是最佳的，请判断谁是赢家。
## 输入格式

第一行包含一个正整数 $n$，表示 Nina 最喜爱歌曲中的单词数量。

接下来的 $n$ 行，每一行输入 Nina 最喜爱歌曲中的一个单词。

接下来的一行包含一个正整数 $m$，表示 Emilija 最喜爱歌曲中的单词数量。

接下来的 $m$ 行，每一行输入 Emilija 最喜爱歌曲中的一个单词。

输入的单词都只包含小写字母，且单词长度总和不超过 $200000$。
## 输出格式

输出获胜的玩家，`Nina` 或 `Emilija`。
## 样例

### 样例输入 #1
```
2
aaa
bbb
3
aab
aba
bbb
```
### 样例输出 #1
```
Nina
```
### 样例输入 #2
```
2
acg
beh
2
adi
bfj
```
### 样例输出 #2
```
Emilija
```
### 样例输入 #3
```
3
ja
sam
vlak
5
sto
zgazit
ce
te
mali
```
### 样例输出 #3
```
Nina
```
## 提示

#### 样例 1 解释

如果 Nina 先写下字母 `b`，那么 Emilija 将必须写下 `b`，然后 Nina 将继续写下 `b`。则当前的单词为 `bbb`，而 Emilija 将无法继续执行下一步，因此 Nina 获胜。

如果 Nina 先写下字母 `a`，那么 Emilija 将写下 `b`。单词将变成 `ab`，因此 Nina 将无法继续执行下一步，因此她将输掉。

#### 数据规模与约定

对于其中 $40$ 分的数据，单词长度总和不超过 $2000$。

对于 $100\%$ 的数据，单词长度总和不超过 $200000$。

#### 说明

**本题分值按 COCI 原题设置，满分 $70$。**

**题目译自 [COCI2020-2021](https://hsin.hr/coci/) [CONTEST #3](https://hsin.hr/coci/contest3_tasks.pdf)  _T2 Vlak_。**


---

---
title: "[BalticOI 2012] 移动网络 (Day1)"
layout: "post"
diff: 普及+/提高
pid: P7249
tag: ['2012', 'Special Judge', 'BalticOI（波罗的海）']
---
# [BalticOI 2012] 移动网络 (Day1)
## 题目描述

有一条线段与若干个点，求线段上的点离最近的点最远的距离。
## 输入格式

第一行两个整数 $n$，$l$，代表总共有 $n$ 个点，线段端点为 $(0,0)$ 与 $(l,0)$。  
接下来每行两个整数 $(x,y)$，描述了点的横纵坐标，保证没有两个点坐标相同。  
给出点的坐标以横坐标为第一关键字，纵坐标为第二关键字升序排序。
## 输出格式

输出最远距离。  

本题开启 SPJ，你的答案与标准答案与标准答案误差不超过 $10^{-3}$ 即为正确。
## 样例

### 样例输入 #1
```
2 10
0 0
11 1
```
### 样例输出 #1
```
5.545455
```
## 提示

**【样例解释】** 

距离最远的点在两个点的中垂线与线段的交点处。

**【数据范围】**

- 对于 25% 的数据，满足 $n \leq 5000$
- 对于 50% 的数据，满足 $n \leq 10^5$
- 对于 100% 的数据，满足 $1\leq n \leq 10^6$，$1 \leq l \leq 10^9$，$-10^9 \leq x_i,y_i \leq 10^9$

**【说明】**

译自 [BalticOI 2012 Day1 T2. Mobile](http://www.boi2012.lv/data/day1/eng/mobile.pdf)


---

---
title: "[BalticOI 2012] 山峰 (Day1)"
layout: "post"
diff: 普及+/提高
pid: P7250
tag: ['2012', 'BalticOI（波罗的海）']
---
# [BalticOI 2012] 山峰 (Day1)
## 题目描述

有一个 $N \times M$ 大小的岛屿，每个点有不同的海拔。定义相邻为两个点横纵坐标差均不超过 $1$。定义路径为任意两个连续点都相邻的序列。定义平坦的区域是一组联通的海拔相同的点的极大集合，山峰是一个不与任何海拔更高的点相邻的平坦区域。

给出这个岛屿上每个点的海拔，你需要求出岛屿上所有的山峰与前往比其高度更高的山峰所需经过的最低点的海拔的最大值。
## 输入格式

第一行两个整数 $N,M$，代表地图的长和宽。

接下来 $N$ 行，每行 $M$ 个整数 $E_{i,j}$ ，描述了 $(i,j)$ 的海拔。
## 输出格式

第一行一个整数 $P$，代表岛上的山峰数。

接下来 $P$ 行，每行两个整数 $h_0,h_1$，代表某座山峰的海拔，以及从该山峰出发到达更高的山峰所需经过的最低点的海拔的最大值。

输出应以 $h_0$ 为第一关键字，$h_1$ 为第二关键字降序排列，特别的，对于最高峰，$h_1=0$
## 样例

### 样例输入 #1
```
6 6
21 16 9 11 6 7
21 21 10 14 15 9
18 20 8 9 13 14
11 10 9 9 8 13
8 12 12 14 13 8
7 13 12 9 5 1
```
### 样例输出 #1
```
4
21 0
15 11
14 13
13 12
```
## 提示

**【样例解释】** 

![](https://cdn.luogu.com.cn/upload/image_hosting/flr0h9rs.png)  
如上图所示，其中圆圈圈出的为山峰，从海拔为15的山峰前往其他山峰的一条路径用深色标出。

**【数据范围】**

- 对于 15% 的数据，满足 $\min (N,M)\leq 2$
- 对于 50% 的数据，满足 $P \leq 500$
- 对于 80% 的数据，满足 $P \leq 5000$
- 对于 100% 的数据，满足 $1 \leq N,M \leq 2000$，$N \times M \leq 10^5$，$1 \leq E_{i,j} \leq 10^6$

**【说明】**

译自 [BalticOI 2012 Day1 T3. Peaks](http://www.boi2012.lv/data/day1/eng/peaks.pdf)


---

---
title: "[COCI 2020/2021 #4] Vepar"
layout: "post"
diff: 普及+/提高
pid: P7281
tag: ['2020', 'COCI（克罗地亚）']
---
# [COCI 2020/2021 #4] Vepar
## 题目描述

给定两组正整数 $\{a,a+1,\cdots,b\}$ 和 $\{c,c+1,\cdots,d\}$。判断 $c \cdot (c+1)\cdots d$ 能否被 $a \cdot (a+1)\cdots b$ 整除。
## 输入格式

第一行输入一个整数 $t$，表示数据组数。

接下来的 $t$ 行，输入四个整数 $a_i,b_i,c_i,d_i$。
## 输出格式

输出共 $t$ 行。对于第 $i$ 行，如果 $c_i \cdot (c_i+1)\cdots d_i$ 能够被 $a_i \cdot (a_i+1)\cdots b_i$ 整除，就输出 `DA`，否则输出 `NE`。
## 样例

### 样例输入 #1
```
2
9 10 3 6
2 5 7 9
```
### 样例输出 #1
```
DA
NE
```
### 样例输入 #2
```
6
1 2 3 4
1 4 2 3
2 3 1 4
1 3 2 4
19 22 55 57
55 57 19 22
```
### 样例输出 #2
```
DA
NE
DA
DA
DA
DA
```
## 提示

#### 样例 1 解释

按照题意分别相乘得到 $9 \times 10=90$ 和 $3 \times 4 \times 5 \times 6=360$。由于 $90$ 能被 $360$ 整除，因此输出 `DA`。

我们得到 $2 \times 3 \times 4 \times 5=120$ 和 $7 \times 8 \times 9=504$。而 $120$ 不能被 $504$ 整除，因此输出 `NE`。

#### 数据规模与约定

本题**不采用捆绑评测**，通过对应测试点就可以拿到对应的分数，但有若干个约束。

| 约束编号 | 分值 | 数据范围及约定 |
| :----------: | :----------: | :----------: |
| $1$ | $10$ | $a_i,b_i,c_i,d_i \le 50$ |
| $2$ | $20$ | $a_i,b_i,c_i,d_i \le 1000$ |
| $3$ | $10$ | $a_i=1$ |
| $4$ | $30$ | 无 |

对于 $100\%$ 的数据，$1 \le t \le 10$，$1 \le a_i \le b_i \le 10^7$，$1 \le c_i \le d_i \le 10^7$。

#### 说明

**本题分值按 COCI 原题设置，满分 $70$。**

**题目译自 [COCI2020-2021](https://hsin.hr/coci/) [CONTEST #4](https://hsin.hr/coci/contest4_tasks.pdf)  _T2 Vepar_。**


---

---
title: "[COCI 2020/2021 #4] Hop"
layout: "post"
diff: 普及+/提高
pid: P7282
tag: ['2020', 'COCI（克罗地亚）']
---
# [COCI 2020/2021 #4] Hop
## 题目背景

> 杰瑞米是一个牛蛙，是我的一个好朋友。
## 题目描述

有 $n$ 片百合花，它们分别从 $1$ 到 $n$ 依次编号。第 $i$ 片上有一个整数 $x_i$，而序列 $(x_i)_{1 \le i \le n}$ 单调递增。

三只青蛙到来。

每对满足 $a \lt b$ 的百合 $(a,b)$ 必须属于青蛙 $1,2$ 或 $3$ 中的其中一只。

当百合 $(i,j)$ 属于一只青蛙且 $x_j$ 能被 $x_i$ 整除时（$j \gt i$），该青蛙可以从 $i$ 号百合跳动到第 $j$ 号。

请找出一种分类方案，使得任何一只青蛙都不会连续跳动 $3$ 次。
## 输入格式

第一行输入一个正整数 $n$，表示百合花的数量。

第二行输入 $n$ 个正整数 $x_i$，表示百合花上的整数。
## 输出格式

输出 $n-1$ 行。第 $i$ 行输出 $i$ 个整数，其中该行第 $j$ 个整数表示 $(j,i+1)$ 所归属的青蛙。
## 样例

### 样例输入 #1
```
8
3 4 6 9 12 18 36 72
```
### 样例输出 #1
```
1
2 3
1 2 3
1 2 3 1
2 3 1 2 3
1 2 3 1 2 3
1 2 3 1 2 3 1
```
### 样例输入 #2
```
2
10 101
```
### 样例输出 #2
```
1
```
## 提示

#### 样例 1 解释

![](https://cdn.luogu.com.cn/upload/image_hosting/d4bitfzs.png)

青蛙 $1,2,3$ 分别用蓝、绿和红色代替。

蓝蛙可以从 $x_1=3$ 跳动到 $x_4=9$，再跳动到 $x_7=36$，再到 $x_8=72$。该青蛙只能进行 $3$ 次连续的跳动。

绿蛙可以从 $x_2=4$ 跳动到 $x_5=12$，再跳动到 $x_7=36$。该青蛙只能进行 $2$ 次连续的跳动。

红蛙不能从 $x_2=4$ 跳动到 $x_3=6$，因为 $6$ 不能被 $4$ 整除。

#### 数据规模与约定

**本题采用捆绑评测。**

| Subtask | 分值 | 数据范围及约定 |
| :----------: | :----------: | :----------: |
| $1$ | $10$ | $n \le 30$ |
| $2$ | $100$ | 无 |

对于 $100\%$ 的数据，$1 \le n \le 1000$，$1 \le x_i \le 10^{18}$。

#### 评分方式

在输出方案中，如果其中一只青蛙可以连续跳动 $k$ 次，其中 $k \gt 3$，而没有青蛙可以连续跳动 $k+1$ 次，则对应测试点的分数为 $f(k)·x$ 分，其中：

$$f(k)=\dfrac{1}{10}·
\begin{cases}
11-k & (4 \le k \le 5) \cr
8-\lfloor {\dfrac{k}{2}} \rfloor & (6 \le k \le 11) \cr
1 & (12 \le k \le 19) \cr
0 & (k \ge 20) \cr
\end{cases}$$

而 $x$ 为对应子任务的总分。每个子任务的得分等于该子任务中所有测试点得分的最小值。

因本题的评分方式特殊，因而启用非官方的自行编写的 [Special Judge](https://www.luogu.com.cn/paste/mfhbmugl)，也可以在附件中下载。欢迎大家 hack（可私信或直接发帖）。

#### 说明

**本题分值按 COCI 原题设置，满分 $110$。**

**题目译自 [COCI2020-2021](https://hsin.hr/coci/) [CONTEST #4](https://hsin.hr/coci/contest4_tasks.pdf)  _T3 Hop_。**


---

---
title: "「EZEC-5」人赢 加强版"
layout: "post"
diff: 普及+/提高
pid: P7291
tag: ['O2优化']
---
# 「EZEC-5」人赢 加强版
## 题目背景

> “我们在 小 Z 面前秀个恩爱吧。”\
>“好的。”

小 Z 发现他身边都是人赢，这使他非常自闭。

小 Z 又看着身边的潇，不禁陷入了沉思……

![](https://cdn.luogu.com.cn/upload/image_hosting/b1ij58kc.png)
## 题目描述

潇有一个数组 $k$，下标为 $1$ 到 $n$ 。

潇定义 $f(x,y)=\begin{cases} \min(k_x,k_y) \times (x + y) &x \ne y \\ k_x\times x&x=y \end{cases}$ 。

潇想知道对于任意的 $1 \le x,y \le n$，$f(x,y)$ 的最大值是多少。但是她不会做，于是就问了善良的 小 Z，然而非常想在妹子面前表现的 小 Z 发现他也不会做，就只能够求助善良的你了。
## 输入格式

第一行一个整数 $n$。

第二行 $n$ 个整数 $k$，第 $i$ 个整数为 $k_i$。含义如上文。
## 输出格式

一行一个整数，表示对于任意的 $1 \le x,y \le n$，$f(x,y)$ 的最大值。
## 样例

### 样例输入 #1
```
3
3 2 1
```
### 样例输出 #1
```
6
```
### 样例输入 #2
```
5
3 4 5 4 3
```
### 样例输出 #2
```
28
```
## 提示

### 数据范围

**本题采用捆绑测试。**

- Subtask 1（10 points）：$1 \le n \le 50$。

- Subtask 2（20 points）：$1 \le n \le 5000$。

- Subtask 3（20 points）：$1 \le n \le 10^6$。

- Subtask 4（10 points）：保证所有 $k_{i}$ 都相等。

- Subtask 5（40 points）：无特殊限制。

对于 $100\%$ 的数据，$1 \le n \le 10^7$，$1 \le k_{i} \le 10^9$。

**本题建议使用较快的读入方式。**

std 使用的快读：

```cpp
#define getchar()(p1==p2&&(p2=(p1=buf)+fread(buf,1,1<<21,stdin),p1==p2)?EOF:*p1++)
char buf[1<<21],*p1=buf,*p2=buf;
inline int read()
{
    char c=getchar();int x=0;bool f=0;
    for(;!isdigit(c);c=getchar())f^=!(c^45);
    for(;isdigit(c);c=getchar())x=(x<<1)+(x<<3)+(c^48);
    if(f)x=-x;return x;
}
```


---

---
title: "[COCI 2018/2019 #2] Deblo"
layout: "post"
diff: 普及+/提高
pid: P7310
tag: ['2018', 'COCI（克罗地亚）']
---
# [COCI 2018/2019 #2] Deblo
## 题目描述

给定一个包含 $n$ 个结点的树，其中每个结点都有一个权值。一条路径的权值定义为该路径经过的所有结点的权值异或后的结果。

你的任务是求出所有路径的权值之和。
## 输入格式

第一行输入正整数 $N$，表示树的结点个数。

第二行输入 $N$ 个用空格分隔的整数 $v_i$，第 $i$ 个整数表示结点 $i$ 的权值。

接下来的 $N-1$ 行，每行输入整数 $a_j,b_j$，表示 $a_j,b_j$ 之间有一条边。
## 输出格式

输出所有路径的权值之和。
## 样例

### 样例输入 #1
```
3
1 2 3
1 2
2 3
```
### 样例输出 #1
```
10
```
### 样例输入 #2
```
5
2 3 4 2 1
1 2
1 3
3 4
3 5
```
### 样例输出 #2
```
64
```
### 样例输入 #3
```
6
5 4 1 3 3 3
3 1
3 5
4 3
4 2
2 6
```
### 样例输出 #3
```
85
```
## 提示

#### 样例 1 解释

路径 $1 \to 1$ 的权值为 $1$；

路径 $1 \to 2$ 的权值为 $1⊕2=3$；

路径 $1 \to 3$ 的权值为 $1⊕2⊕3=0$；

路径 $2 \to 2$ 的权值为 $2$；

路径 $2 \to 3$ 的权值为 $2⊕3=1$；

路径 $3 \to 3$ 的权值为 $3$。

所有路径的权值之和为 $1+3+0+2+1+3=10$。

#### 数据规模与约定

对于 $30\%$ 的数据，$N \le 200$。

对于 $50\%$ 的数据，$N \le 1000$。

对于另外 $20\%$ 的数据，$x=1,2,\cdots,N-1$ 中的每个结点都和结点 $x+1$ 之间有一条边。

对于 $100\%$ 的数据，$1 \le a_j,b_j \le N \le 10^5$，$0 \le v_i \le 3 \times 10^6$。

#### 说明

**本题分值按 COCI 原题设置，满分 $90$。**

**题目译自 [COCI2018-2019](https://hsin.hr/coci/archive/2018_2019/) [CONTEST #2](https://hsin.hr/coci/archive/2018_2019/contest2_tasks.pdf)  _T3 Deblo_。**


---

---
title: "[COCI 2018/2019 #2] Maja"
layout: "post"
diff: 普及+/提高
pid: P7311
tag: ['2018', 'COCI（克罗地亚）']
---
# [COCI 2018/2019 #2] Maja
## 题目描述

蜜蜂 Maja 在一个神奇的牧场里为花朵传粉。牧场可用一个 $N \times M$ 的矩阵表示。在第 $i$ 行第 $j$ 列有 $C_{i,j}$ 朵未传粉的花。

Maja 从位于第 $A$ 行第 $B$ 列的蜂巢出发，并前往牧场的一些区域后返回。Maja 可以在 $1$ 步内从当前区域前往相邻的区域（即位于原区域的左、右、上或下方的区域），但不会离开牧场。每当 Maja 经过一个区域，它将会将该区域所有未传粉的花全部进行传粉。但牧场是神奇的！Maja 在离开区域 $(i,j)$ 后，所有传过粉的花将全部消失，而紧接着将会有 $C_{i,j}$ 朵未传粉的花重新生长。

由于 Maja 不能一直飞下去，因此它将在 $K$ 步后感到劳累。Maja 在 $K$ 步内从蜂巢出发并返回的途中，最多能为多少朵花传粉？
## 输入格式

第一行输入正整数 $N,M,A,B,K$。

接下来的 $N$ 行，每行输入 $M$ 个整数表示区域 $(i,j)$ 的花的数量 $C_{i,j}$。

蜂巢所在区域不会有任何花朵生长。
## 输出格式

输出 Maja 在 $K$ 步内从蜂巢出发并返回的途中，被传粉的花的最大数量。
## 样例

### 样例输入 #1
```
2 2 1 1 2
0 1
2 10
```
### 样例输出 #1
```
2
```
### 样例输入 #2
```
2 2 1 1 4
0 5
5 10
```
### 样例输出 #2
```
20
```
### 样例输入 #3
```
3 3 2 2 6
5 1 0
1 0 3
1 3 3
```
### 样例输出 #3
```
15
```
## 提示

#### 样例 1 解释

Maja 从 $(1,1)$ 开始，先向下飞行，为 $2$ 朵花传粉，然后再返回。

#### 样例 2 解释

Maja 从 $(1,1)$ 开始，依次向右、下、上、左飞行。由于 Maja 经过了 $(1,2)$ 两次，因而它每经过一次，便可为 $5$ 朵花传粉。

#### 数据规模与约定

对于 $40\%$ 的数据，$K \le 10^4$。

对于 $100\%$ 的数据，$2 \le N,M \le 100$，$1 \le A \le N$，$1 \le B \le M$，$2 \le K \le 10^9$，$0 \le C_{i,j} \le 10^9$，$K \bmod 2=0$。

#### 说明

**本题分值按 COCI 原题设置，满分 $110$。**

**题目译自 [COCI2018-2019](https://hsin.hr/coci/archive/2018_2019/) [CONTEST #2](https://hsin.hr/coci/archive/2018_2019/contest2_tasks.pdf)  _T4 Maja_。**


---

---
title: "『MdOI R4』Kotori"
layout: "post"
diff: 普及+/提高
pid: P7339
tag: ['洛谷月赛']
---
# 『MdOI R4』Kotori
## 题目背景

『「因为」？所以呢？』

『因为我是你的妹妹，所以你要叫我别阻止你胡来么？』

『因为我是你的妹妹，所以你要叫我看着你赴死么？』

『因为我是你的妹妹，所以你要叫我默默看着你可能被杀死么？』

『不要开玩笑了，这算什么啊！还以为好不容易和平下来了，还以为士道终于不用再受伤了。』

『我——我不希望士道死掉，不想再看到士道受伤了，已经受不了再让士道感到痛苦了啊……』

『因为我——』

『喜欢士道呀——』

![](https://cdn.luogu.com.cn/upload/image_hosting/s0f5nxk0.png)
## 题目描述

一年一度的世界最萌大会开始了。作为曾经的「萌王」，Kotori 自然无需参赛。但她希望帮助自己的哥哥  Shido 获得「燃王」的头衔。

本届 ISML 共有 $n=2^k$ 名参赛选手，编号为 $1,2\ldots n$，其中 Shido 的编号是 $1$，赛制为淘汰赛。每一轮比赛之后剩余选手中编号最小的两人为对手，编号第 $3,4$ 小的两人为对手，依次类推。每场比赛的胜负取决于粉丝的投票数，获得票数较多的一方晋级下一轮比赛，票数较少的一方淘汰。

例如共有 $4$ 名选手，则第一轮编号为 $1,2$ 的选手进行一场比赛，编号 $3,4$ 的选手进行一场比赛，然后两场比赛的胜者进行一场比赛，争夺总冠军。获得总冠军的选手将获得「燃王」头衔。

每个角色有一个厨团，$i$ 号选手的厨团人数为 $a_i$。每轮投票时，所有厨团的成员**会且仅会**为对应的选手投票。

此外，Kotori 拥有一个人数为 $m$ 人的团队，他们会永远跟随 Kotori 投票。也就是说，每场比赛 Kotori 都可以为对战双方的任意一者增加 $m$ 张得票。注意在一轮比赛中可能有多场比赛，每场比赛一定只有两名选手。

另外，Kotori 还拥有一项特权：当某场比赛双方的票数相同时，作为萌王的她可以决定这场比赛的胜者。

现在，Kotori 希望知道，她是否有能力帮助哥哥成为冠军，获得「燃王」的头衔。
## 输入格式

**本题包含多组数据。** 第一行有一个正整数 $T$ 表示数据组数。

接下来 $T$ 组数据，每组数据两行，包括：

- 第一行两个整数，表示 $k,m$。
- 第二行 $2^k$ 个整数，第 $i$ 个表示 $a_i$。
## 输出格式

$T$ 行，每行对应一组数据。

对于每组数据，如果可以做到输出 `Kotori`，否则输出 `Yoshino`。
## 样例

### 样例输入 #1
```
3
3 6
2 0 0 5 0 9 0 9
3 6
2 0 5 0 0 5 0 9
2 6
2 0 0 5

```
### 样例输出 #1
```
Yoshino
Kotori
Kotori

```
## 提示

【样例解释 #1】

对于 $1$ 组数据，并不存在让 Shido 成为燃王的方案。

对于第 $2$ 组数据，考虑以下方案：

第 $1$ 轮：
- $1$ 号和 $2$ 号比赛，把票给 $1$ 号，$2$ 号淘汰。
- $3$ 号和 $4$ 号比赛，把票给 $3$ 号，$4$ 号淘汰。
- $5$ 号和 $6$ 号比赛，把票给 $6$ 号，$5$ 号淘汰。
- $7$ 号和 $8$ 号比赛，把票给 $7$ 号，$7$ 号淘汰。

第 $2$ 轮：
- $1$ 号和 $3$ 号比赛，把票给 $1$ 号，$3$ 号淘汰。
- $6$ 号和 $8$ 号比赛，把票给 $6$ 号，$8$ 号淘汰。

第 $3$ 轮：
- $1$ 号和 $6$ 号比赛，把票给 $1$ 号，$6$ 号淘汰。

【数据规模与约定】

**本题采用捆绑测试**

| 子任务编号 | $k\le$    |$\sum n\le$ | $m\le $    | 分值  |
| -----|------ | ---------- | ---------- | ----- |
| $1$        | $0$  |$1$      | 无特殊限制 | $1$   |
| $2$        | $1$     |$2^{11}$   | 无特殊限制 | $9$   |
| $3$        | $4$  |$2^{14} $     | 无特殊限制 | $15$  |
| $4$        | 无特殊限制 |$2^{20}$| $0$        | $10 $ |
| $5$        | $9$   |   $2^{11}$| 无特殊限制 | $20$  |
| $6$        | $15$   |$2^{17}$    | 无特殊限制 | $20$  |
| $7$        | $18$   |$2^{20} $   | 无特殊限制 | $25$  |

对于 $100\%$ 的数据，$\sum n\le 2^{20}$，$0\le k\le 18$，$0\le m,a_i\le 10^9$。

【提示与帮助】

本题读入量较大，请选手选择较快的读入方式。

本题中的“世界最萌大会”与真正的“世界最萌大会”有所不同，在本题中请以本题为准。


---

---
title: "[COCI 2018/2019 #6] Simfonija"
layout: "post"
diff: 普及+/提高
pid: P7382
tag: ['2018', 'COCI（克罗地亚）']
---
# [COCI 2018/2019 #6] Simfonija
## 题目描述

给定包含 $N$ 个元素的数组 $A,B$。将 $A$ 数组内的所有元素都加上一个**整数** $X$，并修改不超过 $K$ 个元素，使得下列代数式最小：

$$\sum_{i=1}^N |A_i-B_i|$$
## 输入格式

第一行输入整数 $N,K$。

第二行输入 $N$ 个整数 $A_i$。

第三行输入 $N$ 个整数 $B_i$。
## 输出格式

输出操作之后代数式的最小值。
## 样例

### 样例输入 #1
```
3 0
1 2 3
4 5 7
```
### 样例输出 #1
```
1
```
### 样例输入 #2
```
3 1
1 2 3
4 5 7
```
### 样例输出 #2
```
0
```
### 样例输入 #3
```
4 1
1 2 1 2
5 6 7 8
```
### 样例输出 #3
```
2
```
## 提示

#### 样例 2 解释

当选定 $X=3$，并将 $A$ 数组最后一个数改为 $7$ 后，$A,B$ 两数组完全相同，此时代数式的值为 $0$。

#### 数据规模与约定

对于 $40\%$ 的数据，$K=0$。

对于 $100\%$ 的数据，$1 \le N \le 10^5$，$0 \le K \le N$，$-10^6 \le A_i,B_i \le 10^6$。

#### 说明

**本题分值按 COCI 原题设置，满分 $110$。**

**题目译自 [COCI2018-2019](https://hsin.hr/coci/archive/2018_2019/) [CONTEST #6](https://hsin.hr/coci/archive/2018_2019/contest6_tasks.pdf)  _T4 Simfonija_。**


---

---
title: "[BalticOI 2002] Tennis Club (Day1)"
layout: "post"
diff: 普及+/提高
pid: P7403
tag: ['2002', 'Special Judge', 'BalticOI（波罗的海）']
---
# [BalticOI 2002] Tennis Club (Day1)
## 题目描述

有 $N$ 个人想互相交朋友，第 $i$ 个人想和 $G_i$ 个人交朋友。

求一种交朋友的分配方式。
## 输入格式

第一行一个整数 $N$ 代表人数。       
接下来 $N$ 行每行一个整数 $G_i$ 代表第 $i$ 个人想和 $G_i$ 个人交朋友。
## 输出格式

如果无解，一行输出 `NO SOLUTION`。     
如果有解，首先一行输出 `SOLUTION`。      
接下来 $N$ 行每行 $G_i$ 个整数代表第 $i$ 个人与哪几个人交朋友。

注意如果有方案第 $i$ 行的 $G_i$ 个整数请升序输出。      
如果有多种方案，任意输出一种即可。
## 样例

### 样例输入 #1
```
3
1
2
1 
```
### 样例输出 #1
```
SOLUTION
2
1 3
2 
```
### 样例输入 #2
```
3
2
2
1 
```
### 样例输出 #2
```
NO SOLUTION
```
## 提示

#### 数据规模与约定

对于 $100\%$ 的数据，$2 \le N \le 1000$，$1 \le G_i < N$。

**本题使用 Special
Judge。**

#### 说明

翻译自 [BalticOI 2002 Day1 B Tennis Club](https://boi.cses.fi/files/boi2002_day1.pdf)。


---

---
title: "至曾是英雄的您"
layout: "post"
diff: 普及+/提高
pid: P7479
tag: []
---
# 至曾是英雄的您
## 题目背景

YSGHYYDS
## 题目描述

YSGH 有一个 $n\times m$ 的围棋棋盘，初始时，每个位置要么是空的，要么有一个黑棋棋子。**保证黑棋是连通的。**

在围棋中，一个棋子的「气」是与它相邻的所有**空**位置构成的集合。

设棋盘上第 $i$ 行第 $j$ 个位置为 $(i,j)$。

两个分别在 $(i_1,j_1)$ 和 $(i_2,j_2)$ 的**同色**棋子如果满足 $|i_1-i_2|+|j_1-j_2|=1$，就认为是相邻的，也就是在同一个连通块里。

一个连通块的「气」是这个连通块中所有棋子的「气」的并集。

白方走一步棋是合法的，当且仅当走完这手棋之后这个棋子所在连通块的「气」大于等于 $1$ 或者黑棋连通块的「气」等于 $0$。

比如下图，绿色的位置都是黑棋连通块的「气」。

![](https://cdn.luogu.com.cn/upload/image_hosting/wzrjvpox.png)

「活棋」的定义：无论对方连续走多少手棋，在每步棋都是合法的情况下，该连通块的「气」都大于等于 $1$。

请你判断这个黑棋连通块是否是「活棋」。

如果是，输出 `YES`，否则输出 `NO`。

**本题有多测。**
## 输入格式

第一行，一个正整数 $T$，表示数据组数。

对于每组数据：

第一行，两个正整数 $n, m$，表示棋盘的大小为 $n \times m$。

接下来 $n$ 行，每行一个长度为 $m$ 的字符串。第 $i$ 行第 $j$ 个字符表示棋盘上位置为 $(i, j)$ 的地方是否有棋子。`.` 表示空格，`*` 表示黑棋子。
## 输出格式

如果黑棋是「活棋」，输出 `YES`，否则输出 `NO`。
## 样例

### 样例输入 #1
```
3
3 5
.*.*.
.***.
.....
2 5
.*.*.
.***.
6 5
.*...
.***.
**.**
*...*
**.**
*****
```
### 样例输出 #1
```
NO
YES
NO
```
### 样例输入 #2
```
1
1 3
.*.

```
### 样例输出 #2
```
YES
```
## 提示

**【样例解释 #1】**

第 1 组数据：

白棋依次走 $(1,1),(2,1),(3,2),(3,3),(3,4),(1,5),(2,5),(1,3)$ 即可使得黑棋连通块的「气」变成 $0$ 了。

不妨用 `@` 表示白棋，那么最终局面就是：

```plain
@*@*@
@***@
.@@@.
```

第 2 组数据：

比方说白棋先走 $(1,1)$ 那么白棋之后就再也走不到 $(1,3)$ 和 $(2,1)$ 了，导致黑棋的「气」永远大于等于 $1$，所以黑棋是「活棋」。

第 3 组数据：

最终使得黑棋连通块的「气」等于 $0$ 的局面：

```plain
@*@@.
@***@
**@**
*@.@*
**@**
*****
```

---

**【数据范围】**

**本题采用捆绑测试。**

对于 $100 \%$ 的数据，$1 \le n, m \le 2 \times {10}^3$，$1 \le T \le {10}^5$。输入的初始棋盘的每个位置要么是 `.`，要么是 `*`，并且至少有一个 `.`，至少有一个 `*`。**保证黑棋是连通的。** 保证每个测试点的 $n \times m$ 之和都小于等于 $4 \times {10}^6$。

- Subtask 1（9 points）：$n = 1$。
- Subtask 2（10 points）：$n = 2$，$m = 3$。
- Subtask 3（16 points）：保证 `.` 的个数不超过 $7$，$n, m \le 10$，$T \le 50$。
- Subtask 4（24 points）：保证 `.` 的个数不超过 $14$，$n, m \le 10$，$T \le 50$。
- Subtask 5（15 points）：$n, m \ge 3$，输入局面的边界上都是 `.`。即 $\forall (i, j)$，如果 $i = 1 \lor i = n \lor j = 1 \lor j = m$，则 $(i, j)$ 一定是空地。 
- Subtask 6（26 points）：无特殊限制。 

---
---
---

P.S. Froggy 和 uyom 都是（很久没下棋的）业余四段哥，欢迎找我们然后把我们虐一顿。


---

---
title: "「HMOI R1」地铁客流"
layout: "post"
diff: 普及+/提高
pid: P7500
tag: ['O2优化']
---
# 「HMOI R1」地铁客流
## 题目背景

一座城市的地铁客流量是非常重要的指标，它体现了这座城市正在不断流动着的人口数量。无论通勤还是旅游，都会给这座城市的经济带来活力。

疫情期间各地地铁客流惨淡，甚至有部分城市地铁停运。现在疫情态势好转，各地陆续复工复产，地铁客流量大小也是判断城市复工复产、经济恢复率的重要参考。
## 题目描述

天穹市的地铁系统由 $M$ 条线路组成，共有 $N$ 座车站，**每座车站都会有线路停靠**。每条线路的相邻两站之间可视为由无向边连接。其中地铁 $i$ 号线上有 $k_i$ 座车站，**这些车站互不相同**。

这些线路会在一些车站相交，也就是说，一座车站可能有很多线路停靠。

现在，有 $P$ 位乘客分别想从 $s_j$ 号车站出发，去 $t_j$ 号车站，**保证这两座车站不同**。当这两座车站不在一条线路上时，他就会进行若干次换乘。作为天穹地铁的技术工作人员，你需要计算这些乘客贡献的客流量。

-------------

请注意，在这里使用的客流量计算方法和实际应用中的有所不同。

客流量 $=$ 进站客流 $+$ 换乘客流。进站客流即为乘客数；换乘客流为乘客的换乘次数。起终点之间可能会有多条路径可以选择，此时，地铁客流量与 **乘客选择的** 路径无关；计算时，我们只考虑 **换乘次数最少** 的路径。

---------

注意：

- 设从 $s$ 到 $t$ 最少进行 $\rm trans$ 次换乘，则此时要乘坐 $\rm trans + 1$ 条线路，贡献 $\rm trans + 1$ 的客流量。  
- 当乘客不能从起点到达终点时，即 $s, t$ 之间没有通路，他就会去坐公交，此时客流量计为 $0$。
## 输入格式

第一行三个整数 $N, M, P$。

接下来 $M$ 行，每行表示一条地铁线路：  
每行第一个整数为 $k_i\ (2 \le k_i \le N)$，为这条线的车站数；  
后面 $k_i$ 个整数 $q\ (1 \le q \le N)$，为这条线路依次经过的车站编号。

接下来 $P$ 行，每行两个整数 $s_j, t_j\ (1 \le s_j, t_j \le N;\ s_j \neq t_j)$，表示一位乘客的出行起终点。
## 输出格式

仅一行一个整数，表示这些乘客贡献的客流量。
## 样例

### 样例输入 #1
```
8 4 4
4 1 2 3 5
2 3 6
2 2 4
3 7 4 8
1 6
4 3
4 8
6 7
```
### 样例输出 #1
```
9
```
### 样例输入 #2
```
8 4 4
4 1 2 3 5
3 6 3 8
2 2 4
3 7 4 8
1 6
4 3
4 8
6 7
```
### 样例输出 #2
```
7
```
### 样例输入 #3
```
8 3 4
4 1 2 3 5
2 3 6
3 7 4 8
1 6
4 3
4 8
6 7
```
### 样例输出 #3
```
3
```
## 提示

样例解释：

- 默认乘客会选择换乘次数最少的路径。
- 边上的数字表示所在地铁线路的编号。

样例 1 如图：
![](https://cdn.luogu.com.cn/upload/image_hosting/t97d5qmr.png)

乘客 $1$ 会乘坐 $1$ 号线从 $1$ 到 $3$，再乘坐 $2$ 号线从 $3$ 到 $6$；  
乘客 $2$ 会乘坐 $3$ 号线从 $4$ 到 $2$，再乘坐 $1$ 号线从 $2$ 到 $3$；  
乘客 $3$ 会乘坐 $4$ 号线从 $4$ 到 $8$；  
乘客 $4$ 会乘坐 $2$ 号线从 $6$ 到 $3$，乘坐 $1$ 号线从 $3$ 到 $2$，再乘坐 $3$ 号线从 $2$ 到 $4$，最后乘坐 $4$ 号线从 $4$ 到 $7$。

如上，四个人分别贡献了 $2, 2, 1, 4$ 的客流量，答案为 $9$。

样例 2 如图：
![](https://cdn.luogu.com.cn/upload/image_hosting/i0lm9un9.png)

相比样例 1，  
乘客 $2$ 可以选择另外一条路线，即乘坐 $4$ 号线从 $4$ 到 $8$，再乘坐 $2$ 号线从 $8$ 到 $3$，也是换乘一次的；  
乘客 $4$ 可以选择另外一条换乘次数更少的的路线：乘坐 $4$ 号线从 $7$ 到 $8$，再乘坐 $2$ 号线从 $8$ 到 $6$，只换乘了一次。

总客流量为 $2 + 2 + 1 + 2 = 7$。

样例 3 如图：
![](https://cdn.luogu.com.cn/upload/image_hosting/a2afk5k5.png)

相比样例 1，乘客 $2$ 和 $4$ 的出行路径不是通路，不会计入客流量。

总客流量为 $2 + 0 + 1 + 0 = 3$。

------------

设车站 $i$ 停靠的线路数为 $\mathrm{siz}_i$。  
对于所有数据：

- $2 \le N \le 10^5$；
- $1 \le M \le 1000$；
- $1 \le P \le 100$；
- $1 \le \mathrm{siz}_i \le 50$。

--------

**本题采用捆绑测试。**

| No.  | Constraints              | Score |
| ---- | ------------------------ | ----- |
| $1$  | $N, P \le 5;\ M \le 3$   | $10$  |
| $2$  | $k_i = 2$                | $20$  |
| $3$  | $N, M \le 50;\ P \le 10$ | $20$  |
| $4$  | $M \le 500;\ P \le 10$   | $20$  |
| $5$  | No further constraints   | $30$  |

------------

由于读入量较大，请勿不关流同步使用 `cin`。

你可以通过 `std::ios::sync_with_stdio(false)` 来关闭 `cin` 的流同步。

你也可以使用以下快速读入模板，支持读入 `int` 范围内的非负整数。

```cpp
int readInt() {
	int ret = 0; char o;
	while (!isdigit(o = getchar()));
	do ret = ret * 10 + (o ^ 48);
	while (isdigit(o = getchar()));
	return ret;
}
```
----------

- Idea: 南桥汽车站
- Solution: 南桥汽车站
- Code: 南桥汽车站
- Data: 南桥汽车站


---

---
title: "「HMOI R1」50 块好兄弟"
layout: "post"
diff: 普及+/提高
pid: P7501
tag: ['O2优化']
---
# 「HMOI R1」50 块好兄弟
## 题目背景

Polaris_Dane 非常菜，他不仅沉迷于计数，而且喜欢玩星际争霸 2。
## 题目描述

「我的好兄弟无穷无尽，而你的虫子每时每刻都在消亡」

作为新上任爱民如子的指挥官，Polaris_Dane 充分领悟了雷诺指挥官的智慧，决定将此战术贯彻到底。

有 $N$ 个兵营，依次编号为 $1,2,3\cdots N$。现在需要把它们排列在一条数轴中位于 $[1,M]$ 间的整点处。每一个兵营都有一个生产范围 $r_i$，若兵营放在点 $x\ (1 \le x \le M)$ 处，那么它会在区间 $[x - r_i + 1, x + r_i - 1]$ 生产好兄弟。

当 $\rm type = 0$ 时，生产好兄弟的范围必须被区间 $[1,M]$ 完全包含；当 $\rm type = 1$ 时，生产好兄弟的范围可以落在 $[1,M]$ 之外，但是兵营必须放在 $[1,M]$ 内。

Polaris_Dane 不能让好兄弟们太挤了，所以任何两个兵营的生产范围 **都不能相交**，他想知道有多少种方案满足该条件。

若两个方案中存在一个编号为 $i$ 的兵营，其在两个方案中的放置位置不同，则称这两个方案不同。

由于答案可能很大，所以 Polaris_Dane 想请你输出答案对 $998244353$ 取模后的结果。
## 输入格式

第一行三个整数 $N, M, \mathrm{type}$，其中 $\rm type \in \{0, 1\}$。

第二行 $N$ 个整数 $r_1, r_2, r_3, \ldots, r_n$。
## 输出格式

仅一行一个整数，为所求的答案对 $998244353$ 取模后的结果。
## 样例

### 样例输入 #1
```
4 4 0
1 1 1 1
```
### 样例输出 #1
```
24
```
### 样例输入 #2
```
4 4 1
1 1 1 1
```
### 样例输出 #2
```
24
```
### 样例输入 #3
```
3 47 1
4 8 9
```
### 样例输出 #3
```
10940
```
### 样例输入 #4
```
8 100000 1
21 37 23 13 32 22 9 39
```
### 样例输出 #4
```
405170260
```
## 提示

样例解释：

在样例 1 中，无论如何摆放兵营，生产范围都不会交叉，所以答案即为 $A_4^4 = 24$。

在样例 2 中，虽然生产范围可以出界，但是兵营的可选位置还是只有 $4$ 种，答案仍是 $A_4^4 = 24$。

--------

对于所有数据：
- $1 \le N, M \le 10^6$；
- $1 \le r_i \le 1000$。

-----------

**本题采用捆绑测试。**

| No. | Constraints                           | $\rm type$ | Score |
| ----------- | ------------------------------------- | ---------- | ----- |
| $1$         | $N = 2;\ M \le 1000;\ r_i = 1$          | $0$        | $10$  |
| $2$         | $N = 2;\ M \le 10^6;\ r_i = 1$          | $0$        | $10$  |
| $3$         | $N \le 40;\ M \le 10^6;\ r_i = 1$ | $0$        | $10$  |
| $4$         | No further constraints                | $0$        | $30$  |
| $5$         | $N, r_i \le 40$                 | $1$        | $20$  |
| $6$         | No further constraints                | $1$        | $20$  |

------

- Idea: Polaris_Dane
- Solution: Polaris_Dane
- Code: Polaris_Dane
- Data: Polaris_Dane


---

---
title: "撕裂抹消"
layout: "post"
diff: 普及+/提高
pid: P7509
tag: []
---
# 撕裂抹消
## 题目背景

何以撕裂，何以抹消？
## 题目描述

给定一个长为 $n$ 的整数序列 $a_1,a_2,\dots,a_n$，再给定一个有理数序列 $p_1,p_2,\dots,p_n$。每个位置上有一个随机系数 $c_i \in \{0,1\}$，其中 $P(c_i =  1) = p_i$，$P(c_i = 0) = 1-p_i$。

注意到随机系数写作序列后可以划分为若干个极长的连续 $0$、$1$ 段，极长指不能再向两边扩展。定义一种系数序列的权值为：当系数序列中恰有 $k$ 个极长连续 $1$ 段时为 $\sum\limits_{i=1}^n c_i a_i$，否则为 $0$。

求这个系数序列的期望权值。答案对 $998244353$ 取模。
## 输入格式

第一行，两个正整数 $n,k$。

第二行，$n$ 个非负整数 $a_1,a_2,\dots,a_n$。

第三行，$n$ 个非负整数 $p_1,p_2,\dots,p_n$，以模 $998244353$ 意义下给出。
## 输出格式

一行，一个非负整数，表示期望。
## 样例

### 样例输入 #1
```
5 1
1 2 3 4 5
1 1 1 1 1
```
### 样例输出 #1
```
15
```
### 样例输入 #2
```
3 2
1 2 3
499122177 499122177 499122177
```
### 样例输出 #2
```
499122177
```
## 提示

**样例解释**

对于第一组样例，$c_i$ 必然为 $1$，且必然恰有 $1$ 个极长连续段，故权值必然为 $1 + 2 + 3 + 4 + 5 = 15$。

对于第二组样例，仅有 $c_1 = 1,c_2 = 0,c_3 = 1$ 时权值不为 $0$，且此种情况的概率为 $\frac 12 \times \frac 12 \times \frac 12 = \frac 18$，故期望为 $\frac{1+3}8 = \frac 12 \equiv 499122177 \pmod {998244353}$。

**数据范围**

对于 $30\%$ 的数据，$n \le 20$。

对于 $60\%$ 的数据，$n \le 10^3$。

对于 $100\%$ 的数据，$1 \le n \le 10^5$，$1 \le k \le \min\left(20,\left\lfloor\frac{n+1}2\right\rfloor\right)$，$0 \le a_i,p_i < 998244353$。


---

---
title: "魔女的茶会"
layout: "post"
diff: 普及+/提高
pid: P7524
tag: ['2021', 'O2优化']
---
# 魔女的茶会
## 题目背景

“原来如此，这就是你欲望的根本吗，真有意思呢…”

声音在墓穴中传开来，昴猛然回头，眼前的景象却骤然大变：他的四周由昏黑的墙壁变为了一望无际的草坪，起伏着大大小小的山丘；而原本应该是墓穴入口的地方，却有着一张茶桌和两张座椅，与之一齐处在遮阳伞的荫庇下的，还有一位端坐着的黑衣女子。

![初见](https://cdn.luogu.com.cn/upload/image_hosting/umx8vsni.png)

“我好久没有跟人类对话了，就兴奋了点… 我叫艾姬多娜。「强欲魔女」，这样说比较好懂吧？” 女子浅笑着说道。

“… 这是哪里！？我应该在一个黑暗的遗迹中，你是什么时候把我转移过来的？” 昴咬紧了牙，问道。

“很遗憾，你搞错了。你并不是肉体经历了转移，只是被邀请参加我的茶会而已。”

“茶会…？”

“是魔女的茶会哦。”

**[管理员 Mivik 更改了时间线]**
## 题目描述

“那么… 你还准备在那里站多久？趁着茶还没凉赶紧入座吧。”

“可恶… 知道啦知道啦！” 昴走上前去，坐在了魔女对面。桌上除了两杯茶外，还有一副黑白交错的棋盘。

“这是…？” 昴指着棋盘，问道。

“这是魔女棋哦。我请你过来是为了解答我沉思多年都无法解决的一个问题。如果你解决了它，我就会给你和爱蜜莉雅参加试炼的权利… 否则…”令人不安的笑容浮现在魔女脸上，“你可能就会在圣域里无穷地轮回哦…？”

昴出了一身冷汗，战战兢兢地问道：“那么问题是？”

魔女拾起了身边的一个棋子，缓缓说道：“如你所见，这是一张 $n\times n$ 的棋盘，由 $n^2$ 个方格组成，每个方格上最多只能存在一个棋子。**不同于普通的棋盘，这个棋盘是循环的，也就是说，第 $i$ 行 $n$ 列的格子右边是第 $i$ 行 $1$ 列的格子，第 $n$ 行 $i$ 列的格子下面是第 $1$ 行 $i$ 列的格子，以此类推。** 我手中的棋子名叫「大罪司教」，它一步可以向任意斜线方向移动任意多格。一个棋子能一步走到的格子称为其掌控的格子。如果一个棋子掌控了另一个棋子所在的方格，则这种棋盘布局是不稳定的，反之称其为稳定的。现在，请问你能否向棋盘中放入恰好 $m$ 个「大罪司教」，使得整个棋盘布局是稳定的呢？”

![示例](https://cdn.luogu.com.cn/upload/image_hosting/8d8481wr.png)

[上图高清版](https://cdn.luogu.com.cn/upload/image_hosting/np9zk0t4.png)

昴沉思了一会儿，随后在棋盘上操作，很快就完成了魔女的任务，说道：“那么快给我参加试炼的权利吧！”

魔女说：“不行啦… 我还有一个问题没有解决呢…”

昴：“靠北，你耍赖啊！”

魔女没有理会昴，继续说道：“现在问题是，一共有多少种本质不同的稳定的布局方案，使得布局中恰好有 $m$ 个「大罪司教」呢？两种方案本质不同，当且仅当存在任意一格在一种方案中有棋子而在另一种方案中没有哦。”

昴更加生气，因为他不会做了，他转而求助于你。你只需要告诉他答案对 $998244353$ 取模的结果即可。

## 输入格式

一行两个正整数 $n,m$，代表棋盘的大小和你需要放置的棋子数目。
## 输出格式

一行一个正整数，代表答案对 $998244353$ 取模的结果。
## 样例

### 样例输入 #1
```
1 1
```
### 样例输出 #1
```
1
```
### 样例输入 #2
```
2 2
```
### 样例输出 #2
```
4
```
### 样例输入 #3
```
3 2
```
### 样例输出 #3
```
18
```
### 样例输入 #4
```
10 5
```
### 样例输出 #4
```
8647680
```
## 提示

样例一：将一个棋子放入 $1\times1$ 的棋盘中显然只有一种方案。

样例二：一共有以下四种稳定的布局（用 `.` 代表空位，`o` 代表「大罪司教」）：

```plain
oo .o .. o.
.. .o oo o.
```

样例三：所有 $18$ 种稳定的布局可以在 [这里](https://www.luogu.com.cn/paste/obkotkqb) 查看。

### 数据范围

对于全部数据，有 $1\le n<998244353$，$0\le m\le\min\{n,10^7\}$。

Subtask 1 (5 pts)：保证 $m=0$。

Subtask 2 (10 pts)：保证 $m=1$。

Subtask 3 (10 pts)：保证 $1\le n\le 4$。

Subtask 4 (20 pts)：保证 $n$ 是奇数。

Subtask 5 (25 pts)：保证 $n\le 10^7$。

Subtask 6 (30 pts)：无特殊限制。


---

---
title: "[COCI 2020/2021 #6] Anagramistica"
layout: "post"
diff: 普及+/提高
pid: P7552
tag: ['2020', 'COCI（克罗地亚）']
---
# [COCI 2020/2021 #6] Anagramistica
## 题目描述

Biljana 喜欢出字谜游戏。

如果一个单词可以由另一个单词交换字母顺序得到，则称它们是「相似」的。

现在，她有 $n$ 个单词。她希望选出一些单词，使得其中恰好有 $k$ 对单词是「相似」的。请你帮她计算可行的方案数，对 $10^9 + 7$ 取模。
## 输入格式

第一行两个整数 $n$，$k$。

接下来 $n$ 行，每行一个字符串，表示一个单词。
## 输出格式

一行一个整数，表示可行的方案数，对 $10^9 + 7$ 取模。
## 样例

### 样例输入 #1
```
3 1
ovo
ono
voo
```
### 样例输出 #1
```
2
```
### 样例输入 #2
```
5 2
trava
vatra
vrata
leo
ole
```
### 样例输出 #2
```
3
```
### 样例输入 #3
```
6 3
mali
lima
imal
je
sve
ej
```
### 样例输出 #3
```
6
```
## 提示

#### 样例 1 解释

恰含有一对「相似」的单词的方案为 `ovo, ono, voo` 和 `ovo, voo`。

------------

#### 数据规模与约定

**本题采用捆绑测试**。

| Subtask | 分值 | 数据规模与约定 |
| :----------: | :----------: | :----------: |
| $1$ | $10$ | $1 \le n \le 15$ |
| $2$ | $30$ | $0 \le k \le 3$ |
| $3$ | $70$ | 无附加约定 |

对于 $100\%$ 的数据，$1 \le n \le 2 \times 10^3$，$0 \le k \le 2 \times 10^3$，单词的长度不超过 $10$ 且仅含小写字母。

------------

#### 说明

**本题分值按 COCI 原题设置，满分 $110$**。

**题目译自 [COCI2020-2021](https://hsin.hr/coci/archive/2020_2021/) [CONTEST #6](https://hsin.hr/coci/archive/2020_2021/contest6_tasks.pdf) _T3 Anagramistica_**。


---

---
title: "[COCI 2010/2011 #5] DVONIZ"
layout: "post"
diff: 普及+/提高
pid: P7635
tag: ['2010', 'COCI（克罗地亚）']
---
# [COCI 2010/2011 #5] DVONIZ
## 题目描述

当前 $K$ 个元素的和与最后 $K$ 个元素的和都不大于 $S$ 时，我们说这个 $2\times K$ 个元素的序列是有趣的。

给出一个长度为 $N$ 的序列 $A$。对于每个元素，输出从该元素开始的最长的有趣的子段。
## 输入格式

第一行包含整数 $N$ 和 $S$。

下面的 $N$ 行，每行包含序列 $A$ 中的一个整数 $A_i$。这些整数都是正的且它们的和不超过 $2\times 10^9$。
## 输出格式

输出共 $N$ 行。第 $i$ 行包含一个整数，从第 $i$ 元素开始的最长的有趣的子段的长度。

如果当前位置上没有有趣的子段，输出 `0`。
## 样例

### 样例输入 #1
```
5 10000
1
1
1
1
1 
```
### 样例输出 #1
```
4
4
2
2
0 

```
### 样例输入 #2
```
5 9
1
1
10
1
9 
```
### 样例输出 #2
```
2
0
0
2
0 
```
### 样例输入 #3
```
8 3
1
1
1
1
1
1
1
1 
```
### 样例输出 #3
```
6
6
6
4
4
2
2
0 
```
## 提示

**【数据范围】**

对于 $100\%$ 的数据，$2\le N\le 10^5$，$1\le S\le 2\times 10^9$。

**【说明】**

本题分值按 COCI 原题设置，满分 $120$。

题目译自 [COCI2010-2011](https://hsin.hr/coci/archive/2010_2011/) [CONTEST #5](https://hsin.hr/coci/archive/2010_2011/contest5_tasks.pdf)  _**T5 DVONIZ**_。


---

---
title: "[COCI 2012/2013 #5] HIPERCIJEVI"
layout: "post"
diff: 普及+/提高
pid: P7646
tag: ['2012', 'COCI（克罗地亚）']
---
# [COCI 2012/2013 #5] HIPERCIJEVI
## 题目描述

在遥远的星系中，最快的运输方式是超级管道，它们将 $K$ 个站台连接在一起。从站台 $1$ 到达站台 $N$ 最少需要经过多少个站台?
## 输入格式

第一行，三个整数 $N,K,M$，分别表示站台数，每根超级管道连接的站台数和超级管道数。

接下来 $M$ 行，每行 $K$ 个正整数，表示这跟超级管道连接的站台编号。
## 输出格式

一行，一个正整数，表示最少需要经过的站台数，如果到达不了站台 $N$ ，则输出 `-1`。
## 样例

### 样例输入 #1
```
9 3 5
1 2 3
1 4 5
3 6 7
5 6 7
6 8 9
```
### 样例输出 #1
```
4
```
### 样例输入 #2
```
15 8 4
11 12 8 14 13 6 10 7
1 5 8 12 13 6 2 4
10 15 4 5 9 8 14 12
11 12 14 3 5 6 1 13
```
### 样例输出 #2
```
3
```
## 提示

**【样例解释#1】**

有两种方法从站台 $1$ 走到站台 $9$：

$1\Rightarrow 3\Rightarrow 6\Rightarrow 9$ 或 $1\Rightarrow 5\Rightarrow 6\Rightarrow 9$

共经过了 $4$ 个站台，可以证明这是经过站台最少的情况。


------------

**【数据范围】**

对于 $100\%$ 的数据，$1\le N\le 10^5$，$1\le K,M\le 1000$。


------------

**【说明】**

本题分值按 COCI 原题设置，满分 $120$。

题目译自 [COCI2012~2013](https://hsin.hr/coci/archive/2012_2013/) [CONTEST#5](https://hsin.hr/coci/archive/2012_2013/contest5_tasks.pdf) _**T4 HIPERCIJEVI**_。


---

---
title: "[BalticOI 1996] LOGICAL EXPRESSIONS (Day 1)"
layout: "post"
diff: 普及+/提高
pid: P7653
tag: ['BalticOI（波罗的海）', '1996']
---
# [BalticOI 1996] LOGICAL EXPRESSIONS (Day 1)
## 题目描述

有五个逻辑表达式，称为 R1、R2、R3、R4、R5。只有逻辑变量 $a、b、c、d、e、f、g、h$，逻辑运算  
`#（not）`  
`&（and）`  
`+（or）`  
和圆括号可以在表达式中使用。操作的优先级如上所述。可以使用圆括号定义执行操作的不同顺序。  
操作由这样的表定义  
![Biao](https://cdn.luogu.com.cn/upload/image_hosting/ilfi8gbz.png)  
假设有一些表达式可以通过带有一个或两个参数的单个逻辑运算来表达：  
- $R_i = R_j$（$R_i$ 等价于 $R_j$，即对于每组变量值，$R_i$ 给出与 $R_j$ 相同的值）；  
- $R_i =$ # $R_j$（$R_i$ 等价于 $R_j$ 的否定）；  
- $R_i = R_j $ &  $R_k  $（结合）;  
- $R_i = R_j + R_k$（分离）；其中（$i≠k，i≠j$）。  

一组基本的表达式是通过它可以表示（表达）未包含在该组中的任何其他表达式，如上定义。  
编写一个程序来查找：   
1. 任何最不基本的表达式集；   
1. 每个表达式的任何表示（表达）（不属于表达式的基本集合）。应该使用带有一个或两个参数的任何单个逻辑运算来获得表示，即来自基本集合的表达式。
## 输入格式

一行一个表达式，R1 在第一行,以此类推。表达式中没有空格。假设输入数据是正确的。每行的长度小于 $256$。
## 输出格式

应包含 $5$ 行，每个表达式一行。将基本表达式的名称写入输出的第一行。其余行应包含所有其他表达式（即不属于基本表达式集的表达式）的等式（等价）形式的表示（表达式），如下面的示例所示。
## 样例

### 样例输入 #1
```
a&(b&b) 
c+c
a&b+c
#a
a&b 
```
### 样例输出 #1
```
R1
R2
R4
R3=R1+R2
R5=R1 
```
## 提示

#### 分值说明  
本题分值按 BOI 原题设置，**满分** $30$ 。
#### 题目说明  
来源于 Baltic Olympiad in Informatics 1996 的 [Day 1:LOGICAL EXPRESSIONS](https://boi.cses.fi/files/boi1996_day1.pdf) 。  
由 @[求学的企鹅](/user/271784) 翻译整理。


---

---
title: "[COCI 2014/2015 #5] ZGODAN"
layout: "post"
diff: 普及+/提高
pid: P7662
tag: ['2014', 'COCI（克罗地亚）']
---
# [COCI 2014/2015 #5] ZGODAN
## 题目描述

定义 Handsome 数：这个正整数中任意两个相邻的数位的奇偶性不同。

给你一个正整数 $n$，求与 $n$ 最近的 Handsome 数。如果有多个按从小到大的顺序输出。
## 输入格式

一个正整数 $n$。
## 输出格式

与 $n$ 最近的 Handsome 数。
## 样例

### 样例输入 #1
```
13
```
### 样例输出 #1
```
12 14
```
### 样例输入 #2
```
5801001
```
### 样例输出 #2
```
5810101
```
## 提示

对于 $100\%$ 的数据，$1 \leq n \leq 10^{1000}$。

译自 [COCI 2014/2015 CONTEST #5](https://hsin.hr/coci/archive/2014_2015/contest5_tasks.pdf)。


---

---
title: "[COCI 2014/2015 #5] JABUKE"
layout: "post"
diff: 普及+/提高
pid: P7663
tag: ['2014', 'COCI（克罗地亚）']
---
# [COCI 2014/2015 #5] JABUKE
## 题目描述

给你一个 $n \times m$ 的矩阵，其中苹果树用 `x` 表示，空地用 `.` 表示。

有 $g$ 年，每年都会从天而降一个苹果，落在坐标 $(x_i,y_i)$ 上，要求出**这个苹果离最近一棵苹果树的距离的平方**。当然，一年后这个苹果会长成新的一颗苹果树，并参与一年后落下的那个苹果的计算。
## 输入格式

第一行两个正整数 $n,m$，表示矩阵的长，宽。

接下来 $n$ 行，每行 $m$ 个字符，字符仅含 `x` 和 `.`，表示该矩阵。

接下来一个正整数 $g$，表示年份。

接下来 $g$ 行每行两个正整数 $x_i,y_i$，表示每年苹果下落的位置。
## 输出格式

一共 $g$ 行，每行一个整数，表示每个苹果下落时离最近一棵苹果树的距离的平方。
## 样例

### 样例输入 #1
```
3 3
x..
...
...
3
1 3
1 1
3 2
```
### 样例输出 #1
```
4
0
5
```
### 样例输入 #2
```
5 5
..x..
....x
.....
.....
.....
4
3 1
5 3
4 5
3 5
```
### 样例输出 #2
```
8
8
4
1
```
## 提示

对于 $30\%$ 的数据，$1 \leq g \leq 500$。

对于 $100\%$ 的数据，$1\leq n,m \leq 500,1 \leq g \leq 10^5$，保证初始矩阵至少包含一棵苹果树。

距离计算公式：$d((x_1,y_1),(x_2,y_2))=\sqrt{(x_1-x_2)^2+(y_1-y_2)^2}$。

译自 [COCI 2014/2015 CONTEST #5](https://hsin.hr/coci/archive/2014_2015/contest5_tasks.pdf)。


---

---
title: "[COCI 2013/2014 #5] DOMINE"
layout: "post"
diff: 普及+/提高
pid: P7675
tag: ['2013', 'COCI（克罗地亚）']
---
# [COCI 2013/2014 #5] DOMINE
## 题目描述

给出一个 $N\times 3$ 的棋盘，上面写有数字。给你 $K$ 块 $1\times 2$ 的多米诺骨牌，请你求出用这 $K$ 块骨牌能覆盖的棋盘上的数字之和的最大值。
## 输入格式

第一行，两个整数 $N$ 和 $K$，分别表示棋盘的行数和骨牌块数；

接下来 $N$ 行，每行 $3$ 个整数，表示棋盘上的数字。
## 输出格式

输出一个整数，表示这 $K$ 块骨牌能覆盖的棋盘上的数字之和的最大值。
## 样例

### 样例输入 #1
```
5 3
2 1 -1
1 3 2
0 2 3
2 1 1
3 3 0 
```
### 样例输出 #1
```
16 
```
### 样例输入 #2
```
2 2
0 4 1
3 5 1 
```
### 样例输出 #2
```
13
```
## 提示

**【样例解释 #1】**

![](https://cdn.luogu.com.cn/upload/image_hosting/r38fixsz.png)

如图，总和为 $3+2+2+3+3+3=16$，可以证明这是最大的。

**【数据范围】**

对于 $100\%$ 的数据，$1\le N,K\le 1000$。

**【说明】**

本题分值按 COCI 原题设置，满分 $120$。

题目译自[COCI2013_2014](https://hsin.hr/coci/archive/2013_2014/) [CONTEST #5](https://hsin.hr/coci/archive/2013_2014/contest5_tasks.pdf) _**T4  DOMINE**_


---

---
title: "[COCI 2013/2014 #5] TROKUTI"
layout: "post"
diff: 普及+/提高
pid: P7676
tag: ['2013', 'COCI（克罗地亚）']
---
# [COCI 2013/2014 #5] TROKUTI
## 题目描述

给定 $N$ 条在平面直角坐标系内的直线，这些直线上的点满足 $A_ix+B_iy+C_i=0$。

请你求出这些直线围出的三角形个数，答案对 $10^9+7$ 取模。

保证没有三线共点。
## 输入格式

第一行，一个整数 $N$，表示直线条数；

接下来 $N$ 行，每行 $3$ 个 $A_i,B_i,C_i$，表示直线 $i$ 满足的条件。
## 输出格式

一个整数，表示这些直线围出的三角形对 $10^9+7$ 取模后的个数。
## 样例

### 样例输入 #1
```
6
0 1 0
-5 3 0
-5 -2 25
0 1 -3
0 1 -2
-4 -5 29 
```
### 样例输出 #1
```
10
```
### 样例输入 #2
```
5
-5 3 0
-5 -3 -30
0 1 0
3 7 35
1 -2 -1 
```
### 样例输出 #2
```
10
```
## 提示

**【样例解释 #1】**

![](https://cdn.luogu.com.cn/upload/image_hosting/rrp71ksq.png)

上图即为所有直线在平面直角坐标系上的位置，共围出了 $10$ 个三角形。

**【数据范围】**

对于 $100\%$ 的数据，$1\le N\le 3\times 10^5$，$|A_i|,|B_i|,|C_i|\le 10^9$。

**【说明】**

本题分值按 COCI 原题设置，满分 $140$。

题目译自[COCI2013_2014](https://hsin.hr/coci/archive/2013_2014/) [CONTEST #5](https://hsin.hr/coci/archive/2013_2014/contest5_tasks.pdf) _**T5 TROKUTI*_


---

---
title: "[COCI 2013/2014 #5] LADICE"
layout: "post"
diff: 普及+/提高
pid: P7677
tag: ['2013', 'COCI（克罗地亚）']
---
# [COCI 2013/2014 #5] LADICE
## 题目描述

有 $N$ 个物品，$L$ 个抽屉，没个抽屉只能放 $1$ 个物品，每个物品都能被放进抽屉 $A_i$ 或 $B_i$ 中。

放物品的规则如下（按照顺序执行，即满足条件 $1$ 时就立刻执行，不会执行条件 $2$；不满足条件 $1$ 时就判断条件 $2$）：

- $1.$ 如果抽屉 $A_i$ 是空的，就把这个物品放进抽屉 $A_i$ 中；

- $2$ 如果抽屉 $B_i$ 是空的，就把这个物品放进抽屉 $B_i$ 中；

- $3.$ 把抽屉 $A_i$ 中的物品移到它的另一个抽屉里；如果这个抽屉也满了，就把这个抽屉里的物品放到它的另一个抽屉里，知道你成功或回到之前遇到过的抽屉为止。如果成功了，就把这个物品放进这个抽屉中；

- $4.$ 把抽屉 $B_i$ 中的物品移到它的另一个抽屉里；如果这个抽屉也满了，就把这个抽屉里的物品放到它的另一个抽屉里，知道你成功或回到之前遇到过的抽屉为止。如果成功了，就把这个物品放进这个抽屉中；

- $5.$ 扔掉此物品。

对于给定的每件物品，请你求出哪些物品将被保存，哪些将被扔掉。
## 输入格式

第一行，两个整数 $N$ 和 $L$，分别表示物品个数和抽屉个数；

接下来的 $N$ 行，每行两个整数 $A_i$ 和 $B_i$，表示物品 $i$ 能被储存的两个抽屉。
## 输出格式

输出共 $N$ 行，每行一个字符串：

如果该物品成功被保存，输出 `LADICA`；

如果该物品被扔掉，输出 `SMECE`。
## 样例

### 样例输入 #1
```
5 3
1 2
1 3
1 2
1 3
1 2 
```
### 样例输出 #1
```
LADICA
LADICA
LADICA
SMECE
SMECE 
```
### 样例输入 #2
```
9 10
1 2
3 4
5 6
7 8
9 10
2 3
1 5
8 2
7 9 
```
### 样例输出 #2
```
LADICA
LADICA
LADICA
LADICA
LADICA
LADICA
LADICA
LADICA
LADICA
```
## 提示

**【样例解释 #1】**

物品 $1$ 放入抽屉 $1$，物品 $2$ 放入抽屉 $3$，物品 $3$ 放入抽屉 $3$，物品 $1$ 和物品 $1$ 没有地方放。

**【样例解释 #2】**

物品 $1$ 放入抽屉 $1$，物品 $2$ 放入抽屉 $3$，物品 $3$ 放入抽屉 $5$，物品 $4$ 放入抽屉 $7$，物品 $5$ 放入抽屉 $9$，物品 $6$ 放入抽屉 $2$，物品 $8$ 放入抽屉 $8$。

物品 $7$ 的两个抽屉都满了，将抽屉 $1$ 里的物品 $1$ 移到抽屉 $2$ 里，将抽屉 $2$ 里的物品 $6$ 移到抽屉 $3$ 里，将抽屉 $3$ 里的物品 $2$ 移到抽屉 $4$ 里，抽屉 $4$ 是空的，成功放入。

物品 $9$ 的两个抽屉都满了，将抽屉 $7$ 里的物品 $4$ 移到抽屉 $8$ 里，将抽屉 $8$ 里的物品 $8$ 移到抽屉 $2$ 里，将抽屉 $2$ 里的物品 $1$ 移到抽屉 $1$ 里，将抽屉 $1$ 里的物品 $7$ 移到抽屉 $5$ 里，将抽屉 $5$ 里的物品 $3$ 移到抽屉 $6$ 里，抽屉 $6$ 是空的，成功放入。

**【数据范围】**

对于 $50\%$ 的数据，$1\le N,L\le 2000$；

对于 $100\%$ 的数据，$1\le N,L\le 3\times 10^5$，$1\le A_i,B_i\le L$。

**【说明】**

本题分值按 COCI 原题设置，满分 $160$。

题目译自[COCI2013_2014](https://hsin.hr/coci/archive/2013_2014/) [CONTEST #5](https://hsin.hr/coci/archive/2013_2014/contest5_tasks.pdf) _**T6  LADICE**_


---

---
title: "[COCI 2008/2009 #5] TRESNJA"
layout: "post"
diff: 普及+/提高
pid: P7682
tag: ['2008', 'COCI（克罗地亚）']
---
# [COCI 2008/2009 #5] TRESNJA
## 题目描述

Lana 住在一个快乐的小村庄里。主街旁边有一排樱桃树。Lana 注意到每棵树用从 $1$ 开始的连续整数编号。经过大量研究，Lana 注意到树的编号唯一地决定了树的樱桃数量。对于一棵树，考虑将树编号中的连续数字组拆分出来。对于每组数字，将这一组中唯一的数字乘以该组数字长度的平方。把这些数字加在一起就得到了树上的樱桃总数。例如，在编号为 $77744007$ 的树中，我们将编号中的连续数字组拆分出来，得到 $4$ 组数：$777$、$44$、$00$ 和 $7$。所以编号为 $77744007$ 的树中樱桃的数量为 $7\times 3^2+4\times 2^2+0\times2^2+7\times1^2=86$ 个。

到了摘樱桃的时候了，村民们同意把编号在区间 $[a,b]$ 中的树上的樱桃都摘下来。现在请你编写一个程序来计算采摘樱桃的总量。
## 输入格式

输入仅一行，两个整数 $a,b$，代表能够采摘樱桃的树的起始点和终止点。
## 输出格式

输出仅一行，一个整数，代表能够采摘的樱桃总量。
## 样例

### 样例输入 #1
```
1 9
```
### 样例输出 #1
```
45
```
### 样例输入 #2
```
100 111
```
### 样例输出 #2
```
68
```
### 样例输入 #3
```
7774407 7774407
```
### 样例输出 #3
```
86
```
## 提示

**【数据范围】**

对于所有数据，$1\leqslant a\leqslant b\leqslant 10^{15}$。

**【题目来源】**

本题来源自 **_[COCI 2008-2009](https://hsin.hr/coci/archive/2008_2009/) [CONTEST 5](https://hsin.hr/coci/archive/2008_2009/contest5_tasks.pdf) T5 TRESNJA_**，按照原题数据配置，满分 $120$ 分。

由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。


---

---
title: "[COCI 2008/2009 #5] KRUSKA"
layout: "post"
diff: 普及+/提高
pid: P7683
tag: ['2008', 'COCI（克罗地亚）']
---
# [COCI 2008/2009 #5] KRUSKA
## 题目背景

Aladdin 已经厌倦了宫殿里的生活。他有一份稳定的工作，他的妻子 Jasmine 和孩子们都在路上，生活变得单调。在这一切的驱使下，他决定在安顿下来之前再进行一次冒险。他决定找到 Golden Pear，这是一件极为珍贵的传奇文物，至今无人能找到。
## 题目描述

Aladdin 正在寻找的沙漠可以被看作是一个 $n×n$ 的网格。行和列从上到下、从左到右编号为 $1$ 到 $n$。沙漠中的网格里一共有 $m$ 个巫师，他们以一种不同寻常的方式帮助 Aladdin 完成任务。

Aladdin 星期一在沙漠的左上角 $(1,1)$ 开始他的任务并面朝右。他的动作包括重复这些步骤：

1. 如果当前的网格里有一个醒着的巫师，那么 Aladdin 会根据巫师说的话向左或向右转 $90$ 度。
2. 如果向前走会把 Aladdin 带出沙漠，他会转过 $180$ 度。
3. Aladdin 向前移动了一格，这将花费他一天的时间。

对于每个巫师，我们都知道他的位置和一周中每一天的活动计划。每个巫师的日程表是一个由七个字母（仅包含`L`、`R` 或 `S`）组成的字符串，每个字符告诉我们巫师在一周中的某一天（从**星期一**开始）做什么。字母 `L` 表示 Aladdin 将在这一天被告知向左转，`R` 表示 Aladdin 将在这一天被告知向右转，而 `S` 表示巫师那天正在睡觉。

一个古老的预言说，在改变 $k$ 次方向（通过**步骤 $1$ 和步骤 $2$**）后，Aladdin 会找到 Golden Pear。根据古老的预言，写一个程序来计算冒险将持续多少天。
## 输入格式

输入共 $m+2$ 行。

第一行，两个整数 $n,k$，分别表示沙漠的边长和古老的预言中所说的要改变方向的次数。  
第二行，一个整数 $m$，表示巫师的个数。  
随后 $m$ 行，第 $i$ 行两个整数和一个字符串，分别表示巫师所在的横坐标，纵坐标和一个星期内的行动（从**星期一**开始）。

数据保证不存在在 $(1,1)$ 处的巫师、两个在同一网格的巫师或者在沙漠外的巫师。
## 输出格式

输出仅一行，一个整数，代表冒险持续的天数。
## 样例

### 样例输入 #1
```
3 1
0
```
### 样例输出 #1
```
2
```
### 样例输入 #2
```
5 2
2
1 3 RRSRRRR
1 5 RRRRLRR
```
### 样例输出 #2
```
4
```
### 样例输入 #3
```
5 5
3
1 3 SSRSSSS
3 3 SSSLSSS
4 3 SSRSSLS
```
### 样例输出 #3
```
10
```
## 提示

**【样例 1 解释】**

对于样例 $1$，Aladdin 移动了两格之后到达沙漠的边缘，随后他转过 $180$ 度，找到了 Golden Pear。所以冒险将持续 $2$ 天。

**【样例 2 解释】**

对于样例 $2$，Aladdin 在走了两天之后找到了第一个巫师，但是这个巫师此时正在睡觉，所以 Aladdin 继续走了两天，然后他在第 $4$ 天找到了第二个巫师，这个巫师告诉他要向左转，Aladdin 这么做了，然后他来到了沙漠的边缘，转过 $180$ 度，找到了 Golden Pear。所以冒险将持续 $4$ 天。

**【数据范围】**

对于 $50\%$ 的数据，保证 $k\leqslant 1000$。  
对于所有数据，$2\leqslant n\leqslant 200$，$1\leqslant k\leqslant 10^9$，$0\leqslant m\leqslant 10^4$。

**【题目来源】**

本题来源自 **_[COCI 2008-2009](https://hsin.hr/coci/archive/2008_2009/) [CONTEST 5](https://hsin.hr/coci/archive/2008_2009/contest5_tasks.pdf) T6 KRUSKA_**，按照原题数据配置，满分 $130$ 分。

由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。


---

---
title: "[CEOI 2002] A decorative fence"
layout: "post"
diff: 普及+/提高
pid: P7690
tag: ['2002', 'CEOI（中欧）']
---
# [CEOI 2002] A decorative fence
## 题目描述

理查德刚刚盖完他的新房子。现在房子唯一缺少的是一个可爱的小木栅栏。他不知道如何制作木栅栏，所以他决定订购一个。不知何故，他拿到了 $\texttt{ACME Fence Catalog 2002}$――可爱的小木栅栏的旗舰版资源（注：ACME 是一家什么都造的公司）。看完它的前言，他已经知道，什么使小木栅栏变得可爱。  
一个木栅栏由 $N$ 块木板组成，每块木板垂直排成一排。除此之外，当且仅当满足以下条件时，围栏看起来很可爱：  
- 木板有不同的长度，即 $1,2,\cdots,N$ 为木板长度单位。  
- 每块有两个相邻的木板，它要么比它的相邻的都大，要么比它相邻的都小。（即，这会使得围栏顶部交替上升和下降（高低起伏））。  

因此，我们可以将每个用 $N$ 块木板的可爱的栅栏唯一地描述为一个排列 $a_1,\cdots,a_N$（$\forall i$，$1 < i < N$）$(a_i - a_{i−1}) × (a_i - a_{i+1}) > 0$。反之亦然，每个这样的排列都描述了一个可爱的围栏。  
很明显，可能有许多不同的可爱木栅栏由 $N$ 块木板制成。ACME 的销售经理决定以下列方式排列可爱围栏并放入清单：栅栏 A（由排列 $a_1,\cdots,a_N$ 表示）在栅栏 B 之前（由 $b_1,\cdots,b_N$ 表示），当且仅当存在这样的 $i$，使得（$\forall j < i$）$a_j = b_j$ 和 （$a_i < b_i$）。（也就是说，比较两个围栏中哪个在清单中更早相当于取它们对应的排列，找出它们第一个不同的地方，并比较这个地方的值。）所有 $N$ 块木板的可爱围栏都被按照它们在清单中出现的顺序编号（从 $1$ 开始）。这个号码被称为他们的清单号。 
![TuLi](https://cdn.luogu.com.cn/upload/image_hosting/9kopwi5p.png)
仔细检查所有的可爱的小木栅栏后，理查德决定要它们中的一些。他记下木板的数量 $N$ 和清单号 $C$。后来，他遇到了他的朋友，他想向他们展示他围栏，但他失去了清单。他得到的唯一的事情是他的笔记。请帮助他查明，他的围栏将为何等样子。
## 输入格式

第一行包含一个整数 $K$。接下来 $K$ 行，每行描述一个输入数据集，每一行都包含两个以空格分割的整数 $N$ 和 $C$，$N$ 是围栏上木板的数量，$C$ 是围栏的栅栏的清单号。
## 输出格式

每个数据集输出一行，描述列表带有 $N$ 个木板的第 $C$ 个栅栏。更准确地说，如果栅栏排列 $a_1,\cdots,a_N$，则输出的相应行应包含数字 $a_i$（按正确顺序），由单个空格分隔。
## 样例

### 样例输入 #1
```
2
2 1
3 3
```
### 样例输出 #1
```
1 2
2 3 1
```
## 提示

#### 数据规模与约定  
对于 $100 \%$ 的数据，$1 \leq K \leq 100$，$1 \leq N \leq 20$。你可以认为，$20$ 块木板的可爱小木栅栏的总数适合转换为 $64$ 位有符号整数变量（C/C++ 中的 `long long`，FreePascal 中的 `int64`）。你也可以认为输入是正确的，特别是 $C$ 最小是 $1$ 并且它不超过有 $N$ 块木板的可爱围栏的数量。  
#### 题目说明  
来源于 CENTRAL-EUROPEAN OLYMPIAD IN INFORMATICS 2002 的 [A decorative fence](https://web.ics.upjs.sk/ceoi/documents/tasks/fence-tsk.pdf)。  
由 @[求学的企鹅](/user/271784) 翻译整理。


---

---
title: "[COCI 2009/2010 #4] OGRADA"
layout: "post"
diff: 普及+/提高
pid: P7697
tag: ['2009', 'COCI（克罗地亚）']
---
# [COCI 2009/2010 #4] OGRADA
## 题目背景

Matjia 需要粉刷他的旧篱笆。
## 题目描述

篱笆是由 $n$ 块木板做成的，每块木板宽 $1$ 厘米，高度不一。为了方便快捷，他给自己买了一个宽 $x$ 厘米的超级油漆辊。然而超级油漆辊来了一个陷阱——Matija 必须始终使辊子紧密地整个接触木板，否则油漆会滴到四周并污渍所有东西。此外，辊子必须始终与地面平行，以防泄漏。这意味着为了让 Matija 安全地使用压路机，他需要选择 $x$ 块木板，并从最下面的木板的底部到顶部一次涂上油漆。然后，他选择一些其他的木板，油漆它们，以此类推。

这使得一些木板的部分没有上漆。Matija 必须用牙刷刷这些部分。这显然是相当乏味的，所以他请你帮他编写一个程序，求出他需要手动刷漆的最小面积。因为有不止一种方法可以做到这一点，他也想知道需要使用超级油漆辊的最少次数。
## 输入格式

输入共两行。

第一行两个整数 $n,x$，分别代表木板的个数和超级油漆辊的宽度。  
第二行 $n$ 个正整数 $h_1,h_2,\dots,h_n$，表示每个木板的高度。
## 输出格式

输出共两行。

第一行一个整数，表示 Matjia 需要手动刷漆的最小面积。  
第二行一个整数，表示在手动刷漆的面积最小的前提下，需要使用超级油漆辊的最少次数。
## 样例

### 样例输入 #1
```
5 3
5 3 4 4 5
```
### 样例输出 #1
```
3
2
```
### 样例输入 #2
```
10 3
3 3 3 3 3 3 3 3 3 3
```
### 样例输出 #2
```
0
4
```
### 样例输入 #3
```
7 4
1 2 3 4 3 2 1
```
### 样例输出 #3
```
4
4
```
## 提示

**【样例 1 解释】**

对于样例 $1$，Matjia 需要使用两次超级油漆辊。

- 第一次，用超级油漆辊粉刷第 $1,2,3$ 个木板，粉刷高度为 $3\text{ cm}$，因此粉刷面积为 $9\text{ cm}^2$。
- 第二次，用超级油漆辊粉刷第 $3,4,5$ 个木板，粉刷高度为 $4\text{ cm}$，因此粉刷面积为 $12\text{ cm}^2$。

因为两次粉刷有 $3\text{ cm}^2$ 的面积重叠，因此剩下的需要手动粉刷的面积为 $5+3+4+4+5-9-12+3=3\text{ cm}^2$。可以证明这样的方案需要手动粉刷的面积是最小的并且使用超级油漆辊的次数也是最少的。

具体可以结合下图理解：

![](https://cdn.luogu.com.cn/upload/image_hosting/hrjc66u8.png)

**【数据范围】**

对于所有数据，$1\leqslant n\leqslant 10^6$，$1\leqslant x\leqslant 10^5$，$1\leqslant h_i<10^6$。

**【题目来源】**

本题来源自 **_[COCI 2009-2010](https://hsin.hr/coci/archive/2009_2010/) [CONTEST 4](https://hsin.hr/coci/archive/2009_2010/contest4_tasks.pdf) T4 OGRADA_**，按照原题数据配置，满分 $100$ 分。

由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。


---

---
title: "[CCC 2014] 提前交卷"
layout: "post"
diff: 普及+/提高
pid: P7701
tag: ['2014', 'CCC（加拿大）']
---
# [CCC 2014] 提前交卷
## 题目描述

你正在一个狭窄而又长的礼堂里考试，礼堂一共有 $n$ 排，标号从前到后分别为 $1$ 到 $n$。每排有 $6$ 个座位，左边 $3$ 个，右边 $3$ 个，中间是过道。每个座位都有一个从 A 到 F 的字母标识，其中最左的座位的标识是 A，最右的座位的标识是 F，过道在座位标识为 C 和 D 的座位之间，礼堂同时还有两个保密室，一个在最前面（第一排前面），一个在最后面（第 $n$ 排后面）。

礼堂里的每个座位一开始被刚好一个考生占用。然而，在考试过程中，$m$ 个不同的考生决定完成所有他们会做的题后依次离开礼堂。第 $i$ 个考生在座位 $r_ic_i$，其中 $c_i$ 是 A 到 F 的字母之一。当考生离开礼堂时，他们必须在任意一个保密室等待到考试结束。幸运的是，保密室能容下任意多的考生。

考生不仅关心试题本身，他们还关心怎么样可以最舒服的考试。因此，他们协作以最小化他们的不满度之和。一个考生的不满度的计算方式是 $Ax+By$，其中 $A,B$ 为常数，$x$ 为去往保密室时经过的考生人数，具体将在下面详述，$y$ 是在考生进入保密室之前保密室内的人数。注意如果一个考生不离开他的考位，那么他的不满度为 $0$。

当一个考生从一个考位走往保密室时，他在去往过道时必须先经过同排的考生，然后走过从这行到第一行或第 $n$ 行（取决于所选的保密室）的邻近过道的考生。注意走过空的座位不影响 $x$ 值。

你能帮助他们最小化他们的不满度之和吗？
## 输入格式

第一行四个整数 $n,m,A,B$，以空格分隔，分别表示礼堂内的排数、提前离开的考生数、不满度计算参数。

接下来 $m$ 行每行一个整数 $r_i$ 和一个字母 $c_i$，其中 $1\le i\le n$。
## 输出格式

输出一个整数，表示最小的不满度之和。
## 样例

### 样例输入 #1
```
5 5 3 4
3E
1D
5C
1E
4A
```
### 样例输出 #1
```
55
```
## 提示

其中一个最优策略是，第一个提前离开的考生去最前面的保密室，经过 $6$ 个考生（分别是 `3D`、`3C`、`2D`、`2C`、`1D`、`1C`），不满度为 $3\times6+4\times0=18$。第二个提前离开的考生也去最前面的保密室，只经过 $1$ 个考生，即 `1C`，然后他发现保密室里有 $1$ 个考生，不满度为 $7$。第三个提前离开的考生去最后面的保密室，经过 $1$ 个考生，不满度为 $3$。第四个提前离开的考生去最前面的保密室，经过 $1$ 个考生（因为座位 `1D` 是空的），不满度为 $11$。最后，第五个提前离开的考生去最后面的保密室，经过 $4$ 个考生，发现保密室里有 $1$ 个人，不满度为 $16$。所有考生总的不满度为 $55$。

对于 $60\%$ 的数据，$1\le m\le5000$；

对于 $100\%$ 的数据，$1\le n\le 10^5$，$1\le m\le6n$，$1\le A,B\le 10^9$。


---

---
title: "珍珠帝王蟹（Crab King）"
layout: "post"
diff: 普及+/提高
pid: P7725
tag: []
---
# 珍珠帝王蟹（Crab King）
## 题目背景

在一次航程中，你偶然发现了被一片礁石环绕的帝王蟹，被月岛能量侵蚀的它又与月光有着怎样的联系呢？似乎只有击败它才能见分晓。

## 题目描述

帝王蟹可以通过镶嵌宝石触发战斗，不同的宝石效果不同，但奇特的是，镶嵌宝石的顺序有时也会影响它的强度。

帝王蟹有一个初始为 $0$ 的强度值，每个宝石有属性 $op$ 和 $v$，表示：

- 若 $op$ 为 `+`，则镶嵌后帝王蟹的强度值将会加上 $v$；

- 若 $op$ 为 `*`，则镶嵌后帝王蟹的强度值将会乘上 $v$。

由于宝石的效果十分奇异，所以 $v$ 可能是负数。

作为一个有挑战精神的冒险者，你希望采取某种镶嵌方式，将**每个宝石**都镶嵌**恰好一遍**，且使得帝王蟹的强度值最大。

你只需要输出最大的强度值对 $998244353$ 取模的结果，注意这是一个 $[0, 998244353)$ 中的数。

也就是说，如果答案为 `ans`，按照 C++ 语法，你需要输出 `(ans % P + P) % P`，其中 `P = 998244353`。

## 输入格式

第一行，一个整数 $n$，表示宝石数量。

接下来 $n$ 行，每行有用空格隔开的一个字符 $op$ 和一个整数 $v$，描述一个宝石。
## 输出格式

输出一行一个整数，表示最大的强度值对 $998244353$ 取模的结果。
## 样例

### 样例输入 #1
```
3
+ -3
+ 4
* -4

```
### 样例输出 #1
```
16

```
### 样例输入 #2
```
3
+ -3
+ -4
* 4

```
### 样例输出 #2
```
998244346

```
## 提示

**【样例 1 解释】**

按照输入顺序以 $1, 2, 3$ 标记每个宝石，所有可能的镶嵌顺序如下：

$1\to 2\to 3$：$x = ((0 + {\color{red}{-3}}) + {\color{red}{4}}) \times {\color{red}{-4}} = -4$；

$1\to 3\to 2$：$x = ((0 + {\color{red}{-3}}) \times {\color{red}{-4}}) + {\color{red}{4}} = 16$；

$2\to 1\to 3$：$x = ((0 + {\color{red}{4}}) + {\color{red}{-3}}) \times {\color{red}{-4}} = -4$；

$2\to 3\to 1$：$x = ((0 + {\color{red}{4}}) \times {\color{red}{-4}}) + {\color{red}{-3}} = -19$；

$3\to 1\to 2$：$x = ((0 \times {\color{red}{-4}}) + {\color{red}{-3}}) + {\color{red}{4}} = 1$；

$3\to 2\to 1$：$x = ((0 \times {\color{red}{-4}}) + {\color{red}{4}}) + {\color{red}{-3}} = 1$。

因此，强度值的最大值为 $16$，对 $998244353$ 取模后为 $16$。

---

**【样例 2 解释】**

按照输入顺序以 $1, 2, 3$ 标记每个宝石，所有可能的镶嵌顺序如下：

$1\to 2\to 3$：$x = ((0 + {\color{red}{-3}}) + {\color{red}{-4}}) \times {\color{red}{4}} = -28$；

$1\to 3\to 2$：$x = ((0 + {\color{red}{-3}}) \times {\color{red}{4}}) + {\color{red}{-4}} = -16$；

$2\to 1\to 3$：$x = ((0 + {\color{red}{-4}}) + {\color{red}{-3}}) \times {\color{red}{4}} = -28$；

$2\to 3\to 1$：$x = ((0 + {\color{red}{-4}}) \times {\color{red}{4}}) + {\color{red}{-3}} = -19$；

$3\to 1\to 2$：$x = ((0 \times {\color{red}{4}}) + {\color{red}{-3}}) + {\color{red}{-4}} = -7$；

$3\to 2\to 1$：$x = ((0 \times {\color{red}{4}}) + {\color{red}{-4}}) + {\color{red}{-3}} = -7$。

因此，强度值的最大值为 $-7$，对 $998244353$ 取模后为 $998244346$。

---

**【数据范围】**

**本题采用捆绑测试。**

对于全部测试数据：$1 \le n \le {10}^5$，$2 \le |v| \le {10}^6$。

- Subtask 1（26 points）：$n \le 9$，$|v| \le 5$。
- Subtask 2（22 points）：$v > 0$。
- Subtask 3（12 points）：保证当 $op$ 为 `*` 时 $v > 0$。
- Subtask 4（15 points）：保证当 $op$ 为 `+` 时 $v > 0$。
- Subtask 5（25 points）：无特殊限制。

---

![](https://cdn.luogu.com.cn/upload/image_hosting/rwzuwu9z.png)


---

---
title: "天体探测仪（Astral Detector）"
layout: "post"
diff: 普及+/提高
pid: P7726
tag: ['Special Judge']
---
# 天体探测仪（Astral Detector）
## 题目背景

通过远古档案馆的探索，你成功制出了天体探测仪，你需要用它发现潜藏的天体科技。

## 题目描述

想要找到天体科技，你需要先得到一串天体密码——它是一个 $1 \sim n$ 的**排列**。

天体探测仪允许对于给定的长度 $l$，返回密码中一个长度为 $l$ 的**区间的最小值**。

不幸的是，所有长度为 $l$ 的区间最小值混在了一起，你得到的只是 $n$ 个**可重集合** $S_1, \ldots , S_n$：

- $S_i$ 表示所有长度为 $i$ 的区间最小值构成的可重集合。

你需要根据这些 $S_i$，还原出一种可能的天体密码，保证至少存在一种正确的天体密码。
## 输入格式

第一行，一个整数 $n$，表示天体密码的长度。

接下来 $n$ 行，其中第 $i$ 行包含 $n - i + 1$ 个整数（长度为 $i$ 的区间共有 $n - i + 1$ 个），表示可重集 $S_i$ 中的每个元素，注意元素的顺序是**任意的**，而不一定是按照区间从左到右的顺序。
## 输出格式

输出一行 $n$ 个整数 $p_1, p_2, \ldots , p_n$，表示你还原出的天体密码。

如有多种可行解，可以输出任意一种。
## 样例

### 样例输入 #1
```
4
4 3 2 1
1 2 1
1 1
1

```
### 样例输出 #1
```
3 1 2 4

```
## 提示

**【样例 1 解释】**

样例输出的天体密码为：$p = [3, 1, 2, 4]$。

长度为 $1$ 的区间最小值构成的可重集合：$S_1 = \{ 3, 1, 2, 4 \} = \{ 4, 3, 2, 1 \}$。

长度为 $2$ 的区间最小值构成的可重集合：$S_2 = \{ \min(3, 1), \min(1, 2), \min(2, 4) \} = \{ 1, 1, 2 \} = \{ 1, 2, 1 \}$。

长度为 $3$ 的区间最小值构成的可重集合：$S_3 = \{ \min(3, 1, 2), \min(1, 2, 4) \} = \{ 1, 1 \}$。

长度为 $4$ 的区间最小值构成的可重集合：$S_4 = \{ \min(3, 1, 2, 4) \} = \{ 1 \}$。

每一个 $S_i$ 都与输入对应。

其他可行答案也判为正确，如 $p = [4, 2, 1, 3]$。

---

**【数据范围】**

**本题采用捆绑测试。**

对于 $100\%$ 的数据：$2 \le n \le 800$。

| 子任务编号 | 分值 | $n \le$ | 特殊限制 |
|:-:|:-:|:-:|:-:|
| $1$ | $26$ | $6$ | 无 |
| $2$ | $24$ | $16$ | 无 |
| $3$ | $12$ | $800$ | 对于每个 $i \in [1, n]$，$S_i$ 中不存在两个相同元素 |
| $4$ | $38$ | $800$ | 无 |


---

---
title: "[AHOI2007] 石块地板"
layout: "post"
diff: 普及+/提高
pid: P7741
tag: ['2007', '各省省选', '安徽', 'O2优化']
---
# [AHOI2007] 石块地板
## 题目描述

小可可来到了宫殿的正厅中。大厅的地面是由一块块大小一致的正方形石块组成的，这些石块分为黑、白两色，组成了一个   $m×n$ 的矩形，在其中一个石块的下面就是通往藏宝库的通道。小可可不可能一个一个石块的尝试，因为有些石块安装了机关，一碰就会触发，整个宫殿也随之倒塌。根据藏宝图记载，通道在某一特定的区域中，这个区域是一个由数个石块组成的面积不为 $0$ 的小矩形，它的四条边与大厅地面的边平行。如果对整个大厅地面任意划分矩形，那么在所有矩形中，这个区域的黑色石块数目减去白色石块数目所得的差是最大的。

小可可希望和你分工，由他来选择区域，你来计算黑、白两色石块的数目差 $S$ 。这样就能快速而准确的确认通道所在的区域。藏宝图上说这个区域中的石块都没有安装机关，只要确定了区域，就一定能找到通道。宝藏就在眼前了，加油吧！

（假设用 $1$ 表示黑色石块，用 $0$ 表示白色石块）
## 输入格式

输入文件的第一行为两个整数 $m,n$。

以下 $m$ 行，每行 $n$ 个字符，每个字符都是 $0$ 或 $1$。
## 输出格式

输出文件仅一个数，表示所有可能的区域中 $S$ 值（见前文描述）最大的一个，输出这个值即可。
## 样例

### 样例输入 #1
```
3 4
1011
1111
1111
```
### 样例输出 #1
```
10
```
### 样例输入 #2
```
4 5
10110
01111
11110
10101
```
### 样例输出 #2
```
8
```
## 提示

对于 $ 50\%$ 的数据：$1 \le m, n \leq200$。

对于 $100\%$ 的数据：$1 \le m, n \leq400$。


---

---
title: "[COCI 2016/2017 #5] Ronald"
layout: "post"
diff: 普及+/提高
pid: P7763
tag: ['2016', 'COCI（克罗地亚）']
---
# [COCI 2016/2017 #5] Ronald
## 题目描述

一个国家的 $N$ 个城市通过双向航线相连。

规定一次操作为：

- 选定其中一个城市
- 开设该城市到其它所有城市的航线，同时取消该城市的原有航线

请问是否存在一种操作方式，使得每两个城市之间都存在直达航线（操作次数不限）。
## 输入格式

第一行，一个整数 $N$，表示城市的数量。

第二行，一个整数 $M$，表示初始的航线数量。

接下来的 $M$ 行，每行两个不相等的整数，表示该航线连接的两个城市。
## 输出格式

若存在符合题意的操作方式，则输出 `DA`。否则输出 `NE`。
## 样例

### 样例输入 #1
```
2
0
```
### 样例输出 #1
```
DA
```
### 样例输入 #2
```
3
2
1 2
2 3
```
### 样例输出 #2
```
NE
```
### 样例输入 #3
```
4
2
1 3
2 4
```
### 样例输出 #3
```
DA
```
## 提示

**【样例 1 解释】**

选定城市 $1$（即开通 $1-2$ 的航线）即可。

**【样例 3 解释】**

原有航线为 $1-3$ 和 $2-4$。

第一次选定城市 $1$。此时航线 $1-3$ 被取消，同时新开设航线 $1-1,1-2,1-4$。

第二次选定城市 $3$。此时新开设航线 $3-1,3-2,3-4$。

**【数据规模与约定】**

对于 $100\%$ 的数据，$2 \le N \le 1000$，$0 \le M \lt \dfrac{N(N-1)}{2}$。

**【提示与说明】**

**题目译自 [COCI 2016-2017](https://hsin.hr/coci/archive/2016_2017/) [CONTEST #5](https://hsin.hr/coci/archive/2016_2017/contest5_tasks.pdf) _T4 Ronald_。**

**本题分值按 COCI 原题设置，满分 $120$。**


---

---
title: "魔力滋生"
layout: "post"
diff: 普及+/提高
pid: P7807
tag: ['2021', '洛谷原创', 'Special Judge', 'O2优化']
---
# 魔力滋生
## 题目背景

Source：[八仙敬酒](/paste/78f1vlm0)，这是可以点的。

- 吕洞宾——醉酒提壶力千钧；
- 铁拐李——旋肘膝撞醉还真；
- 汉钟离——跌步抱坛兜心顶；
- **蓝采和——单提敬酒拦腰破**；
- 张果老——醉酒抛杯踢连环；
- 曹国舅——仙人敬酒锁喉扣；
- 韩湘子——擒腕击胸醉吹箫；
- 何仙姑——弹腰献酒醉荡步。
## 题目描述

现有一个 $n$ 个点的树 $T$，满足任意一个结点的所连接的结点个数不超过 $2$。

现在依次对结点 $u=1\sim n$ 进行操作：

- 随机一个整数 $x(\ge k)$；
- 新建 $x$ 个结点，每个结点与 $u$ 之间连一条边。

显然操作完成后仍是一棵树 $T'$，其结点数为 $m=n+\sum x$。

已知操作后的树 $T'$ 及其结点数 $m$，请还原原树 $T$，若有多种方案，输出 **任意一组** 使得 $\color{black}n$ **最大** 的。

值得注意的是，我们进行还原和输出时，只关心树的形状，而不关心结点的相对编号。
## 输入格式

第一行输入两个正整数 $m,k$，表示树 $T'$ 的结点数、随机数 $x$ 的下限。

第 $2\sim m$ 行，每行输入两个正整数 $u,v$，表示树 $T'$ 中的一条边。
## 输出格式

第一行输出一个正整数 $n$，表示构造出树 $T$ 的结点数。

第 $2\sim n$ 行，每行输出两个正整数 $u,v$，表示树 $T$ 中的一条边。

输出的 $u,v$ 必须满足：$1\le u,v\le n$。
## 样例

### 样例输入 #1
```
5 1
1 2
1 3
1 4
1 5
```
### 样例输出 #1
```
1
```
### 样例输入 #2
```
7 0
1 2
1 3
1 4
1 5
1 6
1 7
```
### 样例输出 #2
```
3
1 2
1 3
```
### 样例输入 #3
```
9 1
1 2
2 3
1 4
1 5
2 6
2 7
3 8
3 9
```
### 样例输出 #3
```
3
1 2
2 3
```
## 提示

#### 样例说明

样例 $\#1$ 中，只有结点 $1$ 可能在树 $T$ 中：它对应的 $x$ 是 $4$。

样例 $\#2$ 中，结点 $1,2,3$ 在树 $T$ 中：结点 $1$ 对应的 $x$ 是 $4$，结点 $2,3$ 对应的 $x$ 是 $0$。

样例 $\#3$ 中，结点 $1,2,3$ 在树 $T$ 中：它们随机的 $x$ 均为 $2$。

![](https://cdn.luogu.com.cn/upload/image_hosting/4mug6pzd.png)

样例 $\#3$ 给出一张示意图，图中红色结点表示树 $T$ 中的结点，图中所有结点都在树 $T'$ 上。

#### 数据范围

| Subtask | Score | $x=$ |
| :----------: | :----------: | :----------: |
| $1$ | $30$ | $0$ |
| $2$ | $30$ | $1$ |
| $3$ | $40$ |  |
| $4$ | $0$ | Hack |

说明：Subtask4 为不计分 Hack 数据，只有通过全部的 Subtask $1\sim4$ 才算 AC。

对于 $100\%$ 的数据：$1\le m\le10^5,k\in[0,m)$，数据输入保证有解。

---

### 后记

极光魔花好可爱 $\sim$

![](https://cdn.luogu.com.cn/upload/image_hosting/o0gdk38a.png)


---

---
title: "「MCOI-06」Existence of Truth"
layout: "post"
diff: 普及+/提高
pid: P7887
tag: ['2021', 'O2优化', '洛谷月赛']
---
# 「MCOI-06」Existence of Truth
## 题目描述

可能存在一个非负整数数序列 $a_1,a_2,\dots,a_n$ 使得 $0\le a_i<10^9+7$。

给定 $x_1,x_2,\dots,x_n$，$y_1,y_2,\dots,y_n$，$z_1,z_2,\dots,z_n$，已知对于 $1\le i\le n$ 满足：

$$x_i\left(\sum_{j=1}^ia_j\right)+y_i\left(\sum_{j=i}^na_j\right)\equiv z_i\pmod{10^9+7}$$

求 $a_1,a_2,\dots,a_n$。
## 输入格式

**本题有多组数据。**

第一行一个正整数 $T$，表示表示数据的组数。对于每一组数据：

第一行一个正整数 $n$。

接下来 $n$ 行，每行三个正整数 $x_i,y_i,z_i$。
## 输出格式

对于每一组数据，依次输出：

第一行一个非负整数 $k$，为合法解数量。

如果 $k=1$，第二行输出 $n$ 个非负整数，依次为 $a_1,a_2,\dots,a_n$。
## 样例

### 样例输入 #1
```
2
3
3 1 9
2 2 16
1 3 15
6
3 6 246
5 7 283
2 7 179
4 6 214
8 7 337
3 5 151
```
### 样例输出 #1
```
1
1 2 3
1
8 8 0 6 7 8
```
## 提示

#### 数据规模与约定

**本题采用捆绑测试。**

 - Subtask 1（10 pts）：$n=1$。
 - Subtask 2（19 pts）：$\sum n\le100$。
 - Subtask 3（19 pts）：$x_i=y_i=1$。
 - Subtask 4（22 pts）：保证有**唯一解。**
 - Subtask 5（30 pts）：无特殊限制。

对于所有数据：

 - $1\le n,\sum n\le 2\times10^5$；
 - $1\le x_i,y_i<10^9+7$；
 - $0\le z_i<10^9+7$。


---

---
title: "[CSP-S 2021] 廊桥分配"
layout: "post"
diff: 普及+/提高
pid: P7913
tag: ['2021', 'O2优化', 'CSP-S 提高级']
---
# [CSP-S 2021] 廊桥分配
## 题目描述

当一架飞机抵达机场时，可以停靠在航站楼旁的廊桥，也可以停靠在位于机场边缘的远机位。乘客一般更期待停靠在廊桥，因为这样省去了坐摆渡车前往航站楼的周折。然而，因为廊桥的数量有限，所以这样的愿望不总是能实现。

机场分为国内区和国际区，国内航班飞机只能停靠在国内区，国际航班飞机只能停靠在国际区。一部分廊桥属于国内区，其余的廊桥属于国际区。

L 市新建了一座机场，一共有 $n$ 个廊桥。该机场决定，廊桥的使用遵循“先到先得”的原则，即每架飞机抵达后，如果相应的区（国内/国际）还有空闲的廊桥，就停靠在廊桥，否则停靠在远机位（假设远机位的数量充足）。该机场只有一条跑道，因此不存在两架飞机同时抵达的情况。

现给定未来一段时间飞机的抵达、离开时刻，请你负责将 $n$ 个廊桥分配给国内区和国际区，使停靠廊桥的飞机数量最多。
## 输入格式

输入的第一行，包含三个正整数 $n, m_1, m_2$，分别表示廊桥的个数、国内航班飞机的数量、国际航班飞机的数量。

接下来 $m_1$ 行，是国内航班的信息，第 $i$ 行包含两个正整数 $a_{1, i}, b_{1, i}$，分别表示一架国内航班飞机的抵达、离开时刻。

接下来 $m_2$ 行，是国际航班的信息，第 $i$ 行包含两个正整数 $a_{2, i}, b_{2, i}$，分别表示一架国际航班飞机的抵达、离开时刻。

每行的多个整数由空格分隔。
## 输出格式

输出一个正整数，表示能够停靠廊桥的飞机数量的最大值。
## 样例

### 样例输入 #1
```
3 5 4
1 5
3 8
6 10
9 14
13 18
2 11
4 15
7 17
12 16

```
### 样例输出 #1
```
7

```
### 样例输入 #2
```
2 4 6
20 30
40 50
21 22
41 42
1 19
2 18
3 4
5 6
7 8
9 10

```
### 样例输出 #2
```
4

```
### 样例输入 #3
```
见附件中的 airport/airport3.in
```
### 样例输出 #3
```
见附件中的 airport/airport3.ans
```
## 提示

**【样例解释 #1】**

![](https://cdn.luogu.com.cn/upload/image_hosting/48wcffrv.png)

在图中，我们用抵达、离开时刻的数对来代表一架飞机，如 $(1, 5)$ 表示时刻 $1$ 抵达、时刻 $5$ 离开的飞机；用 $\surd$ 表示该飞机停靠在廊桥，用 $\times$ 表示该飞机停靠在远机位。

我们以表格中阴影部分的计算方式为例，说明该表的含义。在这一部分中，国际区有 $2$ 个廊桥，$4$ 架国际航班飞机依如下次序抵达：

1. 首先 $(2, 11)$ 在时刻 $2$ 抵达，停靠在廊桥。
2. 然后 $(4, 15)$ 在时刻 $4$ 抵达，停靠在另一个廊桥。
3. 接着 $(7, 17)$ 在时刻 $7$ 抵达，这时前 $2$ 架飞机都还没离开、都还占用着廊桥，而国际区只有 $2$ 个廊桥，所以只能停靠远机位。
4. 最后 $(12, 16)$ 在时刻 $12$ 抵达，这时 $(2, 11)$ 这架飞机已经离开，所以有 $1$ 个空闲的廊桥，该飞机可以停靠在廊桥。

根据表格中的计算结果，当国内区分配 $2$ 个廊桥、国际区分配 $1$ 个廊桥时，停靠廊桥的飞机数量最多，一共 $7$ 架。

**【样例解释 #2】**

当国内区分配 $2$ 个廊桥、国际区分配 $0$ 个廊桥时，停靠廊桥的飞机数量最多，一共 $4$ 架，即所有的国内航班飞机都能停靠在廊桥。

需要注意的是，本题中廊桥的使用遵循“先到先得”的原则，如果国际区只有 $1$ 个廊桥，那么将被飞机 $(1, 19)$ 占用，而不会被 $(3, 4)$、$(5, 6)$、$(7, 8)$、$(9, 10)$ 这 $4$ 架飞机先后使用。

**【数据范围】**

对于 $20 \%$ 的数据，$n \le 100$，$m_1 + m_2 \le 100$。  
对于 $40 \%$ 的数据，$n \le 5000$，$m_1 + m_2 \le 5000$。  
对于 $100 \%$ 的数据，$1 \le n \le {10}^5$，$m_1, m_2 \ge 1$，$m_1 + m_2 \le {10}^5$，所有 $a_{1, i}, b_{1, i}, a_{2, i}, b_{2, i}$ 为数值不超过 ${10}^8$ 的互不相同的正整数，且保证对于每个 $i \in [1, m_1]$，都有 $a_{1, i} < b_{1, i}$，以及对于每个 $i \in [1, m_2]$，都有 $a_{2, i} < b_{2, i}$。

【感谢 hack 数据提供】

- [xingxuxin](/user/393378)。
- [cyslngsul](/user/126765)。


---

---
title: "[CSP-S 2021] 回文"
layout: "post"
diff: 普及+/提高
pid: P7915
tag: ['2021', 'O2优化', 'CSP-S 提高级']
---
# [CSP-S 2021] 回文
## 题目描述

给定正整数 $n$ 和整数序列 $a_1, a_2, \ldots, a_{2 n}$，在这 $2 n$ 个数中，$1, 2, \ldots, n$ 分别各出现恰好 $2$ 次。现在进行 $2 n$ 次操作，目标是创建一个长度同样为 $2 n$ 的序列 $b_1, b_2, \ldots, b_{2 n}$，初始时 $b$ 为空序列，每次可以进行以下两种操作之一：

1. 将序列 $a$ 的开头元素加到 $b$ 的末尾，并从 $a$ 中移除。
2. 将序列 $a$ 的末尾元素加到 $b$ 的末尾，并从 $a$ 中移除。

我们的目的是让 $b$ 成为一个**回文数列**，即令其满足对所有 $1 \le i \le n$，有 $b_i = b_{2 n + 1 - i}$。请你判断该目的是否能达成，如果可以，请输出字典序最小的操作方案，具体在【**输出格式**】中说明。
## 输入格式

每个测试点包含多组测试数据。

输入的第一行，包含一个整数 $T$，表示测试数据的组数。对于每组测试数据：

第一行，包含一个正整数 $n$。  
第二行，包含 $2 n$ 个用空格隔开的整数 $a_1, a_2, \ldots, a_{2 n}$。
## 输出格式

对每组测试数据输出一行答案。

如果无法生成出回文数列，输出一行 `-1`，否则输出一行一个长度为 $2 n$ 的、由字符 `L` 或 `R` 构成的字符串（不含空格），其中 `L` 表示移除开头元素的操作 1，`R` 表示操作 2。

你需要输出所有方案对应的字符串中字典序最小的一个。

字典序的比较规则如下：长度均为 $2 n$ 的字符串 $s_{1 \sim 2 n}$ 比 $t_{1 \sim 2 n}$ 字典序小，当且仅当存在下标 $1 \le k \le 2 n$ 使得对于每个 $1 \le i < k$ 有 $s_i = t_i$ 且 $s_k < t_k$。
## 样例

### 样例输入 #1
```
2
5
4 1 2 4 5 3 1 2 3 5
3
3 2 1 2 1 3

```
### 样例输出 #1
```
LRRLLRRRRL
-1

```
### 样例输入 #2
```
见附件中的 palin/palin2.in
```
### 样例输出 #2
```
见附件中的 palin/palin2.ans
```
## 提示

**【样例解释 #1】**

在第一组数据中，生成的的 $b$ 数列是 $[4, 5, 3, 1, 2, 2, 1, 3, 5, 4]$，可以看出这是一个回文数列。

另一种可能的操作方案是 `LRRLLRRRRR`，但比答案方案的字典序要大。

**【数据范围】**

令 $\sum n$ 表示所有 $T$ 组测试数据中 $n$ 的和。

对所有测试点保证 $1 \le T \le 100$，$1 \le n, \sum n \le 5 \times {10}^5$。

| 测试点编号 | $T \le$ | $n \le$ | $\sum n \le$ | 特殊性质 |
|:-:|:-:|:-:|:-:|:-:|
| $1 \sim 7$ | $10$ | $10$ | $50$ | 无 |
| $8 \sim 10$ | $100$ | $20$ | $1000$ | 无 |
| $11 \sim 12$ | $100$ | $100$ | $1000$ | 无 |
| $13 \sim 15$ | $100$ | $1000$ | $25000$ | 无 |
| $16 \sim 17$ | $1$ | $5 \times {10}^5$ | $5 \times {10}^5$ | 无 |
| $18 \sim 20$ | $100$ | $5 \times {10}^5$ | $5 \times {10}^5$ | 有 |
| $21 \sim 25$ | $100$ | $5 \times {10}^5$ | $5 \times {10}^5$ | 无 |

特殊性质：如果我们每次删除 $a$ 中两个相邻且相等的数，存在一种方式将序列删空（例如 $a = [1, 2, 2, 1]$）。

**【hack 数据提供】**  
@[潜在了H2O下面](user/264490)。



---

---
title: "[Kubic] ABC"
layout: "post"
diff: 普及+/提高
pid: P7919
tag: ['Special Judge', 'O2优化', '洛谷月赛']
---
# [Kubic] ABC
## 题目背景

建议先看 D 题题目背景。
## 题目描述

给定一个长度为 $n$ 的只包含 $\texttt{A,B,C}$ 的字符串 $S$，你可以进行若干次操作，每次操作为：

- 先选择一个区间 $[l,r]$，你需要保证 $1\le l\le r\le n$。

- 再选择三个字符 $pA,pB,pC\in\{\texttt{A,B,C}\}$，并将 $S_{l\dots r}$ 中所有 $\texttt{A}$ 变为 $pA$，所有 $\texttt{B}$ 变为 $pB$，所有 $\texttt{C}$ 变为 $pC$，**$pA,pB,pC$ 可以相等**。

求出**最少**需要进行多少次操作才能使得 $S$ 中**任意相邻两个字符不同**，并**输出构造方案**。
## 输入格式

第一行，一个整数 $n$。

第二行，一个长度为 $n$ 的字符串 $S$。
## 输出格式

第一行，一个整数 $m$，表示你所构造的方案的操作次数。

接下来 $m$ 行，每行两个整数 $l,r$ 和三个字符 $pA,pB,pC$。

你需要保证 $1\le l\le r\le n,pA,pB,pC\in\{\texttt{A,B,C}\}$。

**注意：$pA,pB,pC$ 之间不需要，也不应该加空格（参考样例输出）**。
## 样例

### 样例输入 #1
```
5
ABBAA
```
### 样例输出 #1
```
1
3 4 BAC
```
### 样例输入 #2
```
5
ABCBA
```
### 样例输出 #2
```
0
```
## 提示

对于 $100\%$ 的数据，$1\le n\le 5\times 10^3,S_i\in\{\texttt{A,B,C}\}$。

||分值|$n$|特殊性质|
|:-:|:-:|:-:|:-:|
|$\operatorname{Subtask}1$|$1$|无特殊限制|$\forall i\in[1,n),S_i\neq S_{i+1}$|
|$\operatorname{Subtask}2$|$19$|$\le 10$|无|
|$\operatorname{Subtask}3$|$10$|无特殊限制|$S_i=\texttt{A}$|
|$\operatorname{Subtask}4$|$20$|无特殊限制|$S_i\in\{\texttt{A,B}\}$|
|$\operatorname{Subtask}5$|$20$|$\le 100$|无|
|$\operatorname{Subtask}6$|$30$|无特殊限制|无|

### 评分方法

以下情况将会使你在该测试点获得 $0$ 分：

- 输出格式不满足要求。

- 输出多余信息（包括空格和换行符）

- 构造的方案操作次数与标准答案不同。

- 构造的方案不符合题目要求。

- 时间超限。

如果没有上述情况，你在该测试点获得满分。

**保证 SPJ 占用不超过 $100\operatorname{ms},10\operatorname{MB}$**。

### 样例解释 1

一种操作过程如下：

`ABBAA`

`ABABA`

可以证明没有更优的方案。

### 样例解释 2

初始序列已经符合题目要求，直接输出一行 $0$ 即可。


---

---
title: "[COCI 2007/2008 #5] BARICA"
layout: "post"
diff: 普及+/提高
pid: P7936
tag: ['2007', 'COCI（克罗地亚）']
---
# [COCI 2007/2008 #5] BARICA
## 题目描述

Barica 是一只非同寻常的青蛙。她住在一个池塘里，有 $N$ 片漂浮在水面上的荷叶。这些荷叶的编号为 $1$ 到 $N$，位置可以用一对坐标表示。Barica 可以在这些荷叶上跳来跳去，但是她害怕斜着跳和朝负方向跳。

准确的说，她可以从坐标 $(x_1,y_1)$ 跳到另一个坐标 $(x_2,y_2)$ 仅当：

- $x_2>x_1$ 且 $y_2=y_1$ 或者

- $y_2>y_1$ 且 $x_2=x_1$。

对于每一片荷叶，我们知道其附近的苍蝇数量。Barika 可以吃掉所有在她荷叶附近的苍蝇。

Barica 每吃一只苍蝇会获得 $1$ 个单位的能量，每进行一次跳跃消耗 $K$ 个单位的能量。如果 Barica 没有足够的能量，她就不能进行跳跃。

Barica 想通过 $1$ 号植物到达 $N$ 号植物，并获得尽可能多的能量。Barica 开始时没有能量，必须通过吃掉 $1$ 号植物附近的苍蝇来获取能量。

找到使得 Barica 达到目标的一种可行路径。
## 输入格式

第一行，两个整数 $N$ 和 $K$。

接下来 $N$ 行，每行包含三个整数 $x_i$，$y_i$ 和 $z_i$，表示第 $i$ 号荷叶的坐标为 $(x_i,y_i)$，且其附近有 $z_i$ 只苍蝇。
## 输出格式

第一行，输出到达终点后能量单位数量。

第二行，输出一个整数 $L$，表示 Barica 需要经过的植物个数。必须包含 $1$ 号和 $N$ 号植物。

接下来 $L$ 行，依次输出 Barica 需要经过的植物坐标。
## 样例

### 样例输入 #1
```
6 5
1 1 5
2 1 5
1 2 4
2 3 5
3 2 30
3 3 5 
```
### 样例输出 #1
```
5
4
1 1
2 1
2 3
3 3 
```
### 样例输入 #2
```
8 10
1 1 15
2 2 30
1 2 8
2 1 7
3 2 8
2 3 7
4 2 100
3 3 15
```
### 样例输出 #2
```
36
5
1 1
1 2
2 2
3 2
3 3
```
### 样例输入 #3
```
9 5
5 5 10
6 5 2
7 5 1
5 6 2
6 6 6
7 6 2
5 7 1
6 7 2
7 7 1 
```
### 样例输出 #3
```
2
3
5 5
7 5
7 7 
```
## 提示

对于 $100\%$ 的数据，$2\le N\le 3\times 10^5$，$1\le K\le 1000$，$0\le x_i,y_i\le 10^5$，$0\le z_i\le 1000$。

输入数据保证有解，但不保证有唯一解。

本题分值按照原比赛设置，满分 $70$ 分。


---

---
title: "[COCI 2014/2015 #6] NEO"
layout: "post"
diff: 普及+/提高
pid: P7958
tag: ['2014', 'COCI（克罗地亚）']
---
# [COCI 2014/2015 #6] NEO
## 题目描述

一个矩阵 $A$ 是「YF 矩阵」当且仅当满足：

- $r,s>1$
- $A_{1,1}+A_{r,s}\le A_{1,s}+A_{r,1}$

$r,s$ 分别表示矩阵 $A$ 的行数和列数。

此外，如果一个矩阵的每个大小至少为 $2\times2$ 的子矩阵都是「YF 矩阵」，我们就说这个矩阵是「Sept 矩阵」。

给定一个矩阵 $A$，你需要求出 $A$ 的含有最多元素的是「Sept 矩阵」的子矩阵所含的元素数量。
## 输入格式

第一行两个整数 $R,S$，分别表示 $A$ 的行数和列数。

接下来 $R$ 行每行 $S$ 个整数，描述矩阵 $A$。
## 输出格式

仅一行，即 $A$ 的最大的是「Sept 矩阵」的子矩阵所含的元素数量。

若这样的子矩阵不存在，输出 $0$。
## 样例

### 样例输入 #1
```
3 3
1 4 10
5 2 6
11 1 3
```
### 样例输出 #1
```
9
```
### 样例输入 #2
```
3 3
1 3 1
2 1 2
1 1 1
```
### 样例输出 #2
```
4
```
### 样例输入 #3
```
5 6
1 1 4 0 3 3
4 4 9 7 11 13
-3 -1 4 2 8 11
1 5 9 5 9 10
4 8 10 5 8 8
```
### 样例输出 #3
```
15
```
## 提示

#### 样例 3 说明

最大的是「Sept 矩阵」的子矩阵的左上角与右下角坐标分别为 $(3,2),(5,6)$。

#### 数据规模与约定

- 对于 $60\%$ 的数据，有 $R,S\le 350$。
- 对于 $100\%$ 的数据，有 $2\le R,S\le 10^3$，$A_{i,j}\in[-10^6,10^6]$。

#### 说明

按原题配置，满分 140 分。

译自 **[COCI 2014-2015](https://hsin.hr/coci/archive/2014_2015/)** [Contest #6](https://hsin.hr/coci/archive/2014_2015/contest6_tasks.pdf) Task E _**NEO**_。


---

---
title: "[USACO21DEC] Bracelet Crossings G"
layout: "post"
diff: 普及+/提高
pid: P7989
tag: ['USACO', '2021', '分类讨论']
---
# [USACO21DEC] Bracelet Crossings G
## 题目描述

奶牛 Bessie 喜欢手工艺。在她的空闲时间，她制作了 $N$（$1\le N\le 50$）个手链，编号为 $1 \ldots N$。第 $i$ 个手链涂有颜色 $i$，是 $N$ 种不同的颜色之一。制作完手链后，Bessie 将它们放在桌子上进行展示（我们可以将其视为二维平面）。她精心布置这些手链，以满足以下三个条件：

- 每个手链是一个简单闭合折线——一组顶点（点）依次用线段连接，并且第一个点和最后一个点相同（欢迎查阅维基百科页面了解更多详情：[Polygonal_chain](https://en.wikipedia.org/wiki/Polygonal_chain)，或百度百科：[折线](https://baike.baidu.com/item/%E6%8A%98%E7%BA%BF/486302)），

- 没有手链与自身相交（这对应「简单」折线）；

- 以及没有两条手链相交。

不幸的是，就在 Bessie 如此小心翼翼地布置好手链之后，Farmer John 开着拖拉机经过，桌子晃动起来，导致手链四处移动甚至可能断成了多个（不一定是闭合的或简单的）折线！在那之后，Bessie 还是想检查以上三个条件是否仍然成立。然而，天色已暗，她现在无法看清手链。

幸好 Bessie 有一个手电筒。她选择了 $M$（$1\le M\le 50$）条垂直线 $x=1, x=2, \ldots, x=M$，并且对于每条线，她用手电筒的光沿着那条线从 $y=-\infty$ 扫至 $y=\infty$，按照出现的顺序记录她看到的所有手链的颜色。幸运的是，没有光束穿过任何折线的顶点或同时穿过两条线段。此外，对于每一束光，所有出现的颜色都恰好出现了两次。

你能帮助 Bessie 使用此信息来确定手链是否仍然满足上述所有三个条件吗？
## 输入格式

每个测试用例的输入包含 $T$ 个子测试用例（$1 \leq T \leq 50$），所有子测试用例必须全部回答正确才能通过整个测试用例。相邻的子测试用例之间用空行分隔。

输入的第一行包含 $T$。之后是 $T$ 个子测试用例。

每个子测试用例的第一行包含两个整数 $N$ 和 $M$。此后每个子测试用例还包含 $M$ 行。对 $1$ 到 $M$ 的每一个 $i$，第 $i$ 行包含一个整数 $k_i$（$0\le k_i\le 2N$，$k_i$ 为偶数），然后是 $k_i$ 个整数 $c_{i1}, c_{i2},\ldots, c_{ik_i}$（$c_{ij}\in [1,N]$，每个 $c_{ij}$ 出现零次或两次)。这表示当 Bessie 将手电筒从 $(i,-\infty)$ 扫至 $(i,\infty)$ 时，她按顺序 $c_{i1}, c_{i2},\ldots, c_{ik_i}$ 看到了这些颜色。

## 输出格式

对每个子测试用例，如果有可能使得以上三个条件均满足则输出 YES。否则，输出 NO。
## 样例

### 样例输入 #1
```
5

1 2
2 1 1
2 1 1

1 3
2 1 1
0
2 1 1

2 1
4 1 2 1 2

4 2
6 1 2 2 3 3 1
6 1 2 4 4 2 1

2 2
4 1 1 2 2
4 2 2 1 1
```
### 样例输出 #1
```
YES
NO
NO
YES
NO
```
## 提示

【样例解释】

对于第一个子测试用例，一组可行的手链位置为：

![](https://cdn.luogu.com.cn/upload/image_hosting/q3mohld2.png?x-oss-process=image/resize,m_lfit,h_170,w_225)

对于第四个子测试用例，一组可行的手链位置为：

![](https://cdn.luogu.com.cn/upload/image_hosting/8m2hcgbb.png?x-oss-process=image/resize,m_lfit,h_170,w_225)

【数据范围】

- 测试点 2 满足 $N = 1$。
- 测试点 3-5 满足 $N=2$。
- 测试点 6-8 满足 $M=1$。
- 测试点 9-14 满足 $M=2$。
- 测试点 15-20 没有额外限制。


---

---
title: "[COCI 2013/2014 #4] SUMO"
layout: "post"
diff: 普及+/提高
pid: P8014
tag: ['2013', 'COCI（克罗地亚）']
---
# [COCI 2013/2014 #4] SUMO
## 题目描述

有 $N$ 个选手参加 $M$ 场 $1$ 对 $1$ 的比赛，比赛顺序已经定好。

现在让你将这些选手分成 $2$ 队，使选手尽可能晚地碰到同队的选手。

输出最优方案下第一次有选手碰到同队的的选手的比赛序号。
## 输入格式

第一行，一个正整数 $N$，表示有 $N$ 个选手；

第二行，一个正整数 $M$，表示有 $M$ 场比赛；

接下来 $M$ 行，每行两个正整数 $A_i$ 和 $B_i$，表示序号为 $i$ 的比赛参与的选手是序号为 $A_i$ 和 $B_i$ 的两位选手。
## 输出格式

一行，一个正整数，表示最优分队方案下第一次有选手碰到同队的的选手的比赛序号。
## 样例

### 样例输入 #1
```
5
5
1 2
2 3
3 4
4 5
5 1
```
### 样例输出 #1
```
5
```
### 样例输入 #2
```
6
8
1 2
3 4
5 6
1 3
1 6
4 5
2 4
2 6

```
### 样例输出 #2
```
6
```
## 提示

**【样例解释 #1】**

$[1,3,5]$ 一队， $[2,4]$ 一队。

可以证明这是最优方案。

**【数据范围】**

对于 $100\%$ 的数据，$1\le A_i,B_i\le N\le 10^5$，$1\le M\le 3\times 10^5$。

**【来源】**

本题分值按 COCI 原题设置，满分 $100$。

题目译自 [COCI2013-2014 CONTEST #4](https://hsin.hr/coci/archive/2013_2014/contest4_tasks.pdf) _**T3 SUMO**_。


---

---
title: "[COCI 2013/2014 #4] GUMA"
layout: "post"
diff: 普及+/提高
pid: P8015
tag: ['2013', 'COCI（克罗地亚）']
---
# [COCI 2013/2014 #4] GUMA
## 题目描述

给出一个 $N+1$ 列的矩形，第 $i$ 列必须通过水平切割 $A_i-1$ 次被等分成 $A_i$ 份，请你求出最少需要几次切割才能按要求分割完。

$Tips:$ 一次切割一次可以在一个或多个不一定连续的列上进行分割。
## 输入格式

第一行，一个正整数 $N$，表示这个矩形有 $N+1$ 列；

接下来 $N+1$ 行，每行一个正整数 $A_i$，表示第 $i$ 列必须通过水平切割 $A_i-1$ 次被等分成 $A_i$ 份。
## 输出格式

一行，一个正整数，表示最小分割数。
## 样例

### 样例输入 #1
```
1
2
5
```
### 样例输出 #1
```
5
```
### 样例输入 #2
```
2
3
7
14
```
### 样例输出 #2
```
15
```
### 样例输入 #3
```
9
4
2
4
1
2
2
2
8
4
2 
```
### 样例输出 #3
```
7
```
## 提示

**【样例解释 #3】**

![](https://cdn.luogu.com.cn/upload/image_hosting/v45dq77p.png)

共 $7$ 次切割。

**【数据范围】**

对于 $20\%$ 的数据，$1\le N\le 100$；

对于 $100\%$ 的数据，$1\le N,A_i\le 10^5$。

**【来源】**

本题分值按 COCI 原题设置，满分 $120$。

题目译自 [COCI2013-2014 CONTEST #4](https://hsin.hr/coci/archive/2013_2014/contest4_tasks.pdf) _**T4 GUMA**_。


---

---
title: "[COCI 2015/2016 #7] Prosti"
layout: "post"
diff: 普及+/提高
pid: P8036
tag: ['2015', 'COCI（克罗地亚）']
---
# [COCI 2015/2016 #7] Prosti
## 题目描述

现有 $Q$ 组询问，每次给出正整数 $K,L,M$。定义全体高兴数的集合为 $\{x|x \le M$ 或 $x$ 为质数$\}$。

对于每次询问，求一个正整数 $i$，使得 $[i,i+K-1]$ 内恰好有 $L$ 个高兴数。如果不大于 $10^7$ 的 $i$ 值不存在，输出 $-1$。
## 输入格式

第一行，一个整数 $Q$。

接下来的 $Q$ 行，每行三个整数 $K_i,L_i,M_i$。
## 输出格式

输出 $Q$ 行，每行对应一次询问的答案。
## 样例

### 样例输入 #1
```
3
1 1 1
2 0 2
3 1 1
```
### 样例输出 #1
```
1
8
4
```
### 样例输入 #2
```
3
4 1 1
5 2 3
5 0 3
```
### 样例输出 #2
```
6
4
24
```
### 样例输入 #3
```
4
7 2 5
6 1 1
10 4 5
6 2 2
```
### 样例输出 #3
```
6
20
5
4
```
## 提示

**【数据规模与约定】**

- 对于 $100\%$ 的数据，$1 \le Q \le 10^5$，$1 \le K_i,M_i \le 150$，$0 \le L_i \le K_i$。

**【提示与说明】**

欢迎大家通过私信或发帖对自行编写的 [Special Judge](https://www.luogu.com.cn/paste/rj308p4r) 进行 hack。

**题目译自 [COCI 2015-2016](https://hsin.hr/coci/archive/2015_2016/) [#7](https://hsin.hr/coci/archive/2015_2016/contest7_tasks.pdf) _Task 5 Prosti_。**

**本题分值按 COCI 原题设置，满分 $140$。**


---

---
title: "[COCI 2010/2011 #5] DVONIZ（加强版）"
layout: "post"
diff: 普及+/提高
pid: P8049
tag: ['2010', 'O2优化', 'COCI（克罗地亚）']
---
# [COCI 2010/2011 #5] DVONIZ（加强版）
## 题目背景

题面与[原题P7635 [COCI2010-2011#5] DVONIZ](https://www.luogu.com.cn/problem/P7635)无异，仅有数据范围，时空限制与分值不同。
## 题目描述

当前 $K$ 个元素的和或最后 $K$ 个元素的和都不大于 $S$ 时，我们说这个 $2\times K$ 个元素的序列是有趣的。

给出一个长度为 $N$ 的序列 $A$。对于每个元素，输出从该元素开始的最长的有趣的子序列。
## 输入格式

第一行包含整数 $N$ 和 $S$。

下面的 $N$ 行，每行包含序列 $A$ 中的一个整数 $A_i$。这些整数都是正的且它们的和不超过 $2\times 10^9$。
## 输出格式

输出共 $N$ 行。第 $i$ 行包含一个整数，表示从第 $i$ 元素开始的最长的有趣的子序列的长度。

如果当前位置上没有有趣的子序列，输出 `0`。
## 样例

### 样例输入 #1
```
5 10000
1
1
1
1
1 
```
### 样例输出 #1
```
4
4
2
2
0 
```
### 样例输入 #2
```
5 9
1
1
10
1
9 
```
### 样例输出 #2
```
2
0
0
2
0 
```
### 样例输入 #3
```
8 3
1
1
1
1
1
1
1
1 
```
### 样例输出 #3
```
6
6
6
4
4
2
2
0 
```
## 提示

**【样例解释#1】**

对于样例 $1$ 的第一个位置，一共有 $4$ 个子序列，且都满足条件，故取最长的长度为 $4$ 的子序列。

**【数据范围】**

对于 $30\%$ 的数据，$2\le N \le 200$。

对于 $50\%$ 的数据，$2\le N \le 5 \times 10^3$。

对于 $70\%$ 的数据，$2 \le N \le 2 \times 10^5$。

对于 $100\%$ 的数据，$2\le N \le 3 \times 10^6$，$1\le S \le 10^9$，$1\le A_i \le 10^9$。


---

---
title: "[ZYOI Round1] Truth/真心话大冒险"
layout: "post"
diff: 普及+/提高
pid: P8052
tag: ['交互题', 'Special Judge', 'O2优化']
---
# [ZYOI Round1] Truth/真心话大冒险
## 题目背景

**注意：请勿恶意提交代码，浪费评测资源。**

一群人参加了聚会，在玩“真心话大冒险”。
## 题目描述

Charlie 现在盯上了一个人 Percy，Ta 打算找出 Percy 对于 $n$ 个异性的好感度的排名。  

具体地，Charlie 可以提出两种要求：  

1. 【真心话】给定 $3$ 个正整数 $x,y,z$，要求 Percy 回答其中他第二喜欢的异性的编号。要求：$1 \leq x,y,z \leq n$。

2. 【大冒险】给定 $2$ 个正整数 $x,y$，要求 Percy 拥抱其中他更喜欢的那个异性。要求：$1 \leq x,y \leq n$ 且必须保证异性 $x,y$ 之中必有一个是 Percy 最喜欢的。  

Charlie 希望通过至多 $2 \times 10^6$ 次询问达到他的目的。

**交互格式：**  

一开始读入一个正整数 $n$ 开始交互。

你可以输出 $3$ 种信息：  

1. `1 x y z`，表示“真心话”询问，并读入结果。
2. `2 x y`，表示“大冒险”询问，并读入结果。
3. `3 a1 a2 ... an`，表示你已经得出了答案，按顺序输出 Percy 最喜欢、第二喜欢、……的异性的编号。

## 输入格式

（见题目描述）
## 输出格式

（见题目描述）
## 样例

### 样例输入 #1
```
5

3

5
```
### 样例输出 #1
```

1 1 2 3

2 1 5

3 5 2 4 3 1
```
## 提示

**以上输入输出只是为了演示交互格式，可能并不符合逻辑**。

对于 $20\%$ 的数据，$1 \leq n \leq 10$。

对于 $40\%$ 的数据，$1 \leq n \leq 100$。 

对于 $60\%$ 的数据，$1 \leq n \leq 10^3$。 

对于 $80\%$ 的数据，$1 \leq n \leq 10^4$。

对于 $100\%$ 的数据，$1 \leq n \leq 2 \times 10^4$。  

注意输出不合法可能导致 WA/RE/TLE/MLE 等玄学问题。


---

---
title: "B Highbit & lowbit"
layout: "post"
diff: 普及+/提高
pid: P8055
tag: ['O2优化']
---
# B Highbit & lowbit
## 题目描述

定义一个正整数的 $\mathrm{highbit}$ 为该数在二进制表示下的最高二进制位的位值，如 $\mathrm{highbit}(22_{(10)})=\mathrm{highbit}(10110_{(2)})=10000_{(2)}=16_{(10)}$。

定义一个正整数的 $\mathrm{lowbit}$ 为该数在二进制表示下的最低非零二进制位的位值，如 $\mathrm{lowbit}(22_{(10)})=\mathrm{lowbit}(10110_{(2)})=10_{(2)}=2_{(10)}$。

再定义两种操作：

- 操作 $1$：将一个正整数 $x$ 变为 $x+\mathrm{lowbit}(x)$。
- 操作 $2$：将一个正整数 $x$ 变为 $x+\mathrm{highbit}(x)$。

现给定一个操作序列和 $q$ 次询问，每次询问包含 $3$ 个正整数 $l,r,x$，表示将 $x$ 从左到右依次执行 $l\sim r$ 的操作，请输出 $x$ 的值，由于答案可能很大，请输出答案对 $10^9+7$ 取模的值。
## 输入格式

第一行两个正整数 $n,q$。

接下来一行一个字符串 $s$，长度为 $n$，其中仅含有 `0`，`1`。

若第 $i$ 个字符为 `0`，则表示一个 $1$ 操作，即 $x=x+\mathrm{lowbit}(x)$。

若第 $i$ 个字符为 `1`，则表示一个 $2$ 操作，即 $x=x+\mathrm{highbit}(x)$。

之后 $q$ 行，每行 $3$ 个正整数 $l,r,x$，表示一次询问。
## 输出格式

对于每一个询问，输出一行一个数表示答案对 $10^9+7$ 取模的结果。
## 样例

### 样例输入 #1
```
8 8
01100001
1 2 3
1 4 9
2 6 9
3 8 9
6 8 2
8 8 3
5 8 6
2 8 17
```
### 样例输出 #1
```
8
36
40
64
16
5
64
144
```
## 提示

**【数据范围】**

**本题采用捆绑测试。**

对于所有测试点，满足 $1\leq n,q\leq 5\times 10^5$，$1\leq x<2^{30}$。详细数据范围如下：

- Subtask #1 (12 pts): $n,q\le 10$，$x\le 32767$。
- Subtask #2 (23 pts): $n,q\le 10^3$。
- Subtask #3 (11 pts): $n,q\leq 10^5$，字符串中仅含有 `1`。
- Subtask #4 (11 pts): $n,q\leq 10^5$，字符串中仅含有 `0`。
- Subtask #5 (6 pts): $n,q\leq 10^5$，保证每次询问的 $x$ 均可以表示为 $2^a$ 的形式，$a$ 为非负整数。
- Subtask #6 (15 pts): $n,q\leq 10^5$，保证每次询问的 $x$ 均可以表示为 $2^a+2^b$ 的形式，$a,b$ 均为非负整数。
- Subtask #7 (10 pts): $n,q\le 10^5$。
- Subtask #8 (12 pts): 没有任何附加限制。


---

---
title: "[COCI 2009/2010 #7] SVEMIR"
layout: "post"
diff: 普及+/提高
pid: P8074
tag: ['2009', 'COCI（克罗地亚）']
---
# [COCI 2009/2010 #7] SVEMIR
## 题目描述

太空帝国要通过建造隧道来联通它的 $N$ 个星球。

每个星球用三维坐标 $(x_i,y_i,z_i)$ 来表示，而在两个星球 $A,B$ 之间建造隧道的价格为 $\min\{|x_A-x_B|,|y_A-y_B|,|z_A-z_B|\}$。

现要建造 $N-1$ 条隧道使得所有的星球都能直接或间接相连。求完成该任务所需的最小总价。
## 输入格式

第一行，一个整数 $N$。

接下来的 $N$ 行，每行三个整数 $x_i,y_i,z_i$，表示第 $i$ 个星球的坐标。

数据保证不存在两个具有相同坐标的星球。
## 输出格式

输出所需的最小总价。
## 样例

### 样例输入 #1
```
2
1 5 10
7 8 2
```
### 样例输出 #1
```
3
```
### 样例输入 #2
```
3
-1 -1 -1
5 5 5
10 10 10
```
### 样例输出 #2
```
11
```
### 样例输入 #3
```
5
11 -15 -15
14 -5 -15
-1 -1 -5
10 -4 -1
19 -4 19
```
### 样例输出 #3
```
4
```
## 提示

**【数据规模与约定】**

- 对于 $100\%$ 的数据，$1 \le N \le 10^5$，$-10^9 \le x_i,y_i,z_i \le 10^9$。

**【提示与说明】**

**题目译自 [COCI 2009-2010](https://hsin.hr/coci/archive/2009_2010/) [CONTEST #7](https://hsin.hr/coci/archive/2009_2010/contest7_tasks.pdf) _Task 4 SVEMIR_。**

**本题分值按 COCI 原题设置，满分 $100$。**


---

---
title: "「LCOI2022」 Cow Merger"
layout: "post"
diff: 普及+/提高
pid: P8103
tag: ['2022', 'Special Judge']
---
# 「LCOI2022」 Cow Merger
## 题目背景

Bessie 来到她的新家之后，Farmer John 突然意识到自己农场的大小不够了！

所以，Farmer John 需要把所有的奶牛合并到一个牛棚里。
## 题目描述

Farmer John 的农场里本来有 $n$ 个牛棚，第 $i$ 个牛棚里住着 $a_i$ 只牛。

我们定义一次合并 $i,j(a_i\ge a_j)$ 两个牛棚的操作为：从 $i$ 号牛棚中拿出 $a_j$ 头牛，放入 $j$ 号牛棚中。如果在合并结束后 $a_i=0$，那么可以看做 $a_i$ 被合并了，接下来的操作也与 $a_i$ 无关。

由于时间不够了，他决定最多你 $1$ 秒的时间。
## 输入格式

第一行包含一个整数 $T$，表示数据组数。  

对于第 $t$ 组数据:

第 $2t$ 行包含一个整数 $n$。

第 $2t+1$ 行包含 $n$ 个整数，第 $i$ 个整数为 $a_i$。 
## 输出格式

对于每组数据：  

如果你发现自己不可能达到目标，输出 `NO`，否则输出 `YES`。

接下来一行，输出一个整数 $m$ 表示操作次数。

接下来 $m$ 行，每行输出两个数 $i$ 和 $j$（注意操作时应满足 $a_i \ge a_j$）。

**有多解时可输出任意一组解。**
## 样例

### 样例输入 #1
```
3
4
1 2 3 2
5
3 9 6 18 12
5
2 3 5 7 11
```
### 样例输出 #1
```
YES
4
3 1
1 2
3 4
2 4
YES
6
2 1
1 2
4 3
2 3
4 5
3 5
NO
```
## 提示

【数据范围与约定】

对于 $100\%$ 的数据，$1 \leq T \leq 5$，$1 \leq n \leq  10^5$，$0 \leq a_i \leq 10^9$。


---

---
title: "[ICPC 2020 WF] Opportunity Cost"
layout: "post"
diff: 普及+/提高
pid: P8134
tag: ['2020', 'O2优化', 'ICPC']
---
# [ICPC 2020 WF] Opportunity Cost
## 题目背景

ICPC2020 WF G
## 题目描述

As with most types of products, buying a new phone can be difficult.
One of the main challenges is that there are a lot of different
aspects of the phone that you might care about, such as its price, its
performance, and how user-friendly the phone is.
Typically, there will be no single phone that is simultaneously the
best at all of these things: the cheapest phone, the most powerful
phone, and the most user-friendly phone will likely be different phones.

Thus when buying a phone, you are forced to make some sacrifices by
balancing the different aspects you care about against each other and
choosing the phone that achieves the best compromise (where "best"
of course depends on what your priorities happen to be).  One way of
measuring this sacrifice is known as the *opportunity cost*,
which (for the purposes of this problem) we define as follows.

Suppose that you have bought a phone with price $x$, performance $y$,
and user-friendliness $z$. For simplicity, we assume that these three
values are measured on a comparable numeric scale where higher is
better. If there are $n$ available phones, and the values
$(x_i,y_i,z_i)$ represent the (price, performance, user-friendliness)
of the $i^{\text{th}}$ phone, then the opportunity cost of your phone
is defined as

$$\max _{1 \leq i \leq n}\left(\max \left(x_{i}-x, 0\right)+\max \left(y_{i}-y, 0\right)+\max \left(z_{i}-z, 0\right)\right)$$


Write a program that, given the list of available phones, finds a
phone with the minimum opportunity cost.
## 输入格式

The first line of input contains an integer $n$ ($2 \leq n \leq
200\,000$), the number of phones considered. Following that are $n$ lines.
The $i^{\text{th}}$ of these lines contains three integers $x_i$, $y_i$, and $z_i$,
where $x_i$ is the price, $y_i$ is the performance, and $z_i$ is the
user-friendliness of the $i^{\text{th}}$ phone ($1 \leq x_i, y_i, z_i \leq
10^9$).
## 输出格式

Output a single line containing two integers: the smallest possible
opportunity cost and an integer between $1$ and $n$ indicating the
phone achieving that opportunity cost. If there are multiple such
phones, output the one with the smallest index.

## 样例

### 样例输入 #1
```
4
20 5 5
5 20 5
5 5 20
10 10 10
```
### 样例输出 #1
```
10 4

```
### 样例输入 #2
```
4
15 15 5
5 15 15
15 5 15
10 10 10
```
### 样例输出 #2
```
10 1
```
## 题目翻译

与大多数类型的产品一样，购买一部新手机可能很困难。其中一个主要困难是，你可能会关心手机的许多不同方面，比如价格、性能以及手机的用户友好程度（**本题中仅考虑这三种因素**）。通常情况下，不会有一款手机同时在所有这些方面都是最好的，也就是说，最便宜的手机、功能最强大的手机和用户最友好的手机可能是不同的手机。因此，在购买手机时，你不得不做出一些牺牲，平衡彼此关心的不同方面，并选择实现最佳折衷的手机（当然，“最佳”取决于你的优先级）。衡量这种牺牲的一种方法称为**机会成本**（为了解决这个问题），我们将其定义如下：

某商店里一共有 $n$ 部手机，其中第 $i$ 部手机的价格为 $x_i$，性能为 $y_i$，用户友好程度为 $z_i$。假设你购买了一个价格为 $x$，性能为 $y$，用户友好程度为 $z$ 的一台手机，那么购买这台手机的机会成本用如下公式表示：

$$\max\limits_{1\leqslant i\leqslant n}(\max(x_i-x,0)+\max(y_i-y,0)+\max(z_i-z,0))$$

现在，请求出所有 $n$ 部手机的机会成本的最小值，并找到机会成本最小的**编号最小**的手机的编号。

数据范围：

- $2\leqslant n\leqslant 2\times 10^5$。
- $1\leqslant x_i,y_i,z_i\leqslant 10^9$。

Translated by Eason_AC


---

---
title: "[COCI 2012/2013 #2] POPUST"
layout: "post"
diff: 普及+/提高
pid: P8298
tag: ['2012', 'COCI（克罗地亚）']
---
# [COCI 2012/2013 #2] POPUST
## 题目背景

**本题分值按 COCI 原题设置，满分 $120$。**
## 题目描述

Mirko 像熊一样饥饿，发现了一家当地餐馆。这家餐厅提供 $N$ 顿饭，并且有一个有趣的定价政策：每顿饭都有两个指定价格，$A_i$ 和 $B_i$。Mirko 点的第一道菜只需要付 $A$ 元，其他菜都需要付 $B$ 元。

Mirko 无法决定点多少菜。为了更简单地作出决定，他向你求助。对于任意 $k\in[1,N]$，点 $k$ 道菜最少要付的钱。Mirko 不在乎他点了哪些特别的饭菜，也不管他点菜的顺序，但他不会点两道同样的菜。
## 输入格式

第一行一个正整数 $N\ (2\le N\le 5\times 10^5)$，表示菜品数量。

接下来 $N$ 行，每行两个正整数 $A_i,B_i\ (1\le A_i,B_i\le 10^9)$，题目已经描述。
## 输出格式

输出包含 $N$ 行，第 $k$ 行表示点 $k$ 道互不相同的菜最少需要花多少钱。
## 样例

### 样例输入 #1
```
3
10 5
9 3
10 5
```
### 样例输出 #1
```
9
13
18
```
### 样例输入 #2
```
2
100 1
1 100
```
### 样例输出 #2
```
1
2
```
### 样例输入 #3
```
5
1000000000 1000000000
1000000000 1000000000
1000000000 1000000000
1000000000 1000000000
1000000000 1000000000
```
### 样例输出 #3
```
1000000000
2000000000
3000000000
4000000000
5000000000
```
## 提示

#### 样例#1 解释/说明

- $k=1$: Mirko 开始点第 $2$ 道菜，共花费 $A_2=9$ 元。

- $k=2$: Mirko 开始点第 $1$ 道菜，接着点第 $2$ 道菜，共花费 $A_1+B_2=13$ 元。

- $k=3$: Mirko 开始点第 $1$ 道菜，接着点第 $2,3$ 道菜，共花费 $A_1+B_2+B_3=18$ 元。



---

---
title: "〈 TREEのOI 2022 Spring 〉Dimension-2 Square"
layout: "post"
diff: 普及+/提高
pid: P8309
tag: ['Special Judge', 'O2优化']
---
# 〈 TREEのOI 2022 Spring 〉Dimension-2 Square
## 题目背景

# 本题可能轻微卡精度，建议改用 $\tt long\ double$


正月十五夜空中。

一行人望着一棵树，一棵飘在天上的树，期待着它变成一个环。

这棵树有 $4$ 个节点。  

“它变成环了！”有人大喊。  
我顿时向天上望去……  

多么标准的正方形啊！无论哪个天文学家过来测量，它的角都是标准的 $90^{\circ}$，它的边都是完美的 $1:1:1:1$……  

只见那棵树，不，那标致而又完美的环，缓缓飞过，恰巧嵌在了那轮明月中心……

![](https://cdn.pixabay.com/photo/2016/11/29/13/14/full-moon-1869760_960_720.jpg)
## 题目描述

给定平面直角坐标系上 $4$ 个点的坐标。

你需要使用 ~~%法~~ 魔法，做一个正方形，使得这 $4$ 个点分别在正方形每条边的**直线**上。
## 输入格式

**本题采用多组数据评测。**

第一行，输入一个数 $T$，表示数据组数。

对于每组数据，共 $4$ 行，每行两个整数 $x_i,y_i$，表示点的坐标。
## 输出格式

对于每组数据，输出共 $4$ 行，每行两个实数，表示正方形上的四个点的坐标。你需要保证给出的第 $i$ 个点位于正方形的第 $i$ 个和第 $i\ \text{mod}\ 4+1 $ 个顶点形成的边上，且给出的第 $i$ 个点和第 $i\ \text{mod}\ 4+1$ 个点所在的边为邻边。
## 样例

### 样例输入 #1
```
1
235 423
544 345
563 645
453 435
```
### 样例输出 #1
```
380.43769007 531.90429895
395.56394564 543.23089701
406.89054360 528.10464158
391.76428803 516.77804352
```
## 提示

**本题采用 $\tt SPJ$。**

如答案不唯一，输出一种即可。   
四边长度的之差 $\le 10^{-2}$ 且相邻两边夹角在 $\frac{\pi}{2}\pm10^{-2}$ 内且设给定的点为 $(p,q)$，则存在一点 $(p,q+k)\ (|k|\leq1)$ 在对应边所在直线上即可 $\tt \green {AC}$。

对于 $30\%$ 的数据，$T=1,|x_i|,|y_i|\le10^3$。

对于 $70\%$ 的数据，$1\leq T\leq 5\times 10^4,|x_i|,|y_i|\le10^6$。

对于 $100\%$ 的数据，$1\leq T\leq 5\times 10^5,|x_i|,|y_i|\le10^9$。

数据保证任意两点连成的 $6$ 直线两两之间互不垂直，且没有平行于轴的直线，任意三点不共线。保证不存在一组解的边与轴平行。保证有解。

**为了数据的精确性，您输出时至少需要保留 $8$ 位小数。**


---

---
title: "『JROI-4』Sunset"
layout: "post"
diff: 普及+/提高
pid: P8320
tag: ['洛谷原创', '交互题', 'Special Judge', '洛谷月赛']
---
# 『JROI-4』Sunset
## 题目背景

写不出优美的文字，索性不放背景了。【背景待填充】

> 由于这只是个 C，出题人打算良心点，于是加了几个 $0$（指交互次数）（确信）——验题人注。
## 题目描述

**这是一道交互题。**

落日可以抽象成一个序列 $\{a_n\}$.

$\{a_n\}$ 是一个 $1\sim n$ 的排列。

你还有一个数列 $\{d_n\}$，为**当前** $a$ 数列的前缀最大值。

换言之，
$$d_i=\max_{j=1}^i \{a_j\}$$

注意：根据前文的定义，$\{d_n\}$ 可能随着 $\{a_n\}$ 数列的改变而改变。

您可以进行两种不同的操作：

- 指定一个 $i$，询问对于当前的 $a$ 数列， $d_{1\sim i}$ 中有几个不同的值。
- 指定一个 $i$，使得 $a_i\leftarrow 0$.

请使用不超过 $5500$ 次操作求出**原排列**。

**保证交互库是静态的，即交互库不会在交互过程中改变 $a$ 数列。**
## 输入格式

本题多测，第一行一个整数 $T$，表示测试组数，接下来 $T$ 行每行一个整数 $n$，表示本组数据下数列的长度。

本题使用 IO 交互模式。
### 交互格式
- `? 1 i` 询问 $d_{1\sim i}$ 中有几个不同的值，交互库会返回一个正整数 $x$ 表示答案。

- `? 2 i` 使 $a_i=0$。

- `! a1 a2 a3 ... an` 输出答案。

请注意：在每组数据中，请保证前两种操作的次数总和不超过 $5500$。

需要注意的是，在每一次操作后，需要调用以下函数刷新缓存：

- 对于 C/C++：`fflush(stdout);`
- 对于 C++：`std::cout << std::flush;`
- 对于 Java：`System.out.flush();`
- 对于 Python：`stdout.flush();`
- 对于 Pascal：`flush(output);`

对于其他语言，请自行查阅对应语言的帮助文档。
## 输出格式

见「交互格式」。
## 样例

### 样例输入 #1
```
1

3

1

2

3


2


```
### 样例输出 #1
```



? 1 1

? 1 2

? 1 3

? 2 2
? 1 3

! 1 2 3
```
## 提示

**样例仅供理解交互过程，可能不符合逻辑。**

【样例解释】

初始的序列 $a$ 为 `1 2 3`，$d$ 为 `1 2 3`.

在对交互库输出了形如 `? 2 2` 的命令后，序列 $a$ 变为 `1 0 3`，$d$ 变为 `1 1 3`，此时 $d_1\sim d_3$ 中有 $2$ 种不同的值，分别是 $1,3$.



------------


可供选手参考的资料：[OI Wiki-交互题](https://oi-wiki.org/contest/interaction/) **|** [猜数（IO交互版）
](https://www.luogu.com.cn/problem/P1733)



------------

## 数据范围
- 对于 $10\%$ 的数据，$T=1$；
- 对于 $30\%$ 的数据，$n\le 70$；
- 对于另外 $20\%$ 的数据，保证数列 $a$ 随机生成；
- 对于全部数据：$T \leq 10,1\leq n\leq 500$。


---

---
title: "[SNOI2022] 垃圾回收"
layout: "post"
diff: 普及+/提高
pid: P8359
tag: ['各省省选', '2022', 'O2优化', '陕西']
---
# [SNOI2022] 垃圾回收
## 题目描述

通常的情况下，编程语言在管理内存时进行如下的选择：

- 让用户进行手动内存管理（C、C++、Rust 等），这会收获很好的性能，但是给用户提供了很大的编程负担。
- 使用垃圾回收系统（Java、Go 等），这需要维护一个运行时系统，并且在内存使用和程序性能方面造成了许多不可预测的负担。

尽管存在许多的问题，目前最通用的自动化内存管理手段始终为 Tracing Garbage Collector。这种做法的最基础的思路是维护对象间的引用关系，形成一张图，每次回收时通过扫描引用关系推导出已经无法被访问到的对象，释放它们占用的内存。而这种传统的做法最大的问题在于维护引用链需要造成很大的开销，并且随着维护的对象越多，扫描的代价也会越大。

小 L 是一个喜欢思考的女孩子，她发现维护 Garbage Collector 是一件非常复杂的事情，于是她决定考虑一个更简单的模型（注意它与任何现实中的 GC 规则可能是完全不同的！）。


对于一个 $n$ 个点 $m$ 条边的无向图，没有重边自环，点和边均从 $1$ 开始标号。其中每个节点代表一个占用了一定内存的对象，每条边对应一个引用关系（注意这里的引用关系是**无向**的），程序从第 $0$ 秒开始运行，在第 $q + 1$ 秒结束运行。对于 $i = 1, 2, 3, \dots, q$ 的每个时刻 $i$ 发生以下两种操作之一：

- DELETE $i$，删除边 $(x_i,y_i)$，保证不会删除已经被删除的边。
- GC， 进行一次内存回收，即杀死所有从起点出发不能访问到的点，释放它们占用的内存。（注意这里对节点的删除不会删除与这些点相连的边）

你可以认为这些操作是被瞬间执行完成的，在所有操作执行后，也就是第 $q + 1$ 秒，程序结束，删除所有剩余的节点（包括 $1$ 号点）。

第 $i$ 个点占用的内存为 $a_i$，现在请你求出 $\sum_{i = 1}^{n} a_i \cdot \mathit{alive}_i$，这里 $\mathit{alive}_i$ 表示第 $i$ 个点存活的时间，在第 $0$ 秒，所有节点都是存活的。
## 输入格式

输入的第一行是三个正整数 $n, m, q$，分别表示对象的个数，引用关系的个数，操作的个数。

接下来的 $m$ 行每行两个正整数 $x_i, y_i$ 表示第 $i$ 条引用关系的两个端点。

接下来的 $q$ 行每行为以下两种形式之一，第 $i$ 行表示在第 $i$ 秒发生的操作：

- 字符串 DELETE 和正整数 $x$，含义见【题目描述】。
- 字符串 GC，含义见【题目描述】。

接下来的一行有 $n$ 个正整数 $a_1,a_2,\dots,a_n$，表示每个对象占用的内存大小。 
## 输出格式

输出一行一个整数表示答案，含义见【题目描述】。
## 样例

### 样例输入 #1
```
6 6 8
1 2
2 3
2 4
1 4
2 5
1 6
GC
DELETE 5
DELETE 3
GC
DELETE 1
GC
DELETE 2
GC
1 2 3 4 5 6

```
### 样例输出 #1
```
149

```
### 样例输入 #2
```
样例 2 见附件 garbage2.in
本组数据满足测试点 6 的限制。
```
### 样例输出 #2
```
样例 2 见附件 garbage2.ans
```
### 样例输入 #3
```
样例 3 见附件 garbage3.in
本组数据满足测试点 11 的限制。
```
### 样例输出 #3
```
样例 3 见附件 garbage3.ans
```
## 提示

**【样例 1 解释】**

在第 $4$ 秒时，节点 $5$ 被删除。

在第 $6$ 秒时，节点 $2, 3$ 被删除。

在第 $9$ 秒时，节点 $1, 4, 6$ 被删除。

答案即 $5 \times 4 + (2 + 3) \times 6 + (1 + 4 + 6) \times 9 = 20 + 30 + 99 = 149$。

**【数据规模与约定】**

对于全部数据，$1 \leq n, m, q \leq 4 \times 10^5$，$1 \leq a_i \leq 10^8$。

具体的数据规模与约定见下表。

| 测试点编号 | $n$ | $m$ | $q$ | 特殊限制 |
| :----------: | :----------: | :----------: | :----------: | :----------: |
| $1 \sim 2$ | $\leq 500$ | $\leq 500$ | $\leq 500$ |   |
| $3 \sim 5$ | $\leq 3000$ | $\leq 3000$ | $\leq 3000$ |  |
| $6 \sim 10$ | $\leq 5000$ | $\leq 5000$ | $\leq 5000$ |  |
| $11 \sim 14$ | $\leq 2 \times 10^5$ | $n-1$ | $\leq 2 \times 10^5$ | 保证一开始图是一棵树 |
| $15 \sim 16$ | $\leq 2 \times 10^5$ | $\leq 2 \times 10^5$ | $\leq 2 \times 10^5$ |  |
| $17 \sim 20$ | $\leq 4 \times 10^5$ | $\leq 4 \times 10^5$ | $\leq 4 \times 10^5$ |  |


---

---
title: "Two Operations"
layout: "post"
diff: 普及+/提高
pid: P8379
tag: ['洛谷原创', 'O2优化', '洛谷月赛']
---
# Two Operations
## 题目背景

**本题时限较小，请采用较快的读入方式，以下是出题人提供的快读模板：**

```cpp
typedef long long LL;
inline LL read(){
	register LL x=0,f=1;
	char c=getchar();
	while(c<'0'||c>'9'){
		if(c=='-') f=-1;
		c=getchar();
	}
	while(c>='0'&&c<='9') x=(x<<3)+(x<<1)+(c^48),c=getchar();
	return x*f;
}
```

当然你也可以采用自己的读入方法。
## 题目描述

在一次聚会上，一共有 $n$ 名学生，他们的编号分别为 $1,2,3,\cdots,n$，他们被分成 $k$ 组，组的编号分别为 $1,2,3,\ldots,k$。

小 V 老师负责组织这场聚会，在聚会的开始，第 $i$ 名学生被分到了第 $a_i$ 组，并拿到了 $b_i$ 颗糖果。（小 V 既不属于任何组别，也没有任何糖果。在接下来的活动中，小 V 作为组织者的身份。） 

这一次聚会一共有 $m$ 轮活动，对于每一轮活动，可能发生以下两种情况之一：

1.  `Change X Y`，表示把所有组别为 $X$ 的学生的组别改为 $Y$（修改后 $X$ 即为空组），并把组 $X$ **删除**。
2.  `Query`，表示小 V 想要知道，如果把**剩下**的组合并（定义见下） 成一大组，那么这一大组内**拥有最多糖果的学生的糖果数最少可能是多少**。

定义一个组 $G_i$ 的大小就是这个组内含有学生的个数，记为 $S_i$。

**合并**：将大小为 $S_1(S_1>0)$ 的组 $G_1$ 合并到大小为 $S_2(S_2>0)$ 的组 $G_2$，其中 $G_1$ 组内所有学生拥有糖果数之和为 $f$，则：

1. 第一步，将原先 $G_1$ 中所有学生的糖果数都变为 $0$，并将他们的组别改为 $G_2$。
2. 第二步，将目前 $G_2$ 中每位学生（包括原先 $G_1$ 中的学生）的糖果数加上 $\dfrac{f}{S_1+S_2}$（糖果数不一定为整数块）。

**注意：**

1. $G_1$ 合并到 $G_2$ 的最后结果可能会与 $G_2$ 合并到 $G_1$ 的最后结果不同。
2. `Query` 中的合并不会真实发生。即在这一次情况过后，所有学生的糖果数与所在组与此次操作未发生前一致。

请将每次 `Query` 中的答案对 $10^9+7$ 取模。（可能是分数取模，如果不知道如何取模请见**提示说明**）
## 输入格式

第一行三个整数 $n,m,k$。

第二行 $n$ 个整数 $a_{1\ldots n}$。

第三行 $n$ 个整数 $b_{1\ldots n}$。

接下来 $m$ 行，每行对应一种情况。具体格式参见题目描述或输入输出样例。
## 输出格式

输出若干行整数表示答案。
## 样例

### 样例输入 #1
```
3 3 2
1 1 2
3 4 5
Query
Change 2 1
Query
```
### 样例输出 #1
```
666666677
5
```
## 提示

【样例解释】

第一次 `Query` 时，将第二组合并到第一组，此时三名学生的糖果数分别为 $\dfrac{14}{3},\dfrac{17}{3},\dfrac{5}{3}$，糖果数最多的同学有 $\dfrac{17}{3}$ 块糖果，取到了最小值，对 $10^9+7$ 取模后为 $666666677$。

第二次 `Query` 时，所有学生都在同一组，而糖果数最多的同学有 $5$ 块糖果。

---

【数据范围】

| 数据点 | $n$  | $m$  | $k$  | $a_i$ | $b_i$  |
| -----------: | -----------: | -----------: | -----------: | -----------: | -----------: |
| $1$ | $\le 10$ |无特殊限制 | $\le 10$ | $\le 10$ | $\le 100$ |
| $2$ | $\le 100$ | $\le 10$ | $\le 100$ | $\le 100$ | $\le 100$ |
| $3$ | $\le 10^5$ | $=1$ | $\le 10^5$ | $\le 10^5$ | $\le 10^5$ |
| $4$ | $\le 10^5$ | 无特殊限制 | $=1$ | $=1$ | $\le10^5$ |
| $5$ | $\le 10^3$ |无特殊限制 | $\le 5$ | $\le 5$ | $\le 100$ |
| $6$ | $\le 10^4$ | $\le 10^3$ | $\le 10^4$ | $\le 10^4$ | $\le 10^5$ |
| $7$ | $\le 10^4$ | $\le 5\times10^3$ | $\le 10^4$ | $\le 10^4$ | $\le 10^5$ |
| $8$ | $\le 10^5$ | 无特殊限制 | $\le 10^5$ | $\le 10^5$ | $\le 10^5$ |
| $9 $| $\le 5\times10^5$ | 无特殊限制 | $5\times10^5$ | $5\times10^5$ | $\le 10^5$ |
| $10$ | $\le 10^6$ | 无特殊限制 | $\le 10^6$ | $\le 10^6$ | $\le 10^5$ |

对于 $100\%$ 的数据，满足 $1 \leq n \leq 10^6,\ 1\leq m \leq 2\times k-1,\ 1 \leq a_i\leq k \leq n,\ 1 \leq b_i \leq 10^5$。**数据保证合法，初始时每组是非空的。**


不熟悉有理数取模的请看[此处](/problem/solution/P2613)。



---

---
title: "[CCC 2022 J5] Square Pool"
layout: "post"
diff: 普及+/提高
pid: P8404
tag: ['2022', 'CCC（加拿大）']
---
# [CCC 2022 J5] Square Pool
## 题目描述

罗恩想在他的 $n\times n$ 的正方形院子里建一个正方形游泳池，但他的院子里有 $T$ 棵树。

你的任务是确定他可以建造的最大的方形游泳池的边长。
## 输入格式

第一行一个整数 $n$ ，具体意义见题目描述。

第二行一个整数 $T$ ，具体意义见题目描述。

接下来 $T$ 行，每行两个整数 $x,y$ ，表示在 $(x,y)$ 上有一棵树。
## 输出格式

一行，表示游泳池的最大边长。
## 样例

### 样例输入 #1
```
5
1
2 4
```
### 样例输出 #1
```
3
```
### 样例输入 #2
```
15
8
4 7
4 1
14 11
10 6
13 4
4 10
10 3
9 14
```
### 样例输出 #2
```
7
```
## 提示

样例 $1$ 解释：

![](https://cdn.luogu.com.cn/upload/image_hosting/c2b58ek8.png)

样例 $2$ 解释：

![](https://cdn.luogu.com.cn/upload/image_hosting/r7uoub7n.png)

对于 $20\%$ 的数据：$1\le n\le 50,T=1$

对于 $35\%$ 的数据：$1\le n\le 50,1\le T\le 10$

对于 $25\%$ 的数据：$1\le n\le 5\times 10^5,1\le T\le 10$

对于 $100\%$ 的数据：$1\le n\le 5\times 10^5,1\le T\le 100$


---

---
title: "[COCI 2021/2022 #6]  Naboj"
layout: "post"
diff: 普及+/提高
pid: P8405
tag: ['2021', 'COCI（克罗地亚）']
---
# [COCI 2021/2022 #6]  Naboj
## 题目描述

Šikić 先生是一位化学老师，他正在用 $n$ 个金属球和 $m$ 根铜导线做实验。他将一些对金属球用导线相连，使这些球（直接或间接地）与其他球都相连。他想要教学生关于电荷的知识，因此他将通过按顺序给金属球充电来演示它。

Šikić 先生可以让每个球带上正负电荷的一种。当一个金属球带负电荷时，与这个金属球相连的所有导线中的电子都将被排斥到与该导线相连的另一个金属球上。反过来，当一个金属球带正电荷时，与这个金属球相连的所有导线中的电子都将受这个金属球的吸引。无论导线的先前状态如何，给球充电对导线的影响都相同。

在刚上课的时候，所有的金属球都不带电，导线中的电子不动。对于每根导线，Šikić 先生都想让它其中电子的流向是某一个确定的方向。请帮他确定一个给金属球充电的顺序，使得最后电子的流向是他想要的。
## 输入格式

第一行两个数 $n$ 和 $m$，意义如题目描述。

接下来 $m$ 行每行两个整数 $a_i$ 和 $b_i$，表示金属球 $a_i$ 和 $b_i$ 之间有一根导线相连，并且这根导线中的电子应更靠近 $a_i$ 而不是 $b_i$。在一对金属球之间最多只有一条导线。所有的金属球都通过导线直接或间接相连。
## 输出格式

如果不可能让最后电子的流向是 Šikić 先生想要的，输出 $-1$。否则输出 $k$，表示需要充电的金属球数量。$k$ 必须小于等于 $200000$。

接下来 $k$ 行，每行输出两个整数 $c_i$ 和 $d_i(1 \leq c_i \leq n,0 \leq d_i \leq 1)$，分别表示第 $i$ 步 Šikić 先生需要充电的金属球的编号和是给这个金属球充正电荷（用 $d_i=1$ 表示）还是负电荷（用 $d_i=0$ 表示）。如果有多种方案，输出其中一种即可。
## 样例

### 样例输入 #1
```
3 3
1 2
2 3
1 3
```
### 样例输出 #1
```
3
2 1
3 0
1 1

```
### 样例输入 #2
```
4 3
1 2
3 2
2 4

```
### 样例输出 #2
```
4
2 1
4 0
3 1
1 1
```
### 样例输入 #3
```
5 10
2 4
3 4
1 4
4 5
3 2
2 1
5 2
1 3
5 3
1 5
```
### 样例输出 #3
```
-1
```
## 提示

### 样例解释 1：

首先，我们给金属球 $2$ 充正电荷。金属球 $1,2$ 和金属球 $2,3$ 之间的导线中的电子现在更靠近 $2$。金属球 $1,3$ 之间的导线仍保持中性。

现在我们给金属球 $3$ 充负电荷。金属球 $2,3$ 之间的导线状态不变，金属球 $1,3$ 之间的导线中的电子更靠近金属球 $1$。

最后我们给金属球 $1$ 冲正电荷。金属球 $1,3$ 之间的导线状态不变，但金属球 $1,2$ 之间的导线现在将更靠近金属球 $1$，目标流向达成。

### 数据范围：

对于全部数据，$1 \le n\le 200000$，$1\le m\le 500000$，$1 \le a_i,b_ i\le n,a_i\neq b_i$

本题分值与 [COCI 2021-2022#6](https://hsin.hr/coci/contest6_tasks.pdf) 分值相同，满分 $110$ 分


---

---
title: "射命丸文的取材之旅"
layout: "post"
diff: 普及+/提高
pid: P8445
tag: ['洛谷原创', '洛谷月赛']
---
# 射命丸文的取材之旅
## 题目背景

射命丸文（Syameimaru Aya）是一只鸦天狗。她不定期制作名为「文文。新闻」的报纸，而为此，她需要对她收集到的新闻进行剪裁。
## 题目描述

射命丸文现在收集到了 $2n$ 条新闻。她想要将其刊登于自己的报刊之上。然而，自己的报刊最多只能刊登 $n$ 条新闻。

为了能在 $n$ 条新闻的篇幅中让自己的报刊得到最大的吸引力，她将这 $2n$ 条新闻**等分**成**两份**，即每一份中均有 $n$ 条新闻。

每一条新闻自然有着其吸引力。在**第一份**中，第 $i$ 条新闻有着吸引力 $a_i$，而在**第二份**中，第 $i$ 条新闻有着吸引力 $b_i$。这两份新闻的划分在输入时已经给定。

现在射命丸文要从中选取新闻放入自己的报刊。报刊上的第 $i$ 条新闻，将选择**第一份**新闻的第 $i$ 条或**第二份**新闻的第 $i$ 条。这样，报刊上的新闻就可以构成一个长度为 $n$ 的序列，第 $i$ 项也就是第 $i$ 条新闻有着吸引力 $c_i \in \{a_i,b_i\}$。

而这样的一份报刊有着其综合影响力。根据射命丸文的经验，对于她这样的一份含有 $n$ 条新闻的报刊，其综合影响力为：

$$\max\{r-l+1-\operatorname{mex}\{c_l,c_{l+1},\dots, c_{r-1},c_r\}\}(1\le l\le r\le n)$$

其中 $\operatorname{mex}\{c_l,c_{l+1},\dots,c_{r-1},c_r\}$ 指的是 $c_l,c_{l+1},\dots,c_{r-1},c_r$ 中没有出现过的**最小非负整数**。

现在她希望知道，在进行这些操作之后，自己的报刊的**最大**的综合影响力会是多少呢？由于她还要继续取材，因此她把这个任务交付给了你。

【形式化题意】

给定序列 $\{a_n\},\{b_n\}$，求一个序列 $\{c_n\}$ 满足 $\forall i\in[1,n],c_i\in\{a_i,b_i\}$，最大化

$$\max\{r-l+1-\operatorname{mex}\{c_l,c_{l+1},\dots, c_{r-1},c_r\}\}(1\le l\le r\le n)$$

并输出该式子可能的最大值。
## 输入格式

第一行一个正整数 $n$，表示**每一份**新闻中的新闻条数。

第二行 $n$ 个**非负整数**表示第一份新闻中每一条新闻的吸引力，即 $a_1,a_2\dots ,a_{n-1},a_n$。

第三行 $n$ 个**非负整数**表示第二份新闻中每一条新闻的吸引力，即 $b_1,b_2\dots ,b_{n-1},b_n$。
## 输出格式

输出一个整数，表示报刊的**最大**的综合影响力会是多少。
## 样例

### 样例输入 #1
```
5
0 1 0 1 2
0 2 0 1 0
```
### 样例输出 #1
```
3
```
## 提示

**【样例解释和说明】**

射命丸文可以让自己的 $5$ 条新闻分别取第二份的第 $1$ 条，第一份的第 $2$ 条，第一份的第 $3$ 条，第一份的第 $4$ 条和第二份的第 $5$ 条。这样一来，她的报刊每条新闻的吸引力 $c_i$ 分别为 $0,1,0,1,0$。令 $l=1,r=5$，则 $\operatorname{mex}\{c_1,c_2,c_3,c_4,c_5\}=2$，$r-l+1-\operatorname{mex}\{c_1,c_2,c_3,c_4,c_5\}=3$，不难证明其为数列 $c$ 的综合影响力，也是**所有的可能的** $c$ 的最大综合影响力。

**【数据范围】**

对于 $20\%$ 的数据，满足 $1 \leq n\leq 10$。

另外 $40\%$ 的数据满足 $a_i=b_i$。

对于 $100\%$ 的数据，满足 $1 \leq n\le 10^6$，$0
\leq a_i,b_i\leq n$。


---

---
title: "虹色的北斗七星"
layout: "post"
diff: 普及+/提高
pid: P8446
tag: ['洛谷原创', '洛谷月赛']
---
# 虹色的北斗七星
## 题目背景

**【题目背景与题意无关，可以直接阅读题目描述】**

（本题目背景部分改编自真实案例）

宇佐见莲子是外界的一名大学生，在京都的一所大学中专攻超统一物理学，最近在做弦论方面的研究。

莲子与梅莉一同经营着名为秘封俱乐部的社团。进行着在科学世纪探寻遍布四处的结界的活动。

这个月梅莉和莲子又商量着去进行新一轮的探索与发现与贴贴，但是在两人手牵手出门的时候甜腻腻的气氛却被一通电话打破。

莲子因为经常外出探险，同时与梅莉增进感情交流，所以作业一拖再拖。她的物理学教授忍无可忍（毕竟莲子可是拖了一个学期的物理作业一个字都没有动呢），规定她必须在 $\sqrt9$ 天之内交上一篇学习报告，然后才同意给她的“课外实践活动”报备。

这可就没有办法了呢（笑），莲子只好先努力在 deadline 之前糊弄完她的学习报告，然后才能执行她们观赏夜空的计划。
## 题目描述

由于前两天都被莲子用来进行活动的筹备工作了，所以现在她只有几分钟的时间糊弄作业。尽管这样不太好，但是她别无选择，只能从之前的课堂笔记中摘取一段内容。

莲子的课堂笔记共有 $n$ 章，每章分别记着不同的内容。她可以选择其中任意连续的一段 $[l,r]$（表示选取了第 $l$ 章到第 $r$ 章）作为最终的成果。

每一章的内容各不相同，老师对每章内容有一个评价分 $a_i$。因为学习报告要体现出学生的进步，所以老师的满意度将会加上其中最差（$\min\{a_i\}$）和最好章节（$\max\{a_i\}$）的评价分差距。因为直接把冗长的课堂笔记作为报告提交显得太敷衍，所以每存在一章内容，老师的满意度就会 $-1$。

形式化地来说，如果莲子提交了 $[l,r]$ 这一段区间的笔记，老师的满意度将会是 $\max\{a_l,a_{l+1},\cdots,a_r\}-\min\{a_l,a_{l+1},\cdots,a_r\}-(r-l+1)$。

莲子希望你能帮她找出一种使得老师的满意度最大的方案。因为她非常聪明，所以只需要你告诉她这个最大的满意度，她就会知道应该怎么做。

**【形式化题意】**

你有一个长度为 $n$ 的序列 $a$，它的一个区间 $[l,r]$ 的价值是 $\max\{a_l,a_{l+1},\cdots,a_r\}-\min\{a_l,a_{l+1},\cdots,a_r\}-r+l-1$。求这个序列价值最大的子区间并输出这个价值。
## 输入格式

第一行输入一个正整数 $n$，表示笔记的章节数。

第二行输入评价分序列 $a$，以空格隔开每一个元素。
## 输出格式

输出这个评价分序列中，老师满意度最大的子区间的满意度。
## 样例

### 样例输入 #1
```
6
5 2 4 2 8 8
```
### 样例输出 #1
```
4
```
## 提示

**【样例解释和说明】**

令 $l=4,r=5$，则有 $\min\{a_4,a_5\}=2$，$\max\{a_4,a_5\}=8$，贡献值为 $4$。易证这是满意度最大的子区间。

**【数据范围】**

- 对于 $20\%$ 的数据，$n\leq 5\times 10^3$。
- 另有 $20\%$ 的数据，所有的 $a_i$ 都相等。
- 对于 $100\%$ 的数据，$1\le n\le 4\times10^6$，$1 \leq a_i \leq 10^9$。


---

---
title: "[LSOT-1] 逆序对"
layout: "post"
diff: 普及+/提高
pid: P8449
tag: []
---
# [LSOT-1] 逆序对
## 题目背景

逆序对真好玩
## 题目描述

你需要维护一个数列，支持以下 $4$ 种操作：

1. 区间交换；
2. 把一个区间**向后**移动到第 $k$ 个数字与第 $k+1$ 个数字之间；
3. 在最后插入一个数 $x$；
4. 在开头插入一个数 $x$。

每个数数的序号为新序列重新从第一个数到第 $k$ 个数编号为 $1$ 到 $k$。

现在每次操作过后，请你输出整个数列逆序对数量的奇偶性。
## 输入格式

第一行输入两个正整数 $n,m$，表示初始序列的长度与操作个数。

接下来一行输入 $n$ 个正整数 $a_1,a_2,\dots,a_n$，表示初始序列。

接下来 $m$ 行，每行先输入一个 $t$ 表示操作编号，之后：
- 若 $t=1$，则输入四个正整数 $l_1,r_1,l_2,r_2$，表示将区间 $[l_1,r_1]$ 与区间 $[l_2,r_2]$ 整体交换，保证 $l_1\le r_1< l_2\le r_2$；
- 若 $t=2$，则输入三个正整数 $l,r,k$，表示将区间 $[l,r]$ 移动至序列的第 $k$ 个数与第 $k+1$ 个数之间，保证 $r<k$；
- 若 $t=3$，则输入一个正整数 $x$，表示将 $x$ 插入到序列末端；
- 若 $t=4$，则输入一个正整数 $x$，表示将 $x$ 插入到序列首端。
## 输出格式

对于每一个指令执行后，如果逆序对数量是偶数，请输出 `even` ，否则输出 `odd`。
## 样例

### 样例输入 #1
```
6 4
4 3 5 7 2 6
1 1 1 2 2
2 1 1 3
3 11
4 1
```
### 样例输出 #1
```
odd
odd
odd
odd
```
## 提示

【样例解释】

第一次操作将区间 $[1,1]$ 和区间 $[2,2]$ 交换，序列变为 `3 4 5 7 2 6`。

第二次操作将区间 $[1,1]$ 移动到第 $3$ 和第 $4$ 个数中间。序列变为 `4 5 3 7 2 6`。

第三次操作在序列末端插入 $11$，序列变为 `4 5 3 7 2 6 11`。

第四次操作在序列开头插入 $1$，序列变为 `1 4 5 3 7 2 6 11`。

【数据范围】

**「本题采用捆绑测试」**

- $\texttt{Subtask 1(10 pts): }n,m\le 10^2$；
- $\texttt{Subtask 2(15 pts): }n,m\le 10^3$；
- $\texttt{Subtask 3(20 pts): }$没有一二操作；
- $\texttt{Subtask 4(20 pts): }$没有三四操作；
- $\texttt{Subtask 5(35 pts): }$无特殊限制。

对于 $100\%$ 的数据，$1\le n,m \le 2\times 10^5,a_i\le 2\times10^6$，保证在任意时刻 $a$ 中的数均互不相同。


---

---
title: "「REOI-p1」打捞"
layout: "post"
diff: 普及+/提高
pid: P8458
tag: []
---
# 「REOI-p1」打捞
## 题目背景

![](https://cdn.luogu.com.cn/upload/image_hosting/0ukve6wl.png)

出题人：XL4453

验题人：犇犇犇犇

文案：小糯米

upd：注意，先取模再取max
## 题目描述

“别介意，我和那些家伙都是打捞者。我们在头一次追寻梦想降落到地表时，就做好丧命的准备和赴死的觉悟了。”

葛力克一行人在一次打捞中，时来运转，获得了不少的宝藏。在归途之路，言及谁的功劳最大之时，大家却起了冲突。有人说自己的宝藏是史上绝无仅有，是在鬼门关前绕了一大圈才好不容易抢到的一个；有人说自己惨淡经营，虽然没有获得那么珍贵的宝物，但数量可观，也足以与之相提并论；也有人说自己的收获二者兼有，应当综合评价云云：总之，场面一片混乱，颇有生死与共的患难之交从此决裂的危险。

于是，大家把目光投到了葛力克的身上，这让他十分为难。思索良久，他决定这样来评价大家的贡献： 

假设一共有 $n$ 名打捞者，第 $i$ 位打捞者 $a_i$ 取得的宝物数量为 $l_i$ ，而其中第 $p$ 件宝物对应的价值则为 $a_{i,p}$ ，那么在计算的时候只需要将每个序列相加求和即可。但是葛力克并不满足于现状，他现在想知道，如果是将两个人的贡献放在一起看待，那么又将如何计算呢？
一番激烈的头脑风暴后，他决定这样来计算两位打捞者 $i,j$ 之间的贡献 $g(i,j)$ ：将 $a_i$ 与$a_j$ 分别复制数遍使得两堆宝物的数量都为 $k$ ，得到两个序列 $a_i',a_j'$ ，则 $g(i,j)= \sum\limits_{p=1}^k a'_{i,p}\times a'_{j,p}$ 。

现在葛力克想知道，这个贡献值的最大值是多少。

因为贡献值可能会很大，超出了正常生物大脑的运算能力，所以我们对它进行 $998244353$ 的取余。

----------
形式化题面：给定一个整数 $n$，和 $n$ 个序列，第 $i$ 个序列 $\{a_i\}$ 长度为 $l_i$，将每个 $a_i$ 复制 $\dfrac k{l_i}$ 遍得到 $\{a'_i\}$ 使得 $\{a'_i\}$ 的长度为 $k$。

试求：$\max\limits_{i=1,j=i+1}^{i,j\leq n}\{g(i,j)\bmod 998244353\}$，其中$g(i,j)= \sum\limits_{p=1}^k a'_{i,p}\times a'_{j,p}$ 。
## 输入格式

第一行两个整数 $n$，$k$。

接下来输入 $n$ 行。第 $i + 1$ 行第一个数为 $l_i$，接下来输入 $l_i$ 个数，表示打捞者的宝藏 $a_i$。

## 输出格式

一个整数，表示所求的最大值。
## 样例

### 样例输入 #1
```
2 12
3 2 3 4
4 1 2 3 4
```
### 样例输出 #1
```
90
```
### 样例输入 #2
```
3 999999924
4 4 4 5 3
7 1 9 1 9 8 1 0
6 1 1 4 5 1 4
```
### 样例输出 #2
```
599517664
```
## 提示

#### 样例解释 $#1$

$a_1'=2, 3, 4, 2, 3, 4, 2, 3, 4, 2, 3, 4$。  
$a_2'=1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4$。  
$g(1,2)=2\times1+3\times2+4\times3+2\times4+3\times1+4\times2+2\times3+3\times4+4\times1+2\times2+3\times3+4\times4=90$。

#### 样例解释 $#2$

$g(1,2)\bmod998244353=599517664$。  
$g(1,3)\bmod998244353=350889018$。  
$g(2,3)\bmod998244353=66930325$。  
$\max\limits_{1\leq i < j \leq n}\{g(i,j)\bmod998244353\}=599517664$。  

#### 数据范围

对于 $10\%$ 的数据，有 $n=2$。  
对于 $30\%$ 的数据，有 $k \leq 100$。  
对于 $60\%$ 的数据，所有 $l_i$ 两两互质，即 $\gcd(l_i,l_j)=1(1\leq i < j \leq n)$，$\gcd$ 为[最大公约数](https://oi-wiki.org/math/number-theory/gcd/)。  
对于 $100\%$ 的数据，有 $1\leq n\le 100，1\leq l_i\le 1000，1\leq k,a_{i,j}\le 10^{9}$ 且对于任意的 $i \in [1,n],l_i\mid k$。



---

---
title: "「REOI-1」深潜的第六兽"
layout: "post"
diff: 普及+/提高
pid: P8463
tag: ['洛谷原创', '洛谷月赛']
---
# 「REOI-1」深潜的第六兽
## 题目背景

“〈十七兽〉全都不会飞。因此，在它们毁灭大地以后，悬浮大陆群还能像这样浮在天空。

“可是，只有〈深潜的第六兽〉在本身留在大地的同时，还能对悬浮大陆群发动攻击。它有两种能力，『分裂增生』和『快速茁壮』。

“留在地表的本体会让身体分裂出几万个碎块，然后随风飞扬，等待碰巧飘流到某座悬浮岛。抵达岛上以后，它会当场发育茁壮，大约六到八小时过后就能占据并毁灭整座岛。”
## 题目描述

现在有一只〈第六兽〉，在某一次的「分裂增生」时分裂出了 $n$ 个碎块，这些碎块会笔直向上飞去，如果其中一块碎块遇到了一座浮空岛（为了研究方便，我们不妨将它当成一条二维空间中的线段处理），便会迅速占据它，并一分为二，再次从浮空岛的两端笔直向上飞去。

不过好在，那些只是一些无关紧要最为荒凉毫无人烟的岛屿，但如果就这样放任它们继续肆虐，势必会给那些至关重要的浮空岛带来毁灭性的打击。于是乎，负责清理〈第六兽〉的军官们，决定以他们所在的岛屿为直线建立 $x$ 轴，并以重力的方向为正方向建立 $y$ 轴，他们总共监测到了 $m$ 座浮空岛，并确定了那些碎块分裂出的位置（距离 $x$ 轴的位置视作无限远），于是他们想知道，如果放任这些碎块，那么当它们到达军官的位置时，最终会有多少碎块。

注意，若一座浮空岛的 $ l_i $ 与 $ r_i $ 相同，即为一个点， 〈第六兽〉占据后仍然会分裂成两只，从这个点向上飞去。

**提示：浮空岛作为实体显然不会重叠。**

**简要题意：**

在一个平面直角坐标系上有 $m$ 条平行于 x 轴的线段，第 $i$ 条线段为 $(l_i,h_i)$ 与 $(r_i,h_i)$ 的连线。特别注意 $l_i$ 可与 $r_i$ 相等，此时线段变为一个点。

在直线 $y=10^9$ 上有 $n$ 个点，分别位于 $(x_i,10^9)$。

现在，这些点逐渐向下（y轴负方向）移动。若触碰到线段，则会一分为二，分裂出的两个点分别从线段的两端继续向下移动。

特别地，若线段为一个点，则会原地分裂成 2 个。

问所有初始点在经历了线段的分裂后，在最后会有多少个点掉在 $ x $ 轴上
## 输入格式

第一行输入两个数 $ n $ 和 $ m $。

接下来 $ m $ 行，每行三个数 $ l_i $ , $ r_i $ , $ h_i $ ,分别描述一座被视作线段的浮空岛的左端点横坐标，右端点横坐标，以及线段的纵坐标（ $ 0 \leq l_i,r_i,h_i \leq 10^5，l_i \leq r_i$）。

接下来一行 $ n $ 个数，$ x_i $表示第 $ i $ 个碎块的横坐标（ $ 0 \leq x_i \leq 10^5 $）。

## 输出格式

输出一个整数 $ ans $ ，表示最后会有多少个碎块落在 $ x $ 轴上，答案对 $998244353$ 取模。
## 样例

### 样例输入 #1
```
2 2
1 3 2
2 6 1
3 5
```
### 样例输出 #1
```
5
```
## 提示

样例解释：

注意， $y$ 轴正方向为重力方向。
在坐标轴中，横坐标为 $x$ 的碎块，先掉到纵坐标为2的线段上，然后分成两个从 $1$ 和 $3$ 往下掉，$3$ 的那个掉到了纵坐标为1的线段上，分成两个从 $2$ 和 $6$ 往下掉，第一个碎块一共变成了 $3$ 块，分别掉在 $1，2，6$ ，第二个碎块一共变成了两个碎块，分别掉在 $2，6$。

| 子问题 | 特殊限制条件 | 分值 |
| :-----------: | :-----------: | :-----------: |
| 1 | $ 1\leq n,m \leq 10 $ | 10 |
| 2 | $ 1\leq n,m \leq 100 $ | 5 |
| 3 | $ 1\leq n\leq 10^4， 1\leq m \leq 5\times 10^5 $ | 35 |
| 4 |$ 1\leq n,m \leq 5\times 10^5 $|50|

本题各个子问题之间不捆绑测试。

对于 $100\%$ 的数据 $ 1\leq n,m \leq 5\times 10^5 $，所有数字均为非负整数。



---

---
title: "小挖的核燃料填充"
layout: "post"
diff: 普及+/提高
pid: P8549
tag: []
---
# 小挖的核燃料填充
## 题目描述

小挖做 Web 设计的时候，剧情里插入了酷炫的核填充情节！但很可惜，受制于技术，情节对应的游戏竟然是数独……

一开始，会给定你一个有 $n\times n$ 个**宫**，每个宫中有 $n \times n$ 个元素，且**早已全部正确填好**的 $n$ 阶数独。本题中数独游戏的详细表示与玩法见下方 **“补充说明”** 。

但小挖会把其中**一些宫向左或者向右转 90 度/180 度**。比如，若一个宫初始为

```cpp
087
654
321
```

那么它向左旋转 $90$ 度后会变成：

```cpp
741
852
063
```
你在恢复数独时，也**只能将一些宫向左转 $90$ 度**，一次旋转算作一步。现在小挖想考考你：如果把操作后的数独重新恢复成合法的数独，最少需要多少步呢？

如果一开始小挖给出的数独局面不可以通过任意次、任意位置的左旋得到，则输出 $-1$ 。~~为什么呢？因为小挖给出的是“自认为完全正确的”数独，但实际不一定。~~
## 输入格式

第 $1$ 行，输入一个正整数 $n$。

第 $2\sim n^2+1$ 行，每行输入 $n^2$ 个 $16$ 进制整数，表示一个给定的数独局面，表示小挖操作之后的游戏。
## 输出格式

第 $1$ 行输出一个整数，表示最小步数 $s$。

第 $2\sim s+1$ 行，每行输出两个整数 $x_i,y_i$。表示对行号列号为 $x_i,y_i$ 的宫向左旋转了 $90$ 度。

数据保证当存在解时，最优解方案唯一。输出时请按如下规则输出：

设 $i<j$ 表示输出方案时的第 $i,j$ 两步。则：

- $x_i\leq x_j$。
- 若 $x_i= x_j$ ，则 $y_i\leq y_j$。

若不存在合法方案，请输出 $-1$。
## 样例

### 样例输入 #1
```
3
701210842
832478367
564653501
386648785
457235610
021170423
410702257
327514806
685368341
```
### 样例输出 #1
```
12
1 1
1 1
1 2
1 3
2 1
2 2
2 3
2 3
3 1
3 1
3 3
3 3
```
### 样例输入 #2
```
4
36952EA1CF74857C
18E207C9B36D0419
4DAC56BF8209DFE2
B07FD3485AE1BA36
36B5B7CA6E5839FE
A4985620FD32A8B7
01CF94DF1B7C0564
7DE283E14A09C21D
B46D729D0F7246B0
8CF560154BCA159E
1327AB8459D8D278
EA09FC3E6E31A3CF
8E910623C5622B60
320BF7EDB847CDFE
45AF5A18310F183A
6CD7B9C4A9ED7459

```
### 样例输出 #2
```
17
1 1
1 1
1 2
1 2
1 3
1 3
1 4
2 2
2 3
2 4
3 1
3 2
3 2
3 3
4 1
4 2
4 4

```
## 提示

对于 $40\%$ 的数据，$2 \le n\leq 3$。

对于 $100\%$ 的数据，$2 \le n\leq 4$。

## Hint

$n$ 阶数独合法的条件：每一行、每一列、每一个粗线宫 $(n\times n)$ 内的数字均含 $0\sim  n^2-1$，且不重复。

需要注意的是，本题内对于 $4$ 阶数独的表示方式中 $>9$ 的数字采用了十六进制表示法。准确来说 $\mathrm A=10$，$\mathrm B=11$，$\mathrm C=12$，$\mathrm D=13$，$\mathrm E=14$，$\mathrm F=15$。



---

---
title: "Magenta Potion"
layout: "post"
diff: 普及+/提高
pid: P8563
tag: ['洛谷原创', 'O2优化', '洛谷月赛']
---
# Magenta Potion
## 题目描述

给定一个长为 $n$ 的整数序列 $a$，其中所有数的绝对值均大于等于 $2$。有 $q$ 次操作，格式如下：

$\texttt{1 i k}$，表示将 $a_i$ 修改为 $k$。保证 $k $ 的绝对值大于等于 $2$。

$\texttt{2 l r}$，考虑 $[l,r]$ 的子区间（包括本身）中乘积最大的的区间乘积 $M$。如果 $M>2^{30}$，输出 `Too large`，否则输出 $M$。特别地，空区间的元素乘积定义为 $1$。
## 输入格式

第一行两个正整数表示 $n,q$。

第二行输入 $n$ 个**整数**表示 $a_i$。

接下来 $q$ 行，每行三个整数表示一次询问，格式见上。
## 输出格式

对于每次 $\tt2$ 操作输出一行表示询问的答案。
## 样例

### 样例输入 #1
```
5 7
2 2 3 4 5
2 1 5
1 3 -3
2 1 5
2 3 3
1 1 100000
1 2 100000
2 1 2
```
### 样例输出 #1
```
240
20
1
Too large
```
## 提示

对于所有的数据，$2\le |a_i|,|k| \le 10^9$，$1 \le n,q \le 2\times 10^5$，$1 \le l \le r \le n$。

$$
\def{\arraystretch}{1.5}
\begin{array}{c|c|c}\hline 
\textbf{测试点编号}&\bm{~~~~~~~~n,q\le~~~~~~~~}&~~~~\textbf{特殊限制}~~~~\cr\hline 
\textsf1\sim \sf2 & 10& \cr\hline 
\sf3\sim 6 & 100&  \cr\hline 
\sf7\sim 10 & 5 \times 10^3&\cr\hline 
\sf 11\sim 13 &  &\sf A\cr\hline 
\sf14\sim 16 & & \sf B\cr\hline
\sf17\sim 20 & &\cr\hline
\end{array}
$$

$\textsf A$：保证 $a_i,k \ge 2$。

$\textsf B$：保证对于每一组询问，对应的 $r-l \ge 100$。




---

---
title: "「DTOI-2」星之影"
layout: "post"
diff: 普及+/提高
pid: P8574
tag: ['Special Judge', 'O2优化']
---
# 「DTOI-2」星之影
## 题目背景

>闻是白极影，见时方立竿。
## 题目描述

白极影化为立竿之人莅临人间，带来了星之函数 $f(x)$，它的值为最接近于 $\sqrt[4]x$ 的整数$\\$（即 $f(x)=\left\lfloor\sqrt[4]x+\dfrac12\right\rfloor$；$\lfloor u\rfloor$ 为对 $u$ 向下取整后的值）。

现有 $t$ 个数字 $n$，对于每个 $n$，立竿人想知道 $\sum\limits_{i=1}^n\dfrac1{f(i)}$ 的值是多少，请你告诉它吧。

---
~~因为立竿人很急，所以~~本题的 $t$ 组询问强制在线，后一个询问需通过前一个询问的答案生成。

可用以下 `C++` 代码生成（其他语言同理；需包含 `<stdio.h>`）：
```cpp
typedef long long ll;
char buf_ans[114];
ll next_n(double last_ans=0,ll get_n=0){
	//last_ans<n<=1e18
	sprintf(buf_ans,"%.6f",last_ans);
	for(ll i=0,x=0;;i++){
		if(buf_ans[i]=='.')return get_n^x;
		if(i&1)x*=10;
		else x=x*10+(buf_ans[i]^48);
	}
}
```
该函数第一个参数为上一次询问的答案（第一次询问时该值为 $0$，也就是说第一个数未经加密），第二个参数为这一次读入的被加密的数，函数返回解密后的 $n$。
## 输入格式



第一行一个整数 $t$，表示数据组数（询问次数）。

对于每组数据，仅一行一个整数表示加密后的 $n$（第一个 $n$ 未被加密）。
## 输出格式

每行输出一个六位小数，表示答案。
## 样例

### 样例输入 #1
```
7
1
5
12
95
2040
1145141920209
1070909051
```
### 样例输出 #1
```
1.000000
4.000000
6.500000
38.666667
403.857143
1475989956.412959
1.000000
```
## 提示

### 样例解释

样例#1 解密后各组询问分别是：
$$
\def{\r}{\cr\hline}
\def\arraystretch{1.5}\begin{array}{|c|c|c|c|c|c|c|c|}\hline
\textbf{t}&1&2&3&4&5&6&7\r
\textbf{n}&1&4&8&89&2022&1145141919810&1\r
\end{array}
$$
### 数据范围

**本题采用捆绑测试。**
$$
\def\arraystretch{1.5}\begin{array}{|c|c|c|c|}\hline
\textbf{Subtask} & t= & n\le&\bm{\textbf{Score}} \cr\hline
1 & 10&10^6 & 2 \cr\hline
2&1000&10^6&13\cr\hline
3&100&10^9&15\cr\hline
4 &1000&10^{18}&40\cr\hline
5 &%\text{No Special Constraints}
5\times10^5&10^{18}& 30 \cr\hline
\end{array}
$$

对于 $100\%$ 的数据，$10 \le t \le 5\times10^5$，$1 \le n \le 10^{18}$。

### 计分规则

本题采用 $\textbf{Special Judge}$，令你输出的答案为 $\text{pans}$，标答答案为 $\text{jans}$，如果 $\vert \text{pans}-\text{jans}\vert<\text{jans}\times10^{-5}$ 那么该组数据通过，在一个测试点内只有所有 $t$ 组数据通过该测试点才算通过。

注意后一个 $\text{Subtask}$ 对前一个 $\text{Subtask}$ 有依赖关系，即如果你没有在前一个 $\text{Subtask}$ 拿到分，那么你即使通过后一个 $\text{Subtask}$ 的所有测试点，你也无法拿到后面的分数。


---

---
title: "[蓝桥杯 2014 省 B] 小朋友排队"
layout: "post"
diff: 普及+/提高
pid: P8613
tag: ['2014', '蓝桥杯省赛']
---
# [蓝桥杯 2014 省 B] 小朋友排队
## 题目描述

$n$ 个小朋友站成一排。现在要把他们按身高从低到高的顺序排列，但是每次只能交换位置相邻的两个小朋友。

每个小朋友都有一个不高兴的程度。开始的时候，所有小朋友的不高兴程度都是 $0$。

如果某个小朋友第一次被要求交换，则他的不高兴程度增加 $1$，如果第二次要求他交换，则他的不高兴程度增加 $2$（即不高兴程度为 $3$），依次类推。当要求某个小朋友第 $k$ 次交换时，他的不高兴程度增加 $k$。

请问，要让所有小朋友按从低到高排队，他们的不高兴程度之和最小是多少。

如果有两个小朋友身高一样，则他们谁站在谁前面是没有关系的。
## 输入格式

输入的第一行包含一个整数 $n$，表示小朋友的个数。

第二行包含 $n$ 个整数 $H_1,H_2 \cdots H_n$，分别表示每个小朋友的身高。
## 输出格式

输出一行，包含一个整数，表示小朋友的不高兴程度和的最小值。
## 样例

### 样例输入 #1
```
3
3 2 1
```
### 样例输出 #1
```
9
```
## 提示

【样例说明】

首先交换身高为 $3$ 和 $2$ 的小朋友，再交换身高为 $3$ 和 $1$ 的小朋友，再交换身高为 $2$ 和 $1$ 的小朋友，每个小朋友的不高兴程度都是 $3$，总和为 $9$。

【数据规模与约定】

对于 $10\%$ 的数据，$1 \le n \le 10$；

对于 $30\%$ 的数据，$1 \le n \le 1000$；

对于 $50\%$ 的数据，$1 \le n \le 10000$；

对于 $100\%$ 的数据，$1 \le n \le 100000$，$0 \le H_i \le 1000000$。

时限 1 秒, 256M。蓝桥杯 2014 年第五届省赛


---

---
title: "[蓝桥杯 2014 国 B] Log 大侠"
layout: "post"
diff: 普及+/提高
pid: P8618
tag: ['2014', '蓝桥杯国赛']
---
# [蓝桥杯 2014 国 B] Log 大侠
## 题目描述

atm 参加了速算训练班，经过刻苦修炼，对以 $2$ 为底的对数算得飞快，人称 Log 大侠。

一天，Log 大侠的好友 drd 有一些整数序列需要变换，Log 大侠正好施展法力。

变换的规则是：对其某个子序列的每个整数变为 $[\log_2(x)+1]$ 其中 [] 表示向下取整，就是对每个数字求以 $2$ 为底的对数，然后取下整。

例如对序列 $3,4,2$ 操作一次后，这个序列会变成 $2,3,2$。

drd 需要知道，每次这样操作后，序列的和是多少。
## 输入格式

第一行两个正整数 $n,m$。

第二行 $n$ 个数，表示整数序列，都是正数。

接下来 $m$ 行，每行两个数 $L$，$R$ 表示 atm 这次操作的是区间 $[L,R]$，数列序号从 $1$ 开始。
## 输出格式

输出 $m$ 行，依次表示 atm 每做完一个操作后，整个序列的和。
## 样例

### 样例输入 #1
```
3 3
5 6 4
1 2
2 3
1 3
```
### 样例输出 #1
```
10
8
6
```
## 提示

对于 $30\%$ 的数据，$n,m \le 10^3$。

对于 $100\%$ 的数据，$n,m \le 10^5$。

时限 1 秒, 256M。蓝桥杯 2014 年第五届国赛

官方数据似乎有错。重造数据按照 $1 \leq a_i \leq 10^9$ 设计。


---

---
title: "[蓝桥杯 2021 省 B] 填空问题"
layout: "post"
diff: 普及+/提高
pid: P8741
tag: ['2021', '提交答案', '蓝桥杯省赛']
---
# [蓝桥杯 2021 省 B] 填空问题
## 题目描述


## 试题 A ：空间

### 【问题描述】

小蓝准备用 $256 \mathrm{MB}$ 的内存空间开一个数组，数组的每个元素都是 $32$  位二进制整数，如果不考虑程序占用的空间和维护内存需要的辅助空间，请问 $256 \mathrm{MB}$ 的空间可以存储多少个 $32$  位二进制整数?

### 【答案提交】

这是一道结果填空的题，你只需要算出结果后提交即可。本题的结果为一个整数，在提交答案时只填写这个整数，填写多余的内容将无法得分。

## 试题 B ：卡片

### 【问题描述】

小蓝有很多数字卡片，每张卡片上都是数字 $0$  到 $9$ 。

小蓝准备用这些卡片来拼一些数，他想从 $1$  开始拼出正整数，每拼一个，就保存起来，卡片就不能用来拼其它数了。

小蓝想知道自己能从 $1$  拼到多少。

例如，当小蓝有 $30$  张卡片，其中 $0$  到 $9$  各 $3$  张，则小蓝可以拼出 $1$  到 $10$ ，但是拼 $11$  时卡片 $1$  已经只有一张了，不够拼出 $11$ 。

现在小蓝手里有 $0$  到 $9$  的卡片各 $2021$  张，共 $20210$  张，请问小蓝可以从 $1$  拼到多少?

提示：建议使用计算机编程解决问题。

### 【答案提交】

这是一道结果填空的题，你只需要算出结果后提交即可。本题的结果为一个整数，在提交答案时只填写这个整数，填写多余的内容将无法得分。

## 试题 C ：直线

### 【问题描述】

在平面直角坐标系中，两点可以确定一条直线。如果有多点在一条直线上，那么这些点中任意两点确定的直线是同一条。

给定平面上 $2 \times 3$ 个整点 $\{(x,y) \mid 0 \leq x<2,0 \leq y<3,x \in \mathbb{Z},y \in \mathbb{Z}\}$，即横坐标是 $0$  到 $1$  (包含 $0$  和 $1$ ) 之间的整数、纵坐标是 $0$  到 $2$  (包含 $0$  和 $2$  ) 之间的整数的点。这些点一共确定了 $11$  条不同的直线。

给定平面上 $20 \times 21$ 个整点 $\{(x,y) \mid 0 \leq x<20,0 \leq y<21,x \in \mathbb{Z},y \in \mathbb{Z}\}$，即横坐标是 $0$  到 $19$  (包含 $0$  和 $19$ ) 之间的整数、纵坐标是 $0$  到 $20$  (包含 $0$  和 $20$ ) 之间的整数的点。请问这些点一共确定了多少条不同的直线。

### 【答案提交】

这是一道结果填空的题，你只需要算出结果后提交即可。本题的结果为一个整数，在提交答案时只填写这个整数，填写多余的内容将无法得分。

## 试题 D ：货物摆放

### 【问题描述】

小蓝有一个超大的仓库，可以摆放很多货物。

现在，小蓝有 $n$ 箱货物要摆放在仓库，每箱货物都是规则的正方体。小蓝规定了长、宽、高三个互相垂直的方向，每箱货物的边都必须严格平行于长、 宽、高。

小蓝希望所有的货物最终摆成一个大的立方体。即在长、宽、高的方向上分别堆 $L 、 W 、 H$ 的货物，满足 $n=L \times W \times H$。

给定 $n$，请问有多少种堆放货物的方案满足要求。

例如，当 $n=4$ 时，有以下 $6$  种方案：$1 \times 1 \times 4 、 1 \times 2 \times 2 、 1 \times 4 \times 1 、 2 \times 1 \times 2$ 、 $2 \times 2 \times 1 、 4 \times 1 \times 1$

请问，当 $n=2021041820210418$ (注意有 $16$  位数字) 时，总共有多少种方案?

提示：建议使用计算机编程解决问题。

### 【答案提交】

这是一道结果填空的题，你只需要算出结果后提交即可。本题的结果为一个整数，在提交答案时只填写这个整数，填写多余的内容将无法得分。

## 试题 E ：路径

### 【问题描述】

小蓝学习了最短路径之后特别高兴，他定义了一个特别的图，希望找到图中的最短路径。

小蓝的图由 $2021$  个结点组成，依次编号 $1$  至 $2021$ 。

对于两个不同的结点 $a,b$，如果 $a$ 和 $b$ 的差的绝对值大于 $21$ ，则两个结点之间没有边相连; 如果 $a$ 和 $b$ 的差的绝对值小于等于 $21$ ，则两个点之间有一条长度为 $a$ 和 $b$ 的最小公倍数的无向边相连。

例如：结点 $1$  和结点 $23$  之间没有边相连; 结点 $3$  和结点 $24$  之间有一条无向边，长度为 $24$  ; 结点 $15$  和结点 $25$  之间有一条无向边，长度为 $75$ 。

请计算，结点 $1$  和结点 $2021$  之间的最短路径长度是多少。

提示：建议使用计算机编程解决问题。

### 【答案提交】

这是一道结果填空的题，你只需要算出结果后提交即可。本题的结果为一个整数，在提交答案时只填写这个整数，填写多余的内容将无法得分。
## 输入格式

输入一个大写字母，表示第几个问题。
## 输出格式

根据所输入的问题编号，输出对应问题的答案。
## 提示

答题模板，可供参考。

```cpp
#include<iostream>
using namespace std;
int main() {
    string ans [] = {
        "The answer of task A", // 双引号中替换为 A 题的答案
        "The answer of task B", // 双引号中替换为 B 题的答案
        "The answer of task C", // 双引号中替换为 C 题的答案
        "The answer of task D", // 双引号中替换为 D 题的答案
        "The answer of task E", // 双引号中替换为 E 题的答案
    };
    char T;
    cin >> T;
    cout << ans[T - 'A'] << endl;
    return 0;
}
```


---

---
title: "成熟时追随原神"
layout: "post"
diff: 普及+/提高
pid: P8882
tag: ['O2优化']
---
# 成熟时追随原神
## 题目背景

可莉喜欢生活在树上。

![](https://img2.huashi6.com/images/resource/2021/04/29/8945867h9p0.jpg?imageMogr2/quality/100/interlace/1/thumbnail/700x)

画师 pid：4787895
## 题目描述

可莉生活在一颗有根树上，初始节点从 $1$ 到 $n$ 编号。为了方便可莉的出行，蒙德人决定从每个非叶子节点出发，修建一条新道路。具体而言，对与每个非叶子节点 $u$，蒙德人会从其子节点中均匀随机选取一个点 $v$，并在 $u$ 和 $v$ 之间修建一条新道路。显然，这些新修建的道路连成了许多的连通块。为了帮助他们的修建，你需要告诉蒙德人，连通块个数的期望是多少。

可莉听说这个任务后，认为它对于你而言太简单了。因此，她决定添加一些对于树的修改操作：

- $\text{Add}\ u$：在节点 $u$ 下添加一子结点，编号为 $n+i$，其中 $i$ 为操作编号。保证操作前结点 $u$ 存在。
- $\text{Del}\ u$：删除结点 $u$。保证操作前结点 $u$ 存在且为叶子结点。
- $\text{Upd}\ u$：将树根变为 $u$。保证操作前结点 $u$ 存在。

同时，对于任意时刻，保证树不会被删空。

对于初始的树和每次修改之后所得的树，你都需要回答一遍上述的问题。注意，$m$ 次修改之间不独立，但是蒙德人每次修建的新道路不受上一次结果的影响。
## 输入格式

第一行，一个整数 $n$，表示初始树的大小。

第二行至第 $n$ 行，每行输入一个整数，第 $i$ 行将给出 $f_i$，即初始树中 $i$ 的父节点。初始时，节点 $1$ 为树根。

第 $n+1$ 行，一个整数 $m$，表示修改操作个数。

第 $n+2$ 行至第 $n+m+1$ 行，每行输入一个修改操作，形式见 **题目描述**。
## 输出格式

输出共 $m+1$ 行。

第 $1$ 行，为初始时的答案。

第 $2$ 行至第 $m+1$ 行，第 $i$ 行应输出第 $i-1$ 次修改操作后的答案。

所有输出均对 $998244353$ 取模。具体而言，如果答案为 $\frac{p}{q}$，你应当输出一个满足 $xq\equiv p\pmod {998244353}$ 的 $x$。
## 样例

### 样例输入 #1
```
2
1
4
Add 1
Upd 2
Del 3
Del 1
```
### 样例输出 #1
```
1
2
1
1
1

```
## 提示

$$
\begin{array}{|c|c|c|c|}\hline
\textbf{测试点编号}& { n\le} & {m\le} & \textbf{特殊性质} \cr\hline
1\sim 3 & 5 & 5 & - \cr\hline
4\sim 7 & 1000 & 1000 &- \cr\hline
8\sim 10 & 10^5 & 0 & - \cr\hline
11\sim 13 & 10^5 & 2\times 10^5 & \textbf{AB}\cr\hline
14\sim 16 & 2\times 10^5 & 5\times 10^4 & \textbf{A} \cr\hline
17\sim 20 & 2\times 10^5 & 2\times 10^5 & - \cr\hline
\end{array}
$$

- 特殊性质 $\textbf{A}$：保证不存在 $\text{Upd}$ 操作。
- 特殊性质 $\textbf{B}$：保证不存在 $\text{Del}$ 操作。

对于 $100\%$ 的数据，$1\le n,m\le 2\times 10^5$。保证 $1\le f_i<i$。


---

---
title: "[入门赛 #7] 打 ACM 最快乐的就是滚榜读队名了 (Hard Version)"
layout: "post"
diff: 普及+/提高
pid: P8890
tag: ['2022', 'O2优化', '语言月赛']
---
# [入门赛 #7] 打 ACM 最快乐的就是滚榜读队名了 (Hard Version)
## 题目背景

**本题的题意与 [I1](https://www.luogu.com.cn/problem/B3692) 完全相同，区别仅在 $m$ 和 $K$ 的范围。**

在刚刚结束的 ICPC 杭州赛站上，某 E 经历了刺激的滚榜。她发现打 ACM 最快乐的就是滚榜读队名了。
## 题目描述

一场 ICPC 正式赛共 $5$ 小时。

队伍的排名由通过题数与罚时决定。通过题数更多的队伍排名更靠前，若通过题数相同，则罚时更小的队伍排名更靠前。通过题数与罚时均相同的队伍排名相同。本题中可能出现队伍排名相同的情况，此时，认为先出现在提交记录中的队伍排名靠前。

罚时是由通过题目的时间和未通过提交的次数决定的。罚时为每一道题通过时比赛开始的分钟数之和，加上该题之前未通过提交的次数乘 $20$ 分钟得到的。例如，某队在比赛进行 $1:28:35$ 时通过了 G 题，在此之前共有 $3$ 次未通过的提交，则 G 题对罚时的总贡献为 $88+3 \times 20=148$ 分钟。

**需要注意的是，仅有通过的试题的未通过提交会被计算罚时**。例如，某队在 I 题共有 $14$ 次未通过的提交，但到比赛结束，该队都没有通过 I 题，则这 $14$ 次未通过的提交不会被计算罚时。**在某一题通过后，该队对这一题的任何提交（无论是否能够通过）都不会影响本题通过的结果和本题的罚时。**

选手在比赛过程中可以随时提交某一道试题的代码，代码将被立即评测并返回结果（$\texttt{Accepted}$，$\texttt{Time Limit Exceeded}$，$\texttt{Memory Limit Exceeded}$，$\texttt{Presentation Error}$，$\texttt{Wrong Answer}$，$\texttt{Runtime Error}$）。其中，评测结果 $\texttt{Accepted}$ 为通过，其他评测结果均为不通过。

在比赛进行的前四小时（$0:00:00 \sim 4:00:00$），每支队伍的提交均会在排行榜上反映出来。比赛的最后一小时（$4:00:01 \sim 5:00:00$），排行榜将被冻结（封榜），所有的提交在排行榜对应队伍对应试题上均显示为待判题（提交的队伍知道评测结果）。

在比赛结束后，会进行紧张刺激的滚榜环节。滚榜嘉宾将按照封榜时的排行榜，依照从最后一名到第一名，**先读出队伍队名**，再按照从 A 题依次到最后一题的顺序，公布排行榜上该队“待判题”状态试题最终是否通过。

如果通过，所有队伍的排名将立即重新计算，显然，已经滚榜完成（被滚榜嘉宾念过队名，且所有待判题状态的结果都已经揭晓）的队伍排名不会有影响。若该队伍排名上升，则滚榜嘉宾立即开始下一支队伍的滚榜。因此，一支队伍的队名可能被滚榜嘉宾多次读出。

例如，某队队名为“囤题”，在前四小时没有通过任何一题，封榜时排在最后一名。在封榜后，该队连续通过全部十三道题目。那么滚榜嘉宾有可能读到该队队名七八次。当然，当该队上升到第一名后，其排名不会再发生变化，即使揭晓的判题结果为通过，但其排名没有发生变化，滚榜嘉宾不会再次读出其队名。

现在给出某场 ICPC 完整的提交记录，请你依次输出滚榜嘉宾念出的队名。

**一次提交记录都没有的队伍不会在排行榜上出现，也不会在滚榜中被念到队名。**
## 输入格式

输入的第一行为三个整数 $n,m,K$，依次为该场 ICPC 试题数、该场 ICPC 队伍数、该场 ICPC 提交记录数。

接下来 $K$ 行，每行为四个空格分隔的字符串，表达一条提交记录。第一个形如 $x:yy:zz$，代表该记录在比赛开始 $x$ 小时 $yy$ 分钟 $zz$ 秒时提交。第二个字符串为一个大写英文字母，代表试题的编号（$\texttt{A,B,} \cdots$）。第三个字符串为队名，保证队名不含空格。第四个字符串（可能含有空格，但为仅出现「题目描述」中的六种评测结果）为该评测记录的评测结果，具体字符串的含义见试题描述部分。
## 输出格式

输出若干行，为该滚榜嘉宾依次读到的队名。
## 样例

### 样例输入 #1
```
2 2 4
0:00:01 A abc Wrong Answer
0:00:02 A abc Accepted
0:19:38 A bcd Accepted
4:18:22 B abc Accepted
```
### 样例输出 #1
```
abc
bcd
abc

```
## 提示

### 样例解释

在封榜前，队伍 $\texttt{abc}$ 仅通过 $\texttt{A}$ 题，且在第二秒的第一次正确提交之前有一次错误提交，因此罚时为 $20$ 分钟；队伍 $\texttt{bcd}$ 同样仅通过 $\texttt{A}$ 题，且在 $0:19:38$ 的第一次正确提交之前没有错误提交，因此罚时为 $19$ 分钟。

在封榜后，队伍 $\texttt{abc}$ 通过了 $\texttt{B}$ 题。

在滚榜环节开始，由于封榜后的提交未被揭晓，因此暂时认为队伍 $\texttt{abc}$ 与 $\texttt{bcd}$ 均只通过一题，且前者罚时较大，排名靠后。

依照从最后一名到第一名的原则，队伍 $\texttt{abc}$ 的名字先被念到，并揭晓其在封榜后的提交的结果。其通过了 $\texttt{B}$ 题，因此其通过题数被更新为 $2$，罚时同样被更新。同时，所有队伍的排名立即被重新计算。由于此时 $\texttt{abc}$ 通过题目数量大于 $\texttt{bcd}$，因此其排名重新计算为第一名，而 $\texttt{bcd}$ 成为最后一名第二名。

这之后，队伍 $\texttt{bcd}$ 的名字被念到，由于其在封榜后没有提交，因此这时所有队伍的排名没有变化，滚榜嘉宾会进行其上一名队伍的滚榜。

最后，队伍 $\texttt{abc}$ 的名字被念到，滚榜结束。

需要注意的是，在滚榜过程中是逐题揭晓提交。也就是说，如果一支队伍封榜后通过了多道题，在其进行滚榜过程中，只要按照从 $\texttt{A}$ 题依次到最后一题的顺序，该队第一个“待判题”状态试题通过，后面的“待判题”同样暂时不会揭晓，而是立刻进行排名更新过程以及可能存在的更换另一支队伍进行滚榜的过程。

### 数据规模与约定

对于 $100\%$ 的数据，$1 \le n \le 20$，$1 \le m \le 2 \times 10^5$，$1 \le K \le 2 \times 10^6$，$0 \leq x \leq 5$，$00 \leq yy < 60$，$00 \leq zz < 60$，且当 $x = 5$ 时保证 $yy = zz = 00$。

保证提交记录按照提交时间不降序给出，即先给出的提交记录提交时间不会晚于后给出的提交记录的提交时间，试题名称为大写字母 $\texttt{A} \sim \texttt{Z}$，队名均为长度不超过 $50$ 的由小写字母组成的字符串，评测状态为试题中所给的 $6$ 种之一。


---

---
title: "[RC-06] Minimum and Maximum"
layout: "post"
diff: 普及+/提高
pid: P8911
tag: ['O2优化']
---
# [RC-06] Minimum and Maximum
## 题目背景

受洛谷限制，本题数据有所删减。评测全套数据请到 [InfOJ](http://119.27.163.117/contest/7/)。
## 题目描述

给定长度为 $n$ 的序列 $[a_1,a_2,\dots ,a_n]$。

$m$ 次询问，每次给出四个正整数 $L_1,R_1,L_2,R_2\ (1\le L_1\le R_1\le 4000,1\le L_2\le R_2\le 4000)$，问有多少个区间 $[l,r]\ (1\le l\le r\le n)$ 满足 $a_l,a_{l+1},\dots,a_r$ 中的最大值属于 $[L_1,R_1]$、最小值属于 $[L_2,R_2]$。

询问次数很大，所以询问是在程序内生成的。请自行阅读提示说明一栏的代码。
## 输入格式

第一行两个正整数 $n,m$。

接下来一行 $n$ 个正整数 $a_1\sim a_n$。

接下来一行三个正整数 $p,q,seed$，为数据生成器的参数。你不需要理解数据生成器具体的运行过程，你只需要知道，如果正确生成了询问的话，一定有 $L_1,R_1,L_2,R_2\in [p,q]$。
## 输出格式

设第 $i$ 个询问的答案为 $ans_i$。输出一行一个整数，为 $\operatorname{xor}_{i=1}^q 
(i\times ans_i)$ 的值。
## 样例

### 样例输入 #1
```
5 5
2 4 1 3 5
1 5 1145141919810
```
### 样例输出 #1
```
24
```
### 样例输入 #2
```
10 20000000
1 3 4 10 5 5 2 7 10 7
1 10 23333333333333333
```
### 样例输出 #2
```
548722417
```
## 提示

**样例 1 解释**

五次询问的 $(L_1,R_1,L_2,R_2)$ 分别为 $(1,5,1,5),(1,2,2,4),(3,4,2,2),(2,4,2,2),(2,5,2,5)$，答案分别为 $15,1,1,2,6$。

输出 $(1\times 15)\ \mathrm{xor}\ (2\times 1)\ \mathrm{xor}\ (3\times 1)\ \mathrm{xor}\ (4\times 2)\ \mathrm{xor}\ (5\times 6)=24$。

**样例程序**

下面是我们提供的样例程序，你可以直接以其为基础编写你的程序。

```cpp
#include<bits/stdc++.h>
using namespace std;
typedef long long ll;
namespace Generator{
typedef unsigned long long ull;
typedef __uint128_t L;
ull seed;
int p,q;
struct FastMod {
    ull b, m;
    FastMod(ull b) : b(b), m(ull((L(1) << 64) / b)) {}
    ull reduce(ull a) {
        ull q = (ull)((L(m) * a) >> 64);
        ull r = a - q * b; // can be proven that 0 <= r < 2*b
        return r >= b ? r - b : r;
    }
}F(2);
void init(){
	cin>>p>>q>>seed;//读入 p,q,seed 
	assert(p!=q);
	F=FastMod(q-p+1);
}
unsigned long long rd () {
	seed ^= (seed << 13);
	seed ^= (seed >> 7);
	seed ^= (seed << 17);
	return seed;
}
void getlr(int &l1,int &r1,int &l2,int &r2){
	//将 l1,r1,l2,r2 作为参数传入，即可得到一组询问 
	l1=F.reduce(rd())+p;
	r1=F.reduce(rd())+p;
	l2=F.reduce(rd())+p;
	r2=F.reduce(rd())+p;
	if(l1>r1)swap(l1,r1);
	if(l2>r2)swap(l2,r2);
}

}
int n,m,a[100005];
int main(){
	scanf("%d%d",&n,&m);
	for(int i=1;i<=n;i++)scanf("%d",&a[i]);
	Generator::init();
	long long xorsum=0;
	for(int i=1,l1,r1,l2,r2;i<=m;i++){
		Generator::getlr(l1,r1,l2,r2);
		long long ans=/*ans保存你的答案*/;
		xorsum^=ans*i;
	}
	cout<<xorsum;
}
```

**数据范围**

本题有四个子任务。子任务一时间限制 $0.5$ 秒，其它子任务时间限制 $5$ 秒。

所有数据均满足：$1\le n\le 10^5$，$1\le m\le 2\times 10^7$，$1\le a_i\le 4000$，$1\le p\lt q\le 4000$，$0\le seed\lt 2^{64}$。

- 子任务 $1$（$5$ 分）：$n,m,a_i,q\le 10$。
- 子任务 $2$（$20$ 分）：$n\le 10^4$。
- 子任务 $3$（$20$ 分）：$a_i,q\le 10$。
- 子任务 $4$（$55$ 分）：无特殊限制。


---

---
title: "[RC-06] ijk"
layout: "post"
diff: 普及+/提高
pid: P8912
tag: ['O2优化']
---
# [RC-06] ijk
## 题目描述

给定一个序列 $[a_1,a_2,a_3,\dots,a_n]$，保证 $\forall i\in [2,n], a_i\ge a_{i-1}$。

计算有多少整数三元组 $(i,j,k)$ 满足：

- $1\le i,j,k\le n$。
- $a_i\times j\times a_k=i+a_j+k$。
## 输入格式

第一行一个正整数 $n$。

第二行 $n$ 个正整数 $a_1,a_2,\dots,a_n$。保证 $a_i\ge a_{i-1}$。
## 输出格式

输出一行一个非负整数，为答案。
## 样例

### 样例输入 #1
```
5
2 3 3 4 5
```
### 样例输出 #1
```
3
```
### 样例输入 #2
```
10
1 1 2 2 3 3 4 4 5 8
```
### 样例输出 #2
```
25
```
## 提示

本题有三个子任务。

所有数据均满足：$1\le n\le 10^6$，$1\le a_i\le 10^6$，$a_i\ge a_{i-1}$。

- 子任务 $1$（$5$ 分）：$n\le 500$。
- 子任务 $2$（$5$ 分）：$a_i\le 10 $。
- 子任务 $3$（$90$ 分）：无特殊限制。


---

---
title: "[RC-06] Remake"
layout: "post"
diff: 普及+/提高
pid: P8913
tag: ['Special Judge', 'O2优化']
---
# [RC-06] Remake
## 题目描述

请你构造 $n$ 个正整数 $a_1\sim a_n$ 满足：

- $\forall X\in [L,R]$ 且 $X$ 是偶数，$\exists b_1\sim b_n$，使得 $\forall 1\le i\le n,b_i\in \{-1,1\}$ 且 $\sum _{1\le i\le n} a_ib_i=X$。$L,R$ 的值见数据范围。
- 设 $cnt_i$ 为满足 $a_j=i$ 的 $j$ 的个数，则 $cnt_i$ 要么等于 $0$，要么大于等于 $2$。
- $1\le n\le 40$。

为了验证你的 $a_i$ 确实满足条件，会给出 $Q$ 组询问，每次询问偶数 $X \in [L,R]$，请你输出一组合法的 $b_i$。
## 输入格式

第一行两个正整数 $M,Q$，$M$ 表示 $X$ 的上界。在测试数据中，保证 $M=10^9$。

接下来 $Q$ 行，每行一个正偶数 $X$。保证 $X\in [L,R]$。

注意 $L,R$ 并不会在输入中给出，你可以认为 $L=\min X,R=\max X$。
## 输出格式

第一行输出你构造的正整数个数 $n$。$(1\le n\le 40)$

接下来一行 $n$ 个正整数 $a_1\sim a_n$。$(1\le a_i\le 10^9)$

接下来 $Q$ 行，每行 $n$ 个字符，每个字符是 `+` 或 `-`。设第 $i$ 个字符为 $s_i$，设本次询问的值为 $X$，则需要满足 $\sum _{1\le i\le n} a_i([s_i=$ `+` $]-[s_i=$ `-` $])=X$，其中 $[P]$ 在 $P$ 成立时等于 $1$，否则等于 $0$。

你输出的 $a_i$ 需要满足题面中的要求。
## 样例

### 样例输入 #1
```
6 3
2
4
6
```
### 样例输出 #1
```
8
1 1 1 1 1 1 1 1
++-+-++-
++-++++-
++-+++++
```
## 提示

本题有三个子任务。

所有数据均满足：$2\le M\le 10^9$，$1\le Q\le 10^5$，$X\in [L,R]$。

- 子任务 $1$（$25$ 分）：$L=2$，$R=2\times 10^5$。
- 子任务 $2$（$5$ 分）：$L=10^9-2\times 10^5+2$，$R=10^9$。
- 子任务 $3$（$70$ 分）：$L=2$，$R=M$。


---

---
title: "「CGOI-3」巫泡弹弹乐"
layout: "post"
diff: 普及+/提高
pid: P8957
tag: ['洛谷原创', 'Special Judge', 'O2优化', 'Ad-hoc']
---
# 「CGOI-3」巫泡弹弹乐
## 题目背景

mc 正在挑战弹弹乐。

![](https://cdn.luogu.com.cn/upload/image_hosting/yaye0cgu.png)
## 题目描述

弹弹乐由 $n$ 个弹力菇组成，每个弹力菇有 $a,b$ 两个属性。

对于弹力菇 $i$ 会向弹力菇 $j$ 连一条边权为 $\max(a_i,a_j)+\max(b_i,b_j)$ 的双向弹力通道。现在 mc 想知道弹力菇组成的图的最小生成树，以便他打破记录。
## 输入格式

第一行一个整数 $n$。

第二行 $n$ 个整数，第 $i$ 个数表示 $a_i$。

第三行 $n$ 个整数，第 $i$ 个数表示 $b_i$。
## 输出格式

第一行输出这个最小生成树的边权和。

接下来 $n-1$ 行，每行输出两个整数表示一条树边。你可以输出任意一种合法方案。
## 样例

### 样例输入 #1
```
3
1 2 1
3 2 3
```
### 样例输出 #1
```
9
1 2
1 3
```
## 提示

#### 数据范围

**「本题采用捆绑测试」**

$$\def{\arraystretch}{1.5}\begin{array}{|c|c|c|c|}\hline
\textbf{Subtask} & \bm{n} & \textbf{特殊性质} & \textbf{分值}\cr\hline
1 & n\le 500 & \text{无} & 20 \cr\hline
2 & n\le 5\times 10^4 & \text{无} & 20\cr\hline
3 & \text{无特殊限制} & \text{数据随机} & 20\cr\hline
4 & \text{无特殊限制} & \text{无} & 40 \cr\hline
\end{array}$$

- 对于 $100\%$ 的数据，满足：$1\le n\le 10^6$，$1\le a_i,b_i\le 10^9$。


---

---
title: "[CEOI 2022] Homework"
layout: "post"
diff: 普及+/提高
pid: P8997
tag: ['2022', 'CEOI（中欧）']
---
# [CEOI 2022] Homework
## 题目描述

这是 Helena 的数学作业中的一道题：

我们定义合法表达式如下：

- `?` 是合法表达式，这表示一个未知数。
- 如果 $A,B$ 均为合法表达式，那么 `min(`$A$`,`$B$`)` 和 `max(`$A$`,`$B$`)` 均为合法表达式，这分别表示取左右两边的最大值/最小值。

设 `?` 的个数为 $N$，现在给出一个合法表达式，将每一个问号替换为 $1\sim N$ 中的任意一个数并且每一个数不能使用多次，可以得到多少种不同的答案？

可怜的 Helena 并不会做，请你帮帮她。
## 输入格式

仅一行一个字符串表示给出的合法表达式。
## 输出格式

输出一个整数，表示不同答案的个数。
## 样例

### 样例输入 #1
```
min(min(?,?),min(?,?))
```
### 样例输出 #1
```
1
```
### 样例输入 #2
```
max(?,max(?,min(?,?)))
```
### 样例输出 #2
```
2
```
### 样例输入 #3
```
min(max(?,?),min(?,max(?,?)))
```
### 样例输出 #3
```
3
```
## 提示

### 样例 1 解释

无论权值如何选择，最后的答案都会是 $\min\{1,2,3,4\}$，也就是 $1$。

### 样例 2 解释

答案为 $4$ 的方案是： `4=max(4,max(3,min(2,1)))`，答案为 $3$ 的方案是 `3=max(3,max(2,min(1,4)))`，可以证明答案不可能为 $1$ 或 $2$。

### 数据规模与约定

对于全部数据，$2\le N\le 10^6$。

| Subtask 编号 |                                   特殊限制                                   | 得分 |
| :----------: | :--------------------------------------------------------------------------: | :--: |
|     $1$      |                                   $N\le 9$                                   | $10$ |
|     $2$      |                                  $N\le 16$                                   | $13$ |
|     $3$      | 对于任意 `min(`$A$`,`$B$`)` 与 `max(`$A$`,`$B$`)`，$A$ 和 $B$ 中有一个为 `?`。 | $13$ |
|     $4$      |                                 $N\le 10^3$                                  | $30$ |
|     $5$      |                                  无特殊限制                                   | $34$ |


---

---
title: "[RC-07] 心跳"
layout: "post"
diff: 普及+/提高
pid: P9002
tag: ['O2优化']
---
# [RC-07] 心跳
## 题目描述

对正整数 $x$，设 $f(x,B)$ 表示 $x$ 在 $B$ 进制下的数位和。说一个正整数 $p$ 是 $B$-好的，当且仅当对于任意正整数 $q<p$ 都有 $f(p,B)\ge f(q,B)$。

给定正整数 $n$ 和 $B$，计算有多少个 $\le n$ 的正整数是 $B$-好的。
## 输入格式

本题单个测试点内有多组数据。



第一行是数据组数 $T$。

接下来 $T$ 行，每行两个正整数 $n,B$。
## 输出格式

输出 $T$ 行，每行一个非负整数，为答案。
## 样例

### 样例输入 #1
```
6
4 2
9 3
1000 2
1000 20
28238934 154154154154154
23389348458425 5
```
### 样例输出 #1
```
3
6
49
60
28238934
760
```
## 提示

**样例解释**

这里只解释第二组询问的输出。三进制下，$1,2,3,4,5,6,7,8,9$ 的数位和分别为 $1,2,1,2,3,2,3,4,1$，据此容易看出只有 $1,2,4,5,7,8$ 是 $3$-好的，所以输出 $6$。

**数据范围**

所有数据均满足：$1\le T\le 10^5$，$1\le n\le 10^{18}$，$2\le B\le 10^{18}$。

- 子任务 $1$（$50$ 分）：$T\le 10^4$，$n,B\le 100$。
- 子任务 $2$（$30$ 分）：$B=2$。
- 子任务 $3$（$20$ 分）：无特殊限制。


---

---
title: "[COCI 2022/2023 #1]  Čokolade"
layout: "post"
diff: 普及+/提高
pid: P9029
tag: ['2022', 'COCI（克罗地亚）']
---
# [COCI 2022/2023 #1]  Čokolade
## 题目背景

Lana 和 Fran 正在参观一家巧克力工厂，现在他们想买些巧克力。
## 题目描述

巧克力工厂里有 $n$ 块不同的巧克力，其中第 $i$ 块的价格为 $c_i$。Lana 和 Fran 想买 $m$ 块巧克力。

Fran 有一个消费方案：

•如果巧克力价格低于 $k$ 元，这块巧克力的费用将全部由 Lana 支付。

•否则，Lana 将支付 $k$ 元，而 Fran 将支付其余的部分，即 $c_i−k$ 元。

Lana 对 Fran 的方案不满意，想要报复 Fran。设 $l$ 为 Lana 需要支付的金额，$f$ 为 Fran 需要支付的金额。Lana 将选择使 $l−f$ 的值最小的购买方案。

由于 Fran 还在犹豫，不知道要买多少巧克力，所以 Lana 想知道对于给出的 $q$ 种不同的购买方案 $k_i$ 和 $m_i$，每种方案 $l−f$ 的最小值。
## 输入格式

第一行包含两个整数 $n$ 和 $q$，分别表示巧克力的数量和询问数量。

第二行包含 $n$ 个整数 $c_i$，依次表示每块巧克力的价格。

接下来 $q$ 行，每行包含两个整数 $k_i$ 和 $m_i$，分别表示 Fran 的付款阈值和购买的巧克力总数量。
## 输出格式

输出 $q$ 行，每行一个整数表示 Lana 询问的答案。
## 样例

### 样例输入 #1
```
5 2
1 9 22 10 19
18 4
5 2
```
### 样例输出 #1
```
34
-21
```
### 样例输入 #2
```
7 4
1 5 4 3 7 11 9
5 4
5 7
7 3
4 5
```
### 样例输出 #2
```
4
16
7
1
```
### 样例输入 #3
```
3 3
5 6 7
10 1
5 3
3 3
```
### 样例输出 #3
```
5
12
0
```
## 提示

| 子任务 | 分值 | 特殊性质 |
| :----------: | :----------: | :----------: |
| $1$ | $15$ | $n,q \leq 1000,c_i,k_i\leq 10^6$ |
| $2$ | $20$ | 所有询问的 $k$ 都相等 |
| $3$ | $35$ | 无特殊性质 |

对于 $100\%$ 的数据，$1\leq m_i\leq n,q\leq 10^5,1\leq c_i,k_i \leq 10^9$。

本题满分 $70$ 分。


---

---
title: "[PA 2021] Butelki"
layout: "post"
diff: 普及+/提高
pid: P9038
tag: ['2021', 'PA（波兰）']
---
# [PA 2021] Butelki
## 题目描述

Byteasar 有三瓶橙汁。他现在想通过把橙汁从一个瓶子倒入另一个瓶子的方式，让其中一个瓶子恰好装有 $k$ 升橙汁。因为他家里没有量筒，所以唯一允许的操作是在两个瓶子之间转移橙汁——要么把一个瓶子倒空，要么把一个瓶子倒满。橙汁不能撒到地上，也不能在这三个瓶子之外添加橙汁。

Byteasar 现在想知道，对于每一个 $k$，最少需要转移多少次橙汁才能让三个瓶子中的一个装有恰好 $k$ 升橙汁。他希望你帮帮他。
## 输入格式

第一行，三个整数 $A, B, C$，表示第一、二、三个瓶子的容积；

第二行，三个整数 $a, b, c$，表示第一、二、三个瓶子中最初装的橙汁体积。
## 输出格式

一行，$C + 1$ 个整数，其中第 $i$ 个整数在存在一种操作方式使得让三个瓶子中的一个装有 $i - 1$ 升橙汁时为最小操作次数，否则为 $-1$。
## 样例

### 样例输入 #1
```
2 7 9
1 3 6
```
### 样例输出 #1
```
1 0 1 0 1 1 0 1 2 1
```
## 提示

对于 $100\%$ 的数据，$1 \leq A \leq B \leq C \leq 10^5$，$0 \leq a \leq A$，$0 \leq b \leq B$，$0 \leq c \leq C$。


---

---
title: "[PA 2021] Zbalansowane słowa"
layout: "post"
diff: 普及+/提高
pid: P9043
tag: ['2021', 'PA（波兰）']
---
# [PA 2021] Zbalansowane słowa
## 题目描述

定义一个字符串 $s$ 是好的，当且仅当它包含的所有字符出现次数相同。

好的字符串例如：`mama`、`aabbcbcccbaa`。

不好的字符串例如：`ovo`。

给定一个字符串 $s$，求出 $s$ 好的**子串**数量。
## 输入格式

一行，一个字符串 $s$。
## 输出格式

一行，一个整数，表示所求的值。
## 样例

### 样例输入 #1
```
aabbabcccba
```
### 样例输出 #1
```
28
```
## 提示

对于 $100\%$ 的数据，$1 \leq |s| \leq 3 \times 10^5$，$s$ 中只含 `a`、`b`、`c` 三个小写字母。


---

---
title: "[PA 2021] Mopadulo"
layout: "post"
diff: 普及+/提高
pid: P9049
tag: ['2021', 'PA（波兰）']
---
# [PA 2021] Mopadulo
## 题目描述

给定一个长度为 $n$ 的序列 $a$，求有多少种方案可以将 $a$ 划分成若干个区间，使得每段区间所有数的和模 $10^9 + 7$ 的结果为偶数。

由于结果可能很大，你只需要求出结果对 $10^9 + 7$ 取模的值。
## 输入格式

第一行，一个整数 $n$；

第二行，$n$ 个整数 $a_1, a_2, \cdots, a_n$。
## 输出格式

一行，一个整数，表示所求的值。
## 样例

### 样例输入 #1
```
4
1000000006 1 5 1000000004
```
### 样例输出 #1
```
3
```
## 提示

#### 样例 #1 解释
三种划分方式如下：

- $[1, 4]$
- $[1, 2], [3, 4]$
- $[1], [2, 3], [4]$
#### 数据范围
对于 $100\%$ 的数据，$1 \leq n \leq 3 \times 10^5$，$0 \leq a_i < 10^9 + 7$。


---

---
title: "[PA 2021] Ranking sklepów internetowych"
layout: "post"
diff: 普及+/提高
pid: P9053
tag: ['2021', 'PA（波兰）']
---
# [PA 2021] Ranking sklepów internetowych
## 题目描述

给定长为 $n$ 的**排列** $a$。

定义区间 $[l, r]$ 的权值如下：将区间内的数从小到大排序，设 $x$ 为区间长度（即 $r - l + 1$），$y$ 为区间中位数，则该区间的权值为 $x + 2y$。

求所有 $\frac{n(n + 1)}{2}$ 个区间中权值的最大值和最大值的个数。

------------

中位数的定义：

以一个长为 $n$ 的**单调递增**的序列 $a$ 为例。

- 当 $n$ 为奇数，中位数为 $a_{\frac{n + 1}{2}}$。
- 当 $n$ 为偶数，中位数为 $\frac{a_{\frac{n}{2}} + a_{\frac{n}{2} + 1}}{2}$。
## 输入格式

第一行，一个整数 $n$；

第二行，$n$ 个整数 $a_1, a_2, \cdots, a_n$。
## 输出格式

一行，两个整数，表示权值的最大值和最大值的个数。
## 样例

### 样例输入 #1
```
5
1 4 3 5 2
```
### 样例输出 #1
```
11 5
```
## 提示

对于 $100\%$ 的数据，$1 \leq n \leq 10^6$，$1 \leq a_i \leq n$。


---

---
title: "[yLOI2023] 云梦谣"
layout: "post"
diff: 普及+/提高
pid: P9065
tag: ['2023', 'O2优化', '洛谷月赛']
---
# [yLOI2023] 云梦谣
## 题目背景

> 归来且做云梦梦一场 大梦好  
> 栽花闻酒香 醒醒醉醉笑笑  
> 天地偌大复路远山高 最难得偷半日逍遥  
> 偶尔糊涂不问世事不知晓

——银临 & 慕寒《云梦谣》
## 题目描述

“喂，枸杞，你这只笨狗，又偷吃！看我不收拾你！”

朵一气呼呼地从院子里跑出来，手中握着掸子，而枸杞早已不见踪影。

云梦庭可以看作一个 $n$ 行 $m$ 列的方格阵，第 $i$ 行第 $j$ 列的格子被记作 $(i,j)$。每个格子 $(i,j)$ 要么有一个高度 $h_{i,j}$（$h_{i,j}$ 为正整数），要么是障碍物，不能通过。（方便起见，约定障碍物的 $h_{i,j}$ 用 $0$ 表示。）另外，云梦庭上有 $k$ 个指定的格子上可以进行**御剑飞行**。开始时，朵一和枸杞分别位于方格 $(1,1)$ 和 $(n,m)$。

朵一的御剑飞行还不是很熟练，现在她还控制不好御剑的高度。因此在任意时刻，朵一在方格 $(i,j)$ 上可以做如下行动之一：

- 移动到与该方格相邻的方格 $(i-1,j)$、$(i+1,j)$、$(i,j-1)$、$(i,j+1)$ 之一上（不能移动出方格边界，也不能移动到障碍物上）；
- 如果方格 $(i,j)$ 上允许御剑飞行，则朵一可以御剑飞行至另一个**同样允许御剑飞行且与方格 $(i,j)$ 高度相等的方格上**；
- 使用仙法将当前格子的高度 $h_{i,j}$ 改变为任一正整数。

进行上述每项行动均需花费 $1$ 个单位时间。

“哼，笨狗子你再跑！”说罢，朵一便追了出去。朵一接下来还要尽快继续今天的修行，因此她想知道到达 $(n,m)$ 格子所需的最短时间是多少。
## 输入格式

输入的第一行有三个整数，依次表示方格阵的行数 $n$、列数 $m$ 和能御剑飞行的方格个数 $k$。  
接下来 $n$ 行，每行 $m$ 个整数，其中第 $i$ 行的第 $j$ 个数表示方格 $(i,j)$ 的高度 $h_{i,j}$。数据保证 $h_{1,1}$ 和 $h_{n,m}$ 不为 $0$。  
接下来 $k$ 行，每行两个整数 $x$ 和 $y$，表示一个允许御剑飞行的方格的坐标 $(x, y)$。数据保证这 $k$ 个方格的坐标互不相同。
## 输出格式

一行一个整数，表示朵一到达 $(n,m)$ 所需的最小时间。如果朵一无法到达，输出 ```-1```。
## 样例

### 样例输入 #1
```
4 4 2
1 2 3 4
1 2 3 4
1 2 3 4
1 2 3 4
1 1
3 4
```
### 样例输出 #1
```
3
```
### 样例输入 #2
```
4 4 3
1 2 3 4
1 2 3 4
1 2 3 4
1 2 3 4
1 1
2 4
4 1
```
### 样例输出 #2
```
4
```
### 样例输入 #3
```
2 5 0
1 0 3 3 4
2 3 4 0 5
```
### 样例输出 #3
```
7
```
### 样例输入 #4
```
4 4 3
1 1 1 0
1 1 0 1
1 0 1 1
0 1 1 1
1 1
2 1
3 3
```
### 样例输出 #4
```
3
```
## 提示

### 样例 1 解释

第 $1$ 个单位时间，朵一将当前方格 $(1,1)$ 的高度修改为 $4$；  
第 $2$ 个单位时间，朵一从方格 $(1,1)$ 御剑飞行至 $(3,4)$；  
第 $3$ 个单位时间，朵一从方格 $(3,4)$ 移动到 $(4,4)$，追上了枸杞。

### 样例 2 解释

第 $1$ 个单位时间，朵一从方格 $(1,1)$ 御剑飞行至 $(4,1)$；  
第 $2$ 个单位时间，朵一从方格 $(4,1)$ 移动到 $(4,2)$；  
第 $3$ 个单位时间，朵一从方格 $(4,2)$ 移动到 $(4,3)$；  
第 $4$ 个单位时间，朵一从方格 $(4,3)$ 移动到 $(4,4)$，追上了枸杞。

### 数据规模与约定


![](https://cdn.luogu.com.cn/upload/image_hosting/f2epmv84.png)

对全部的测试点，保证 $1 \leq n, m \leq 3 \times 10^3$，$0 \leq k,h_{i,j} \leq n \times m$。
### 提示

请注意大量数据读入对程序效率造成的影响，选择合适的读入方式，避免超时。

### 说明

本题共有 5 个附加样例文件，见附件里的 dream.zip。

### 后记

不过，别看朵一现在一副生气的样子，可当她追上枸杞后，大抵是不舍得真的动手吧。“嘿嘿，今日的修行结束后，该吃什么好呢？”在这飞瀑悬挂、翠竹怀抱的云梦庭中，修仙炼体，不羡尘嚣，应是这世上最逍遥的事了。


---

---
title: "[春季测试 2023] 幂次"
layout: "post"
diff: 普及+/提高
pid: P9118
tag: ['2023', 'NOIP 提高组', 'O2优化']
---
# [春季测试 2023] 幂次
## 题目描述

小 Ω 在小学数学课上学到了“幂次”的概念：$\forall a, b \in \N^+$，定义 $a^b$ 为 $b$ 个 $a$ 相乘。

她很好奇有多少正整数可以被表示为上述 $a^b$ 的形式？由于所有正整数 $m \in N^+$ 总是可以被表示为 $m^1$ 的形式，因此她要求上述的表示中，必须有 $b \geq k$，其中 $k$ 是她事先选取好的一个正整数。

因此她想知道在 $1$ 到 $n$ 中，有多少正整数 $x$ 可以被表示为 $x = a^b$ 的形式，其中 $a, b$ 都是正整数，且 $b \geq k$？
## 输入格式

第一行包含两个正整数 $n, k$，意义如上所述。
## 输出格式

输出一行包含一个非负整数表示对应的答案。
## 样例

### 样例输入 #1
```
99 1
```
### 样例输出 #1
```
99
```
### 样例输入 #2
```
99 3
```
### 样例输出 #2
```
7
```
### 样例输入 #3
```
99 2
```
### 样例输出 #3
```
12
```
## 提示

**【样例 2 解释】**

以下是全部 $7$ 组符合题意的正整数及对应的一种合法的表示方法。

$1 = 1^3, 8 = 2^3, 16 = 2^4, 27 = 3^3, 32 = 2^5, 64 = 4^3, 81 = 3^4$

注意某些正整数可能有多种合法的表示方法，例如 $64$ 还可以表示为 $64 = 2^6$。

但根据题意，同一个数的不同的合法表示方法只会被计入一次。

**【样例 3 解释】**

以下是全部 $12$ 组符合题意的正整数及对应的一种合法的表示方法。

$1 = 1^2, 4 = 2^2, 8 = 2^3, 9 = 3^2, 16 = 4^2, 25 = 5^2, 27 = 3^3, 32 = 2^5, 36 = 6^2, 49 = 7^2, 64 = 8^2, 81 = 9^2$

**【样例 4】**

见选手目录下的 power/power4.in 与 power/power4.ans。

**【样例 5】**

见选手目录下的 power/power5.in 与 power/power5.ans。

**【样例 6】**

见选手目录下的 power/power6.in 与 power/power6.ans。


**【数据范围】**

对于所有数据，保证 $1 \leq n \leq 10^{18}$，$1 \leq k \leq 100$。

|测试点编号|$n \le$|$k$|
|:-:|:-:|:-:|
|1|$10^2$|$=1$|
|2|$10^2$|$\ge 2$|
|3|$10^4$|$\ge 3$|
|4|$10^4$|$\ge 2$|
|5|$10^6$|$\ge 3$|
|6|$10^6$|$\ge 2$|
|7|$10^8$|$\ge 3$|
|8|$10^8$|$\ge 2$|
|9|$10^{10}$|$\ge 3$|
|10|$10^{10}$|$\ge 2$|
|11|$10^{12}$|$\ge 3$|
|12|$10^{12}$|$\ge 2$|
|13|$10^{14}$|$\ge 3$|
|14|$10^{14}$|$\ge 2$|
|15|$10^{16}$|$\ge 3$|
|16|$10^{16}$|$\ge 2$|
|17|$10^{18}$|$\ge 3$|
|18|$10^{18}$|$\ge 2$|
|19|$10^{18}$|$\ge 2$|
|20|$10^{18}$|$\ge 2$|



---

---
title: "[省选联考 2023] 火车站"
layout: "post"
diff: 普及+/提高
pid: P9166
tag: ['各省省选', '2023', 'O2优化']
---
# [省选联考 2023] 火车站
## 题目描述

有 $n$ 个火车站排成一条直线，从 $1$ 到 $n$ 编号。一共有 $m$ 条火车轨道，每条轨道覆盖一段火车站区间 $[l_i, r_i]$。

对于一个被多条火车轨道覆盖的火车站，火车在经过这里的时候，可以在此处改变轨道。但是火车无法掉头，只能朝着一个方向运行（即只能一直往 $1$ 的方向开或者一直往 $n$ 的方向开）。

小 A 从火车站 $x$ 出发，即搭上了经过 $x$ 的任意一列火车（这列火车也可能是从车站 $x$ 出发）。这列火车可能行驶在火车站 $x$ 所处的任一条轨道上，其运行方向既可能是往 $1$ 的方向开，也可能是往 $n$ 的方向开。小 A 上车后就开始昏睡，直到乘坐的火车到达某条线路的终点站停下，他才醒过来。问小 A 最后可能到达的车站。

注意：火车应运行至少一个车站，且火车切换轨道后不会立刻停下来，而是会继续沿着当前轨道前进。

## 输入格式

输入的第一行包含三个正整数 $n, m, x$，分别表示火车站的数量，火车轨道的数量以及小 A 初始的起点。

接下来 $m$ 行，每行包含两个正整数 $l_i, r_i$，表示一条火车轨道运行的区间。

## 输出格式

输出一行，包含若干个用单个空格分隔的正整数，表示小 A 最后可能到达的车站，按照车站编号升序排序输出。

## 样例

### 样例输入 #1
```
7 5 4
3 4
4 6
1 3
5 7
4 6

```
### 样例输出 #1
```
1 3 6 7

```
## 提示

**【样例 1 解释】**

火车从车站 $4$ 出发，沿着第一条轨道可以运行到终点 $3$，也可以接着沿第三条轨道运行到终点 $1$。

火车从车站 $4$ 出发，沿着第二条轨道可以运行到终点 $6$，也可以在车站 $5$ 换到第四条轨道运行到终点 $7$。

所以最终按顺序输出 $1, 3, 6, 7$。

**【数据范围】**

对于所有的数据，保证 $1 \le n, m \le 2 \times 10^5$，$1 \le x \le n$，$1 \le l_i < r_i \le n$。

|测试点|$n, m \le$|特殊性质|
|:-:|:-:|:-:|
|1|$50$|无|
|2|$50$|无|
|3|$5000$|无|
|4|$5000$|无|
|5|$5000$|无|
|6|$2 \times 10^5$|A|
|7|$2 \times 10^5$|A|
|8|$2 \times 10^5$|无|
|9|$2 \times 10^5$|无|
|10|$2 \times 10^5$|无|

特殊性质 A：保证 $x = 1$。



---

---
title: "[COCI 2022/2023 #4] Vrsta"
layout: "post"
diff: 普及+/提高
pid: P9176
tag: ['2022', 'COCI（克罗地亚）']
---
# [COCI 2022/2023 #4] Vrsta
## 题目描述

Domagoj 最喜欢的课是体育课。每节体育课都以热身运动开始。体育老师有一个有趣的方法来选择带领其他同学做热身运动的学生。学生们按身高从低到高的顺序站成一排，老师会选择站在队伍中间的学生。如果有两个学生在中间，他将选择较矮的那个。例如：如果学生的身高为 $1, 3, 5, 7, 11$，身高为 $5$ 的学生将带领其他同学做热身运动。

Domagoj 记不住他同学的身高。幸运的是，站在他旁边的 Lovro 十分擅长估计他人的身高。他给了 Domagoj $n$ 条信息：「有 $a_i$ 个身高为 $v_i$ 的学生进入了体育馆。」在 Lovro 说完每条信息之后，Domagoj 都对带领其他同学做热身运动的那个同学的身高感兴趣。假定所有进入体育馆的同学都是来上体育课的。请帮他回答他的问题！
## 输入格式

第一行一个整数 $n\ (1\le n\le 200\ 000)$，表示 Lovro 的信息条数。

接下来 $n$ 行包含两个整数 $v_i,a_i\ (1\le v_i,a_i\le 10^9)$，表示 Lovro 所给信息中的身高和人数。
## 输出格式

输出 $n$ 行，表示在 Lovro 给出第 $i$ 条信息后，对 Domagoj 问题的回答。
## 样例

### 样例输入 #1
```
3
2 1
3 1
1 1
```
### 样例输出 #1
```
2
2
2
```
### 样例输入 #2
```
4
17 2
23 5
11 4
9 5
```
### 样例输出 #2
```
17
23
17
11
```
### 样例输入 #3
```
3
10 20
100 5
1000 5
```
### 样例输出 #3
```
10
10
10
```
## 提示

|子任务编号|	附加限制|	分值|
|:-:|:-:|:-:|
| $0$ | 是样例 | $0$ |
| $1$ | $n,v_i\le 1000$ | $17$ |
| $2$ | $a_1=a_2=\ldots=a_n=1$ | $24$ |
| $3$ | $v_1<v_2<\ldots <v_n$ |	$26$ |
| $4$ |	无附加限制 |	$33$ |


---

---
title: "[COCI 2022/2023 #5] Diskurs"
layout: "post"
diff: 普及+/提高
pid: P9178
tag: ['2022', 'COCI（克罗地亚）']
---
# [COCI 2022/2023 #5] Diskurs
## 题目描述

给你 $n$ 个非负整数 $a_1, a_2, \cdots a
_n$，任何一个都小于 $2^m$。

对于其中的每一个数，你都要找出它与数组中其他元素之间的最大哈明距离。

两个非负整数的哈明距离被定义为在这些数字的二进制表示中，它们之间有多少个不同的位置（如果有必要，加上前导零）。

形式上，对于每个 $i$ 求：

$$\max\limits_{1\leq j\leq n} hamming(a_i,a_j)$$
## 输入格式

第一行包含两个整数 $n$ 和 $m(1\leq n\leq 2^
m，1\leq m\leq 20)$。
第二行包含 $n$ 个数字 $a_i(0 \leq ai < 2^
m)$。
## 输出格式

一行 $n$ 个数，第 $i$ 个数表示 $a_i$ 与数组中其他元素之间的最大哈明距离。
## 样例

### 样例输入 #1
```
4 4
9 12 9 11

```
### 样例输出 #1
```
2 3 2 3
```
### 样例输入 #2
```
4 4
5 7 3 9
```
### 样例输出 #2
```
2 3 2 3

```
### 样例输入 #3
```
4 4
3 4 6 10

```
### 样例输出 #3
```
3 3 2 3
```
## 提示

| Subatask | $pts$ | 限制 |
| :----------: | :----------: | :----------: |
| $0$ | $0$ | 是样例 |
| $1$ | $20$ | $m\leq 10$ |
| $2$ | $25$ | $m\leq 16$ |
| $3$ | $25$ | 无 |



---

---
title: "[COCI 2022/2023 #5] Logaritam"
layout: "post"
diff: 普及+/提高
pid: P9179
tag: ['2022', 'COCI（克罗地亚）']
---
# [COCI 2022/2023 #5] Logaritam
## 题目描述

定义对数序列为一个长为 $n$ 的对数序列 $(a_1,a_2,\ldots,a_n)$，满足对于所有正整数 $x,y$ 且 $xy\le n$，有 $a_{xy}=a_x+a_y$。一个长为 $6$ 的对数序列例子为 $0,1,\pi,2,0.7,1+\pi$。

有 $q$ 个长度为 $n$ 的对数序列，但是现在每个序列都恰好有一个元素被改掉了。给你序列个数 $q$，序列长度 $n$ 和每个序列被改动的元素位置 $x_i$，对于每个序列，输出在不改动已经更改的元素的情况下，至少要修改序列中多少个位置的元素才能使这个序列仍然是对数序列。

注：可以证明对于任意的初始对数序列，改动同一位置后，在不改动这个位置的情况下将序列变为对数序列的最小改动数都是相等的。
## 输入格式

第一行两个正整数 $n,q\ (1\le n\le 10^8,1\le q\le 10^4)$，分别表示序列长度和序列个数。

接下来 $q$ 行，第 $i$ 行一个正整数 $x_i\ (1\le x_i\le n)$，表示第 $i$ 个序列中修改的元素下标。
## 输出格式

如果第 $i$ 个序列无法在不改动已经更改的元素的情况下，将原序列变为对数序列，则输出 `-1`，否则输出最少更改元素个数。
## 样例

### 样例输入 #1
```
6 6
1
2
3
4
5
6

```
### 样例输出 #1
```
-1
2
1
2
0
1

```
### 样例输入 #2
```
20 5
7
8
2
19
12

```
### 样例输出 #2
```
1
9
9
0
5

```
### 样例输入 #3
```
10000 4
1234
2345
3456
7890

```
### 样例输出 #3
```
15
148
3332
37

```
## 提示

样例 $1$ 解释：

假设初始序列是 $0,1,\pi,2,0.7,1+\pi$，修改第四个元素为 8，那就可以把第二个元素改为 $4$，把第六个元素改为 $4+\pi$，这样序列变成 $0,4,\pi,8,0.7,4+\pi$，又变成了对数序列。

|子任务编号|	附加限制|	分值|
|:-:|:-:|:-:|
|$0$|	是样例	|$0$|
|$1$|	$n\le 20,q\le 20$	|$17$|
|$2$|	$q\le 8$	|$24$|
|$3$|	$n\le 10^4$	|$26$|
|$4$|	无附加限制	|$33$|


---

---
title: "[入门赛 #11] 写大作业 (Hard Version)"
layout: "post"
diff: 普及+/提高
pid: P9216
tag: ['2023', 'Special Judge', 'O2优化', '语言月赛']
---
# [入门赛 #11] 写大作业 (Hard Version)
## 题目背景

**本题与 Easy Version 的区别在于：输入的是数列而不是字符串，输入输出格式不同，数据规模不同**。

## 题目描述

扶苏为了写计算理论大作业已经 $36$ 小时没有合眼了。

为了能快点睡觉，扶苏找到了 $n$ 份文献，第 $i$ 份文献是一数列 $a_i$，她打算把这些文献组合起来。

具体来说，一共有两种操作：

- `1 x y`：把文献 $a_x$ 整体拼接到 $a_y$ 的后面，然后删除 $a_x$。
- `2 x y`：查询 $a_x$ 和 $a_y$ 是否**相似**。

我们保证在 `1 x y` 操作出现后，数列 $a_x$ **不会**出现在接下来的任何操作中。这就是说，操作 $1$ 至多有 $n-1$ 次。

**相似**的定义是：对两个数列 $a_x$ 和 $a_y$，如果存在一种重新排列 $a_x$ 的方法，使得重排后的 $a_x$ 和 $a_y$ 相等，则称 $a_x$ 和 $a_y$ **相似**。

例如，假设 $a_1 = 1,2$, $a_2 = 3,4$，$a_3 = 1,2,3,4$，则执行 `1 1 2` 后，$a_1$ 被删除，$a_2 = 3,4,1,2$，$s_3 = 1,2,3,4$；继续执行 `2 2 3` 后，因为可以把 $a_2$ 重排为 $1,2,3,4$，所以 $a_2$ 和 $a_3$ 相似。

注意，操作 $2$ 不会对数列做出实际修改。
## 输入格式

第一行是两个整数，分别表示文献的数量 $n$ 和操作的数量 $q$。  
接下来 $n$ 行，每行描述一个数列。第 $i$ 行描述 $a_i$：   
每行第一个数是 $m_i$，表示数列 $a_i$ 的长度，接下来有 $m_i$ 个数，描述数列 $a_i$。  
接下来 $q$ 行，每行三个整数 $op, x, y$，其含义见『题目描述』。
## 输出格式

为了避免输出过大，请你输出一行一个整数，表示所有答案为**两数列相似**的询问的**操作编号**的按位异或和。

操作的编号从 $1$ 开始，两种操作均会令编号增加 $1$。你可以参考样例解释来理解输出格式。
## 样例

### 样例输入 #1
```
4 5
2 1 2
2 3 4
4 1 2 3 4
4 1 2 3 3
1 1 2
2 2 3
2 3 4
2 2 4
2 3 2
```
### 样例输出 #1
```
7
```
## 提示

### 样例解释

共有五次操作，它们的编号和回答情况如下：
| 编号 | 操作 | 回答 |
| :-: | :-: | :-: |
| $1$ | `1 1 2` | 不是查询操作|
| $2$ | `2 2 3` | 相似 |
| $3$ | `2 3 4` | 不相似 |
| $4$ | `2 2 4` | 不相似 |
| $5$ | `2 2 3` | 相似 |

可以看到，回答为**两数列相似**的询问的操作编号为 $2$ 和 $5$。它们的按位异或和是 $7$。故输出为 $7$。

### 数据规模与约定

对全部的测试点，保证 $1 \leq n \leq 10^5$，$1 \leq q \leq 5 \times 10^6$，$1 \leq m_i \leq 10^5$，$\sum_{i = 1}^n m_i \leq 5 \times 10^5$。数列里的元素都是不超过 $10^9$ 的非负整数。

数据保证数列元素的生成方式是：对一个数列，限定一个该数列元素大小的上界 $k$，然后在 $[0, k]$ 内均匀随机地生成 $m_i$ 个整数作为数列 $a_i$。注意，$k$ 不一定是 $10^9$。


---

---
title: "「TAOI-1」Antipathy World"
layout: "post"
diff: 普及+/提高
pid: P9219
tag: ['交互题', 'Special Judge', 'O2优化']
---
# 「TAOI-1」Antipathy World
## 题目背景

> 簡単なことも解らないわ \
> あたしって何だっけ \
> それすら夜の手に絆されて \
> 愛のように 消える 消える \
> さようならも言えぬ儘泣いた フォニイ フォニイ フォニイ \
> 嘘に絡まっているあたしはフォニイ \
> **ANTIPATHY WORLD**
## 题目描述

**这是一道 IO 交互题。**

可不有 $n$ 朵花，每朵花有一个正整数美丽度。

她发现，有一朵花的美丽度不小于其它任何一朵花的美丽度的两倍。

你想知道这朵花是哪一朵，于是你可以进行至多 $k$ 次询问，每次询问你给出两个正整数 $i,j \in [1, n]$，可不会告诉你第 $i$ 朵和第 $j$ 朵花的美丽度之差的绝对值。

你想运用这些询问的答案，得到最美丽的花是第几朵。

### 交互格式

**本题有多组数据**。

第一行交互库给出一个整数 $T$，表示数据组数。

对于每组数据，第一行输入两个正整数 $n,k$。

对于你的每组询问，你输出 `? i j`，交互库会返回一个非负整数，表示第 $i$ 朵和第 $j$ 朵花的美丽度之差。

如果你已经得到答案，输出 `! i` 代表你得到第 $i$ 朵花为最美丽的花。在此之后你应该开始对下一组数据的处理。

每次你输出之后，请**刷新缓冲区**。

你可以使用如下语句来清空缓冲区：

- 对于 C/C++：`fflush(stdout)`；
- 对于 C++：`std::cout << std::flush`；
- 对于 Java：`System.out.flush()`；
- 对于 Python：`stdout.flush()`；
- 对于 Pascal：`flush(output)`；
- 对于其他语言，请自行查阅对应语言的帮助文档。

特别的，对于 C++ 语言，在输出换行时如果你使用 `std::endl` 而不是 `'\n'`，也可以自动刷新缓冲区。
## 输入格式

见「交互格式」。
## 输出格式

见「交互格式」。
## 样例

### 样例输入 #1
```
1
3 114514

3

2

1

```
### 样例输出 #1
```


? 1 2

? 1 3

? 2 3

! 1
```
## 提示

样例中给出了一种可能的交互方式，其中花的美丽度为 $\{4,1,2\}$。

---

**本题采用捆绑测试**。

- Subtask 1（20 points）：$k=\dfrac{n(n-1)}{2}$，$n \le 200$。
- Subtask 2（30 points）：$k=n$。
- Subtask 3（50 points）：$k=\left\lfloor\dfrac{n}{2}\right\rfloor+2$。

对于所有测试数据，设所有花的美丽度为 $a_i$，$1 \le T \le 25$，$3 \le n \le 5 \times 10^4$，$1 \le a_i \le 10^8$。


---

---
title: "[蓝桥杯 2023 省 A] 异或和之和"
layout: "post"
diff: 普及+/提高
pid: P9236
tag: ['2023', '蓝桥杯省赛']
---
# [蓝桥杯 2023 省 A] 异或和之和
## 题目描述

给定一个数组 $A_i$，分别求其每个子段的异或和，并求出它们的和。或者说，对于每组满足 $1 \leq L \leq R \leq n$ 的 $L,R$，求出数组中第 $L$ 至第 $R$ 个元素的异或和。然后输出每组 $L,R$ 得到的结果加起来的值。
## 输入格式

输入的第一行包含一个整数 $n$ 。

第二行包含 $n$ 个整数 $A_i$，相邻整数之间使用一个空格分隔。
## 输出格式

输出一行包含一个整数表示答案。
## 样例

### 样例输入 #1
```
5
1 2 3 4 5
```
### 样例输出 #1
```
39
```
## 提示

#### 【评测用例规模与约定】

对于 $30 \%$ 的评测用例，$n \leq 300$；

对于 $60 \%$ 的评测用例，$n \leq 5000$;

对于所有评测用例，$1 \leq n \leq 10^5$，$0 \leq A_i \leq 2^{20}$。


---

---
title: "[PA 2022] Podwyżki"
layout: "post"
diff: 普及+/提高
pid: P9255
tag: ['2022', 'Special Judge', 'PA（波兰）']
---
# [PA 2022] Podwyżki
## 题目描述

**题目译自 [PA 2022](https://sio2.mimuw.edu.pl/c/pa-2022-1/dashboard/) Runda 2 [Podwyżki](https://sio2.mimuw.edu.pl/c/pa-2022-1/p/pod/)**

对于 Bytecorp 来说，2022 年是艰难的一年。商业决策失误，再加上不景气的市场状况，意味着公司无力为员工涨薪。为了准备应对员工提出的不舒服的问题，人资部门发明了一种方法来证明员工不值得涨薪。

根据一个雇员在连续几天内产生的总收益，可以将一年（在 Byteotia，一年不一定是 365 天）划分为若干区间，这将表明该雇员工作不投入。更确切地说，人资部门希望将收入序列划分为 $k$ 个连续区间，使得序列中的每个元素都恰好属于一个区间。如果**不可能**从每个区间选择一个元素，使所选元素形成严格的升序，那么这种划分是正确的。

Bytecorp 的未来在你手上。写一个程序读入某个雇员产生的收益序列和一个整数 $k$，并根据人资部门的要求把序列分成 $k$ 段，或者判断无法分成这样的 $k$ 段。
## 输入格式

输入的第一行包含两个整数 $n,k$，表示序列长度和要分成的段数。

第二行包含 $n$ 个整数 $a_1,a_2,\ldots,a_n$，表示收益序列。
## 输出格式

如果这个序列不能按如上方法分割，输出一行一个字符串 `NIE`。

否则输出两行，第一行一个字符串 `TAK`，第二行输出 $k-1$ 个整数 $v_1,\ldots,v_{k-1}$，表示正确的划分中除最后一个区间外，每个连续区间的右端点，最后一个区间的右端点一定是 $n$。

如果有多个正确答案，可以输出任意一个。
## 样例

### 样例输入 #1
```
6 3
3 5 4 8 3 7

```
### 样例输出 #1
```
TAK
3 5

```
### 样例输入 #2
```
4 2
2 3 2 3

```
### 样例输出 #2
```
NIE

```
## 提示

对于 $100\%$ 的数据，满足：

$2\le k\le n\le 5 \times 10 ^ 5, 1\le a_i\le 10^9, 1\le v_i<n,v_i<v_{i+1}$。


---

---
title: "[PA 2022] Fotografia"
layout: "post"
diff: 普及+/提高
pid: P9259
tag: ['2022', 'Special Judge', 'PA（波兰）']
---
# [PA 2022] Fotografia
## 题目描述

**题目译自 [PA 2022](https://sio2.mimuw.edu.pl/c/pa-2022-1/dashboard/) Runda 3 [Fotografia](https://sio2.mimuw.edu.pl/c/pa-2022-1/p/fot/)**

字节科技学校（*Bajtockiej Szkoły Technicznej*, BST）的毕业生们聚集在学校前面的广场上拍摄纪念照。他们排成一排，其位置从左到右编号为 $1$ 至 $n$，其中 $n$ 是今年毕业生的人数。

摄影师决定重新安排这些人的位置，让他们按身高升序排列。最矮的人在最左边，最高的人在最右边。幸运的是，今年的毕业生中没有任意两人身高相同。

为了避免混乱，安排位置将按一定方式进行。在一次操作中，摄影师将喊出一串位置编号。在这些位置上的人将按所喊到的顺序出列并走到广场中间。然后，摄影师将重复同样的数字列表。广场中间的人将他们出列顺序的**逆序**，依次回到摄影师所喊出的位置。

我们希望用尽可能少的操作将所有毕业生按身高的升序排列。你的工作是规划重新安排的方案，并告诉摄影师在第几次操作让哪些毕业生出列。
## 输入格式

第一行一个整数 $n$，表示毕业生人数。

接下来 $n$ 行是一个整数序列 $h_1,h_2,\ldots,h_n$，每行一个整数，表示站成一排的人的身高。所有身高两两不同。
## 输出格式

输出第一行包含一个整数 $r$，表示把所有人按身高升序排列所用的最少操作次数。

接下来 $2r$ 行包含对这些操作的描述。描述第一行包含一个整数 $p_i\ ()$，表示这一轮出列的人数，第二行 $p_i$ 个整数，表示按输出顺序喊出人的位置编号。在一次操作中喊出的人不能重复。

如果有多种操作次数最少的方案，输出任意一种即可。
## 样例

### 样例输入 #1
```
5
1670
2011
1560
1232
1447

```
### 样例输出 #1
```
1
5
2 1 3 4 5

```
### 样例输入 #2
```
6
1556
1449
1863
2014
1333
1220

```
### 样例输出 #2
```
2
5
5 6 1 4 3
4
1 2 3 4

```
## 提示

对于 $100\%$ 的数据，满足：

$1\le n\le 3 \times 10 ^ 3, 1\le h_i\le 3 \times 10 ^ 3, 1\le p_i\le n$。


---

---
title: "[PA 2022] Walizki"
layout: "post"
diff: 普及+/提高
pid: P9267
tag: ['2022', 'PA（波兰）']
---
# [PA 2022] Walizki
## 题目描述

**题目译自 [PA 2022](https://sio2.mimuw.edu.pl/c/pa-2022-1/dashboard/) Runda 5 [Walizki](https://sio2.mimuw.edu.pl/c/pa-2022-1/p/wal/)**

有没有想过，你在机场办理完了登机手续，你的行李箱会去哪里？就在它们消失的帘子后面，有一个巨大的大厅，里面布满了错综复杂的平台和传送带，对你的行李进行相应的分类。

Byteasar 负责评估新规划的 Byteburg Bitom 机场的行李大厅的设计。根据规划，大厅里将有 $n$ 个平台，用 $1$ 到 $n$ 的整数编号，每个行李箱最初都要运输到第一个平台。一些单向传送带可以从平台出发，连接到编号严格更大的平台。如果一个平台没有传送带出口，在这个平台的行李箱将由机场工作人员手动拿走并转移到相应的飞机上。另一方面，如果平台接有多条出口传送带，那么传送带的顺序就很重要——第一个行李箱遇到这样的平台，就会从第一条传送带上离开，第二个就会从第二条上离开，以此类推。当行李箱从最后一条传送带离开平台时，下一个行李箱又会从第一条传送带离开，如此循环往复。

一旦一个行李箱被送到第一个平台，它在传送带上的运输和工作人员的收集都在下一个行李箱放在第一个平台之前进行。换句话说，在任何时候，最多只有一个行李箱在传送带上运输。

可以想见，在处理了一定数量的行李箱后，这个行李系统会「复位」，即回到对于每个有出口传送带的平台，行李箱到达平台后都从第一条出口传送带离开的状态。Byteasar 想知道最少处理多少行李箱之后，系统将自我复位。请帮他计算出这个值！
## 输入格式

第一行一个整数 $n$，表示平台个数。

接下来 $n$ 行描述平台。第 $i$ 行开头一个非负整数 $r_i$，表示从第 $i$ 个平台离开的传送带条数。如果 $r_i=0$，表示工作人员从这个平台取行李。如果 $r_i>0$，这一行接着有 $r_i$ 个整数 $l_{i,1},l_{i,2},\ldots,l_{i,r_i}$，按顺序表示出口传送带连接的平台编号（到达的平台编号也同样是递增的）。
## 输出格式

输出一行一个整数，表示最少处理多少行李箱之后，系统将自我复位。
## 样例

### 样例输入 #1
```
7
3 2 3 5
2 3 6
3 5 6 7
1 6
1 7
0
0

```
### 样例输出 #1
```
6

```
### 样例输入 #2
```
3
0
1 3
0

```
### 样例输出 #2
```
1

```
## 提示

对于 $100\%$ 的数据，满足：

$1\le n\le 100, i<l_{i,1}<l_{i,2}<\ldots<l_{i,r_i}$。


---

---
title: "[PA 2022] Wieczór gier"
layout: "post"
diff: 普及+/提高
pid: P9268
tag: ['2022', 'Special Judge', 'PA（波兰）']
---
# [PA 2022] Wieczór gier
## 题目描述

**题目译自 [PA 2022](https://sio2.mimuw.edu.pl/c/pa-2022-1/dashboard/) Runda 5 [Wieczór gier](https://sio2.mimuw.edu.pl/c/pa-2022-1/p/wie/)**

Bytie 喜欢在晚上玩他最喜欢的棋盘游戏。幸运的是，这个游戏是单人游戏，Bytie 不需要和朋友一起玩这个游戏。

棋盘共 $n$ 行，每行有 $m$ 个方格，整个棋盘共有 $nm$ 个方格。棋盘上有 $k$ 个无法区分的棋子，最多只有 $8$ 个。 棋盘的边缘有装饰性的标记，这些标记表明了棋盘的上下左右方位。每个方格可能是空的，也可能放有一个棋子，但棋盘上总是至少有一个棋子，而且至少有一个方格是空的。换句话说，满足 $1\le k\le nm-1$。游戏中一步棋指的是选择一个包含棋子的方格和与之相邻的另一个不包含棋子的方格，然后将棋子从这个方格移到相邻的空方格中。

Bytie 喜欢这个不复杂但令人兴奋的规则，他可以花几个小时来移动棋子。一天晚上，他坐在棋盘前，在棋盘上摆了 $k$ 个棋子，并想到了一种棋子的排布方式，这种排布方式也许与开始时不同。他说，每次他要走一步棋时，他都会确定现在所有棋子的所有可能走法，并从这些走法中随机选出他要怎么走棋。例如，如果棋盘上有两个棋子，第一个棋子有一种走法，第二个棋子有两种走法，那么 Bytie 将以 $\frac{1}{3}$ 的概率从这三种走法中选出一种来走下一步棋。

Bytie（正如我们已经提到的）非常喜欢玩这个游戏，所以他已经确定他会正好走 $100^{100^{100^{100}}}$ 步棋。在走了这么多步之后，棋盘上的棋子排布和目标排布相同的概率是多少？
## 输入格式

第一行两个整数 $n,m$，分别表示棋盘的行数和列数。

接下来 $n$ 行，每行 $m$ 个字符，表示初始的棋盘排布。如果第 $i$ 行第 $j$ 个字符是 `.`，那么棋盘第 $i$ 行第 $j$ 列的方格是空的。否则，这个字符将是 `O`（大写的 `o`），表示第 $i$ 行第 $j$ 列的方格中有一个棋子。

接下来空一行，再接下来 $n$ 行描述目标状态，格式如初始状态。

保证两个棋盘上的棋子个数相同，并且这个个数属于区间 $[1,nm-1]$。此外，保证棋子数不超过 $8$。
## 输出格式

输出一行一个实数，表示在恰好走了 $100^{100^{100^{100}}}$ 步棋后，棋盘上的棋子排布和目标排布相同的概率。如果输出与答案的**绝对**误差不超过 $10^{-13}$，那么输出将被认为是正确的。

注意：由于技术原因，输出小数点后位数多于 $18$ 位，或输出科学计数法形式的小数均将被判为「答案错误」。
## 样例

### 样例输入 #1
```
1 5
O....

....O

```
### 样例输出 #1
```
0.25
```
### 样例输入 #2
```
2 2
O.
.O

OO
..

```
### 样例输出 #2
```
0

```
## 提示

对于 $100\%$ 的数据，满足：

$1\le n,m\le 8$。


---

---
title: "[ICPC 2022 Xi'an R] Find Maximum"
layout: "post"
diff: 普及+/提高
pid: P9362
tag: ['2022', 'O2优化', 'ICPC']
---
# [ICPC 2022 Xi'an R] Find Maximum
## 题目描述

We define a function $f(x)$ over all non-negative integer $x$ as follows:
$$
f(x) =
\begin{cases}
1 & (x = 0) \\
f(\frac{x}{3}) + 1 & (x > 0\land x\bmod3 = 0) \\
f(x - 1) + 1  & (x > 0\land x\bmod 3\neq 0)
\end{cases}
$$
Calculate $\max_{x = l} ^ r f(x)$.

You need to answer $T$ queries independently.
## 输入格式

The first line contains a single integer $T$ ($1\leq T\leq 10 ^ 4$).

Each of the next $T$ lines contains two integers $l$ and $r$ ($1\leq l\leq r\leq 10 ^ {18}$), representing a query.
## 输出格式

Output $T$ lines. The $i$-th line contains a single integer, representing the answer to the $i$-th query.
## 样例

### 样例输入 #1
```
10
1 2
1 3
1 4
1 5
2 3
2 4
2 5
3 4
3 5
4 5

```
### 样例输出 #1
```
3
3
4
5
3
4
5
4
5
5

```
## 提示

**Source**: The 2022 ICPC Asia Xi'an Regional Contest Problem E.

**Author**: MagicSpark.
## 题目翻译

### 题目描述

定义在所有非负整数 $x$ 上的函数 $f(x)$ 如下：

$$
f(x) =
\begin{cases}
1 & (x = 0) \\
f(\frac{x}{3}) + 1 & (x > 0\land x\bmod3 = 0) \\
f(x - 1) + 1  & (x > 0\land x\bmod 3\neq 0)
\end{cases}
$$

计算 $\max_{x = l} ^ r f(x)$。

共有 $T$ 组数据。

$1\leq T\leq 10 ^ 4$，$1\leq l\leq r\leq 10 ^ {18}$。

### 输入格式

第一行一个整数 $T$。

接下来 $T$ 行，每行两个整数 $l, r$ 表示一组询问。

### 输出格式

对于每组询问，输出一行一个整数表示答案。




---

---
title: "[ICPC 2022 Xi'an R] Perfect Word"
layout: "post"
diff: 普及+/提高
pid: P9364
tag: ['2022', 'O2优化', 'ICPC']
---
# [ICPC 2022 Xi'an R] Perfect Word
## 题目描述

You are given $n$ strings and required to find the length of the longest *perfect word*.

A string $t$ is called a *perfect word*, if and only if every non-empty substring of $t$ appears in the given strings.

A string $s$ is called a substring of $t$ if and only if it can be obtained by removing several (possibly zero) characters from the beginning or end of $t$.

## 输入格式

The first line contains a single integer $n$ ($1 \leq n \leq 10 ^ 5$).

Each of the next $n$ lines contains a string consisting of lowercase English letters.

It is guaranteed that the total length of the given strings is no more than $10 ^ 5$.

## 输出格式

Output an integer, representing the length of the longest perfect word.

## 样例

### 样例输入 #1
```
4
a
t
b
ab

```
### 样例输出 #1
```
2

```
## 提示

**Source**: The 2022 ICPC Asia Xi'an Regional Contest Problem G.

**Author**: MonkeyKing.
## 题目翻译

### 题目描述

给定 $n$ 个字符串，你需要找到最长的「完美单词」。

字符串 $t$ 称为「完美单词」，当且仅当它的所有非空子串都出现在给定的字符串中。

字符串 $s$ 称为 $t$ 的子串，当且仅当 $s$ 可由 $t$ 在开头和结尾分别删去零个或若干个字符得到。

$1\leq n\leq 10 ^ 5$，字符串仅由小写字母组成，且总长不超过 $10 ^ 5$。

### 输入格式

第一行一个整数 $n$。

接下来 $n$ 行，每行一个字符串。

### 输出格式

输出一行一个整数表示最长的「完美单词」的长度。




---

---
title: "[ICPC 2022 Xi'an R] Tree"
layout: "post"
diff: 普及+/提高
pid: P9369
tag: ['2022', 'O2优化', 'ICPC']
---
# [ICPC 2022 Xi'an R] Tree
## 题目描述

You are given a tree $T$ with $n$ nodes. The tree is rooted at $1$. Define $\mathrm{subtree}(u)$ as the set of nodes in the subtree of $u$.

Call a subset of nodes $S$ good if and only if $S$ satisfies at least one of the following contidions:

- For all $u, v\in S$ where $u\neq v$, either $u\in \mathrm{subtree}(v)$ or $v\in \mathrm{subtree}(u)$.
- For all $u, v\in S$ where $u\neq v$, both $u\notin \mathrm{subtree}(v)$ and $v\notin \mathrm{subtree}(u)$.

You need to partition all nodes of $T$ into several good subsets. Calculate the minimum number of subsets.

## 输入格式

The first line contains a single integer $Q$ ($1\leq Q\leq 10 ^ 5$), denoting the number of test cases.

For each test case, the first line contains an integer $n$ ($1\leq n\leq 10 ^ 6$). The next line contains $n - 1$ integers $p_2, p_3, \ldots, p_n$ ($1\leq p_i < i$), indicating that there is an edge between $p_i$ and $i$ for each $i=2,3,\ldots,n$.

It is guaranteed that the sum of $n$ over all test cases is no more than $10 ^ 6$.
## 输出格式

For each test case, output a single integer representing the answer.
## 样例

### 样例输入 #1
```
2
7
1 1 2 2 2 3
5
1 2 3 4

```
### 样例输出 #1
```
3
1

```
## 提示

**Source**: The 2022 ICPC Asia Xi'an Regional Contest Problem L.

**Author**: Alex_Wei.
## 题目翻译

### 题目描述

给定大小为 $n$ 的有根树 $T$，根节点为 $1$。定义 $\mathrm{subtree}(u)$ 表示结点 $u$ 的子树。

称集合 $S$ 是好的，当且仅当 $S$ 至少满足下列条件之一：

- 对于 $u, v\in S$ 且 $u\neq v$，$u\in \mathrm{subtree}(v)$ 或 $v\in \mathrm{subtree}(u)$。
- 对于 $u, v\in S$ 且 $u\neq v$，$u\notin \mathrm{subtree}(v)$ 且 $v\notin \mathrm{subtree}(u)$。

将 $T$ 划分为若干好的集合，求集合数量的最小值。

共有 $Q$ 组数据。

$1\leq Q\leq 10 ^ 5$，$1\leq n, \sum n\leq 10 ^ 6$，每个点的父亲编号 $1\leq p_i < i$。

### 输入格式

第一行一个整数 $Q$。

对于每组测试数据，第一行一个整数 $n$，第二行 $n - 1$ 个由空格隔开的整数 $p_2, p_3, \cdots, p_n$，表示每个点的父亲编号。

### 输出格式

对于每组测试数据，输出一行一个整数表示答案。


---

---
title: "[POI 2021/2022 R1] Impreza krasnali"
layout: "post"
diff: 普及+/提高
pid: P9418
tag: ['POI（波兰）', '2021']
---
# [POI 2021/2022 R1] Impreza krasnali
## 题目背景

译自 [XXIX Olimpiada Informatyczna – I etap](https://sio2.mimuw.edu.pl/c/oi29-1/dashboard/) [Impreza krasnali](https://sio2.mimuw.edu.pl/c/oi29-1/p/imp/)。
## 题目描述

有 $n$ 个人依次站成一排，每个人手上都有一个数字，这 $n$ 个数字形成一个排列。

每个人会二选一地报告他左边或右边的人手上的数字。注意第一个人与第 $n$ 个人并不相邻，所以第一个人总是会报告第二个人的数字，第 $n$ 个人总是会报告第 $n-1$ 个人的数字。

现在你得到了 $n$ 个人报告的数字，求出原先的排列有多少种可能。
## 输入格式

第一行一个正整数 $n$。

第二行 $n$ 个整数，表示每个人报告的数字。
## 输出格式

一行一个整数，你的答案模 $10^9+7$。
## 样例

### 样例输入 #1
```
5
3 4 3 4 1

```
### 样例输出 #1
```
2

```
### 样例输入 #2
```
见附件
```
### 样例输出 #2
```
0
```
### 样例输入 #3
```
见附件
```
### 样例输出 #3
```
1
```
## 提示

对于所有数据，$2\leq n\leq 100000$。

| 子任务编号 | 附加限制 | 分数 |
| :----------: | :----------: | :----------: |
| 1 | $n\leq 10$ | 12 |
| 2 | $n\leq 20$ | 30 |
| 3 | $n\leq 1000$ | 30 |
| 4 |  | 28 |


---

---
title: "[ICPC 2021 WF] Splitstream"
layout: "post"
diff: 普及+/提高
pid: P9448
tag: ['2021', 'ICPC']
---
# [ICPC 2021 WF] Splitstream
## 题目描述

A splitstream system is an acyclic network of nodes that processes finite sequences of numbers. There are two types of nodes (illustrated in Figure J.1):

- A *split* node takes a sequence of numbers as input and distributes them alternatingly to its two outputs. The first number goes to output $1$, the second to output $2$, the third to output $1$, the fourth to output $2$, and so on, in this order.</li>
- A *merge** node takes two sequences of numbers as input and merges them alternatingly to form its single output. The output contains the first number from input $1$, then the first from input $2$, then the second from input $1$, then the second from input $2$, and so on. If one of the input sequences is shorter than the other, then the remaining numbers from the longer sequence are simply transmitted without being merged after the shorter sequence has been exhausted.</li>

 ![](https://cdn.luogu.com.cn/upload/image_hosting/e0gr6wa3.png)
  
  Figure J.1: Illustration of how split and merge nodes work.
  
The overall network has one input, which is the sequence of positive integers $1, 2, 3, \ldots, m$. Any output of any node can be queried. A query will seek to identify the $k^{th}$ number in the sequence of numbers for a given output and a given $k$. Your task is to implement such queries efficiently.
## 输入格式

The first line of input contains three integers $m$, $n$, and $q$, where $m$ ($1 \leq m \leq 10^9$) is the length of the input sequence, $n$ ($1 \leq n \leq 10^4$) is the number of nodes, and $q$ ($1 \leq q \leq 10^3$) is the number of queries.

The next $n$ lines describe the network, one node per line. A split node has the format $\texttt{S} \ x \ y \ z$, where $x$, $y$ and $z$ identify its input, first output and second output, respectively. A merge node has the format $\texttt{M} \ x \ y \ z$, where $x$, $y$ and $z$ identify its first input, second input and output, respectively. Identifiers $x$, $y$ and $z$ are distinct positive integers. The overall input is identified by $1$, and the remaining input/output identifiers form a consecutive sequence beginning at $2$. Every input identifier except $1$ appears as exactly one output. Every output identifier appears as the input of at most one node.

Each of the next $q$ lines describes a query. Each query consists of two integers $x$ and $k$, where $x$ ($2 \leq x \leq 10^5$) is a valid output identifier and $k$ ($1 \leq k \leq 10^9$) is the index of the desired number in that sequence. Indexing in a sequence starts with $1$.
## 输出格式

For each query $x$ and $k$ output one line with the $k^{th}$ number in the output sequence identified by $x$, or $\texttt{none}$ if there is no element with that index number.
## 样例

### 样例输入 #1
```
200 2 2
S 1 2 3
M 3 2 4
4 99
4 100

```
### 样例输出 #1
```
100
99

```
### 样例输入 #2
```
100 3 6
S 1 4 2
S 2 3 5
M 3 4 6
6 48
6 49
6 50
6 51
6 52
5 25

```
### 样例输出 #2
```
47
98
49
51
53
100

```
### 样例输入 #3
```
2 3 3
S 1 2 3
S 3 4 5
M 5 2 6
3 1
5 1
6 2

```
### 样例输出 #3
```
2
none
none

```
## 题目翻译

### 题意
有一个有 $n$ 个节点的传输数字序列的网络，其中有两种节点：拆分节点和合并节点。拆分节点会将输入序列中的数字交替插入两个输出序列中，合并节点会交替将两个输入序列中的数字插入输出序列中。例如：

$\{1,2,3,4,5\}$ 拆分得 $\{1,3,5\}$ 和 $\{2,4\}$。

$\{2,4\}$ 和 $\{1,3,5\}$ 合并得 $\{2,1,4,3,5\}$。

在网络中，除 $1$ 号外每一个结点的每一个输入端都连接着另一个节点的输出端,$1$ 号节点的输入端为总输入端，每一个输出端不一定连接着另一个节点的输入端。每一个输出端都有着从 $2$ 开始的正整数编号。

将一个数字序列 $\{1,2,\cdots,m\}$ 从 $1$ 号节点的输入端输入网络，你需要求出编号为  $x$ 的输出端输出的序列中的第 $k$ 个数字。

### 输入格式
第一行三个整数 $n,m,q$。分别表示结点的个数、输入序列为 $\{1,2,\cdots,m\}$、查询的次数。

接下来 $n$ 行，每行一个字母开头，接着是三个整数 $x,y,z$。若字母为 $S$，则表示这是一个拆分节点，$x$ 是它的输入端所连接的输出端编号，$y,z$ 是它的两个输出端的编号；若字母为 $M$，则表示这是一个合并节点，$x,y$ 是它的两个输入端所连接的输出端的编号，$z$ 是它的输出端编号。

再接下来 $q$ 行，每行两个整数 $x,k$，意义如题意中所述。

### 输出格式
对于每一次询问，输出其对应的回答。若答案不存在，输出 `none`。


---

---
title: "「LAOI-1」Bash Game-Plus"
layout: "post"
diff: 普及+/提高
pid: P9486
tag: ['洛谷原创']
---
# 「LAOI-1」Bash Game-Plus
## 题目描述

>巴什博弈：有一堆 $n$ 个物品，两名玩家轮流从中拿取物品。每次至少拿 $1$ 个，至多拿 $m$ 个，不能不拿，最终将物品拿完者获胜。

我们给这个游戏增加一些规则：

有一堆 $n$ 个物品，甲和乙轮流从中拿取物品，甲先拿。每次至少拿 $1$ 个，至多拿 $m$ 个，最终将物品拿完者获胜。    
现在新加入一条规则：**也可以不拿**，但每当有一名玩家选择不拿物品时，接下来的 $k$ 次操作中两名玩家都不可以不拿。

举个例子，当 $k=3$ 时，如果甲在某一次操作中没有拿物品，那么接下来乙、甲、乙三轮都必须拿至少 $1$ 件物品。然后又轮到甲了，这次甲就可以再次选择不拿。

甲乙两人一共进行了 $t$ 次游戏。对于每次游戏，你需要告诉甲他有没有必胜策略。
## 输入格式

第一行两个正整数 $t,op$。$op=1$ 时取消新增加的规则，但是也需要正常读入 $k$。

接下来的 $t$ 行，每行三个正整数 $n,m,k$。
## 输出格式

对于每轮游戏，如果甲有必胜策略，那么输出 `Yes`。否则输出 `No`。
## 样例

### 样例输入 #1
```
6 0
2 2 2
3 2 2
4 2 2
7 2 3
13 2 6
14 2 6
```
### 样例输出 #1
```
Yes
Yes
No
Yes
Yes
No
```
### 样例输入 #2
```
6 0
4 3 2
5 3 3
13 3 5
13 3 6
5 100 1000000000000
123454204 4321 97
```
### 样例输出 #2
```
Yes
No
Yes
No
Yes
No
```
## 提示

| Subtask | 得分 | $t$ | $op$ | $n\le$ | $m\le$ | $k\le$ | 特殊性质 |
| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |
| $0$ | $2$ | $100000$ | $1$ | $10^{18}$ | $10^{18}$ | $k=114514$ |  |
| $1$ | $2$ | $99994$ | $0$ | $10^{18}$ | $10^{18}$ | $k=1$ |  |
| $2$ | $9$ | $99995$ | $0$ | $10^{18}$ | $10^{18}$ | $3$ |  |
| $3$ | $5$ | $99996$ | $0$ | $10^{18}$ | $10^{18}$ | $k\ge n$ |  |
| $4$ | $10$ | $50$ | $0$ | $50$ | $50$ | $10^{18}$ |  |
| $5$ | $13$ | $99997$ | $0$ | $100$ | $100$ | $10^{18}$ |  |
| $6$ | $16$ | $99998$ | $0$ | $400$ | $400$ | $10^{18}$ | $A$ |
| $7$ | $10$ | $99999$ | $0$ | $5000$ | $5000$ | $10^{18}$ |  |
| $8$ | $31$ | $100000$ | $0$ | $10^{18}$ | $10^{18}$ | $10^{18}$ |  |
| $9$ | ~~45~~ $2$ | $99993$ | $0$ | $10^{18}$ | $10^{18}$ | $10^{18}$ | 不可以，总司令 |

特殊性质 $A$ ：所有 $m$ 相等。

对于所有数据：$t\le10^5$，$1\le n,m,k\le10^{18}$

不保证数据随机。


---

---
title: "ZHY 的生成树"
layout: "post"
diff: 普及+/提高
pid: P9488
tag: ['O2优化']
---
# ZHY 的生成树
## 题目描述

ZHY 有一个 $n$ 个点的完全图，点 $u$ 与点 $v$ 的距离为 $\gcd(u,v)$，求这个完全图的最大生成树的边权之和。
## 输入格式

一个正整数 $n$。
## 输出格式

一个整数，表示这个最大生成树的边权之和。
## 样例

### 样例输入 #1
```
4
```
### 样例输出 #1
```
4
```
### 样例输入 #2
```
30
```
### 样例输出 #2
```
183
```
### 样例输入 #3
```
100
```
### 样例输出 #3
```
1916
```
## 提示

**本题采用捆绑测试。**

$\text{Subtask}$ $0\kern{3pt}$(10pts)：$n\le 5$。

$\text{Subtask}$ $1\kern{3pt}$(20pts)：$n\le 1000$。

$\text{Subtask}$ $2\kern{3pt}$(30pts)：$n\le 10^{6}$。

$\text{Subtask}$ $3\kern{3pt}$(40pts)：$n\le 10^{7}$。

对于所有测试数据，$1\le n \le 10^{7}$。


---

---
title: "地铁"
layout: "post"
diff: 普及+/提高
pid: P9618
tag: []
---
# 地铁
## 题目背景

> 两年级生 孤单一人
>
> 仰望上空 陋市苍穹
>
> 在宇宙这个约会室中
>
> Maybe 我们只是刚好没能邂逅呢
## 题目描述

著名工程学专家 625OutContradiction 设计了一张地铁交通网 $G$．$G$ 拥有 $n$ 个站点和 $m$ 条地铁线路．

第 $i$ 条地铁线路 $P_i$ 会经过交通网上的若干站点，形如 $P_i=(u_1,u_2,u_3,...,u_{k_i})(k_i>0)$：每两个相邻站点 $u_j,u_{j+1}(j<k_i)$ 之间存在一段属于线路 $i$ 的从 $u_j$ 通向 $u_{j+1}$ 的单向地铁轨道．保证一条地铁线路不重复经过同一站点．但一个站点可能被若干条地铁线路经过．

丹羽和艾莉欧准备从 $1$ 号站点前往 $n$ 号站点．然而他们的自行车坏掉了，只好准备乘坐地铁．现在他们需要决定出行的方案．

一种出行方案具体是这样的：从 $1$ 号站点出发，选定一条经过 $1$ 号站点的地铁线路并开始乘坐地铁．沿当前地铁线路乘坐地铁的过程中，可以选择换乘其他任意一条经过当前站点的地铁线路．要求最终到达 $n$ 号站点．乘坐地铁过程中重复经过某一站点或某段地铁轨道是被允许的．

**请注意：从 $1$ 号站点出发，第一次乘坐地铁不被算作换乘．**

艾莉欧提出了 $q$ 个问题．对于每个问题，艾莉欧会提供三个参数 $a, b, c$．在这次问题中，一个出行方案如果经过了 $x$ 段地铁轨道并进行了 $y$ 次换乘，那么它的疲惫值为 $ax+by$．您需要回答换乘次数不超过 $c$ 的出行方案中最小的疲惫值是多少．
## 输入格式

第一行三个整数 $n, m, q$．

接下来 $m$ 行，第 $i$ 行形如：$k_i,u_1,u_2,u_3,...,u_{k_i}$．
表示一条地铁线路．

接下来 $q$ 行，每行三个整数，表示 $a,b,c$．
## 输出格式

$q$ 行，对应每个问题的回答．
## 样例

### 样例输入 #1
```
5 3 3
5 1 2 3 4 5
2 1 3
3 2 4 5
1 1 1
3 0 2
1 5 2

```
### 样例输出 #1
```
4
9
4

```
### 样例输入 #2
```
10 7 10
10 1 2 3 4 5 6 7 8 9 10
5 3 8 5 1 6
2 1 6
4 3 7 8 5
1 1
2 10 2
6 8 4 7 3 1 5
5 10 6
17 14 0
11 14 5
8 8 3
8 13 9
11 2 9
7 1 6
11 11 8
15 3 0
0 17 4

```
### 样例输出 #2
```
35
153
69
48
53
57
36
66
135
0

```
### 样例输入 #3
```
10 7 10
10 1 2 3 4 5 6 7 8 9 10
3 2 7 1
3 5 10 9
2 2 7
5 4 8 1 7 2
3 10 9 4
4 2 1 7 8
18 6 0
16 11 0
18 1 0
14 0 0
19 14 0
3 2 0
18 15 0
5 18 0
2 17 0
20 10 0

```
### 样例输出 #3
```
162
144
162
126
171
27
162
45
18
180

```
## 提示

### 样例 #1 说明
$1\rightarrow 2\rightarrow 3\rightarrow 4\rightarrow 5$ 是给出的第一条地铁线路，$1\rightarrow 3$，$2\rightarrow 4\rightarrow 5$ 是第二三条地铁线路．

对于第一二组询问，均存在一种最优的出行方案为，在 $1$ 站点搭乘第二条地铁线路到达 $3$ 站点，在 $3$ 站点换乘第一条地铁线路到达终点；共经过 $3$ 段地铁轨道，并进行了 $1$ 次换乘，故第一二组询问的答案分别为 $3\times 1+1\times 1=4$，$3\times 3+1\times 0=9$．对于第三组询问，由于换乘的代价较大，最优的方案为顺着第一条地铁线路一直通向终点，途径 $4$ 段地铁轨道，答案为 $4$．

### 数据点约束
对于所有数据满足：

$1\le n \le 10^5$，$1\le m \le 10^4$，$1\le q \le 10^5$，$\sum k_i \le 3\times 10^5$．

$0 \le a,b \le 10^6$，$0 \le c \le 20$．

---
对于 $10\%$ 的数据满足：$n \le 20$，$\sum k_i \le 40$，$q \le 30$．

---

对于另外 $20\%$ 的数据满足：$c=0$．

---

对于另外 $30\%$ 的数据满足：$q=1$．

---

题目中可能存在只经过一个地铁站的地铁线路．这种线路可以直接忽视．数据保证：对于任意一组询问，存在一条合法的路线可以到达终点．


---

---
title: "[ICPC 2020 Nanjing R] Fireworks"
layout: "post"
diff: 普及+/提高
pid: P9627
tag: ['2020', 'Special Judge', 'O2优化', 'ICPC', '南京']
---
# [ICPC 2020 Nanjing R] Fireworks
## 题目描述

Kotori is practicing making fireworks for the upcoming hanabi taikai$^1$. It takes her $n$ minutes to make a single firework, and as she is not really proficient in making fireworks, each firework only has a probability of $p \times 10^{-4}$ to be perfect.

After she finishes making a firework, she can just start making the next firework, or take $m$ minutes to light all the remaining fireworks finished before. If there is at least one perfect firework among the lit ones, she will be happy and go to rest. Otherwise, she will continue practicing. Can you tell her the minimum expected practicing time before she goes to rest if she takes the optimal strategy?

Notice that no matter how many fireworks remain, it always takes $m$ minutes to light them all.

$^1$ Hanabi taikai: Romaji of the Japanese word ``花火大會``, which means the firework... err... party?
## 输入格式

There are multiple test cases. The first line of the input contains an integer $T$ ($1 \le T \le 10^4$) indicating the number of test cases. For each test case:

The first and only line contains three integers $n$, $m$ and $p$ ($1 \le n, m \le 10^9$, $1 \le p \le 10^4$).
## 输出格式

For each test case, output one line containing one number indicating the minimum expected practicing time.

Your answer will be considered correct if and only if the absolute or relative error does not exceed $10^{-4}$.
## 样例

### 样例输入 #1
```
3
1 1 5000
1 1 1
1 2 10000
```
### 样例输出 #1
```
4.0000000000
10141.5852891136
3.0000000000
```
## 题目翻译

Kotori 正在制作烟花。她制作一支烟花需要 $n$ 分钟，每支烟花有 $p\times 10 ^ {-4}$ 的概率是完美的。

当 Kotori 制作好一支烟花时，她可以选择继续制作，也可以选择用 $m$ 分钟点燃所有烟花。如果其中有完美的烟花，那么她会很开心，并停下来休息，否则她会继续制作烟花。你能告诉她在最优策略下，最少期望多长时间才能停下来休息吗？

注意，无论已经制作好了多少支烟花，Kotori 都需要 $m$ 分钟将它们点燃。

多组数据，$1\leq T, p\leq 10 ^ 4$，$1\leq n, m\leq 10 ^ 9$。要求相对误差或绝对误差不超过 $10 ^ {-4}$。


---

---
title: "「yyOI R1」youyou 的篡改（Hard Ver.）"
layout: "post"
diff: 普及+/提高
pid: P9637
tag: ['O2优化']
---
# 「yyOI R1」youyou 的篡改（Hard Ver.）
## 题目背景

**Easy Version 与 Hard Version 仅最后所求内容不同，其他描述均一致。**
## 题目描述

youyou 准备举办一场比赛，这场比赛有 $n$ 道题，每一道题都有一个难度值 $v_i$。

youyou 给出一个计数分量 $k(k\le n)$，他认为，第 $x(x \geq k)$ 道题的可做性 $a_x$ 应当是第 $1\sim x$ 题所有题目中将难度值从小到大排序后难度较大的 $k$ 道题目难度值之和。

由于第 $1 \sim k-1$ 题难度过于简单，youyou 不想考虑这些题目的可做性。

那么这场比赛的总可做性即为第 $k$ 道题至第 $n$ 道题可做性之和，即 $\sum^{n}_{i=k}a_i$
 的值。

他可以篡改题目 $m$ 的难度为任意正整数。

问：总可做性必须满足在区间 $[l,r]$ 的范围内，那么总可做性有几种取值？
## 输入格式

第一行输入五个正整数，分别为 $n,m,k,l,r$。

第二行输入 $n$ 个整数，第 $i$ 个数 $v_i$ 为第 $i$ 道题难度值。
## 输出格式

仅一行，输出一个数，表示在满足条件的前提下，总可做性的取值数。
## 样例

### 样例输入 #1
```
5 1 1 5 10
1 2 2 2 2
```
### 样例输出 #1
```
2
```
## 提示

### 样例解释#1

你可以改动 $v_1$，$k=1$。

当第一个数改动为 $1$ 时，总难度 $1+2+2+2+2=9$。

当第一个数改动为 $2$ 时，总难度 $2+2+2+2+2=10$。

仅有以上两种取值符合题意，即总难度值等于 $9$ 或 $10$。因此答案为 $2$。

## 数据范围

本题启用 **Subtask**，对于每一个 **Subtask**，你需要通过全部测试点才能得到该部分的分数。

| 子任务编号 | $n$ | 分数 |
| :-----------: | :-----------: | :-----------: |
| $1$ | $\le10$ | $15$ |
| $2$ | $\le10^3$ | $15$ |
| $3$ | $\le10^5$ | $70$ |


对于 $100\%$ 的数据，$1\le k,t \le n \le 10^5$，$1 \le l \le r \le 10^{9}$，$1\le v_i\le10^9$。


---

---
title: "[ICPC 2021 Macao R] Sandpile on Clique"
layout: "post"
diff: 普及+/提高
pid: P9661
tag: ['2021', 'O2优化', 'ICPC', 'Ad-hoc', '澳门']
---
# [ICPC 2021 Macao R] Sandpile on Clique
## 题目描述

The $\textit{Abelian Sandpile Model}$ is a famous dynamical system displaying self-organized criticality. It has been studied for decades since it was introduced by Per Bak, Chao Tang and Kurt Wiesenfeld in a 1987 paper. The sandpile prediction is of wide interest in physics,
computer science, and mathematics, both for its beautiful algebraic structure and for its relevance to applications like load balancing and derandomization of models like internal diffusion-limited aggregation. The sandpile model is related to many other models and physical phenomena, like the rotor-routing model, avalanche models.

In the sandpile model, we are given an undirected graph $G$ whose vertices are indexed from $1$ to $n$. We're also given $n$ integers $a_1, a_2, \cdots, a_n$ where $a_i$ indicates that there are $a_i$ chips placed on vertex $i$ initially. Each turn we will pick an arbitrary vertex $v$ such that the number of chips on $v$ is not smaller than the number of edges connecting $v$, denoted as $d_v$. For each neighbor of $v$, it will receive one chip from $v$. Therefore, $v$ will lost $d_v$ chips. This process is called firing or toppling. Firing will keep happening until no vertex $v$ has at least $d_v$ chips.

It can be proven that the order of firing doesn't affect the result. Meanwhile, it is also possible that the firing will never terminate. This instance is described as ``recurrent``. Now you are given a clique and the initial number of chips. Determine whether this instance is a recurrent one. If not, please output the final number of chips for each node respectively.

A clique (also called a complete graph) is a graph where every two vertices are connected with an edge.
## 输入格式

There is only one test case in each test file.

The first line of the input contains an integer $n$ ($2 \leq n \leq 5 \times 10^5$) indicating the size of the clique. 

The second line contains $n$ integers $a_1, a_2, \cdots, a_n$ ($0 \leq a_i \leq 10^9$) where $a_i$ indicates the initial number of chips placed on vertex $i$.

## 输出格式

Output one line. If the given sandpile instance will terminate, output $n$ integers separated by a space where the $i$-th integer indicates the final number of chips on the $i$-th vertex. Otherwise output ``Recurrent`` (without quotes) instead.

Please, DO NOT output extra spaces at the end of each line or your solution may be considered incorrect!
## 样例

### 样例输入 #1
```
5
5 0 3 0 3
```
### 样例输出 #1
```
3 3 1 3 1
```
### 样例输入 #2
```
2
1 0
```
### 样例输出 #2
```
Recurrent
```
## 提示

For the first sample test case:

- We can only select vertex $1$ at the beginning. The number of chips becomes $\{1, 1, 4, 1, 4\}$.
- We can now select vertex $3$ or $5$ because both of them have at least $4$ chips. We select vertex $3$ and the number of chips becomes $\{2, 2, 0, 2, 5\}$. Selecting vertex $5$ will lead to the same result.
- We now select vertex $5$. The number of chips becomes $\{3, 3, 1, 3, 1\}$. There is no vertex with at least $4$ chips so the firing terminates.

For the second sample test case, we can select vertex $1$ and $2$ repeatedly. The firing never terminates.
## 题目翻译

**【题目描述】**

阿贝尔沙堆模型（Abelian Sandpile Model）是一个著名的显示自组织临界性的动力学系统。自从它由 Per Bak、Chao Tang 和 Kurt Wiesenfeld 在 1987 年的一篇论文中引入以来，它已经被研究了数十年。沙堆模型的预测引起了物理学、计算机科学和数学的广泛关注，这不仅是因为它美丽的代数结构，还因为它与负载平衡和内部扩散有关的模型的应用，如去随机化。沙堆模型与许多其他模型和物理现象相关，如转子路由模型、雪崩模型。

在沙堆模型中，给定一个顶点编号从 $1$ 到 $n$ 的无向图 $G$。我们还给出了 $n$ 个整数 $a_1, a_2, \cdots, a_n$，其中 $a_i$ 表示初始时放置在顶点 $i$ 上的筹码数量。每个回合，我们将选择一个任意的顶点 $v$，使得 $v$ 上的筹码数量不小于与 $v$ 相连的边数，记为 $d_v$。对于 $v$ 的每个邻居，它将从 $v$ 接收一枚筹码。因此，$v$ 将失去 $d_v$ 枚筹码。这个过程被称为 ``firing`` 或 ``toppling``。直到没有顶点 $v$ 至少有 $d_v$ 枚筹码时，firing 才会停止。

可以证明，firing 的顺序不会影响结果。同时，也可能 firing 永远不会终止。这种情况被描述为“recurrent”。现在给定一个团和初始筹码数量，请确定这个实例是否是一个 recurrent 实例。如果不是，请分别输出每个节点的最终筹码数量。

团（也称为完全图）是一个图，其中任意两个顶点都有边相连。

**【输入格式】**

每个测试文件中只有一个测试用例。

输入的第一行包含一个整数 $n$（$2 \leq n \leq 5 \times 10^5$），表示团的大小。

第二行包含 $n$ 个整数 $a_1, a_2, \cdots, a_n$（$0 \leq a_i \leq 10^9$），其中 $a_i$ 表示放置在顶点 $i$ 上的初始筹码数量。

**【输出格式】**

输出一行。如果给定的沙堆实例将终止，则输出由空格分隔的 $n$ 个整数，其中第 $i$ 个整数表示第 $i$ 个顶点上的最终筹码数量。否则输出 ``Recurrent``（不包括引号）。

请不要在每行末尾输出额外的空格，否则您的解决方案可能被认为是错误的！

**【样例解释】**

对于第一个样例测试用例：

- 我们只能在开始时选择顶点 $1$。筹码数量变为 $\{1, 1, 4, 1, 4\}$。
- 现在我们可以选择顶点 $3$ 或 $5$，因为它们都至少有 $4$ 枚筹码。我们选择顶点 $3$，筹码数量变为 $\{2, 2, 0, 2, 5\}$。选择顶点 $5$ 会得到相同的结果。
- 现在我们选择顶点 $5$。筹码数量变为 $\{3, 3, 1, 3, 1\}$。没有顶点至少有 $4$ 枚筹码，因此 firing 终止。

对于第二个样例测试用例，我们可以重复选择顶点 $1$ 和 $2$。firing 永远不会终止。

翻译来自于：[ChatGPT](https://chatgpt.com/)


---

---
title: "[ICPC 2022 Jinan R] Frozen Scoreboard"
layout: "post"
diff: 普及+/提高
pid: P9670
tag: ['2022', 'Special Judge', 'O2优化', 'ICPC', '济南']
---
# [ICPC 2022 Jinan R] Frozen Scoreboard
## 题目描述

There was an ICPC contest two thousand years ago in the Qin dynasty. There were $m$ problems and $n$ teams in the contest. We only know how many problems each team solved and how much total time they used from the historical records. These are called the $\textbf{final result}$s of the teams. We don't know which problems they solved or their submission times.

Recently, we seem to had a discovery. We found the $\textbf{frozen scoreboard}$ of the teams. From the frozen scoreboard of a team, we know their submissions during the whole contest, but we don't know the verdicts of the submissions in the last hour. And some people found that for some teams, their frozen scoreboards may contradict their final results in the historical records.

Given the final results and the frozen scoreboards of the teams, please construct a $\textbf{final scoreboard}$ for each team that is consistent with both its final result and its frozen scoreboard.

From the submissions during the contest, we can calculate the final scoreboard and the final result as follows:

For a fixed team $i$, its $\textbf{final scoreboard}$ is an array of $m$ elements where the $j$-th element shows some information about team $i$'s submissions on problem $j$. 

- If team $i$ didn't submit to problem $j$, the cell should be a single character ``.`` (without quotes). 

- If team $i$ submitted $x$ times to problem $j$ and none of the submissions was accepted, the cell should contain $-\ x$. 

- Otherwise, consider all submissions from team $i$ to problem $j$. Each submission has a submission time. Suppose the earliest accepted submission is the $x$-th one. Then the cell should contain $+\ x/y$ where $y~(0\le y\le 299)$ is the submission time of the $x$-th submission. $y$ is an integer representing the submission time in minutes.

Note that in the final scoreboard, we don't care about submissions after the first accepted one. It is possible that two or more submissions happened in the same minute.

The $\textbf{final result}$ of a team is computed from its $\textbf{final scoreboard}$. For each team, we can calculate the number of problems it solved. This number is equal to the number of ``+`` in the team's final scoreboard.

We can also calculate its total time. If team $i$ solved problem $j$ in the $y$-th minute after $x-1$ unaccepted submissions (in other words, the $j$-th cell of its final scoreboard is $+\ x/y$), problem $j$ contributes $20(x-1)+y$ time to team $i$. If team $i$ didn't solve problem $j$, problem $j$ contributes $0$ time to team $i$, no matter team $i$ submitted to problem $j$ or not. The total time of team $i$ is the sum of contributions of each problem.

The rules for the $\textbf{frozen scoreboard}$ will be introduced in the input section. We will distinguish submissions in the final hour and other submissions. A submission was in the final hour if its submission time is between $240$ and $299$.
## 输入格式

The first line contains two integers $n, m~(1\le n\le 1000, 1\le m\le 13)$, the number of teams in the contest, and the number of problems in the contest.

Then there are $n$ blocks describing the $\textbf{final result}$ and the $\textbf{frozen scoreboard}$ of each team.

The $i$-th block represents team $i$. In the $i$-th block, the first line contains two integers $a_i, b_i~(0\le a_i\le m, 0\le b_i\le 10^5)$, the number of problems team $i$ solved $\textbf{during the whole contest}$ and the total time of team $i$ for solving the $a_i$ problems. These two numbers represent the final result of the contest. The next $m$ lines describe the status of team $i$ in the frozen scoreboard. For each $1\le j\le m$, 

- If the $j$-th line is $+\ x/y$ $(1\le x\le 100, 0\le y\le 239)$, team $i$ solved problem $j$ at time $y$ and the accepted solution is their $x$-th submission on problem $j$.
- If the $j$-th line is $?\ x\ y$ $(1\leq x \leq y \leq 100)$, team $i$ didn't solve the problem $j$ in the first four hours. Team $i$ submitted problem $j$ for $y$ times in which $x$ submissions are in the last hour. Note that submissions made in the last hour after the accepted one will count in the $\textbf{frozen scoreboard}$, but not in the $\textbf{final scoreboard}$.
- If the $j$-th line is $-\ x$, team $i$ didn't solve the problem $j$ in the first four hours. Team $i$ submitted problem $j$ for $x~(1\le x\le 100)$ times before the last hour and did not submit problem $j$ in the last hour.
- If the $j$-th line is a single character ``.`` (without quotes), team $i$ didn't submit problem $j$ at all.
## 输出格式

For each team $i$, if its final result contradicts its frozen scoreboard, output $\texttt{No}$ in one line. Otherwise, output $\texttt{Yes}$ in the first line and then output $m$ lines, describing a final scoreboard that is consistent with both the final result and the frozen scoreboard of team $i$. The $j$-th line should contain 

- $+\ x/y$ $(1\le x \le 100, 0\le y \le 299)$, if the $x$-th submission from team $i$ to problem $j$ is accepted and is in the $y$-th minute of the contest. All submissions from team $i$ to team $j$ before the $x$-th one was not accepted. Please don't output extra spaces before and after slash ``/``. 
- $-\ x$ $(1\le x\le 100)$, if team $i$ submitted to problem $j$ for $x$ times and none of the submissions was accepted.
- $.$ if team $i$ didn't submit to problem $j$ at all. 

If there are multiple solutions, output any.

$\textbf{Please note that in the input and the output, there is always a space following each ?, +, and -.}$
## 样例

### 样例输入 #1
```
1 13
7 951
+ 1/6
? 3 4
+ 4/183
- 2
+ 3/217
.
.
.
+ 2/29
+ 1/91
.
+ 1/22
.
```
### 样例输出 #1
```
Yes
+ 1/6
+ 2/263
+ 4/183
- 2
+ 3/217
.
.
.
+ 2/29
+ 1/91
.
+ 1/22
.
```
### 样例输入 #2
```
6 2
1 100
.
? 3 4
2 100
+ 1/1
+ 1/2
0 0
- 5
- 6
2 480
? 100 100
? 100 100
2 480
? 99 100
? 100 100
1 2000
? 100 100
? 100 100
```
### 样例输出 #2
```
No
No
Yes
- 5
- 6
Yes
+ 1/240
+ 1/240
No
Yes
+ 87/280
- 100
```
## 提示

Here is an example of the frozen scoreboard in the first sample.

![](https://cdn.luogu.com.cn/upload/image_hosting/jw4c3965.png)
## 题目翻译

### 题目描述

2000 年以前的秦朝，曾举办过一次 ICPC 比赛。比赛中有 $m$ 道题，$n$ 个团队。我们知道每个队完成了多少道题以及其历史记录的总用时。这些称作该团队的结果，但是我们不知道他们每道题是否完成、用时多久。

最近，我们发现了每个队**冻结的计分板**。从该计分板上，我们可以看到每个队在比赛中的提交情况，但是不知道在最后一小时内提交的判分。一些人发现，对于一些队来说，他们冻结的计分板可能与他们在历史记录中的最终成绩相矛盾。

请根据最终得分和冻结的计分板，为各队创建一个与其最终结果和冻结的计分板一致的最终计分板。

按照以下规则来计算计分板和总分：

对于给定的队伍 $i$，它**最终的计分板**是一个 $m$ 元数组，其中第 $j$ 个元素给出队伍 $i$ 在第 $j$ 题上的提交信息。

- 如果队伍 $i$ 没有提交问题 $j$，输出 ```.```。

- 如果队伍 $i$ 对问题 $j$ 提交了 $x$ 次但均未通过，输出 $-x$。

- 否则，考虑队伍 $i$ 在问题 $j$ 的所有评测结果。每次提交都有一个提交时间，设第一个通过的评测是第 $x$ 次评测，在第 $y$ 分钟时提交。输出 $+x/y$，其中 $0\leq y\leq299$。

在最终计分板上，只考虑第一次通过的提交。同一分钟内可能有多次提交。

一个队伍的最终得分是该队伍完成了多少道题，即该队最终计分板上 ```+``` 的个数。

一个队伍总用时按如下方式计算。如果队伍 $i$ 在第 $y$ 分钟完成了第 $j$ 道题，在完成前有 $x-1$ 次失败的提交（即最终计分板上第 $j$ 个问题的数为 $+x/y$），该问题的用时记为 $20(x-1)+y$。 如果队伍 $i$ 没有完成第 $j$ 道题，该问题的用时记为 $0$，无论是否提交过。队伍 $i$ 的总时间是每道题用时的总和。

### 输入格式

第一行包括两个整数 $n,m\;(1\leq n\leq1000,1\leq m\leq13)$，为队伍个数和题目个数。

接下来 $n$ 组，描述每个队伍的最终得分和冻结的计分板。

第 $i$ 组表示队伍 $i$。每一组中，第一行包括两个整数 $a_i,b_i\;(0\leq a_i\leq m,0\leq b_i\leq10^5)$，为队伍 $i$ 在**整场比赛中**完成的题目个数和每道题的用时。这两个数字是比赛的最终结果。

接下来 $m$ 行，描述队伍 $i$ 在计分板上的内容。对于任意 $1\leq j\leq m$，

- 如果第 $j$ 行是 $+\,x/y\;(1\leq x\leq100,0\leq y\leq239)$，表示队伍 $i$ 在第 $y$ 分钟，第 $x$ 次提交时通过了题 $j$。

- 如果第 $j$ 行是 $?\,x\,y\;(1\leq x\leq y\leq100)$，表示队伍 $i$ 没有在前四个小时中作出题 $j$。这个队伍提交了 $y$ 次，其中 $x$ 次在最后一小时内。最后一小时内且通过该题的提交记录会在**冻结的计分板**上显示，但不会在**最终计分板**上显示。

- 如果第 $j$ 行是 $-x$，表示队伍 $i$ 没有在前四小时内作出题 $j$。这个队伍在最后一个小时前提交了 $x\,(1\leq x\leq100)$ 次，且没有在最后一小时内做出题 $j$。

- 如果第 $j$ 行是一个单一的字符 ```.```，表示队伍 $i$ 没有提交过题 $j$。

### 输出格式

对于每个队伍 $i$，如果最终结果和冻结的计分板相矛盾，输出一行 $\texttt{No}$。否则，第一行输出 $\texttt{Yes}$，接下来 $m$ 行，描述一种队伍 $i$ 可能的计分板，满足最终结果和冻结的计分板。其中，第 $j$ 行应该包括：

- $+\,x/y\,(1\leq x\leq100,0\leq y\leq299)$，如果队伍 $i$ 在第 $x$ 次提交，第 $y$ 分钟完成了题 $j$，在这之前没有队伍通过这道题。不要在字符 ```/``` 前后输出多余的空格。

- $-x\,(1\leq x\leq100)$，如果队伍 $i$ 提交了 $x$ 次题 $j$，且均未通过。

- ```.```，如果队伍 $i$ 没有提交题 $j$。

如果有多种可能的答案，任意输出一种即可。

**请注意，在输入和输出中，```?,+,-``` 后总有一个空格。**


---

---
title: "[CSP-J 2023] 旅游巴士"
layout: "post"
diff: 普及+/提高
pid: P9751
tag: ['2023', 'O2优化', 'CSP-J 入门级']
---
# [CSP-J 2023] 旅游巴士
## 题目描述

小 Z 打算在国庆假期期间搭乘旅游巴士去一处他向往已久的景点旅游。

旅游景点的地图共有 $n$ 处地点，在这些地点之间连有 $m$ 条道路。其中 $1$ 号地点为景区入口，$n$ 号地点为景区出口。我们把一天当中景区开门营业的时间记为 $0$ 时刻，则从 $0$ 时刻起，每间隔 $k$ 单位时间便有一辆旅游巴士到达景区入口，同时有一辆旅游巴士从景区出口驶离景区。

所有道路均只能**单向通行**。对于每条道路，游客步行通过的用时均为恰好 $1$ 单位时间。

小 Z 希望乘坐旅游巴士到达景区入口，并沿着自己选择的任意路径走到景区出口，再乘坐旅游巴士离开，这意味着他到达和离开景区的时间都必须是 **$k$ 的非负整数倍**。由于节假日客流众多，**小 Z 在旅游巴士离开景区前只想一直沿着景区道路移动，而不想在任何地点（包括景区入口和出口）或者道路上停留**。

出发前，小 Z 忽然得知：景区采取了限制客流的方法，对于每条道路均设置了一个
“开放时间”$a _ i$，游客只有**不早于 $a _ i$ 时刻**才能通过这条道路。

请帮助小 Z 设计一个旅游方案，使得他乘坐旅游巴士离开景区的时间尽量地早。
## 输入格式

输入的第一行包含 3 个正整数 $n, m, k$，表示旅游景点的地点数、道路数，以及旅游巴士的发车间隔。

输入的接下来 $m$ 行，每行包含 3 个非负整数 $u _ i, v _ i, a_ i$，表示第 $i$ 条道路从地点 $u _ i$ 出发，到达地点 $v _ i$，道路的“开放时间”为 $a _ i$。
## 输出格式

输出一行，仅包含一个整数，表示小 Z 最早乘坐旅游巴士离开景区的时刻。如果不存在符合要求的旅游方案，输出 `-1`。
## 样例

### 样例输入 #1
```
5 5 3
1 2 0
2 5 1
1 3 0
3 4 3
4 5 1
```
### 样例输出 #1
```
6
```
## 提示

**【样例 #1 解释】**

小 Z 可以在 $3$ 时刻到达景区入口，沿 $1 \to 3 \to 4 \to 5$ 的顺序走到景区出口，并在 $6$ 时刻离开。

**【样例 #2】**

见附件中的 `bus/bus2.in` 与 `bus/bus2.ans`。

**【数据范围】**

对于所有测试数据有：$2 \leq n \leq 10 ^ 4$，$1 \leq m \leq 2 \times 10 ^ 4$，$1 \leq k \leq 100$，$1 \leq u _ i, v _ i \leq n$，$0 \leq a _ i \leq 10 ^ 6$。

| 测试点编号 | $n \leq$ | $m \leq$ | $k \leq$ | 特殊性质 |
|:-:|:-:|:-:|:-:|:-:|
| $1 \sim 2$ | $10$ |$15$ | $100$ | $a _ i = 0$ |
| $3 \sim 5$ | $10$ | $15$ | $100$ | 无 |
| $6 \sim 7$ | $10 ^ 4$ | $2 \times 10 ^ 4$ | $1$ | $a _ i = 0$ |
| $8 \sim 10$ | $10 ^ 4$ | $2 \times 10 ^ 4$ | $1$ | 无 |
| $11 \sim 13$ | $10 ^ 4$ | $2 \times 10 ^ 4$ | $100$ | $a _ i = 0$ |
| $14 \sim 15$ | $10 ^ 4$ | $2 \times 10 ^ 4$ | $100$ | $u _ i \leq v _ i$ |
| $16 \sim 20$ | $10 ^ 4$ | $2 \times 10 ^ 4$ | $100$ | 无 |


---

---
title: "[COCI 2022/2023 #3] Bomboni"
layout: "post"
diff: 普及+/提高
pid: P9759
tag: ['2022', 'COCI（克罗地亚）']
---
# [COCI 2022/2023 #3] Bomboni
## 题目描述

Iva 是一个狂热的糖果迷！在她面前是一块填满糖果和障碍的 $n\times n$ 的土地。Iva 目前在左上角。通过向右或向下移动，她要前往右下角。Iva 目前所在的格子没有障碍。

在每个格子中写了一个数字表示此地为糖果或障碍。Iva 会吃掉所有经过的糖果（包括起点和终点的糖果）并且将糖果对应的数字相乘。Iva 知道她自己最喜欢的数字是 $k$，所以她希望这个乘积结果能被 $k$ 整除。她想知道一共有多少条这样的路径。由于答案可能很大，她只想知道答案模 $998244353$ 的结果。
## 输入格式

第一行两个整数 $n,k$，表示土地的边长和 Iva 的最喜欢的数字。

在接下来的 $n$ 行中，每一行 $n$ 个数字，描述这片土地。如果 $a_{i,j}=-1$，那么这块土地就是障碍物，否则满足这块土地包含一个 $1\le a_{i,j}\le 10^6$ 的数。
## 输出格式

一行一个整数表示结果。
## 样例

### 样例输入 #1
```
2 2
3 2
1 4
```
### 样例输出 #1
```
2
```
### 样例输入 #2
```
3 6
5 2 -1
7 3 6
-1 3 1
```
### 样例输出 #2
```
3
```
## 提示

**【样例解释 #2】**

共有三条这样的路线：
- 5-2-3-3-1
- 5-2-3-6-1
- 5-7-3-6-1

**【数据范围】**

| 子任务 | 分值 | 特殊性质 |
| :----------: | :----------: | :----------: |
| $1$ | $13$ | $n,k,a_{i,j} \leq 20$ |
| $2$ | $17$ | $n,k \leq 20$ |
| $3$ | $33$ | $k\le 20$ |
| $4$ | $47$ | 无特殊性质 |

对于 $100\%$ 的数据，满足 $1\leq n \leq 500,1\le k\le 10^6, -1\le a_{i,j}\le 10^6$。

本题满分 $110$ 分。


---

---
title: "[HUSTFC 2023] 新取模运算"
layout: "post"
diff: 普及+/提高
pid: P9774
tag: ['2023', 'O2优化', '高校校赛']
---
# [HUSTFC 2023] 新取模运算
## 题目描述

在这道题中，我们定义一个新的运算符号 $\oplus$ 并将其称为新取模运算。

当计算 $x \oplus y$ 时，如果 $x$ 不是 $y$ 的倍数，则得到 $x$ 除以 $y$ 的余数; 否则令 $x$ 不断除以 $y$ 直到 $x$ 不再是 $y$ 的倍数，假设它为 $x'$，然后得到 $x'$ 除以 $y$ 的余数。例如，$4\oplus 5=4$，$20\oplus 5=4$，$100\oplus 5=4$。

给定一个质数 $p$，接下来会有多组询问，对于每次询问会给出一个整数 $n$，你需要计算出 $n!\oplus p$ 的值。其中 $n!$ 是 $n$ 的阶乘，即所有小于等于 $n$ 的正整数的乘积。
## 输入格式

第一行包含两个整数 $T\ (1\le T\le 10^5)$ 和 $p\ (2\le p\le 10^6)$，分别表示询问的次数和给定的质数。

接下来 $T$ 行，每行包含一个整数 $n\ (1\le n\le 10^{18})$，含义如题目所述。
## 输出格式

对于每次询问，输出一行包含一个整数，即 $n!\oplus p$ 的值。
## 样例

### 样例输入 #1
```
3 7
11
45
14
```
### 样例输出 #1
```
4
1
2

```
### 样例输入 #2
```
2 10007
1919
810
```
### 样例输出 #2
```
3152
3679

```


---

---
title: "[NERC 2018] Easy Chess"
layout: "post"
diff: 普及+/提高
pid: P9795
tag: ['2018', 'Special Judge', 'ICPC']
---
# [NERC 2018] Easy Chess
## 题目背景

翻译自 [NERC 2018](https://neerc.ifmo.ru/archive/2018/neerc-2018-statement.pdf) E 题。
## 题目描述

Elma 正在学习象棋。

Elma 是个新手，她还不特别了解象棋是如何下的，所以，为了更好地让她了解象棋，她的奶奶让她从一个棋盘（如下图）中进行 $n$ 次移动，每次移动只能是水平或垂直地移动若干个格子的，且每个点只能到达一次，使得从 a1 到 h8 处。

![](https://cdn.luogu.com.cn/upload/image_hosting/zlooykdb.png)
## 输入格式

输入一个数 $n(2 \leq n \leq 63)$，表示你一共需要走的步数。
## 输出格式

给出一种可行方案且保证停留过的点不重复。
## 样例

### 样例输入 #1
```
4
```
### 样例输出 #1
```
a1 f1 c1 c8 h8
```
## 提示

对于所有数据保证 $2 \leq n \leq 63$ 且保证存在至少一种合法方案。


---

---
title: "[CCC 2015 S4] Convex Hull"
layout: "post"
diff: 普及+/提高
pid: P9813
tag: ['2015', 'CCC（加拿大）']
---
# [CCC 2015 S4] Convex Hull
## 题目描述

给定一个 $n$ 个点，$m$ 条边的无向图，每条边有两个边权 $t_{i}$ 和 $h_{i}$。

你需要找到一条从 $s$ 到 $t$ 的路径，满足路径上边的 $h_{i}$ 之和 $<k$ 且 $t_{i}$ 之和最小，只需要输出这个最小值即可，如果无法找到满足条件的路径，输出 $-1$。
## 输入格式

第一行三个整数 $k,n,m$。

接下来 $m$ 行，每行四个整数 $u_{i},v_{i},t_{i},h_{i}$ 表示一条从 $u_{i}$ 到 $v_{i}$ 的路径，边权为 $\{t_{i},h_{i}\}$。

最后一行两个整数 $s,t$。
## 输出格式

当存在满足条件的路径时，输出一行一个整数表示满足条件的最小 $t_{i}$ 之和。

否则输出一行 $-1$。
## 样例

### 样例输入 #1
```
10 4 7
1 2 4 4
1 3 7 2
3 1 8 1
3 2 2 2
4 2 1 6
3 4 1 1
1 4 6 12
1 4
```
### 样例输出 #1
```
7
```
### 样例输入 #2
```
3 3 3
1 2 5 1
3 2 8 2
1 3 1 3
1 3
```
### 样例输出 #2
```
-1
```
## 提示

**【数据范围】：**

对于 $20\%$ 的数据，$k = 1$，$2 \leq n \leq 200$。

对于另外 $20\%$ 的数据，$k = 1$，$2 \leq n \leq 2 \times 10^{3}$。

对于 $100\%$ 的数据，$0 \leq h_{i} \leq 200$，$1 \leq t_{i} \leq 10^{5}$，$1 \leq k \leq 200$，$2 \leq n \leq 2 \times 10^{3}$，$1 \leq m \leq 10^{4}$，$s \neq t$。


---

---
title: "少项式复合幂"
layout: "post"
diff: 普及+/提高
pid: P9816
tag: ['O2优化']
---
# 少项式复合幂
## 题目背景

> I have won everything except your heart.

终于，小 Z 可以玩一年原神了。但在此之前，他决定做出这道题，以纪念自己对【数据删除】的感情。
## 题目描述

给定多项式 $f(x)=\sum_{i=1}^ma_ix^{b_i}$。定义 $f_1(x)=f(x)$，$f_n(x)=f(f_{n-1}(x))$。

给定模数 $p$。有 $q$ 次询问，每次给出 $x,y$，查询 $f_y(x)\bmod p$ 的值。

**请注意 $m,p$ 的特殊数据范围。**
## 输入格式

输入的第一行包含三个正整数 $m,q,p$，分别为 $f$ 的项数，询问次数和给定模数。

随后 $m$ 行，每行读入两个非负整数 $a_i,b_i$，用于描述多项式 $f$。

随后 $q$ 行，每行两个正整数 $x,y$，表示一次询问。
## 输出格式

输出共 $q$ 行，每行包含对应询问的答案。
## 样例

### 样例输入 #1
```
3 5 71
1 1
3 3
1 0
7 5
9 6
10 1
5 6
7 6
```
### 样例输出 #1
```
27
11
29
2
5
```
## 提示

#### 样例解释

样例 1 中 $f(x)=3x^3+x+1$。以第 3 次询问为例，$f_1(10)=f(10)=3\times10^3+10+1=3011\equiv 29 \pmod {71}$。

#### 数据范围与约定

|测试点编号|$y$|$m$|$q$|特殊性质|
|:-:|:-:|:-:|:-:|:-:|
|$1\sim 3$|$\le 10$|$\le 20$|$\le 10^3$|无|
|$4\sim 7$|$\le 10^3$|$\le 20$|$\le 10^4$|无|
|$8,9$|$\le 10^7$|$\le 1$|$\le 3\times 10^5$|A|
|$10$|$\le 10^7$|$\le 1$|$\le 3\times 10^5$|无|
|$11,12$|$\le 10^7$|$\le 2$|$\le 10^5$|A、B|
|$13$|$\le 10^7$|$\le 2$|$\le 10^5$|B|
|$14\sim 16$|$\le 10^7$|$\le 20$|$\le 500$|无|
|$17\sim 20$|$\le 10^7$|$\le 20$|$\le 3\times 10^5$|无|
- 特殊性质 A：保证 $p$ 为质数。
- 特殊性质 B：保证 $b_i\le 1$。

对于所有数据，保证 $1\le m\le 20$，$0\le a_i,b_i\le 10^5$，$2\le p\le 10^5$，$1\le q\le 3\times 10^5$，$1\le x,y\le 10^7$。


---

---
title: "[USACO05OPEN] Lazy Cows G"
layout: "post"
diff: 普及+/提高
pid: P9832
tag: ['2005', 'USACO']
---
# [USACO05OPEN] Lazy Cows G
## 题目描述

地母是这个世界上大地的主宰，在她眼中整个大地呈现两行 $n$ 列的一个状态。在这个大地上如珍珠般散落着各种宝藏，每个宝藏占据一个格子。不过这个消息让天公知道了，他想抢走这些宝藏。地母决定用「无极」牌帆布盖住这些宝藏。

「无极」牌帆布是矩形状的，而且地母现在手头比较紧，她决定用 $k$ 块帆布盖住所有的宝藏。现在希望你求出这 $k$ 块帆布的面积之和的最小值。
## 输入格式

第一行给出三个数，分别代表宝藏的个数 $m$，帆布的张数 $k$，以及整个大地所呈现的列数 $n$，下面 $m$ 行给出两个数，代表每个宝藏所在的位置。
## 输出格式

输出一行一个数，帆布面积之和的最小值。
## 样例

### 样例输入 #1
```
8 2 9
1 2
1 6
1 7
1 8
1 9
2 2
2 3
2 4
```
### 样例输出 #1
```
10
```
## 提示

对于 $100\%$ 的数据，$1 \leq n \leq 1.5 \times 10^7$，$1 \leq k \leq m \leq 10^3$。


---

---
title: "[USACO05OPEN] Expedition G"
layout: "post"
diff: 普及+/提高
pid: P9833
tag: ['2005', 'USACO']
---
# [USACO05OPEN] Expedition G
## 题目描述

一群奶牛抢了一辆卡车决定前往树林里探险，但是由于它们的驾驶技术太糟，油箱在路上给弄破了，所以它们每前进一个单位的路程就会漏掉一个单位的油。

为了修好油箱，奶牛们必须前往最近的城市（不会超过 $10^6$ 单位路程）。  
在当前位置和城市之间有 $n$ 个加油站．奶牛可以在加油站加 $1$ 到 $100$ 单位的油。  

对于人来说，树林是个危险的地方；对奶牛来说，更是这样。  所以，奶牛要尽可能的少停站加油，幸运的是，这辆卡车的油箱非常大，你可以认为它的容量是无穷大的。  
卡车在离城 $l$ 个单位时还有 $p$ 个单位的油，你要算出奶牛们至少要停几站才能到城市，或者奶牛们根本到不了城市。
## 输入格式

第一行，一个整数 $n$。

第二到 $n+1$ 行，每行有两个用空格隔开的整数，描述一个加油站。第一个数表示这个加油站离城市的距离，第二个数表示在这个加油站最多可以加多少油。

第 $n+1$ 行：两个用空格分开的整数 $l$ 和 $p$。
## 输出格式

一个表示卡车到城市最少要停的次数，如果无法到达输出 `-1`。
## 样例

### 样例输入 #1
```
4
4 4
5 2
11 5
15 10
25 10

```
### 样例输出 #1
```
2
```
## 提示

对于 $100\%$ 的数据，$1\leq n\leq 10^4$，$1\leq p\leq 1000000$。


---

---
title: "[USACO05OPEN] Around the world G"
layout: "post"
diff: 普及+/提高
pid: P9834
tag: ['2005', 'USACO']
---
# [USACO05OPEN] Around the world G
## 题目描述

这些年，农夫约翰在国际上交了一大批开农场的朋友。由于他有一段时间没有去见过英国的农夫泰德和荷兰的农夫波尔，所以他想去拜访他们。

他知道每个朋友的农场的经度（是一个从 $0$ 到 $359$ 的整数，我们把地球看成一个圆，经度在此圆上顺时针方向递增）。  

农夫约翰打算乘飞机去拜访他的 $n$ 个朋友（用 $1$ 到 $n$ 来表示）。他知道在这些农场之间有 $m$ 条双向的航线。飞机是沿着地面上最短的路径飞行的（就是圆上的最短弧长）。两个农场之间的航线一定是最短的。

保证如果有两个农场在直径两端，那么它们之间一定不会被某条航线直接连接。

所以任何一次航行都可以被描述成顺时针或是逆时针的．比如说，经度 $30$ 到经度 $35$ 是顺时针的，经度 $350$ 到经度 $10$ 也是顺时针的，而经度 $350$ 到经度 $200$ 是逆时针的。

农夫约翰为了耍酷，决定要经过几个朋友的农场做到环球旅行，他想知道这是否可能，如果可能最少要乘几次飞机。

他想在他最好的朋友（即输入中的第一个）的农场上开始和结束这次旅行。为了保证这是一次环球航行，结束旅行，顺时针经过的路程不能等于逆时针经过的路程。
## 输入格式

第一行两个用空格隔开的整数 $n$ 和 $m$。

第二到 $n+1$ 行：第 $i+1$ 行有一个整数，表示第 $i$ 个农场的经度。第二行是他的最好的朋友的地址。

第 $n+2$ 过程 $n+m+1$ 行：第 $i+n+1$ 行有两个整数，表示这两个农场之间有航线。
## 输出格式

一个整数，表示农夫约翰至少要乘几次飞机才能完成环球旅行。每次农夫约翰从一个农场前往另一个农场算作乘一次飞机。如果不可能做到环球旅行则输出 `-1`。
## 样例

### 样例输入 #1
```
3 3
0
120
240
1 2
2 3
1 3

```
### 样例输出 #1
```
3
```
## 提示

对于 $100\%$ 的数据，$1 \leq n \leq 5 \times 10^3$，$1 \leq m \leq 2.5 \times 10^4$。


---

---
title: "[USACO05OPEN] Landscaping G"
layout: "post"
diff: 普及+/提高
pid: P9835
tag: ['2005', 'USACO']
---
# [USACO05OPEN] Landscaping G
## 题目描述

农夫约翰正在做一次艰难的转型，从养山羊改成养奶牛，他的农场，由于是为养山羊而设计的所以有太多的山，为了养牛就必须将它整平。但是，将山整平是件很花钱的工作，所以他要移走尽可能少的土。

由于农场很细长，所以可以用一个 $n$ 和 $n$ 个整数（范围 $[1,10^6]$）组成的二维的数组来表示，如：

```
1 2 3 3 3 2 1 3 2 2 1 2
```

上述农场的侧面图是这样的：

```
    * * *     *
  * * * * *   * * *   *
* * * * * * * * * * * *
1 2 3 3 3 2 1 3 2 2 1 2
```

一个或是一些连续等高的地面，如果它左边或是右边的海拔都比它低的话，就被称为山顶，上面的例子就有三个山顶。 确定如果要使地图上仅有 $k$ 个山顶，至少要移走多少体积的土（每块地面减少一单位海拔需移走一单位的土）。注意，地面的海拔只能被降低不能被升高。 对于例子，如果要减少到只有 $1$ 个山顶，这需要移走 $2+1+1+1=5$ 个单位的土（`-` 表示移走的土）：

```
    * * *     -
  * * * * *   - - -   -
* * * * * * * * * * * *
1 2 3 3 3 2 1 3 2 2 1 2
```
## 输入格式

第 $1$ 行输入整数 $n$ 和 $k$。

之后 $n$ 行，每行输入一个整数，表示这块地的海拔。
## 输出格式

如果仅能有 $k$ 个山顶至少要移走多少土。
## 样例

### 样例输入 #1
```
12 1
1
2
3
3
3
2
1
3
2
2
1
2

```
### 样例输出 #1
```
5
```
## 提示

对于 $100\%$ 的数据，$1 \leq n \leq 10^3$，$1 \leq k \leq 25$。


---

---
title: "[ICPC 2021 Nanjing R] Paimon Sorting"
layout: "post"
diff: 普及+/提高
pid: P9843
tag: ['2021', 'Special Judge', 'O2优化', 'ICPC', '南京']
---
# [ICPC 2021 Nanjing R] Paimon Sorting
## 题目描述

Paimon just invents a new sorting algorithm which looks much like $\textit{bubble sort}$, with a few differences. It accepts a $1$-indexed sequence $A$ of length $n$ and sorts it. Its pseudo-code is shown below.

```cpp
// The Sorting Algorithm
SORT(A)
  for i from 1 to n // n is the number of elements if A
    for j from 1 to n
      if a[i] < a[j] // a[i] is the i-th element in A
        Swap a[i] and a[j]
```


If you don't believe this piece of algorithm can sort a sequence it will also be your task to prove it. Anyway here comes the question:

Given an integer sequence $A = a_1, a_2, \cdots, a_n$ of length $n$, for each of its prefix $A_k$ of length $k$ (that is, for each $1 \le k \le n$, consider the subsequence $A_k = a_1, a_2, \cdots, a_k$), count the number of swaps performed if we call $\text{SORT}(A_k)$.
## 输入格式

There are multiple test cases. The first line of the input contains an integer $T$ indicating the number of test cases. For each test case:

The first line contains an integer $n$ ($1 \le n \le 10^5$) indicating the length of the sequence.

The second line contains $n$ integers $a_1, a_2, \cdots, a_n$ ($1 \le a_i \le n$) indicating the given sequence.

It's guaranteed that the sum of $n$ of all test cases will not exceed $10^6$.
## 输出格式

For each test case output one line containing $n$ integers $s_1, s_2, \cdots, s_n$ separated by a space, where $s_i$ is the number of swaps performed if we call $\text{SORT}(A_i)$.

Please, DO NOT output extra spaces at the end of each line or your solution may be considered incorrect!
## 样例

### 样例输入 #1
```
3
5
2 3 2 1 5
3
1 2 3
1
1

```
### 样例输出 #1
```
0 2 3 5 7
0 2 4
0

```
## 题目翻译

给出一个排序算法（用伪代码表示）：

```cpp
// 排序算法
SORT(A)
  for i from 1 to n // n 是序列 A 的元素个数
    for j from 1 to n
      if a[i] < a[j] // a[i] 是序列 A 的第 i 个元素
        Swap a[i] and a[j]

```

请你算出对于一个序列 $A=a_1,a_2,\cdots,a_n$ 的所有前缀 $A_k=a_1,a_2,\cdots,a_k$（$1\le k\le n$），$\operatorname{SORT}(A_k)$ 中的交换（Swap）操作将会被执行几次。


---

---
title: "[CCC 2008 J5/S5] Nukit"
layout: "post"
diff: 普及+/提高
pid: P9862
tag: ['2008', 'CCC（加拿大）']
---
# [CCC 2008 J5/S5] Nukit
## 题目背景

注：J5 与 S5 仅数据范围有所不同，在此选取 S5 的数据范围及数据进行评测。
## 题目描述

Canada’s top two nuclear scientists, Patrick and Roland, have just completed the construction of the world’s first nuclear fission reactor. Now it is their job to sit and operate the reactor all day, every day. Naturally they got a little bored after doing this for a while and as a result, two things have happened. First, they can now control the individual reactions that happen inside the reactor. Second, to pass the time, they have invented a new game called Nukit.

At the beginning of Nukit, a number of particles are put in the reactor. The players take alternating turns, with Patrick always going first. When it is a player’s turn to move, they must select some of the remaining particles to form one of the possible reactions. Then those particles are destroyed. Eventually there will be so few particles that none of the reactions can be formed; at this point, the first person who is unable to form a reaction on their turn loses.

In our universe you can assume that there are only $4$ types of particles: `A`, `B`, `C`, `D`. Each reaction is a list of particles that can be destroyed on a single turn. The five reactions are:

$1.$ `AABDD`

$2.$ `ABCD`

$3.$ `CCD`

$4.$ `BBB`

$5.$ `AD`

For example, the first reaction `AABDD` says that it is allowable to destroy two `A`, one `B`, and two `D` particles all at the same time on a turn.

It turns out that, no matter how many particles start off in the reactor, exactly one of Patrick or Roland has a perfect winning strategy. By player $X$ has a perfect winning strategy, we mean that no matter what the other player does, player $X$ can always win by carefully choosing reactions.

For example, if the reactor starts off with one `A`, five `B`, and three `D` particles then Roland has the following perfect winning strategy: “if Patrick forms reaction `BBB` initially, then form reaction `AD` afterward; if Patrick forms reaction AD initially, then form reaction `BBB` afterward.” (The strategy works because either way, on Patrick’s second turn, there are not enough particles left to form any reactions.)

Given the number of each type of particle initially in the reactor, can you figure out who has a perfect winning strategy?
## 输入格式

The first line of input contains $n$, the number of test cases $(1 \leq n < 100)$. Each test case consists of $4$ integers separated by spaces on a single line; they represent the initial number of `A`, `B`, `C` and `D` particles. You can assume that there are initially between $0$ and $30$ (inclusive) of each type of particle.
## 输出格式

For each test case, output the player who has a perfect winning strategy, either `Roland` or `Patrick`.
## 样例

### 样例输入 #1
```
6
0 2 0 2
1 3 1 3
1 5 0 3
3 3 3 3
8 8 6 7
8 8 8 8
```
### 样例输出 #1
```
Roland
Patrick
Roland
Roland
Roland
Patrick
```
## 提示

Partial Explanation for Sample Output:

The first output occurs since Patrick loses immediately, since he cannot form any reaction. (Roland’s perfect winning strategy is “do nothing.”)

The second output occurs since Patrick has the perfect winning strategy “form reaction ABCD,” which makes Roland lose on his first turn.

The third output is explained in the problem statement.
## 题目翻译

Patrick 和 Roland 在玩一个游戏，它的规则如下：

初始时给你 $4$ 个整数（每个整数的大小都不超过 $30$），依次表示：

- 当前 `A` 字符的个数；
- 当前 `B` 字符的个数；
- 当前 `C` 字符的个数；
- 当前 `D` 字符的个数。

每次操作，可以选择下面 $5$ 个操作方式进行操作：

1. `AABDD`
2. `ABCD`
3. `CCD`
4. `BBB`
5. `AD`

举个例子，当选择了 `AABDD` 时，就说明你想要删除 $2$ 个 `A`，$1$ 个 `B`，$2$ 个 `D`。其他的同理。

但是请注意，**如果当前某个字符数量小于你所要删除的那个字符的数量**，你便不能执行该操作。

如果每个操作都无法执行的话，便视为输掉此游戏。

现在他们想要玩 $n$ 轮游戏 $(1 \leq n < 100)$，每轮游戏 Patrick 先手，Roland 后手。假设两人都足够聪明。如果 Patrick 赢了，输出 `Patrick`，否则输出 `Roland`。


---

---
title: "[POI 2021 ~2022R2] arm"
layout: "post"
diff: 普及+/提高
pid: P9863
tag: ['POI（波兰）', '2021', '2022']
---
# [POI 2021 ~2022R2] arm
## 题目背景

翻译自 [POI2021-2022R2 Day0 试机题](https://szkopul.edu.pl/problemset/problem/gxeCvLD1xW1t-Y33bbC0n3wZ/statement/)。

## 题目描述

初始时你有 $1$ 个物品，你需要将物品的数量按若干次以下步骤增加到 $> n$ 个。

- 选择 $1$：将物品数量存储进数据库中，耗费 $a$ 的时间。
- 选择 $2$：使物品数量增加等同于数据库中的数量，耗费 $b$ 的时间。

初始时数据库为空，问最小操作次数。
## 输入格式

输入一行，共三个整数 $n,a,b\ (1 \leq n \leq 10^{18},1 \leq a,b \leq 10^9)$。
## 输出格式

输出最小的操作次数。
## 样例

### 样例输入 #1
```
8 2 1
```
### 样例输出 #1
```
8
```
## 提示

样例解释：

初始时你有一个物品。  
先进行一次扫描，耗费 $2$ 时间。  
然后打印 $2$ 次，耗费 $1 \times 2 = 2$ 时间，数量增加到 $3$。  
继续进行扫描，耗费 $2$ 时间。  
最后再打印 $2$ 次，耗费 $1 \times 2 = 2$ 时间，数量变为 $9$。

子任务分配：

| 子任务编号 | 特殊性质 | 分值 |
| :-----------: | :-----------: | :-----------: |
| $1$ | $a = b = 1$ | $10$ |
| $2$ | $n \leq 10^3$ | $40$ |
| $3$ | $n \leq 10^5$ | $15$ |
| $4$ | $n \leq 10^9$ | $15$ |
| $5$ | 无特殊限制 | $20$ |

子任务 $0$ 为样例。


---

---
title: "[POI 2021 ~2022R2] lic"
layout: "post"
diff: 普及+/提高
pid: P9865
tag: ['POI（波兰）', '2021', '2022']
---
# [POI 2021 ~2022R2] lic
## 题目背景

翻译自 [POI2021~2022R2 Day1T2](https://szkopul.edu.pl/problemset/problem/kQ5ExYNkFhx3K2FvVuXAAbn4/statement/)。
## 题目描述

定义 $a$ 的「不友好数」$b$ 为 $\gcd(a,b)=1$ 的数。

现在你知道了数字 $n$，你需要求出它的「不友好数」升序排序第 $k$ 个开始后的 $c$ 个数。
## 输入格式

一行，三个数 $n,k,c\ (2 \leq n \leq 10^{14}, 1 \leq k \leq 10^{14}, 1 \leq c \leq 10^5)$。
## 输出格式

输出 $c$ 个数，表示第 $k \sim k+c-1$ 个 $n$ 的「不友好数」。
## 样例

### 样例输入 #1
```
10 3 4
```
### 样例输出 #1
```
7 9 11 13
```
## 提示

样例解释：

$10$ 的「不友好数」依次为 $1,3,7,9,11,13,17\ldots$。

子任务分配如下：

| 子任务编号 | 特殊性质 | 分值 |
| :----------- | :----------- | :----------- |
| $1$ | $n \leq 10^6$ 且 $M \leq n$ | $10$ |
| $2$ | $f(n) \leq 10^6$ 且 $M \leq n$ | $36$ |
| $3$ | $c \leq 100$ | $30$ |
| $4$ | 无特殊限制 | $24$ |

上述 $M$ 为输出的最大值，$f(n)$ 为 $\leq n$ 的「不友好数」数量。


---

---
title: "[EC Final 2021] Fenwick Tree"
layout: "post"
diff: 普及+/提高
pid: P9883
tag: ['2021', 'Special Judge', 'O2优化', 'ICPC']
---
# [EC Final 2021] Fenwick Tree
## 题目描述

Prof. Pang is giving a lecture on the Fenwick tree (also called binary indexed tree). 

In a Fenwick tree, we have an array $c[1\ldots n]$ of length $n$ which is initially all-zero ($c[i]=0$ for any $1\le i\le n$). Each time, Prof. Pang can call the following procedure for some position $pos$ ($1\leq pos \leq n$) and value $val$:

```cpp
def update(pos, val):
    while (pos <= n):
        c[pos] += val
        pos += pos & (-pos)
```

Note that `pos & (-pos)` equals to the maximum power of $2$ that divides `pos` for any positive integer `pos`. 

In the procedure, $val$ can be **any real** number. After calling it some (zero or more) times, Prof. Pang forgets the exact values in the array $c$. He only remembers whether $c[i]$ is zero or not for each $i$ from $1$ to $n$. Prof. Pang wants to know what is the minimum possible number of times he called the procedure assuming his memory is accurate.
## 输入格式

The first line contains a single integer $T~(1 \le T \le 10^5)$ denoting the number of test cases.

For each test case, the first line contains an integer $n~(1 \le n \le 10 ^ 5)$. The next line contains a string of length $n$. The $i$-th character of the string is `1` if $c[i]$ is nonzero and `0` otherwise. 

It is guaranteed that the sum of $n$ over all test cases is no more than $10^6$.
## 输出格式

For each test case, output the minimum possible number of times Prof. Pang called the procedure. It can be proven that the answer always exists.
## 样例

### 样例输入 #1
```
3
5
10110
5
00000
5
11111

```
### 样例输出 #1
```
3
0
3

```
## 提示

For the first example, Prof. Pang can call `update(1,1)`, `update(2,-1)`, `update(3,1)` in order.

For the third example, Prof. Pang can call `update(1,1)`, `update(3,1)`, `update(5,1)` in order.
## 题目翻译

定义一次「操作」为选定任意一个 $pos$ 和 $val$ 后对 $c$ 序列进行以下操作（显然就是树状数组的单点加操作）：

```python
def update(pos, val):
    while (pos <= n):
        c[pos] += val
        pos += pos & (-pos)
```

给定序列长度 $n$ 和一个长度为 $n$ 的 $\texttt{01}$ 串 $s$，以及一个初始全为 $0$ 的序列 $c$。 求最少的操作数使得最终的 $c$ 序列满足 $\forall 1\le i\le n: s_i=\texttt0 \Leftrightarrow c_i=0,s_i=1\Leftrightarrow c_i\not=0$。 

你只需要输出最少的操作数。


---

---
title: "[COCI 2023/2024 #1] AN2DL"
layout: "post"
diff: 普及+/提高
pid: P9905
tag: ['2023', 'O2优化', 'COCI（克罗地亚）']
---
# [COCI 2023/2024 #1] AN2DL
## 题目描述

While wandering around Building $21$, you came across a wall completely covered with numbers, arranged in a table of $n$ rows and $m$ columns. Soon you noticed that there was a frame leaning against the wall large to frame $r$ rows and $s$ columns of the table on the wall. And next to the frame you found a pencil and
a piece of paper containing an empty table.

You are sad that the table on the piece of paper is empty, so you decided to play around with the frame to fill it.

You leaned the frame against the wall so that the number in the $i$-th row and $j$-th column is in the upper left corner, and the borders of the frame are parallel to the edges of the wall. Considering the numbers inside the frame, and since you like large numbers, you have decided to write the largest among them in the $i$-th row and $j$-th column of the table on the piece of paper.

You repeated the process for every possible position of the frame on the wall (such that the frame is
entirely on the wall, and that there are exactly $r \times s$ numbers inside it), making sure that the edges of the frame are parallel to the edges of the wall.

When you were done, the table on the piece of paper was even more beautiful than the one on the wall.What numbers are in the table on the piece of paper?

### 题目大意

给定 $n,m,r,s$ 和一个 $n\times m$ 的整数矩阵 $A$，求它每个 $r\times s$ 的子矩阵的元素最大值。
## 输入格式

第一行两个整数 $n,m$ 表示矩阵的高和宽。

接下来 $n$ 行每行 $m$ 个整数，表示矩阵 $A$。

最后一行两个整数 $r,s$。
## 输出格式

$n-r+1$ 行，每行 $m-s+1$ 个数，第 $i$ 行 $j$ 列的数表示以 $(i,j)$ 为左上角的 $r\times s$ 的子矩阵元素的最大值，即 $\max\limits_{i\leq x\leq i+r-1,j\leq y\leq j+s-1}A_{x,y}$。
## 样例

### 样例输入 #1
```
3 3
1 1 2
2 3 4
4 3 2
3 3
```
### 样例输出 #1
```
4
```
### 样例输入 #2
```
3 3
1 1 2
2 3 4
4 3 2
2 1
```
### 样例输出 #2
```
2 3 4
4 3 4
```
### 样例输入 #3
```
5 5
-1 -3 -4 -2 4
-8 -7 -9 -10 11
5 2 -8 -2 1
13 -3 -2 -6 -9
11 6 2 7 4
2 3
```
### 样例输出 #3
```
-1 -2 11
5 2 11
13 2 1
13 7 7
```
## 提示

### 【样例解释#1】

只有一个 $3\times 3$ 的子矩阵，且是整个矩阵，它的元素最大值是 $4$。

### 【样例解释#2】

矩阵和它的每个 $2\times 1$ 的子矩阵如下图所示，其中标红的数为最大值：

![](https://cdn.luogu.com.cn/upload/image_hosting/89liqsac.png)

### 【数据范围】

对于 $100\%$ 的数据，$1\leq n,m\leq 4000$，$\lvert A_{i,j}\rvert\leq 10000$，$1\leq r\leq n$，$1\leq s\leq m$。

**本题采用捆绑测试。**

| 子任务 | 特殊性质 | 分值 |
| :----------: | :----------: | :----------: |
| $1$ | $n,m\leq 40$，$r=n$，$s=m$ | $12$ |
| $2$ | $n,m\leq 40$ | $17$ |
| $3$ | $n,m\leq 1000$ | $25$ |
| $4$ | 无特殊性质 | $56$ |

### 【说明】

本题分值按 COCI 原题设置，满分 $110$。

题目译自 [COCI2022-2023](https://hsin.hr/coci/) [CONTEST #1](https://hsin.hr/coci/contest1_tasks.pdf) _**T3 AN2DL**_。
## 题目翻译

给定 $n,m,r,s$ 和一个 $n\times m$ 的整数矩阵 $A$，求它每个 $r\times s$ 的子矩阵的元素最大值。


---

---
title: "[COCI 2023/2024 #2] Kuglice"
layout: "post"
diff: 普及+/提高
pid: P9911
tag: ['2023', 'O2优化', 'COCI（克罗地亚）']
---
# [COCI 2023/2024 #2] Kuglice
## 题目描述

一个双端队列里面有 $n$ 个球，每个球有一个颜色。A 和 B 玩一个游戏：

A 先手，两个人轮流操作，每次从队列的最左端或者最右端拿出一个球，如果这种颜色的球是第一次被拿出，拿出它的人获得 $1$ 分。所有球都拿完后游戏结束。

假设 A 和 B 都以最优策略操作，请求出最终得分是多少。
## 输入格式

第一行一个整数 $n$。

第二行 $n$ 个整数 $a_{1\sim n}$ 表示从左到右每个球的颜色。
## 输出格式

输出一行两个以 `:` 隔开的整数（形如 `a:b`），`a` 表示 A 最终的得分，`b` 表示 B 最终的得分。
## 样例

### 样例输入 #1
```
5
1 1 2 1 1
```
### 样例输出 #1
```
1:1
```
### 样例输入 #2
```
6
1 2 3 1 2 3
```
### 样例输出 #2
```
2:1
```
## 提示

### 数据范围
|$\text{Subtask}$|分值|特殊性质|
|:-:|:-:|:-:|
|$1$|$17$|$a_i\le 2$|
|$2$|$10$|$n\le 20$|
|$3$|$26$|$a_i\le 20$|
|$4$|$15$|$n\le 300$|
|$5$|$42$|无|

对于所有数据，$1\le n\le 3000$，$1\le a_i\le n$。


---

---
title: "[COCI 2023/2024 #2] Zatopljenje"
layout: "post"
diff: 普及+/提高
pid: P9912
tag: ['2023', 'O2优化', 'COCI（克罗地亚）']
---
# [COCI 2023/2024 #2] Zatopljenje
## 题目描述

Mr. Malnar 有一张地形图，上面画着一个区域内每个位置的海拔高度。具体的，有 $n$ 个位置排成一排，第 $i$ 个位置高出海平面 $h_i$ 米。

海平面可能会上升。给定 $q$ 次询问，对于第 $i$ 次询问你需回答：如果海平面高度上升 $x_i$ 米，那么 $[l_i,r_i]$ 区间中会形成多少个岛？一个岛的定义为一个极长的，每个位置的高度都大于 $x_i$ 的段。

![](https://cdn.luogu.com.cn/upload/image_hosting/mffg52xn.png)

上图分别表示了样例 1 的第一组询问以及样例 2 的第二组询问。左图 $[2,5]$ 区间中有 $[2,2],[4,5]$ 两个岛，而右图中有 $[1,1],[4,4],[8,8],[10,10]$ 四个岛。
## 输入格式

第一行两个整数 $n,q$。

第二行 $n$ 个整数 $h_{1\sim n}$ 表示每个位置的初始海拔。

接下来 $q$ 行每行 $3$ 个整数 $l_i,r_i,x_i$ 表示一次询问。
## 输出格式

输出 $q$ 行，第 $i$ 行一个整数表示第 $i$ 次询问的答案。
## 样例

### 样例输入 #1
```
6 3
2 4 2 3 4 1
2 5 2
3 5 3
3 4 4
```
### 样例输出 #1
```
2
1
0
```
### 样例输入 #2
```
10 3
5 0 3 4 2 0 1 6 3 5
3 9 1
1 10 3
1 10 2
```
### 样例输出 #2
```
2
4
3
```
## 提示

### 数据范围
|$\text{Subtask}$|分值|特殊性质|
|:-:|:-:|:-:|
|$1$|$10$|$n,q\le 2000$|
|$2$|$20$|$l_i=1,r_i=n$|
|$3$|$20$|存在 $p\in [1,n]$ 满足 $h_1\ge h_2\ge \cdots \ge h_p\le h_{p+1}\le \cdots \le h_n$|
|$4$|$60$|无|

对于所有数据，$1\le n,q\le 2\times 10^5$，$0\le h_i,x_i\le 10^9$，$1\le l_i\le r_i\le n$。


---

---
title: "[NFLSPC #6] 等差数列"
layout: "post"
diff: 普及+/提高
pid: P9936
tag: ['O2优化']
---
# [NFLSPC #6] 等差数列
## 题目背景

![](https://cdn.luogu.com.cn/upload/image_hosting/asxexdko.png)

![](https://cdn.luogu.com.cn/upload/image_hosting/rzayzc9p.png)
## 题目描述

*Alek 岁*在某知名 OJ *代码力量*上做了 $a_i$ 道难度为 $i$ 的题。他希望做一些题使得 $a_i$ 形成 **公差非正** 的等差数列，这样画出来的统计图表很好看。

尽管 *Alek 岁*一天能做 42 道题，但他依然希望做尽可能少的题达到目标。你需要求出新做题数的最小值。

你可以认为 OJ 上有足够多的各种难度的题目。
## 输入格式

第一行一个整数 $T$ 表示数据组数。

对于每组数据：
- 第一行一个整数 $n$ 表示难度总数。
- 第二行 $n$ 个整数 $a_i$。
## 输出格式

对于每组数据，输出一行一个整数表示答案。
## 样例

### 样例输入 #1
```
6
2
822 1064
2
1064 822
4
1 3 4 2
4
2 4 3 1
6
2 6 2 1 4 4
9
9 9 8 2 4 4 3 5 3

```
### 样例输出 #1
```
242
0
6
4
17
25

```
## 提示

对于所有数据，$1\leq T\leq 100$，$1\leq n, \sum n\leq 10 ^ 5$，$1\leq a_i\leq 10 ^ 9$。

- 子任务 1（$30$ 分）：$\sum n \leq 10 ^ 3$。
- 子任务 2（$70$ 分）：无特殊限制。

Source：NFLSPC #6 L by Alex_Wei


---


---
title: "[厦门小学生 C++ 2023] 数据核心"
layout: "post"
diff: 普及+/提高
pid: B4157
tag: ['动态规划 DP', '2023', '福建', '根号分治', '小学科创活动']
---
# [厦门小学生 C++ 2023] 数据核心
## 题目背景

2023 年厦门市小学生 C++ 语言复赛试题，数据为洛谷自造。
## 题目描述

Sora 有一块神奇的数据核心，这块数据核心里有 $n\times m$ 个数据块，这些数据块组成了一个 $n\times m$ 的矩阵。

在数据核心中，每个数据块都有一个强度 $a_{i,j}$，代表这个数据块存在数据核心中时会提供多少的运算力。但是随着时间的推移，数据核心中有一些数据块出现了硬件老化，有些数据块的强度是一个负数，继续保留过多的老化数据块会影响数据核心的使用效率，所以 Sora 决定从原本的数据核心的矩阵中，先确定一个数据块作为新数据核心的左上角，其位置为 $(x, y)$ ，向右下方切割出一块数据核心（子矩阵），以保证其使用效率。

但是 Sora 是一个有着天马行空想象力的科学家，她想知道在确定了新的数据核心左上角的数据块的情况下，其位置为 $(x, y)$，新的数据核心（子矩阵）能够获得的最大运算力是多少。

当然她的问题很多，有 $Q$ 次询问，每次询问都会给出一个位置 $(x, y)$，你需要算出以这个位置为左上角的新数据核心对应的最大运算力。

## 输入格式

第一行两个整数 $n,m$，表示原始数据核心的大小。

接下来 $n$ 行，每行 $m$ 个整数，对应的是每个数据块的强度 $a_{i,j}$。

第 $n+2$ 行一个整数 $Q$，表示询问次数。
接下来 $Q$ 行，每行两个整数 $x,y$，表示新数据核心的左上角数据块在原数据核心中位于第 $x$ 行第 $y$ 列。
## 输出格式

输出 $Q$ 行，每行一个整数，表示对应询问的最大运算力。
## 样例

### 样例输入 #1
```
5 5
1 -1 1 -1 1
2 2 2 -1 2
1 1 2 -1 -1
-1 -1 2 2 1
1 1 1 1 -1
6
1 1
2 2
3 3
2 4
5 1
5 5
```
### 样例输出 #1
```
16
12
7
2
4
-1
```
## 提示

### 样例解释

- 第一个询问对应的新数据核心是 $(1,1)$ 到 $(5,5)$。
- 第二个询问对应的新数据核心是 $(2,2)$ 到 $(5,5)$。
- 第三个询问对应的新数据核心是 $(3,3)$ 到 $(5,4)$。
- 第四个询问对应的新数据核心是 $(5,1)$ 到 $(5,4)$。
- 第五个询问对应的新数据核心是 $(5,5)$ 到 $(5,5)$。

### 数据范围

- 对于 $20\%$ 的数据，$n\times m \leq 500$，$Q \leq 500$，$a_{i,j} \leq 10^5$。
- 对于 $50\%$ 的数据，$n\times m \leq 5000$，$Q \leq 5000$，$a_{i,j} \leq 10^5$。
- 对于 $80\%$ 的数据，$n\times m \leq 10000$，$Q \leq 10000$，$a_{i,j} ≤ 10^5$。
- 对于 $100\%$ 的数据，$n\times m \leq 100000$，$Q \leq 100000$，$|a_{i,j}| \leq 10^9$。


---

---
title: "[蓝桥杯 2025 省 C/Python A/Java C] 登山"
layout: "post"
diff: 普及+/提高
pid: P12169
tag: ['2025', '分治', '蓝桥杯省赛']
---
# [蓝桥杯 2025 省 C/Python A/Java C] 登山
## 题目描述

小蓝正在登山，山峰的高度构成 $n$ 行 $m$ 列的正整数矩阵，$a_{i,j}$ 表示第 $i$ 行第 $j$ 列格子 $(i,j)$ 上的山峰的高度。小蓝以一种特别的方式进行登山，如果他此刻在第 $p$ 行第 $q$ 列的格子 $(p,q)$ 上，那么下一步可以选择：

1. 走到格子 $(i,q)$，满足 $a_{i,q} < a_{p,q}$ 且 $i > p$；
2. 走到格子 $(i,q)$，满足 $a_{i,q} > a_{p,q}$ 且 $i < p$；
3. 走到格子 $(p,j)$，满足 $a_{p,j} < a_{p,q}$ 且 $j > q$；
4. 走到格子 $(p,j)$，满足 $a_{p,j} > a_{p,q}$ 且 $j < q$。

小蓝想知道，如果他依次从每一个格子开始出发，按照最优策略，他最高能到达的山峰的高度的平均值是多少？
## 输入格式

输入的第一行包含两个正整数 $n, m$，用一个空格分隔。

接下来 $n$ 行，每行包含 $m$ 个正整数。其中第 $i$ 行包含 $a_{i,1}, a_{i,2}, \cdots, a_{i,m}$，相邻整数之间使用一个空格分隔。
## 输出格式

输出一行包含一个实数表示答案，四舍五入保留正好 $6$ 位小数。
## 样例

### 样例输入 #1
```
2 2
1 3
3 2
```
### 样例输出 #1
```
2.500000
```
### 样例输入 #2
```
2 3
2 4 1
4 2 5
```
### 样例输出 #2
```
4.166667
```
## 提示

### 样例说明 1

除了从格子 $(1,1)$ 出发以外，其他格子都能到达高度为 $3$ 的山峰，$(1 + 3 + 3 + 3)/4 = 2.5$。

### 样例说明 2

每个格子能到达的高度：

$$\begin{matrix} 4 & 4 & 4 \\ 4 & 4 & 5\end{matrix}$$

其中 $(1,1)$ 可以先到达格子 $(1,3)$ 再到达格子 $(1,2)$。

### 评测用例规模与约定

- 对于 $40\%$ 的评测用例，$1 \leq n, m \leq 10^2$；
- 对于所有评测用例，$1 \leq n, m \leq 10^4$，$1 \leq n \times m \leq 10^6$，$1 \leq a_{ij} \leq 10^9$。


---

---
title: "[POI 2017 R2] 集装箱 Shipping containers"
layout: "post"
diff: 普及+/提高
pid: P12751
tag: ['2017', 'POI（波兰）', '根号分治']
---
# [POI 2017 R2] 集装箱 Shipping containers
## 题目背景

翻译来自于 [LibreOJ](https://loj.ac/p/5059)。
## 题目描述

**题目译自 [XXIV Olimpiada Informatyczna — II etap](https://sio2.mimuw.edu.pl/c/oi24-2/dashboard/) [Kontenery](https://szkopul.edu.pl/problemset/problem/oNnWY6ZuzzhvG-jCmijiXkIk/statement/)**

工程师 Bajtazar 负责管理一个集装箱装卸坡道。坡道由 $n$ 个连续位置组成，编号从 $1$ 至 $n$。每位位置上，起重机可堆放任意数量的集装箱，层层叠放。

部分集装箱装有危险物质，需避免过于密集堆放。

Bajtazar 收到 $k$ 项起重机操作指令，第 $i$ 项操作形如 $(a_i, \ell_i, d_i)$，表示从位置 $a_i$ 开始，每隔 $d_i$ 个位置放置一个集装箱，共放置 $\ell_i$ 个（即在位置 $a_i, a_i+d_i, a_i+2d_i, \ldots, a_i+(\ell_i-1)d_i$ 各放一个）。他想知道所有操作完成后，每位位置上的集装箱数量。
## 输入格式

第一行包含两个正整数 $n, k$，分别表示坡道位置数量和操作数量。

接下来的 $k$ 行描述操作，第 $i$ 行包含三个正整数 $a_i, \ell_i, d_i$，满足 $a_i+(\ell_i-1)d_i \leq n$。当 $\ell_i=1$ 时，保证 $d_i=1$。
## 输出格式

输出一行，包含 $n$ 个整数 $c_1, c_2, \ldots, c_n$，其中 $c_i$ 表示所有操作完成后位置 $i$ 上的集装箱数量。
## 样例

### 样例输入 #1
```
8 3
3 4 1
2 3 3
3 2 2
```
### 样例输出 #1
```
0 1 2 1 3 1 0 1
```
## 提示

**样例 1 解释**

每个集装箱上的编号对应将其放置在坡道上的操作序号。

![](https://cdn.luogu.com.cn/upload/image_hosting/49gtt0eh.png)

**附加样例**

1. $n=10, k=10$，随机样例。  
2. $n=11000, k=999, a_i=\ell_i=i+1, d_i=10$，对于 $i=1, 2, \ldots, k$。  
3. $n=100000, k=100000, \ell_1=\ell_2=\ldots=\ell_k=1$。

详细子任务附加限制及分值如下表所示。

| 子任务 | 附加限制 | 分值 |
| :---: | :--: | :---: |
| $1$    | $n \leq 1000, k \leq 2000$ | $21$ |
| $2$    | $n, k \leq 100000, d_1=d_2=\ldots=d_k$ | $33$ |
| $3$    | $n, k \leq 100000$       | $46$ |


---

---
title: "[蓝桥杯 2025 国 Java B] 道具摆放"
layout: "post"
diff: 普及+/提高
pid: P12890
tag: ['树状数组', '2025', '分治', '蓝桥杯国赛']
---
# [蓝桥杯 2025 国 Java B] 道具摆放
## 题目描述

小蓝是社区剧团的道具员，他负责管理一排编号为 $1$ 到 $N$ 的道具箱。平常，这些道具箱会按编号升序排列在舞台上。

今天晚上有一场重要的演出，演出开始前，导演小李递给小蓝一份清单，上面写着他想要的道具箱排列顺序：$P_1, P_2, \ldots, P_N$。导演希望小蓝在演出过程中将这排箱子调整成这个顺序。由于舞台空间狭小，每次调整只能交换相邻两个箱子的位置。且每完成一次交换，舞台灯光就会闪烁一次作为提示。

灯光系统有个特别的节奏设定：每进行 $M$ 次闪烁，灯光就会切换一种模式。为了配合这种节奏，导演强调：必须在某次灯光切换模式的那一瞬间完成所有调整工作。这意味着，小蓝完成调整所需的交换次数必须是 $M$ 的整数倍。

现在，请你帮小蓝计算一下，他最少需要多少次交换操作才能按照导演的要求完成调整。如果无论如何都无法满足要求，则输出 $-1$。

## 输入格式

第一行包含两个整数 $N$ 和 $M$，分别表示道具箱的数量和灯光模式切换的周期。

第二行包含 $N$ 个整数 $P_1, P_2, \ldots, P_N$，表示导演想要的道具箱排列顺序。
## 输出格式

输出一个整数，表示最少需要的操作次数。如果无法满足导演的要求，则输出 $-1$。
## 样例

### 样例输入 #1
```
3 2
3 1 2
```
### 样例输出 #1
```
2
```
### 样例输入 #2
```
3 3
1 2 3
```
### 样例输出 #2
```
0
```
### 样例输入 #3
```
3 2
1 3 2
```
### 样例输出 #3
```
-1
```
## 提示

**【评测用例规模与约定】**

对于 $50\%$ 的评测用例，$1 \leq N, M \leq 10^2$，$1 \leq P_i \leq N$，$P_1, P_2, \ldots, P_N$ 互不相同。

对于 $100\%$ 的评测用例，$1 \leq N \leq 10^5$，$1 \leq M \leq 10^9$，$1 \leq P_i \leq N$，$P_1, P_2, \ldots, P_N$ 互不相同。



---

---
title: "三元上升子序列"
layout: "post"
diff: 普及+/提高
pid: P1637
tag: ['线段树', '树状数组', '分治']
---
# 三元上升子序列
## 题目描述

Erwin 最近对一种叫 `thair` 的东西巨感兴趣。。。

在含有 $n$ 个整数的序列 $a_1,a_2,\ldots,a_n$ 中，三个数被称作`thair`当且仅当 $i<j<k$ 且 $a_i<a_j<a_k$。

求一个序列中 `thair` 的个数。
## 输入格式

开始一行一个正整数 $n$,

以后一行 $n$ 个整数 $a_1,a_2,\ldots,a_n$。
## 输出格式

一行一个整数表示 `thair` 的个数。
## 样例

### 样例输入 #1
```
4
2 1 3 4
```
### 样例输出 #1
```
2
```
### 样例输入 #2
```
5
1 2 2 3 4
```
### 样例输出 #2
```
7
```
## 提示

#### 样例2 解释

$7$ 个 `thair` 分别是：

- 1 2 3
- 1 2 4
- 1 2 3
- 1 2 4
- 1 3 4
- 2 3 4
- 2 3 4

#### 数据规模与约定

- 对于 $30\%$ 的数据 保证 $n\le100$；
- 对于 $60\%$ 的数据 保证 $n\le2000$；
- 对于 $100\%$ 的数据 保证 $1 \leq n\le3\times10^4$，$1\le a_i\leq 10^5$。


---

---
title: "寒假作业"
layout: "post"
diff: 普及+/提高
pid: P2717
tag: ['树状数组', 'cdq 分治']
---
# 寒假作业
## 题目背景

zzs 和 zzy 正在被寒假作业折磨，然而他们有答案可以抄啊。

## 题目描述

他们共有 $n$ 项寒假作业。zzy 给每项寒假作业都定义了一个疲劳值 $a_i$，表示抄这个作业所要花的精力。

zzs 现在想要知道，有多少组连续的寒假作业的疲劳值的平均值不小于 $k$？

简单地说，给定一个长度为 $n$ 的正整数序列 $\{a_i\}$，求出有多少个**连续**子序列的平均值不小于 $k$。

## 输入格式

第一行是两个整数，分别表示序列长度 $n$ 和给定的参数 $k$。

第二行有 $n$ 个整数，第 $i$ 个整数表示序列的第 $i$ 个数字 $a_i$。
## 输出格式

输出一行一个整数表示答案。
## 样例

### 样例输入 #1
```
3 2
1
2
3

```
### 样例输出 #1
```
4
```
## 提示

#### 样例 1 解释

共有 $6$ 个连续的子序列，分别是 $(1)$、$(2)$、$(3)$、$(1,2)$、$(2,3)$、$(1,2,3)$，平均值分别为 $1$、$2$、$3$、$1.5$、$2.5$、$2$，其中平均值不小于 $2$ 的共有 $4$ 个。

#### 数据规模与约定

- 对于 $20\%$ 的数据，保证 $n \leq 100$。
- 对于 $50\%$ 的数据，保证 $n \leq 5000$。
- 对于 $100\%$ 的数据，保证 $1 \leq n \leq 10^5$，$1 \leq a_i,k \leq 10^4$。


---

---
title: "[BJOI2016] 回转寿司"
layout: "post"
diff: 普及+/提高
pid: P5459
tag: ['2016', '线段树', '各省省选', '树状数组', '离散化', '北京', 'cdq 分治', 'O2优化']
---
# [BJOI2016] 回转寿司
## 题目描述

酷爱日料的小Z经常光顾学校东门外的回转寿司店。在这里，一盘盘寿司通过传送带依次呈现在小Z眼前。  

不同的寿司带给小Z的味觉感受是不一样的，我们定义小Z对每盘寿司都有一个满意度。  

例如小Z酷爱三文鱼，他对一盘三文鱼寿司的满意度为 $10$；小Z觉得金枪鱼没有什么味道，他对一盘金枪鱼寿司的满意度只有 $5$；小Z最近看了电影《美人鱼》，被里面的八爪鱼恶心到了，所以他对一盘八爪鱼刺身的满意度是 $-100$。   

特别地，小Z是个著名的吃货，他吃回转寿司有一个习惯，我们称之为“狂吃不止”。具体地讲，当他吃掉传送带上的一盘寿司后，他会毫不犹豫地吃掉它后面的寿司，直到他不想再吃寿司了为止。  

今天，小Z再次来到了这家回转寿司店，$N$ 盘寿司将依次经过他的面前。其中，小Z对第 $i$ 盘寿司的满意度为$a_i$。  

小Z可以选择从哪盘寿司开始吃，也可以选择吃到哪盘寿司为止。他想知道共有多少种不同的选择，使得他的满意度之和不低于 $L$，且不高于 $R$。

注意，虽然这是回转寿司，但是我们不认为这是一个环上的问题，而是一条线上的问题。即，小Z能吃到的是输入序列的一个连续子序列；最后一盘转走之后，第一盘并不会再出现一次。
## 输入格式

第一行三个正整数 $N,L,R$，表示寿司盘数，满意度的下限和上限。  
第二行包含 $N$ 个整数 $a_i$，表示小Z对寿司的满意度。  

## 输出格式

一行一个整数，表示有多少种方案可以使得小Z的满意度之和不低于 $L$ 且不高于 $R$。
## 样例

### 样例输入 #1
```
5 5 9
1 2 3 4 5
```
### 样例输出 #1
```
6
```
## 提示

【数据范围】  

$1\le N \le 10^5$  
$|a_i| \le 10^5$   
$0\le L,R \le 10^9$


---

---
title: "奶牛排队"
layout: "post"
diff: 普及+/提高
pid: P6510
tag: ['单调队列', 'NOI 导刊', 'O2优化', '分治', '栈']
---
# 奶牛排队
## 题目描述

奶牛在熊大妈的带领下排成了一条直队。

显然，不同的奶牛身高不一定相同……

现在，奶牛们想知道，如果找出一些连续的奶牛，要求最左边的奶牛 $A$ 是最矮的，最右边的 $B$ 是最高的，且 $B$ 高于 $A$ 奶牛。中间如果存在奶牛，则身高不能和 $A,B$ 奶牛相同。问这样的奶牛最多会有多少头？

从左到右给出奶牛的身高，请告诉它们符合条件的最多的奶牛数（答案可能是 $0,2$，但不会是 $1$）。
## 输入格式

第一行一个正整数 $N$，表示奶牛的头数。

接下来 $N$ 行，每行一个正整数，从上到下表示从左到右奶牛的身高 $h_i$。

## 输出格式

一行一个整数，表示最多奶牛数。
## 样例

### 样例输入 #1
```
5
1
2
3
4
1
```
### 样例输出 #1
```
4
```
## 提示

#### 样例解释

取第 $1$ 头到第 $4$ 头奶牛，满足条件且为最多。

#### 数据范围

对于全部的数据，满足 $2 \le N \le 10^5$，$1 \le h_i <2^{31}$。


---

---
title: "「RdOI R2」称重(weigh)"
layout: "post"
diff: 普及+/提高
pid: P7579
tag: ['二分', '2021', '三分', '交互题', 'Special Judge', '分治']
---
# 「RdOI R2」称重(weigh)
## 题目背景

因为 rui_er 是一个良心出题人，所以本题是一道交互题。
## 题目描述

rui_er 为了准备体测，买了 $n$ 个实心球准备练习，但是却发现在发货时混入了两个质量明显较轻但外观相似的球（这两个球质量相等），且已知这两个球的质量之和大于一个正常的球。为了防止影响训练效果，现在需要找出这两个球。因为手动找太慢了，现在拿来了一个天平，可以在两侧各放上若干个球，得到两侧的质量大小关系。请你帮帮 rui_er，在使用不超过 $k$ 次天平的情况下，找出这两个较轻的球。

这里 $k$ 是每个测试点的属性，你不必也不应该读入。

---

**交互方式**

本题采用 I/O 交互。

你可以选择进行称量操作，此时向标准输出打印一行 `1 p a1 a2 ... ap q b1 b2 ... bq`，表示在天平左盘放入编号为 $a_1,a_2,\cdots,a_p$ 的 $p$ 个球，在天平右盘放入编号为 $b_1,b_2,\cdots,b_q$ 的 $q$ 个球。随后清空缓冲区，并从标准输入读入一个 `<>=` 之一的字符，表示左盘与右盘的质量关系。

对于每次此类询问，你需要保证 $1\le p,q\le n$，$p+q\le n$，所有 $a_i$ 和 $b_i$ 互不相同，且你最多进行此类询问 $k$ 次。

在得到答案后，向标准输出打印一行 `2 x y` 来提交答案，表示编号为 $x$ 的球和编号为 $y$ 的球质量偏轻。

你需要保证 $1\le x\lt y\le n$（注意需要严格按照从小到大顺序输出），且在进行完这一操作后立即终止程序。

交互库在一开始就已经确定小球的情况，不会随着你的询问而改变。
## 输入格式

第一行一个整数 $n$，表示球的数量。这里 $k$ 是每个测试点的属性，你不必也不应该读入。

接下来若干行，见【交互方式】。
## 输出格式

若干行，见【交互方式】。
## 样例

### 样例输入 #1
```
6

=

<

>
```
### 样例输出 #1
```

1 1 1 1 2

1 1 3 1 4

1 1 5 1 6

2 3 6
```
## 提示

**样例解释**

三次询问的结果为 $a_1=a_2,a_3\lt a_4,a_5\gt a_6$，可以知道编号为 $3,6$ 的两个球质量偏轻。

---

**数据范围**

本题按点得分。

$20$ 个非 HACK 测试点中，第一个点 $4$ 分，其它点每点 $5$ 分；$4$ 个 HACK 测试点共 $1$ 分，任意一个测试点不通过则不得分。

|测试点|$n\le$|$k=$|特殊性质|测试点|$n\le$|$k=$|特殊性质|
|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
|1|$5$|$50$|无|11|$500$|$50$|无|
|2|$10$|$50$|无|12|$500$|$50$|无|
|3|$100$|$50$|无|13|$500$|$20$|A|
|4|$100$|$50$|无|14|$500$|$20$|B|
|5|$500$|$50$|A|15|$500$|$20$|A|
|6|$500$|$50$|B|16|$500$|$20$|B|
|7|$500$|$50$|A|17|$500$|$20$|无|
|8|$500$|$50$|B|18|$500$|$20$|无|
|9|$500$|$50$|无|19|$500$|$20$|无|
|10|$500$|$50$|无|20|$500$|$20$|无|
|ex1|$500$|$12$|B/HACK|ex3|$500$|$13$|HACK|
|ex2|$500$|$13$|HACK|ex4|$500$|$14$|HACK|

- 特殊性质 A：$n=2^i-1,i\in\left\{4,5,6,7,8\right\}$。
- 特殊性质 B：$n=2^i,i\in\left\{4,5,6,7,8\right\}$。
- 备注：HACK 数据的 $k$ 根据测试点实际情况设置，会卡一些奇怪的做法，保证正解可过。

对于全部数据，$5\le n\le 500$，$k\in\left\{50,20,14,13,12\right\}$。


---

---
title: "[JRKSJ R6] Eltaw"
layout: "post"
diff: 普及+/提高
pid: P8572
tag: ['2022', '洛谷原创', 'O2优化', '枚举', '前缀和', '根号分治']
---
# [JRKSJ R6] Eltaw
## 题目背景

![](https://cdn.luogu.com.cn/upload/image_hosting/at23jtmh.png?x-oss-process=image)

你在月下独自行走，不禁想起了一道简单题。

（题目背景图片来自 Phigros 曲绘，如有侵权，请告知出题人。）
## 题目描述

给你 $k$ 个长为 $n$ 的序列 $a_{1\dots k,1\dots n}$，有 $q$ 次询问，每次询问给出一个区间 $[l,r]$，要求出 $\displaystyle\max_{i=1}^k\sum_{j=l}^ra_{i,j}$，即求出所有序列中区间 $[l,r]$ 的和的最大值。
## 输入格式

第一行三个整数 $n,k,q$。\
接下来 $k$ 行，每行 $n$ 个整数 $a_{i,j}$。\
接下来 $q$ 行，每行两个整数 $l,r$ 表示一次询问。
## 输出格式

输出 $q$ 行表示每个询问的答案。
## 样例

### 样例输入 #1
```
7 2 3
1 1 4 5 1 4 0
1 9 1 9 8 1 0
6 7
5 7
1 3
```
### 样例输出 #1
```
4
9
11
```
## 提示

Idea：cyffff，Solution：cyffff，Code：cyffff，Data：cyffff

**Eltaw - Fl00t (Insane14.4)**

**本题输入输出文件较大，请使用恰当的输入输出方式。**
### 数据规模
本题采用捆绑测试。

| $\text{Subtask}$ | $n\le$ | 特殊限制 | $\text{Score}$ |
| :----------: | :----------: | :----------: | :----------: |
| $1$ | $5\times10^3$ | $k\le 100$ | $20$ |
| $2$ | $5\times10^5$ | 保证 $l=1$ | $30$ |
| $3$ | $5\times10^5$ | 无 | $50$ |

对于 $100\%$ 的数据，$1\le n,k,q\le5\times 10^5$，$1\le n\times k\le 5\times10^5$，$1\le l\le r\le n$，$0\le a_{i,j}\le 10^9$。
### 数据更新记录
$\text{upd 2022.10.05}$：更新了两组数据，分别卡掉了两种时间复杂度错误的做法。感谢 @[二叉苹果树](https://www.luogu.com.cn/user/270854) 指出。


$\text{upd 2022.10.08}$：更新了一组数据，卡掉了记忆化不正确的做法。感谢 @[SweetOrangeOvO](https://www.luogu.com.cn/user/236862) 指出。

如果你能通过现在的所有测试点，说明你的代码复杂度极可能是正确的。如果你仍认为你的复杂度是错误的，请联系出题人。


---

---
title: "[蓝桥杯 2021 国 ABC] 异或变换"
layout: "post"
diff: 普及+/提高
pid: P8763
tag: ['2021', '分治', '位运算', '蓝桥杯国赛']
---
# [蓝桥杯 2021 国 ABC] 异或变换
## 题目描述

小蓝有一个 01 串 $s=s_{1} s_{2} s_{3} \cdots s_{n}$。

以后每个时刻, 小蓝要对这个 01 串进行一次变换。每次变换的规则相同。 对于 01 串 $s=s_{1} s_{2} s_{3} \cdots s_{n}$, 变换后的 01 串 $s^{\prime}=s_{1}^{\prime} s_{2}^{\prime} s_{3}^{\prime} \cdots s_{n}^{\prime}$ 为：

$$
\begin{aligned}
&s_{1}^{\prime}=s_{1} \\
&s_{i}^{\prime}=s_{i-1} \oplus s_{i}
\end{aligned}
$$

其中 $a \oplus b$ 表示两个二进制的异或, 当 $a$ 和 $b$ 相同时结果为 $0$ , 当 $a$ 和 $b$ 不同时结果为 $1$ 。

请问, 经过 $t$ 次变换后的 01 串是什么?
## 输入格式

输入的第一行包含两个整数 $n, t$, 分别表示 01 串的长度和变换的次数。

第二行包含一个长度为 $n$ 的 01 串。
## 输出格式

输出一行包含一个 01 串, 为变换后的串。

## 样例

### 样例输入 #1
```
5 3
10110
```
### 样例输出 #1
```
11010
```
## 提示

**【样例说明】**

初始时为 `10110` , 变换 1 次后变为 `11101` , 变换 2 次后变为 `10011` , 变换 3 次后变为 `11010`。

**【评测用例规模与约定】**

对于 $40 \%$ 的评测用例, $1 \leq n \leq 100,1 \leq t \leq 1000$。

对于 $80 \%$ 的评测用例, $1 \leq n \leq 1000,1 \leq t \leq 10^{9}$。

对于所有评测用例, $1 \leq n \leq 10000,1 \leq t \leq 10^{18}$。

蓝桥杯 2021 国赛 A 组 F 题（B 组 G 题，C 组 G 题）。


---

---
title: "Bina."
layout: "post"
diff: 普及+/提高
pid: P9689
tag: ['动态规划 DP', '洛谷原创', 'O2优化', '分治', '洛谷月赛']
---
# Bina.
## 题目描述

小 J 家门前有两棵树，一棵是二叉树，一棵是三叉树。

你被小 J 叫来修剪他的二叉树，使得他的二叉树的“美丽值”最大，所谓一棵树的美丽值 $=$ 这棵树的点的编号之和 $\div$ 这棵树的深度（结果向下取整）。

这棵二叉树有一个构建参数 $n$，构建方式如下：

```cpp
void build(int s,int t,int p){
  if(s==t) return ;
  build(s,(s+t)/2,2*p);
  build((s+t)/2+1,t,2*p+1);
  add_edge(p,2*p),add_edge(p,2*p+1);
}

int main(){
  build(1,n,1);
  return 0;
}
```

其中 `build(s,t,p)` 函数参数中的 $p$ 是当前点的编号，`add_edge(x,y)` 函数是指将编号为 $x$ 的点向编号为 $y$ 的点连接一条有向边。

容易发现这棵树的根节点是 $1$，并且我们规定节点的深度为节点到根节点路径上经过的点的个数（包括自己和根节点），这棵树的深度即为所有节点深度的最大值。

对于 $n=3$ 的情况，最后构建出来的结果如下，这棵树的深度为 $3$，你需要选择一个深度 $k$ 把深度大于 $k$ 的点都剪掉，但是 $k$ 必须**大于等于** $1$ 且**小于等于**这棵树的深度。

![](https://cdn.luogu.com.cn/upload/image_hosting/ueggbyn8.png)

小 J 还给了你一个要求，你剪去的节点个数一定得大于等于 $m$ 他才会高兴，你需要保证让他高兴的同时树的“美丽值”最大。

现在小 J 给了你构建树的参数 $n$ 和至少剪的节点个数 $m$，要你求出来他的树在你修剪后最大的美丽值是多少，如果无论如何你也不可能让小 J 高兴，输出 $-1$。
## 输入格式

本题有多组数据。

第一行一个正整数 $T$，表示数据组数。

对于每组数据：

输入共一行两个整数 $n,m$，表示构建二叉树的参数和你至少剪掉的节点个数。
## 输出格式

对于每组数据：输出一行一个整数，表示能够获得的最大的“美丽值”，如果无法让小 J 高兴，输出 $-1$。
## 样例

### 样例输入 #1
```
6
3 0
3 1
3 2
3 3
3 4
3 5
```
### 样例输出 #1
```
5
3
3
1
1
-1
```
### 样例输入 #2
```
10
5 5
10 0
999 155
135 92
1000232 234255
10293845 1239485
123948 1239454
12394 2131094
1000000000 98765432
1000000000 999999999
```
### 样例输出 #2
```
3
40
52377
1161
27487764480
5864061665280
-1
-1
19215358392218419
4969489234738635
```
## 提示

#### 【样例解释 #1】

对于第一组样例，$n$ 都等于 $3$，构建出来的树同题面所示。

如果我们选择把深度大于 $1$ 的节点全部剪掉，那么我们剪掉了 $2,3,4,5$ 共 $4$ 个节点，美丽值为 $1$。

如果我们选择把深度大于 $2$ 的节点全部剪掉，那么我们剪掉了 $4,5$ 共 $2$ 个节点，美丽值为 $\lfloor \dfrac{1+2+3}{2}\rfloor = 3$。

如果我们选择把深度大于 $3$ 的节点全部剪掉，那么我们没有剪掉任何节点，美丽值为 $\lfloor \dfrac{1+2+3+4+5}{3}\rfloor = 5$。

所以对于 $m=0$ 的情况，答案为 $5$；对于 $1 \le m \le 2$ 的情况，答案为 $3$；对于 $3 \le m \le 4$ 的情况，答案为 $1$；其它情况，无解输出 $-1$。

#### 【数据范围】

对于所有测试数据，满足 $1 \le T \le 10^5$，$1 \le n \le 10^9$，$0 \le m \le 2 \times 10^9$。

**本题开启捆绑测试，所有数据范围均相同的测试点捆绑为一个 $\text{Subtask}$。**

各测试点的附加限制如下表所示。

| 测试点 | $n \le$ | $m \le$ | $T \le$ | 特殊限制 |
| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |
| $1 \sim 2$ | $10^3$ | $10^5$ | $10^3$ | 无 |
| $3 \sim 4$ | $10^6$ | $2 \times 10^6$ | $10^5$ | 无 |
| $5$ | $10^9$ | $1$ | $10^5$ | 无 |
| $6$ | $10^9$ | $2$ | $10^5$ | 无 |
| $7 \sim 8$ | $10^9$ | $3$ | $10^5$ | 无 |
| $9 \sim 10$ | $10^9$ | $2 \times 10^9$ | $10^5$ | $m \ge 1$ |
| $11 \sim 12$ | $10^9$ | $10^3$ | $10^5$ | 无 |
| $13 \sim 16$ | $10^9$ | $2 \times 10^9$ | $10$ | 无 |
| $17 \sim 20$ | $10^9$ | $2 \times 10^9$ | $10^5$ | 所有 $n$ 均相同 |
| $21 \sim 25$ | $10^9$ | $2 \times 10^9$ | $10^5$ | 无 |


---


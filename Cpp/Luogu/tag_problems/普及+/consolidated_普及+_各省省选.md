---
title: "[ZJOI2007] 时态同步"
layout: "post"
diff: 普及+/提高
pid: P1131
tag: ['动态规划 DP', '树形数据结构', '2007', '各省省选', '浙江', '树形 DP', '构造']
---
# [ZJOI2007] 时态同步
## 题目描述

小 Q 在电子工艺实习课上学习焊接电路板。一块电路板由若干个元件组成，我们不妨称之为节点，并将其用数字 $1,2,3\cdots$ 进行标号。电路板的各个节点由若干不相交的导线相连接，且对于电路板的任何两个节点，都存在且仅存在一条通路（通路指连接两个元件的导线序列）。

在电路板上存在一个特殊的元件称为“激发器”。当激发器工作后，产生一个激励电流，通过导线传向每一个它所连接的节点。而中间节点接收到激励电流后，得到信息，并将该激励电流传向与它连接并且尚未接收到激励电流的节点。最终，激励电流将到达一些“终止节点”――接收激励电流之后不再转发的节点。

激励电流在导线上的传播是需要花费时间的，对于每条边 $e$，激励电流通过它需要的时间为 $t_e$，而节点接收到激励电流后的转发可以认为是在瞬间完成的。现在这块电路板要求每一个“终止节点”同时得到激励电路――即保持时态同步。由于当前的构造并不符合时态同步的要求，故需要通过改变连接线的构造。目前小 Q 有一个道具，使用一次该道具，可以使得激励电流通过某条连接导线的时间增加一个单位。请问小 Q 最少使用多少次道具才可使得所有的“终止节点”时态同步？
## 输入格式

第一行包含一个正整数 $N$，表示电路板中节点的个数。

第二行包含一个整数 $S$，为该电路板的激发器的编号。

接下来 $N-1$ 行，每行三个整数 $a,b,t$。表示该条导线连接节点 $a$ 与节点 $b$，且激励电流通过这条导线需要 $t$ 个单位时间。
## 输出格式

仅包含一个整数 $V$，为小 Q 最少使用的道具次数。
## 样例

### 样例输入 #1
```
3
1
1 2 1
1 3 3

```
### 样例输出 #1
```
2

```
## 提示

- 对于 $40\%$ 的数据，$1\le N\le 1000$。
- 对于 $100\%$ 的数据，$1\le N\le 5\times 10^5$。

对于所有的数据，$1\le t_e\le 10^6$。


---

---
title: "[ZJOI2007] 棋盘制作"
layout: "post"
diff: 普及+/提高
pid: P1169
tag: ['动态规划 DP', '2007', '各省省选', '浙江', '栈']
---
# [ZJOI2007] 棋盘制作
## 题目描述

国际象棋是世界上最古老的博弈游戏之一，和中国的围棋、象棋以及日本的将棋同享盛名。据说国际象棋起源于易经的思想，棋盘是一个 $8 \times 8$ 大小的黑白相间的方阵，对应八八六十四卦，黑白对应阴阳。

而我们的主人公 `小Q`，正是国际象棋的狂热爱好者。作为一个顶尖高手，他已不满足于普通的棋盘与规则，于是他跟他的好朋友 `小W` 决定将棋盘扩大以适应他们的新规则。

`小Q` 找到了一张由 $N \times M$ 个正方形的格子组成的矩形纸片，每个格子被涂有黑白两种颜色之一。`小Q` 想在这种纸中裁减一部分作为新棋盘，当然，他希望这个棋盘尽可能的大。

不过 `小Q` 还没有决定是找一个正方形的棋盘还是一个矩形的棋盘（当然，不管哪种，棋盘必须都黑白相间，即相邻的格子不同色），所以他希望可以找到最大的正方形棋盘面积和最大的矩形棋盘面积，从而决定哪个更好一些。

于是 `小Q` 找到了即将参加全国信息学竞赛的你，你能帮助他么？

## 输入格式

包含两个整数 $N$ 和 $M$，分别表示矩形纸片的长和宽。接下来的 $N$ 行包含一个 $N\times M$ 的 $01$ 矩阵，表示这张矩形纸片的颜色（$0$ 表示白色，$1$ 表示黑色）。

## 输出格式

包含两行，每行包含一个整数。第一行为可以找到的最大正方形棋盘的面积，第二行为可以找到的最大矩形棋盘的面积（注意正方形和矩形是可以相交或者包含的）。

## 样例

### 样例输入 #1
```
3 3
1 0 1
0 1 0
1 0 0

```
### 样例输出 #1
```
4
6

```
## 提示

对于 $20\%$ 的数据，$N, M ≤ 80$

对于 $40\%$ 的数据，$N, M ≤ 400$

对于 $100\%$ 的数据，$N, M ≤ 2000$



---

---
title: "[JSOI2008] 星球大战"
layout: "post"
diff: 普及+/提高
pid: P1197
tag: ['2008', '并查集', '各省省选', '江苏', '连通块']
---
# [JSOI2008] 星球大战
## 题目描述

很久以前，在一个遥远的星系，一个黑暗的帝国靠着它的超级武器统治着整个星系。

某一天，凭着一个偶然的机遇，一支反抗军摧毁了帝国的超级武器，并攻下了星系中几乎所有的星球。这些星球通过特殊的以太隧道互相直接或间接地连接。

但好景不长，很快帝国又重新造出了他的超级武器。凭借这超级武器的力量，帝国开始有计划地摧毁反抗军占领的星球。由于星球的不断被摧毁，两个星球之间的通讯通道也开始不可靠起来。

现在，反抗军首领交给你一个任务：给出原来两个星球之间的以太隧道连通情况以及帝国打击的星球顺序，以尽量快的速度求出每一次打击之后反抗军占据的星球的连通块的个数。（如果两个星球可以通过现存的以太通道直接或间接地连通，则这两个星球在同一个连通块中）。
## 输入格式

输入文件第一行包含两个整数，$n,m$，分别表示星球的数目和以太隧道的数目。星球用 $0 \sim n-1$ 的整数编号。

接下来的 $m$ 行，每行包括两个整数 $x,y$，表示星球 $x$ 和星球 $y$ 之间有 “以太” 隧道，可以直接通讯。

接下来的一行为一个整数 $k$ ，表示将遭受攻击的星球的数目。

接下来的 $k$ 行，每行有一个整数，按照顺序列出了帝国军的攻击目标。这 $k$ 个数互不相同，且都在 $0$ 到 $n-1$ 的范围内。
## 输出格式

第一行是开始时星球的连通块个数。接下来的 $k$ 行，每行一个整数，表示经过该次打击后现存星球的连通块个数。
## 样例

### 样例输入 #1
```
8 13
0 1
1 6
6 5
5 0
0 6
1 2
2 3
3 4
4 5
7 1
7 2
7 6
3 6
5
1
6
3
5
7

```
### 样例输出 #1
```
1
1
1
2
3
3
```
## 提示

【数据范围】  
对于 $100\%$ 的数据，$1\le m \le 2\times 10^5$，$1\le n \le 2m$，$x \neq y$。

[JSOI2008]



---

---
title: "[JSOI2008] 最大数"
layout: "post"
diff: 普及+/提高
pid: P1198
tag: ['2008', '线段树', '二分', '各省省选', '江苏', '栈', 'ST 表']
---
# [JSOI2008] 最大数
## 题目描述

现在请求你维护一个数列，要求提供以下两种操作：

1.  查询操作。

语法：`Q L`

功能：查询当前数列中末尾 $L$ 个数中的最大的数，并输出这个数的值。

限制：$L$ 不超过当前数列的长度。$(L > 0)$

2. 插入操作。

语法：`A n`

功能：将 $n$ 加上 $t$，其中 $t$ 是最近一次查询操作的答案（如果还未执行过查询操作，则 $t=0$），并将所得结果对一个固定的常数 $D$ 取模，将所得答案插入到数列的末尾。

限制：$n$ 是整数（可能为负数）并且在长整范围内。

注意：初始时数列是空的，没有一个数。

## 输入格式

第一行两个整数，$M$ 和 $D$，其中 $M$ 表示操作的个数，$D$ 如上文中所述。

接下来的 $M$ 行，每行一个字符串，描述一个具体的操作。语法如上文所述。
## 输出格式

对于每一个查询操作，你应该按照顺序依次输出结果，每个结果占一行。

## 样例

### 样例输入 #1
```
5 100
A 96
Q 1
A 97
Q 1
Q 2

```
### 样例输出 #1
```
96
93
96

```
## 提示

#### 数据规模与约定

对于全部的测试点，保证 $1 \leq M \leq 2 \times 10^5$，$1 \leq D \leq 2 \times 10^9$。


---

---
title: "[SHOI2002] 百事世界杯之旅"
layout: "post"
diff: 普及+/提高
pid: P1291
tag: ['数学', '2002', '各省省选', '上海']
---
# [SHOI2002] 百事世界杯之旅
## 题目背景

“……在 2002 年 6 月之前购买的百事任何饮料的瓶盖上都会有一个百事球星的名字。只要凑齐所有百事球星的名字，就可参加百事世界杯之旅的抽奖活动，获得球星背包，随声听，更可赴日韩观看世界杯。还不赶快行动！”
## 题目描述

你关上电视，心想：假设有 $n$ 个不同的球星名字，每个名字出现的概率相同，平均需要买几瓶饮料才能凑齐所有的名字呢？
## 输入格式

输入只有一行一个整数，表示不同球星名字的个数 $n$。
## 输出格式

输出凑齐所有的名字平均需要买的饮料瓶数。如果是一个整数，则直接输出，否则应该直接按照分数格式输出，例如五又二十分之三应该输出为：

```plain
 3
5--
 20
```

第一行是分数部分的分子，第二行首先是整数部分，然后是由减号组成的分数线，第三行是分母。减号的个数应等于分母的位数。分子和分母的首位都与第一个减号对齐。

分数必须是不可约的。
## 样例

### 样例输入 #1
```
2

```
### 样例输出 #1
```
3

```
### 样例输入 #2
```
17
```
### 样例输出 #2
```
  340463
58------
  720720
```
## 提示

### 数据规模与约定

对于全部的测试点，保证 $2 \leq n \leq 33$。


---

---
title: "[JSOI2004] 平衡点 / 吊打XXX"
layout: "post"
diff: 普及+/提高
pid: P1337
tag: ['计算几何', '2004', '二分', '各省省选', '江苏', '模拟退火']
---
# [JSOI2004] 平衡点 / 吊打XXX
## 题目描述

如图，有 $n$ 个重物，每个重物系在一条足够长的绳子上。

每条绳子自上而下穿过桌面上的洞，然后系在一起。图中 $x$ 处就是公共的绳结。假设绳子是完全弹性的（即不会造成能量损失），桌子足够高（重物不会垂到地上），且忽略所有的摩擦，求绳结 $x$ 最终平衡于何处。

**注意**：桌面上的洞都比绳结 $x$ 小得多，所以即使某个重物特别重，绳结 $x$ 也不可能穿过桌面上的洞掉下来，最多是卡在某个洞口处。

![](https://cdn.luogu.com.cn/upload/image_hosting/u20jvui9.png)
## 输入格式

文件的第一行为一个正整数 $n$（$1\le n\le 1000$），表示重物和洞的数目。

接下来的 $n$ 行，每行是 $3$ 个整数 $x_i, y_i, w_i$，分别表示第 $i$ 个洞的坐标以及第 $i$ 个重物的重量。（$-10000\le x_i,y_i\le10000, 0<w_i\le1000$）

## 输出格式

你的程序必须输出两个浮点数（保留小数点后三位），分别表示处于最终平衡状态时绳结 $x$ 的横坐标和纵坐标。两个数以一个空格隔开。
## 样例

### 样例输入 #1
```
3
0 0 1
0 2 1
1 1 1
```
### 样例输出 #1
```
0.577 1.000
```


---

---
title: "[CQOI2009] 中位数"
layout: "post"
diff: 普及+/提高
pid: P1627
tag: ['数学', '2009', '重庆', '各省省选', '排序']
---
# [CQOI2009] 中位数
## 题目描述

给出 $1,2,...,n$ 的一个排列，统计该排列有多少个长度为奇数的连续子序列的中位数是 $b$。中位数是指把所有元素从小到大排列后，位于中间的数。
## 输入格式

第一行为两个正整数 $n$ 和 $b$，第二行为 $1,2,...,n$ 的排列。
## 输出格式

输出一个整数，即中位数为 $b$ 的连续子序列个数。

## 样例

### 样例输入 #1
```
7 4
5 7 2 4 3 1 6 
```
### 样例输出 #1
```
4
```
## 提示

#### 数据规模与约定

对于 $30\%$ 的数据中，满足 $n \le 100$；

对于 $60\%$ 的数据中，满足 $n \le 1000$；

对于 $100\%$ 的数据中，满足 $n \le 100000,1 \le b \le n$。


---

---
title: "[SDOI2008] 烧水问题"
layout: "post"
diff: 普及+/提高
pid: P1984
tag: ['数学', '2008', '各省省选', '山东']
---
# [SDOI2008] 烧水问题
## 题目描述

把总质量为 $1\ \rm kg$ 的水分装在 $n$ 个杯子里，每杯水的质量均为 $(1/n)\ \rm kg$，初始温度均为 $0$ 度。现需要把每一杯水都烧开。我们可以对任意一杯水进行加热。把一杯水的温度升高 $t$ 度所需的能量为 $(4200\times t/n)\rm J$，其中，$\rm J$ 是能量单位“焦耳”。如果一旦某杯水的温度达到 $100$ 度，那么这杯水的温度就不能再继续升高，此时我们认为这杯水已经被烧开。显然地，如果直接把水一杯一杯地烧开，所需的总能量为 $(4200\times 100)\rm J$。

在烧水的过程中，我们随时可以在两杯温度不同的水之间进行热传递操作。热量只能从温度较高的那杯水传递到温度较低的那杯水。由于两杯水的质量相同，所以进行热传递操作之后，原来温度较高的那杯水所降低的温度总是等于原来温度较低的那杯水所升高的温度。

一旦两杯水的温度相同，热传递立刻停止。

为了把问题简化，我们假设：

1. 没有进行加热或热传递操作时，水的温度不会变化。
2. 加热时所花费的能量全部被水吸收，杯子不吸收能量。
3. 热传递总是隔着杯子进行，$n$ 杯水永远不会互相混合。
4. 热传递符合能量守恒，而且没有任何的热量损耗。

在这个问题里，只要求把每杯水都至少烧开一遍就可以了，而不要求最终每杯水的温度都是 $100$ 度。我们可以用如下操作把两杯水烧开：先把一杯水加热到 $100$ 度，花费能量 $(4200\times 100/2)\rm J$，然后两杯水进行热传递，直到它们的温度都变成 $50$ 度为止，最后把原来没有加热到 $100$ 度的那杯水加热到 $100$ 度，花费能量 $(4200\times 50/2)\rm J$，此时两杯水都被烧开过了，当前温度一杯 $100$ 度，一杯 $50$ 度，花费的总能量为 $(4200\times 75)\rm J$，比直接烧开所需的 $(4200\times 100)\rm J$ 少花费了 $25\%$ 的能量。

你的任务是设计一个最佳的操作方案使得 $n$ 杯水都至少被烧开一遍所需的总能量最少。

## 输入格式

数据数据共一行，一个整数 $n$。
## 输出格式

输出 $n$ 杯水都至少被烧开一遍所需的最少的总能量，单位为 $J$，四舍五入到小数点后两位。
## 样例

### 样例输入 #1
```
2
```
### 样例输出 #1
```
315000.00
```
## 提示

### 数据范围及约定

对于全部数据，$1 \le n \le 3000000$。


---

---
title: "[AHOI2009] 维护序列"
layout: "post"
diff: 普及+/提高
pid: P2023
tag: ['2009', '线段树', '各省省选', '安徽']
---
# [AHOI2009] 维护序列
## 题目背景

老师交给小可可一个维护数列的任务，现在小可可希望你来帮他完成。
## 题目描述

有一个长为 $n$ 的数列 $\{a_n\}$，有如下三种操作形式：

1. 格式 `1 t g c`，表示把所有满足 $t\le i\le g$ 的 $a_i$ 改为 $a_i\times c$ ;
2. 格式 `2 t g c` 表示把所有满足 $t\le i\le g$ 的 $a_i$ 改为 $a_i+c$ ;
3. 格式 `3 t g` 询问所有满足 $t\le i\le g$ 的 $a_i$ 的和，由于答案可能很大，你只需输出这个数模 $p$ 的值。
## 输入格式

第一行两个整数 $n$ 和 $p$。

第二行含有 $n$ 个非负整数，表示数列 $\{a_i\}$ 。

第三行有一个整数 $m$，表示操作总数。

从第四行开始每行描述一个操作，同一行相邻两数之间用一个空格隔开，每行开头和末尾没有多余空格。
## 输出格式

对每个操作 3，按照它在输入中出现的顺序，依次输出**一行一个整数**表示询问结果。
## 样例

### 样例输入 #1
```
7 43
1 2 3 4 5 6 7
5
1 2 5 5
3 2 4
2 3 7 9
3 1 3
3 4 7
```
### 样例输出 #1
```
2
35
8

```
## 提示

#### 样例输入输出 1 解释

- 初始时数列为 $\{1,2,3,4,5,6,7\}$。
- 经过第 $1$ 次操作后，数列为 $\{1,10,15,20,25,6,7\}$。
- 对第 $2$ 次操作，和为 $10+15+20=45$，模 $43$ 的结果是 $2$。
- 经过第 $3$ 次操作后，数列为 $\{1,10,24,29,34,15,16\}$。
- 对第 $4$ 次操作，和为 $1+10+24=35$，模 $43$ 的结果是 $35$。
- 对第 $5$ 次操作，和为 $29+34+15+16=94$，模 $43$ 的结果是$8$。


#### 数据规模与约定

测试数据规模如下表所示：

| 数据点编号 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9,10 |
| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |
| $n=$ | $10$ | $1000$ | $1000$ | $10000$ | $60000$ | $70000$ | $80000$ | $90000$ | $100000$ |
| $m=$ | $10$ | $1000$ | $1000$ | $10000$ | $60000$ | $70000$ | $80000$ | $90000$ | $100000$ |

对于全部的测试点，保证 $0 \leq p, a_i, c \leq 10^9$，$1 \leq t \leq g \leq n$。


---

---
title: "[AHOI2009] 跳棋"
layout: "post"
diff: 普及+/提高
pid: P2039
tag: ['2009', '各省省选', '安徽']
---
# [AHOI2009] 跳棋
## 题目描述

在一个 $1$ 行 $N$ 列（$N$ 是奇数）的棋盘上，有 $K$ 个格子是红色的。这种情况下，你有一个跳棋在最左端的格子上。你的目标是将它移动到最右边的格子，在开始移动之间，你可以在棋盘的任意空位上放棋子。在游戏开始后 你只可以随时在一个红色格子上放棋子。棋子的移动规则是：每次只可以选择一个棋子，跳过与之相邻的棋子走到后面的空格上，被它跳过的棋子被吃掉，即从棋盘上移走，如相邻棋子的另一侧有棋子，则不能跳。


请回答以下两个问题：

1. 移动开始前至少要放多少棋子才能完成任务。
2. 如果要使开始前放的棋子数要求尽量少，那么在移动过程中最少需要放多少个棋子才能完成任务。


关于规则的补充说明：

1. 只能往空位上放棋子，不管是移动开始前还是移动过程中。
2. 移动前棋盘最左端的那个原始棋子绝对不能被吃掉。

## 输入格式

第一行一个正奇数 $N$。

第二行有 $N$ 个整数，如果第 $i$ 个整数是 $1$，说明第 $i$ 个格子是红棋，否则为白棋。

数字间用空格分开。

## 输出格式

两行，每行一个整数分别代表第一问和第二问的结果。

## 样例

### 样例输入 #1
```
5
0 0 0 1 0


```
### 样例输出 #1
```
1
1
```
## 提示

在游戏开始前，可以在第二个格子上放上一个棋子，游戏开始后可用最左边的棋子吃掉它，从而移动到第三格。然后由于第四格是个红色的格子，在游戏中可以在那放一个棋子，然后用已经移动第三格的棋子把它吃掉，从而达到终点。

$100\%$ 的数据中，$1\le N\le  1000$，输出中的数字不超过 $10^ {15}$。

$30\%$ 的数据中，$N\le 20$。


Source: [Ahoi2009] checker



---

---
title: "[HAOI2007] 理想的正方形"
layout: "post"
diff: 普及+/提高
pid: P2216
tag: ['2007', '河南', '各省省选', '单调队列', '队列']
---
# [HAOI2007] 理想的正方形
## 题目描述

有一个 $a \times b$ 的整数组成的矩阵，现请你从中找出一个 $n \times n$ 的正方形区域，使得该区域所有数中的最大值和最小值的差最小。
## 输入格式

第一行为 $3$ 个整数，分别表示 $a,b,n$ 的值。

第二行至第 $a+1$ 行每行为 $b$ 个非负整数，表示矩阵中相应位置上的数。每行相邻两数之间用一空格分隔。
## 输出格式

仅一个整数，为 $a \times b$ 矩阵中所有“ $n \times n$ 正方形区域中的最大整数和最小整数的差值”的最小值。
## 样例

### 样例输入 #1
```
5 4 2
1 2 5 6
0 17 16 0
16 17 2 1
2 10 2 1
1 2 2 2

```
### 样例输出 #1
```
1
```
## 提示

矩阵中的所有数都不超过 $1,000,000,000$。

$20\%$ 的数据 $2 \le a,b \le 100,n \le a,n \le b,n \le 10$。

$100\%$ 的数据 $2 \le a,b \le 1000,n \le a,n \le b,n \le 100$。


---

---
title: "[HNOI2001] 矩阵乘积"
layout: "post"
diff: 普及+/提高
pid: P2222
tag: ['2001', '各省省选', '湖南']
---
# [HNOI2001] 矩阵乘积
## 题目描述

已知矩阵：

$$A_{m\times n}=\begin{bmatrix}a_{1,1} & a_{1,2} & \cdots & a_{1,n}\\ a_{2,1} & a_{2,2} & \cdots & a_{2,n} \\ \vdots & \vdots & \ddots & \vdots\\ a_{m,1} & a_{m,2} & \cdots &a_{m,n} \end{bmatrix} ,B_{n\times p}=\begin{bmatrix}b_{1,1} & b_{1,2} & \cdots & b_{1,p}\\ b_{2,1} & b_{2,2} & \cdots & b_{2,p} \\ \vdots & \vdots & \ddots & \vdots\\ b_{n,1} & b_{n,2} & \cdots &b_{n,q} \end{bmatrix}$$

当矩阵 $A$ 的列数与矩阵 $B$ 的行数相同时，则 $A$ 与 $B$ 可以相乘，其乘积为一个 $m\times p$ 的矩阵 $D$：

$$D_{m\times p}=\begin{bmatrix} d_{1,1} & d_{1,2} & \cdots & d_{1,p}\\ d_{2,1} & d_{2,2} & \cdots & d_{2,p} \\ \vdots & \vdots & \ddots & \vdots\\ d_{m,1} & d_{m,2} & \cdots & d_{m,p}\end{bmatrix}$$

其中 $d_{i,j}=\sum^n_{k=1} a_{i,k} \times b_{k,j}$，简记为 $D=A\times B$。

现已知三个矩阵 $A,B,C$，这三个矩阵大多数元素为 $0$，我们把这种矩阵称为稀疏矩阵。因此，我们采用三元组 $i,j,a$ 来表示矩阵的第 $i$ 行第 $j$ 列的值为 $a$ 其余未列出的元素均为 $0$；在计算机中，我们仅给出非零元素的三元组，而且使用行优先法给出稀疏矩阵的三元组，首先是第一行按列给出，然后是第二行按列给出……

例如，矩阵：$\begin{bmatrix}1&0&0&0\\0&0&2&-1\\0&1&2&3\\0&0&0&0\end{bmatrix}$ 那么，矩阵的三元组表示为：

```plain
1 1 1
2 3 2
2 4 -1
3 2 1 
3 3 2
3 4 3
```

你的任务就是：计算矩阵 $D=A\times B\times C$。
## 输入格式

第一行为两个正整数 $x,y$，分别表示输出结果所在的行和列。

第二行为四个整数 $m,n,o,p$，表明 $A$ 为$m\times n$ 的矩阵，$B$ 为 $n\times o$ 的矩阵，$C$ 为 $o\times p$ 的矩阵。

第三行以后的每一行有三个整数分别是矩阵的三元组表示法中的一个元素的值，每个矩阵之间有一个空行。表示的顺序是矩阵 $A,B,C$。

## 输出格式

仅一个整数，为 $D$ 的第 $x$ 行第 $y$ 列的元素的值。
## 样例

### 样例输入 #1
```
1 2                       

3 4 2 3

1 1 3

1 4 5

2 2 1

3 1 2



1 2 2

2 1 1

3 1 2

3 2 4



1 2 2

1 3 3

2 1 1

2 2 2


```
### 样例输出 #1
```
12
```
## 提示

#### 数据规模与约定
对于全部的测试点，保证 $1\le m,n,o,p\le 6\times 10^3$，三元数组的总个数不大于 $6\times 10^3$。数据之间用空格分开。


---

---
title: "[HNOI2001] 遥控赛车比赛"
layout: "post"
diff: 普及+/提高
pid: P2226
tag: ['动态规划 DP', '2001', '各省省选', '湖南']
---
# [HNOI2001] 遥控赛车比赛
## 题目描述

全国遥控赛车大赛近日在星沙举行。竞赛选用一块大小为 $N\times M$ 的场地作为竞赛场地，要求选手的赛车在最短的时间内从起点移动到终点。虽然赛场地形高低有少许的起伏，但并不存在无法到达的地点。但是在赛场上增加了许多无法穿越的障碍物，若赛车在到达终点前撞上障碍物，就视为任务失败。

在赛车的马力和灵活性等性能相差较小的情况下，要控制速度极快的赛车绕开障碍物移动到终点，关键是提高选手的反应灵敏度，即两次改变赛车运动方向所间隔的最短时间，也可称为选手的反应时间。使自己能够更快地控制赛车改变前进的方向。

当然，由于选手反应灵敏度的不同，可选择的路径就会大不相同。如图 $1$ 和图 $2$ 所示，对于同一个赛场，两位选手的反应时间分别为 $2$ 秒和 $1$ 秒，而其到达终点所需的时间分别为 $18$ 秒和 $16$ 秒（赛车每秒可沿当前方向移动一格，从起点出发时算改变一次方向）。

由图 $1$ 和图 $2$ 可知，赛车的最短路线长度是由选手的反应灵敏度所决定的，当选手的反应很慢时，可能就不会存在可行的路径。你的任务是：在能够完成赛程（即存在从起点到终点的路径）的条件下，求出选手每个可能的反应时间所对应的最短路线长度。

![](https://cdn.luogu.com.cn/upload/pic/1294.png)

## 输入格式

第一行包含两个整数 $N$ 和 $M$，表示赛场的行数和列数。$1≤N, M≤100$。

第二行有四个整数 $x1$、$y1$、$x2$、$y2$，表示赛程的起点和终点的位置分别为 $(x1, y1$ 和 $x2,y2$。

接下来 $N$ 行是一个 $N×M$ 的 0-1 矩阵，矩阵中第 $i$ 行第 $j$ 列元素 $A_{i,j}=1$ 表示赛场中位置 $(i,j)$ 为赛道，$A_{i,j}=0$ 表示赛场中位置 $(i,j)$ 有障碍物。

## 输出格式

输出文件可能有多行，其中每行输出一个可能的选手反应时间及该时间所对应的最短路线长度。输出文件中必须包含所有符合题目要求的选手反应时间。注意：由于选手的反应时间不可能很慢，因而不必考虑选手反应时间大于 $10$ 秒的情况，只需输出 $10$ 以内（包含 $10$）的解。

## 样例

### 样例输入 #1
```
10 10                                   
1 4 10 7                                 
0 0 0 1 0 0 0 0 0 0
0 0 0 1 1 1 0 0 0 0
0 0 0 1 0 1 0 0 0 0
1 1 1 1 0 1 1 1 1 0
1 0 0 0 0 0 0 0 1 0
1 0 1 1 1 0 1 1 1 0
1 1 1 0 1 1 1 0 1 0
0 0 1 0 0 0 0 0 1 0
0 0 1 1 1 1 1 1 1 0
0 0 0 0 0 0 1 0 0 0

```
### 样例输出 #1
```
1 16
2 18

```


---

---
title: "[HNOI2002] 公交车路线"
layout: "post"
diff: 普及+/提高
pid: P2233
tag: ['动态规划 DP', '2002', '各省省选', '湖南', '矩阵乘法']
---
# [HNOI2002] 公交车路线
## 题目描述

在长沙城新建的环城公路上一共有 $8$ 个公交站，分别为 A、B、C、D、E、F、G、H。公共汽车只能够在相邻的两个公交站之间运行，因此你从某一个公交站到另外一个公交站往往要换几次车，例如从公交站 A 到公交站 D，你就至少需要换 $3$ 次车。

 ![](https://cdn.luogu.com.cn/upload/pic/1297.png) 

Tiger 的方向感极其糟糕，我们知道从公交站 A 到公交 E 只需要换 $4$ 次车就可以到达，可是 tiger 却总共换了 $n$ 次车，注意 tiger 一旦到达公交站 E，他不会愚蠢到再去换车。现在希望你计算一下 tiger 有多少种可能的乘车方案。

## 输入格式

仅有一个正整数 $n$，表示 tiger 从公交车站 A 到公交车站 E 共换了 $n$ 次车。
## 输出格式

输出一个正整数表示方案数，由于方案数很大，请输出方案数除以 $1000$ 后的余数。
## 样例

### 样例输入 #1
```
6
```
### 样例输出 #1
```
8
```
## 提示

8 条路线分别是：

(A→B→C→D→C→D→E)，(A→B→C→B→C→D→E)，

(A→B→A→B→C→D→E)，(A→H→A→B→C→D→E)，

(A→H→G→F→G→F→E)，(A→H→G→H→G→F→E)，

(A→H→A→H→G→F→E)，(A→B→A→H→G→F→E)。

#### 数据范围

$4\le n\le10^7$。


---

---
title: "[HNOI2002] 高质量的数据传输"
layout: "post"
diff: 普及+/提高
pid: P2269
tag: ['2002', '各省省选', '湖南']
---
# [HNOI2002] 高质量的数据传输
## 题目描述

![](https://cdn.luogu.com.cn/upload/pic/1325.png)

## 输入格式

输入文件ROUTING.IN

共有2n+1行。

第1行是网络的节点数n，数据要传输的两个结点的序号i，j，其中结点数n不大于200。第2行到第n+1行是时延t的邻接矩阵，其元素tkl的值是第k个结点到第l个结点的边的时延，当其值=-1时表示第k个结点到第l个结点无边。显然该邻接矩阵是对称矩阵。第n+2行到第2n+1行是丢失率p的邻接矩阵，其元素pkl的值是第k个结点到第l个结点的边的丢失率，已精确到小数点后4位，当其值=-1时表示第k个结点到第l个结点无边。显然该邻接矩阵是对称矩阵。

## 输出格式

输出文件ROUTING.OUT

共1行，输出所找出的路径的时延和丢失率（精确到小数点后4位）。

## 样例

### 样例输入 #1
```
3 1 3                       
0 1 5
1 0 2
5 2 0
0 0.1 0.05
0.1 0 0.05
0.05 0.05 0
```
### 样例输出 #1
```
5 0.0500
```


---

---
title: "[HNOI2003] 24点游戏"
layout: "post"
diff: 普及+/提高
pid: P2277
tag: ['2003', '各省省选', '湖南']
---
# [HNOI2003] 24点游戏
## 题目描述

为了培养小孩的计算能力，大人们经常给小孩玩这样的游戏：从一副扑克牌中任意抽出 $4$ 张扑克，要小孩用 `+`、`-`、`*`、`/` 和括号组成一个合法的表达式，并使表达式的值为 $24$ 点。这种游戏就是所谓的“$24$ 点游戏”。

请你编程求出对于给出的任意 $4$ 个正整数 $a$、$b$、$c$、$d$，请你编程求出这 $4$ 个整数能组成多少个值为 $24$ 的不同表达式。

## 输入格式

输入文件共一行，为四个正整数 $a$、$b$、$c$、$d$。（$0 \le a, b, c, d \le 100$）

## 输出格式

输出文件为由 $a$、$b$、$c$、$d$ 组成的值为 $24$ 的表达式个数，如没有，输出 $0$。

## 样例

### 样例输入 #1
```
5 5 5 5

```
### 样例输出 #1
```
1

```


---

---
title: "[HNOI2005] 狡猾的商人"
layout: "post"
diff: 普及+/提高
pid: P2294
tag: ['2005', '并查集', '各省省选', '湖南', '差分约束', '前缀和']
---
# [HNOI2005] 狡猾的商人
## 题目描述

刁姹接到一个任务，为税务部门调查一位商人的账本，看看账本是不是伪造的。账本上记录了 $n$ 个月以来的收入情况，其中第 $i$ 个月的收入额为 $a_i$，$i=1,2,\ldots,n-1,n$。当 $a_i>0$ 时表示这个月盈利 $a_i$ 元，当 $a_i<0$ 时表示这个月亏损 $|a_i|$ 元。所谓一段时间内的总收入，就是这段时间内每个月的收入额的总和。

刁姹的任务是秘密进行的，为了调查商人的账本，她只好跑到商人那里打工。她趁商人不在时去偷看账本，可是她无法将账本偷出来，每次偷看账本时她都只能看某段时间内账本上记录的收入情况，并且她只能记住这段时间内的总收入。

现在，姹总共偷看了 $m$ 次账本，当然也就记住了 $m$ 段时间内的总收入，你的任务是根据记住的这些信息来判断账本是不是假的。

## 输入格式

第一行为一个正整数 $w$，其中 $w<100$，表示有 $w$ 组数据，即 $w$ 个账本，需要你判断。

每组数据的第一行为两个正整数 $n$ 和 $m$，其中 $n<100,m<1000$，分别表示对应的账本记录了多少个月的收入情况以及偷看了多少次账本。

接下来的 $m$ 行表示刁姹偷看 $m$ 次账本后记住的 $m$ 条信息，每条信息占一行，有三个整数 $s,t$ 和 $v$，表示从第 $s$ 个月到第 $t$ 个月（包含第 $t$ 个月）的总收入为 $v$，这里假设 $s$ 总是小于等于 $t$。

## 输出格式

包含 $w$ 行，每行是 `true` 或 `false`，其中第 $i$ 行为 `true` 当且仅当第 $i$ 组数据，即第 $i$ 个账本不是假的；第 $i$ 行为 `false` 当且仅当第 $i$ 组数据，即第 $i$ 个账本是假的。

## 样例

### 样例输入 #1
```
2
3 3
1 2 10
1 3 -5
3 3 -15
5 3
1 5 100
3 5 50
1 2 51

```
### 样例输出 #1
```
true
false

```


---

---
title: "[HNOI2005] 虚拟内存"
layout: "post"
diff: 普及+/提高
pid: P2318
tag: ['模拟', '2005', '各省省选', '离散化', '湖南', '哈希 hashing']
---
# [HNOI2005] 虚拟内存
## 题目描述

操作系统中一种重要的存储管理技术就是虚拟内存技术。操作系统中允许进程同时运行，也就是并行。每个进程都有其相对独立的数据块（进程运行的过程中将对其进行读写操作）。理想的情况下，这些数据块都应该存放在内存中，这样才能实现高效的读写操作。但事实上，内存的容量有限，每个进程只能把一部分数据放在内存中，为了解决这个矛盾，提出了虚拟内存技术。

虚拟内存技术的基本原理是：对进程而言，内存空间是无限大的，进程可以随意地读写数据，而对操作系统内部而言，利用外存来模拟扩充的内存空间，进程要求访问某个内存单元时，交由操作系统处理，操作系统首先在内存中查找该单元是否存在，如果存在，查找成功，否则转入外存查找（一定存在于外存中）。

就存储介质的物理性质而言，内存的访问速度相对于外存要快得多，因此对于每个进程来说操作系统应该把那些访问次数较多的数据存放在内存中，而把那些访问次数很少的数据放在外存中。如何选择内存中暂留的数据是一个很值得研究的问题，下面介绍一个内存管理中比较常用的算法：

内存中的数据以页为基本存储单位，进程的读写操作都针对页来进行。实际内存空间被分割成n页，虚拟内存空间的页数往往要多得多。某一时刻，进程需要访问虚存编号为P的页，该算法的执行步骤如下：

a.    首先在内存中查找，如果该页位于内存中，查找成功，转d，否则继续下面的操作；

b.    寻找内存中是否存在空页（即没有装载任何数据页的页面），若有，则从外存中读入要查找页，并将该页送至内存中的空页进行存储，然后转d，否则继续下面的操作；

c.    在内存中寻找一个访问次数最少的页面（如果存在多个页面的访问次数同时为最少，则选取最早读入数据进入内存的那个页面），从外存中读入要查找页，替换该页。

d.    结束

所谓访问次数是指从当前页面进入内存到该时刻被访问的次数，如果该页面以前进入过内存并被其它页面替换，那么前面的访问次数不应计入这个时刻的访问次数中。

你的任务是设计一个程序实现上述算法。

测试数据将会提供 $m$ 条读写内存的命令，每条命题提供要求访问的虚拟内存页的编号 $P$ 。你的程序要求能够模拟整个 $m$ 条命令的全部执行过程，所有的命令是按照输入的先后执行的，最开始的时候内存中的 $n$ 页全为空。


## 输入格式

输入共 $m + 1$ 行，第 $1$ 行为 $n (n \le 10000)$ 和 $m (m \le 1000000)$ ，分别表示内存页数和读写内存命令条数。接下来有 $m$ 行，其中第 $i+1$ 行有一个正整数 $P_i (P_i \le 10^9)$ ，表示第i条读写内存命令需要访问的虚拟内存页的编号。

## 输出格式

输出中仅包含一个正整数，表示在整个模拟过程中，在内存中直接查找成功的次数（即上面的算法只执行步骤 a 的次数）。

## 样例

### 样例输入 #1
```
3 8 

1

1

2

3

4

2

5

4


```
### 样例输出 #1
```
1
```


---

---
title: "[HNOI2006] 鬼谷子的钱袋"
layout: "post"
diff: 普及+/提高
pid: P2320
tag: ['2006', '各省省选', '湖南', 'Special Judge', '进制']
---
# [HNOI2006] 鬼谷子的钱袋
## 题目描述

鬼谷子非常聪明，正因为这样，他非常繁忙，经常有各诸侯的特派员前来向他咨询时政。

有一天，他在咸阳游历的时候，朋友告诉他在咸阳最大的拍卖行（聚宝商行）将要举行一场拍卖会，其中有一件宝物引起了他极大的兴趣，那就是无字天书。

但是，他的行程安排得很满，他已经买好了去邯郸的长途马车票，不巧的是出发时间是在拍卖会快要结束的时候。于是，他决定事先做好准备，将自己的金币数好并用一个个的小钱袋装好，以便在他现有金币的支付能力下，任何数目的金币他都能用这些封闭好的小钱的组合来付账。

鬼谷子也是一个非常节俭的人，他想方设法使自己在满足上述要求的前提下，所用的钱袋数最少，并且不有两个钱袋装有相同的大于 $1$ 的金币数。假设他有 $m$ 个金币，你能猜到他会用多少个钱袋，并且每个钱袋装多少个金币吗？
## 输入格式

包含一个整数，表示鬼谷子现有的总的金币数目 $m$。其中，$1 \le m \le {10}^9$。
## 输出格式

两行，第一行一个整数 $h$，表示所用钱袋个数。

第二行表示每个钱袋所装的金币个数，由小到大输出，空格隔开。
## 样例

### 样例输入 #1
```
3

```
### 样例输出 #1
```
2
1 2

```


---

---
title: "[HNOI2006] 公路修建问题"
layout: "post"
diff: 普及+/提高
pid: P2323
tag: ['2006', '二分', '并查集', '各省省选', '湖南', 'Special Judge', '生成树']
---
# [HNOI2006] 公路修建问题
## 题目描述

OI island 是一个非常漂亮的岛屿，自开发以来，到这儿来旅游的人很多。然而，由于该岛屿刚刚开发不久，所以那里的交通情况还是很糟糕。所以，OIER Association 组织成立了，旨在建立 OI island 的交通系统。

OI island 有 $n$ 个旅游景点，不妨将它们从 $1$ 到 $n$ 标号。现在，OIER Association 需要修公路将这些景点连接起来。一条公路连接两个景点。公路有，不妨称它们为一级公路和二级公路。一级公路上的车速快，但是修路的花费要大一些。

OIER Association 打算修 $n-1$ 条公路将这些景点连接起来（使得任意两个景点之间都会有一条路径）。为了保证公路系统的效率， OIER Association 希望在这 $n-1$ 条公路之中，至少有 $k$ 条 $(0 \le k \le n-1)$ 一级公路。OIER Association 也不希望为一条公路花费的钱。所以，他们希望在满足上述条件的情况下，花费最多的一条公路的花费尽可能的少。

而你的任务就是，在给定一些可能修建的公路的情况下，选择 $n-1$ 条公路，满足上面的条件。
## 输入格式

文件第一行有三个数 $n(1 \le n \le 10000)$，$k(0 \le k \le n-1),m(n-1 \le m \le 20000)$，这些数之间用空格分开。$N$ 和 $k$ 如前所述，$m$ 表示有 $m$ 对景点之间可以修公路。

以下的 $m-1$ 行，每一行有 $4$ 个正整数 $a,b,c_1,c_2$，（$1 \le a,b \le n,a \ne b,1 \le c_2 \le c_1 \le 30000$），表示在景点 $a$ 与 $b$ 之间可以修公路，如果修一级公路，则需要 $c_1$ 的花费，如果修二级公路，则需要 $c_2$ 的花费。

**在实际评测时，将只会有 $m-1$ 行公路**

## 输出格式

输出第一行有一个数据，表示花费最大的公路的花费。

接下来的 $n-1$ 行，每行有两个正整数 $t$ 和 $p$，$t$ 和 $p$ 表示在输入的第 $t$ 对（按照输入的顺序，从 $1$ 开始标号）景点之间修建 $p$ 级公路。

$n-1$ 条公路的输出必须按 $t$ 的大小递增，如果有多个方案使花费最大的公路花费最小，那么输出任意一个都可以。
## 样例

### 样例输入 #1
```
4 2 5 
1 2 6 5
1 3 3 1
2 3 9 4
2 4 6 1
```
### 样例输出 #1
```
6 
1 1 
2 1 
4 1
```


---

---
title: "[SCOI2005] 栅栏"
layout: "post"
diff: 普及+/提高
pid: P2329
tag: ['搜索', '2005', '四川', '各省省选', '深度优先搜索 DFS', '剪枝']
---
# [SCOI2005] 栅栏
## 题目描述


农夫约翰打算建立一个栅栏将他的牧场给围起来，因此他需要一些特定规格的木材。于是农夫约翰到木材店购买木材。可是木材店老板说他这里只剩下少部分大规格的木板了。不过约翰可以购买这些木板，然后切割成他所需要的规格。而且约翰有一把神奇的锯子，用它来锯木板，不会产生任何损失，也就是说长度为 $10$ 的木板可以切成长度为 $8$ 和 $2$ 的两个木板。

你的任务：给你约翰所需要的木板的规格，还有木材店老板能够给出的木材的规格，求约翰最多能够得到多少他所需要的木板。
## 输入格式

第一行为整数 $m(m\leq50)$ 表示木材店老板可以提供多少块木材给约翰。紧跟着 $m$ 行为老板提供的每一块木板的长度。

接下来一行（即第 $m+2$ 行）为整数 $n(n\leq1000)$，表示约翰需要多少木材。

接下来 $n$ 行表示他所需要的每一块木板的长度。木材的规格小于 $32767$。（对于店老板提供的和约翰需要的每块木板，你只能使用一次）。
## 输出格式

只有一行，为约翰最多能够得到的符合条件的木板的个数。

## 样例

### 样例输入 #1
```
4
30
40
50
25
10
15
16
17
18
19
20
21
25
24
30

```
### 样例输出 #1
```
7
```
### 样例输入 #2
```
3
20
10
10
9
3
3
3
5
5
7
8
8
9

```
### 样例输出 #2
```
7
```


---

---
title: "[USACO03FALL / HAOI2006] 受欢迎的牛 G"
layout: "post"
diff: 普及+/提高
pid: P2341
tag: ['图论', '2003', '2006', '河南', 'USACO', '各省省选', '强连通分量', 'Tarjan', '栈']
---
# [USACO03FALL / HAOI2006] 受欢迎的牛 G
## 题目背景

本题测试数据已修复。
## 题目描述

每头奶牛都梦想成为牛棚里的明星。被所有奶牛喜欢的奶牛就是一头明星奶牛。所有奶牛都是自恋狂，每头奶牛总是喜欢自己的。奶牛之间的“喜欢”是可以传递的——如果 $A$ 喜欢 $B$，$B$ 喜欢 $C$，那么 $A$ 也喜欢 $C$。牛栏里共有 $N$ 头奶牛，给定一些奶牛之间的爱慕关系，请你算出有多少头奶牛可以当明星。
## 输入格式

第一行：两个用空格分开的整数：$N$ 和 $M$。

接下来 $M$ 行：每行两个用空格分开的整数：$A$ 和 $B$，表示 $A$ 喜欢 $B$。

## 输出格式

一行单独一个整数，表示明星奶牛的数量。

## 样例

### 样例输入 #1
```
3 3
1 2
2 1
2 3
```
### 样例输出 #1
```
1
```
## 提示

只有 $3$ 号奶牛可以做明星。

【数据范围】

对于 $10\%$ 的数据，$N\le20$，$M\le50$。

对于 $30\%$ 的数据，$N\le10^3$，$M\le2\times 10^4$。

对于 $70\%$ 的数据，$N\le5\times 10^3$，$M\le5\times 10^4$。

对于 $100\%$ 的数据，$1\le N\le10^4$，$1\le M\le5\times 10^4$。


---

---
title: "[SDOI2005] 阶梯教室设备利用"
layout: "post"
diff: 普及+/提高
pid: P2439
tag: ['2005', '各省省选', '山东']
---
# [SDOI2005] 阶梯教室设备利用
## 题目描述

我们现有许多演讲要在阶梯教室中举行。每一个演讲都可以用唯一的起始和终止时间来确定，如果两个演讲时间有部分或全部重复，那么它们是无法同时在阶级教室中举行的。现在我们想要尽最大可能的利用这个教室，也就是说，我们需要在这些演讲中选择一些不重复的演讲来举行使得他们用的总时间尽可能的长。我们假设在某一演讲结束的瞬间我们就可以立即开始另一个演讲。

请写一个程序：

读入所有演讲的起始和终止时间，计算最大的可能演讲总时间。
## 输入格式

第一行包括一个正整数 $n$，为所有的演讲的数目。

以下的 $n$ 行每行含有两个由空格隔开的整数 $p$ 和 $k$。这样的一对整数表示一个演讲由时间 $p$ 开始到时间 $k$ 结束。
## 输出格式

输出唯一的一个整数，为最长的演讲总时间。

## 样例

### 样例输入 #1
```
12

1 2

3 5

0 4

6 8

7 13

4 6

9 10

9 12

11 14

15 19

14 16

18 20


```
### 样例输出 #1
```
16
```
## 提示

### 样例解释

可以选择第 $3$ 个、第 $5$ 个、第 $6$ 个、第 $11$ 个、第 $12$ 个演讲，此时有最长的演讲总时间 $16$。

### 数据范围

$1\le n\le 10^4$，$0\le p<k\le 3\times 10^4$。


---

---
title: "[SDOI2006] 保安站岗"
layout: "post"
diff: 普及+/提高
pid: P2458
tag: ['2006', '各省省选', '山东']
---
# [SDOI2006] 保安站岗
## 题目描述

五一来临，某地下超市为了便于疏通和指挥密集的人员和车辆，以免造成超市内的混乱和拥挤，准备临时从外单位调用部分保安来维持交通秩序。

已知整个地下超市的所有通道呈一棵树的形状；某些通道之间可以互相望见。总经理要求所有通道的每个端点（树的顶点）都要有人全天候看守，在不同的通道端点安排保安所需的费用不同。

一个保安一旦站在某个通道的其中一个端点，那么他除了能看守住他所站的那个端点，也能看到这个通道的另一个端点，所以一个保安可能同时能看守住多个端点（树的结点），因此没有必要在每个通道的端点都安排保安。

编程任务：

请你帮助超市经理策划安排，在能看守全部通道端点的前提下，使得花费的经费最少。

## 输入格式

第 $1$ 行 $n$，表示树中结点的数目。

第 $2$ 行至第 $n+1$ 行，每行描述每个通道端点的信息，依次为：该结点标号 $i$（$0<i \le n$），在该结点安置保安所需的经费 $k$（$ \le 10000$），该边的儿子数 $m$，接下来 $m$ 个数，分别是这个节点的 $m$ 个儿子的标号 $r_1,r_2,\cdots, r_m$。

对于一个 $n$（$0<n \le 1500$）个结点的树，结点标号在 $1$ 到 $n$ 之间，且标号不重复。
## 输出格式

输出一行一个整数，表示最少的经费。


## 样例

### 样例输入 #1
```
6

1 30 3 2 3 4

2 16 2 5 6

3 5 0

4 4 0

5 11 0

6 5 0
```
### 样例输出 #1
```
25
```
## 提示

### 样例解释

![](https://cdn.luogu.com.cn/upload/image_hosting/g013tlmh.png)

在结点 $2,3,4$ 安置 $3$ 个保安能看守所有的 $6$ 个结点，需要的经费最小：$25$。



---

---
title: "[SCOI2008] 着色方案"
layout: "post"
diff: 普及+/提高
pid: P2476
tag: ['动态规划 DP', '搜索', '2008', '四川', '各省省选', '记忆化搜索']
---
# [SCOI2008] 着色方案
## 题目描述

有 $n$ 个木块排成一行，从左到右依次编号为 $1$ 至 $n$。

你有 $k$ 种颜色的油漆，第 $i$ 种颜色的油漆足够涂 $c_i$ 个木块。

所有油漆刚好足够涂满所有木块，即 $\sum_{i=1}^kc_i=n$。

由于相邻两个木块涂相同色显得很难看，所以你希望统计任意两个相邻木块颜色不同的着色方案。

由于答案可能很大，请输出对 $10^9+7$ 取模的结果。
## 输入格式

第一行，一个整数 $k$，表示颜色数量。

第二行 $k$ 个整数 $c_1,c_2,\dots,c_k$，表示每种颜色能够涂木块的个数。
## 输出格式

一行一个整数，表示答案对 $10^9+7$ 取模的结果。
## 样例

### 样例输入 #1
```
3
1 2 3
```
### 样例输出 #1
```
10
```
### 样例输入 #2
```
5
2 2 2 2 2
```
### 样例输出 #2
```
39480
```
### 样例输入 #3
```
10
1 1 2 2 3 3 4 4 5 5

```
### 样例输出 #3
```
85937576
```
## 提示

- 对于 $50\%$ 的数据，$1 \leq k \leq 5$，$1 \leq c_i \leq 3$；
- 对于 $100\%$ 的数据，$1 \leq k \leq 15$，$1 \leq c_i \leq 5$。


---

---
title: "[SDOI2012] 拯救小云公主"
layout: "post"
diff: 普及+/提高
pid: P2498
tag: ['2012', '二分', '各省省选', '山东']
---
# [SDOI2012] 拯救小云公主
## 题目描述

英雄又即将踏上拯救公主的道路……

这次的拯救目标是——爱和正义的小云公主。

英雄来到boss的洞穴门口，他一下子就懵了，因为面前不只是一只boss，而是上千只boss。当英雄意识到自己还是等级1的时候，他明白这就是一个不可能完成的任务。

但他不死心，他在想，能不能避开boss去拯救公主呢，嘻嘻。

Boss的洞穴可以看成一个矩形，英雄在左下角（1,1），公主在右上角（row，line）。英雄为了避开boss，当然是离boss距离越远越好了，所以英雄决定找一条路径使到距离boss的最短距离最远。

Ps:英雄走的方向是任意的，但是不能走出矩形的范围。即英雄可以到达矩形范围内的任意一个点（没有必要是整点）

你可以帮帮他吗？

当英雄找到了美丽漂亮的小云公主，立刻就被boss包围了！！！英雄缓闭双眼，举手轻挥，白光一闪后使用了回城卷轴，回到了城堡，但只有小云公主回去了……因为英雄忘了进入回城的法阵了。

## 输入格式

第一行，输入三个整数，n表示boss的数目，row，line表示矩形的大小；

接下来n行，每行分别两个整数表示boss的位置坐标。

## 输出格式

输出一个小数，表示英雄的路径离boss的最远距离，精确到小数点后两位。

## 样例

### 样例输入 #1
```
1 3 3

2 2
```
### 样例输出 #1
```
1.00
```
### 样例输入 #2
```
1 3 3

3 1
```
### 样例输出 #2
```
2.00
```
## 提示

数据范围：

20%数据，boss坐标范围小于等于50；

60%数据，n<=1500；

100%数据，n<=3000；




---

---
title: "[SHOI2001] Panda的烦恼"
layout: "post"
diff: 普及+/提高
pid: P2527
tag: ['搜索', '2001', '各省省选', '离散化', '上海']
---
# [SHOI2001] Panda的烦恼
## 题目描述

panda 是个数学怪人，他非常喜欢研究跟别人相反的事情。最近他正在研究筛法，众所周知，对一个范围内的整数，经过筛法处理以后，剩下的全部都是质数，不过 panda 对这些不感兴趣，他只对被筛掉的数感兴趣，他觉得在这些被筛掉的数中一定隐藏着重要的宇宙秘密，只是人们还没有发现罢了。

panda 还觉得如果只是单纯地从小到大筛的话，还不足够发现其中的奥秘，于是他决定对至多只包含某些质因数的数进行研究（比如说至多只包含质因数  $2,3$ 的数有  $2,3,4,6,8,9,\ldots$），他需要得到这些数中第  $k$ 小的数（ $k$ 是 panda 认为的宇宙系数），请你编个程序，帮助他找到这个数。
## 输入格式

第一行有两个整数  $n,k$， $n$ 代表质因数的个数， $k$ 代表那个宇宙系数。

第二行有  $n$ 个整数，代表这  $n$ 个质因数，设这些质因数组成的序列为  $p$。

## 输出格式

仅一行，即至多只包含这  $n$ 个质因数的数中第  $k$ 小的正整数，设这个答案为  $ans$。
## 样例

### 样例输入 #1
```
2 7
3 5
```
### 样例输出 #1
```
45


```
## 提示

#### 样例解释

前六个数分别是  $3,5,9,15,25,27$。

#### 数据范围及限制

对于所有数据，有  $1\le n\le 100$， $1\le k\le 10^5$， $p_i\in\text{prime}$， $p_i\le 10^3$， $p_i\not=p_j(i\not=j)$， $1\le ans\le 2\times 10^9$。


---

---
title: "[SHOI2001] 排序工作量之新任务"
layout: "post"
diff: 普及+/提高
pid: P2528
tag: ['2001', '各省省选', '上海']
---
# [SHOI2001] 排序工作量之新任务
## 题目描述

假设我们将序列中第 $i$ 件物品的参数定义为 $A_i$，那么排序就是指将 $A_1, \cdots ,A_n$ 从小到大排序。若 $i<j$ 且 $A_i>A_j$ ，则 $(i,j)$ 就为一个“逆序对”。SORT 公司是一个专门为用户提供排序服务的公司，他们的收费标准就是被要求排序物品的“逆序对”的个数，简称“逆序数”。

Grant 是这家公司的排序员，他想知道对于 $n$ 个参数都不同的物品组成的序列集合中，逆序对数为 $t$ 的物品有多少个，并试给出其中一个最小的物品序列。所谓最小，即若有两个物品序列 $(A_1,A_2,\cdots ,A_n)$，$(B_1,B_2,\cdots ,B_n)$，存在 $1 \le i \le n$，使得 $(A_1,A_2,\cdots ,A_{i-1})=(B_1,B_2,\cdots,B_{i-1})$ 且$A_i<B_i$。

## 输入格式

即两个整数 $n$和 $t(1 \le n \le 20,0 \le t \le \dfrac{n\cdot (n-1)}{2})$。

## 输出格式

第一行表示 $n$ 个参数都不通的物品组成的序列集合中，逆序数为 $t$ 的序列个数；

第二行是所求物品参数序列。假设 $n$ 个物品分别为 $1$ 到 $n$。

## 样例

### 样例输入 #1
```
4 3
```
### 样例输出 #1
```
6
1 4 3 2
```


---

---
title: "[AHOI2012] 树屋阶梯"
layout: "post"
diff: 普及+/提高
pid: P2532
tag: ['模拟', '高精度', '2012', '各省省选', '安徽', 'Catalan 数']
---
# [AHOI2012] 树屋阶梯
## 题目描述

 ![](https://cdn.luogu.com.cn/upload/pic/1630.png) 

 ![](https://cdn.luogu.com.cn/upload/pic/1631.png) 


## 输入格式

一个正整数 $N$，表示阶梯的高度。

## 输出格式

一个正整数，表示搭建方法的个数。**注**：搭建方法的个数可能很大。

## 样例

### 样例输入 #1
```
3
```
### 样例输出 #1
```
5
```
## 提示

- 对于 $40\%$ 的数据，满足 $1\le N\le 20$。
- 对于 $80\%$ 的数据，满足 $1\le N\le 300$。
- 对于 $100\%$ 的数据，满足 $1\le N\le 500$。



---

---
title: "[AHOI2005] 病毒检测"
layout: "post"
diff: 普及+/提高
pid: P2536
tag: ['字符串', '2005', '各省省选', '安徽', '字典树 Trie', 'AC 自动机']
---
# [AHOI2005] 病毒检测
## 题目描述

科学家们在 Samuel 星球上的探险仍在继续。非常幸运的，在 Samuel 星球的南极附近，探险机器人发现了一个巨大的冰湖！机器人在这个冰湖中搜集到了许多 RNA 片段运回了实验基地。

科学家们经过几个昼夜的研究，发现这些 RNA 片段中有许多是未知的病毒！

每个 RNA 片段都是由 `A`、`C`、`T`、`G` 组成的序列。科学家们也总结出了 Samuel 星球上的“病毒模版片段”。一个模版片段是由 `A`、`C`、`T`、`G` 的序列加上通配符 `*` 和 `?` 来表示。其中 `*` 的意思是可以匹配上 $0$ 个或任意多个字符，而 `?` 的意思是匹配上任意一个字母。

如果一个 RNA 片段能够和“病毒模版片段”相匹配，那么这个 RNA 片段就是未知的病毒。

例如，假设 “病毒模版片段”为 `A*G?C`。RNA 片段：`AGTC`，`AGTGTC` 都是未知的病毒，而 RNA 片段 `AGTGC` 则不是病毒。

由于，机器人搜集的这些 RNA 片段中除去病毒的其他部分都具有非常高的研究价值。所以科学家们希望能够分辨出其中哪些 RNA 片段不是病毒，并将不是病毒的 RNA 片段运回宇宙空间站继续进行研究。

科学家将这项任务交给了小联。现在请你为小联编写程序统计哪些 RNA 片段不是病毒。
## 输入格式

共 $N+2$ 行输入。

第一行有一个字符串，由 `A`、`C`、`T`、`G`、`*`、`?` 组成，表示“病毒模版片段”。“病毒模版片段”的长度不超过 $1000$。

第二行有一个整数 $N$，表示机器人搜集到的 RNA 片段的数目。

随后的 $N$ 行，每一行有一个字符串，由 `A`、`C`、`T`、`G` 组成，表示一个 RNA 片段。
## 输出格式

只有一行输出，为整数 $M$，即不是病毒的 RNA 片段的数目。

## 样例

### 样例输入 #1
```
A*G?C
3
AGTC
AGTGTC
AGTGC
```
### 样例输出 #1
```
1
```
## 提示

输入中的 RNA 片段 `AGTGC` 不是病毒。

对于所有数据，$0 < N < 500$。

特别的：

- 每个 RNA 片段的长度不超过 $500$；
- “病毒模版片段”和 RNA 片段的长度都至少为 $1$。


---

---
title: "[AHOI2001] 多项式乘法"
layout: "post"
diff: 普及+/提高
pid: P2553
tag: ['模拟', '数学', '2001', '各省省选', '安徽']
---
# [AHOI2001] 多项式乘法
## 题目描述

请编程序把含有乘法运算的代数多项式表达式改写成不含乘法的代数多项式。为简化计算，特做以下约定：

1. 代数多项式表达式中只涉及一个代数符号 `a`；
2. 保证输入的「含乘法运算的代数多项式」有且仅有一个「代数多项式」与「代数多项式」的乘法。形式化地讲，每一个测试点的输入数据中，一定有且仅有一行 `(...)*(...)`，其中 `...` 为不含乘法运算的代数多项式。
3. 一个「不含乘法运算的代数多项式」会被写作 `XXXa^YYY+XXXa^YYY+XXXa^YYY+...+XXX`（代表 $\text{XXX}a ^ \text{YYY} + \text{XXX}a ^ \text{YYY} + \text{XXX}a ^ \text{YYY} + \cdots + \text{XXX}$），其中 `XXX`、`YYY` 均为正整数，且保证除第一项外每一项的 `YYY` 比上一项的 `YYY` 少 $1$。例如，一个合法的「不含乘法运算的代数多项式」为 `142a^4+9a^3+4a^2+1a^1+3`。

> 对于约定 3，原题目给予了这样一个表述：常数项以外的各项都是 $xa^y$ 的形式，写作 `xa^y`，其中 $x$ 为该项的系数，而 $y$ 是该项的指数。$x = 1$ 时，不得简写成 `a^y`，应写成 `1a^y`。而 $y = 1$ 时，不得简写成 `xa`，应写成 `xa^1`。
## 输入格式

输入仅有一行字符串，代表给定的「含乘法运算的代数多项式」。

其格式为：`(...)*(...)`，其中 `...` 为不含乘法运算的代数多项式。对于「不含乘法运算的代数多项式」的约束，请参考题目描述。

## 输出格式

输出一行一个字符串，代表答案。

答案要求指数大的项不能出现在指数小的项之后，指数相同的项必须合并同类项。**不允许出现不必要的空白字符**。输出中不允许有括号。
## 样例

### 样例输入 #1
```
(5a^2+3a^1+2)*(4a^1+1)
(5a^1+1)* (5a^1+1)
```
### 样例输出 #1
```
20a^3+17a^2+11a^1+2
25a^2+10a^1+1
```
## 提示

关于数据范围以及数据若干格式的说明：

* 系数范围和指数范围均为 $[0,30]$。


---

---
title: "[AHOI2002] 数的朗读"
layout: "post"
diff: 普及+/提高
pid: P2555
tag: ['2002', '各省省选', '安徽']
---
# [AHOI2002] 数的朗读
## 题目描述

春游时小可可结识了刚回国定居的 Sealock。但是 Sealock 在海外出生，

回国后才开始学习汉语。数的朗读成为 Sealock 的一个难题，小可可下决心

教会 Sealock 如何朗读绝对值小于 10 亿的数。

小可可知道汉语中有如下的读数规则：

⑴首先读符号位， 然后读整数部分， 整数部分之后可能出现小数点， 如果有

小数部分则小数点一定出现、并且读出小数点之后读小数部分；

⑵符号位的读法是：

(2.1)正数，不论正号“+”是否出现，都不必读出符号位；

(2.2)负数的最左边的符号是“-”， 读成“ 负” (以“ F” 来表示“负” )；

⑶整数部分的读法是：

蚌埠， 2002.4.20 AH02SGOI11A1.doc 第1页

2002 年安徽省青少年信息学(计算机)竞赛网上同步赛暨 SGOI 第十一次友谊赛 一试试题

(3.1)如果整数部分不存在或者整数部分全是零则直接读成“零” (以“ 0”

来表示“零” )；

(3.2)否则从整数部分中最左边的非零数字开始读起， 然后以十、 百、 千、

万、亿(分别以“ S”、“ B”、“ Q”、“ W”、“ Y”来表示)等数量单位来拼读整

数部分；

⑷整数部分中：

(4.1)每一个非零数字都必须结合各个相应的数量单位读出来；

(4.2)每一段连续的“零” 只能读成一个“零”， 但是某一段连续的“零”的左侧或者右侧不存在非零数字(这里只考虑整数部分)则这一段“零” 不应该读出来；

⑸如果有小数部分，则首先读“点”(以“ D”来表示“点”)，然后从左至右顺序地读出各个小数位。 在读小数部分的时候不可以使用十、 百、 千、 万、亿等数量单位； 但是小数部分的每一个数字都需要读出来， 连续的零不可以读成一个“零”，而应该分别读出；

⑹如果数中有小数点而没有小数部分，则不应该把小数点读出来。

例如， -0020030004.567 应该读成“ F2Q03W04D567”， 000.89 应该读成“ 0D89”。

请你编写程序帮助小可可把给定的数正确地读出来。

## 输入格式

文件中以一行的形式存放了一个数(不超过 50 个字符)，其绝对值

小于 10 亿。

## 输出格式

以一行的形式输出这个数的正确读法。

## 样例

### 样例输入 #1
```
000.89
```
### 样例输出 #1
```
0D89
```
### 样例输入 #2
```
-0020030004.567
```
### 样例输出 #2
```
F2Q03W04D567
```


---

---
title: "[AHOI2002] 芝麻开门"
layout: "post"
diff: 普及+/提高
pid: P2557
tag: ['数学', '2002', '各省省选', '安徽']
---
# [AHOI2002] 芝麻开门
## 题目描述

周末小可可参加智力大冲浪活动，经过努力终于来到最后一关“芝麻开门”。门上的电子显示屏写着这么一段话：如果你能把 $n^k$ 的所有正整数因子的和正确地写在门上，并念一声“芝麻开门”，门就能够自由打开。

例如：$n=2$，$k=3$，则 $n^k=8$，它的正因子有 $1,2,4,8$，如果小可可把它们的和 $15$ 写在门上，然后念一声“芝麻开门”，门就能够自动打开。

已知门上的 $n,k$ 都是每过一段时间就会变化一次，请你编写程序协助小可可在规定的时间内求出答案，从而获得智力大冲浪的最终大奖。

## 输入格式

一行两个正整数 $n,k$。

## 输出格式

一行一个整数表示答案。

## 样例

### 样例输入 #1
```
1 1
```
### 样例输出 #1
```
1
```
### 样例输入 #2
```
2 2
```
### 样例输出 #2
```
7
```
## 提示

$1\le  n  \le 2^{16}$，$1\le k \lt 20$。

解的位数不超过 $100$ 位。


---

---
title: "[AHOI2002] 网络传输"
layout: "post"
diff: 普及+/提高
pid: P2558
tag: ['动态规划 DP', '搜索', '2002', '各省省选', '安徽', '栈']
---
# [AHOI2002] 网络传输
## 题目描述

在计算机网络中所有数据都是以二进制形式来传输的。但是在进行较大数据的传输时，直接使用该数的二进制形式加以传输则往往传输的位数过多。譬如要传输 $1024$ 就需要 $11$ 位二进制数。于是小可可提出了一种数据优化传输的设想，并打算对这一设想进行试验。

该设想是：正整数的所有方幂以及任意多个互不相等的 $k$ 的方幂之和排成一个递增数列 $\{a(k)n\}$，例如当 $k=3$ 时，$\{a(k)n\}$ 的前 $7$ 项为 $1(=3^0)$ 、 $3(=3^1)$ 、 $4(=3^0+3^1)$ 、 $9(=3^2)$ 、 $10(=3^0+3^2)$ 、 $12(=3^1+3^2)$ 、 $13(=3^0+3^1+3^2)$。

如果数 $d$ 是数列 $\{a(k)n\}$ 中的第 $p$ 项，则可以通过传送 $k$ 和 $p$ 这两个数来表示数 $d$。由于 $k$ 和 $p$ 这两个相对很小的数就可以表达出很大的数，因而理论上可以减少网络传输的位数。

小可可现在请你编写程序把接收到的数 $k$ 和 $p$ 所代表的数 $d$ 计算出来。
## 输入格式

文件中以一行的形式存放了两个正整数 $k$ 和 $p$，$1<k \le 1024$，
$1 \le p \le 1024$。
## 输出格式

以一行的形式输出问题的解（解的位数不超过 $50$ 位）。
## 样例

### 样例输入 #1
```
3 2
```
### 样例输出 #1
```
3
```
### 样例输入 #2
```
3 7
```
### 样例输出 #2
```
13
```


---

---
title: "[AHOI2002] Kitty猫基因突变"
layout: "post"
diff: 普及+/提高
pid: P2560
tag: ['2002', '各省省选', '安徽']
---
# [AHOI2002] Kitty猫基因突变
## 题目描述

 ![](https://cdn.luogu.com.cn/upload/pic/1682.png) 

![](https://cdn.luogu.com.cn/upload/pic/1683.png)

## 输入格式

![](https://cdn.luogu.com.cn/upload/pic/1684.png)

## 输出格式

以一行的形式输出评价效果最好的突变方案的评价指标。

## 样例

### 样例输入 #1
```
3 2
11000101
10 10 5 6 3 2 1 2
```
### 样例输出 #1
```
9
```


---

---
title: "[SCOI2009] 生日礼物"
layout: "post"
diff: 普及+/提高
pid: P2564
tag: ['2009', '四川', '各省省选', '单调队列', '队列']
---
# [SCOI2009] 生日礼物
## 题目背景

四川2009NOI省选

## 题目描述


小西有一条很长的彩带，彩带上挂着各式各样的彩珠。已知彩珠有 $N$ 个，分为 $K$ 种。简单的说，可以将彩带抽象为一个 x 轴，每一个彩珠有一个对应的坐标（即位置）。某些坐标上可以没有彩珠，但多个彩珠也可以出现在同一个位置上。

小布的生日快到了，于是小西打算剪一段彩带送给小布。为了让礼物彩带足够漂亮，小西希望这一段彩带中能包含所有种类的彩珠。同时，为了方便，小西希望这段彩带尽可能短，你能帮助小西计算这个最短的长度么？

彩带的长度即为彩带开始位置到结束位置的位置差。

## 输入格式

第一行包含两个整数 $N, K$，分别表示彩珠的总数以及种类数。

接下来 $K$ 行，每行第一个数为 $T_i$，表示第 $i$ 种彩珠的数目。

接下来按升序给出 $T_i$ 个非负整数，为这 $T_i$ 个彩珠分别出现的位置。
## 输出格式

输出应包含一行，为最短彩带长度。

## 样例

### 样例输入 #1
```
6 3
1 5
2 1 7
3 1 3 8

```
### 样例输出 #1
```
3
```
## 提示


### 样例说明

有多种方案可选，其中比较短的是 $1 \sim 5$ 和 $5 \sim 8$。后者长度为 $3$，更短，故答案为 $3$。

### 数据范围

对于 $50\%$ 的数据，$N \le 10^4$；

对于 $80\%$ 的数据，$N \le 8 \times 10^5$；

对于 $100\%$ 的数据，$1 \le N \le 10^6, 1 \le K \le 60$，$0 \le$ 珠子位置 $< 2^{31}$，且 $\sum T_i = N$。


---

---
title: "[ZJOI2004] 午餐"
layout: "post"
diff: 普及+/提高
pid: P2577
tag: ['动态规划 DP', '2004', '各省省选', '浙江', '排序']
---
# [ZJOI2004] 午餐
## 题目描述

上午的训练结束了，THU ACM小组集体去吃午餐，他们一行N人来到了著名的十食堂。这里有两个打饭的窗口，每个窗口同一时刻只能给一个人打饭。由于每个人的口味（以及胃口）不同，所以他们要吃的菜各有不同，打饭所要花费的时间是因人而异的。另外每个人吃饭的速度也不尽相同，所以吃饭花费的时间也是可能有所不同的。

THU ACM小组的吃饭计划是这样的：先把所有的人分成两队，并安排好每队中各人的排列顺序，然后一号队伍到一号窗口去排队打饭，二号队伍到二号窗口去排队打饭。每个人打完饭后立刻开始吃，所有人都吃完饭后立刻集合去六教地下室进行下午的训练。

现在给定了每个人的打饭时间和吃饭时间，要求安排一种最佳的分队和排队方案使得所有人都吃完饭的时间尽量早。

假设THU ACM小组在时刻0到达十食堂，而且食堂里面没有其他吃饭的同学（只有打饭的师傅）。每个人必须而且只能被分在一个队伍里。两个窗口是并行操作互不影响的，而且每个人打饭的时间是和窗口无关的，打完饭之后立刻就开始吃饭，中间没有延迟。

现在给定N个人各自的打饭时间和吃饭时间，要求输出最佳方案下所有人吃完饭的时刻。

## 输入格式

第一行一个整数N，代表总共有N个人。

以下N行，每行两个整数 Ai，Bi。依次代表第i个人的打饭时间和吃饭时间。

## 输出格式

一个整数T，代表所有人吃完饭的最早时刻。

## 样例

### 样例输入 #1
```
5

2 2

7 7

1 3

6 4

8 5


```
### 样例输出 #1
```
17
```
## 提示

所有输入数据均为不超过200的正整数。



---

---
title: "[ZJOI2006] 三色二叉树"
layout: "post"
diff: 普及+/提高
pid: P2585
tag: ['动态规划 DP', '搜索', '2006', '各省省选', '浙江', '深度优先搜索 DFS']
---
# [ZJOI2006] 三色二叉树
## 题目描述

一棵二叉树可以按照如下规则表示成一个由 $0$、$1$、$2$ 组成的字符序列，我们称之为“二叉树序列 $S$”：

$$S=
\begin{cases}
0& \text表示该树没有子节点\\
1S_1& 表示该树有一个节点，S_1 为其子树的二叉树序列\\
2S_1S_2& 表示该树由两个子节点，S_1 和 S_2 分别表示其两个子树的二叉树序列
\end{cases}$$

例如，下图所表示的二叉树可以用二叉树序列 $S=\texttt{21200110}$ 来表示。

![haha.png](https://i.loli.net/2020/04/27/Ijw8ZEWCKH2rtJG.png)

你的任务是要对一棵二叉树的节点进行染色。每个节点可以被染成红色、绿色或蓝色。并且，一个节点与其子节点的颜色必须不同，如果该节点有两个子节点，那么这两个子节点的颜色也必须不同。给定一颗二叉树的二叉树序列，请求出这棵树中**最多和最少**有多少个点能够被染成绿色。
## 输入格式

输入只有一行一个字符串 $s$，表示二叉树序列。
## 输出格式

输出只有一行，包含两个数，依次表示最多和最少有多少个点能够被染成绿色。
## 样例

### 样例输入 #1
```
1122002010
```
### 样例输出 #1
```
5 2
```
## 提示

#### 数据规模与约定

对于全部的测试点，保证 $1 \leq |s| \leq 5 \times 10^5$，$s$ 中只含字符 `0` `1` `2`。


---

---
title: "[ZJOI2008] 泡泡堂"
layout: "post"
diff: 普及+/提高
pid: P2587
tag: ['贪心', '2008', '各省省选', '浙江']
---
# [ZJOI2008] 泡泡堂
## 题目描述

第 XXXX 届 NOI 期间，为了加强各省选手之间的交流，组委会决定组织一场省际电子竞技大赛，每一个省的代表队由 $n$ 名选手组成，比赛的项目是老少咸宜的网络游戏泡泡堂。每一场比赛前，对阵双方的教练向组委会提交一份参赛选手的名单，决定了选手上场的顺序，一经确定，不得修改。比赛中，双方的一号选手，二号选手……，$n$ 号选手捉对厮杀，共进行 $n$ 场比赛。每胜一场比赛得 $2$ 分，平一场得 $1$ 分，输一场不得分。最终将双方的单场得分相加得出总分，总分高的队伍晋级(总分相同抽签决定)。

作为浙江队的领队，你已经在事先将各省所有选手的泡泡堂水平了解的一清二楚，并将其用一个实力值来衡量。为简化问题，我们假定选手在游戏中完全不受任何外界因素干扰，即实力强的选手一定可以战胜实力弱的选手，而两个实力相同的选手一定会战平。由于完全不知道对手会使用何种策略来确定出场顺序，所以所有的队伍都采取了这样一种策略，就是完全随机决定出场顺序。

当然你不想这样不明不白的进行比赛。你想事先了解一下在最好与最坏的情况下，浙江队最终分别能得到多少分。

## 输入格式

输入文件的第一行为一个整数 $n$，表示每支代表队的人数。

接下来 $n$ 行，每行一个整数，描述了 $n$ 位浙江队的选手的实力值。

接下来 $n$ 行，每行一个整数，描述了你的对手的 $n$ 位选手的实力值。



## 输出格式

输入文件中包括两个用空格隔开的整数，分别表示浙江队在最好与最坏的情况下分别能得多少分。不要在行末输出多余的空白字符。

## 样例

### 样例输入 #1
```
2
1
3
2
4

```
### 样例输出 #1
```
2 0
```
### 样例输入 #2
```
6
10000000
10000000
10000000
10000000
10000000
10000000
0
0
0
0
0
0

```
### 样例输出 #2
```
12 12
```
## 提示

样例说明

1：我们分别称 $4$ 位选手为 $A,B,C,D$ 。则可能出现以下 $4$ 种对战方式，最好情况下可得 $2$ 分，最坏情况下得 $0$ 分。

| | 浙江 | ？？？ | 结果 | 浙江 | ？？？ | 结果 |  浙江 | ？？？ | 结果 | 浙江 | ？？？ | 结果 |
| :----------- | :----------- | :----------- | :----------- | :----------- | :----------- | :----------- | :----------- | :----------- | :----------- | :----------- | :----------- | :----------- |
| 一号 | A | C | 负 | A | D | 负 | B | C | 胜 | B | D | 负 |
| 二号 | B | D | 负 | B | C | 胜 | A | D | 负 | A | C | 负 |
| 得分 |  |  | 0 |  |  | 2 |  |  | 2 |  |  | 0 |


2：对手都是认真学习的好孩子，不会打游戏。无论如何排列出场顺序都无法改变被蹂躏的结果。浙江队总能取得全胜的结果。

$20\%$ 的数据中，$1\leq n\leq 10$；

$40\%$ 的数据中，$1\leq n\leq 100$；

$60\%$ 的数据中，$1\leq n\leq 1000$；

$100\%$ 的数据中，$1\leq n\leq 100000$，且所有选手的实力值在 $0$ 到 $10000000$ 之间。



---

---
title: "[ZJOI2010] 数字计数"
layout: "post"
diff: 普及+/提高
pid: P2602
tag: ['动态规划 DP', '递推', '2010', '各省省选', '浙江', '深度优先搜索 DFS', '数位 DP']
---
# [ZJOI2010] 数字计数
## 题目描述

给定两个正整数 $a$ 和 $b$，求在 $[a,b]$ 中的所有整数中，每个数码(digit)各出现了多少次。
## 输入格式

仅包含一行两个整数 $a,b$，含义如上所述。
## 输出格式

包含一行十个整数，分别表示 $0\sim 9$ 在 $[a,b]$ 中出现了多少次。
## 样例

### 样例输入 #1
```
1 99

```
### 样例输出 #1
```
9 20 20 20 20 20 20 20 20 20

```
## 提示

#### 数据规模与约定

- 对于 $30\%$ 的数据，保证 $a\le b\le10^6$；
- 对于 $100\%$ 的数据，保证 $1\le a\le b\le 10^{12}$。


---

---
title: "[ZJOI2012] 旅游"
layout: "post"
diff: 普及+/提高
pid: P2610
tag: ['动态规划 DP', '2012', '各省省选', '浙江', '广度优先搜索 BFS', '树形 DP', '树的直径']
---
# [ZJOI2012] 旅游
## 题目描述

到了难得的暑假，为了庆祝小白在数学考试中取得的优异成绩，小蓝决定带小白出去旅游~~

经过一番抉择，两人决定将 T 国作为他们的目的地。T 国的国土可以用一个凸 $n$ 边形来表示，$n$ 个顶点表示 $n$ 个入境/出境口。T 国包含 $n-2$ 个城市，每个城市都是顶点均为 $n$ 边形顶点的三角形（换而言之，**城市组成了关于 T 国的一个三角剖分**）。**两人的旅游路线可以看做是连接 $n$ 个顶点中不相邻两点的线段**。

![](https://cdn.luogu.com.cn/upload/pic/1409.png) 

为了能够买到最好的纪念品，小白希望旅游路线上经过的城市尽量多。作为小蓝的好友，你能帮帮小蓝吗？
## 输入格式

每个输入文件中仅包含一个测试数据。

第一行包含一个正整数 $n$，$n$ 的含义如题目所述。

接下来有 $n-2$ 行，每行包含三个整数 $p,q,r$，表示该城市三角形的三个顶点的编号（T 国的 $n$ 个顶点按顺时间方向从 $1$ 至 $n$ 编号）。
## 输出格式

输出文件共包含一行，表示最多经过的城市数目。（**一个城市被当做经过当且仅当其与线路有至少两个公共点**）
## 样例

### 样例输入 #1
```
6

1 2 4

2 3 4

1 4 5

1 5 6
```
### 样例输出 #1
```
4
```
## 提示

对于 $20\%$ 的数据，$n\le 2000$。

对于 $100\%$ 的数据，$4\le n \le 200000$。


---

---
title: "[CQOI2014] 数三角形"
layout: "post"
diff: 普及+/提高
pid: P3166
tag: ['数学', '2014', '重庆', '各省省选', '最大公约数 gcd', '排列组合']
---
# [CQOI2014] 数三角形
## 题目描述

给定一个 $N\times M$ 的网格，请计算三点都在格点上的三角形共有多少个。注意三角形的三点不能共线。
## 输入格式

输入一行，包含两个空格分隔的正整数 $M$ 和 $N$。
## 输出格式

输出一个正整数，为所求三角形数量。

## 样例

### 样例输入 #1
```
2 2
```
### 样例输出 #1
```
76
```
## 提示

#### 数据规模与约定

对于全部的测试点，保证 $1\le N,M\le1000$。


---

---
title: "[HNOI2012] 排队"
layout: "post"
diff: 普及+/提高
pid: P3223
tag: ['数学', '高精度', '2012', '各省省选', '湖南', '组合数学']
---
# [HNOI2012] 排队
## 题目描述

某中学有 $n$ 名男同学，$m$ 名女同学和两名老师要排队参加体检。他们排成一条直线，并且任意两名女同学不能相邻，两名老师也不能相邻，那么一共有多少种排法呢？（注意：任意两个人都是不同的）

## 输入格式

只有一行且为用空格隔开的两个非负整数 $n$ 和 $m$，其含义如上所述。 
## 输出格式

仅一个非负整数，表示不同的排法个数。注意答案可能很大。

## 样例

### 样例输入 #1
```
1  1
```
### 样例输出 #1
```
12
```
## 提示

对于 $30\%$ 的数据 $n\leq 100$，$m\leq 100$。

对于 $100\%$ 的数据 $n\leq 2000$，$m\leq 2000$。



---

---
title: "[HAOI2014] 贴海报"
layout: "post"
diff: 普及+/提高
pid: P3740
tag: ['2014', '河南', '线段树', '各省省选', '离散化', '枚举']
---
# [HAOI2014] 贴海报
## 题目描述

Bytetown 城市要进行市长竞选，所有的选民可以畅所欲言地对竞选市长的候选人发表言论。为了统一管理，城市委员会为选民准备了一个张贴海报的 electoral 墙。

张贴规则如下：

1. electoral 墙是一个长度为 $N$ 个单位的长方形，每个单位记为一个格子；

2. 所有张贴的海报的高度必须与 electoral 墙的高度一致的；

3. 每张海报以 `A B` 表示，即从第 $A$ 个格子到第 $B$ 个格子张贴海报；

4. 后贴的海报可以覆盖前面已贴的海报或部分海报。

现在请你判断，张贴完所有海报后，在 electoral 墙上还可以看见多少张海报。
## 输入格式

第一行，两个正整数 $N,M$，分别表示 electoral 墙的长度和海报个数。

接下来 $M$ 行，每行两个正整数 $A_i,B_i$，表示每张海报张贴的位置。

## 输出格式

输出贴完所有海报后，在 electoral 墙上还可以看见的海报数。
## 样例

### 样例输入 #1
```
100 5
1 4
2 6
8 10
3 4
7 10

```
### 样例输出 #1
```
4
```
## 提示

![](https://cdn.luogu.com.cn/upload/pic/5209.png) 

**约束条件**

$10\le N \le 10000000,1\le M\le 1000,1\le A_i \le B_i \le 10000000$

所有的数据都是正整数，数据之间有一个空格。


---

---
title: "[TJOI2017] 可乐"
layout: "post"
diff: 普及+/提高
pid: P3758
tag: ['2017', '倍增', '各省省选', '矩阵加速', '天津']
---
# [TJOI2017] 可乐
## 题目描述

加里敦星球的人们特别喜欢喝可乐。因而，他们的敌对星球研发出了一个可乐机器人，并且放在了加里敦星球的 $1$ 号城市上。这个可乐机器人有三种行为： 停在原地，去下一个相邻的城市，自爆。它每一秒都会随机触发一种行为。现在给加里敦星球城市图，在第 $0$ 秒时可乐机器人在 $1$ 号城市，问经过了 $t$ 秒，可乐机器人的行为方案数是多少？

## 输入格式

第一行输入两个正整数 $N$，$M$。$N$ 表示城市个数，$M$ 表示道路个数。

接下来 $M$ 行每行两个整数 $u$，$v$，表示 $u$，$v$ 之间有一条道路。保证两座城市之间只有一条路相连，且没有任何一条道路连接两个相同的城市。

最后一行是一个整数 $t$，表示经过的时间。
## 输出格式

输出可乐机器人的行为方案数，答案可能很大，请输出对 $2017$ 取模后的结果。
## 样例

### 样例输入 #1
```
3 2
1 2
2 3
2
```
### 样例输出 #1
```
8
```
## 提示

#### 样例输入输出 1 解释


- $1$ ->爆炸。
- $1$ -> $1$ ->爆炸。
- $1$ -> $2$ ->爆炸。
- $1$ -> $1$ -> $1$。
- $1$ -> $1$ -> $2$。
- $1$ -> $2$ -> $1$。
- $1$ -> $2$ -> $2$。
- $1$ -> $2$ -> $3$。

---

#### 数据范围与约定

- 对于 $20\%$ 的数据，保证 $t \leq 1000$。
- 对于$100\%$的数据，保证 $1 < t \leq 10^6$，$1 \leq N \leq30$，$0 < M < 100$，$1 \leq u, v \leq N$。


---

---
title: "[TJOI2007] 圆"
layout: "post"
diff: 普及+/提高
pid: P3844
tag: ['2007', '各省省选', '天津']
---
# [TJOI2007] 圆
## 题目描述

平面上有 n 个圆，任意两个不同的圆之间只有相离（可以外切）和包含（可以内切）两

种关系。初始时整个平面是黑色的，我们按照输入给定的顺序在平面上画出这些圆，我们画

一个圆的时候，把这个圆覆盖的区域全部反色，即如果区域中的一个点原来是黑色，则将它

涂为白色；如果这个点原来是白色，则将它涂成黑色。

按照这个步骤把所有的圆都画出来后，请输出平面上的所有白色区域的面积之和。

## 输入格式

输入文件的第一行有一个整数 n，表示圆的个数。以下 n 行，每行用三个整数 x, y 和 r

描述一个圆，表示圆心(x, y)和半径 r。在平面上画圆的顺序和输入给定的顺序相同。

## 输出格式

你只需要向输出文件输入一个实数，精确到小数点后两位，表示平面上白色区域面积之

和。
## 样例

### 样例输入 #1
```
3
0 0 5
0 1 2
10 10 1
```
### 样例输出 #1
```
69.12
```
## 提示

100%的数据中，n ≤ 100，对于所有的圆，|x|, |y|, r ≤ 1 000。



---

---
title: "[TJOI2008] Binary Land"
layout: "post"
diff: 普及+/提高
pid: P3855
tag: ['动态规划 DP', '搜索', '2008', '各省省选', '广度优先搜索 BFS', '天津']
---
# [TJOI2008] Binary Land
## 题目背景

Binary Land是一款任天堂红白机上的经典游戏，讲述的是两只相爱的企鹅Gurin和Malon的故事。两只企鹅在一个封闭的迷宫中，你可以控制他们向上下左右四个方向移动。但是他们的移动有一个奇怪的规则，即如果你按“上”或“下”方向键，两只企鹅会同时向上移动或向下移动1格；如果你按“左”方向键，则Malon向左移动1格，同时Gurin向右移动1格；如果你按“右”方向键，则Malon向右移动1格，Gurin向左移动1格。当然，如果某只企鹅被障碍挡住，它就不会移动了。另外，在迷宫的某些格子处有蜘蛛网，如果任何一只企鹅进入这种格子，则游戏失败。两只企鹅不会相互阻挡，即在相向运动时他们可以“穿过”彼此，也可以同时处于同一格子里。迷宫的某个格子上有一颗红心，游戏的任务就是使两只企鹅同时到达这个格子。

![](https://cdn.luogu.com.cn/upload/pic/6099.png)

## 题目描述

请编写程序找出完成任务所需的最少的操作步数。如果无法完成目标，输出“no”。

## 输入格式

第一行包含两个整数R, C 表示迷宫的长和宽。

按下来有R行，每行包含C个字符，描述了一个迷宫。其中’#’表示企鹅不能通过的障碍物，’X’表示蜘蛛网，’.’表示空地，’G’表示Gurin的初始位置，’M’表示Malon的初始位置，’T’表示终点位置。

输入数据保证标有’G’,’M’,’T’的格子分别只有一个，保证企鹅不可能走到迷宫以外。

## 输出格式

输出只有一行，为最少的操作步数。如果不能完成任务，输出“no”。

## 样例

### 样例输入 #1
```
4 7
#######
#..T..#
#G##M##
#######

```
### 样例输出 #1
```
4
```
## 提示

满足要求的一个操作序列为：上－右－左－左

3 ≤ R, C ≤ 30



---

---
title: "[TJOI2009] 火星人的手机"
layout: "post"
diff: 普及+/提高
pid: P3860
tag: ['2009', '各省省选', '天津']
---
# [TJOI2009] 火星人的手机
## 题目背景

你应火星人之邀为他们设计一款新型的手机。我们知道在标准的地球人手机上，数字键共有 $10$ 个，$26$ 个字母 `a`…`z` 分别与某个数字键相关联，并且一个数字键上的若干字母必须是字母表中连续的一段。比如下图是地球手机的一个标准方案：

![](https://cdn.luogu.com.cn/upload/pic/6103.png)

## 题目描述

我们要输入一个字母，必须连续按它所在的数字键若干次，次数即为这个字母在这个键的第几个位置。例如在上图的方案中，若我们要输入 `C`，就需要按三次数字键 `2`；若要输入 `M`，需按一次数字键 `6`。

火星人手机的构造与地球人手机类似，上面有 $M$ 个火星数字键，你需要把火星文的 $N$ 个字母放置在这 $M$ 个键上。（同样要求一个数字键上必须是连续的若干个火星字母）现在给定一段火星文中各个字母的出现次数，你设计的手机必须使得输入这段文字所需的按键次数最少。

## 输入格式

输入文件的第一行包括两个数字 $N$ 和 $M$，分别表示火星文字母数和火星手机的按键数。接下来有 $N$ 行，每行包含一个数字，依次表示每个字母在文章中的出现次数。这个次数不超过 $1000$。

## 输出格式

输出文件的第一行包括一个数字，表示最少的按键次数。

接下来的 $M$ 行表示一种设计方案：每行包含一个数，依次表示每个数字键上有几个火星字母。（这些数字可以为 $0$）

如果有多种方案可以得到最少的按键次数，你需要输出第一个数字键上包含字母最少的方案；如果仍有多种方案，你需要在其中选择第二个数字键上字母最少的方案；依此类推。

## 样例

### 样例输入 #1
```
3 2
100
200
300

```
### 样例输出 #1
```
800
2
1

```
## 提示

### 数据范围及约定

对于 $100\%$ 的数据，$1\le N \le 500$，$1 \le M \le 100$。



---

---
title: "[TJOI2009] 宝藏"
layout: "post"
diff: 普及+/提高
pid: P3869
tag: ['搜索', '2009', '各省省选', 'O2优化', '天津', '状压 DP']
---
# [TJOI2009] 宝藏
## 题目描述

为了寻找传说中的宝藏，小明走进了一个迷宫，我们用一个 $r$ 行 $c$ 列的矩阵来描述这个迷宫，矩阵的每个位置表示一个方块区域：

- 字符 `.` 表示可以通过的方格。
- 字符 `#` 表示不能通过的方格。
- 在迷宫中有 $k$ 个机关，第 $i$ 个机关工作方式为：  
  - 每当小明走上第 $r_i$ 行，$c_i$ 列的格子时，位于第 $R_i$ 行，$C_i$ 列的格子改变状态（如果这个格子此时可以通过，此后就变为不能通过；如果此时不能通过，此后可以通过。最左上角的格子是第 $1$ 行第 $1$ 列）。

现给出当前小明的位置，宝藏的位置，迷宫中每个格子的状态，以及所有机关的描述，问小明至少还要走多少步才能拿到宝藏（不能走出迷宫的边界，在开始时刻，小明和宝藏所在的位置都是可以通过的，机关不会出现在起点和终点，也不会影响这两个格子）。

## 输入格式

输入数据的第 $1$ 行是两个整数：$r$ 和 $c$。

输入数据的第 $2$ 行到第 $r+1$ 行，每行是一个长度为 $c$ 的字符串，描述迷宫的当前状态：`.` 表示此时可以通过的格子，`#` 表示此时不能通过的格子，`S` 表示起点，`T` 表示宝藏的位置。

输入数据的第 $r+2$ 行是一个整数 $k$，表示机关的数目。接下来有 $k$ 行，每一行包含 $4$ 个整数 $r_i,c_i,R_i,C_i$，用来描述一个机关。

## 输出格式

输出一个整数：小明最少需要走多少步才能拿到宝藏。测试数据保证可以找到宝藏。

## 样例

### 样例输入 #1
```
5 5
S.#..
#####
..#..
##.#.
...#T
6
1 5 4 2
1 4 3 3
5 1 3 3
1 4 4 5
1 2 1 3
1 5 2 1

```
### 样例输出 #1
```
22
```
## 提示

### 数据范围及约定

对于全部数据，$5 \le r, c \le 30$，$0 \le k \le 10$，$1 \le r_i,R_i\le r$，$1 \le c_i,C_i \le c$。



---

---
title: "[TJOI2009] 开关"
layout: "post"
diff: 普及+/提高
pid: P3870
tag: ['2009', '线段树', '各省省选', '分块', '天津']
---
# [TJOI2009] 开关
## 题目描述

现有 $n$ 盏灯排成一排，从左到右依次编号为：$1$，$2$，……，$n$。然后依次执行 $m$ 项操作。

操作分为两种：

1. 指定一个区间 $[a,b]$，然后改变编号在这个区间内的灯的状态（把开着的灯关上，关着的灯打开）；
2. 指定一个区间 $[a,b]$，要求你输出这个区间内有多少盏灯是打开的。

**灯在初始时都是关着的。**
## 输入格式

第一行有两个整数 $n$ 和 $m$，分别表示灯的数目和操作的数目。

接下来有 $m$ 行，每行有三个整数，依次为：$c$、$a$、$b$。其中 $c$ 表示操作的种类。

- 当 $c$ 的值为 $0$ 时，表示是第一种操作。
- 当 $c$ 的值为 $1$ 时，表示是第二种操作。

$a$ 和 $b$ 则分别表示了操作区间的左右边界。
## 输出格式

每当遇到第二种操作时，输出一行，包含一个整数，表示此时在查询的区间中打开的灯的数目。
## 样例

### 样例输入 #1
```
4 5
0 1 2
0 2 4
1 2 3
0 2 4
1 1 4

```
### 样例输出 #1
```
1
2
```
## 提示

#### 数据规模与约定

对于全部的测试点，保证 $2\le n\le 10^5$，$1\le m\le 10^5$，$1\le a,b\le n$，$c\in\{0,1\}$。


---

---
title: "[TJOI2010] 中位数"
layout: "post"
diff: 普及+/提高
pid: P3871
tag: ['2010', '各省省选', '平衡树', 'O2优化', '排序', '天津']
---
# [TJOI2010] 中位数
## 题目描述

给定一个由 $N$ 个元素组成的整数序列，现在有两种操作：

- $\texttt{1 add }\textit{a}$：在该序列的最后添加一个整数 $a$，组成长度为 $N + 1$ 的整数序列。
- $\texttt{2 mid}$：输出当前序列的中位数。

中位数是指将一个序列按照从小到大排序后处在中间位置的数。（若序列长度为偶数，则指处在中间位置的两个数中较小的那个）

例 $1$：$[1, 2, 13, 14, 15, 16]$ 中位数为 $13$。  
例 $2$：$[1, 3, 5, 7, 10, 11, 17]$ 中位数为 $7$。  
例 $3$：$[1, 1, 1, 2, 3]$ 中位数为 $1$。

## 输入格式

第一行为初始序列长度 $N$。第二行为 $N$ 个整数，表示整数序列，数字之间用空格分隔。第三行为操作数 $M$，即要进行 $M$ 次操作。下面为 $M$ 行，每行输入格式如题意所述。

## 输出格式

对于每个 $\verb!mid!$ 操作输出中位数的值。
## 样例

### 样例输入 #1
```
6
1 2 13 14 15 16
5
add 5
add 3
mid
add 20
mid

```
### 样例输出 #1
```
5
13

```
## 提示

### 数据范围及约定

- 对于 $30\%$ 的数据，$1 ≤ N ≤ 10,000$，$0 ≤ M ≤ 1,000$。
- 对于 $100\%$ 的数据，$1 ≤ N ≤ 100,000$，$0 ≤ M ≤ 10,000$。

序列中整数的绝对值不超过 $10^9$，序列中的数可能有重复。


---

---
title: "[GDOI2014] OJ"
layout: "post"
diff: 普及+/提高
pid: P3892
tag: ['2014', '各省省选', '广东', '邻接表']
---
# [GDOI2014] OJ
## 题目描述

小 M 是一个勤奋的 ACMer，他利用课余时间刷了很多题目。但他是个很健忘的孩子，经常会忘记自己刷过一些什么题目，所以他想写一个 OJ 来管理自己做过的题目。

经过一个星期的努力，小 M 的 OJ 基本成型，只是还差一个 Contest 的模块没有实现。小 M 觉得这个模块很难实现，所以他希望找你来帮忙。

小 M 告诉你，一个 OJ 的基础元素包括：

1. 题目，可以用 pid 唯一标识，pid 为正整数；
2. 比赛，可以用 cid 唯一标识，cid 为正整数；
3. 用户，可以用 uid 唯一标识，uid 为正整数；
4. 提交状态，可以由 sid 唯一标识，sid 为正整数。

一个提交状态是由 sid、cid、pid、uid 和 result 组成的，分别表示本条状态的提交 ID，所属比赛 ID，题目 ID，用户 ID 以及评测结果。

简单起见，这里的 result 只有 AC、UNAC 和 WAIT 三种状态，分别表示通过、不通过和等待评测。

同时小 M 提出一个比赛模块需要实现以下请求：

1. `createContest cid t pid_1 pid_2 … pid_t`

表示要创建一个比赛，cid 是一个正整数，是这场比赛的唯一标识。

$t$ 表示这场比赛有 $t$（($1\le t\le1000$)）道题目，接下来 $t$ 个不同的整数，表示这场比赛的题目编号。

2. `submission sid cid pid uid result`

该条状态的 sid 要么之前没出现过，要么以前出现过，但是被 rejudge 了。

result 为 AC 或者 UNAC。

3. `getRank cid uid`

在一场比赛中，所有有提交的用户都应该算在排名内（包括被 rejudge 的提交），用户的排名按照通过的题目数从大到小排序，如果题目数相同，则按随机顺序排序。

该指令需要统计用户 uid 在 cid 这场比赛中的通过目数，最高排名以及最低排名。

值得注意的是，用户 uid 在 cid 这场比赛中同一道题目的多个通过记录只算一次。

输出格式为：`uid solved highest lowest`。

分别代表用户 ID，通过题目数量，最高排名以及最低排名，其中 $\mathit{highest}\le\mathit{lowest}$。

4. `rejudge sid`

重测以 sid 标识的提交记录，即将该记录的 result 改成 WAIT。

## 输入格式

第一行三个整数 $\mathit{pcnt}$、$\mathit{ucnt}$、$m$（$1\le\mathit{pcnt}\le5000,1\le\mathit{ucnt}\le5000,1\le m\le3\times10^5$），分别表示 OJ 有 pcnt 道题目，ucnt 个用户以及 m 条请求。

pid 的范围是 $1000\sim1000+\mathit{pcnt}-1$，uid 的范围是 $1\sim\mathit{ucnt}$，cid 的范围为 $1\sim50$，$1\le\mathit{sid}\le m$。

接下来有 $m$ 行，每行一个请求，请求为题述四种请求之一，请求需要按输入顺序执行。

你需要注意以下几点：

1. 对于 `createContest` 请求，保证 cid 不会与之前的 createContest 的 cid 重复。
2. 对于 `submission` 请求，在此请求前，保证比赛 cid 已经创建，题目 pid 是该场比赛的题目之一。
3. 对于 `getRank` 指令，在此请求前，保证比赛 cid 已经创建，用户 uid 至少在该比赛中有一个提交记录。
4. 对于 `rejudge` 指令，在此请求前，保证存在以 sid 标识的提交。

## 输出格式

对于每一个 `getRank` 请求，根据要求输出用户 ID，通过题目数量，最高排名以及最低排名，整数之间用一个空格隔开。

## 样例

### 样例输入 #1
```
7 5 17
createContest 1 5 1001 1004 1002 1005 1006
submission 1 1 1001 1 AC
submission 2 1 1001 1 AC
submission 3 1 1001 2 UNAC
submission 4 1 1003 3 UNAC
getRank 1 1
getRank 1 2
getRank 1 3
rejudge 3
submission 3 1 1001 2 AC
getRank 1 2
submission 5 1 1006 2 AC
getRank 1 1
submission 6 1 1006 2 UNAC
getRank 1 2
rejudge 5
getRank 1 2

```
### 样例输出 #1
```
1 1 1 1
2 0 2 3
3 0 2 3
2 1 1 2
1 1 2 2
2 2 1 1
2 1 1 2

```
## 提示

对于 $20\%$ 的数据，$1\le\mathit{pcnt},\mathit{ucnt},m\le100$；

对于 $50\%$ 的数据，$1\le\mathit{pcnt},\mathit{ucnt}\le2000,1\le m\le50000$；

对于 $100\%$ 的数据，$1\le\mathit{pcnt},\mathit{ucnt}\le5000,1\le m\le3\times10^5,1\le\mathit{cid}\le50$。



---

---
title: "[JSOI2010] 快递服务"
layout: "post"
diff: 普及+/提高
pid: P4046
tag: ['动态规划 DP', '2010', '各省省选', '江苏', '枚举']
---
# [JSOI2010] 快递服务
## 题目描述

「飞奔」快递公司成立之后，已经分别与市内许多中小企业公司签订邮件收送服务契约。由于有些公司是在同一栋大楼内，所以「飞奔」公司收件的地点（收件点）最多只有 $m$ 点（$1,2,\dots,m$），因此「飞奔」仅先行采购了三辆货车并聘用了三名司机，每天早上分别从收件地点 $1,2,3$ 出发。而在与客户的服务契约中有明确订约：「飞奔」必须在客户提出邮件寄送要求的隔天派人至该公司（地点）收件。

为了能更有效率的服务客户并节省收件时间，该公司设立了收件服务登记网站，客户如有邮件需要寄送，必须在需要收件的前一天就先上网登记。为了节省油量，「飞奔」就利用晚上先行安排三位司机隔天的收件路线。每位司机至各地点收件的顺序应与各公司上网登记的顺序相符且必须能在最省油的情况下完成当天所有的收件服务。因此每位司机有可能需要在不同时间重复到同一地点收件，或不同的司机有可能需在不同的时间点前往同一地点收件。

如下面范例二（收件公司地点依序为：`4 2 4 1 5 4 3 2 1`）所示，虽然司机 $1$ 一开始就已经在收件地点 $1$ 了，但是他却不能先把后面第四个登记的公司（地点 $1$）邮件先收了再前往第一、第二、或第三个登记收件地点（地点 $4,2,4$）收件。但是如果前三个登记收件的服务是由司机 $2$ 或 $3$ 来负责，则司机 $1$ 就可以在地点 $1$ 收了第四个登记的邮件后再前往后面所登记的地点收件。此外，在某些情况下，不一定每辆车都要收到货，也就是说，最佳收件方式也有可能是只需出动一或两辆车去收货。请写一个程序来帮「飞奔」公司计算每天依预约顺序至各收件地点收件的最少总耗油量。

### 简要题意

给定一个 $m \times m$ 的矩阵 $D$。我们规定一个序列 $a(a_0,a_1,a_2,\dots,a_n)$ 的花费为 $\sum\limits_{i=1}^{n}D_{a_{i-1},a_i}$。

现在给定你一个长度 $\leq 1000$ 的序列 $s$，请你把它分成三个子序列 $a,b,c$，并且规定 $a_0=1,b_0=2,c_0=3$，求出所有划分方案中它们的最小化费和。

特殊地，矩阵 $D$ 满足三角不等式，具体见输入格式中的详细解释。

（By El_destructor）
## 输入格式

输入文件第一行有一个整数 $m$，代表「飞奔」公司收件的地点数，以 $1$ 至 $m$ 之间的整数代号来表示每个地点。

接下来的 $m$ 行（第 $2$ 到第 $m+1$ 行），每行有 $m$ 个整数，代表一个矩阵 $D$。第 $i$ 行的第 $j$ 个整数 $D(i,j)$ 表示司机开车从收件点 $i$ 到收件点 $j$ 所需耗油量。最后一行是一个序列，按照顺序为前一天上网登记要求收件的公司地点代号，最多会有 $1000$ 个收件请求。

输入文件中任两个相邻的整数都以一个空格隔开。

注意：油量矩阵 $D$ 满足三角不等式，也就是说 $\forall 1 \leq i,j,k \leq m,D(i,j) \leq D(i,k)+D(k,j)$。因此，每辆车前往下一个收件地点时一定是直接前往，不必先绕道至其它地点再抵达下个收件地点。
## 输出格式

输出一个整数，代表收件所需最少总耗油量。

## 样例

### 样例输入 #1
```
4 
0 5 0 6 
6 0 5 6 
1 6 0 6 
1 1 1 0 
1 1 1 1 4 4 2 2 2 3 
```
### 样例输出 #1
```
6
```
## 提示

#### 样例解释

到每个请求收件地点的司机分别为 `1 1 1 1 3 3 2 2 2 1`，因此司机 $1$ 只需从起使点 $1$ 移动到地点 $3$，司机 $2$ 只需停留在地点 $2$，司机 $3$ 从起始点 $3$ 移动到地点 $4$。

#### 数据范围

$3 \leq m \leq 200,1 \leq s_i \leq m$。


---

---
title: "[JSOI2010] 部落划分"
layout: "post"
diff: 普及+/提高
pid: P4047
tag: ['2010', '二分', '并查集', '各省省选', '江苏', '生成树']
---
# [JSOI2010] 部落划分
## 题目描述

聪聪研究发现，荒岛野人总是过着群居的生活，但是，并不是整个荒岛上的所有野人都属于同一个部落，野人们总是拉帮结派形成属于自己的部落，不同的部落之间则经常发生争斗。只是，这一切都成为谜团了——聪聪根本就不知道部落究竟是如何分布的。

不过好消息是，聪聪得到了一份荒岛的地图。地图上标注了 $n$ 个野人居住的地点（可以看作是平面上的坐标）。我们知道，同一个部落的野人总是生活在附近。我们把两个部落的距离，定义为部落中距离最近的那两个居住点的距离。聪聪还获得了一个有意义的信息——这些野人总共被分为了 $k$ 个部落！这真是个好消息。聪聪希望从这些信息里挖掘出所有部落的详细信息。他正在尝试这样一种算法：

对于任意一种部落划分的方法，都能够求出两个部落之间的距离，聪聪希望求出一种部落划分的方法，使靠得最近的两个部落尽可能远离。

例如，下面的左图表示了一个好的划分，而右图则不是。请你编程帮助聪聪解决这个难题。


![](https://cdn.luogu.com.cn/upload/pic/30573.png)
## 输入格式

输入文件第一行包含两个整数 $n$ 和 $k$，分别代表了野人居住点的数量和部落的数量。

接下来 $n$ 行，每行包含两个整数 $x$，$y$，描述了一个居住点的坐标。
## 输出格式

输出一行一个实数，为最优划分时，最近的两个部落的距离，精确到小数点后两位。
## 样例

### 样例输入 #1
```
4 2
0 0
0 1
1 1
1 0

```
### 样例输出 #1
```
1.00

```
### 样例输入 #2
```
9 3
2 2
2 3
3 2
3 3
3 5
3 6
4 6
6 2
6 3
```
### 样例输出 #2
```
2.00
```
## 提示

#### 数据规模与约定

对于 $100\%$ 的数据，保证 $2 \leq k \leq n \leq 10^3$，$0 \leq  x, y \leq 10^4$。


---

---
title: "[JSOI2007] 建筑抢修"
layout: "post"
diff: 普及+/提高
pid: P4053
tag: ['贪心', '2007', '各省省选', '江苏', '优先队列']
---
# [JSOI2007] 建筑抢修
## 题目描述

小刚在玩 JSOI 提供的一个称之为“建筑抢修”的电脑游戏：经过了一场激烈的战斗，T 部落消灭了所有 Z 部落的入侵者。但是 T 部落的基地里已经有 $N$ 个建筑设施受到了严重的损伤，如果不尽快修复的话，这些建筑设施将会完全毁坏。现在的情况是：T 部落基地里只有一个修理工人，虽然他能瞬间到达任何一个建筑，但是修复每个建筑都需要一定的时间。同时，修理工人修理完一个建筑才能修理下一个建筑，不能同时修理多个建筑。如果某个建筑在一段时间之内没有完全修理完毕，这个建筑就报废了。你的任务是帮小刚合理的制订一个修理顺序，以抢修尽可能多的建筑。

## 输入格式

第一行，一个整数 $N$。

接下来 $N$ 行，每行两个整数 $T_1,T_2$ 描述一个建筑：修理这个建筑需要 $T_1$ 秒，如果在 $T_2$ 秒之内还没有修理完成，这个建筑就报废了。

## 输出格式

输出一个整数 $S$，表示最多可以抢修 $S$ 个建筑。

## 样例

### 样例输入 #1
```
4
100 200
200 1300
1000 1250
2000 3200
```
### 样例输出 #1
```
3
```
## 提示

对于 $100 \%$ 的数据，$1 \le N < 150000$，$1 \le T_1 < T_2 < 2^{31}$。


---

---
title: "[AHOI2008] 紧急集合 / 聚会"
layout: "post"
diff: 普及+/提高
pid: P4281
tag: ['2008', '倍增', '各省省选', '安徽', '最近公共祖先 LCA', '树链剖分']
---
# [AHOI2008] 紧急集合 / 聚会
## 题目描述

欢乐岛上有个非常好玩的游戏，叫做“紧急集合”。在岛上分散有 $n$ 个等待点，有 $n-1$ 条道路连接着它们，每一条道路都连接某两个等待点，且通过这些道路可以走遍所有的等待点，通过道路从一个点到另一个点要花费一个游戏币。

参加游戏的人三人一组，开始的时候，所有人员均任意分散在各个等待点上（每个点同时允许多个人等待），每个人均带有足够多的游戏币（用于支付使用道路的花费）、地图（标明等待点之间道路连接的情况）以及对话机（用于和同组的成员联系）。当集合号吹响后，每组成员之间迅速联系，了解到自己组所有成员所在的等待点后，迅速在 $n$ 个等待点中确定一个集结点，组内所有成员将在该集合点集合，集合所用花费最少的组将是游戏的赢家。

小可可和他的朋友邀请你一起参加这个游戏，由你来选择集合点，聪明的你能够完成这个任务，帮助小可可赢得游戏吗？

## 输入格式

第一行两个正整数 $n$ 和 $m$，分别表示等待点的个数（等待点也从 $1$ 到 $n$ 进行编号）和获奖所需要完成集合的次数。

随后 $n-1$ 行，每行两个正整数 $a,b$，表示编号为 $a$ 和编号为 $b$ 的等待点之间有一条路。

随后 $m$ 行，每行用三个正整数 $x,y,z$，表示某次集合前小可可、小可可的朋友以及你所在等待点的编号。
## 输出格式

输出共 $m$ 行，每行两个用空格隔开的整数 $p,c$。其中第 $i$ 行表示第 $i$ 次集合点选择在编号为 $p$ 的等待点，集合总共的花费是 $c$ 个游戏币。
## 样例

### 样例输入 #1
```
6 4  
1 2  
2 3  
2 4 
4 5
5 6
4 5 6
6 3 1
2 4 4 
6 6 6
```
### 样例输出 #1
```
5 2
2 5
4 1
6 0



```
## 提示

对于 $40\%$ 的数据，$n\leq2\times10^3$，$m\leq2\times 10^3$。

对于 $100\%$ 的数据，$1\leq x,y,z\leq n\leq 5\times10^5$，$1\leq m\leq 5\times 10^5$。


---

---
title: "[HAOI2008] 玩具取名"
layout: "post"
diff: 普及+/提高
pid: P4290
tag: ['动态规划 DP', '2008', '河南', '各省省选', '枚举', '区间 DP']
---
# [HAOI2008] 玩具取名
## 题目描述

某人有一套玩具，并想法给玩具命名。首先他选择 `W, I, N, G` 四个字母中的任意一个字母作为玩具的基本名字。然后他会根据自己的喜好，将名字中任意一个字母用 `W, I, N, G` 中任意两个字母代替，使得自己的名字能够扩充得很长。

现在，他想请你猜猜某一个很长的名字，最初可能是由哪几个字母变形过来的。
## 输入格式

第一行四个整数 $W, I, N, G$。表示每一个字母能由几种两个字母所替代。

接下来 $W$ 行，每行两个字母,表示 `W` 可以用这两个字母替代。

接下来 $I$ 行，每行两个字母，表示 `I` 可以用这两个字母替代。

接下来 $N$ 行，每行两个字母，表示 `N` 可以用这两个字母替代。

接下来 $G$ 行，每行两个字母，表示 `G` 可以用这两个字母替代。

最后一行一个长度不超过 $L$ 的字符串。表示这个玩具的名字。
## 输出格式

一行字符串，该名字可能由哪些字母变形而得到。（按照 `W, I, N, G` 的顺序输出）

如果给的名字不能由任何一个字母变形而得到则输出 `The name is wrong!`。
## 样例

### 样例输入 #1
```
1 1 1 1
II
WW
WW
IG
IIII

```
### 样例输出 #1
```
IN

```
## 提示

### 数据规模与约定

- $30\%$ 数据满足 $L \leq 20$，$W, I, N, G \leq 6$；
- $100\%$ 数据满足 $L \leq 200$，$W, I, N, G \leq 16$。


---

---
title: "[SHOI2015] 自动刷题机"
layout: "post"
diff: 普及+/提高
pid: P4343
tag: ['2015', '二分', '各省省选', '上海']
---
# [SHOI2015] 自动刷题机
## 题目背景

曾经发明了信号增幅仪的发明家 SHTSC 又公开了他的新发明：自动刷题机——一种可以自动 AC 题目的神秘装置。
## 题目描述

自动刷题机刷题的方式非常简单：首先会瞬间得出题目的正确做法，然后开始写程序。每秒，自动刷题机的代码生成模块会有两种可能的结果：

1.写了 $x$ 行代码  
2.心情不好，删掉了之前写的 $y$ 行代码。（如果 $y$ 大于当前代码长度则相当于全部删除。）

对于一个 OJ，存在某个固定的正整数长度 $n$，一旦自动刷题机在某秒结束时积累了大于等于 $n$ 行的代码，它就会自动提交并 AC 此题，然后新建一个文件（即弃置之前的所有代码）并开始写下一题。SHTSC 在某个 OJ 上跑了一天的自动刷题机，得到了很多条关于写代码的日志信息。他突然发现自己没有记录这个 OJ 的 $n$ 究竟是多少。所幸他通过自己在 OJ 上的 Rank 知道了自动刷题机一共切了 $k$ 道题，希望你计算 $n$ 可能的最小值和最大值。
## 输入格式

第一行两个整数 $l , k$，表示刷题机的日志一共有 $l$ 行，一共了切了 $k$ 题。

接下来 $l$ 行，每行一个整数 $x_i$，依次表示每条日志。若 $x_i \geq 0$，则表示写了 $x_i$ 行代码，若 $x_i \lt 0$，则表示删除了 $-x_i$ 行代码。
## 输出格式

输出一行两个整数，分别表示 $n$ 可能的最小值和最大值。  
如果这样的 $n$ 不存在，请输出一行一个整数 $-1$。
## 样例

### 样例输入 #1
```
4 2
2
5
-3
9
```
### 样例输出 #1
```
3 7
```
## 提示

#### 数据规模与约定

- 对于 $20\%$ 的数据，保证 $l \le 10$；
- 对于 $40\%$ 的数据，保证 $l \le 100$ ；
- 对于 $60\%$ 的数据，保证$l \le 2 \times 10^3$；
- 对于 $100\%$ 的数据，保证 $1 \leq l \le 10^5$，$-10^9 \le x_i \le 10^9$。


---

---
title: "[JSOI2009] 电子字典"
layout: "post"
diff: 普及+/提高
pid: P4407
tag: ['字符串', '2009', '各省省选', '江苏', '枚举', '深度优先搜索 DFS', '字典树 Trie']
---
# [JSOI2009] 电子字典
## 题目描述


人们在英文字典中查找某个单词的时候可能不知道该单词的完整拼法，而只知道该单词的一个错误的近似拼法，这时人们可能陷入困境，为了查找一个单词而浪费大量的时间。带有模糊查询功能的电子字典能够从一定程度上解决这一问题：用户只要输入一个字符串，电子字典就返回与该单词编辑距离最小的几个单词供用户选择。

字符串 $a$ 与字符串 $b$ 的编辑距离是指：允许对 $a$ 或 $b$ 串进行下列“编辑”操作，将 $a$ 变为 $b$ 或 $b$ 变为 $a$，最少“编辑”次数即为距离。

1. 删除串中某个位置的字母；
2. 添加一个字母到串中某个位置；
3. 替换串中某一位置的一个字母为另一个字母。

JSOI 团队正在开发一款电子字典，你需要帮助团队实现一个用于模糊查询功能的计数部件：对于一个待查询字符串，如果它是单词，则返回 $-1$；如果它不是单词，则返回字典中有多少个单词与它的编辑距离为 $1$。
## 输入格式

第一行包含两个正整数 $N$ 和 $M$。

接下来的 $N$ 行，每行一个字符串，第 $i+1$ 行为单词 $W_i$，单词长度在 $1$ 至 $20$ 之间。

再接下来 $M$ 行，每行一个字符串，第 $i+N+1$ 表示一个待查字符串 $Q_i$。待查字符串长度在 $1$ 至 $20$ 之间。$W_i$ 和 $Q_i$ 均由小写字母构成，文件中不包含多余空格。
## 输出格式

输出应包括 $M$ 行，第 $i$ 行为一个整数 $X_i$：

- $X_i = -1$ 表示 $Q_i$ 为字典中的单词；

- 否则 $X_i$ 表示与 $Q_i$ 编辑距离为 $1$ 的单词的个数。
## 样例

### 样例输入 #1
```
4 3
abcd
abcde
aabc
abced
abcd
abc
abcdd
```
### 样例输出 #1
```
-1
2
3
```
## 提示

### 样例解释

- `abcd` 在单词表中出现过；
- `abc` 与单词 `abcd`、`aabc` 的编辑距离都是 $1$；
- `abcdd` 与单词 `abcd`、`abcde`、`abced` 的编辑距离都是 $1$。

### 数据范围与约定

- 所有单词互不相同，但是查询字符串可能有重复；
- 对 $50\%$ 的数据范围，$N,M\le 10^3$；
- 对 $100\%$ 的数据范围，$N,M\le 10^4$。


---

---
title: "[BJOI2018] 求和"
layout: "post"
diff: 普及+/提高
pid: P4427
tag: ['2018', '倍增', '各省省选', '北京', 'O2优化', '深度优先搜索 DFS', '最近公共祖先 LCA', '树链剖分', '前缀和']
---
# [BJOI2018] 求和
## 题目描述

master 对树上的求和非常感兴趣。他生成了一棵有根树，并且希望多次询问这棵树上一段路径上所有节点深度的 $k$ 次方和，而且每次的 $k$ 可能是不同的。此处节点深度的定义是这个节点到根的路径上的边数。他把这个问题交给了 pupil，但 pupil 并不会这么复杂的操作，你能帮他解决吗？
## 输入格式

第一行包含一个正整数 $n$，表示树的节点数。

之后 $n-1$ 行每行两个空格隔开的正整数 $i, j$，表示树上的一条连接点 $i$ 和点 $j$ 的边。

之后一行一个正整数 $m$，表示询问的数量。

之后每行三个空格隔开的正整数 $i, j, k$，表示询问从点 $i$ 到点 $j$ 的路径上所有节点深度的 $k$ 次方和。由于这个结果可能非常大，输出其对 $998244353$ 取模的结果。

树的节点从 $1$ 开始标号，其中 $1$ 号节点为树的根。
## 输出格式

对于每组数据输出一行一个正整数表示取模后的结果。

## 样例

### 样例输入 #1
```
5
1 2
1 3
2 4
2 5
2
1 4 5
5 4 45
```
### 样例输出 #1
```
33
503245989
```
## 提示

### 样例解释

以下用 $d (i)$ 表示第 $i$ 个节点的深度。

对于样例中的树，有 $d (1) = 0, d (2) = 1, d (3) = 1, d (4) = 2, d (5) = 2$。

因此第一个询问答案为 $(2^5 + 1^5 + 0^5) \bmod 998244353 = 33$，第二个询问答案为$(2^{45} + 1^{45} + 2^{45}) \bmod 998244353 = 503245989$。

### 数据范围

对于 $30\%$ 的数据，$1 \leq n,m \leq 100$。

对于 $60\%$ 的数据，$1 \leq n,m \leq 1000$。

对于 $100\%$ 的数据，$1 \leq n,m \leq 300000$，$1 \leq k \leq 50$。

另外存在 5 个不计分的 hack 数据。

### 提示

数据规模较大，请注意使用较快速的输入输出方式。


---

---
title: "[HNOI/AHOI2018] 道路"
layout: "post"
diff: 普及+/提高
pid: P4438
tag: ['动态规划 DP', '2018', '各省省选', '安徽', '湖南', '深度优先搜索 DFS', '树形 DP']
---
# [HNOI/AHOI2018] 道路
## 题目描述

W 国的交通呈一棵树的形状。W 国一共有 $n-1$ 个城市和 $n$ 个乡村，其中城市从 $1$ 到 $n-1$ 编号，乡村从 $1$ 到 $n$ 编号，且 $1$ 号城市是首都。道路都是单向的，本题中我们只考虑从乡村通往首都的道路网络。

对于每一个城市，恰有一条公路和一条铁路通向这座城市。对于城市 $i$， 通向该城市的道路（公路或铁路）的起点，要么是一个乡村，要么是一个编号比 $i$ 大的城市。没有道路通向任何乡村。除了首都以外，从任何城市或乡村出发只有一条道路；首都没有往外的道路。从任何乡村出发，沿着唯一往外的道路走，总可以到达首都。

W 国的国王小 W 获得了一笔资金，他决定用这笔资金来改善交通。由于资金有限，小 W 只能翻修 $n-1$ 条道路。小 W 决定对每个城市翻修恰好一条通向它的道路，即从公路和铁路中选择一条并进行翻修。小 W 希望从乡村通向城市可以尽可能地便利，于是根据人口调查的数据，小 W 对每个乡村制定了三个参数，编号为 $i$ 的乡村的三个参数是 $a_i$，$b_i$ 和 $c_i$。假设从编号为 $i$ 的乡村走到首都一共需要经过 $x$ 条未翻修的公路与 $y$ 条未翻修的铁路，那么该乡村的不便利值为：

$$c_i \cdot (a_i + x) \cdot (b_i + y)$$

在给定的翻修方案下，每个乡村的不便利值相加的和为该翻修方案的不便利值。 翻修 $n-1$ 条道路有很多方案，其中不便利值最小的方案称为最优翻修方案，小 W 自然希望找到最优翻修方案，请你帮助他求出这个最优翻修方案的不便利值。
## 输入格式

第一行为正整数 $n$。 

接下来 $n - 1$ 行，每行描述一个城市。其中第 $i$ 行包含两个数 $s_i,t_i$。$s_i$ 表示通向第 $i$ 座城市的公路的起点，$t_i$ 表示通向第 $i$ 座城市的铁路的起点。如果$s_i>0$，那么存在一条从第 $s_i$ 座城市通往第$i$座城市的公路，否则存在一条从第 $-s_i$ 个乡村通往第 $i$ 座城市的公路；$t_i$ 类似地，如果 $t_i > 0$，那么存在一条从第 $t_i$ 座城市通往第 $i$ 座城市的铁路，否则存在一条从第 $-t_i$ 个乡村通往第 $i$ 座城市的铁路。 

接下来 $n$ 行，每行描述一个乡村。其中第 $i$ 行包含三个数 $a_i,b_i,c_i$，其意义如题面所示。 
## 输出格式

输出一行一个整数，表示最优翻修方案的不便利值。
## 样例

### 样例输入 #1
```
6 
2 3 
4 5 
-1 -2 
-3 -4 
-5 -6 
1 2 3 
1 3 2 
2 1 3 
2 3 1 
3 1 2 
3 2 1
```
### 样例输出 #1
```
54
```
### 样例输入 #2
```
9 
2 -2 
3 -3 
4 -4 
5 -5 
6 -6 
7 -7 
8 -8 
-1 -9 
1 60 1 
1 60 1 
1 60 1 
1 60 1 
1 60 1 
1 60 1 
1 60 1 
1 60 1 
1 60 1
```
### 样例输出 #2
```
548
```
### 样例输入 #3
```
12 
2 4 
5 3 
-7 10 
11 9 
-1 6 
8 7 
-6 -10 
-9 -4
-12 -5 
-2 -3 
-8 -11 
53 26 491 
24 58 190 
17 37 356 
15 51 997 
30 19 398 
3 45 27 
52 55 838 
16 18 931 
58 24 212 
43 25 198 
54 15 172 
34 5 524
```
### 样例输出 #3
```
5744902
 

```
## 提示

【样例解释 1】 

![](https://cdn.luogu.com.cn/upload/pic/17506.png)

如图所示，我们分别用蓝色、黄色节点表示城市、乡村；用绿色、红色箭头分别表示 公路、铁路；用加粗箭头表示翻修的道路。 

一种不便利值等于54的方法是：翻修通往城市2和城市5的铁路，以及通往其他城市的 公路。用→和⇒表示公路和铁路，用∗→和∗⇒表示翻修的公路和铁路，那么： 

编号为1的乡村到达首都的路线为：-1 ∗→ 3 ⇒ 1，经过0条未翻修公路和1条未翻修铁 路，代价为3 × (1 + 0) × (2 + 1) = 9；  
编号为2的乡村到达首都的路线为：-2 ⇒ 3 ⇒ 1，经过0条未翻修公路和2条未翻修铁 路，代价为2 × (1 + 0) × (3 + 2) = 10；  
编号为3的乡村到达首都的路线为：-3 ∗→ 4 → 2 ∗→ 1，经过1条未翻修公路和0条未 翻修铁路，代价为3 × (2 + 1) × (1 + 0) = 9；  
编号为4的乡村到达首都的路线为：-4 ⇒ 4 → 2 ∗→ 1，经过1条未翻修公路和1条未翻 修铁路，代价为1 × (2 + 1) × (3 + 1) = 12；  
编号为5的乡村到达首都的路线为：-5 → 5 ∗⇒ 2 ∗→ 1，经过1条未翻修公路和0条未 翻修铁路，代价为2 × (3 + 1) × (1 + 0) = 8；  
编号为6的乡村到达首都的路线为：-6 ∗⇒ 5 ∗⇒ 2 ∗→ 1，经过0条未翻修公路和0条未翻修铁路，代价为1 × (3 + 0) × (2 + 0) = 6；  

总的不便利值为9 + 10 + 9 + 12 + 8 + 6 = 54。可以证明这是本数据的最优解。 

【样例解释 2】 

在这个样例中，显然应该翻修所有公路。


【数据范围】 
一共20组数据，编号为1 ∼ 20。 
对于编号$\le 4$的数据，$n \le 20$；  
对于编号为5 ∼ 8的数据，$a_i,b_i,c_i \le 5$，$n \le 50$；  
对于编号为9 ∼ 12的数据，$n \le 2000$；  
对于所有的数据，$n \le 20000$，$1 \le a_i,b_i \le 60$，$1 \le c_i \le 10^9$，$s_i,t_i$是$[-n,-1] \cup (i,n - 1]$内的整数，任意乡村可以通过不超过40条道路到达首都。


---

---
title: "[CQOI2007] 三角形"
layout: "post"
diff: 普及+/提高
pid: P4536
tag: ['字符串', '2007', '重庆', '各省省选', '递归', '深度优先搜索 DFS']
---
# [CQOI2007] 三角形
## 题目描述

画一个等边三角形，把三边的中点连接起来，得到四个三角形，把它们称为 $T_1,T_2,T_3,T_4$，如图1。

把前三个三角形也这样划分，得到 $12$ 个更小的三角形，$T_{11},T_{12},T_{13},T_{14},T_{21},T_{22},T_{23},T_{24},T_{31},T_{32},T_{33},T_{34}$，如图2。

把编号以 $1,2,3$ 结尾的三角形又继续划分……最后得到的分形称为 Sierpinski 三角形。

![](https://cdn.luogu.com.cn/upload/pic/18501.png)

如果三角形 $B$ 不包含三角形 $A$，且 $A$ 的某一条完整的边是 $B$ 的某条边的一部分，则我们说 $A$ 靠在 $B$ 的边上。例如 $T_{12}$ 靠在 $T_{14}$ 和 $T_4$ 上，但不靠在 $T_{32}$ 上。

给出 Spierpinski 三角形中的一个三角形，找出它靠着的所有三角形。
## 输入格式

输入仅一行，即三角形的编号，以 `T` 开头，后面有 $n$ 个 $1$ 到 $4$ 的数字。仅最后一个数字可能为 $4$。
## 输出格式

输出每行一个三角形编号，按字典序从小到大排列。

## 样例

### 样例输入 #1
```
T312
```
### 样例输出 #1
```
T314
T34
T4
```
## 提示

对于 $100 \%$ 的数据，$1 \le n \le 50$。


---

---
title: "[CQOI2007] 矩形"
layout: "post"
diff: 普及+/提高
pid: P4537
tag: ['模拟', '搜索', '2007', '重庆', '各省省选']
---
# [CQOI2007] 矩形
## 题目描述

给一个a\*b矩形，由a\*b个单位正方形组成。你需要沿着网格线把它分成非空的两部分，每部分所有格子连通，且至少有一个格子在原矩形的边界上。“连通”是指任两个格子都可以通过水平或者竖直路径连在一起。 求方案总数。例如3*2的矩形有15种方案。

![](https://cdn.luogu.com.cn/upload/pic/18502.png)
## 输入格式

输入仅一行，为两个整数a，b。
1<=a<=6, 2<=b<=7
## 输出格式

输出仅一行，即方案总数。
## 样例

### 样例输入 #1
```
3 2
```
### 样例输出 #1
```
15
```


---

---
title: "[JLOI2011] 飞行路线"
layout: "post"
diff: 普及+/提高
pid: P4568
tag: ['2011', '各省省选', '吉林', '最短路']
---
# [JLOI2011] 飞行路线
## 题目描述

Alice 和 Bob 现在要乘飞机旅行，他们选择了一家相对便宜的航空公司。该航空公司一共在 $n$ 个城市设有业务，设这些城市分别标记为 $0$ 到 $n-1$，一共有 $m$ 种航线，每种航线连接两个城市，并且航线有一定的价格。

Alice 和 Bob 现在要从一个城市沿着航线到达另一个城市，途中可以进行转机。航空公司对他们这次旅行也推出优惠，他们可以免费在最多 $k$ 种航线上搭乘飞机。那么 Alice 和 Bob 这次出行最少花费多少？
## 输入格式

第一行三个整数 $n,m,k$，分别表示城市数，航线数和免费乘坐次数。

接下来一行两个整数 $s,t$，分别表示他们出行的起点城市编号和终点城市编号。

接下来 $m$ 行，每行三个整数 $a,b,c$，表示存在一种航线，能从城市 $a$ 到达城市 $b$，或从城市 $b$ 到达城市 $a$，价格为 $c$。
## 输出格式

输出一行一个整数，为最少花费。
## 样例

### 样例输入 #1
```
5 6 1
0 4
0 1 5
1 2 5
2 3 5
3 4 5
2 3 3
0 2 100
```
### 样例输出 #1
```
8
```
## 提示

#### 数据规模与约定

对于 $30\%$ 的数据，$2 \le n \le 50$，$1 \le m \le 300$，$k=0$。

对于 $50\%$ 的数据，$2 \le n \le 600$，$1 \le m \le 6\times10^3$，$0 \le k \le 1$。

对于 $100\%$ 的数据，$2 \le n \le 10^4$，$1 \le m \le 5\times 10^4$，$0 \le k \le 10$，$0\le s,t,a,b < n$，$a\ne b$，$0\le c\le 10^3$。

另外存在一组 hack 数据。


---

---
title: "[CQOI2013] 图的逆变换"
layout: "post"
diff: 普及+/提高
pid: P4575
tag: ['2013', '重庆', '各省省选']
---
# [CQOI2013] 图的逆变换
## 题目描述

给一个 $n$ 结点 $m$ 条边的有向图 $D$，可以这样构造图 $E$：给 $D$ 的每条边 $(u,v)$，在 $E$ 中建立一个点 $uv$，然后对于 $D$ 中的两条边 $(u,v)$ 和 $(v,w)$，在 $E$ 中从 $uv$ 向 $vw$ 连一条有向边。$E$ 中不含有其他点和边。

输入 $E$，你的任务是判断是否存在相应的 $D$。

注意，$D$ 可以有重边和自环。
## 输入格式

第一行包含测试数据个数 $T$（$T\leq 10$）。

对于每组数据：

第一行一个整数 $m$（$0\le m\le300$），表示 $D$ 的边数（即 $E$ 的点数）。

第二行一个整数 $k$，表示 $E$ 的边数。

以下 $k$ 行每行两个整数 $x, y$，表示 $E$ 中有一条有向边 $(x,y)$。$E$ 中的点编号为 $0\sim m-1$。
## 输出格式

对于每组数据输出一行。如果存在，输出 `Yes`，否则输出 `No`。
## 样例

### 样例输入 #1
```
4
2
1
0 1
5
0
4
3
0 1
2 1
2 3
3
9
0 1
0 2
1 2
1 0
2 0
2 1
0 0
1 1
2 2
```
### 样例输出 #1
```
Yes
Yes
No
Yes
```


---

---
title: "[CQOI2013] 棋盘游戏"
layout: "post"
diff: 普及+/提高
pid: P4576
tag: ['搜索', '博弈论', '2013', '重庆', '各省省选']
---
# [CQOI2013] 棋盘游戏
## 题目描述

一个n*n（n>=2）棋盘上有黑白棋子各一枚。游戏者A和B轮流移动棋子，A先走。

 * A的移动规则：只能移动白棋子。可以往上下左右四个方向之一移动一格。
 
 * B的移动规则：只能移动黑棋子。可以往上下左右四个方向之一移动一格或者两格。
 
和通常的“吃子”规则一样，当某游戏者把自己的棋子移动到对方棋子所在的格子时，他就赢了。

两个游戏者都很聪明，当可以获胜时会尽快获胜，只能输掉的时候会尽量拖延时间。你的任务是判断谁会赢，需要多少回合。


比如$n=2$，白棋子在$(1,1)$，黑棋子在$(2,2)$，那么虽然A有两种走法，第二个回合B总能取胜。
## 输入格式

仅一行，包含五个整数n, r1, c1, r2, c2，即棋盘大小和棋子位置。

白色棋子在$(r1,c1)$，黑色棋子在$(r2,c2)$ $(1<=r1,c1,r2,c2<=n)$。黑白棋子的位置保证不相同。
## 输出格式

仅一行，即游戏结果。

如果A获胜，输出WHITE x;

如果B获胜，输出BLACK x;

如果二者都没有必胜策略,输出DRAW.
## 样例

### 样例输入 #1
```
2 1 1 2 2
```
### 样例输出 #1
```
BLACK 2
```
## 提示

$n<=20$


---

---
title: "[TJOI2018] 数学计算"
layout: "post"
diff: 普及+/提高
pid: P4588
tag: ['2018', '线段树', '各省省选', '天津']
---
# [TJOI2018] 数学计算
## 题目描述

小豆现在有一个数 $x$，初始值为 $1$。小豆有 $Q$ 次操作，操作有两种类型：

`1 m`：将 $x$ 变为 $x \times m$，并输出 $x \bmod M$

`2 pos`：将 $x$ 变为 $x$ 除以第 $pos$ 次操作所乘的数（保证第 $pos$ 次操作一定为类型 1，对于每一个类型 1 的操作至多会被除一次），并输出 $x \bmod M$。
## 输入格式

一共有  $t$ 组输入。

对于每一组输入，第一行是两个数字 $Q,M$。

接下来 $Q$ 行，每一行为操作类型 $op$，操作编号或所乘的数字 $m$（保证所有的输入都是合法的）。
## 输出格式

对于每一个操作，输出一行，包含操作执行后的 $x \bmod M$ 的值。
## 样例

### 样例输入 #1
```
1
10 1000000000
1 2
2 1
1 2
1 10
2 3
2 4
1 6
1 7
1 12
2 7
```
### 样例输出 #1
```
2
1
2
20
10
1
6
42
504
84
```
## 提示

对于 $20\%$ 的数据，$1 \le Q \le 500$。

对于 $100\%$ 的数据，$1 \le Q \le 10^5$，$t \le 5, M \le 10^9$，$0 < m \leq 10^9$。


---

---
title: "[CQOI2006] 简单题"
layout: "post"
diff: 普及+/提高
pid: P5057
tag: ['2006', '重庆', '线段树', '各省省选', '树状数组']
---
# [CQOI2006] 简单题
## 题目描述

有一个 $n$ 个元素的数组，每个元素初始均为 $0$。有 $m$ 条指令，每条指令为两种操作中的一种：
1. 让其中一段连续序列数字反转；（即 $0$ 变 $1$，$1$ 变 $0$）
2. 询问某个元素的值。

例如当 $n=20$ 时，$10$ 条指令如下：

![](https://cdn.luogu.com.cn/upload/pic/44663.png)

## 输入格式

第一行包含两个整数 $n,m$，表示数组的长度和指令的条数。

接下来 $m$ 行，每行的第一个数 $t$ 表示操作的种类：

* 若 $t=1$，则接下来有两个数 $L,R$，表示反转区间 $[L,R]$ 的每个数；
* 若 $t=2$，则接下来只有一个数 $i$，表示询问的下标。
## 输出格式

每个操作 $2$ 输出一行（非 $0$ 即 $1$），表示每次操作 $2$ 的回答。
## 样例

### 样例输入 #1
```
20 10
1 1 10
2 6
2 12
1 5 12
2 6
2 15
1 6 16
1 11 17
2 12
2 6
```
### 样例输出 #1
```
1
0
0
0
1
1
```
## 提示

对于 $50\%$ 的数据，$1 \le n \le 10^3$，$1 \le m \le 10^4$；

对于 $100\%$ 的数据，$1 \le n \le 10^5$，$1 \le m \le 5 \times 10^5$，保证 $L \le R$。


---

---
title: "[BJOI2019] 排兵布阵"
layout: "post"
diff: 普及+/提高
pid: P5322
tag: ['动态规划 DP', '2019', '各省省选', '北京', 'O2优化', '背包 DP']
---
# [BJOI2019] 排兵布阵
## 题目描述

小 C 正在玩一款排兵布阵的游戏。在游戏中有 $n$ 座城堡，每局对战由两名玩家来争夺这些城堡。每名玩家有 $m$ 名士兵，可以向第 $i$ 座城堡派遣 $a_i$ 名士兵去争夺这个城堡，使得总士兵数不超过 $m$。   

如果一名玩家向第 $i$ 座城堡派遣的士兵数**严格**大于对手派遣士兵数的两倍，那么这名玩家就占领了这座城堡，获得 $i$ 分。  

现在小 C 即将和其他 $s$ 名玩家两两对战，这 $s$ 场对决的派遣士兵方案必须相同。小 C 通过某些途径得知了其他 $s$ 名玩家即将使用的策略，他想知道他应该使用什么策略来最大化自己的总分。   

由于答案可能不唯一，你只需要输出小 C 总分的最大值。
## 输入格式

输入第一行包含三个正整数 $s,n,m$，分别表示除了小 C 以外的玩家人数、城堡数和每名玩家拥有的士兵数。   
接下来 $s$ 行，每行 $n$ 个非负整数，表示一名玩家的策略，其中第 $i$ 个数 $a_i$ 表示这名玩家向第 $i$ 座城堡派遣的士兵数。


## 输出格式

输出一行一个非负整数，表示小 C 获得的最大得分。
## 样例

### 样例输入 #1
```
1 3 10
2 2 6
```
### 样例输出 #1
```
3
```
### 样例输入 #2
```
2 3 10
2 2 6
0 0 0
```
### 样例输出 #2
```
8
```
## 提示

**样例1解释：**  
小 C 的最佳策略为向第 $1$ 座城堡和第 $2$ 座城堡各派遣 $5$ 名士兵。 

**样例2解释：**  
小 C 的最佳策略之一为向第 $1$ 座城堡派遣 $2$ 名士兵，向第 $2$ 座城堡派遣 $5$ 名士兵，向第 $3$ 座城堡派遣 $1$ 名士兵。  

**数据范围：**   
对于 $10\%$ 的数据： $s=1,n \le 3,m \le 10$   
对于 $20\%$ 的数据： $s=1,n \le 10,m \le 100$   
对于 $40\%$ 的数据： $n\le 10,m\le 100$     
对于另外 $20\%$ 的数据： $s=1$     
对于 $100\%$ 的数据：  
$1\le s \le 100$  
$1\le n \le 100$  
$1\le m \le 20000$   
对于每名玩家 $a_i \ge 0$，$\sum\limits_{i=1}^n a_i \le m$   



---

---
title: "[SNOI2019] 字符串"
layout: "post"
diff: 普及+/提高
pid: P5329
tag: ['2019', '各省省选', '陕西']
---
# [SNOI2019] 字符串
## 题目描述

给出一个长度为$n$的由小写字母组成的字符串$a$，设其中第$i$个字符为$a_i(1≤i≤n)$ 。

设删掉第$i$个字符之后得到的字符串为$s_i$，请按照字典序对$s_1,s_2,……,s_n$从小到大排序。若两个字符串相等，则认为编号小的字符串字典序更小。
## 输入格式

第一行一个整数$n$。

第二行一个长为$n$的由小写字母组成的字符串$a$。
## 输出格式

输出一行$n$个整数$k_1,k_2,……,k_n$，用空格隔开。表示$s_{k_1}<s_{k_2}<……<s_{k_n}$。
## 样例

### 样例输入 #1
```
7
aabaaab
```
### 样例输出 #1
```
3 7 4 5 6 1 2
```
## 提示

对于所有数据，$1≤n≤10^6$。

对于10%的数据，$1≤n≤2000$；

对于另外20%的数据，$1≤n≤10^5$且任意两个相邻字符$a_i,a_{i+1}$不相等；

对于另外30%的数据，$1≤n≤10^5$；

对于余下40%的数据，无特殊限制。


---

---
title: "[TJOI2019] 大中锋的游乐场"
layout: "post"
diff: 普及+/提高
pid: P5340
tag: ['2019', '各省省选', 'O2优化', '天津']
---
# [TJOI2019] 大中锋的游乐场
## 题目描述

大中锋正在一个游乐场里玩耍。游乐场里有 $n$ 个娱乐设施，娱乐设施之间相互有共 $m$ 条道路相连，经过每一条路都需要花费一定的时间。为了方便游客，每一个娱乐设施旁都会配有一个小卖部，一部分小卖部会销售可乐，另一部分会销售汉堡。

由于大中锋十分贪吃，所以每当他走到一个娱乐设施，他都会先去购买一杯可乐或一个汉堡，并把它们吃掉。但如果大中锋吃掉的汉堡数量比他喝掉的可乐数量多于 $k$ ，那他就会感到很渴；如果喝掉的可乐数量比吃掉的汉堡数量多于 $k$ ，那他就会感到很饿。

现在大中锋正在第 $a$ 个娱乐设施，他想前往第 $b$ 个娱乐设施，但在他前进的路途中他不希望自己很渴或很饿。大中锋想知道自己在路上少花费多少时间。但由于大中锋很懒惰，他不想思考这个问题。你能帮助他解决这个问题吗？

注意：大中锋非常贪吃，所以他到达每个点的第一件事是去吃(或者喝)，才考虑其他的事情，所以在起始点和终点他都会去买汉堡(可乐)，你也需要保证在这两个点他不会感到很饿或者很渴。
## 输入格式

输入的第一行是一个整数 $T$ 表示数据组数数，对于每组数据的格式如下：

第一行有三个整数，分别代表游乐场的娱乐设施个数 $n$，游乐场的道路数 $m$ ， 以及给出的参数 $k$，其含义见【题目描述】。

第二行有 $n$ 个整数，第 $i$ 个整数 $a_i$ 代表编号为 $i$ 的娱乐设施旁的小卖部销售的物品，$1$ 表示可乐，$2$ 表示汉堡。

第 $3$ 到第 $(m + 2)$ 行，每行三个整数 $u, v, w$，代表从第 $u$ 个娱乐设施到第 $v$ 个娱乐设施有存在一条双向道路，通过该道路需要花费时间 $w$。

第 $m + 3$ 行有两个整数 $s, t$ ，代表大中锋想从娱乐设施 $s$ 前往娱乐设施 $t$。
## 输出格式

对于每组数据输出一行一个整数表示答案。如果无解，请输出 $-1$。
## 样例

### 样例输入 #1
```
1
2 1 1
1 1
1 2 1
1 2
```
### 样例输出 #1
```
-1
```
### 样例输入 #2
```
1
2 1 2
1 1
1 2 1
1 2
```
### 样例输出 #2
```
1
```
## 提示

#### 数据规模与约定

- 对于 $30\%$ 的数据，保证 $n\leq 50,m\leq 1000$。
- 对于 $100\%$ 的数据，保证 $1 \leq n\leq 10000$，$1 \leq m\leq 100000$，$1 \leq k\leq 10$，$1 \leq a_i \leq 2$，$1 \leq u, v,s, t \leq n$，$1 \leq w \leq 10000$。

对于所有数据，保证 $1 \leq T \leq 10$ ，且每个测试点的大数据不超过 $2$ 个。

#### 题目补充说明

- 路径不一定是简单路径。
- 大中锋可以多次经过一个节点，同时每次都会取得汉堡/可乐。


---

---
title: "[SNOI2017] 英雄联盟"
layout: "post"
diff: 普及+/提高
pid: P5365
tag: ['2017', '各省省选', '背包 DP']
---
# [SNOI2017] 英雄联盟
## 题目描述

正在上大学的小皮球热爱英雄联盟这款游戏，而且打的很菜，被网友们戏称为「小学生」。

现在，小皮球终于受不了网友们的嘲讽，决定变强了，他变强的方法就是：买皮肤！

小皮球只会玩  $\text{N}$ 个英雄，因此，他也只准备给这 $\text{N}$ 个英雄买皮肤，并且决定，以后只玩有皮肤的英雄。

这 $\text{N}$ 个英雄中，第 $\text{i}$ 个英雄有 $K_i$ 款皮肤，价格是每款 $C_i$ Q 币（同一个英雄的皮肤价格相同）。

为了让自己看起来高大上一些，小皮球决定给同学们展示一下自己的皮肤，展示的思路是这样的：对于有皮肤的每一个英雄，随便选一个皮肤给同学看。

比如，小皮球共有 5 个英雄，这 5 个英雄分别有 $\text{0,0,3,2,4}$ 款皮肤，那么，小皮球就有 $3 \times 2 \times 4 = 24$ 种展示的策略。

现在，小皮球希望自己的展示策略能够至少达到  $\text{M}$ 种，请问，小皮球至少要花多少钱呢？
## 输入格式

第一行，两个整数 $\text{N,M}$。

第二行，$\text{N}$ 个整数，表示每个英雄的皮肤数量 $K_i$。

第三行，$\text{N}$ 个整数，表示每个英雄皮肤的价格 $C_i$。
## 输出格式

一个整数，表示小皮球达到目标最少的花费。
## 样例

### 样例输入 #1
```
3 24
4 4 4
2 2 2
```
### 样例输出 #1
```
18
```
## 提示

**样例解释**

每一个英雄都只有4款皮肤，每款皮肤2 Q币，那么每个英雄买3款皮肤，$3 \times 3 \times 3 \ge 24$，共花费 $6 \times 3$ Q币。

**数据范围**

共 10 组数据，第 $\text{i}$ 组数据满足：$\text{N} \le \max(5, \log_2^4i)$

$\text{100}\%$ 的数据：$\text{M} \le 10^{17}, 1 \le K_i \le 10, 1 \le C_i \le 199$。保证有解。


---

---
title: "[BJOI2016] 回转寿司"
layout: "post"
diff: 普及+/提高
pid: P5459
tag: ['2016', '线段树', '各省省选', '树状数组', '离散化', '北京', 'cdq 分治', 'O2优化']
---
# [BJOI2016] 回转寿司
## 题目描述

酷爱日料的小Z经常光顾学校东门外的回转寿司店。在这里，一盘盘寿司通过传送带依次呈现在小Z眼前。  

不同的寿司带给小Z的味觉感受是不一样的，我们定义小Z对每盘寿司都有一个满意度。  

例如小Z酷爱三文鱼，他对一盘三文鱼寿司的满意度为 $10$；小Z觉得金枪鱼没有什么味道，他对一盘金枪鱼寿司的满意度只有 $5$；小Z最近看了电影《美人鱼》，被里面的八爪鱼恶心到了，所以他对一盘八爪鱼刺身的满意度是 $-100$。   

特别地，小Z是个著名的吃货，他吃回转寿司有一个习惯，我们称之为“狂吃不止”。具体地讲，当他吃掉传送带上的一盘寿司后，他会毫不犹豫地吃掉它后面的寿司，直到他不想再吃寿司了为止。  

今天，小Z再次来到了这家回转寿司店，$N$ 盘寿司将依次经过他的面前。其中，小Z对第 $i$ 盘寿司的满意度为$a_i$。  

小Z可以选择从哪盘寿司开始吃，也可以选择吃到哪盘寿司为止。他想知道共有多少种不同的选择，使得他的满意度之和不低于 $L$，且不高于 $R$。

注意，虽然这是回转寿司，但是我们不认为这是一个环上的问题，而是一条线上的问题。即，小Z能吃到的是输入序列的一个连续子序列；最后一盘转走之后，第一盘并不会再出现一次。
## 输入格式

第一行三个正整数 $N,L,R$，表示寿司盘数，满意度的下限和上限。  
第二行包含 $N$ 个整数 $a_i$，表示小Z对寿司的满意度。  

## 输出格式

一行一个整数，表示有多少种方案可以使得小Z的满意度之和不低于 $L$ 且不高于 $R$。
## 样例

### 样例输入 #1
```
5 5 9
1 2 3 4 5
```
### 样例输出 #1
```
6
```
## 提示

【数据范围】  

$1\le N \le 10^5$  
$|a_i| \le 10^5$   
$0\le L,R \le 10^9$


---

---
title: "[JLOI2010] 铁人双项比赛"
layout: "post"
diff: 普及+/提高
pid: P5485
tag: ['计算几何', '2010', '各省省选', '吉林']
---
# [JLOI2010] 铁人双项比赛
## 题目描述

铁人双项比赛是吉林教育学院的一项传统体育项目。该项目比赛由长跑和骑自行车组成，参赛选手必须先完成$k$公里的长跑，然后完成r公里的骑车，才能到达终点。每个参赛选手所擅长的项目不同，有的擅长长跑，有的擅长骑车。如果总赛程$s=k+r$一定，那么K越大，对擅长长跑的选手越有利；$k$越小，对擅长骑车的选手越有利。
 
现在给定总赛程$s$，以及每个选手长跑和骑车的平均速度，请你求出对于某个指定的选手最有利的k和r。所谓最有利，是指选择了这个$k$和$r$后，该选手可以获得冠军，且领先第$2$名尽量地多。
## 输入格式

你的程序从文件读入输入数据。
输入的第一行是两个正整数$s$和$n$，$s$表示总赛程（单位为公里，$s\leq 2^{31}$），$n$表示参赛总人数（$2\leq n\leq 100$）。
接下来的$n$行每行是两个实数，分别表示每个选手长跑的平均速度和骑车的平均速度（单位为千米/小时）。
第$n$个选手就是指定的选手，你的任务是求出对他最有利的$k$和$r$。
## 输出格式

你的程序的输出包括三个数$k,r,t$，分别表示对第$n$号选手最有利的$k$和$r$（浮点数，保留小数点后$2$位），以及在选择$k$和$r$的情况下，第$n$号选手最多可以领先第$2$名多少秒（四舍五入到整数）；如果另一个选手和该选手并列第一，则$t_i=0$。倘若无论选择什么$k$，$r$都不能使第$n$号选手获胜，则输出“$NO$”。
## 样例

### 样例输入 #1
```
100 3
10.0 40.0
20.0 30.0
15.0 35.0
```
### 样例输出 #1
```
14.29 85.71 612
```


---

---
title: "[GZOI2017] 小z玩游戏"
layout: "post"
diff: 普及+/提高
pid: P5676
tag: ['图论', '2017', '各省省选', 'O2优化', '贵州', 'Tarjan']
---
# [GZOI2017] 小z玩游戏
## 题目背景

GZOI2017 D1T2
## 题目描述

小 z 很无聊。

小 z 要玩游戏。

小 z 有 $N$ 个新游戏，第 $i$ 个游戏看上去的有趣程度为 $w_i$。

小 z 很挑，他只会玩看上去的有趣程度是自己兴奋程度整数倍的游戏。

由于游戏实际上有好玩的也有不好玩的，玩完第 $i$ 个游戏后，小 z 的兴奋程度会变为 $e_i$。

已知小 z 初始兴奋程度为 $1$，请问小 z 有多少个游戏可能会玩两次？
## 输入格式

第一行一个正整数 $T$，表示测试数据组数，最多 $10$ 组。

对于每组测试数据：

- 第一行一个正整数 $N$，表示游戏的个数。
- 第二行 $N$ 个正整数，第 $i$ 个数 $w_i$，表示第 $i$ 个游戏看上去的有趣程度为 $w_i$。
- 第三行 $N$ 个正整数，第 $i$ 个数 $e_i$，表示小 z 玩完第 $i$ 个游戏后，小 z 的兴奋程度会变为 $e_i$。
## 输出格式

共 $T$ 行。

每行一个正整数，表示对应测试数据，小 z 可能会玩两次的游戏数量。
## 样例

### 样例输入 #1
```
5
1
100000
100000
5
1 2 6 15 35
5 7 9 2 3
5
2 3 5 35 21
7 11 7 3 2
10
6 15 77 12 24 37 35 99 55 42
4 2 5 7 11 3 6 8 9 10
10
6540 5604 567 57065 60 670 6870 1230 465 6540
12 5 37 3 34 13 17 18 10 12
```
### 样例输出 #1
```
1
3
3
8
5
```
## 提示

### 样例 2 解释

数字代表游戏编号，箭头表示下一个。

- 情况 $1$：$2\to 5\to 4\to 2$；
- 情况 $2$：$5\to 4\to 2\to 5$；
- 情况 $3$：$4\to 2\to 5\to 4$。

所以小 z 可能玩 $2,4,5$ 两次。

小 z 无论如何都不能玩 $1$ 或 $3$ 两次。

### 数据范围及约定


![](https://cdn.luogu.com.cn/upload/image_hosting/s757wplh.png)


---

---
title: "[CQOI2005] 珠宝"
layout: "post"
diff: 普及+/提高
pid: P5765
tag: ['2005', '重庆', '各省省选']
---
# [CQOI2005] 珠宝
## 题目描述

有一棵 $n$ 个结点的树，给每个点安排一个正整数编号，使得相邻点具有不同的编号，编号的总和尽量小。
## 输入格式

第一行一个整数 $n$。

以下 $n-1$ 行，每行两个数 $u,v(1\le u,v\le n)$，表示 $u$ 和 $v$ 间有一条边。
## 输出格式

仅一行，为最小编号和。
## 样例

### 样例输入 #1
```
8  
1 2 
1 3
1 4
1 5
5 6
5 7
5 8
```
### 样例输出 #1
```
11
```
## 提示

对于 $20\%$ 的数据，$n\le 10$；

对于 $40\%$ 的数据，$n\le 1000$；

对于 $100\%$ 的数据，$1\le n\le 50000$。


---

---
title: "[SCOI2004] 文本的输入"
layout: "post"
diff: 普及+/提高
pid: P5810
tag: ['2004', '四川', '各省省选', 'O2优化']
---
# [SCOI2004] 文本的输入
## 题目描述

人们在输入文本时，除了逐个输入这种方式外，还可以利用剪贴板进行复制，如果打入一个字母需要 $1$ 的时间，将已输入的部分复制进剪贴板需要 $5$ 的时间（`Ctrl`+`A`，`Ctrl`+`C`，再取消全选状态），将剪贴板的内容粘贴出来需要 $2$ 的时间（`Ctrl`+`V`）。

如果我们不关心输入文本的内容，而只关心输入文本的长度，要输入一个长度**不低于** $n$ 的文本最少需要多少时间？

**请注意，数据范围与原题略有不同。**
　　
## 输入格式

一个正整数 $n$，表示文本的长度。
## 输出格式

一个正整数 $t$，表示需要的最短的时间。
## 样例

### 样例输入 #1
```
20
```
### 样例输出 #1
```
16
```
## 提示

样例解释：先用 $7$ 时间打出 $7$ 个字符，再复制（用去 $5$ 时间），粘贴两次（用去 $4$ 时间），即可用 $16$ 时间打出 $21$ 个字符。

对于 $20\%$ 的数据，$n\le 10$；

对于 $60\%$ 的数据，$n\le 10^4$；

对于 $100\%$ 的数据，$n\le 4\times 10^4$。


---

---
title: "[CQOI2010] 扑克牌"
layout: "post"
diff: 普及+/提高
pid: P5815
tag: ['2010', '重庆', '二分', '各省省选']
---
# [CQOI2010] 扑克牌
## 题目描述

你有 $n$ 种牌，第 $i$ 种牌的数目为 $c_i$。另外有一种特殊的牌：joker，它的数目是 $m$。你可以用每种牌各一张来组成一套牌，也可以用一张 joker 和除了某一种牌以外的其他牌各一张组成 $1$ 套牌。比如，当 $n=3$ 时，一共有 $4$ 种合法的套牌：$\{1,2,3\}$，$\{J,2,3\}$，$\{1,J,3\}$，$\{1,2,J\}$。

给出 $n$，$m$ 和 $c_i$，你的任务是组成尽量多的套牌。每张牌最多只能用在一副套牌里（可以有牌不使用）。
## 输入格式

第一行包含两个整数 $n$，$m$，即牌的种数和 joker 的个数。

第二行包含 $n$ 个整数 $c_i$，即每种牌的张数。

## 输出格式

输出仅一个整数，即最多组成的套牌数目。

## 样例

### 样例输入 #1
```
3 4
1 2 3

```
### 样例输出 #1
```
3

```
## 提示

**样例说明**

输入数据表明：一共有 $1$ 个 $1$，$2$ 个 $2$，$3$ 个 $3$，$4$ 个 joker。最多可以组成三副套牌：$\{1,J,3\}$，$\{J,2,3\}$，$\{J,2,3\}$，joker 还剩一个，其余牌全部用完。

**数据范围**

对于 $50\%$ 的数据，$2 \le n \le 5$，$0 \le m \le 10^6$，$0 \le c_i \le 200$。

对于 $100\%$ 的数据，$2 \le n \le 50$，$0 \le m,c_i \le 5 \times 10^8$。


---

---
title: "[省选联考 2020 B 卷] 幸运数字"
layout: "post"
diff: 普及+/提高
pid: P6627
tag: ['2020', '各省省选', '离散化', '差分']
---
# [省选联考 2020 B 卷] 幸运数字
## 题目描述

为庆祝疫情防治取得重大进展，某商场举行酬宾活动，给顾客一些优惠额度，规则如下：

1. 每位顾客可以任意选择一个整数作为自己的幸运数字。
2. 每位顾客的初始优惠额度为 $0$ 元。
3. 商场有 $n$ 个奖励条件，对应不同的奖励额度 $w_i$。
4. 每位顾客需要依次比对这 $n$ 个奖励条件，如果该位顾客选择的幸运数字满足第 $i$ 个条件，那么他的优惠额度就会**异或**上这个条件所对应的奖励额度。

奖励条件共有三种，假设顾客选择的幸运数字为 $x$：

1. 区间型条件，其有两个参数 $L$ 与 $R$，满足条件为 $L \le x\le R$。保证 $L < R$。
2. 相等型条件，其有一个参数 $A$，满足条件为 $x = A$。
3. 不等型条件，其有一个参数 $B$，满足条件为 $x \neq B$。

小炎同学获知了所有奖励条件的信息，他希望知道一位顾客能够得到的最大优惠额度以及对应的幸运数字是多少，请你帮他计算。

## 输入格式

第一行包含一个正整数 $n$，代表奖励条件的数量。

接下来 $n$ 行，每行三个或四个整数表示一个奖励条件。每行第一个整数 $t_i$ 代表奖励条件的类型：

1. $t_i = 1$ 则该条件是区间型条件，接下来三个整数，分别代表 $L, R, w_i$。
2. $t_i = 2$ 则该条件是相等型条件，接下来两个整数，分别代表 $A, w_i$。
3. $t_i = 3$ 则该条件是不等型条件，接下来两个整数，分别代表 $B, w_i$。

## 输出格式

输出一行两个整数，第一个数代表能够得到的最大优惠额度，第二个数代表对应的幸运数字。

如果有多个幸运数字能够得到最大优惠额度，输出绝对值最小的那个。如果还有多个，则输出值最大的。

## 样例

### 样例输入 #1
```
4
1 -100 -80 37
2 -3 3
3 4 64
1 -10 1024 156
```
### 样例输出 #1
```
223 -3
```
## 提示

**样例解释**

幸运数字 $-3$ 满足奖励条件 $2, 3, 4$，奖励额度为 $3\oplus 64\oplus 156 = 223$，其中 $\oplus$ 表
示异或运算。

**数据范围与约定**

$20\%$ 的数据满足：$n, |L|, |R|, |A|, |B| \le 1000$。  
$40\%$ 的数据满足：$n\le 1000$。  
$100\%$ 的数据满足：$1\le n\le 10^5, |L|, |R|, |A|, |B|\le 10^9, 1\le w_i\le 10^9$。



---

---
title: "[AHOI2007] 石块地板"
layout: "post"
diff: 普及+/提高
pid: P7741
tag: ['2007', '各省省选', '安徽', 'O2优化']
---
# [AHOI2007] 石块地板
## 题目描述

小可可来到了宫殿的正厅中。大厅的地面是由一块块大小一致的正方形石块组成的，这些石块分为黑、白两色，组成了一个   $m×n$ 的矩形，在其中一个石块的下面就是通往藏宝库的通道。小可可不可能一个一个石块的尝试，因为有些石块安装了机关，一碰就会触发，整个宫殿也随之倒塌。根据藏宝图记载，通道在某一特定的区域中，这个区域是一个由数个石块组成的面积不为 $0$ 的小矩形，它的四条边与大厅地面的边平行。如果对整个大厅地面任意划分矩形，那么在所有矩形中，这个区域的黑色石块数目减去白色石块数目所得的差是最大的。

小可可希望和你分工，由他来选择区域，你来计算黑、白两色石块的数目差 $S$ 。这样就能快速而准确的确认通道所在的区域。藏宝图上说这个区域中的石块都没有安装机关，只要确定了区域，就一定能找到通道。宝藏就在眼前了，加油吧！

（假设用 $1$ 表示黑色石块，用 $0$ 表示白色石块）
## 输入格式

输入文件的第一行为两个整数 $m,n$。

以下 $m$ 行，每行 $n$ 个字符，每个字符都是 $0$ 或 $1$。
## 输出格式

输出文件仅一个数，表示所有可能的区域中 $S$ 值（见前文描述）最大的一个，输出这个值即可。
## 样例

### 样例输入 #1
```
3 4
1011
1111
1111
```
### 样例输出 #1
```
10
```
### 样例输入 #2
```
4 5
10110
01111
11110
10101
```
### 样例输出 #2
```
8
```
## 提示

对于 $ 50\%$ 的数据：$1 \le m, n \leq200$。

对于 $100\%$ 的数据：$1 \le m, n \leq400$。


---

---
title: "[省选联考 2022] 预处理器"
layout: "post"
diff: 普及+/提高
pid: P8289
tag: ['模拟', '各省省选', '2022', 'O2优化']
---
# [省选联考 2022] 预处理器
## 题目描述

宏是 C/C++ 语言的一项特性，它根据预先定义的规则进行文本替换（也被称为 “宏展开”），能够实现定义常量、简化代码重复输入等功能。例如：

```cpp
#define PI 3.14159
double area = PI * r * r;
```

以上代码经过宏展开后变为：

```cpp

double area = 3.14159 * r * r;
```

其中，宏定义命令变成了空行，而其他行中的宏被展开成了规则定义的文本。

C/C++ 语言代码在编译时对宏的处理由**预处理器**完成。你的任务是实现一个简化版的预处理器，要求如下：

- 代码由**行**组成，每行除行末的换行符外，均由可打印 ASCII 字符（ASCII 码范围 $32\sim 126$）组成。每行要么是**预处理命令**（以 `#` 开头），要么是**普通文本**（其他情况）。

- 预处理器逐行处理代码，
	- 如果是预处理命令，执行该命令，并输出一个空行。
    - 如果是普通文本，对其进行宏展开并输出结果。
- 预处理命令有两种，分别是宏定义命令 `#define` 和取消宏定义命令 `#undef`。
	- 宏定义命令的格式为 `#define <name> <content>`，其中第一部分 `#define` 是命令名，第二部分 `<name>` 是要定义的宏的名字，第三部分 `<content>` 是要定义的宏的展开内容。
    - 取消宏定义命令的格式为 `#undef <name>`，其中第一部分 `#undef` 是命令名，第二部分 `<name>` 是要取消的宏的名字。
    
    以上两种预处理命令中，相邻两部分之间都严格用一个空格分隔。`<name>` 是由大小写字母和数字以及下划线组成的**标识符**（一个或多个字符），`<content>` 可以包含任意可打印 ASCII 字符（零个或多个字符）。一个宏定义的**有效范围**是从它定义所在行开始到后续最近的宏名匹配的取消定义所在行为止（如果没有对应的取消定义，则有效范围一直覆盖到文件结束）。
    
对普通文本进行宏展开时，将一行文本中每段**连续极长**的大小写字母和数字以及下划线视为标识符（而不是其中一部分），其余为**其他字符**。从左到右依次对文本中的标识符进行宏展开：
    
1. 如果该标识符是有效的宏名，则用对应的展开内容替换它，此时该宏名进入正在展开的状态，直到本流程结束；否则原样保留宏名。例如，若宏 `A` 定义为 `b`，则文本 `A` 展开结果为 `b`（发生替换），文本 `B` 展开结果仍然为 `B`（未定义，不替换），文本 `AA` 展开结果仍然为 `AA`（`AA` 是不同于 `A` 的另一个标识符，未定义），而文本 `A*B` 展开结果为 `b*B`。
    
2. 替换发生后，如果展开内容中包含标识符，重复应用以上的展开操作，称为 “多次展开”。例如，若宏 `A` 定义为 `B`，宏 `B` 定义为 `c`，则文本 `A` 的展开结果为 `c`。
    
3. 如果待展开的宏名与正在进行展开的某个宏名相同，称为 “递归展开”，此时该宏名不再展开。本规则用来防止无限递归展开。例如，若宏 `A` 定义为 `B+a`，宏 `B` 定义为 `A+b`，则文本 `A` 展开结果为 `A+b+a`，由于最初的 `A` 处于正在展开状态，因此 `A+b+a` 里的 `A` 不再展开。

4. 其他字符原样保留。

注意：出于简化的目的，本题的要求与 C/C++ 语言标准里的描述不完全一致，请以上面的要求为准。最明显的区别是本题只有标识符和其他字符两类词法单元，没有数值、字符串、注释等。
## 输入格式

输入的第一行包含一个正整数 $n$，表示要处理的代码行数。

接下来的 $n$ 行是要处理的代码。
## 输出格式

输出 $n$ 行，为输入逐行预处理后的结果。
## 样例

### 样例输入 #1
```
5
#define BEGIN {
#define END }
#define INTEGER int
class C BEGIN INTEGER x; END;
INTEGER main() BEGIN C c; END

```
### 样例输出 #1
```



class C { int x; };
int main() { C c; }

```
### 样例输入 #2
```
见附件中的 preprocessor/preprocessor2.in
```
### 样例输出 #2
```
见附件中的 preprocessor/preprocessor2.ans
```
### 样例输入 #3
```
见附件中的 preprocessor/preprocessor3.in
```
### 样例输出 #3
```
见附件中的 preprocessor/preprocessor3.ans
```
## 提示

**【数据范围】**

对 $20\%$ 的数据，不会出现宏定义命令 `#define` 和宏取消定义命令 `#undef`。

对另外 $20\%$ 的数据，不会出现多次展开的情况，且不会出现宏取消定义命令 `#undef`。

对另外 $20\%$ 的数据，不会出现多次展开的情况。

对另外 $20\%$ 的数据，不会出现递归展开的情况。

对其余数据，无特殊限制。

对 $100\%$ 的数据，$n \leq 100$，输入的每行字符数都不超过 $100$，且保证输出的每行字符数都不超过 $1000$（字符数均不计行末换行符）。保证输入数据中的预处理命令都是合法的，包含但不限于：

- `#` 字符只会出现在预处理命令所在行的第一个字符的位置，其他任何位置（包括预处理命令和普通文本）都不会出现 `#` 字符。
- 宏定义和取消定义命令的格式是正确的，严格遵循题面所描述的格式。
- 同一个宏在取消定义之前不会被再次定义。
- 要取消定义的宏在之前被定义过且还没有被取消过。

也就是说，**你不需要做任何语法和语义的错误检查**。

**【提示】**

本题进行输入时建议使用 C++ 语言的按行读入字符串功能，示例如下：

```cpp
#include <iostream>
#include <string>
using namespace std;
string line;
// 从 cin 读入一行，放入 line 中（换行符被舍弃）
getline(cin, line);
```

也可以使用 C 语言提供的 `fgets` 函数，示例如下：

```cpp
#include <stdio.h>
#define MAX_LEN 200
char line[MAX_LEN];
// 从 stdin 读入一行，放入 line 中（包含换行符）
fgets(line, MAX_LEN, stdin);
```

**注意**：在读取行数 $n$ 之后可能需要额外读取一行以忽略其后的换行符。


---

---
title: "[SNOI2022] 垃圾回收"
layout: "post"
diff: 普及+/提高
pid: P8359
tag: ['各省省选', '2022', 'O2优化', '陕西']
---
# [SNOI2022] 垃圾回收
## 题目描述

通常的情况下，编程语言在管理内存时进行如下的选择：

- 让用户进行手动内存管理（C、C++、Rust 等），这会收获很好的性能，但是给用户提供了很大的编程负担。
- 使用垃圾回收系统（Java、Go 等），这需要维护一个运行时系统，并且在内存使用和程序性能方面造成了许多不可预测的负担。

尽管存在许多的问题，目前最通用的自动化内存管理手段始终为 Tracing Garbage Collector。这种做法的最基础的思路是维护对象间的引用关系，形成一张图，每次回收时通过扫描引用关系推导出已经无法被访问到的对象，释放它们占用的内存。而这种传统的做法最大的问题在于维护引用链需要造成很大的开销，并且随着维护的对象越多，扫描的代价也会越大。

小 L 是一个喜欢思考的女孩子，她发现维护 Garbage Collector 是一件非常复杂的事情，于是她决定考虑一个更简单的模型（注意它与任何现实中的 GC 规则可能是完全不同的！）。


对于一个 $n$ 个点 $m$ 条边的无向图，没有重边自环，点和边均从 $1$ 开始标号。其中每个节点代表一个占用了一定内存的对象，每条边对应一个引用关系（注意这里的引用关系是**无向**的），程序从第 $0$ 秒开始运行，在第 $q + 1$ 秒结束运行。对于 $i = 1, 2, 3, \dots, q$ 的每个时刻 $i$ 发生以下两种操作之一：

- DELETE $i$，删除边 $(x_i,y_i)$，保证不会删除已经被删除的边。
- GC， 进行一次内存回收，即杀死所有从起点出发不能访问到的点，释放它们占用的内存。（注意这里对节点的删除不会删除与这些点相连的边）

你可以认为这些操作是被瞬间执行完成的，在所有操作执行后，也就是第 $q + 1$ 秒，程序结束，删除所有剩余的节点（包括 $1$ 号点）。

第 $i$ 个点占用的内存为 $a_i$，现在请你求出 $\sum_{i = 1}^{n} a_i \cdot \mathit{alive}_i$，这里 $\mathit{alive}_i$ 表示第 $i$ 个点存活的时间，在第 $0$ 秒，所有节点都是存活的。
## 输入格式

输入的第一行是三个正整数 $n, m, q$，分别表示对象的个数，引用关系的个数，操作的个数。

接下来的 $m$ 行每行两个正整数 $x_i, y_i$ 表示第 $i$ 条引用关系的两个端点。

接下来的 $q$ 行每行为以下两种形式之一，第 $i$ 行表示在第 $i$ 秒发生的操作：

- 字符串 DELETE 和正整数 $x$，含义见【题目描述】。
- 字符串 GC，含义见【题目描述】。

接下来的一行有 $n$ 个正整数 $a_1,a_2,\dots,a_n$，表示每个对象占用的内存大小。 
## 输出格式

输出一行一个整数表示答案，含义见【题目描述】。
## 样例

### 样例输入 #1
```
6 6 8
1 2
2 3
2 4
1 4
2 5
1 6
GC
DELETE 5
DELETE 3
GC
DELETE 1
GC
DELETE 2
GC
1 2 3 4 5 6

```
### 样例输出 #1
```
149

```
### 样例输入 #2
```
样例 2 见附件 garbage2.in
本组数据满足测试点 6 的限制。
```
### 样例输出 #2
```
样例 2 见附件 garbage2.ans
```
### 样例输入 #3
```
样例 3 见附件 garbage3.in
本组数据满足测试点 11 的限制。
```
### 样例输出 #3
```
样例 3 见附件 garbage3.ans
```
## 提示

**【样例 1 解释】**

在第 $4$ 秒时，节点 $5$ 被删除。

在第 $6$ 秒时，节点 $2, 3$ 被删除。

在第 $9$ 秒时，节点 $1, 4, 6$ 被删除。

答案即 $5 \times 4 + (2 + 3) \times 6 + (1 + 4 + 6) \times 9 = 20 + 30 + 99 = 149$。

**【数据规模与约定】**

对于全部数据，$1 \leq n, m, q \leq 4 \times 10^5$，$1 \leq a_i \leq 10^8$。

具体的数据规模与约定见下表。

| 测试点编号 | $n$ | $m$ | $q$ | 特殊限制 |
| :----------: | :----------: | :----------: | :----------: | :----------: |
| $1 \sim 2$ | $\leq 500$ | $\leq 500$ | $\leq 500$ |   |
| $3 \sim 5$ | $\leq 3000$ | $\leq 3000$ | $\leq 3000$ |  |
| $6 \sim 10$ | $\leq 5000$ | $\leq 5000$ | $\leq 5000$ |  |
| $11 \sim 14$ | $\leq 2 \times 10^5$ | $n-1$ | $\leq 2 \times 10^5$ | 保证一开始图是一棵树 |
| $15 \sim 16$ | $\leq 2 \times 10^5$ | $\leq 2 \times 10^5$ | $\leq 2 \times 10^5$ |  |
| $17 \sim 20$ | $\leq 4 \times 10^5$ | $\leq 4 \times 10^5$ | $\leq 4 \times 10^5$ |  |


---

---
title: "[省选联考 2023] 火车站"
layout: "post"
diff: 普及+/提高
pid: P9166
tag: ['各省省选', '2023', 'O2优化']
---
# [省选联考 2023] 火车站
## 题目描述

有 $n$ 个火车站排成一条直线，从 $1$ 到 $n$ 编号。一共有 $m$ 条火车轨道，每条轨道覆盖一段火车站区间 $[l_i, r_i]$。

对于一个被多条火车轨道覆盖的火车站，火车在经过这里的时候，可以在此处改变轨道。但是火车无法掉头，只能朝着一个方向运行（即只能一直往 $1$ 的方向开或者一直往 $n$ 的方向开）。

小 A 从火车站 $x$ 出发，即搭上了经过 $x$ 的任意一列火车（这列火车也可能是从车站 $x$ 出发）。这列火车可能行驶在火车站 $x$ 所处的任一条轨道上，其运行方向既可能是往 $1$ 的方向开，也可能是往 $n$ 的方向开。小 A 上车后就开始昏睡，直到乘坐的火车到达某条线路的终点站停下，他才醒过来。问小 A 最后可能到达的车站。

注意：火车应运行至少一个车站，且火车切换轨道后不会立刻停下来，而是会继续沿着当前轨道前进。

## 输入格式

输入的第一行包含三个正整数 $n, m, x$，分别表示火车站的数量，火车轨道的数量以及小 A 初始的起点。

接下来 $m$ 行，每行包含两个正整数 $l_i, r_i$，表示一条火车轨道运行的区间。

## 输出格式

输出一行，包含若干个用单个空格分隔的正整数，表示小 A 最后可能到达的车站，按照车站编号升序排序输出。

## 样例

### 样例输入 #1
```
7 5 4
3 4
4 6
1 3
5 7
4 6

```
### 样例输出 #1
```
1 3 6 7

```
## 提示

**【样例 1 解释】**

火车从车站 $4$ 出发，沿着第一条轨道可以运行到终点 $3$，也可以接着沿第三条轨道运行到终点 $1$。

火车从车站 $4$ 出发，沿着第二条轨道可以运行到终点 $6$，也可以在车站 $5$ 换到第四条轨道运行到终点 $7$。

所以最终按顺序输出 $1, 3, 6, 7$。

**【数据范围】**

对于所有的数据，保证 $1 \le n, m \le 2 \times 10^5$，$1 \le x \le n$，$1 \le l_i < r_i \le n$。

|测试点|$n, m \le$|特殊性质|
|:-:|:-:|:-:|
|1|$50$|无|
|2|$50$|无|
|3|$5000$|无|
|4|$5000$|无|
|5|$5000$|无|
|6|$2 \times 10^5$|A|
|7|$2 \times 10^5$|A|
|8|$2 \times 10^5$|无|
|9|$2 \times 10^5$|无|
|10|$2 \times 10^5$|无|

特殊性质 A：保证 $x = 1$。



---


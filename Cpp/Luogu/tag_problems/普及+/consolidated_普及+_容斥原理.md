---
title: "[蓝桥杯 2023 国 Python A] 2023"
layout: "post"
diff: 普及+/提高
pid: P10986
tag: ['2023', '组合数学', '容斥原理', '蓝桥杯国赛']
---
# [蓝桥杯 2023 国 Python A] 2023
## 题目背景

建议使用 PyPy3 提交本题。
## 题目描述

给定 $n, m$，请求出所有 $n$ 位十进制整数中有多少个数中恰好出现了 $m$ 个 $2023$。

例如 $00202312023$ 是一个 $11$ 位的出现了 $2$ 个 $2023$ 的十进制整数。

由于结果可能很大，请输出答案对 $998,244,353$ 取模的结果。



## 输入格式

输入一行包含两个整数 $n,m$，用一个空格分隔。


## 输出格式

输出一行包含一个整数表示答案。
## 样例

### 样例输入 #1
```
5 1
```
### 样例输出 #1
```
20
```
## 提示

对于 $40\%$ 的评测用例，$n \le 10^5,m \le 10$；

对于所有评测用例，$4 \le n \le 10^5,0 \le 4m \le n$。


---

---
title: "红色的幻想乡"
layout: "post"
diff: 普及+/提高
pid: P3801
tag: ['线段树', '树状数组', '洛谷原创', '容斥原理']
---
# 红色的幻想乡
## 题目背景

蕾米莉亚的红雾异变失败后，很不甘心。

## 题目描述

经过上次失败后，蕾米莉亚决定再次发动红雾异变，但为了防止被灵梦退治，她决定将红雾以奇怪的阵势释放。

我们将幻想乡看做是一个 $n \times m$的方格地区，一开始没有任何一个地区被红雾遮盖。蕾米莉亚每次站在某一个地区上，向东南西北四个方向各发出一条无限长的红雾，可以影响到整行/整列，但不会影响到她所站的那个地区。如果两阵红雾碰撞，则会因为密度过大而沉降消失。灵梦察觉到了这次异变，决定去解决它。但在解决之前，灵梦想要了解一片范围红雾的密度。可以简述为两种操作:

``1 x y`` 蕾米莉亚站在坐标 $(x,y)$ 的位置向四个方向释放无限长的红雾。

``2 x1 y1 x2 y2`` 询问左上点为$(x1,y1)$，右下点为 $(x2,y2)$ 的矩形范围内，被红雾遮盖的地区的数量。

## 输入格式

第一行三个整数 $n,m,q$，表示幻想乡大小为 $n \times m$，有 $q$ 个询问。

接下来 $q$ 行，每行 $3$ 个或 $5$ 个整数,用空格隔开，含义见题目描述。
## 输出格式

对于每一个操作 $2$，输出一行一个整数，表示对应询问的答案。
## 样例

### 样例输入 #1
```
4 4 3
1 2 2
1 4 4
2 1 1 4 4

```
### 样例输出 #1
```
8
```
## 提示

#### 样例输入输出 1 解释

用``o``表示没有红雾，``x``表示有红雾，两次释放红雾后幻想乡地图如下:

```
oxox
xoxo
oxox
xoxo
```

---

#### 数据规模与约定

- 对于 $20\%$ 的数据，$1 \le n,m,q \le 200$。
- 对于 $40\%$ 的数据，$1 \le n,m,q \le 10^3$。
- 对于 $100\%$ 的数据，$1 \le n,m,q \le 10^5$，$1 \le x_1,x_2,x \le n$，$x_1 \le x_2$，$1 \le y_1,y_2,y \le m$，$y_1 \le y_2$。


---

---
title: "齿轮"
layout: "post"
diff: 普及+/提高
pid: P6298
tag: ['数学', '2020', '容斥原理']
---
# 齿轮
## 题目描述

Daniel13265 从不知哪里找来了 $n$ 个齿轮，第 $i$ 个齿轮的齿数为不超过 $m$ 的正整数 $a_i$。他现在想把其中 $k$ 个齿轮按照一定的方式拼接在一起。

当齿轮使用一段时间后，就会产生损耗。一个齿轮组的损耗速率是由这个齿轮组的所有齿轮齿数的最大公约数决定的：最大公约数越大，相同的齿之间啮合的频率就会增高，从而损耗的速率就会变快。这个最大公约数又被称为损耗因子。

算出一个齿轮组的损耗因子是很容易的。可是现在 Daniel13265 想要知道，对于可能拼接出的所有齿轮组的损耗因子。

Daniel13265 知道拼接出损耗因子大于 $m$ 的齿轮组是不可能的，而且由于可能拼出的齿轮组的个数很多，你只需要反过来告诉他对于所有的 $t\in[1, m]$，能够拼接出的损耗因子为 $t$ 的齿轮组的个数对 $10^9+7$ 取模后的结果即可。
## 输入格式

输入共 $2$ 行。
  
第一行包含三个正整数 $n,m,k$，分别表示 Daniel13265 拥有的齿轮个数，齿轮齿数的最大可能值与 Daniel13265 期望的齿轮组的齿轮个数。  
第二行共 $n$ 个用单个空格隔开的正整数，第 $i$ 个数 $a_i$ 表示第 $i$ 个齿轮的齿数。
## 输出格式

输出一行 $m$ 个整数，第 $t$ 个数表示能够拼接出的损耗因子为 $t$ 的齿轮组的个数对 $10^9+7$ 取模后的结果。
## 样例

### 样例输入 #1
```
5 6 2
1 2 3 4 6

```
### 样例输出 #1
```
6 3 1 0 0 0

```
## 提示

### 样例解释

损耗因子为 $1$ 的齿轮组有 $(1,2),(1,3),(1,4),(1,6),(2,3),(3,4)$ 共 $6$ 个；  
损耗因子为 $2$ 的齿轮组有 $(2,4),(2,6),(4,6)$ 共 $3$ 个；  
损耗因子为 $3$ 的齿轮组有 $(3,6)$ 共 $1$ 个。

### 数据范围

**本题采用捆绑测试。你每通过一个子任务的所有数据点，就能得到该子任务的全部分数。**

| 子任务编号 | $n\le$ | $m\le$ | $k\le$ | 分值 |
|:-:|:-:|:-:|:-:|:-:|
| $1$ | $10$ | $10^6$ | $10$ | $10$ |
| $2$ | $10^3$ | $10^3$ | $10^3$ | $20$ |
| $3$ | $10^6$ | $10^3$ | $2$ | $5$ |
| $4$ | $10^6$ | $10^6$ | $1$ | $5$ |
| $5$ | $10^6$ | $10^6$ | $2$ | $20$ |
| $6$ | $10^6$ | $10^6$ | $10^6$ | $40$ |

对于 $100\%$ 的数据，满足 $1\le k\le n\le10^6$，$1\le a_i\le m\le10^6$。


---

---
title: "「EZEC-2」字母"
layout: "post"
diff: 普及+/提高
pid: P6600
tag: ['前缀和', '容斥原理']
---
# 「EZEC-2」字母
## 题目背景


给你一个 $01$ 矩阵，我们希望你从中找到由连续的 $1$ 组成的「字母 T」。
## 题目描述

「字母 T」由一横和一竖组成，竖一定在横的下方（您可以借助英文字母 `T` 辅助理解）。

在本题中，我们定义「横」为组成「字母 T」的水平线段，「竖」为组成「字母 T」的竖直线段。

注意「横」与「竖」的公共部分同时计入横长和竖长。

**合法的「字母 T」的「横」长必须为奇数且「竖」与「横」交于「横」的中点，「横」长最小为 $3$ ，「竖」长最小为 $2$。**


如：

$$
    \begin{array}{ccc}
       0\color{Red}111\color{black}1\\
       00\color{Red}1\color{black}01
    \end{array}
$$

**只含有**一个合法的「字母 T」（即标红部分）。


现在给你一个 $n \times m$ 的 $01$ 矩阵，请你求出在这个矩阵中**合法**的「字母 T」中，一共有多少个**满足以下条件**的「字母 T」。 

设某个合法的「字母 T」的「横」长为 $w$，「竖」长为 $h$，有：

- $w\ge a$
- $h\ge b$
- $w\times h \ge s$
- $w+h\ge x$

两个「字母 T」不相同即两个「字母 T」的 **「横」长** 或 **「竖」长** 或 **最左上角的坐标** 不同。     
## 输入格式

第一行，两个整数 $n,m$，表示给定的 $01$ 矩阵共有 $n$ 行 $m$ 列。

第二行，四个整数 $a,b,s,x$。

接下来 $n$ 行，每行 $m$ 个数，只可能是 $0$ / $1$，为给定的矩阵。
## 输出格式

输出一个整数，表示有多少个**满足条件且合法**的「字母 T」。   
## 样例

### 样例输入 #1
```
5 5
3 3 18 9
11111
01110
11111
01110
11111
```
### 样例输出 #1
```
2
```
### 样例输入 #2
```
5 5
3 3 15 7
11111
01110
11111
01110
11111
```
### 样例输出 #2
```
7
```
### 样例输入 #3
```
10 10
5 4 40 11
0011111111
1011110101
1111111111
1001111101
1111101111
1111110110
0111011101
0111111110
0011111111
0111111101

```
### 样例输出 #3
```
8
```
## 提示

**【样例解释 #1】**
$$
    \begin{array}{ccc}
      \color{Red}11111\qquad11111\\01\color{Red}1\color{black}10\qquad01\color{Red}1\color{black}10\\
      11\color{Red}1\color{black}11\qquad11\color{Red}1\color{black}11\\
      01\color{Red}1\color{black}10\qquad01\color{Red}1\color{black}10\\
      11111\qquad11\color{Red}1\color{black}11\\\\
      第\ 1\ 个\qquad第\ 2\ 个
    \end{array}
$$
除了以上两个「字母 T」，没有其他满足条件且合法的「字母 T」，故输出 $2$。

**【数据范围】**       
| 测试点编号 | $n,m\le$ | $a,b\le$ | $s\le$ | $x\le$ |
| :----------: | :----------: | :----------: | :----------: | :----------: |
| $1 \sim 4$ | $100$ | $100$ |$10^4$|$200$|
| $5 \sim 8$ | $500$ | $500$ |$2.5\times 10^5$|$10^4$|
| $9,10$ | $3\times 10^3$ | $0$ |$0$|$0$|
| $11\sim 13$ | $3\times 10^3$ |$3\times 10^3$|$0$|$6\times 10^3$|
| $14\sim 16$ | $3\times 10^3$ |$3\times 10^3$|$9\times 10^6$|$0$|
| $17\sim 20$ | $3\times 10^3$ |$3\times 10^3$|$9\times 10^6$|$6\times 10^3$|

对于 $100\%$ 的数据，满足 $1 \le n,m \le 3\times 10^3$，$0 \le a,b \le 3\times10^3$，$0 \le s \le 9\times10^6$，$\space0 \le x \le 6\times10^3$。




---

---
title: "出生点"
layout: "post"
diff: 普及+/提高
pid: P6692
tag: ['数学', '2020', 'O2优化', '容斥原理']
---
# 出生点
## 题目背景

小 L、小 W 和小 H 在一起van♂游戏。

~~由于小 L 太菜了所以导致他一直在看着小 W 和小 H 打游戏。~~
## 题目描述

这款游戏的地图可以抽象成一张有 $n$ 行 $m$ 列的网格图，网格图上有 $k$ 个障碍点，相邻两点间边长为 $1$。游戏开始时~~小 L~~、小 W 和小 H 会**各自**随机出生在一个点。当然，他们**不会出生在障碍点**。

~~经常开局死的~~小 L 看着小 W 和小 H 每次在地图上汇合时经过的路径，很想知道他们每次出生后两个人之间的期望距离。（这里的距离指两点间[曼哈顿距离](https://www.luogu.com.cn/blog/xuxing/Distance-Algorithm)，即 $\left|x_1-x_2\right|+\left|y_1-y_2\right|$）

由于小 L 可以非常容易算出有多少种出生点安排方案，所以你实际上**只需要告诉他所有情况中他们两人距离之和**。

**注意**：小 W 出生在点 $A$，小 H 出生在点 $B$，跟小 W 出生在点 $B$，小 H 出生在点 $A$，这两种情况**视作同一种情况**。
## 输入格式

第一行有三个整数 $n,m,k$，分别表示地图行数、列数以及障碍物点数。

接下来有 $k$ 行，第 $i$ 行有两个正整数 $x_i,y_i$，表示第 $i$ 个障碍物的位置。
## 输出格式

一个整数，表示**所有情况中小 W 和小 H 两人出生点距离之和**。

由于小 L 十分无聊，所以他让你将答案对 $10^9+7$ 取模。
## 样例

### 样例输入 #1
```
3 3 2
2 1
3 3

```
### 样例输出 #1
```
42
```
### 样例输入 #2
```
9 8 8
3 2
4 6
7 3
9 5
3 7
2 2
1 6
6 4

```
### 样例输出 #2
```
11552
```
## 提示

对于样例一，地图样式如下（其中蓝点为障碍点，红点为可能的出生点）：  
![](https://cdn.luogu.com.cn/upload/image_hosting/3bq78rx7.png)

+ 出生点为 $(1,1)$ 和 $(1,1)$，距离为 $0$。
+ 出生点为 $(1,1)$ 和 $(1,2)$，距离为 $1$。
+ 出生点为 $(1,1)$ 和 $(1,3)$，距离为 $2$。
+ 出生点为 $(1,1)$ 和 $(2,2)$，距离为 $2$。
+ 出生点为 $(1,1)$ 和 $(2,3)$，距离为 $3$。
+ 出生点为 $(1,1)$ 和 $(3,1)$，距离为 $2$。
+ 出生点为 $(1,1)$ 和 $(3,2)$，距离为 $3$。
+ 出生点为 $(1,2)$ 和 $(1,2)$，距离为 $0$。
+ 出生点为 $(1,2)$ 和 $(1,3)$，距离为 $1$。
+ 出生点为 $(1,2)$ 和 $(2,2)$，距离为 $1$。
+ 出生点为 $(1,2)$ 和 $(2,3)$，距离为 $2$。
+ 出生点为 $(1,2)$ 和 $(3,1)$，距离为 $3$。
+ 出生点为 $(1,2)$ 和 $(3,2)$，距离为 $2$。
+ 出生点为 $(1,3)$ 和 $(1,3)$，距离为 $0$。
+ 出生点为 $(1,3)$ 和 $(2,2)$，距离为 $2$。
+ 出生点为 $(1,3)$ 和 $(2,3)$，距离为 $1$。
+ 出生点为 $(1,3)$ 和 $(3,1)$，距离为 $4$。
+ 出生点为 $(1,3)$ 和 $(3,2)$，距离为 $3$。
+ 出生点为 $(2,2)$ 和 $(2,2)$，距离为 $0$。
+ 出生点为 $(2,2)$ 和 $(2,3)$，距离为 $1$。
+ 出生点为 $(2,2)$ 和 $(3,1)$，距离为 $2$。
+ 出生点为 $(2,2)$ 和 $(3,2)$，距离为 $1$。
+ 出生点为 $(2,3)$ 和 $(2,3)$，距离为 $0$。
+ 出生点为 $(2,3)$ 和 $(3,1)$，距离为 $3$。
+ 出生点为 $(2,3)$ 和 $(3,2)$，距离为 $2$。
+ 出生点为 $(3,1)$ 和 $(3,1)$，距离为 $0$。
+ 出生点为 $(3,1)$ 和 $(3,2)$，距离为 $1$。
+ 出生点为 $(3,2)$ 和 $(3,2)$，距离为 $0$。

总和为 $42$。

### 数据范围

**本题采用捆绑测试。**

+ Subtask 1( $10\%$ )：$n,m\leq 80$。
+ Subtask 2( $20\%$ )：$n,m\leq 5000$。
+ Subtask 3( $15\%$ )：$k=0$。
+ Subtask 4( $15\%$ )：$m=1$。
+ Subtask 5( $40\%$ )：无特殊限制。

对于 $100\%$ 的数据，$1\leq n,m\leq 10^9,1\leq x_i\leq n,1\leq y_i\leq m,0\leq k\leq 5\times 10^5,k<n\times m$，**保证所有障碍点各不相同**。


---

---
title: "[COCI 2015/2016 #6] PAROVI"
layout: "post"
diff: 普及+/提高
pid: P7800
tag: ['2015', '容斥原理', 'COCI（克罗地亚）']
---
# [COCI 2015/2016 #6] PAROVI
## 题目描述

$\text{Mirko}$ 和 $\text{Slavko}$ 在玩一个游戏，先由 $\text{Mirko}$ 在 $1\dots N$ 中选出几组互质的数。例如当 $N=5$ 时，$\text{Slavko}$ 可以选择 $\big\{\{1,2\},\{3,4\},\{2,5\},\{3,5\},\cdots\big\}$ 中的几组。

然后轮到 $\text{Slavko}$。他需要找到一个 $x\in \big[2,n\big]$ 使得对于每组 $\{a,b\}$ 都满足以下两个条件之一：

- $a$，$b<x$

- $a$，$b\ge x$

例如，如果 $\text{Mirko}$ 选了 $\big\{\{1,2\},\{3,4\}\big\}$，那么 $x$ 可以等于 $3$。

如果 $\text{Slavko}$ 找不到满足条件的 $x$ 值，则表示 $\text{Mirko}$ 获得胜利。现在请你求出 $\text{Mirko}$ 获胜的不同情况的总数，在对 $10^9$ 取模后告诉他。
## 输入格式

第一行包含一个整数 $N$。
## 输出格式

第一行输出一个整数，为 $\text{Mirko}$ 获胜的不同情况的总数对 $10^9$ 取模后的值。
## 样例

### 样例输入 #1
```
2
```
### 样例输出 #1
```
1
```
### 样例输入 #2
```
3
```
### 样例输出 #2
```
5
```
### 样例输入 #3
```
4
```
### 样例输出 #3
```
21
```
## 提示

**【样例 1 解释】**

$\text{Slavko}$ 只有一种取法 $\big\{\{1,2\}\big\}$。

**【样例 2 解释】**

$\text{Slavko}$ 的其中一种取法为 $\big\{\{1,2\},\{1,3\}\big\}$。

**【数据范围】**

对于 $100\%$ 的数据，$1\le N\le 20$。

**【题目来源】**

**题目译自 [COCI 2015-2016](https://hsin.hr/coci/archive/2015_2016/) [CONTEST #6](https://hsin.hr/coci/archive/2015_2016/contest6_tasks.pdf) T4 PAROVI**。

**本题分值按 COCI 原题设置，满分 $120$**。


---


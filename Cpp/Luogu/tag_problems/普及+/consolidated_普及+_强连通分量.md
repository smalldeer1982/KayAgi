---
title: "间谍网络"
layout: "post"
diff: 普及+/提高
pid: P1262
tag: ['图论', '强连通分量']
---
# 间谍网络
## 题目描述

由于外国间谍的大量渗入，国家安全正处于高度的危机之中。如果 A 间谍手中掌握着关于 B 间谍的犯罪证据，则称 A 可以揭发 B。有些间谍收受贿赂，只要给他们一定数量的美元，他们就愿意交出手中掌握的全部情报。所以，如果我们能够收买一些间谍的话，我们就可能控制间谍网中的每一分子。因为一旦我们逮捕了一个间谍，他手中掌握的情报都将归我们所有，这样就有可能逮捕新的间谍，掌握新的情报。

我们的反间谍机关提供了一份资料，包括所有已知的受贿的间谍，以及他们愿意收受的具体数额。同时我们还知道哪些间谍手中具体掌握了哪些间谍的资料。假设总共有 $n$ 个间谍（$n$ 不超过 $3000$），每个间谍分别用 $1$ 到 $3000$ 的整数来标识。

请根据这份资料，判断我们是否有可能控制全部的间谍，如果可以，求出我们所需要支付的最少资金。否则，输出不能被控制的一个间谍。
## 输入格式

第一行只有一个整数 $n$。

第二行是整数 $p$。表示愿意被收买的人数，$1\le p\le n$。

接下来的 $p$ 行，每行有两个整数，第一个数是一个愿意被收买的间谍的编号，第二个数表示他将会被收买的数额。这个数额不超过 $20000$。

紧跟着一行只有一个整数 $r$，$1\le r\le8000$。然后 $r$ 行，每行两个正整数，表示数对 $(A, B)$，$A$ 间谍掌握 $B$ 间谍的证据。
## 输出格式

如果可以控制所有间谍，第一行输出 `YES`，并在第二行输出所需要支付的贿金最小值。否则输出 `NO`，并在第二行输出不能控制的间谍中，编号最小的间谍编号。
## 样例

### 样例输入 #1
```
3
2
1 10
2 100
2
1 3
2 3

```
### 样例输出 #1
```
YES
110

```
### 样例输入 #2
```
4
2
1 100
4 200
2
1 2
3 4
```
### 样例输出 #2
```
NO
3

```


---

---
title: "[POI 2018 R2] 自行车道 Bike paths"
layout: "post"
diff: 普及+/提高
pid: P12760
tag: ['2018', 'POI（波兰）', '强连通分量', 'Tarjan']
---
# [POI 2018 R2] 自行车道 Bike paths
## 题目背景

翻译来自于 [LibreOJ](https://loj.ac/p/5068)。
## 题目描述

**题目译自 [XXV Olimpiada Informatyczna — II etap](https://sio2.mimuw.edu.pl/c/oi25-2/dashboard/) [Drogi rowerowe](https://szkopul.edu.pl/problemset/problem/aKKSmtjWTtDOEHDqnmQ3-eAA/statement/)**

拜托城国王 Bajtazar 倾听民意，决定将部分预算盈余用于修建自行车道。皇家道路顾问已设计了一套单向自行车道网络，连接各路口，但经国王要求进行了多次修改。网络由连接路口 $u$ 到 $v$ 的单向路段组成。从路口 $u$ 到 $v$ 的路径定义为任意一串不同路口序列 $u=v_0, v_1, \ldots, v_k=v$，其中每对连续路口 $v_i, v_{i+1}$ $(0 \leq i < k)$ 由从 $v_i$ 到 $v_{i+1}$ 的路段连接。

国王要求网络「公平」，即满足：若从路口 $v$ 无法到达路口 $u$（不存在从 $v$ 到 $u$ 的路径），则从 $u$ 到 $v$ 至多只有一条路径。国王认为，这能避免路口 $v$ 的居民嫉妒路口 $u$ 的居民。

市民自行车委员会获取了这一公平网络的设计，却对此不满，认为它不便于城市出行。他们需提交报告，急需确凿数据。你需计算网络的通达度，即对于每个路口 $v$，计算从 $v$ 可达的路口数量。
## 输入格式

第一行包含两个整数 $n, m$ $(n \geq 2, m \geq 1)$，分别表示拜托城的路口数量和路段数量，路口编号为 $1$ 至 $n$。

接下来的 $m$ 行描述网络，每行包含两个整数 $a, b$ $(1 \leq a, b \leq n, a \neq b)$，表示存在从路口 $a$ 到 $b$ 的单向路段。每对有序对 $(a, b)$ 至多出现一次，保证网络公平。
## 输出格式

输出 $n$ 行，第 $i$ 行包含一个整数，表示从路口 $i$ 可达的路口数量。
## 样例

### 样例输入 #1
```
7 7
1 4
1 6
4 2
6 2
2 1
5 3
3 7
```
### 样例输出 #1
```
3
3
1
3
2
3
0
```
## 提示

**样例 1 解释**

![](https://cdn.luogu.com.cn/upload/image_hosting/hvqu1a0f.png)

**附加样例**

1. $n=25, m=600$，每路口到其他路口均有路段。
2. $n=55, m=54$，含孤立路口及长度 $2$ 至 $10$ 的独立环。
3. $n=50000, m=49999$，所有路口在一条路径上。
4. $n=50000, m=50000$，所有路口在一个环上。

详细子任务附加限制及分值如下表所示。

| 子任务 | 附加限制 | 分值 |
| :---: | :--: | :---: |
| $1$    | $n \leq 60$              | $12$ |
| $2$    | $n, m \leq 5000$         | $8$  |
| $3$    | $n \leq 50000, m \leq 100000$，若 $u > v$，则无从 $u$ 到 $v$ 的路径 | $18$ |
| $4$    | $n \leq 50000, m \leq 100000$，若从 $u$ 可达 $v$，则 $v$ 不可达 $u$ | $18$ |
| $5$    | $n \leq 50000, m \leq 100000$ | $44$ |


---

---
title: "消息扩散"
layout: "post"
diff: 普及+/提高
pid: P2002
tag: ['图论', '洛谷原创', '强连通分量']
---
# 消息扩散
## 题目背景

本场比赛第一题，给个简单的吧，这 100 分先拿着。
## 题目描述

有 $n$ 个城市，中间有单向道路连接，消息会沿着道路扩散，现在给出 $n$ 个城市及其之间的道路，问至少需要在几个城市发布消息才能让这所有 $n$ 个城市都得到消息。
## 输入格式

第一行两个整数 $n, m$，表示 $n$ 个城市，$m$ 条单向道路。

以下 $m$ 行，每行两个整数 $b, e$ 表示有一条从 $b$ 到 $e$ 的道路，道路可以重复或存在自环。
## 输出格式

一行一个整数，表示至少要在几个城市中发布消息。
## 样例

### 样例输入 #1
```
5 4
1 2
2 1
2 3
5 1

```
### 样例输出 #1
```
2

```
## 提示

**【样例解释 #1】**

样例中在 $4, 5$ 号城市中发布消息。

**【数据范围】**

对于 $20 \%$ 的数据，$n \le 200$；  
对于 $40 \%$ 的数据，$n \le 2000$；  
对于 $100 \%$ 的数据，$1 \le n \le {10}^5$，$1 \le m \le 5 \times {10}^5$。


---

---
title: "正则表达式"
layout: "post"
diff: 普及+/提高
pid: P2169
tag: ['图论', '最短路', '强连通分量']
---
# 正则表达式
## 题目背景

小Z童鞋一日意外的看到小X写了一个正则表达式的高级程序，这个正则表达式程序仅仅由字符“0”,“1”，“.”和“\*”构成，但是他能够匹配出所有在OJ上都AC的程序的核心代码！小Z大为颇感好奇，于是他决定入侵小X的电脑上去获得这个正则表达式的高级程序。

## 题目描述

在 Internet 网络中的每台电脑并不是直接一对一连通的，而是某些电脑之间存在单向的网络连接，也就是说存在 $A$ 到 $B$ 的连接不一定存在 $B$ 到 $A$ 的连接，并且有些连接传输速度很快，有些则很慢，所以不同连接传输所花的时间是有大有小的。另外，如果存在 $A$ 到 $B$ 的连接的同时也存在 $B$ 到 $A$ 的连接的话，那么 $A$ 和 $B$ 实际上处于同一局域网内，可以通过本地传输，这样花费的传输时间为 $0$。

现在小 Z 告诉你整个网络的构成情况，他希望知道从他的电脑（编号为 $1$），到小 X 的电脑（编号为 $n$）所需要的最短传输时间。
## 输入格式

第一行两个整数 $n,m$，表示有 $n$ 台电脑，$m$ 个连接关系。

接下来 $m$ 行，每行三个整数 $u,v,w$，表示从电脑 $u$ 到电脑 $v$ 传输信息的时间为 $w$。
## 输出格式

输出文件仅一行为最短传输时间。

## 样例

### 样例输入 #1
```
3 2
1 2 1
2 3 1

```
### 样例输出 #1
```
2
```
### 样例输入 #2
```
5 5
1 2 1
2 3 6
3 4 1
4 2 1
3 5 2

```
### 样例输出 #2
```
3
```
## 提示

- 对于  $40\%$ 的数据，$1\leq n\leq 10^3$, $1\leq m\leq 10^4$；
- 对于  $70\%$ 的数据，$1\leq n\leq 5 \times 10^3$， $1\leq m\leq 10^5$；
- 对于  $100\%$ 的数据，$1\leq n\leq 2 \times 10^5$， $1\leq m\leq 10^6$。

保证答案在 `int` 范围内。


---

---
title: "[USACO03FALL / HAOI2006] 受欢迎的牛 G"
layout: "post"
diff: 普及+/提高
pid: P2341
tag: ['图论', '2003', '2006', '河南', 'USACO', '各省省选', '强连通分量', 'Tarjan', '栈']
---
# [USACO03FALL / HAOI2006] 受欢迎的牛 G
## 题目背景

本题测试数据已修复。
## 题目描述

每头奶牛都梦想成为牛棚里的明星。被所有奶牛喜欢的奶牛就是一头明星奶牛。所有奶牛都是自恋狂，每头奶牛总是喜欢自己的。奶牛之间的“喜欢”是可以传递的——如果 $A$ 喜欢 $B$，$B$ 喜欢 $C$，那么 $A$ 也喜欢 $C$。牛栏里共有 $N$ 头奶牛，给定一些奶牛之间的爱慕关系，请你算出有多少头奶牛可以当明星。
## 输入格式

第一行：两个用空格分开的整数：$N$ 和 $M$。

接下来 $M$ 行：每行两个用空格分开的整数：$A$ 和 $B$，表示 $A$ 喜欢 $B$。

## 输出格式

一行单独一个整数，表示明星奶牛的数量。

## 样例

### 样例输入 #1
```
3 3
1 2
2 1
2 3
```
### 样例输出 #1
```
1
```
## 提示

只有 $3$ 号奶牛可以做明星。

【数据范围】

对于 $10\%$ 的数据，$N\le20$，$M\le50$。

对于 $30\%$ 的数据，$N\le10^3$，$M\le2\times 10^4$。

对于 $70\%$ 的数据，$N\le5\times 10^3$，$M\le5\times 10^4$。

对于 $100\%$ 的数据，$1\le N\le10^4$，$1\le M\le5\times 10^4$。


---

---
title: "采蘑菇"
layout: "post"
diff: 普及+/提高
pid: P2656
tag: ['图论', '洛谷原创', '强连通分量']
---
# 采蘑菇
## 题目描述

小胖和 ZYR 要去 ESQMS 森林采蘑菇。

ESQMS 森林间有 $N$ 个小树丛，$M$ 条小径，每条小径都是单向的，连接两个小树丛，上面都有一定数量的蘑菇。小胖和 ZYR 经过某条小径一次，可以采走这条路上所有的蘑菇。由于 ESQMS 森林是一片神奇的沃土，所以一条路上的蘑菇被采过后，又会长出一些新的蘑菇，数量为原来蘑菇的数量乘上这条路的“恢复系数”，再下取整。

比如，一条路上有 $4$ 个蘑菇，这条路的“恢复系数”为 $0.7$，则第一~四次经过这条路径所能采到的蘑菇数量分别为 $4,2,1,0$。

现在，小胖和 ZYR 从 $S$ 号小树丛出发，求他们最多能采到多少蘑菇。

## 输入格式

第一行两个整数，$N$ 和 $M$。

第二行到第 $M+1$ 行，每行四个数，分别表示一条小路的起点，终点，初始蘑菇数，恢复系数。

第 $M+2$ 行，一个整数 $S$。

## 输出格式

一行一个整数，表示最多能采到多少蘑菇，保证答案不超过 $(2^{31}-1)$。

## 样例

### 样例输入 #1
```
3 3
1 2 4 0.5
1 3 7 0.1
2 3 4 0.6
1
```
### 样例输出 #1
```
8
```
## 提示

对于 $30\%$ 的数据，$N\le 7$，$M\le15$

另有 $30\%$ 的数据，满足所有“恢复系数”为 $0$。

对于 $100\%$ 的数据，$1
\le N\le 8\times 10^4$，$1\le M\le 2\times 10^5$，$0\le\text{恢复系数}\le 0.8$ 且最多有一位小数， $1\le S\le N$。


---

---
title: "[USACO5.3] 校园网Network of Schools"
layout: "post"
diff: 普及+/提高
pid: P2746
tag: ['2001', 'USACO', 'IOI', '强连通分量', 'Tarjan']
---
# [USACO5.3] 校园网Network of Schools
## 题目描述

一些学校连入一个电脑网络。那些学校已订立了协议：每个学校都会给其它的一些学校分发软件（称作“接受学校”）。注意即使 $B$ 在 $A$ 学校的分发列表中，$A$ 也不一定在 $B$ 学校的列表中。

你要写一个程序计算，根据协议，为了让网络中所有的学校都用上新软件，必须接受新软件副本的最少学校数目（子任务 A）。更进一步，我们想要确定通过给任意一个学校发送新软件，这个软件就会分发到网络中的所有学校。为了完成这个任务，我们可能必须扩展接收学校列表，使其加入新成员。计算最少需要增加几个扩展，使得不论我们给哪个学校发送新软件，它都会到达其余所有的学校（子任务 B）。一个扩展就是在一个学校的接收学校列表中引入一个新成员。
## 输入格式

输入文件的第一行包括一个正整数 $N$，表示网络中的学校数目。学校用前 $N$ 个正整数标识。

接下来 $N$ 行中每行都表示一个接收学校列表（分发列表），第 $i+1$ 行包括学校 $i$ 的接收学校的标识符。每个列表用 $0$ 结束，空列表只用一个 $0$ 表示。
## 输出格式

你的程序应该在输出文件中输出两行。

第一行应该包括一个正整数，表示子任务 A 的解。

第二行应该包括一个非负整数，表示子任务 B 的解。
## 样例

### 样例输入 #1
```
5
2 4 3 0
4 5 0
0
0
1 0
```
### 样例输出 #1
```
1
2
```
## 提示

$2 \le N \le 100$。

题目翻译来自NOCOW。

USACO Training Section 5.3



---

---
title: "刻录光盘"
layout: "post"
diff: 普及+/提高
pid: P2835
tag: ['图论', '并查集', '强连通分量']
---
# 刻录光盘
## 题目描述

在JSOI2005夏令营快要结束的时候，很多营员提出来要把整个夏令营期间的资料刻录成一张光盘给大家，以便大家回去后继续学习。组委会觉得这个主意不错！可是组委会一时没有足够的空光盘，没法保证每个人都能拿到刻录上资料的光盘，又来不及去买了，怎么办呢？！

组委会把这个难题交给了LHC，LHC分析了一下所有营员的地域关系，发现有些营员是一个城市的，其实他们只需要一张就可以了，因为一个人拿到光盘后，其他人可以带着U盘之类的东西去拷贝啊！

可是，LHC调查后发现，由于种种原因，有些营员并不是那么的合作，他们愿意某一些人到他那儿拷贝资料，当然也可能不愿意让另外一些人到他那儿拷贝资料，这与我们JSOI宣扬的团队合作精神格格不入！！！

现在假设总共有N个营员（2<=N<=200），每个营员的编号为1~N。LHC给每个人发了一张调查表，让每个营员填上自己愿意让哪些人到他那儿拷贝资料。当然，如果A愿意把资料拷贝给B，而B又愿意把资料拷贝给C，则一旦A获得了资料，则B，C都会获得资料。

现在，请你编写一个程序，根据回收上来的调查表，帮助LHC计算出组委会至少要刻录多少张光盘，才能保证所有营员回去后都能得到夏令营资料？

## 输入格式

先是一个数N，接下来的N行，分别表示各个营员愿意把自己获得的资料拷贝给其他哪些营员。即输入数据的第i+1行表示第i个营员愿意把资料拷贝给那些营员的编号，以一个0结束。如果一个营员不愿意拷贝资料给任何人，则相应的行只有1个0，一行中的若干数之间用一个空格隔开。

## 输出格式

一个正整数，表示最少要刻录的光盘数。

## 样例

### 样例输入 #1
```
5
2 3 4 0
4 5 0
0
0
1 0
```
### 样例输出 #1
```
1
```


---

---
title: "[USACO06JAN] The Cow Prom S"
layout: "post"
diff: 普及+/提高
pid: P2863
tag: ['2006', 'USACO', '强连通分量', 'Tarjan']
---
# [USACO06JAN] The Cow Prom S
## 题目描述

有一个 $n$ 个点，$m$ 条边的有向图，请求出这个图点数大于 $1$ 的强连通分量个数。
## 输入格式

第一行为两个整数 $n$ 和 $m$。

第二行至 $m+1$ 行，每一行有两个整数 $a$ 和 $b$，表示有一条从 $a$ 到 $b$ 的有向边。
## 输出格式

仅一行，表示点数大于 $1$ 的强连通分量个数。
## 样例

### 样例输入 #1
```
5 4
2 4
3 5
1 2
4 1
```
### 样例输出 #1
```
1
```
## 提示

#### 数据规模与约定

对于全部的测试点，保证 $2\le n \le 10^4$，$2\le m\le 5\times 10^4$，$1 \leq a, b \leq n$。


---

---
title: "[COCI 2006/2007 #3] BICIKLI"
layout: "post"
diff: 普及+/提高
pid: P4645
tag: ['2006', '广度优先搜索 BFS', '强连通分量', 'COCI（克罗地亚）']
---
# [COCI 2006/2007 #3] BICIKLI
## 题目背景

一场自行车比赛将要在一个遥远的地方上举行。
## 题目描述

这个地方有 $n$ 个城镇，从 $1\sim n$ 编号，其中有 $m$ 条**单向**道路连接它们。比赛将在 $1$ 号城镇开始并在 $2$ 号城镇结束。

主办方想知道，一共有多少条不同的路线？
## 输入格式

输入第一行为两个整数 $n,m$，意义如题目描述所示。

接下来的 $m$ 行，每行两个整数 $a,b$，描述一条从 $a$ 到 $b$ 的道路。

两个城镇间可以有多条道路。
## 输出格式

输出不同的路线的数量。

如果有无数条不同的路线，则输出 `inf`。

否则输出路线数对 $10^9$ 取模的结果。
## 样例

### 样例输入 #1
```
6 7
1 3
1 4
3 2
4 2
5 6
6 5
3 4
```
### 样例输出 #1
```
3
```
### 样例输入 #2
```
6 8
1 3
1 4
3 2
4 2
5 6
6 5
3 4
4 3
```
### 样例输出 #2
```
inf
```
## 提示

#### 数据规模与约定

对于 $100\%$ 的数据，$1\le n\leq 5\times 10 ^ 4$，$1\leq m\le 10^5$。

#### 说明

**题目译自 [COCI2006-2007](https://hsin.hr/coci/archive/2006_2007/) [CONTEST #3](https://hsin.hr/coci/archive/2006_2007/contest3_tasks.pdf) *T5 BICIKLI***

感谢 @[ShineEternal](https://www.luogu.com.cn/user/45475) 提供的翻译。


---

---
title: "[USACO22OPEN] Visits S"
layout: "post"
diff: 普及+/提高
pid: P8269
tag: ['USACO', '2022', '拓扑排序', '连通块', '强连通分量', '基环树']
---
# [USACO22OPEN] Visits S
## 题目描述

Bessie 的 $N$（$2\le N\le 10^5$）个奶牛伙伴（编号为 $1\cdots N$）每一个都拥有自己的农场。对于每个 $1\le i\le N$，伙伴 i 想要访问伙伴 $a_i$（$a_i\neq i$）。

给定 $1\ldots N$ 的一个排列 $(p_1,p_2,\ldots, p_N)$，访问按以下方式发生。

对于 $1$ 到 $N$ 的每一个 $i$：

- 如果伙伴 $a_{p_i}$ 已经离开了她的农场，则伙伴 $p_i$ 仍然留在她的农场。
- 否则，伙伴 $p_i$ 离开她的农场去访问伙伴 $a_{p_i}$ 的农场。这次访问会产生快乐的哞叫 $v_{p_i}$ 次（$0\le v_{p_i}\le 10^9$）。


对于所有可能的排列 $p$，计算所有访问结束后可能得到的最大哞叫次数。
## 输入格式

输入的第一行包含 $N$。

对于每一个 $1\le i\le N$，第 $i+1$ 行包含两个空格分隔的整数 $a_i$ 和 $v_i$。
## 输出格式

输出一个整数，为所求的答案。

**注意这个问题涉及到的整数可能需要使用 64 位整数型（例如，C/C++ 中的 "long long"）。**
## 样例

### 样例输入 #1
```
4
2 10
3 20
4 30
1 40
```
### 样例输出 #1
```
90
```
## 提示

【样例解释】


如果 $p=(1,4,3,2)$，则

- 伙伴 $1$ 访问伙伴 $2$ 的农场，产生 $10$ 次哞叫。
- 伙伴 $4$ 看到伙伴 $1$ 已经离开了农场，所以无事发生。
- 伙伴 $3$ 访问伙伴 $4$ 的农场，又产生 $30$ 次哞叫。
- 伙伴 $2$ 看到伙伴 $3$ 已经离开了农场，所以无事发生。

这样总计得到了 $10+30=40$ 次哞叫。

另一方面，如果 $p=(2,3,4,1)$，则

- 伙伴 $2$ 访问伙伴 $3$ 的农场，产生 $20$ 次哞叫。
- 伙伴 $3$ 访问伙伴 $4$ 的农场，产生 $30$ 次哞叫。
- 伙伴 $4$ 访问伙伴 $1$ 的农场，产生 $40$ 次哞叫。
- 伙伴 $1$ 看到伙伴 $2$ 已经离开了农场，所以无事发生。

这样总计得到了 $20+30+40=90$ 次哞叫。可以证明这是所有可能的排列 $p$ 中访问结束后得到的最大可能的哞叫次数。


---

---
title: "[NAPC-#1] Stage3 - Jump Refreshers"
layout: "post"
diff: 普及+/提高
pid: P9431
tag: ['O2优化', '强连通分量', 'Tarjan']
---
# [NAPC-#1] Stage3 - Jump Refreshers
## 题目背景

> ![](https://cdn.luogu.com.cn/upload/image_hosting/wkktxonu.png)
## 题目描述

**注意本题中 kid 的移动方式与 iw 游戏中不同（）。**

kid 面前有一个无穷大的竖直二维平面。坐标系 $x$ 轴正方向为从左到右，$y$ 轴正方向为从下到上。

地图（该平面）内有 $n$ 个**位置互不相同**的**可以无限重复使用**的跳跃球。当 kid 正好位于某跳跃球位置时，他可以让 shift 键按下，然后他会瞬间上升 $d$ 格（此期间不能左右移动）。他每秒往下坠落 $1$ 格，同时每秒 kid 可以选择：向左或向右移动 1 格，或者不移动。当 kid 不在跳跃球上时他不能起跳。

![](https://cdn.luogu.com.cn/upload/image_hosting/1abzjhjs.png)

上图是一个例子，蓝色区域表示 kid 在跳跃球（箭头）处起跳（$d=2$）后可以达到的区域。**kid 每秒时的横纵坐标只能是整数，即：我们认为他不能达到非整点位置。**

现在，kid 把存档放在了第 $c$ 个跳跃球处（即起点是第 $c$ 个跳跃球处；此时可以立即起跳）。定义 kid 的得分为他经过（即在某处起跳：显然起跳之后可以回到原位置）的**不同**跳跃球的个数。kid 想知道他可以最多获得多少得分（**不需要**（但可以）**回到起点**），请你告诉他吧。

再次提醒：**跳跃球可以无限重复使用，即 kid 可以在某个跳跃球上无限起跳。**
## 输入格式

**本题单测试点内有多组数据。**

第一行仅两个整数 $T,id$ 表示测试数据的数量和测试点编号。特别地，样例的 $id=0$。

对于每组测试数据：

第一行三个正整数 $n,d,c$ 含义如上所述。

后 $n$ 行每行两个正整数 $x_i,y_i$ 表示第 $i$ 个跳跃球的位置。
## 输出格式

对于每组测试数据输出一行一个正整数表示最大得分。
## 样例

### 样例输入 #1
```
4 0
4 2 1
2 4
1 1
5 2
4 1
5 3 4
1 7
2 4
3 2
4 5
8 2
4 1 2
1 1
1 2
1 3
4 1
4 2 1
1 1
4 1
1 4
4 4
```
### 样例输出 #1
```
3
4
4
1
```
## 提示

### 【数据范围】

**本题采用捆绑测试。**
$$
\def\r{\cr\hline}
\def\None{\text{None}}
\def\arraystretch{1.5}
\begin{array}{c|c|c|c}
\textbf{Subtask} & id= & \textbf{Sp. Constraints} & \textbf{Score}\r
\textsf1& 1\sim3,36 & n\leqslant10,T\leqslant10 & 10 \r
\textsf2& 4\sim7 & \sum n\leqslant200 & 15 \r
\textsf3& 8\sim13 & \mathbf A & 25 \r
\textsf4& 14\sim18 & \mathbf B & 10 \r
\textsf5& 19\sim35 & - & 40 \r
\end{array}
$$
其中 $\sum n$ 表示单测试点内所有 $n$ 的总和。

$id=1\sim3,36$ 表示 $id\in\{1,2,3,36\}$。
- 特殊性质 $\mathbf A$：保证对于任意不同跳跃球 $u,v$，如果 kid 理论上能从 $u$ 跳到 $v$（理论上：不考虑 kid 能否从起点到达 $u$ 的问题，下同），那么他理论上**一定不可以**从 $v$ 跳到 $u$。
- 特殊性质 $\mathbf B$：保证对于任意跳跃球 $u,v$，如果 kid 理论上能从 $u$ 跳到 $v$，那么他理论上**一定可以**从 $v$ 跳到 $u$。

注意上面的“从 $u$ 跳到 $v$"不一定非得一跳到位。比如样例 #1-2 中可以从第 $3$ 个跳到第 $5$ 个：$3\to2\to4\to5$。

对于 $100\%$ 的数据，$1\leqslant T\leqslant 1000$，$1\leqslant n\leqslant 3000$，$\sum n\leqslant 3000$，$1\leqslant d\leqslant 10^9$，$1\leqslant c\leqslant n$，$1\leqslant x_i,y_i\leqslant10^6$，$(x_i,y_i)$ 互不相同。

---
#### 【样例解释 #1-1】
![](https://cdn.luogu.com.cn/upload/image_hosting/zpc7sm2i.png)

$d=2$，容易发现离开初始位置就上不去了。所以 kid 要么往左边碰第 $2$ 个跳跃球，得分为 $2$；要么往右边跳，经过第 $3$ 和第 $4$ 个跳跃球，得分为 $3$。
#### 【样例解释 #1-2】
![](https://cdn.luogu.com.cn/upload/image_hosting/q8ks8qb4.png)

$d=3$，kid 可以先往下走一圈（$4\to3\to2\to4$）跳回起点，然后往右去碰第 $5$ 个球。左上角的第 $1$ 个跳跃球是碰不到的。
#### 【样例解释 #1-3】
![](https://cdn.luogu.com.cn/upload/image_hosting/akghkpe9.png)

通过最上面那个球是可以跳到右边的。
#### 【样例解释 #1-4】
![](https://cdn.luogu.com.cn/upload/image_hosting/50smzomm.png)

有 的 人 。


---


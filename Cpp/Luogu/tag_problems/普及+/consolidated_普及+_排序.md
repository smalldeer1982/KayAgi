---
title: "「Cfz Round 3」Mex of Sequence"
layout: "post"
diff: 普及+/提高
pid: P10032
tag: ['模拟', '洛谷原创', 'O2优化', '排序', '其它技巧', '洛谷月赛', 'Ad-hoc']
---
# 「Cfz Round 3」Mex of Sequence
## 题目描述

**请注意本题特殊的时间限制。**

给定一个长度为 $n$ 的序列 $a$ 和一个整数 $m$。

我们定义一次操作为，**同时**将序列 $a$ 中的**每个**元素 $a_i$ 替换为序列 $a$ 中除 $a_i$ 以外的所有元素的 $\operatorname{mex}$。

你需要求出进行 $m$ 次操作后的序列 $a$。

其中，一个序列的 $\operatorname{mex}$ 为该序列中**未出现过的最小自然数**，例如：

- $\operatorname{mex}\{1,2,3\}=0$；
- $\operatorname{mex}\{0\}=1$；
- $\operatorname{mex}\{1,0,2,4\}=3$；
- $\operatorname{mex}\{2,1,3,0,2\}=4$。

特别地，当序列为空时，该序列的 $\operatorname{mex}$ 为 $0$。 
## 输入格式

**本题有多组测试数据。**

第一行输入一个整数 $T$，表示测试数据组数。

接下来依次输入每组测试数据。对于每组测试数据：

- 第一行输入两个整数 $n,m$。
- 第二行输入 $n$ 个整数，表示给定的序列 $a$。
## 输出格式

对于每组测试数据，输出一行，包含用空格分隔的 $n$ 个整数，表示进行 $m$ 次操作后的序列 $a$。
## 样例

### 样例输入 #1
```
3
4 1
1 0 1 2
4 5
9 9 6 1
3 5
1 3 0
```
### 样例输出 #1
```
3 0 3 2
0 0 0 0
1 2 0
```
## 提示

#### 「样例解释 #1」

对于第 $1$ 组数据，因为 $\operatorname{mex}\{0,1,2\}=3$，$\operatorname{mex}\{1,1,2\}=0$，$\operatorname{mex}\{1,0,2\}=3$，$\operatorname{mex}\{1,0,1\}=2$，所以进行 $1$ 次操作后的序列 $a$ 为 $\{3,0,3,2\}$。

#### 「数据范围」

设 $\sum n$ 表示单个测试点中 $n$ 的和。

对于所有数据，$1 \le T \le 1000$，$1 \le n \le 10^6$，$1 \le m \le 10^9$，$0 \le a_i \le 10^9$，$\sum n \le 10^6$。

**只有你通过本题的所有测试点，你才能获得本题的分数。**


---

---
title: "[ROIR 2022] 分数排序 (Day 2)"
layout: "post"
diff: 普及+/提高
pid: P10091
tag: ['数学', '二分', '2022', 'Special Judge', '排序', '其它技巧', 'ROIR（俄罗斯）']
---
# [ROIR 2022] 分数排序 (Day 2)
## 题目背景

翻译自 [ROIR 2022 D2T2](https://neerc.ifmo.ru/school/archive/2021-2022/ru-olymp-regional-2022-day2.pdf)。
## 题目描述

有两个由 $n$ 个不同整数组成的序列 $A = [a_1, a_2, \dots , a_n]$ 和 $B = [b_1, b_2, \dots , b_n]$。将它们组合成 $n^2$ 个分数，形式为 $\frac{a_i}{b_j}$，并将每个分数约分后按递增顺序排序。

给定一个数字 $q$ 和 $q$ 个整数 $c_1, c_2, \dots , c_q$。对于每个 $c_i$，请输出上面所说的 $n^2$ 个分数中第 $c_i$ 小的分数。
## 输入格式

第一行包含两个整数 $n$ 和 $q$。

第二行包含 $n$ 个不同的整数 $a_1, a_2, \dots, a_n$。

第三行包含 $n$ 个不同的整数 $b_1, b_2, \dots, b_n$。

第四行包含 $q$ 个不同的整数 $c_1, c_2, \dots, c_q$。
## 输出格式

输出 $q$ 行。第 $i$ 行输出按递增顺序得到的第 $c_i$ 个分数。分数 $\frac{p}{q}$ 应以 `p q` 的格式输出，并且应为最简分数。
## 样例

### 样例输入 #1
```
4 8
3 4 1 2
2 3 4 5
1 16 2 4 5 6 10 15
```
### 样例输出 #1
```
1 5
2 1
1 4
2 5
1 2
1 2
4 5
3 2
```
## 提示

在样例中，初始的分数列表如下：

$$
\left[
\frac{3}{2},
\frac{3}{3},
\frac{3}{4},
\frac{3}{5},
\frac{4}{2},
\frac{4}{3},
\frac{4}{4},
\frac{4}{5},
\frac{1}{2},
\frac{1}{3},
\frac{1}{4},
\frac{1}{5},
\frac{2}{2},
\frac{2}{3},
\frac{2}{4},
\frac{2}{5}
\right],
$$

经过约分后，得到：

$$
\left[
\frac{3}{2},
\frac{1}{1},
\frac{3}{4},
\frac{3}{5},
\frac{2}{1},
\frac{4}{3},
\frac{1}{1},
\frac{4}{5},
\frac{1}{2},
\frac{1}{3},
\frac{1}{4},
\frac{1}{5},
\frac{1}{1},
\frac{2}{3},
\frac{1}{2},
\frac{2}{5}
\right],
$$

最后按递增顺序排序，得到：

$$
\left[
\frac{1}{5},
\frac{1}{4},
\frac{1}{3},
\frac{2}{5},
\frac{1}{2},
\frac{1}{2},
\frac{3}{5},
\frac{2}{3},
\frac{3}{4},
\frac{4}{5},
\frac{1}{1},
\frac{1}{1},
\frac{1}{1},
\frac{4}{3},
\frac{3}{2},
\frac{2}{1}
\right].
$$

本题使用捆绑测试。

| 子任务 | 分值 | 特殊性质 |
| :----------: | :----------: | :----------: |
| $1$ | $14$ | $n\le50$ |
| $2$ | $13$ | $n\le500$ |
| $3$ | $15$ | $q,c_i\le100$ |
| $4$ | $21$ | $c_i\le10^5$ |
| $5$ | $37$ |  |

对于 $100\%$ 的数据，$1 \leq n \leq 10^5$，$1 \leq q \leq 10^5$ 且 $q \leq n^2,n\times q\le10^5$（所以实际上 $q\le1000\sqrt[3]{10}\approx2154$），$1 \leq a_i,b_i \leq 10^6$，$1 \leq c_i \leq n^2$。


---

---
title: "[USACO24JAN] Cowmpetency S"
layout: "post"
diff: 普及+/提高
pid: P10134
tag: ['贪心', '线段树', 'USACO', '2024', '排序']
---
# [USACO24JAN] Cowmpetency S
## 题目描述

Farmer John 正在为他的奶牛们雇用一位新的牛群领队。为此，他面试了 $N$（$2\le N\le 10^5$）头奶牛来担任该职位。在面试第 $i$ 个候选牛后，他会为候选牛分配一个 $1$ 到 $C$（$1\le C\le 10^9$）范围内的整数「牲任力」分数 $c_i$，与她们的领导能力相关。

由于 Farmer John 面试了如此多的奶牛，他没能记得所有奶牛的牲任力分数。然而，他确实记得 $Q$（$1\le Q<N$）对数字 $(a_j,h_j)$，其中奶牛 $h_j$ 是第一头比奶牛 $1$ 到 $a_j$ 拥有严格更高牲任力分数的奶牛（所以 $1\le a_j<h_j\le N$）。

Farmer John 现在告诉你序列 $c_1,\ldots,c_N$
（其中 $c_i=0$ 表示他忘记了奶牛 $i$ 的牲任力分数）和 $Q$ 对 $(a_j,h_j)$。帮助他求出与此信息一致的最小字典序的牲任力分数序列，或者判断不存在这样的序列！如果一个分数序列比另一个分数序列于这两个序列不同的第一个位置上的奶牛分配了更小的分数，则这个分数序列的字典序更小。

每个测试点包含 $T$（$1\le T\le 20$）个独立的测试用例。输入保证所有测试用例的 $N$ 之和不超过 $3\cdot 10^5$。 
## 输入格式

输入的第一行包含 $T$，独立的测试用例的数量。每个测试用例描述如下：

 1. 第一行包含 $N$，$Q$ 和 $C$。
 2. 第二行包含序列 $c_1,\ldots,c_N$（$0\le c_i\le C$）。
 3. 最后 $Q$ 行，每行包含一个数对 $(a_j,h_j)$。输入保证同一测试用例内的所有 $a_j$ 各不相同。
## 输出格式

 对于每个测试用例，输出一行，包含与 Farmer John 记忆一致的最小字典序牲任力分数序列，或者如果这样的序列不存在时输出 $−1$。
## 样例

### 样例输入 #1
```
1
7 3 5
1 0 2 3 0 4 0
1 2
3 4
4 5
```
### 样例输出 #1
```
1 2 2 3 4 4 1
```
### 样例输入 #2
```
5
7 6 10
0 0 0 0 0 0 0
1 2
2 3
3 4
4 5
5 6
6 7
8 4 9
0 0 0 0 1 6 0 6
1 3
6 7
4 7
2 3
2 1 1
0 0
1 2
10 4 10
1 2 0 2 1 5 8 6 0 3
4 7
1 2
5 7
3 7
10 2 8
1 0 0 0 0 5 7 0 0 0
4 6
6 9
```
### 样例输出 #2
```
1 2 3 4 5 6 7
1 1 2 6 1 6 7 6
-1
1 2 5 2 1 5 8 6 1 3
-1
```
## 提示

### 样例解释 1

我们可以看到给定的输出满足所有 Farmer John 记得的数对。

- $\max(c_1)=1$，$c_2=2$ 且 $1<2$，故第一个数对是满足的
- $\max(c_1,c_2,c_3)=2$，$c_4=3$ 且 $2<3$，故第二个数对是满足的
- $\max(c_1,c_2,c_3,c_4)=3$，$c_5=4$ 且 $3<4$，故第三个数对是满足的

存在一些其他的序列与 Farmer John 的记忆相一致，如

$1\ 2\ 2\ 3\ 5\ 4\ 1$  
$1\ 2\ 2\ 3\ 4\ 4\ 5$

然而，其中没有序列比给定的输出字典序更小。 

### 样例解释 2

在测试用例 $3$ 中，由于 $C=1$，唯一可能的序列是

$1\ 1$

然而，在这种情况下，奶牛 $2$ 的分数并不比奶牛 $1$ 高，因此我们无法满足条件。

在测试用例 $5$ 中，$a_1$ 和 $h_1$ 告诉我们奶牛 $6$ 是第一头分数严格高于奶牛 $1$ 到 $4$ 的奶牛。因此，奶牛 $1$ 到 $6$ 的最高得分是奶牛 $6$，为 $5$。由于奶牛 $7$ 的分数为 $7$，所以奶牛 $7$ 是第一头比奶牛 $1$ 到 $6$ 得分更高的奶牛。因此，第二个陈述「奶牛 $9$ 是第一头比奶牛 $1$ 到 $6$ 得分更高的奶牛」不能成立。 

### 测试点性质

 - 测试点 $3$：$N \le 10$ 且 $Q,C\le 4$。
 - 测试点 $4-8$：$N\le 1000$。
 - 测试点 $9-12$：没有额外限制。


---

---
title: "[NOIP 2003 提高组] 神经网络"
layout: "post"
diff: 普及+/提高
pid: P1038
tag: ['图论', '2003', 'NOIP 提高组', '拓扑排序']
---
# [NOIP 2003 提高组] 神经网络
## 题目背景

人工神经网络（Artificial Neural Network）是一种新兴的具有自我学习能力的计算系统，在模式识别、函数逼近及贷款风险评估等诸多领域有广泛的应用。对神经网络的研究一直是当今的热门方向，兰兰同学在自学了一本神经网络的入门书籍后，提出了一个简化模型，他希望你能帮助他用程序检验这个神经网络模型的实用性。


## 题目描述

在兰兰的模型中，神经网络就是一张有向图，图中的节点称为神经元，而且两个神经元之间至多有一条边相连，下图是一个神经元的例子：

![](https://cdn.luogu.com.cn/upload/image_hosting/61qm40kj.png)

神经元（编号为 $i$）


图中，$X_1 \sim X_3$ 是信息输入渠道，$Y_1 \sim Y_2$ 是信息输出渠道，$C_i$ 表示神经元目前的状态，$U_i$ 是阈值，可视为神经元的一个内在参数。

神经元按一定的顺序排列，构成整个神经网络。在兰兰的模型之中，神经网络中的神经元分为几层；称为输入层、输出层，和若干个中间层。每层神经元只向下一层的神经元输出信息，只从上一层神经元接受信息。下图是一个简单的三层神经网络的例子。

![](https://cdn.luogu.com.cn/upload/image_hosting/4xd7f8yz.png)

兰兰规定，$C_i$ 服从公式：（其中 $n$ 是网络中所有神经元的数目）

$$C_i=\left(\sum\limits_{(j,i) \in E} W_{ji}C_{j}\right)-U_{i}$$

公式中的 $W_{ji}$（可能为负值）表示连接 $j$ 号神经元和 $i$ 号神经元的边的权值。当 $C_i$ 大于 $0$ 时，该神经元处于兴奋状态，否则就处于平静状态。当神经元处于兴奋状态时，下一秒它会向其他神经元传送信号，信号的强度为 $C_i$。

如此．在输入层神经元被激发之后，整个网络系统就在信息传输的推动下进行运作。现在，给定一个神经网络，及当前输入层神经元的状态（$C_i$），要求你的程序运算出最后网络输出层的状态。


## 输入格式

输入文件第一行是两个整数 $n$（$1 \le n \le 100$）和 $p$。接下来 $n$ 行，每行 $2$ 个整数，第 $i+1$ 行是神经元 $i$ 最初状态和其阈值（$U_i$），非输入层的神经元开始时状态必然为 $0$。再下面 $p$ 行，每行有两个整数 $i,j$ 及一个整数 $W_{ij}$，表示连接神经元 $i,j$ 的边权值为 $W_{ij}$。

## 输出格式

输出文件包含若干行，每行有 $2$ 个整数，分别对应一个神经元的编号，及其最后的状态，$2$ 个整数间以空格分隔。仅输出最后状态大于 $0$ 的输出层神经元状态，并且按照编号由小到大顺序输出。

若输出层的神经元最后状态均小于等于 $0$，则输出 `NULL`。

## 样例

### 样例输入 #1
```
5 6
1 0
1 0
0 1
0 1
0 1
1 3 1
1 4 1
1 5 1
2 3 1
2 4 1
2 5 1

```
### 样例输出 #1
```
3 1
4 1
5 1

```
## 提示

**【题目来源】**

NOIP 2003 提高组第一题


---

---
title: "奇数码问题"
layout: "post"
diff: 普及+/提高
pid: P10454
tag: ['树状数组', '排序']
---
# 奇数码问题
## 题目描述

你一定玩过八数码游戏，它实际上是在一个 $3 \times 3$ 的网格中进行的，$1$ 个空格和 $1 \sim 8$ 这 $8$ 个数字恰好不重不漏地分布在这 $3 \times 3$ 的网格中。

例如：

    5 2 8
    1 3 _
    4 6 7
    

在游戏过程中，可以把空格与其上、下、左、右四个方向之一的数字交换（如果存在）。

例如在上例中，空格可与左、上、下面的数字交换，分别变成：

    5 2 8       5 2 _      5 2 8
    1 _ 3       1 3 8      1 3 7
    4 6 7       4 6 7      4 6 _
    

奇数码游戏是它的一个扩展，在一个 $n \times n$ 的网格中进行，其中 $n$ 为奇数，$1$ 个空格和 $1 \sim n^2-1$ 这 $n^2-1$ 个数恰好不重不漏地分布在 $n \times n$ 的网格中。

空格移动的规则与八数码游戏相同，实际上，八数码就是一个 $n=3$ 的奇数码游戏。

现在给定两个奇数码游戏的局面，请判断是否存在一种移动空格的方式，使得其中一个局面可以变化到另一个局面。
## 输入格式

多组数据，对于每组数据：

第 $1$ 行输入一个整数 $n$，$n$ 为奇数。

接下来 $n$ 行每行 $n$ 个整数，表示第一个局面。

再接下来 $n$ 行每行 $n$ 个整数，表示第二个局面。

局面中每个整数都是 $0 \sim n^2-1$ 之一，其中用 $0$ 代表空格，其余数值与奇数码游戏中的意义相同，保证这些整数的分布不重不漏。
## 输出格式

对于每组数据，若两个局面可达，输出 `TAK`，否则输出 `NIE`。

## 样例

### 样例输入 #1
```
3
1 2 3
0 4 6
7 5 8
1 2 3
4 5 6
7 8 0
1
0
0
```
### 样例输出 #1
```
TAK
TAK
```
## 提示

$1 \le n < 500$


---

---
title: "后缀数组"
layout: "post"
diff: 普及+/提高
pid: P10469
tag: ['二分', '排序', '哈希 hashing']
---
# 后缀数组
## 题目描述

后缀数组 (SA) 是一种重要的数据结构，通常使用倍增或者 DC3 算法实现，这超出了我们的讨论范围。

在本题中，我们希望使用快排、Hash 与二分实现一个简单的 $O(n\log^2n)$ 的后缀数组求法。

详细地说，给定一个长度为 $n$ 的字符串 $S$（下标 $0 \sim n-1$），我们可以用整数 $k(0 \le k < n)$ 表示字符串 $S$ 的后缀 $S(k \sim n-1)$。

把字符串 $S$ 的所有后缀按照字典序排列，排名为 $i$ 的后缀记为 SA[i]。

额外地，我们考虑排名为 $i$ 的后缀与排名为 $i-1$ 的后缀，把二者的最长公共前缀的长度记为 Height[i]。

我们的任务就是求出 SA 与 Height 这两个数组。
## 输入格式

输入一个字符串，其长度不超过 $30$ 万。

字符串由小写字母构成。
## 输出格式

第一行为数组 SA，相邻两个整数用 $1$ 个空格隔开。

第二行为数组 Height，相邻两个整数用 $1$ 个空格隔开，我们规定 Height[1]=0。
## 样例

### 样例输入 #1
```
ponoiiipoi
```
### 样例输出 #1
```
9 4 5 6 2 8 3 1 7 0
0 1 2 1 0 0 2 1 0 2
```


---

---
title: "【MX-J1-T4】『FLA - III』Wrestle"
layout: "post"
diff: 普及+/提高
pid: P10784
tag: ['动态规划 DP', '二分', 'O2优化', '排序', '背包 DP', '前缀和', '双指针 two-pointer', '梦熊比赛']
---
# 【MX-J1-T4】『FLA - III』Wrestle
## 题目背景

原题链接：<https://oier.team/problems/J1D>。

---

在 2022 年末，疫情将西北某不知名知名学校的大多数学生关在家中上网课，安同学还不知道，他和语文老师的对决已然悄无声息地开始了——他每天早读和语文课都直接睡过去了。

安同学习惯起来穿好衣服、面对摄像头睡觉，摄像头只能拍到他的半个肩膀，就算被强制打开也不会暴露他在睡觉的事实，而且从来没有老师强制打开他的摄像头。而这个不凡的早晨，语文老师打开了他的摄像头，现在是早读时间，他在朦胧中被老师的关爱声叫醒，可惜为时已晚，老师已经愤怒。安同学决定假装网络卡顿，平复老师愤怒的心情。

老师，愤怒了！在安同学醒来后的某些时间段，她要呼叫他的真名，其余时间等他应答。与此同时安同学要打造网卡的假象，他可以在某些时间段内检查设备或者呼叫老师，其余时间静止或随机在画面中闪现，他在这些时间段内的行为称为表演。你的任务是帮助安同学在不激怒老师的情况下最大化表演时间。

因为安同学实在是太抽象了，原始题面受他影响变得也很抽象，这里只有形式化题面给你看。
## 题目描述

给定三个正整数 $n,m,k$ 和两组线段。第一组线段有权值，共 $n$ 条，是**红色**的；第二组线段没有权值，共 $m$ 条，是**蓝色**的。这些线段位于同一个数轴。

- 使用 $l,r,w$ 三个正整数表示一条从数轴上第 $l$ 个整点覆盖到第 $r$ 个整点，权值为 $w$ 的红色线段。**保证数轴上任意一个整点至多被红色线段覆盖一次。**

- 使用 $L,R$ 两个正整数表示一条从数轴上第 $L$ 个整点覆盖到第 $R$ 个整点，没有权值的蓝色线段。**保证数轴上任意一个整点至多被蓝色线段覆盖一次。**

如果一条红色线段从第 $l_0$ 个整点覆盖到第 $r_0$ 个整点，一条蓝色线段从第 $L_0$ 个整点覆盖到第 $R_0$ 个整点且 $\max(l_0,L_0) \leq \min(r_0,R_0)$，就认为这两条线段有交集，交集包含从第 $\max(l_0,L_0)$ 个整点到第 $\min(r_0,R_0)$ 个整点的全部 $\min(r_0,R_0)-\max(l_0,L_0)+1$ 个整点。你可以选择一些蓝色线段，一种合法的选择方案必须符合以下条件：

- 题目给定的每条红色线段至多与你选择的 $1$ 条蓝色线段有交集。

- 所有和**你选择的蓝色线段**有交集的红色线段权值之和不超过 $k$。

选择方案合法时，**你选择的蓝色线段**和**所有红色线段**的交集至多能包含多少个整点？
## 输入格式

第一行输入三个正整数 $n,m,k$。

接下来 $n$ 行，第 $i$ 行输入三个正整数 $l_i,r_i,w_i$ 表示一条红色线段。

接下来 $m$ 行，第 $i$ 行输入两个正整数 $L_i,R_i$ 表示一条蓝色线段。

**保证数轴上任意一个整点至多被红色线段覆盖一次。保证数轴上任意一个整点至多被蓝色线段覆盖一次。**
## 输出格式

输出一行一个整数表示答案。
## 样例

### 样例输入 #1
```
2 3 23
7 18 7
63 71 2
77 86
13 19
63 71

```
### 样例输出 #1
```
15

```
### 样例输入 #2
```
4 5 7
59 65 7
39 42 1
43 51 2
19 33 2
14 25
71 81
6 11
59 69
83 92

```
### 样例输出 #2
```
7

```
### 样例输入 #3
```
4 8 45
80 94 22
60 67 2
35 44 45
7 14 5
82 86
2 3
58 63
48 50
73 80
25 45
11 19
93 94

```
### 样例输出 #3
```
13

```
## 提示

**「样例解释 #1」**

![example](https://cdn.luogu.com.cn/upload/image_hosting/0mxbdlcn.png)

如图，选择输入的第 $2$ 条蓝色线段和第 $3$ 条蓝色线段。

第 $2$ 条蓝色线段与第 $1$ 条红色线段有交，交集包含从第 $13$ 个整点到第 $18$ 个整点的所有整点；第 $3$ 条蓝色线段与第 $2$ 条红色线段有交，交集包含从第 $63$ 个整点到第 $71$ 个整点的所有整点。

第 $1$ 条红色线段仅与第 $2$ 条蓝色线段有交，第 $2$ 条红色线段仅与第 $3$ 条蓝色线段有交；和被选择的蓝色线段有交的红色线段权值和为 $9$，方案合法。故答案为 $15$。

**「数据范围」**

**本题采用捆绑测试。**

|Subtask|$n \leq$|$m \leq$|$k \leq$|$l_i,r_i,L_i,R_i \leq$|分值|
|:-:|:-:|:-:|:-:|:-:|:-:|
|**#1**|$10$|$10$|$50$|$100$|$20$|
|**#2**|$200$|$200$|$200$|$10^5$|$30$|
|**#3**|$5000$|$5000$|$5000$|$10^9$|$30$|
|**#4**|$2 \times 10^5$|$5000$|$5000$|$10^9$|$20$|

对于 $100\%$ 的数据，$1 \leq n \leq 2 \times 10^5$，$1 \leq m,k \leq 5000$，$1 \leq l_i,r_i,L_i,R_i \leq 10^9$，$1 \leq w_i \leq k$，$l_i < r_i$，$L_i < R_i$。**保证数轴上任意一个整点至多被红色线段覆盖一次。保证数轴上任意一个整点至多被蓝色线段覆盖一次。**


---

---
title: "『SpOI - R1』Double Champions"
layout: "post"
diff: 普及+/提高
pid: P10793
tag: ['动态规划 DP', '贪心', '单调队列', 'O2优化', '排序']
---
# 『SpOI - R1』Double Champions
## 题目描述

**本题包含多组数据。**

现在有若干个格子排在一行上。

再给出 $n$ 个区间，每个区间 $i$ 可以覆盖 $[l_i,r_i]$ 这个区间中的每一个格子（例如，区间 $[1,2]$ 可以覆盖格子 $1,2$）。

现在需要把这些区间分组，每个组带来的贡献为所有其旗下的区间的交的总长度。

你需要求出最少把这些区间分成多少组，才能使得每一组的贡献都 $\geq w$。如果不存在任何方案满足条件，输出 `No`。
## 输入格式

第一行一个整数 $T$，表示数据组数。

对于每组数据，第一行两个整数 $n,w$。

接下来 $n$ 行，每一行两个整数 $l_i,r_i$，描述一个区间。
## 输出格式

对于每组数据，输出一行一个答案，表示最少要分的组数，或者字符串 `No`，表示无解。
## 样例

### 样例输入 #1
```
2
5 3 
6 10
6 8 
3 5 
7 9 
1 9
5 5
5 10
3 8
6 10
4 10
5 9
```
### 样例输出 #1
```
3
3
```
## 提示

#### 样例 #1 解释

按照输入顺序将输入的区间依次编号为 $①,②,③,④,⑤$。

可以将 $5$ 个区间分为以下 $3$ 组：$\{①,④\},\{②\},\{③⑤\}$。这样每一组的贡献即交集大小分别为 $3,3,3$，符合对每组贡献 $\geq 3$ 的要求。可以证明，$3$ 组是所有符合条件的区间划分方案中组数最少的。

### 数据范围

**请注意常数因子对程序效率的影响。**

**本题开启捆绑测试和子任务依赖。**

对于 $100\%$ 的数据，$1\leq T\leq 20$，$1\leq n\leq 2\times 10^5$，$0\leq w\leq 10^6$，$1\leq l_i\leq r_i\leq 10^6$。

| Subtask | $n\leq$ | $w,l_i,r_i\leq$ | 得分 | 子任务依赖 |
| :----------: | :----------: | :----------: | :----------: | :----------: |
| 1 | $8$ | $15$ | $10$ | 无 |
| 2 | $11$ | $20$ | $10$ | 1 |
| 3 | $1.5\times 10^3$ | $10^4$ | $25$ | 1,2 |
| 4 | $2\times 10^5$ | $10^6$ | $55$ | 1,2,3 |


---

---
title: "[NOIP 2012 提高组] 国王游戏"
layout: "post"
diff: 普及+/提高
pid: P1080
tag: ['贪心', '高精度', '2012', 'NOIP 提高组', '排序']
---
# [NOIP 2012 提高组] 国王游戏
## 题目描述

恰逢 H 国国庆，国王邀请 $n$ 位大臣来玩一个有奖游戏。首先，他让每个大臣在左、右手上面分别写下一个整数，国王自己也在左、右手上各写一个整数。然后，让这 $n$ 位大臣排成一排，国王站在队伍的最前面。排好队后，所有的大臣都会获得国王奖赏的若干金币，每位大臣获得的金币数分别是：排在该大臣前面的所有人的左手上的数的乘积除以他自己右手上的数，然后向下取整得到的结果。

国王不希望某一个大臣获得特别多的奖赏，所以他想请你帮他重新安排一下队伍的顺序，使得获得奖赏最多的大臣，所获奖赏尽可能的少。注意，国王的位置始终在队伍的最前面。

## 输入格式

第一行包含一个整数 $n$，表示大臣的人数。

第二行包含两个整数 $a$ 和 $b$，之间用一个空格隔开，分别表示国王左手和右手上的整数。

接下来 $n$ 行，每行包含两个整数 $a$ 和 $b$，之间用一个空格隔开，分别表示每个大臣左手和右手上的整数。

## 输出格式

一个整数，表示重新排列后的队伍中获奖赏最多的大臣所获得的金币数。

## 样例

### 样例输入 #1
```
3 
1 1 
2 3 
7 4 
4 6 
```
### 样例输出 #1
```
2
```
## 提示

【输入输出样例说明】

按 $1$、$2$、$3$ 这样排列队伍，获得奖赏最多的大臣所获得金币数为 $2$；

按 $1$、$3$、$2$ 这样排列队伍，获得奖赏最多的大臣所获得金币数为 $2$；

按 $2$、$1$、$3$ 这样排列队伍，获得奖赏最多的大臣所获得金币数为 $2$；

按$ 2$、$3$、$1 $这样排列队伍，获得奖赏最多的大臣所获得金币数为 $9$；

按 $3$、$1$、$2 $这样排列队伍，获得奖赏最多的大臣所获得金币数为 $2$；  

按$ 3$、$2$、$1$ 这样排列队伍，获得奖赏最多的大臣所获得金币数为 $9$。

因此，奖赏最多的大臣最少获得 $2$ 个金币，答案输出 $2$。


 
【数据范围】

对于 $20\%$ 的数据，有 $1≤ n≤ 10,0 < a,b < 8$；

对于 $40\%$ 的数据，有$ 1≤ n≤20,0 < a,b < 8$；

对于 $60\%$ 的数据，有 $1≤ n≤100$；

对于 $60\%$ 的数据，保证答案不超过 $10^9$；

对于 $100\%$ 的数据，有 $1 ≤ n ≤1,000,0 < a,b < 10000$。



NOIP 2012 提高组 第一天 第二题



---

---
title: "『FLA - I』云音泛"
layout: "post"
diff: 普及+/提高
pid: P10837
tag: ['模拟', '离散化', '洛谷原创', 'O2优化', '排序', '前缀和', '队列', '差分', '洛谷月赛']
---
# 『FLA - I』云音泛
## 题目背景

**[English statement.](/problem/U458238) You must submit your code at the Chinese version of the statement.**

“……这些年来，过得可好？”

“……无所谓好或不好，人生一场空虚大梦，韶华白首，不过转瞬。惟有天道恒在，往复循环，不曾更改...”
## 题目描述

在梦中，秋种下了 $n$ 朵凋零玫瑰。他记得，第 $i$ 朵玫瑰是在时刻 $t_i$ 种植的。

凋零玫瑰在被种下的那个时刻就立即开放，但每一株玫瑰只会开放 $m$ 个时刻（在时刻 $T$ 种植的玫瑰会且仅会在从时刻 $T$ 到时刻 $T+m-1$ 的 $m$ 个时刻开放），在 $m$ 个时刻后便化作再也无法挽留的灰尘，飘散在凛冽的寒风中。

他问你，假如他可以改变不超过一朵玫瑰的种植时间（选定一个 $t_i$ 并将其修改为任意正整数），那么最多有多少个时刻有且仅有一株凋零玫瑰开放？
## 输入格式

第一行输入两个正整数 $n,m$。

第二行输入 $n$ 个正整数，第 $i$ 个正整数为 $t_i$。
## 输出格式

输出一行一个正整数表示答案。
## 样例

### 样例输入 #1
```
5 4
11 9 1 3 12

```
### 样例输出 #1
```
14

```
### 样例输入 #2
```
13 7
6 42 58 41 20 60 2 61 45 28 45 28 12

```
### 样例输出 #2
```
38

```
## 提示

**「样例解释 #1」**

如图，使用金色标记有且仅有一株凋零玫瑰开放的时刻，使用黑色和红色标记每朵凋零玫瑰开放的时刻。

![example1](https://cdn.luogu.com.cn/upload/image_hosting/1u42cn1k.png)

将使用红色标记的玫瑰的种植时刻改为 $17$（将 $t_1$ 的值修改为 $17$，如下图）后有 $14$ 个时刻有且仅有一株凋零玫瑰开放。可以证明不存在能够使有且仅有一株凋零玫瑰开放的时刻数量大于 $14$ 的修改方案。

![example2](https://cdn.luogu.com.cn/upload/image_hosting/ig0pgy5w.png)

**「数据范围」**

|测试点编号|$n \leq$|$m \leq$|$t_i \leq$|
|:-:|:-:|:-:|:-:|
|$1 \sim 6$|$5000$|$5000$|$5000$|
|$7 \sim 12$|$2 \times 10^5$|$2 \times 10^5$|$2 \times 10^5$|
|$13 \sim 14$|$2 \times 10^5$|$1$|$10^9$|
|$15 \sim 20$|$2 \times10^5$|$10^9$|$10^9$|

对于所有测试数据，$1 \leq n \leq 2 \times 10^5$，$1 \leq m,t_i \leq 10^9$。


---

---
title: "[蓝桥杯 2023 国 Python A] 选段排序"
layout: "post"
diff: 普及+/提高
pid: P10991
tag: ['贪心', '2023', '排序', '蓝桥杯国赛']
---
# [蓝桥杯 2023 国 Python A] 选段排序
## 题目描述

给定一个长度为 $n$ 的序列 $A_i$ 以及两个下标 $p, q(p < q)$。你可以选择任意一个区间 $[L, R]$ 并将序列的这个范围内的元素 $A_L \sim A_R$ 从小到大排序。

求选择一个区间排序后 $A_q − A_p$ 的值最大可以是多少。

## 输入格式

输入的第一行包含三个整数 $n, p, q$，相邻两个整数之间使用一个空格分隔。

第二行包含 $n$ 个整数，分别表示 $A_1, A_2, \cdots, A_n$，相邻两个整数之间使用一个空格分隔。

## 输出格式

输出一行，包含一个整数表示 $A_q − A_p$ 的最大值。
## 样例

### 样例输入 #1
```
5 1 4
4 5 3 3 1

```
### 样例输出 #1
```
3

```
## 提示

对于 $20\%$ 的评测用例，$n \le 100 ,A_i \le 200$；

对于 $40\%$ 的评测用例，$n \le 2000 ,A_i \le 3000$；

对于所有评测用例，$1 \le p \le q \le n \le 2 \times 10^5,1 \le A_i \le 10^6$。


---

---
title: "「LAOI-6」Yet Another Graph Coloration Problem"
layout: "post"
diff: 普及+/提高
pid: P11022
tag: ['图论', '洛谷原创', 'Special Judge', 'O2优化', '深度优先搜索 DFS', '拓扑排序', 'Tarjan', '双连通分量', '构造', '洛谷月赛', '圆方树']
---
# 「LAOI-6」Yet Another Graph Coloration Problem
## 题目背景

[English statement](https://www.luogu.com.cn/problem/U477166). You must submit your code at the Chinese version of the statement.
## 题目描述

小 R 有一张 $n$ 个节点和 $m$ 条的边简单无向图，节点的编号依次为 $1 \sim n$。她想要为图中的每个节点分配黑色或白色的颜色，使得：

- 有至少 $1$ 个黑色节点；
- 有至少 $1$ 个白色节点；
- 对于任何一对点对 $(u, v)$，只要 $u$ 和 $v$ 的颜色不同，就存在至少 $2$ 条从 $u$ 到 $v$ 的不同的简单路径。
	- 简单路径是图上指不重复经过同一点的路径。
	- 若两条简单路径不同，要么其长度不同，要么至少存在一个正整数 $i$ 使两条路径经过的第 $i$ 个点不同。

或者，报告解不存在。
## 输入格式

**本题有多组数据。**

第一行，一个整数 $T$，表示数据组数。对于每组数据：

- 第一行，两个整数 $n, m$，表示图的节点数和边数。
- 接下来 $m$ 行，每行两个整数 $u, v$，表示有一条 $u, v$ 之间的边。

保证给出的图无重边、无自环。
## 输出格式

对于每组数据：

- 若有解，输出一行长为 $n$ 的字符串，第 $i$ 个字符为 `B` 表示 $i$ 号节点为黑色，为 `W` 表示 $i$ 号节点为白色；
- 若无解，仅输出一行一个整数 $-1$。

如果有多种合法的解，你只需要输出任意一种即可。
## 样例

### 样例输入 #1
```
3
4 5
1 2
1 3
1 4
2 3
3 4
5 6
1 2
1 3
1 5
2 3
2 4
3 4
6 10
1 2
1 3
1 5
2 3
2 4
2 5
2 6
3 5
3 6
4 6
```
### 样例输出 #1
```
BWBW
BBWWB
BWBWBW
```
### 样例输入 #2
```
1
4 3
1 2
1 3
2 3
```
### 样例输出 #2
```
-1
```
## 提示

**本题采用捆绑测试**。

- Subtask 0（15 pts）：$\sum 2^n \leq 2^{16}$。
- Subtask 1（25 pts）：$n \leq 3\times 10^3$，$m \leq 3\times 10^3$，$\sum n \leq 10^4$，$\sum m \leq 2\times 10^4$。
- Subtask 2（5 pts）：保证图不连通。
- Subtask 3（10 pts）：保证每个点的度数均为 $2$。
- Subtask 4（20 pts）：保证 $n = m$。
- Subtask 5（25 pts）：无特殊限制。

对于所有数据，保证 $1 \leq T \leq 10^5$，$2 \leq n \leq 2 \times 10^5$，$0 \leq m \leq 2 \times 10^5$，$\sum n \leq 2\times 10^6$，$\sum m \leq 2\times 10^6$，保证给出的图无重边、无自环。


---

---
title: "[CSP-S 2024] 超速检测"
layout: "post"
diff: 普及+/提高
pid: P11232
tag: ['模拟', '数学', '贪心', '二分', '2024', 'O2优化', '排序', 'CSP-S 提高级']
---
# [CSP-S 2024] 超速检测
## 题目描述

小 D 新入职了某国的交管部门，他的第一个任务是负责国家的一条长度为 $L$ 的南北主干道的车辆超速检测。为了考考小 D，上司首先需要他解决一个简化的场景。

这个周末，主干道上预计出现 $n$ 辆车，其中第 $i$ 辆车从主干道上距离最南端 $d_i$ 的位置驶入，以 $v_i$ 的初速度和 $a_i$ 的加速度做匀加速运动向北行驶。我们只考虑从南向北的车辆，故 $v_i > 0$，但 $a_i$ 可正可负，也可以为零。当车辆行驶到主干道最北端（即距离最南端为 $L$ 的位置）或速度降为 $0$（这只可能在 $a_i < 0$ 时发生）时，我们认为该车驶离主干道。

主干道上设置了 $m$ 个测速仪，其中第 $j$ 个测速仪位于主干道上距离最南端 $p_j$ 的位置，每个测速仪可以设置开启或关闭。当某辆车经过某个开启的测速仪时，若这辆车的瞬时速度**超过**了道路限速 $V$，那么这辆车就会被判定为超速。注意当车辆驶入与驶出主干道时，如果在对应位置有一个开启的测速仪，这个测速仪也会对这辆车进行测速。

上司首先想知道，如果所有测速仪都是开启的，那么这 $n$ 辆车中会有多少辆车被判定为超速。

其次，为了节能，部门想关闭一部分测速仪。然而，他们不希望漏掉超速的车，也就是说，当 $n$ 辆车里的某辆车在所有测速仪都开启时被判定为超速，他们希望在关闭一部分测速仪以后它依然被判定为超速。上司还想知道在这样的条件下最多可以关闭多少测速仪。

由于 $n$ 很大，上司允许小 D 使用编程解决这两个问题，于是小 D 找到了你。

如果你对于加速度并不熟悉，小 D 贴心地在本题的“提示”部分提供了有关加速度的公式。
## 输入格式

输入的第一行包含一个正整数 $T$，表示数据组数。

接下来包含 $T$ 组数据，每组数据的格式如下：

第一行包含四个整数 $n, m, L, V$，分别表示车辆数量、测速仪数量、主干道长度和道路限速。

接下来 $n$ 行：

第 $i$ 行包含三个整数 $d_i, v_i, a_i$ 描述一辆车。

最后一行包含 $m$ 个整数 $p_1, p_2, \dots , p_m$ 描述道路上所有测速仪的位置。
## 输出格式

对于每组数据：输出一行包含两个整数，第一个整数为所有测速仪都开启时被判定为超速的车辆数量，第二个整数为在不漏掉超速车辆的前提下最多可以关闭的测速仪数量。
## 样例

### 样例输入 #1
```
1
5 5 15 3
0 3 0
12 4 0
1 1 4
5 5 -2
6 4 -4
2 5 8 9 15
```
### 样例输出 #1
```
3 3
```
## 提示

**【样例 1 解释】**

在该组测试数据中，主干道长度为 $15$，限速为 $3$，在距离最南端 $2, 5, 8, 9, 15$ 的位置各设有一个测速仪。
- 第一辆车在最南端驶入，以 $3$ 的速度匀速行驶。这辆车在整个路段上都没有超速。
- 第二辆车在距离最南端 $12$ 的位置驶入，以 $4$ 的速度匀速行驶。在最北端驶离主干道时，它会被距离最南端 $15$ 的测速仪判定为超速。
- 第三辆车在距离最南端 $1$ 的位置驶入，以 $1$ 的初速度、$4$ 的加速度行驶。其在行驶了 $\frac{3^2-1^2}{2\times 4}=1$ 的距离，即到达 $2$ 的位置时，速度变为 $3$，并在之后一直超速。因此这辆车会被除了距离最南端 $2$ 的测速仪以外的其他测速仪判定为超速。
- 第四辆车在距离最南端 $5$ 的位置驶入，以 $5$ 的初速度、$-2$ 的加速度行驶。其在行驶了 $\frac{3^2-5^2}{2\times (-2)}$ 的距离，即到达 $9$ 的位置时，速度变为 $3$。因此这辆车在距离最南端 $[5, 9)$ 时超速，会被距离最南端 $5$ 和 $8$ 的两个测速仪判定为超速。
- 第五辆车在距离最南端 6 的位置驶入，以 4 的初速度、−4 的加速度行驶。在其行驶了 $\frac{3^2-4^2}{2\times (-4)}=\frac{7}{8}$ 的距离后，即这辆车到达 $6\frac{7}{8}$ 的位置时，其速度变为 $3$。因此这辆车在距离最南端 $[6,6\frac{7}{8})$ 时超速，但这段区间内没有测速仪，因此不会被判定为超速。

因此第二、三、四辆车会被判定为超速，输出的第一个数为 $3$。

我们可以关闭距离最南端 $2, 8, 9$ 的三个测速仪，保留 $5$ 和 $15$ 的两个测速仪，此时三辆之前被判定为超速的车依然被判定为超速。可以证明不存在更优方案，因此输出的第二个数为 $3$。

**【样例 2】**

见选手目录下的 detect/detect2.in 与 detect/detect2.ans。

该组样例满足 $n, m \leq 10$。

**【样例 3】**

见选手目录下的 detect/detect3.in 与 detect/detect3.ans。

该组样例满足特殊性质 A，其中前十组测试数据满足 $n, m \leq 3000$。

**【样例 4】**

见选手目录下的 detect/detect4.in 与 detect/detect4.ans。

该组样例满足特殊性质 B，其中前十组测试数据满足 $n, m \leq 3000$。

**【样例 5】**

见选手目录下的 detect/detect5.in 与 detect/detect5.ans。

该组样例满足特殊性质 C，其中前十组测试数据满足 $n, m \leq 3000$。

**【数据范围】**

对于所有测试数据，保证：

- $1 \leq T \leq 20$；
- $1 \leq n, m \leq 10^5$，$1 \leq L \leq 10^6$，$1 \leq V \leq 10^3$；
- $0 \leq d_i < L$，$1 \leq v_i \leq 10^3$，$|a_i| \leq 10^3$；
- $0 \leq p_1 < p_2 < \dots < p_m \leq L$。

| 测试点 | $n,m\leq$ | 特殊性质 |
| :----------: | :----------: | :----------: |
| $1$ | $10$ | 无 |
| $2$ | $20$ | 无 |
| $3$ | $3000$ | A |
| $4$ | $10^5$ | A |
| $5$ | $3000$ | B |
| $6$ | $10^5$ | B |
| $7$ | $3000$ | C |
| $8$ | $10^5$ | C |
| $9$ | $3000$ | 无 |
| $10$ | $10^5$ | 无 |

特殊性质 A：保证 $a_i = 0$。

特殊性质 B：保证 $a_i > 0$。

特殊性质 C：保证 $a_i < 0$，且所有车都不在最北端驶离主干道。

**【提示】**

与加速度有关的定义和公式如下：

- 匀加速运动是指物体在运动过程中，加速度保持不变的运动，即每单位时间内速度的变化量是恒定的。
- 当一辆车的初速度为 $v_0$、加速度 $a\neq 0$，做匀加速运动，则 $t$ 时刻后它的速度 $v_1 = v_0 + a \times t$，它的位移（即行驶路程）$s=v_0\times t+0.5\times a\times t^2$。
- 当一辆车的初速度为 $v_0$、加速度 $a \neq 0$，做匀加速运动，则当它的位移（即行驶路程）为 $s$ 时，这辆车的瞬时速度为 $\sqrt{v_0^2+2\times a\times s}$。
- 当一辆车的初速度为 $v_0$、加速度 $a \neq 0$，在它的位移（即行驶路程）为 $\frac{v_1^2-v_0^2}{2a}$ 时，这辆车的瞬时速度为 $v_1$。

如果你使用浮点数进行计算，需要注意潜在的精度问题。


---

---
title: "吻秋"
layout: "post"
diff: 普及+/提高
pid: P11244
tag: ['模拟', '暴力数据结构', '洛谷原创', 'O2优化', '枚举', '排序', '洛谷月赛']
---
# 吻秋
## 题目背景

[English statement](https://www.luogu.com.cn/problem/U500140). **You must submit your code at the Chinese version of the statement.**

秋雨刚刚亲吻过大地，白云便卷起赤橙黄绿青蓝紫。

波长在可见光范围内自由落体，让蒸腾的水汽都带上了递进的旋律。

渐变色模糊的印象总被晴天匆匆带过，但往往反常的极差让我们更加记忆犹新。

所以有序，真的最优吗？
## 题目描述

小 C 有 $m$ 个整数序列 $a_1\dots a_m$，每个序列的长度都为 $n$。

小 C 想要把自己的序列按照整数大小排序。于是小 C 有 $q$ 次操作，每次操作：

- 要么，小 C 给出 $x, y\ (x \neq y)$，他想把 $a_x, a_y$ 拼接在一起形成长度为 $2n$ 的序列 $b$，将 $b$ 升序排序后取 $b_1\dots b_n$ 作为新的 $a_x$，$b_{n+1}\dots b_{2n}$ 作为新的 $a_y$；
- 要么，小 C 给出 $i, j$，细心的小 C 想要询问你，经过前面的若干次操作后，$a_{i,j}$ 的值，你需要准确回答他的问题。
## 输入格式

第一行，三个整数 $n, m, q$。

接下来 $m$ 行，每行 $n$ 个整数，第 $i$ 行 $j$ 个整数表示 $a_{i,j}$。

接下来 $q$ 行，每行三个整数，描述一次操作或询问。其格式为下述两种之一：

- $\verb!1 x y!$ 表示对 $a_x, a_y$ 进行排序，其中 $1 \leq x \neq y \leq m$；
- $\verb!2 i j!$ 表示查询 $a_{i,j}$，其中 $1 \leq i \leq m$，$1 \leq j \leq n$。
## 输出格式

对于每组询问，一行一个整数，表示答案。
## 样例

### 样例输入 #1
```
5 3 6
1 3 2 5 6
2 7 8 2 2
3 5 3 4 8
2 1 5
1 1 2
2 2 4
1 1 3
1 2 1
2 2 3
```
### 样例输出 #1
```
6
7
2

```
### 样例输入 #2
```
6 5 20
5 14 13 1 15 17
7 7 19 3 8 6
16 13 13 6 14 2
12 5 4 17 12 3
19 19 4 6 3 3
2 5 3
1 4 3
2 1 1
1 2 5
2 4 6
2 2 2
1 4 2
1 2 4
2 1 1
2 3 3
2 3 3
1 4 2
1 4 1
2 3 5
1 3 4
1 4 1
1 1 4
1 5 1
2 2 4
2 4 2

```
### 样例输出 #2
```
4
5
12
3
5
13
13
16
6
14

```
## 提示

### 数据规模与约定

**本题采用捆绑测试和子任务依赖**。

因为最后两个 Subtask 的极限输入数据大小分别达到 18MB、50MB 以上，C++ 选手可以选择使用下面的 **快速输入输出模板**：

```cpp
namespace FastIO {
	char buf[1 << 21], *p1 = buf, *p2 = buf;
#define getchar() (p1 == p2 && (p1 = buf, p2 = (p1 + fread(buf, 1, 1 << 21, stdin))) == p1 ? EOF : *p1++)
	template <typename T> inline T read() { T x = 0, w = 0; char ch = getchar(); while (ch < '0' || ch > '9') w |= (ch == '-'), ch = getchar(); while ('0' <= ch && ch <= '9') x = x * 10 + (ch ^ '0'), ch = getchar(); return w ? -x : x; }
	template <typename T> inline void write(T x) { if (!x) return; write<T>(x / 10), putchar((x % 10) ^ '0'); }
	template <typename T> inline void print(T x) { if (x > 0) write<T>(x); else if (x < 0) putchar('-'), write<T>(-x); else putchar('0'); }
	template <typename T> inline void print(T x, char en) { print<T>(x), putchar(en); }
}; using namespace FastIO;
#undef getchar()
```

**不保证除了 C++ 以外的语言一定能够通过，但保证对于 C++ 语言有充足的时限。**

---

- Subtask 0（0 pts）：样例。
- Subtask 1（9 pts）：$n \leq 10^4$，$q \leq 3000$。依赖于子任务 $0$。
- Subtask 2（23 pts）：$q \leq 3000$。依赖于子任务 $0, 1$。
- Subtask 3（20 pts）：$m \leq 5$，$q \leq 4\times 10^5$。依赖于子任务 $0$。
- Subtask 4（28 pts）：$q \leq 4\times 10^5$。依赖于子任务 $0 \sim 3$。
- Subtask 5（20 pts）：无特殊限制。依赖于子任务 $0 \sim 4$。

对于所有数据，满足 $1 \leq n\cdot m \leq 2\times 10^6$，$1 \leq m \leq 20$，$1 \leq q \leq 5\times 10^6$，$1 \leq a_{i,j} \leq 10^7$；对于操作或询问，$1 \leq x \neq y \leq m$，$1 \leq i \leq m$，$1 \leq j \leq n$。


---

---
title: "【MX-S6-T1】「KDOI-11」打印"
layout: "post"
diff: 普及+/提高
pid: P11289
tag: ['贪心', 'O2优化', '排序', '优先队列', '梦熊比赛']
---
# 【MX-S6-T1】「KDOI-11」打印
## 题目背景

原题链接：<https://oier.team/problems/S6A>。
## 题目描述

巡的家有 $m$ 台打印机，编号从 $1$ 到 $m$。她有 $n$ 个文件想要打印。其中第 $i$ 个文件会在第 $t_i$ 时刻下发打印命令，打印这个文件需要 $s_i$ 的时间。

每次发送一个文件打印会选择等待时间最短的打印机，如有多个，选择编号最小的。

你需要告诉巡每台打印机打印了哪些文件。

**保证同一时刻不会下发多个打印命令。**
## 输入格式

第一行，两个正整数 $n,m$，表示文件的数量和打印机的数量。

接下来 $n$ 行，每行两个正整数 $s_i,t_i$，表示第 $i$ 个文件需要的打印时间以及下发命令的时刻。保证所有 $t_i$ 互不相同。
## 输出格式

$m$ 行，第 $i$ 行 $k_i + 1$ 个整数：
- 第一个非负整数 $k_i$，表示第 $i$ 台打印机打印的文件数量；
- 接下来 $k_i$ 个正整数，从小到大排序，表示其打印的文件编号。
## 样例

### 样例输入 #1
```
3 3
2 3
2 1
5 2
```
### 样例输出 #1
```
2 1 2
1 3
0
```
## 提示

**【样例解释 #1】**

共有 $3$ 台打印机。按时间顺序，打印命令如下：
- 文件 $2$ 在第 $1$ 秒被下发。此时所有打印机等待时间都是 $0$。因此选择编号最小的 $1$ 号打印机。
- 文件 $3$ 在第 $2$ 秒被下发。此时 $1$ 号打印机正在打印文件 $2$，其余打印机等待时间都是 $0$。因此选择编号最小的 $2$ 号打印机。
- 文件 $1$ 在第 $3$ 秒被下发。此时 $1$ 号打印机已经完成文件 $2$ 的打印，等待时间为 $0$。因此选择 $1$ 号打印机。

故三台打印机分别打印了编号为 $[1,2],[3],[]$ 的文件。

**【样例 #2】**

见附件中的 `print/print2.in` 与 `print/print2.ans`。

该组样例满足测试点 $1\sim 3$ 的约束条件。

**【样例 #3】**

见附件中的 `print/print3.in` 与 `print/print3.ans`。

该组样例满足测试点 $4\sim 9$ 的约束条件。

**【样例 #4】**

见附件中的 `print/print4.in` 与 `print/print4.ans`。

该组样例满足测试点 $18\sim 20$ 的约束条件。

**【数据范围】**

对于所有测试数据，保证：$1\leq n,m\leq 2\times 10^5$，$1\leq s_i,t_i\leq 10^9$，所有 $t_i$ 互不相同。

| 测试点编号  |   $n,m\leq$    | $s_i\leq $ |   $t_i\leq $   |
| :---------: | :------------: | :--------: | :------------: |
|  $1\sim 3$  |      $10$      |   $10^9$   |     $10^9$     |
|  $4\sim 9$  |     $5000$     |   $10^9$   |     $10^9$     |
| $10\sim 13$ | $2\times 10^5$ |    $1$     |     $2\times 10^5$     |
| $14\sim 17$ | $2\times 10^5$ |   $10^9$   | $2\times 10^5$ |
| $18\sim 20$ | $2\times 10^5$ |   $10^9$   |     $10^9$     |




---

---
title: "垃圾陷阱"
layout: "post"
diff: 普及+/提高
pid: P1156
tag: ['动态规划 DP', '排序', '背包 DP']
---
# 垃圾陷阱
## 题目描述

卡门――农夫约翰极其珍视的一条 `Holsteins` 奶牛――已经落了到 “垃圾井” 中。“垃圾井” 是农夫们扔垃圾的地方，它的深度为 $D$（$2 \le D \le 100$）英尺。

卡门想把垃圾堆起来，等到堆得与井深同样高或比井深更高（即，垃圾高度总和 $\geq D$）时，她就能逃出井外了。另外，卡门可以通过吃一些垃圾来维持自己的生命。

每个垃圾都可以用来吃或堆放，并且堆放垃圾不用花费卡门的时间。

假设卡门预先知道了每个垃圾扔下的时间 $t$（$1 \le t \le 1000$），以及每个垃圾堆放的高度 $h$（$1 \le h \le 25$）和吃进该垃圾能增加维持生命的时间 $f$（$1 \le f \le 30$），要求出卡门最早能逃出井外的时间，假设卡门当前体内有足够持续 $10$ 小时的能量，如果卡门 $10$ 小时内（不含 $10$ 小时，维持生命的时间同）没有进食，卡门就将饿死。特别地，若体力值为 $0$ 时吃下垃圾或逃出井外也不会饿死。
## 输入格式

第一行为两个整数，$D$ 和 $G$（$1 \le G \le 100$），$G$ 为被投入井的垃圾的数量。

第二到第 $G+1$ 行每行包括三个整数：$T$（$1 \le T \le 1000$），表示垃圾被投进井中的时间；$F$（$1 \le F \le 30$），表示该垃圾能维持卡门生命的时间；和 $H$（$1 \le H \le 25$），该垃圾能垫高的高度。

## 输出格式

如果卡门可以爬出陷阱，输出一个整数，表示最早什么时候可以爬出；否则输出卡门最长可以存活多长时间。

## 样例

### 样例输入 #1
```
20 4
5 4 9
9 3 2
12 6 10
13 1 1
```
### 样例输出 #1
```
13
```
## 提示

**【样例说明】**

卡门堆放她收到的第一个垃圾：$\mathrm{height}=9$；

卡门吃掉她收到的第 $2$ 个垃圾，使她的生命从 $10$ 小时延伸到 $13$ 小时；

卡门堆放第 $3$ 个垃圾，$\mathrm{height}=19$；

卡门堆放第 $4$ 个垃圾，$\mathrm{height}=20$。



---

---
title: "[USACO25OPEN] Compatible Pairs S"
layout: "post"
diff: 普及+/提高
pid: P12026
tag: ['图论', '贪心', 'USACO', '2025', '图论建模', '拓扑排序']
---
# [USACO25OPEN] Compatible Pairs S
## 题目描述

在遥远的乡村，农夫约翰的奶牛并非普通的农场动物——它们隶属于一个秘密的奶牛情报网络。每头奶牛都有一个由精英密码学家精心分配的ID号码。但由于农夫约翰随意的标记系统，部分奶牛出现了重复ID的情况。

农夫约翰记录到共有 $N$（$1\le N\le 2\cdot 10^5$）个不同的ID号码，对于每个唯一ID $d_i$（$0\le d_i\le 10^9$），有 $n_i$（$1\le n_i\le 10^9$）头奶牛共享该ID。

奶牛们只能成对交流，它们的加密通信有一个严格规则：两头奶牛仅当不是同一头牛且它们的ID号码之和等于 $A$ 或 $B$（$0\le A\le B\le 2\cdot 10^9$）时才能交换信息。每头奶牛同一时间只能参与一次对话（即不能同时属于多对通信组合）。

农夫约翰希望最大化互不干扰的通信对数来确保最佳信息流通。你能计算出最多可以同时建立多少对通信吗？

## 输入格式

第一行包含 $N$、$A$、$B$。
接下来 $N$ 行每行包含 $n_i$ 和 $d_i$。所有 $d_i$ 均不相同。

## 输出格式

可同时建立的最大互不干扰通信对数。
注意：由于涉及大整数运算，可能需要使用 64 位整数类型（如C/C++中的 `long long`）。
## 样例

### 样例输入 #1
```
4 4 5
17 2
100 0
10 1
200 4
```
### 样例输出 #1
```
118
```
## 提示

解释：
ID为 $0$ 的奶牛可与 ID 为 $4$ 奶牛通信（ID 之和为 $4$）。由于共有 $100$ 头 ID $0$ 的奶牛和 $200$ 头 ID $4$ 的奶牛，最多可组成 $100$ 对通信组合。

ID 为 $4$ 的奶牛还可与 ID 为 $1$ 的奶牛通信（ID 之和为$5$）。此时剩余 $100$ 头 ID $4$ 的奶牛和 $10$ 头 ID $1$ 的奶牛可组成 $10$ 对通信组合。

最后，ID 为 $2$ 的奶牛可与其他同 ID 奶牛通信。$17$ 头 ID $2$ 的奶牛最多可组成 $8$ 对通信组合（$\lfloor17/2\rfloor=8$）。

总计 $100+10+8=118$ 对通信组合，可以证明这是最大可能值。

- 测试点 $3\sim4$：$A=B$。
- 测试点 $5\sim7$：$N\le 1000$。
- 测试点 $8\sim12$：无额外限制。


---

---
title: "[USTCPC 2025] 高位逼抢"
layout: "post"
diff: 普及+/提高
pid: P12039
tag: ['2025', '拓扑排序', '高校校赛']
---
# [USTCPC 2025] 高位逼抢
## 题目背景

考虑到评测机性能差异，改为 2s 时限。USTCPC 时限为 3s。

（题面最后提供了形式化的描述）

克露丝卡尔酱最近开始游玩“实况足球”手游，在天梯遭遇10连败之后，又不幸匹配上了臭名昭著的“倒脚狗”。只见那可憎的对手将足球从后卫传到门将，又从门将传到后卫，又从后卫传到门将······

是可忍，孰不可忍！怒不可遏的克露丝卡尔酱操纵自己的球员大举压上，向对手展开了高压逼抢。只可惜那对手发扬 Tiki-taka 战术，来回传球，把克露丝卡尔酱的上抢球员耍的团团转。

说时迟，那时快，对手见克露丝卡尔酱全军出击，后防空虚，一个大脚将皮球开到前场。对手的前锋接球长驱直入，轻松攻破了克露丝卡尔酱的大门！

克露丝卡尔酱自闭的卸载了“实况足球”，虽然过了几天又下了回来。但是在东山再起之前，她想要请教“实况足球”领域大神——你，该如何对付可恶的“倒脚狗”。
## 题目描述

一场球赛上，对手共有 $n$ 名球员，但由于距离和技术限制，并不是任何两名球员之间都可以互相直接传球。具体来说，有且仅有 $m$ 对球员之间可以互相传球。

当对手持球时，克露丝卡尔酱可以操纵球员上抢和封堵传球路线，具体地，当 $x+1$ 名队员去**高压逼抢**时:

- 有 $1$ 名球员上抢，干扰持球球员。
- 其余 $x$ 名球员，每个球员会**封堵至多一条传球路线**。

由于没有练习过花式技巧，持球球员不会过人。因此在受到干扰后，持球球员必须立刻将球通过一条传球路线传给某个队友。

如果某一时刻，持球球员发现自己所有的传球线路都被封堵。此时上抢球员直扑右脚，持球球员**丢失球权**。

然而，过多的前场逼抢会快速地消耗球员体力，同时也会给防守带来隐患。因此，克露丝卡尔酱希望想知道：当对方的第 $i$ 号球员拿球时，$x$ 至少为多少，可以保证在有限的时间内抢下足球？


### 形式化题面
一个 $n$ 个点 $m$ 条边的无向图（无重边自环），一个棋子，还有一个常数 $x$。A 和 B 玩一个游戏。

初始棋子位于 $i$ 节点，此后每一回合：

- B 选定至多 $x$ 条边删掉
- A 把棋子沿着某条边移到另一个节点
- B 把刚刚删掉的边复原

如果 A，B 都绝顶聪明，并且在有限轮中，B 可以把 A 逼入绝境（无法移动），则 B 胜利，否则 A 胜利。

对于 $i\in[1,n]$ 求 $x$ 至少为多少，B 才胜利。
## 输入格式

第一行包含两个整数 $n$ $(1\le n\le 10^6)$ 和 $m$ $(0\le m\le 2\times 10^6)$，表示图中的节点数和边数。

接下来的 $m$ 行，每行包含两个整数 $u$ 和 $v$ $(1\le u,v\le n)$，表示球员 $u$ 和球员 $v$ 之间可以互相传球。

保证图无重边自环。
## 输出格式

输出一行 $n$ 个整数，表示对 $i=1\sim n$ 的答案。


## 样例

### 样例输入 #1
```
5 5
1 4
2 5
1 2
2 3
3 1
```
### 样例输出 #1
```
2 2 2 1 1
```
### 样例输入 #2
```
1 0
```
### 样例输出 #2
```
0
```
### 样例输入 #3
```
6 9
1 2
1 3
1 4
1 5
1 6
2 3
2 5
2 6
5 6
```
### 样例输出 #3
```
3 3 2 1 3 3
```
### 样例输入 #4
```
3 2
1 2
2 3
```
### 样例输出 #4
```
1 1 1
```


---

---
title: "[蓝桥杯 2025 省 A] 地雷阵"
layout: "post"
diff: 普及+/提高
pid: P12144
tag: ['贪心', '计算几何', '2025', '排序', '扫描线', '蓝桥杯省赛', '极角排序', '平面几何']
---
# [蓝桥杯 2025 省 A] 地雷阵
## 题目描述

小蓝正在平面直角坐标系中的第一象限里玩一个逃生小游戏。在第一象限中埋有 $n$ 颗地雷，第 $i$ 颗地雷的坐标为 $(x_i, y_i)$，触发范围为以 $(x_i, y_i)$ 为圆心，半径为 $r_i$ 的圆。一旦小蓝走进了圆内就会触发地雷导致游戏失败。小蓝初始在原点 $(0, 0)$ 上，他需要在第一象限内选择一个方向一直往前走，如果能不触发任何地雷即可成功通关游戏。他想知道在 $[0, \frac{\pi}{2}]$ 中均匀随机选择一个方向，即在 $0^\circ$（朝向 $x$ 轴正方向）至 $90^\circ$（朝向 $y$ 轴正方向）之间随机选择一个方向，通关游戏的概率是多少？
## 输入格式

输入的第一行包含一个正整数 $n$。

接下来 $n$ 行，每行包含三个正整数 $x_i, y_i, r_i$，相邻整数之间使用一个空格分隔。
## 输出格式

输出一行包含一个实数，四舍五入保留三位小数，表示答案。
## 样例

### 样例输入 #1
```
1
2 2 1
```
### 样例输出 #1
```
0.540
```
### 样例输入 #2
```
2
1 3 1
3 1 1
```
### 样例输出 #2
```
0.181
```
## 提示

### 评测用例规模与约定

- 对于 $20\%$ 的评测用例，$1 \leq n \leq 100$；
- 对于所有评测用例，$1 \leq n \leq 10^5$，$1 \leq x_i, y_i \leq 10^4$，$r_i < \min(x_i, y_i)$。


---

---
title: "[GDCPC 2024] 不等式"
layout: "post"
diff: 普及+/提高
pid: P13359
tag: ['贪心', '2024', '广东', '拓扑排序', 'XCPC']
---
# [GDCPC 2024] 不等式
## 题目背景

数据、标程、题解等资源的获取：<https://gitlink.org.cn/thusaa/gdcpc2024>
## 题目描述

给定 $n,m$，以及 $m$ 个形如 $a_{x_i}\ge a_{y_i}+a_{z_i}(1 \le i \le m)$ 的条件。问是否有一组**正整数** $(a_1,a_2,\cdots,a_n)$ 满足所有条件，并且 $a_1+a_2+\cdots+a_n \le 10^{9}$。如果有，输出 $a_1+a_2+\cdots+a_n$ 的最小值；如果无解，输出 $-1$。
## 输入格式

第一行两个整数 $n,m(1 \le n,m \le 2\times 10^5)$。

之后 $m$ 行，第 $i$ 行三个整数 $x_i,y_i,z_i$，表示一个限制 $a_{x_i}\ge a_{y_i}+a_{z_i}(1\le x_i,y_i,z_i \le n)$。
## 输出格式

输出一行一个整数，表示答案。
## 样例

### 样例输入 #1
```
5 2
1 2 3
3 4 5
```
### 样例输出 #1
```
8
```
## 提示

和最小的解为 $(3,1,2,1,1)$，和为 $8$。


---

---
title: "兽径管理"
layout: "post"
diff: 普及+/提高
pid: P1340
tag: ['图论', '福建省历届夏令营', '排序', '生成树']
---
# 兽径管理
## 题目描述

约翰农场的牛群希望能够在 $N$ 个草地之间任意移动。草地的编号由 $1$ 到 $N$。草地之间有树林隔开。牛群希望能够选择草地间的路径，使牛群能够从任一 片草地移动到任一片其它草地。 牛群可在路径上双向通行。

牛群并不能创造路径，但是他们会保有及利用已经发现的野兽所走出来的路径（以下简称兽径）。每星期他们会选择并管理一些或全部已知的兽径当作通路。

牛群每星期初会发现一条新的兽径。他们接着必须决定管理哪些兽径来组成该周牛群移动的通路，使得牛群得以从任一草地移动到任一草地。牛群只能使用当周有被管理的兽径做为通路。

牛群希望他们管理的兽径长度和为最小。牛群可以从所有他们知道的所有兽径中挑选出一些来管理。牛群可以挑选的兽径与它之前是否曾被管理无关。

兽径决不会是直线，因此连接两片草地之间的不同兽径长度可以不同。 此外虽然两条兽径或许会相交，但牛群非常的专注，除非交点是在草地内，否则不会在交点换到另外一条兽径上。

在每周开始的时候，牛群会描述他们新发现的兽径。如果可能的话，请找出可从任何一草地通达另一草地的一组需管理的兽径，使其兽径长度和最小。

## 输入格式

输入的第一行包含两个用空白分开的整数 $N$ 和 $W$。$W$ 代表你的程序需要处理的周数。

以下每处理一周，读入一行数据，代表该周新发现的兽径，由三个以空白分开的整数分别代表该兽径的两个端点（两片草地的编号) 与该兽径的长度。一条兽径的两个端点一定不同。

## 输出格式

每次读入新发现的兽径后，你的程序必须立刻输出一组兽径的长度和，此组兽径可从任何一草地通达另一草地，并使兽径长度和最小。如果不能找到一组可从任一草地通达另一草地的兽径，则输出 $-1$。

## 样例

### 样例输入 #1
```
4 6	 	 
1 2 10	 	 
1 3 8	 	 
3 2 3	 	 
1 4 3	 	 
1 3 6	 	 
2 1 2	 	 

```
### 样例输出 #1
```
-1
-1
-1
14
12
8
```
## 提示

### 样例解释

对于每一周，

- 第一周时 $4$ 号草地不能与其他草地连通，输出 $-1$；
- 第二周时 $4$ 号草地不能与其他草地连通，输出 $-1$；
- 第三周时 $4$ 号草地不能与其他草地连通，输出 $-1$；
- 第四周时可以选择兽径 $(1,4,3),(1,3,8)$ 和 $(3,2,3)$；
- 第五周时可以选择兽径 $(1,4,3),(1,3,6)$ 和 $(3,2,3)$；
- 第六周时可以选择兽径 $(1,4,3),(2,1,2)$ 和 $(3,2,3)$。


### 数据范围及约定

对于全部数据，$1\le N\le 200$，$1 \le W \le 6000$，兽径的长度不超过 $10^4$ 且为正整数。


---

---
title: "排序"
layout: "post"
diff: 普及+/提高
pid: P1347
tag: ['图论', '福建省历届夏令营', '排序', '拓扑排序']
---
# 排序
## 题目描述

一个不同的值的升序排序数列指的是一个从左到右元素依次增大的序列，例如，一个有序的数列 $A,B,C,D$ 表示 $A<B,B<C,C<D$。在这道题中，我们将给你一系列形如 $A<B$ 的关系，并要求你判断是否能够根据这些关系确定这个数列的顺序。
## 输入格式

第一行有两个正整数 $n,m$，$n$ 表示需要排序的元素数量，$2\leq n\leq 26$，第 $1$ 到 $n$ 个元素将用大写的 $A,B,C,D,\dots$ 表示。$m$ 表示将给出的形如 $A<B$ 的关系的数量。

接下来有 $m$ 行，每行有 $3$ 个字符，分别为一个大写字母，一个 `<` 符号，一个大写字母，表示两个元素之间的关系。

## 输出格式

若根据前 $x$ 个关系即可确定这 $n$ 个元素的顺序 `yyy..y`（如 `ABC`），输出

`Sorted sequence determined after xxx relations: yyy...y.`

若根据前 $x$ 个关系即发现存在矛盾（如 $A<B,B<C,C<A$），输出

`Inconsistency found after x relations.`

若根据这 $m$ 个关系无法确定这 $n$ 个元素的顺序，输出

`Sorted sequence cannot be determined.`

（提示：确定 $n$ 个元素的顺序后即可结束程序，可以不用考虑确定顺序之后出现矛盾的情况）

## 样例

### 样例输入 #1
```
4 6
A<B
A<C
B<C
C<D
B<D
A<B

```
### 样例输出 #1
```
Sorted sequence determined after 4 relations: ABCD.
```
### 样例输入 #2
```
3 2
A<B
B<A
```
### 样例输出 #2
```
Inconsistency found after 2 relations.
```
### 样例输入 #3
```
26 1
A<Z
```
### 样例输出 #3
```
Sorted sequence cannot be determined.
```
## 提示

$2 \leq n \leq 26,1 \leq m \leq 600$。


---

---
title: "[GCJ 2008 Finals] Juice"
layout: "post"
diff: 普及+/提高
pid: P13486
tag: ['2008', '堆', '树状数组', '枚举', '排序', 'STL', 'Google Code Jam']
---
# [GCJ 2008 Finals] Juice
## 题目描述

You are holding a party. In preparation, you are making a drink by mixing together three different types of fruit juice: Apple, Banana, and Carrot. Let's name the juices $A$, $B$ and $C$.

You want to decide what fraction of the drink should be made from each type of juice, in such a way that the maximum possible number of people attending the party like it.

Each person has a minimum fraction of each of the $3$ juices they would like to have in the drink. They will only like the drink if the fraction of each of the $3$ juices in the drink is greater or equal to their minimum fraction for that juice.

Determine the maximum number of people that you can satisfy.
## 输入格式

* One line containing an integer $T$, the number of test cases in the input file.

For each test case, there will be:

* One line containing the integer $N$, the number of people going to the party.
* $N$ lines, one for each person, each containing three space-separated numbers "$A$ $B$ $C$", indicating the minimum fraction of each juice that would like in the drink. $A$, $B$ and $C$ are integers between $0$ and $10000$ inclusive, indicating the fraction in parts-per-ten-thousand. $A + B + C \leq 10000$.

## 输出格式

* $T$ lines, one for each test case in the order they occur in the input file, each containing the string "Case #$X$: $Y$" where $X$ is the number of the test case, starting from $1$, and $Y$ is the maximum number of people who will like your drink.
## 样例

### 样例输入 #1
```
3
3
10000 0 0
0 10000 0
0 0 10000
3
5000 0 0
0 2000 0
0 0 4000
5
0 1250 0
3000 0 3000
1000 1000 1000
2000 1000 2000
1000 3000 2000
```
### 样例输出 #1
```
Case #1: 1
Case #2: 2
Case #3: 5
```
## 提示

**Limits**

In the first case, for each juice, we have one person that wants the drink to be made entirely out of that juice! Clearly we can only satisfy one of them.

In the second case, we can satisfy any two of the three preferences.

In the third case, all five people will like the drink if we make it using equal thirds of each juice.

**Limits**

- $1 \leq T \leq 12$

**Small dataset (Test set 1 - Visible)**

- $1 \leq N \leq 10$

**Large dataset (Test set 2 - Hidden)**

- $1 \leq N \leq 5000$


---

---
title: "烹调方案"
layout: "post"
diff: 普及+/提高
pid: P1417
tag: ['动态规划 DP', '排序', '背包 DP']
---
# 烹调方案
## 题目背景

由于你的帮助，火星只遭受了最小的损失。但 gw 懒得重建家园了，就造了一艘飞船飞向遥远的 earth 星。不过飞船飞到一半，gw 发现了一个很严重的问题：肚子饿了 ~。

gw 还是会做饭的，于是拿出了储藏的食物准备填饱肚子。gw 希望能在 $T$ 时间内做出最美味的食物，但是这些食物美味程度的计算方式比较奇葩，于是绝望的 gw 只好求助于你了。
## 题目描述

一共有 $n$ 件食材，每件食材有三个属性，$a_i$，$b_i$ 和 $c_i$，如果在 $t$ 时刻完成第 $i$ 样食材则得到 $a_i-t\times b_i$ 的美味指数，用第 $i$ 件食材做饭要花去 $c_i$ 的时间。

众所周知，gw 的厨艺不怎么样，所以他需要你设计烹调方案使得美味指数最大。
## 输入格式

第一行是两个正整数 $T$ 和 $n$，表示到达地球所需时间和食材个数。

- 下面一行 $n$ 个整数，$a_i$；
- 下面一行 $n$ 个整数，$b_i$；
- 下面一行 $n$ 个整数，$c_i$。
## 输出格式

输出最大美味指数。

## 样例

### 样例输入 #1
```
74 1
502
2
47

```
### 样例输出 #1
```
408
```
## 提示

### 数据范围及约定

- 对于 $40\%$ 的数据 $1 \le n \le 10$；
- 对于 $100\%$ 的数据 $1 \le n \le 50$。

所有数字均小于 $10^5$。

### 题目来源

tinylic 改编



---

---
title: "[NOIP 2010 提高组] 关押罪犯"
layout: "post"
diff: 普及+/提高
pid: P1525
tag: ['图论', '贪心', '2010', '并查集', 'NOIP 提高组', '排序', '二分图']
---
# [NOIP 2010 提高组] 关押罪犯
## 题目背景

NOIP2010 提高组 T3
## 题目描述

S 城现有两座监狱，一共关押着 $N$ 名罪犯，编号分别为 $1\sim N$。他们之间的关系自然也极不和谐。很多罪犯之间甚至积怨已久，如果客观条件具备则随时可能爆发冲突。我们用“怨气值”（一个正整数值）来表示某两名罪犯之间的仇恨程度，怨气值越大，则这两名罪犯之间的积怨越多。如果两名怨气值为 $c$ 的罪犯被关押在同一监狱，他们俩之间会发生摩擦，并造成影响力为 $c$ 的冲突事件。

每年年末，警察局会将本年内监狱中的所有冲突事件按影响力从大到小排成一个列表，然后上报到 S 城 Z 市长那里。公务繁忙的 Z 市长只会去看列表中的第一个事件的影响力，如果影响很坏，他就会考虑撤换警察局长。

在详细考察了 $N$ 名罪犯间的矛盾关系后，警察局长觉得压力巨大。他准备将罪犯们在两座监狱内重新分配，以求产生的冲突事件影响力都较小，从而保住自己的乌纱帽。假设只要处于同一监狱内的某两个罪犯间有仇恨，那么他们一定会在每年的某个时候发生摩擦。

那么，应如何分配罪犯，才能使 Z 市长看到的那个冲突事件的影响力最小？这个最小值是多少？

## 输入格式

每行中两个数之间用一个空格隔开。第一行为两个正整数 $N,M$，分别表示罪犯的数目以及存在仇恨的罪犯对数。接下来的 $M$ 行每行为三个正整数 $a_j,b_j,c_j$，表示 $a_j$ 号和 $b_j$ 号罪犯之间存在仇恨，其怨气值为 $c_j$。数据保证 $1<a_j< b_j\leq N, 0 < c_j\leq 10^9$，且每对罪犯组合只出现一次。

## 输出格式

共一行，为 Z 市长看到的那个冲突事件的影响力。如果本年内监狱中未发生任何冲突事件，请输出 `0`。

## 样例

### 样例输入 #1
```
4 6
1 4 2534
2 3 3512
1 2 28351
1 3 6618
2 4 1805
3 4 12884
```
### 样例输出 #1
```
3512
```
## 提示

**输入输出样例说明**

罪犯之间的怨气值如下面左图所示，右图所示为罪犯的分配方法，市长看到的冲突事件影响力是 $3512$（由 $2$ 号和 $3$ 号罪犯引发）。其他任何分法都不会比这个分法更优。

![](https://cdn.luogu.com.cn/upload/image_hosting/uia11zcq.png)

**数据范围**  

对于 $30\%$ 的数据有 $N\leq 15$。

对于 $70\%$ 的数据有 $N\leq 2000,M\leq 50000$。  

对于 $100\%$ 的数据有 $N\leq 20000,M\leq 100000$。



---

---
title: "[POI 2004] SZP"
layout: "post"
diff: 普及+/提高
pid: P1543
tag: ['搜索', '贪心', '2004', 'POI（波兰）', '树形 DP', '拓扑排序', '基环树']
---
# [POI 2004] SZP
## 题目背景

一班班花 [$\color{red}{\texttt{y}}\color{black}{\texttt{hb}}$](/user/835809) 十分可爱。
## 题目描述

班花 [$\color{red}{\texttt{y}}\color{black}{\texttt{hb}}$](/user/835809) 作为某日的值日班长，在自习课上管理着 $n$ 名同学。除了她以外每一名同学都监视着另一名同学。现在班花 [$\color{red}{\texttt{y}}\color{black}{\texttt{hb}}$](/user/835809) 需要选择尽量多的同学去搬卷子和答题卡，且使得对于这些同学中的每一名同学，至少有一位监视她的同学没有被选中。问班花 [$\color{red}{\texttt{y}}\color{black}{\texttt{hb}}$](/user/835809) 最多可以选择多少同学。

由于班花 [$\color{red}{\texttt{y}}\color{black}{\texttt{hb}}$](/user/835809) 太可爱了，所以没有人监视她，也可以认为她的学号是 $0$。

如果一个人没有被监视，那么她就不能被选择。

## 输入格式

第一行只有一个整数，$n$ 代表同学的数量。同学的学号从 $1$ 到 $n$ 编号。

接下来 $n$ 行每行一个整数 $a_k$ 表示同学 $k$ 将要监视同学 $a_k$，$1 \le k \le n$，$1 \le a_k \le n$，$a_k \ne k$。
## 输出格式

一个数，最多能有多少同学参加入这个任务。
## 样例

### 样例输入 #1
```
6
2
3
1
3
6
5

```
### 样例输出 #1
```
3
```
## 提示

对于 $100\%$ 的数据，$1\le k,a_k\le n\le 10^6$。


---

---
title: "[CQOI2009] 中位数"
layout: "post"
diff: 普及+/提高
pid: P1627
tag: ['数学', '2009', '重庆', '各省省选', '排序']
---
# [CQOI2009] 中位数
## 题目描述

给出 $1,2,...,n$ 的一个排列，统计该排列有多少个长度为奇数的连续子序列的中位数是 $b$。中位数是指把所有元素从小到大排列后，位于中间的数。
## 输入格式

第一行为两个正整数 $n$ 和 $b$，第二行为 $1,2,...,n$ 的排列。
## 输出格式

输出一个整数，即中位数为 $b$ 的连续子序列个数。

## 样例

### 样例输入 #1
```
7 4
5 7 2 4 3 1 6 
```
### 样例输出 #1
```
4
```
## 提示

#### 数据规模与约定

对于 $30\%$ 的数据中，满足 $n \le 100$；

对于 $60\%$ 的数据中，满足 $n \le 1000$；

对于 $100\%$ 的数据中，满足 $n \le 100000,1 \le b \le n$。


---

---
title: "序列合并"
layout: "post"
diff: 普及+/提高
pid: P1631
tag: ['二分', '堆', '排序']
---
# 序列合并
## 题目描述

有两个长度为 $N$ 的**单调不降**序列 $A,B$，在 $A,B$ 中各取一个数相加可以得到 $N^2$ 个和，求这 $N^2$ 个和中最小的 $N$ 个。
## 输入格式

第一行一个正整数 $N$；

第二行 $N$ 个整数 $A_{1\dots N}$。

第三行 $N$ 个整数 $B_{1\dots N}$。



## 输出格式

一行 $N$ 个整数，从小到大表示这 $N$ 个最小的和。
## 样例

### 样例输入 #1
```
3
2 6 6
1 4 8
```
### 样例输出 #1
```
3 6 7
```
## 提示

对于 $50\%$ 的数据，$N \le 10^3$。

对于 $100\%$ 的数据，$1 \le N \le 10^5$，$1 \le a_i,b_i \le 10^9$。


---

---
title: "游览"
layout: "post"
diff: 普及+/提高
pid: P1685
tag: ['图论', '拓扑排序']
---
# 游览
## 题目描述

顺利通过了黄药师的考验，下面就可以尽情游览桃花岛了！

你要从桃花岛的西头开始一直玩到东头，然后在东头的码头离开。可是当你游玩了一次后，发现桃花岛的景色实在是非常的美丽！！！于是你还想乘船从桃花岛东头的码头回到西头，再玩一遍，但是桃花岛有个规矩：你可以游览无数遍，但是每次游玩的路线不能完全一样。

我们把桃花岛抽象成了一个图，共 $n$ 个点代表路的相交处，$m$ 条边表示路，边是有向的（只能按照边的方向行走），且可能有连接相同两点的边。输入保证这个图没有环，而且从西头到东头至少存在一条路线。两条路线被认为是不同的当且仅当它们所经过的路不完全相同。

你的任务是：把所有不同的路线游览完一共要花多少时间？

## 输入格式

第一行为 $5$ 个整数 $n,m,s,t,t_0$，分别表示点数，边数，岛西头的编号，岛东头的编号（编号是从 $1$ 到 $n$）和你乘船从岛东头到西头一次的时间。

以下 $m$ 行，每行 $3$ 个整数 $x,y,t$，表示从点 $x$ 到点 $y$ 有一条行走耗时为 $t$ 的路。

每一行的多个数据之间用一个空格隔开。

## 输出格式

假设总耗时为 $total$，则输出 $total\ \bmod 10000$ 的值（$total$ 对 $10000$ 取余）。

## 样例

### 样例输入 #1
```
3 4 1 3 7
1 2 5
2 3 7
2 3 10
1 3 15

```
### 样例输出 #1
```
56
```
## 提示

【样例说明】

共有 $3$ 条路径可以从点 $1$ 到点 $3$，分别是 $1-2-3$，$1-2-3$，$1-3$。

时间计算为：

$(5+7)+7        +(5+10)+7        +(15)=56$

### 数据范围

$2\leq n\leq 10^4$，$1\leq m\leq 5\times 10^4$，$t\leq 10^4$，$t_0\leq 10^4$。


---

---
title: "[NOIP 2013 普及组] 车站分级"
layout: "post"
diff: 普及+/提高
pid: P1983
tag: ['图论', '贪心', '2013', 'NOIP 普及组', 'O2优化', '排序', '图论建模', '拓扑排序']
---
# [NOIP 2013 普及组] 车站分级
## 题目背景

NOIP2013 普及组 T4
## 题目描述

一条单向的铁路线上，依次有编号为 $1, 2, …, n$ 的 $n $ 个火车站。每个火车站都有一个级别，最低为 $1$ 级。现有若干趟车次在这条线路上行驶，每一趟都满足如下要求：如果这趟车次停靠了火车站 $x$，则始发站、终点站之间所有级别大于等于火车站 $x$ 的都必须停靠。  
注意：起始站和终点站自然也算作事先已知需要停靠的站点。

例如，下表是 $ 5 $ 趟车次的运行情况。其中，前 $ 4$ 趟车次均满足要求，而第 $5$ 趟车次由于停靠了 $3$ 号火车站（$2$ 级）却未停靠途经的 $6$ 号火车站（亦为 $2$ 级）而不满足要求。



 ![](https://cdn.luogu.com.cn/upload/pic/1238.png) 

现有 $m$ 趟车次的运行情况（全部满足要求），试推算这 $ n$ 个火车站至少分为几个不同的级别。

## 输入格式

第一行包含 $2$ 个正整数 $n, m$，用一个空格隔开。

第 $i + 1$ 行 $(1 ≤ i ≤ m)$ 中，首先是一个正整数 $s_i\ (2 ≤ s_i ≤ n)$，表示第 $ i$ 趟车次有 $s_i$ 个停靠站；接下来有 $ s_i$ 个正整数，表示所有停靠站的编号，从小到大排列。每两个数之间用一个空格隔开。输入保证所有的车次都满足要求。

## 输出格式

一个正整数，即 $n$ 个火车站最少划分的级别数。

## 样例

### 样例输入 #1
```
9 2 
4 1 3 5 6 
3 3 5 6 
```
### 样例输出 #1
```
2
```
### 样例输入 #2
```
9 3 
4 1 3 5 6 
3 3 5 6 
3 1 5 9 
```
### 样例输出 #2
```
3
```
## 提示

对于 $ 20\%$ 的数据，$1 ≤ n, m ≤ 10$；

对于 $50\%$ 的数据，$1 ≤ n, m ≤ 100$；

对于 $100\%$ 的数据，$1 ≤ n, m ≤ 1000$。



---

---
title: "[USACO08JAN] Cow Contest S"
layout: "post"
diff: 普及+/提高
pid: P2419
tag: ['2008', 'USACO', '深度优先搜索 DFS', '拓扑排序']
---
# [USACO08JAN] Cow Contest S
## 题目描述

$ N (1 ≤ N ≤ 100) $ cows, conveniently numbered $ 1 ~ N $ , are participating in a programming contest. As we all know, some cows code better than others. Each cow has a certain constant skill rating that is unique among the competitors.

The contest is conducted in several head-to-head rounds, each between two cows. If cow $ A $ has a greater skill level than cow $ B (1 ≤ A ≤ N; 1 ≤ B ≤ N; A ≠ B) $, then cow $ A $ will always beat cow $ B $ .

Farmer John is trying to rank the cows by skill level. Given a list the results of $ M (1 ≤ M ≤ 4,500) $ two-cow rounds, determine the number of cows whose ranks can be precisely determined from the results. It is guaranteed that the results of the rounds will not be contradictory.

FJ的 $N$（$1 \leq N \leq 100$）头奶牛们最近参加了场程序设计竞赛。在赛场上，奶牛们按 $1, 2, \cdots, N$ 依次编号。每头奶牛的编程能力不尽相同，并且没有哪两头奶牛的水平不相上下，也就是说，奶牛们的编程能力有明确的排名。 整个比赛被分成了若干轮，每一轮是两头指定编号的奶牛的对决。如果编号为 $A$ 的奶牛的编程能力强于编号为 $B$ 的奶牛 （$1 \leq A, B \leq N$，$A \neq B$)，那么她们的对决中，编号为 $A$ 的奶牛总是能胜出。 FJ 想知道奶牛们编程能力的具体排名，于是他找来了奶牛们所有 $M$（$1 \leq M \leq 4,500$）轮比赛的结果，希望你能根据这些信息，推断出尽可能多的奶牛的编程能力排名。比赛结果保证不会自相矛盾。
## 输入格式

第一行两个用空格隔开的整数 $N, M$。

第 $2\sim M + 1$ 行，每行为两个用空格隔开的整数 $A, B$ ，描述了参加某一轮比赛的奶牛的编号，以及结果（每行的第一个数的奶牛为**胜者**）。
## 输出格式

输出一行一个整数，表示排名可以确定的奶牛的数目。

## 样例

### 样例输入 #1
```
5 5
4 3
4 2
3 2
1 2
2 5
```
### 样例输出 #1
```
2

```
## 提示

样例解释：

编号为 $2$ 的奶牛输给了编号为 $1, 3, 4$ 的奶牛，也就是说她的水平比这 $3$ 头奶牛都差。而编号为 $5$ 的奶牛又输在了她的手下，也就是说，她的水平比编号为 $5$ 的奶牛强一些。于是，编号为 $2$ 的奶牛的排名必然为第 $4$，编号为 $5$ 的奶牛的水平必然最差。其他 $3$ 头奶牛的排名仍无法确定。


---

---
title: "[ZJOI2004] 午餐"
layout: "post"
diff: 普及+/提高
pid: P2577
tag: ['动态规划 DP', '2004', '各省省选', '浙江', '排序']
---
# [ZJOI2004] 午餐
## 题目描述

上午的训练结束了，THU ACM小组集体去吃午餐，他们一行N人来到了著名的十食堂。这里有两个打饭的窗口，每个窗口同一时刻只能给一个人打饭。由于每个人的口味（以及胃口）不同，所以他们要吃的菜各有不同，打饭所要花费的时间是因人而异的。另外每个人吃饭的速度也不尽相同，所以吃饭花费的时间也是可能有所不同的。

THU ACM小组的吃饭计划是这样的：先把所有的人分成两队，并安排好每队中各人的排列顺序，然后一号队伍到一号窗口去排队打饭，二号队伍到二号窗口去排队打饭。每个人打完饭后立刻开始吃，所有人都吃完饭后立刻集合去六教地下室进行下午的训练。

现在给定了每个人的打饭时间和吃饭时间，要求安排一种最佳的分队和排队方案使得所有人都吃完饭的时间尽量早。

假设THU ACM小组在时刻0到达十食堂，而且食堂里面没有其他吃饭的同学（只有打饭的师傅）。每个人必须而且只能被分在一个队伍里。两个窗口是并行操作互不影响的，而且每个人打饭的时间是和窗口无关的，打完饭之后立刻就开始吃饭，中间没有延迟。

现在给定N个人各自的打饭时间和吃饭时间，要求输出最佳方案下所有人吃完饭的时刻。

## 输入格式

第一行一个整数N，代表总共有N个人。

以下N行，每行两个整数 Ai，Bi。依次代表第i个人的打饭时间和吃饭时间。

## 输出格式

一个整数T，代表所有人吃完饭的最早时刻。

## 样例

### 样例输入 #1
```
5

2 2

7 7

1 3

6 4

8 5


```
### 样例输出 #1
```
17
```
## 提示

所有输入数据均为不超过200的正整数。



---

---
title: "[NOIP 2015 普及组] 求和"
layout: "post"
diff: 普及+/提高
pid: P2671
tag: ['2015', '线性数据结构', 'NOIP 普及组', '排序', '前缀和']
---
# [NOIP 2015 普及组] 求和
## 题目背景

NOIP2015 普及组 T3
## 题目描述

一条狭长的纸带被均匀划分出了 $n$ 个格子，格子编号从 $1$ 到 $n$。每个格子上都染了一种颜色 $color_i$ 用 $[1,m]$ 当中的一个整数表示），并且写了一个数字 $number_i$。

| 编号 | 1 | 2 | 3 | 4 | 5 | 6 |
| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |
| **颜色和数字** | $\color{blue}{5}$ | $\color{blue}{5}$ | $\color{red}{3}$ | $\color{red}{2}$ | $\color{blue}{2}$ | $\color{red}{2}$ |

定义一种特殊的三元组：$(x,y,z)$，其中 $x,y,z$ 都代表纸带上格子的编号，这里的三元组要求满足以下两个条件：

1. $x,y,z$ 都是整数，$x<y<z,y-x=z-y$。

2. $color_x=color_z$。

满足上述条件的三元组的分数规定为 $(x+z) \times (number_x+number_z)$。整个纸带的分数规定为所有满足条件的三元组的分数的和。这个分数可能会很大，你只要输出整个纸带的分数除以 $10007$ 所得的余数即可。

## 输入格式

第一行是用一个空格隔开的两个正整数 $n$ 和 $m,n$ 表纸带上格子的个数，$m$ 表纸带上颜色的种类数。

第二行有 $n$ 用空格隔开的正整数，第 $i$ 个数字表示纸带上编号为 $i$ 格子上面写的数字 $number_i$。

第三行有 $n$ 用空格隔开的正整数，第 $i$ 数字表示纸带上编号为 $i$ 格子染的颜色 $color_i$。

## 输出格式

一个整数，表示所求的纸带分数除以 $10007$ 所得的余数。

## 样例

### 样例输入 #1
```
6 2
5 5 3 2 2 2
2 2 1 1 2 1
```
### 样例输出 #1
```
82

```
### 样例输入 #2
```
15 4
5 10 8 2 2 2 9 9 7 7 5 6 4 2 4
2 2 3 3 4 3 3 2 4 4 4 4 1 1 1
```
### 样例输出 #2
```
1388
```
## 提示

**样例 1 解释**

纸带如题目描述中的图所示。

所有满足条件的三元组为：$(1, 3, 5), (4, 5, 6)$。

所以纸带的分数为 $(1 + 5) \times (5 + 2) + (4 + 6) \times (2 + 2) = 42 + 40 = 82$。


对于第 $1$ 组至第 $2$ 组数据， $1 ≤ n ≤ 100, 1 ≤ m ≤ 5$；

对于第 $3$ 组至第 $4$ 组数据，$1 ≤ n ≤ 3000, 1 ≤ m ≤ 100$；

对于第 $5$ 组至第 $ 6 $ 组数据，$1 ≤ n ≤ 100000, 1 ≤ m ≤ 100000$，且不存在出现次数超过 $ 20 $ 的颜色；

对于全部 $10$ 组数据，$1 ≤ n ≤ 100000, 1 ≤ m ≤ 100000, 1 ≤ color_i ≤ m,1≤number_i≤100000$。



---

---
title: "[USACO3.1] 丑数 Humble Numbers"
layout: "post"
diff: 普及+/提高
pid: P2723
tag: ['搜索', '数学', 'USACO', '平衡树', '枚举', '排序']
---
# [USACO3.1] 丑数 Humble Numbers
## 题目描述

对于一给定的素数集合 $S = \{ p_1, p_2, ..., p_k \}$, 考虑一个正整数集合，该集合中任一元素的质因数全部属于 $S$。这个正整数集合包括，$p_1$、$p_1 \times p_2$、$p_1 \times p_1$、$p_1 \times p_2 \times p_3$ ...(还有其它)。该集合被称为 $S$ 集合的“丑数集合”。注意：我们认为 $1$不是一个丑数。

你的工作是对于输入的集合 $S$ 去寻找“丑数集合”中的第 $n$ 个“丑数”。保证答案可以用 32 位有符号整数表示。

补充：丑数集合中每个数从小到大排列，每个丑数都是素数集合中的数的乘积，第 $n$ 个“丑数”就是在能由素数集合中的数相乘得来的（包括它本身）第 $n$ 小的数。

## 输入格式

输入的第一行是两个的整数，分别代表集合 $S$ 的大小 $k$ 和给定的参数 $n$。

输入的第二行有 $k$ 互不相同的整数，第 $i$ 个整数代表 $p_i$。
## 输出格式

输出一行一个整数，代表答案。
## 样例

### 样例输入 #1
```
4 19
2 3 5 7
```
### 样例输出 #1
```
27
```
## 提示

#### 数据规模与约定

对于 $100\%$ 的数据，保证：

- $1 \leq k \leq 100$。
- $1 \leq n \leq 10^5$。
- $2 \leq p_i < 2^{31}$，且 $p_i$ 一定为质数。

---
#### 说明

题目翻译来自 NOCOW。

USACO Training Section 3.1



---

---
title: "[USACO10OCT] Dinner Time S"
layout: "post"
diff: 普及+/提高
pid: P2994
tag: ['贪心', '2010', 'USACO', '排序']
---
# [USACO10OCT] Dinner Time S
## 题目描述

Farmer John's N (1 <= N <= 1,000) cows conveniently numbered 1..N are participating in the IOI in Bulgaria. The cows like the Bulgarian sun and are enjoying their holiday. All seems well.

This changes around dinner time. The restaurant is rather small, having only M (1 <= M <= N) cow seats conveniently numbered 1..M. Each cow starts at a location CX\_i, CY\_i (-1,000,000 <= CX\_i <= 1,000,000; -1,000,000 <= CY\_i <= 1,000,000); the seats can be found at SX\_j, SY\_j (-1,000,000 <= SX\_j <= 1,000,000; -1,000,000 <= SY\_j <= 1,000,000).

The cows have a very efficient (though primitive) method to distribute themselves into the seats. As soon as a cow is certain she will get to a seat first, she rushes there as fast as she can (all cows runs equally fast).

Farmer John's cows, like all prize cows, have no problem jumping over seats, tables, or other cows, so they can run in a straight line. When multiple cows can reach a seat at the very same time, the oldest cow (the one appearing earlier in the input data) gets the seat.  Likewise, when a cow can be the first to reach multiple seats she will also choose the one appearing earliest in the input.

Some cows won't be able to eat dinner, and those hungry cows are collectively planning to steal Farmer John's very own food. Farmer John would like a list of cows he should be wary of. (In the case when there are no hungry cows, output 0). Can you help him?

NOTE: Standard distance calculations will likely require an

intermediate result that will fit into a 64-bit integer but not into a 32-bit integer.
## 输入格式

\* Line 1: Two space-separated integers: N and M

\* Lines 2..N+1: Line i+1 contains two space separated integers: CX\_i and CY\_i

\* Lines N+2..N+M+1: Line j+N+1 contains two space separated integers: SX\_j and SY\_j
## 输出格式

\* Lines 1..N-M: Line i contains the number of the ith cow that Farmer John should be wary of. The cow numbers should be listed in increasing order.
## 样例

### 样例输入 #1
```
2 1 
0 1 
1 0 
1 10 

```
### 样例输出 #1
```
2 

```
## 提示

2 cows: Cow 1 starts at (0, 1) and cow 2 at (1, 0). There 

is only 1 seat at (1, 10). 

Cow 1 is closer to the seat than cow 2, so cow 1 will get the only seat.

## 题目翻译

## 题目描述

农场主约翰的 $N$（$1 \le N \le 10 ^ 3$）头奶牛被编号为 $1 \sim N$，它们正在保加利亚参加 IOI。奶牛们喜欢保加利亚的太阳并享受着它们的假日，一切看起来都没问题。

变化发生在晚餐时间前后。这家餐馆很小，只有 $M$（$1 \le M \le N$）个座位，编号为 $1 \sim M$。每头牛从一个位置 $CX_i$，$CY_i$ 进入餐馆（$-10 ^ 6 \le CX_i \le 10 ^ 6,-10 ^ 6 \le CY_i \le 10 ^ 6$）；座位可以在 $SX_j$，$SY_j$ 找到（$-10 ^ 6 \le SX_j \le10 ^ 6,-10 ^ 6\le SY_j\le 10 ^ 6$）。



奶牛有一种非常有效的（尽管很原始）方法把自己分配到座位上。一旦某只奶牛确定她会先到某个座位上，她就会尽快赶到那里（所有的奶牛都跑得一样快）。



农场主约翰的奶牛和所有获奖的奶牛一样，跳过座位、桌子或其他奶牛都没有问题，因此它们可以直线奔跑。当多头牛可以同时到达一个座位时，最老的牛（在输入数据中出现得更早的牛）获得座位。当一头牛可以第一个到达多个座位时，她也会选择在输入中最早出现的座位。



一些奶牛将不能吃晚饭，这些吃不到饭的饥饿的奶牛正集体计划偷农场主约翰自己的食物。农场主约翰想要一份他应该提防的奶牛名单。（如果没有饥饿的奶牛，则输出 $0$）。你能帮他吗？



注：在计算中可能会有超过 $32$ 位整数范围但在 $64$ 位整数范围内的数。

------------


## 输入格式

第一行：两个空格分隔的整数：$N$ 和 $M$。

第 $2 \sim N + 1$ 行：第 $i+1$ 行包含两个空格分隔的整数：$CX_i$ 和 $CY_i$。



第 $N+2 \sim N+M+1$ 行：行 $j+N+1$ 包含两个空格分隔的整数：$SX_j$ 和 $SY_j$。


------------

##  输出格式

第 $1$ 行到第 $(N-M)$ 行：第 $i$ 行包含农场主约翰应该提防的第 $i$ 头牛的编号。奶牛的编号应递增排序。




---

---
title: "[USACO13FEB] Tractor S"
layout: "post"
diff: 普及+/提高
pid: P3073
tag: ['搜索', '2013', '二分', 'USACO', '并查集', '排序', '生成树']
---
# [USACO13FEB] Tractor S
## 题目描述

One of Farmer John's fields is particularly hilly, and he wants to purchase a new tractor to drive around on it.  The field is described by an N x N grid of non-negative integer elevations (1 <= N <= 500).  A tractor capable of moving from one grid cell to an adjacent cell (one step north, east, south, or west) of height difference D costs exactly D units of money.

FJ would like to pay enough for his tractor so that, starting from some grid cell in his field, he can successfully drive the tractor around to visit at least half the grid cells in the field (if the number of total cells in the field is odd, he wants to visit at least half the cells rounded up).  Please help him compute the minimum cost necessary for buying a tractor capable of this task.

## 输入格式

\* Line 1: The value of N.

\* Lines 2..1+N: Each line contains N space-separated non-negative integers (each at most 1 million) specifying a row of FJ's field.





## 输出格式

\* Line 1: The minimum cost of a tractor that is capable of driving around at least half of FJ's field.



## 样例

### 样例输入 #1
```
5 
0 0 0 3 3 
0 0 0 0 3 
0 9 9 3 3 
9 9 9 3 3 
9 9 9 9 3 

```
### 样例输出 #1
```
3 

```
## 题目翻译

题目描述

FJ有块农田太崎岖了，他要买一辆新拖拉机才能在这里巡视。这块农田由N x N个格子的非负整数表示高度(1<=N<=500)。拖拉机从当前格子走到相邻格子（东、南、西、北四个方向）的代价为高度差D，则FJ驶过这两个格子的拖拉机最少也要值D块钱。

FJ愿意花足够的钱买一辆新的拖拉机使得他能以最小的高度差走遍所有格子的一半(如果格子总数是奇数，那么一半的值为四舍五入的值)。因为FJ很懒，所以他找到你帮他编程计算他最小需要花多少钱买到符合这些要求的拖拉机。

输入输出格式

输入格式：

第一行为一个整数N

第2到N+1行每行包含N个非负整数（不超过1,000,000），表示当前格子的高度。

输出格式：

共一行，表示FJ买拖拉机要花的最小价钱。


---

---
title: "[USACO15JAN] Meeting Time S"
layout: "post"
diff: 普及+/提高
pid: P3116
tag: ['动态规划 DP', '2015', 'USACO', '拓扑排序']
---
# [USACO15JAN] Meeting Time S
## 题目描述

Bessie and her sister Elsie want to travel from the barn to their favorite field, such that they leave at exactly the same time from the barn, and also arrive at exactly the same time at their favorite field.

The farm is a collection of N fields (1 <= N <= 100) numbered 1..N, where field 1 contains the barn and field N is the favorite field. The farm is built on the side of a hill, with field X being higher in elevation than field Y if X < Y.  An assortment of M paths connect pairs of fields.  However, since each path is rather steep, it can only be followed in a downhill direction. For example, a path connecting field 5 with field 8 could be followed in the 5 -> 8 direction but not the other way, since this would be uphill.  Each pair of fields is connected by at most one path, so M <= N(N-1)/2.

It might take Bessie and Elsie different amounts of time to follow a path; for example, Bessie might take 10 units of time, and Elsie 20. Moreover, Bessie and Elsie only consume time when traveling on paths between fields -- since they are in a hurry, they always travel through a field in essentially zero time, never waiting around anywhere.

Please help determine the shortest amount of time Bessie and Elsie must take in order to reach their favorite field at exactly the same moment.

## 输入格式

The first input line contains N and M, separated by a space.

Each of the following M lines describes a path using four integers A B C D, where A and B (with A < B) are the fields connected by the path, C is the time required for Bessie to follow the path, and D is the time required for Elsie to follow the path.  Both C and D are in the range 1..100.

## 输出格式

A single integer, giving the minimum time required for Bessie and Elsie to travel to their favorite field and arrive at the same moment.

If this is impossible, or if there is no way for Bessie or Elsie to reach the favorite field at all, output the word IMPOSSIBLE on a single line.

## 样例

### 样例输入 #1
```
3 3 
1 3 1 2 
1 2 1 2 
2 3 1 2 

```
### 样例输出 #1
```
2 
```
## 提示

SOLUTION NOTES:

Bessie is twice as fast as Elsie on each path, but if Bessie takes the path 1->2->3 and Elsie takes the path 1->3 they will arrive at the same time.


## 题目翻译

### 题目描述

$\texttt{Bessie}$ 和她的妹妹 $\texttt{Elsie}$ 想从粮仓去她们最喜欢的田地，也就是能够使她们一起从粮仓离开，并且能同一时间到达的田地。

这个农场是由 $N$ 块 $(1\leq N\leq 100)$ 编号为 $1\cdots N$ 的田地构成的，第一块田地就是粮仓，并且第 $N$ 块田地是她们最喜欢的田地。

这个农场建在山的一边，所以，如果 $X < Y$ 的话则满足第 $X$ 块田地的高度要高于第 $Y$ 块田地的高度。在这之中，有 $M$ 条交错纵横的路径将不同的田地连接起来。

不过，显而易见的是，因为每条路都太陡了，所以这些小路只能沿着从高到低的方向走。例如，一条连接第 $5$ 块田地和 $8$ 块田地的小路只能沿着 $5\to 8$ 的方向走，而不能沿着其他方向，因为那样会成为上坡路。每两块田地最多只能有一条路径相连接，所以一定有 $M \leq \dfrac{N(N-1)}{2}$。

有可能的是，$\texttt{Bessie}$ 和 $\texttt{Elsie}$ 两个人走同一条小路会耗费不同的时间；比如，通过同一条小路，$\texttt{Bessie}$ 可能会耗费 $10$ 个单位的时间，而 $\texttt{Elsie}$ 会耗费 $20$ 个单位的时间。

此外，$\texttt{Bessie}$ 和 $\texttt{Elsie}$ 只会在通过连接两块田地的小路时耗费时间——因为她们太匆忙了，在穿过田地时不会耗费任何时间，也从来不在任何地方停下来等待。

现在，请你判断出，能够满足使 $\texttt{Bessie}$ 和 $\texttt{Elsie}$ 同时出发并且同时到达她们喜欢的田地的最短的时间。

### 输入格式

第一行输入 $N$ 和 $M$，中间用空格分开。

接下来的 $M$ 行，每行有四个整数 $A,B,C,D$，其中，$A$ 和$B(A<B)$ 代表着两块用这条小路连接的田地，$C$ 代表 $\texttt{Bessie}$ 通过这条小路的时间，而 $D$ 代表 $\texttt{Elsie}$ 通过这条小路的时间。$C$ 和 $D$ 均在 $1\cdots100$ 的范围之内。

### 输出格式

一个整数，输出的是能够使两人同时出发并且同时到达目的地的最短时间，如果没有满足条件的答案，则输出 `IMPOSSIBLE`。

### 说明与提示

$\texttt{Bessie}$ 在每一条路都比 $\texttt{Elsie}$ 快两倍。

如果 $\texttt{Bessie}$ 经过 $1\to 2\to 3$ 的路线，$\texttt{Elsie}$ 经过 $1\to 3$ 的路线，他们可以同时到达。


---

---
title: "[USACO16OPEN] Splitting the Field G"
layout: "post"
diff: 普及+/提高
pid: P3145
tag: ['2016', 'USACO', '枚举', '排序', 'ST 表']
---
# [USACO16OPEN] Splitting the Field G
## 题目描述

Farmer John's $N$ cows ($3 \leq N \leq 50,000$) are all located at distinct positions in his two-dimensional field.  FJ wants to enclose all of the cows with a rectangular fence whose sides are parallel to the x and y axes, and hewants this fence to be as small as possible so that it contains every cow (cowson the boundary are allowed).

FJ is unfortunately on a tight budget due to low milk production last quarter.He would therefore like to enclose a smaller area to reduce maintenance costs,and the only way he can see to do this is by building two enclosures instead of one.  Please help him compute how much less area he needs to enclose, in total,by using two enclosures instead of one. Like the original enclosure, the two enclosures must collectively contain all the cows (with cows on boundaries allowed), and they must have sides parallel to the x and y axes.  The two enclosures are not allowed to overlap -- not even on their boundaries. Note that enclosures of zero area are legal, for example if an enclosure has zero width and/or zero height.
## 输入格式

The first line of input contains $N$.  The next $N$ lines each contain two integers specifying the location of a cow. Cow locations are positive integers in the range $1 \ldots 1,000,000,000$.
## 输出格式

Write a single integer specifying amount of total area FJ can save by using two enclosures instead of one.
## 样例

### 样例输入 #1
```
6
4 2
8 10
1 1
9 12
14 7
2 3
```
### 样例输出 #1
```
107
```
## 题目翻译

### 题目描述

Farmer John 的 $N$ 头奶牛（$3 \leq N \leq 50,000$）位于他二维牧场的不同位置。FJ 想要用一个与 x 轴和 y 轴平行的矩形围栏将所有奶牛围住，并且他希望这个围栏尽可能小，以便它包含每一头奶牛（允许奶牛位于边界上）。

由于上季度牛奶产量低，FJ 的预算紧张。因此，他希望围住更小的区域以减少维护成本，而他唯一能想到的方法就是建造两个围栏而不是一个。请帮助他计算使用两个围栏而不是一个围栏总共可以减少多少面积。与原始围栏一样，这两个围栏必须共同包含所有奶牛（允许奶牛位于边界上），并且它们的边必须与 $x$ 轴和 $y$ 轴平行。这两个围栏不允许重叠——即使在它们的边界上也不行。注意，零面积的围栏是合法的，例如如果一个围栏的宽度和/或高度为零。

### 输入格式

输入的第一行包含 $N$。接下来的 $N$ 行每行包含两个整数，指定一头奶牛的位置。奶牛的位置是 $1 \ldots 1,000,000,000$ 范围内的正整数。

### 输出格式

输出一个整数，表示 FJ 通过使用两个围栏而不是一个围栏总共可以减少的面积。


---

---
title: "魔法"
layout: "post"
diff: 普及+/提高
pid: P3619
tag: ['贪心', '洛谷原创', '排序']
---
# 魔法
## 题目描述

cjwssb 知道是误会之后，跟你道了歉。你为了逗笑他，准备和他一起开始魔法。不过你的时间不多了，但是更惨的是你还需要完成 $n$ 个魔法任务。假设你当前的时间为 $T$，每个任务需要有一定的限制 $t_i$ 表示只有当你的 $T$ 严格大于 $t_i$ 时你才能完成这个任务，完成任务并不需要消耗时间。当你完成第 $i$ 个任务时，你的时间 $T$ 会加上 $b_i$，此时要保证 $T$ 在任何时刻都大于 $0$，那么请问你是否能完成这 $n$ 个魔法任务，如果可以，输出 $\texttt{+1}\texttt{s}$，如果不行，输出 $\texttt{-1}\texttt{s}$。

## 输入格式

第一行：一个整数 $Z$，表示有 $Z$ 个测试点。

对于每个测试点：

第一行：两个整数 $n,T$，表示有 $n$ 个任务,你一开始有 $T$ 的时间。

接下来 $n$ 行，每行 $2$ 个数字，$t_i$ 与 $b_i$。

## 输出格式

对于每个测试点，输出 $\texttt{+1}\texttt{s}$ 或者 $\texttt{-1}\texttt{s}$。

## 样例

### 样例输入 #1
```
1
2 13
1 -9
5 -3

```
### 样例输出 #1
```
+1s

```
## 提示

对于 $20\%$ 的数据，$n\leq10$；

对于 $100\%$ 的数据，$n\leq10^5,Z\leq10,t_i\leq10^5,T\leq10^5,-10^5\leq b_i\leq 10^5$。

By lantian

$\LaTeX$ By ⚡炭治郎⚡

## 因为历史遗留问题，博客讨论可能无法发出样例输出的字符串，可以考虑使用其他方式规避。



---

---
title: "[USACO17FEB] Why Did the Cow Cross the Road I S"
layout: "post"
diff: 普及+/提高
pid: P3661
tag: ['贪心', '2017', 'USACO', '排序']
---
# [USACO17FEB] Why Did the Cow Cross the Road I S
## 题目描述

Farmer John's cows are trying to learn to cross the road effectively. Remembering the old "why did the chicken cross the road?" joke, they figure the chickens must be experts on crossing the road, and go off in search of chickens to help them.

As it turns out, chickens are very busy creatures and have limited time to help the cows. There are $C$ chickens on the farm ($1 \leq C \leq 20,000$), conveniently numbered $1 \ldots C$, and each chicken $i$ is only willing to help a cow at precisely time $T_i$. The cows, never in a hurry, have more flexibility in their schedules. There are $N$ cows on the farm ($1 \leq N \leq 20,000$), conveniently numbered $1 \ldots N$, where cow $j$ is able to cross the road between time $A_j$ and time $B_j$. Figuring the "buddy system" is the best way to proceed, each cow $j$ would ideally like to find a chicken $i$ to help her cross the road; in order for their schedules to be compatible, $i$ and $j$ must satisfy $A_j \leq T_i \leq B_j$.

If each cow can be paired with at most one chicken and each chicken with at most one cow, please help compute the maximum number of cow-chicken pairs that can be constructed.
## 输入格式

The first line of input contains $C$ and $N$. The next $C$ lines contain $T_1 \ldots T_C$, and the next $N$ lines contain $A_j$ and $B_j$ ($A_j \leq B_j$) for $j = 1 \ldots N$. The $A$'s, $B$'s, and $T$'s are all non-negative integers (not necessarily distinct) of size at most 1,000,000,000
## 输出格式

Please compute the maximum possible number of cow-chicken pairs.

## 样例

### 样例输入 #1
```
5 4
7
8
6
2
9
2 5
4 9
0 3
8 13
```
### 样例输出 #1
```
3
```
## 题目翻译

### 题目描述

Farmer John 的奶牛们正在学习如何有效地过马路。回想起古老的“鸡为什么要过马路？”笑话，他们认为鸡一定是过马路的专家，于是去寻找鸡来帮助它们。

事实上，鸡是非常忙碌的生物，它们只有有限的时间来帮助奶牛。农场上有 $C$ 只鸡（$1 \leq C \leq 20,000$），方便地用编号 $1 \ldots C$ 标识，每只鸡 $i$ 只愿意在确切的时间 $T_i$ 帮助一头奶牛。奶牛们从不着急，它们的日程安排更加灵活。农场上有 $N$ 头奶牛（$1 \leq N \leq 20,000$），方便地用编号 $1 \ldots N$ 标识，其中奶牛 $j$ 能够在时间 $A_j$ 到时间 $B_j$ 之间过马路。考虑到“伙伴系统”是最好的方式，每头奶牛 $j$ 理想情况下希望找到一只鸡 $i$ 来帮助她过马路；为了使它们的日程安排兼容，$i$ 和 $j$ 必须满足 $A_j \leq T_i \leq B_j$。

如果每头奶牛最多只能与一只鸡配对，每只鸡也最多只能与一头奶牛配对，请计算可以构建的最大奶牛-鸡配对数。

### 输入格式

输入的第一行包含 $C$ 和 $N$。接下来的 $C$ 行包含 $T_1 \ldots T_C$，接下来的 $N$ 行包含 $A_j$ 和 $B_j$（$A_j \leq B_j$），其中 $j = 1 \ldots N$。$A$、$B$ 和 $T$ 都是不超过 1,000,000,000 的非负整数（不一定互不相同）。

### 输出格式

请计算可能的奶牛-鸡配对的最大数量。


---

---
title: "[TJOI2010] 中位数"
layout: "post"
diff: 普及+/提高
pid: P3871
tag: ['2010', '各省省选', '平衡树', 'O2优化', '排序', '天津']
---
# [TJOI2010] 中位数
## 题目描述

给定一个由 $N$ 个元素组成的整数序列，现在有两种操作：

- $\texttt{1 add }\textit{a}$：在该序列的最后添加一个整数 $a$，组成长度为 $N + 1$ 的整数序列。
- $\texttt{2 mid}$：输出当前序列的中位数。

中位数是指将一个序列按照从小到大排序后处在中间位置的数。（若序列长度为偶数，则指处在中间位置的两个数中较小的那个）

例 $1$：$[1, 2, 13, 14, 15, 16]$ 中位数为 $13$。  
例 $2$：$[1, 3, 5, 7, 10, 11, 17]$ 中位数为 $7$。  
例 $3$：$[1, 1, 1, 2, 3]$ 中位数为 $1$。

## 输入格式

第一行为初始序列长度 $N$。第二行为 $N$ 个整数，表示整数序列，数字之间用空格分隔。第三行为操作数 $M$，即要进行 $M$ 次操作。下面为 $M$ 行，每行输入格式如题意所述。

## 输出格式

对于每个 $\verb!mid!$ 操作输出中位数的值。
## 样例

### 样例输入 #1
```
6
1 2 13 14 15 16
5
add 5
add 3
mid
add 20
mid

```
### 样例输出 #1
```
5
13

```
## 提示

### 数据范围及约定

- 对于 $30\%$ 的数据，$1 ≤ N ≤ 10,000$，$0 ≤ M ≤ 1,000$。
- 对于 $100\%$ 的数据，$1 ≤ N ≤ 100,000$，$0 ≤ M ≤ 10,000$。

序列中整数的绝对值不超过 $10^9$，序列中的数可能有重复。


---

---
title: "数列找不同"
layout: "post"
diff: 普及+/提高
pid: P3901
tag: ['模拟', '莫队', '排序', '进制']
---
# 数列找不同
## 题目描述

现有数列 $A_1,A_2,\ldots,A_N$，$Q$ 个询问 $(L_i,R_i)$，询问 $A_{L_i} ,A_{L_i+1},\ldots,A_{R_i}$ 是否互不相同。

## 输入格式

第一行，两个整数$N,Q$。  
第二行，$N$ 个整数$A_1, A_2, \ldots , A_N$。  
接下来 $Q$ 行，每行两个整数 $L_i,R_i$。
## 输出格式

对每个询问输出一行，`Yes` 或 `No`。

## 样例

### 样例输入 #1
```
4 2
1 2 3 2
1 3
2 4
```
### 样例输出 #1
```
Yes
No
```
## 提示

对于 $50\%$ 的数据，$N,Q  \le 10^3$。  
对于 $100\%$ 的数据，$1 \le N,Q \le 10^5$，$1 \le A_i \le N$，$1 \le L_i \le R_i \le N$。


---

---
title: "肮脏的牧师"
layout: "post"
diff: 普及+/提高
pid: P3944
tag: ['搜索', '贪心', '排序']
---
# 肮脏的牧师
## 题目背景

@Yumis 出题人在这里哦~

## 题目描述

Yumis最近在玩炉石传说。

在炉石传说中脏牧有一张一费卡片（一费就是使用要消耗1点法力水晶），叫做疯狂药水，这个的效果是将一个敌方场上攻击小于等于2的随从拉到自己的战场内。

还有一张四费卡片叫做暗影狂乱，这个的效果是将一个敌方场上攻击小于等于3的随从拉到自己的战场内。

还有一张一费卡片就是缩小药水，这个的效果是将敌人全场的随从攻击力下降3点。


你PY了炉石的GM所以你有了无数张的这三种卡片，但是GM告诉你缩小药水是这个牌比较不好创建，为了为GM着想你必须在使用**最少的缩小药水**的情况下A爆对手的脸。


现在你的对手场上有n个随从，每个随从的攻击力是ki点。

你的对手有m点血量。


而你现在要做的就是将敌方的场上的随从拉过来自己的场上并攻击对手（每一个随从只能攻击一次，攻击力为你拉过来的时候随从剩余的攻击力），A爆对面的脸（将对面的血打到0点及以下）。

## 输入格式

第一行用一个空格隔开的两个整数n,m分别代表敌方场上的随从数量和你对手的血量。

第二行n个整数每两个整数之间用一个空格隔开，分别代表敌方场上每一个随从的攻击力ki。

## 输出格式

一行如果可以A爆则输出**最少使用的缩小药水的数量**和此时使用的法力水晶，两个数据之间用一个空格隔开（如果有多个答案则输出消耗法力水晶最少的答案）。

否则输出“Human Cannot Win Dog”（没有双引号）

## 样例

### 样例输入 #1
```
3 5
1 2 3 

```
### 样例输出 #1
```
0 5
```
### 样例输入 #2
```
8 8
10 20 30 40 50 60 70 80

```
### 样例输出 #2
```
16 23
```
### 样例输入 #3
```
8 80
10 20 30 40 50 60 70 80

```
### 样例输出 #3
```
Human Cannot Win Dog
```
## 提示

样例说明1：

敌方场上有3只随从，敌方有5点血量

我们把3攻随从和2攻随从拉过来花费0个缩小药水和5点耗费（一张疯狂药水一个暗影狂乱（1+4 = 5））伤害足够击杀对方。


样例说明2：

使用16个缩小药水（下面数据后面第一个括号指拉过来的时候伤害为多高 ，第二个括号表示拉过来的时候使用多少的缩小药水）

拿10（1）（3）、20（2）（6）、30（3）（9）、50（2）（16）攻的怪物总共造成8点伤害 刚好A爆！



Easy : 保证 0 < n <= 10  并且不存在用到暗影狂乱和缩小药水的情况    20%


Normal ：保证 0 < n <= 10  并且不存在用到缩小药水的情况           20%


Hard ：保证 0 < n <= 10                                                 30%


Extra：保证0 <= n <= 5000000(6个0)，最大攻击力小于30000                  30%


保证 0 < n <= 5000000     0 < ki <=30000    0<=m<=5000000 (6个0)



---

---
title: "不开心的金明"
layout: "post"
diff: 普及+/提高
pid: P3985
tag: ['模拟', '排序', '背包 DP', '进制', '洛谷月赛']
---
# 不开心的金明
## 题目描述

金明今天很不开心，家里购置的二手房就要领钥匙了，房里并没有一间他自己专用的很宽敞的房间。更让他不高兴的是，妈妈昨天对他说：“你需要购买哪些物品，怎么布置，你说了不算（有很大的限制），而且不超过 $W$ 元钱。”。今天一早金明就开始做预算，但是他想买的东西太多了，肯定会超过妈妈限定的 $W$ 元。于是，他把每件物品规定了一个重要度整数 $p_i$ 表示。他还从因特网上查到了每件物品的价格 $v_i$（都是整数元）。

妈妈看到购物单后进行了审查，要求购物单上所有的物品价格的极差（最贵的减去最便宜的）不超过 $3$（当然金明至今不知道为什么会这样）。他希望在不超过 $W$ 元（可以等于 $W$ 元）的前提下，使购买的重要度总和 $\sum p_i$ 的最大。


请你帮助金明设计一个满足要求的购物单，你只需要告诉我们重要度的最大的和。

## 输入格式

输入的第 $1$ 行，为两个正整数，用一个空格隔开：

$n,W$（其中 $W$ 表示总钱数，$n$ 为希望购买物品的个数。）

从第 $2$ 行到第 $n+1$ 行，第 $j$ 行给出了编号为 $j-1$ 的物品的基本数据，每行有 $2$ 个非负整数 $v_p$（其中 $v$ 表示该物品的价格，$p$ 表示该物品的重要度）
## 输出格式

输出只有一个正整数，为不超过总钱数的物品的重要度的总和的最大值。
## 样例

### 样例输入 #1
```
5 10
2 800
5 400
5 300
3 400
2 200

```
### 样例输出 #1
```
1600
```
## 提示

$1 \le N \le 100$。

$1 \le W \le 10^9$。

$1 \le v_i \le 10^9$。

对所有的 $i=1,2,3,…,N$，$\min(v_i) \le v_i \le \min(v_i)+3$。

$1 \le p_i \le 10^7$。



---

---
title: "[USACO18JAN] Rental Service S"
layout: "post"
diff: 普及+/提高
pid: P4181
tag: ['贪心', '2018', 'USACO', '排序']
---
# [USACO18JAN] Rental Service S
## 题目描述

Farmer John realizes that the income he receives from milk production is insufficient to fund the growth of his farm, so to earn some extra money, he launches a cow-rental service, which he calls "USACOW" (pronounced "Use-a-cow").

Farmer John has $N$ cows ($1 \leq N \leq 100,000$), each capable of producing some amount of milk every day. The $M$ stores near FJ's farm ($1 \leq M \leq 100,000$) each offer to buy a certain amount of milk at a certain price. Moreover, Farmer John's $R$ ($1 \leq R \leq 100,000$) neighboring farmers are each interested in renting a cow at a certain price.


Farmer John has to choose whether each cow should be milked or rented to a nearby farmer. Help him find the maximum amount of money he can make per day.

## 输入格式

The first line in the input contains $N$, $M$, and $R$. The next $N$ lines each contain an integer $c_i$ ($1 \leq c_i \leq 1,000,000$), indicating that Farmer John's $i$th cow can produce $c_i$ gallons of milk every day. The next $M$ lines each contain two integers $q_i$ and $p_i$ ($1 \leq q_i, p_i \leq 1,000,000$), indicating that the $i$th store is willing to buy up to $q_i$ gallons of milk for $p_i$ cents per gallon. Keep in mind that Farmer John can sell any amount of milk between zero and $q_i$ gallons to a given store. The next $R$ lines each contain an integer $r_i$ ($1 \leq r_i \leq 1,000,000$), indicating that one of Farmer John's neighbors wants to rent a cow for $r_i$ cents per day.

## 输出格式

The output should consist of one line containing the maximum profit Farmer John can make per day by milking or renting out each of his cows. Note that the output might be too large to fit into a standard 32-bit integer, so you may need to use a larger integer type like a "long long" in C/C++.

## 样例

### 样例输入 #1
```
5 3 4
6
2
4
7
1
10 25
2 10
15 15
250
80
100
40
```
### 样例输出 #1
```
725

```
## 提示

Farmer John should milk cows #1 and #4, to produce 13 gallons of milk. He should completely fill the order for 10 gallons, earning 250 cents, and sell the remaining three gallons at 15 cents each, for a total of 295 cents of milk profits.


Then, he should rent out the other three cows for 250, 80, and 100 cents, to earn 430 more cents. (He should leave the request for a 40-cent rental unfilled.) This is a total of 725 cents of daily profit.

## 题目翻译

### 题目描述

Farmer John 意识到牛奶生产的收入不足以支持农场的扩展，因此为了赚取额外收入，他推出了一项奶牛租赁服务，称为“USACOW”（发音为“Use-a-cow”）。

Farmer John 有 $N$ 头奶牛（$1 \leq N \leq 100,000$），每头奶牛每天可以生产一定量的牛奶。附近的 $M$ 家商店（$1 \leq M \leq 100,000$）每家都愿意以一定价格购买一定量的牛奶。此外，Farmer John 的 $R$ 个邻居（$1 \leq R \leq 100,000$）每家都愿意以一定价格租赁一头奶牛。

Farmer John 需要决定每头奶牛是用于产奶还是租给附近的农民。请帮助他计算每天可以赚取的最大金额。

### 输入格式

输入的第一行包含 $N$、$M$ 和 $R$。接下来的 $N$ 行每行包含一个整数 $c_i$（$1 \leq c_i \leq 1,000,000$），表示 Farmer John 的第 $i$ 头奶牛每天可以生产 $c_i$ 加仑牛奶。接下来的 $M$ 行每行包含两个整数 $q_i$ 和 $p_i$（$1 \leq q_i, p_i \leq 1,000,000$），表示第 $i$ 家商店愿意以每加仑 $p_i$ 美分的价格购买最多 $q_i$ 加仑牛奶。请注意，Farmer John 可以向每家商店出售任意数量的牛奶，范围从 $0$ 到 $q_i$ 加仑。接下来的 $R$ 行每行包含一个整数 $r_i$（$1 \leq r_i \leq 1,000,000$），表示 Farmer John 的一个邻居愿意以每天 $r_i$ 美分的价格租赁一头奶牛。

### 输出格式

输出应包含一行，表示 Farmer John 通过产奶或租赁奶牛每天可以获得的最大利润。请注意，输出可能超过标准 32 位整数的范围，因此可能需要使用更大的整数类型，例如 C/C++ 中的 `long long`。

### 提示

Farmer John 应该让奶牛 #1 和 #4 产奶，每天生产 $13$ 加仑牛奶。他应该完全满足 $10$ 加仑的订单，赚取 $250$ 美分，并以每加仑 $15$ 美分的价格出售剩余的 $3$ 加仑，总共赚取 $295$ 美分的牛奶利润。

然后，他应该将其他三头奶牛分别以 $250$、$80$ 和 $100$ 美分的价格租出，赚取额外的 $430$ 美分。（他应该忽略 $40$ 美分的租赁请求。）这样，他每天的总利润为 $725$ 美分。


---

---
title: "绿豆蛙的归宿"
layout: "post"
diff: 普及+/提高
pid: P4316
tag: ['递归', '拓扑排序', '期望', '栈']
---
# 绿豆蛙的归宿
## 题目背景

随着新版百度空间的上线，Blog 宠物绿豆蛙完成了它的使命，去寻找它新的归宿。
## 题目描述

给出张 $n$ 个点 $m$ 条边的有向无环图，起点为 $1$，终点为 $n$，每条边都有一个长度，并且从起点出发能够到达所有的点，所有的点也都能够到达终点。

绿豆蛙从起点出发，走向终点。 到达每一个顶点时，如果该节点有 $k$ 条出边，绿豆蛙可以选择任意一条边离开该点，并且走向每条边的概率为 $\frac{1}{k}$ 。现在绿豆蛙想知道，从起点走到终点的所经过的路径总长度期望是多少？
## 输入格式

输入的第一行是两个整数，分别代表图的点数 $n$ 和边数 $m$。

第 $2$ 到第 $(m + 1)$ 行，每行有三个整数 $u, v, w$，代表存在一条从 $u$ 指向 $v$ 长度为 $w$ 的有向边。
## 输出格式

输出一行一个实数代表答案，四舍五入保留两位小数。
## 样例

### 样例输入 #1
```
4 4 
1 2 1 
1 3 2 
2 3 3 
3 4 4
```
### 样例输出 #1
```
7.00
```
## 提示

#### 数据规模与约定

- 对于 $20\%$ 的数据，保证 $n \leq 10^2$。
- 对于 $40\%$ 的数据，保证 $n \leq 10^3$。
- 对于 $60\%$ 的数据，保证 $n \leq 10^4$。
- 对于 $100\%$ 的数据，保证 $1 \leq n \leq 10^5$，$1 \leq m \leq 2 \times n$，$1 \leq u, v \leq n$，$0 \leq w \leq 10^9$，给出的图无重边和自环。


---

---
title: "[BalticOI 2005] Bus Trip"
layout: "post"
diff: 普及+/提高
pid: P4673
tag: ['动态规划 DP', '2005', '拓扑排序', 'BalticOI（波罗的海）']
---
# [BalticOI 2005] Bus Trip
## 题目描述

这里有 $N$ 座城镇, 和城镇之间的 $M$ 巴士单行线(没有中间停靠站)。 城镇从$1$到 $N$ 标号。 一个旅行者在 $0$ 时刻位于 $1$ 号城镇想要到达 $P$ 号城镇。他将乘坐巴士在 $T$ 时刻到达 $P$ 号城镇。如果他早到了，他必须等待。

对于任意一个巴士路线 $i$ , 我们知道其中的起点城镇 $si$ 和目标城镇$ti$ 。我们也同样知道路线的出发时间和到达时间,但仅仅是近似值：我们知道巴士离开起点城镇 $si$ 在时间范围$[ai, bi]$内，且到达目标城镇 $ti$ 在时间范围$[ci, di]$内(端点值包括在内)。

旅行者不喜欢等待, 因此他要寻找一个旅行计划使得最大等待时间尽量小，同时保证绝对不会错过计划中的任何一辆巴士(意思是, 每次他换乘巴士, 他需要下车的巴士的最晚到达时间不会迟于他需要搭乘的下一辆巴士的最早出发时间)。

当计算等待时间时，我们必须假设最早可能到达的时间和最晚可能出发的时间。

编写一个程序，寻找一个最为合理的搭车计划。
## 输入格式

输入文件名为TRIP.IN。第一行包含整数$N(1 \leq N \leq 50000),M(1 \leq M \leq 100000),P(1 \leq P \leq N),T(0 \leq T \leq 1000000000)$。

下面的M线描述了公交线路。每一行包含整数$si, ti, ai, bi, ci, di$，其中$si$和$ti$是公交线路$i$的始发地和目的地，$ai,bi,ci,di$描述了出发和到达时间，如上文所解释的$(1 \leq si \leq N, 1 \leq ti \leq N, 0 \leq ai \leq bi < ci \leq di \leq 1,000,000,000)$。
## 输出格式

只需要包含一个数——最合理搭车方案的最长可能等待时间。如果不可能保证在 $T$ 时刻到达城市$P$，那么输出-1。
## 样例

### 样例输入 #1
```
3 6 2 100
1 3 10 20 30 40
3 2 32 35 95 95
1 1 1 1 7 8
1 3 8 8 9 9
2 2 98 98 99 99
1 2 0 0 99 101
```
### 样例输出 #1
```
32
```
## 提示

翻译来自BZOJ P1354


---

---
title: "Divided Prime"
layout: "post"
diff: 普及+/提高
pid: P4752
tag: ['O2优化', '排序', '素数判断,质数,筛法', '洛谷月赛']
---
# Divided Prime
## 题目描述

给定一个数字$A$，这个$A$由$a_1,a_2,\cdots,a_N$相乘得到。

给定一个数字$B$，这个$B$由$b_1,b_2,\cdots,b_M$相乘得到。

如果$\frac{A}{B}$是一个质数，请输出`YES`，否则输出`NO`。


## 输入格式

每个测试点包含多组数据，第一行读入一个整数 $T$ 表示数据组数，对于每组数据：

第一行输入两个整数 $N,M$，分别表示 $A$ 由 $N$ 个数字相乘得到，$B$ 由 $M$ 个数字相乘得到。

第二行输入 $N$ 个整数，分别表示组成 $A$ 的 $N$ 个数字。

第三行输入 $M$ 个整数，分别表示组成 $B$ 的 $M$ 个数字。

保证对于一个数字，其在 ${b_i}$ 中出现的次数不多于在 ${a_i}$ 中出现的次数。
## 输出格式

对于每组数据：
如果 $\frac{A}{B}$ 是一个质数，请输出 `YES`，否则输出 `NO`。
在输出 `YES` 或 `NO` 后输出一个换行符。
## 样例

### 样例输入 #1
```
2
3 2
5 7 7
5 7
4 2
5 7 7 7
5 7
```
### 样例输出 #1
```
YES
NO
```
## 提示

$1 \le N \le 100000$

$0 \le M \le N$

$1 \le a_i,b_i \le 10^{12}$

$1 \le T \le 10$

$\sum N \le 100000$


---

---
title: "[USACO15DEC] High Card Low Card G"
layout: "post"
diff: 普及+/提高
pid: P4816
tag: ['贪心', '2015', 'USACO', '枚举', '排序']
---
# [USACO15DEC] High Card Low Card G
## 题目描述

Bessie the cow is a huge fan of card games, which is quite surprising, given her lack of opposable thumbs. Unfortunately, none of the other cows in the herd are good opponents. They are so bad, in fact, that they always play in a completely predictable fashion! Nonetheless, it can still be a challenge for Bessie to figure out how to win.

Bessie and her friend Elsie are currently playing a simple card game where they take a deck of $2N$ cards, conveniently numbered $1…2N$, and divide them into $N$ cards for Bessie and $N$ cards for Elsie. The two then play $N$ rounds, where in each round Bessie and Elsie both play a single card. In the first $N/2$ rounds, the player with the highest card earns a point, and in the last $N/2$ rounds, the rules switch and the player who plays the lowest card wins a point.

Given that Bessie can predict the order in which Elsie will play her cards, please determine the maximum number of points Bessie can win. 
## 输入格式

The first line of input contains the value of $N$ ($2 ≤ N ≤ 50,000$; N will be even).

The next $N$ lines contain the cards that Elsie will play in each of the successive rounds of the game. Note that it is easy to determine Bessie's cards from this information. 
## 输出格式

 Output a single line giving the maximum number of points Bessie can score. 
## 样例

### 样例输入 #1
```
4
1
8
4
3

```
### 样例输出 #1
```
2
```
## 提示

Here, Bessie must have cards 2, 5, and 6, and 7 in her hand, and she can use these to win at most 2 points, by saving her '2' card until one of the hands in the second half of the game.

Problem credits: Brian Dean 
## 题目翻译

### 题目描述

奶牛 Bessie 是卡牌游戏的狂热爱好者，尽管她没有对生拇指，但这并不影响她的热情。遗憾的是，她的同伴们在卡牌游戏方面水平堪忧，甚至出牌顺序都完全可预测！尽管如此，Bessie 仍需精心策划才能获胜。

Bessie 和她的朋友 Elsie 正在玩一个简单的卡牌游戏。她们使用一副包含 $2N$ 张卡牌的牌组（编号为 $1 \ldots 2N$），并将牌分成各 $N$ 张。随后进行 $N$ 轮比赛：每轮双方各打出一张牌。在前 $N/2$ 轮中，打出较大数字的玩家得 1 分；在后 $N/2$ 轮中，规则反转，打出较小数字的玩家得 1 分。

已知 Bessie 可以预知 Elsie 每轮出牌的顺序，请计算 Bessie 能够获得的最大分数。

### 输入格式

第一行输入包含整数 $N$（$2 \leq N \leq 50,000$，且 $N$ 为偶数）。

接下来 $N$ 行按顺序给出 Elsie 在每轮比赛中将打出的卡牌。注意根据这些信息可以推断出 Bessie 手中的卡牌。

### 输出格式

输出一行，包含 Bessie 能够获得的最大分数。

### 说明/提示

在此样例中，Bessie 手中的卡牌为 $2$、$5$、$6$ 和 $7$。她可以通过在比赛后半段保留 $2$ 这张牌，从而最多获得 2 分。

题目提供者：Brian Dean


---

---
title: "抓住czx"
layout: "post"
diff: 普及+/提高
pid: P4880
tag: ['排序', '最短路']
---
# 抓住czx
## 题目背景

蒟蒻 lty 出了一道题，但是由于太弱了，所以希望喜欢鸽子的 czx 来帮他写一个 std 。由于 czx 又放鸽子去了，所以没有写 std。蒟蒻 lty 觉得受到了学长的鄙视，所以决定去 czx 放鸽子的地方找他。
## 题目描述

 czx 放鸽子的地方是一个公园，公园珂以看作是由 $n$ 个点 $m$ 条边组成的无向图(保证无自环）， lty 将从公园的入口（ $b$ 号节点）进去寻找 czx ， czx 刚开始的位置为 $e$ ，而 czx 会在 $a_i$ 个单位时间时变化位置到第 $x$ 个节点去，在此之前 lty 已经知道了 czx 的具体位置和接下来他位置的变化方案，蒟蒻 lty 现在想知道他至少需要花多少时间找到 czx 。

UPD:

保证图联通， czx 最后会待在一个地方不动
## 输入格式

第一行四个整数$n$,$m$,$b$,$e$,$b$和$e$的意义如题面所示。

接下来$m$行，每行三个整数$x,y,z$，表示 $x$ 到 $y$ 之间有一条双向边， lty 走这条边要花费 $z$ 的时间。

第 $m+1$ 行一个整数 $T$，表示 czx 位置变化的次数。

接下来 $T$ 行，每行两个整数 $a_i$ 和 $x$，表示 czx 将在第$a_i$ 个单位时间时移动到第 $x$ 个点上去。
## 输出格式

一个整数表示最短所需时间。
## 样例

### 样例输入 #1
```
6 9 1 6
1 2 1
1 3 3
1 4 4
2 3 2
3 6 6
4 5 6
2 5 9
3 5 7
5 6 2
3
10 3
8 5
9 2
```
### 样例输出 #1
```
9
```
## 提示

**样例解释：**

在开始的时候就直接走到 $2$ 号节点，然后等到 czx过来。总花费时间 $9$ 个单位时间。

对于 30% 的数据，$n\le 100,m\le 1000,T\le 100$

对于另外 30% 的数据，$T=0$

对于 100% 的数据，$n \le 10^5,m \le 5\times10^5,T \le 10^5$

数据保证所有时间在 int 范围内

注意：在任意一个 czx 开始移动的时间点，都是 czx 先瞬移，然后 lty 再行走，也就是说， lty 不能在 czx 瞬移的时候到他瞬移前的点抓住他，但是 lty 可以在他瞬移到的点等着抓他。


---

---
title: "信号站"
layout: "post"
diff: 普及+/提高
pid: P4998
tag: ['贪心', '排序', '前缀和']
---
# 信号站
## 题目背景

   扶贫行动来到了Q村，扶贫队准备在Q村修筑信号站，让Q村不再“远离尘世”,让人们获得丰富的外界信息。
## 题目描述

   Q村非常非常Qiong，整个村只有一条路。在这条路上，有N户人家，因为条件有限，所以一个点上可能有多户人家。因为山区运输条件落后，所以扶贫队只能修筑k个信号站，并且他们希望各电站的不合理值之和最小。信号站的不合理值是指该信号站到每户人家的距离之和。
 
   扶贫队善于修筑电站，但是他们不擅长选址~~（因为数学不好QwQ）~~，他们希望你>>编程高手，来帮助他们选择修筑信号站的最佳地点，使得k个信号站的不合理值最小。

   距离求解方法:若某信号站的坐标为x,某户人家的坐标为y,那么该信号站与该人家的距离为|x-y|（即取绝对值）。

   数据保证人家数大于信号站数。放置信号站的位置坐标必须为整数。一个位置上只能放一个信号站。

## 输入格式

#### 共2行，

第一行，读入$ n $，$ k $，分别代表人家数和信号站数；

第二行，读入各户人家的坐标$ ai $（保证为整数），用空格隔开。


## 输出格式

仅一行，输出**最小**的不合理值之和。
## 样例

### 样例输入 #1
```
7 2
1 1 2 2 3 3 4
```
### 样例输出 #1
```
13
```
## 提示

#### 样例解释

在2和3的位置上放置信号站（方案不唯一）。

#### 数据范围

对于 $ 70\% $ 的数据，$ n,k\leq 10^3 $；  
对于 $ 100\% $ 的数据，$  n \leq 1000000, 0 \leq a_i \leq 10 ^ 6 $。


---

---
title: "小 C 与桌游"
layout: "post"
diff: 普及+/提高
pid: P5603
tag: ['动态规划 DP', '贪心', 'Special Judge', '拓扑排序', '洛谷月赛']
---
# 小 C 与桌游
## 题目背景

小 C 是一个热爱桌游的高中生，现在他被一个桌游难住了，快来帮帮他！
## 题目描述

这个桌游的地图可以被抽象成一个 $n$ 个点，$m$ 条边的**有向无环图**（**不保证连通**），小 C 在这个地图上行走，小 C 能走到某个点当且仅当能够到达这个点的所有点都已经被小 C 走到。小 C 会走到每个点恰好 $1$ 次，并且他能走到哪些点与他当前所在的点没有关系（即可以走到与当前所在的点没有连边的点，只要满足之前的条件）。

小 C 每走到一个标号比之前走到的点都大的点，他就会有 $\frac{1}{2}$ 的概率从对手那里拿到 $1$ 块筹码，有 $\frac{1}{2}$ 的概率给对手 $1$ 块筹码，双方初始各有 $1919810$ 个筹码。

小 C 的运气时好时坏，所以他希望你帮他计算出：

- 在最优情况下，即他每次都能从对手那里拿到筹码时，他采取最优的行走方式能得到的筹码数。
- 在最劣情况下，即对手每次都能从他那里拿到筹码时，他采取最优的行走方式会失去的筹码数。


## 输入格式

第一行两个正整数 $n, m$。

接下来 $m$ 行，每行两个正整数 $u, v$，表示地图上有一条有向边 $(u, v)$，不保证无重边。
## 输出格式

输出两行，每行一个正整数，第一行表示最优情况下小 C 能拿到的筹码数，第二行表示最劣情况下小 C 会失去的筹码数。
## 样例

### 样例输入 #1
```
3 2
1 2
1 3
```
### 样例输出 #1
```
3
2
```
## 提示

**样例解释**

最优情况下的行走方式是 $1-2-3$，最劣情况下的行走方式是 $1-3-2$。

**计分方式**

对于每一个测试点：

- 如果你输出格式错误或者两行都不正确，将会得到 $0$ 分。
- 如果你的输出第一行正确，第二行错误或第二行正确，第一行错误，将会得到这个测试点 $40 \%$ 的分数。
- 否则，你将会得到这个测试点 $100 \%$ 的分数。

**数据范围**

对于 $20\%$ 的数据，$1 \le n, m \le 10$。

对于 $40\%$ 的数据，$1 \le n, m \le 2000$。

对于 $100\%$ 的数据，$1 \le n, m \le 5 \times 10^5$，$1 \le u, v \le n$。



---

---
title: "[NOIP 2004 提高组] 合并果子 加强版"
layout: "post"
diff: 普及+/提高
pid: P6033
tag: ['贪心', '2004', 'NOIP 提高组', 'O2优化', '排序', '队列']
---
# [NOIP 2004 提高组] 合并果子 加强版
## 题目背景

本题除【数据范围与约定】外与 [P1090](https://www.luogu.com.cn/problem/P1090) **完  全  一  致**。
## 题目描述

在一个果园里，多多已经将所有的果子打了下来，而且按果子的不同种类分成了不同的堆。多多决定把所有的果子合成一堆。

每一次合并，多多可以把两堆果子合并到一起，消耗的体力等于两堆果子的重量之和。可以看出，所有的果子经过 $(n - 1)$ 次合并之后， 就只剩下一堆了。多多在合并果子时总共消耗的体力等于每次合并所耗体力之和。

因为还要花大力气把这些果子搬回家，所以多多在合并果子时要尽可能地节省体力。假定每个果子重量都为 $1$，并且已知果子的种类数和每种果子的数目，你的任务是设计出合并的次序方案，使多多耗费的体力最少，并输出这个最小的体力耗费值。

例如有 $3$ 堆果子，数目依次为 $1,~2,~9$。可以先将 $1$、$2$ 堆合并，新堆数目为 $3$，耗费体力为 $3$。接着，将新堆与原先的第三堆合并，又得到新的堆，数目为 $12$，耗费体力为 $12$。所以多多总共耗费体力为 $3+12=15$。可以证明 $15$ 为最小的体力耗费值。

## 输入格式

输入的第一行是一个整数 $n$，代表果子的堆数。\
输入的第二行有 $n$ 个用空格隔开的整数，第 $i$ 个整数代表第 $i$ 堆果子的个数 $a_i$。
## 输出格式

输出一行一个整数，表示最小耗费的体力值。
## 样例

### 样例输入 #1
```
3 
1 2 9 

```
### 样例输出 #1
```
15

```
## 提示

**【数据规模与约定】**

**本题采用多测试点捆绑测试，共有四个子任务**。

- Subtask 1（10 points）：$1 \leq n \leq 8$。
- Subtask 2（20 points）：$1 \leq n \leq 10^3$。
- Subtask 3（30 points）：$1 \leq n \leq 10^5$。
- Subtask 4（40 points）：$1 \leq n \leq 10^7$。

对于全部的测试点，保证 $1 \leq a_i \leq 10^5$。

**【提示】**

- 请注意常数因子对程序效率造成的影响。
- 请使用类型合适的变量来存储本题的结果。
- 本题输入规模较大，请注意数据读入对程序效率造成的影响。




---

---
title: "[USACO20FEB] Triangles S"
layout: "post"
diff: 普及+/提高
pid: P6149
tag: ['数学', '2020', 'USACO', '排序']
---
# [USACO20FEB] Triangles S
## 题目描述

Farmer John 想要给他的奶牛们建造一个三角形牧场。

有 $N$（$3\leq N\leq 10^5$）个栅栏柱子分别位于农场的二维平面上不同的点 $(X_1,Y_1)\ldots (X_N,Y_N)$。他可以选择其中三个点组成三角形牧场，只要三角形有一条边与 $x$ 轴平行，且有另一条边与 $y$ 轴平行。

FJ 可以组成的所有可能的牧场的面积之和等于多少？
## 输入格式

第一行包含 $N$。

以下 $N$ 行每行包含两个整数 $X_i$ 和 $Y_i$，均在范围 $−10^4\ldots 10^4$ 之内，描述一个栅栏柱子的位置。
## 输出格式

由于面积之和不一定为整数且可能非常大，输出面积之和的**两倍**模 $10^9+7$ 的余数。
## 样例

### 样例输入 #1
```
4
0 0
0 1
1 0
1 2
```
### 样例输出 #1
```
3
```
## 提示

#### 样例解释：
栅栏木桩 ($0,0$)、($1,0$) 和 ($1,2$) 组成了一个面积为 $1$ 的三角形，($0,0$)、($1,0$) 和 ($0,1$) 组成了一个面积为 $0.5$ 的三角形。所以答案为 $2\times (1+0.5)=3$。

#### 子任务：
- 测试点 $2$ 满足 $N=200$。
- 测试点 $3$-$4$ 满足 $N\leq 5000$。
- 测试点 $5$-$10$ 没有额外限制。


---

---
title: "游走"
layout: "post"
diff: 普及+/提高
pid: P6154
tag: ['2020', '记忆化搜索', '拓扑排序', '期望']
---
# 游走
## 题目背景

zbw 在 B 城游走。
## 题目描述

B 城可以看作一个有 $n$ 个点 $m$ 条边的**有向无环图**。**可能存在重边**。

zbw 在 B 城随机游走，他会在所有路径中随机选择一条路径，选择所有路径的概率相等。路径的起点和终点可以相同。

定义一条路径的长度为经过的边数，你需要求出 zbw 走的路径长度的期望，答案对 $998244353$ 取模。
## 输入格式

第一行两个整数 $n,m$。

接下来 $m$ 行，每行两个整数 $x,y$，表示存在一条从 $x$ 到 $y$ 的有向边。
## 输出格式

一行一个整数，表示答案对 $998244353$ 取模后的值。
## 样例

### 样例输入 #1
```
3 2
1 2
3 2
```
### 样例输出 #1
```
199648871
```
### 样例输入 #2
```
6 5
1 3
2 3
3 4
4 5
4 6
```
### 样例输出 #2
```
630470119
```
### 样例输入 #3
```
5 6
1 2
1 3
4 5
3 4
3 5
2 4
```
### 样例输出 #3
```
887328315
```
## 提示

样例说明：样例的答案分别为 $\dfrac{2}{5}$，$\dfrac{25}{19}$ 和 $\dfrac{11}{9}$。

| 测试点编号 | $n$ | $m$ | 特殊性质 | 每测试点分数 |
| :----------: | :----------: | :----------: | :----------: | :----------: |
| $1,2$ | $\le 10$ | $\le 10$ | 无 | $2$ |
| $3,4,5$ | $\le 15$ | $\le 100$ | 无 | $2$ |
| $6,7,8$ | $\le 100$ | $\le 10^3$ | 无 | $2$ |
| $9,10$ | $\le 10^3$ | $\le 10^4$ | 无 | $2$ |
| $11,12$ | $\le 10^4$ | $\le 10^5$ | 无 | $5$ |
| $13,14$ | $\le 10^5$ | $\le 2\times10^5$ | 无 | $5$ |
| $15,16$ | $\le 10^5$ | $\le 7\times10^5$ | 无 | $10$ |
| $17$ | $\le 10$ | $=n-1$ | 有向树 | $10$ |
| $18$ | $\le 10^3$ | $=n-1$ | 有向树 | $10$ |
| $19$ | $\le 10^4$ | $=n-1$ | 有向树 | $10$ |
| $20$ | $\le 10^5$ | $=n-1$ | 有向树 | $10$ |

其中，“有向树”的定义是：若把图视为无向图，则为一棵树（如样例 $1,2$）。

保证所有数据均按照某种方式随机，这意味着你可以认为算法执行过程中，你可以放心执行模意义下除法操作而不用担心除以零。


---

---
title: "[SBCOI2020] 时光的流逝"
layout: "post"
diff: 普及+/提高
pid: P6560
tag: ['图论', '博弈论', '2020', 'O2优化', '广度优先搜索 BFS', '拓扑排序']
---
# [SBCOI2020] 时光的流逝
## 题目背景

时间一分一秒的过着，伴随着雪一同消融在了这个冬天，  
或许，要是时光能停留在这一刻，该有多好啊。  
......    
“这是...我在这个小镇的最后一个冬天了吧。”  
“嗯，你可不能这辈子都呆在这个小镇吧。外面的世界很大呢，很大很大...”  
“唔...外面的世界...突然有点期待呢！”  
“总有一天，你会走得很远很远。以后你可不要忘记这个小镇那。”  
“不会的，至少...这里曾经是我最快乐的一段回忆呢！你也一定不要忘记我呀。”   
“你看，这雪花。传说，每当世界上有一份思念，便会化成一片雪花在这里飘落。”   
“那...以后你可一定要找到我的那片雪花啊......”  
![](https://cdn.luogu.com.cn/upload/image_hosting/orzntcy6.png)    
“嗯，不如我们一起在这个冬天创造最后一段回忆吧。”  
“好呀，我们玩个游戏吧......”  
## 题目描述

这个游戏是在一个有向图（不保证无环）上进行的。每轮游戏开始前，她们先在图上选定一个起点和一个终点，并在起点处放上一枚棋子。

然后两人轮流移动棋子，每次可以将棋子按照有向图的方向移动至相邻的点。

如果谁先将棋子移动至终点，那么谁就胜利了。同样，如果谁无法移动了，那么谁就失败了。

两人轮流操作，请问，他们是否有必胜策略呢？  

答案为一个整数 `0` 或 `1` 或 `-1`，其中 `1` 表示（先手）有必胜策略，`-1` 表示后手有必胜策略，`0` 表示两人均无必胜策略。
## 输入格式

第$\text{1}$行有三个整数 $n,m,q$ ，表示图上有 $n$ 个点， $m$ 条边，一共进行 $q$ 轮游戏。                      
接下来 $m$ 行，每行输入两个数 $u_i,v_i$ ，表示 $u_i$ 到 $v_i$ 有一条边。  
接下来 $q$ 行，每行两个数 $x,y$ ，表示每轮操作的起点和终点。数据保证起点，终点不同
## 输出格式

对于每轮游戏，仅输出一个整数 `0` 或 `1` 或 `-1`，其中 `1` 表示先手有必胜策略，`-1` 表示后手有必胜策略，`0` 表示两人均无必胜策略。
## 样例

### 样例输入 #1
```
7 7 1
1 2
2 3
3 4
4 5
3 6
7 5
6 7
1 5
```
### 样例输出 #1
```
1
```
### 样例输入 #2
```
5 5 2
1 2
2 3
3 1
3 4
4 5
1 5
4 3
```
### 样例输出 #2
```
0
1
```
## 提示

#### 样例解释 $#1$

![](https://cdn.luogu.com.cn/upload/image_hosting/k7q0qjrb.png)

为描述题意，假设两人为 A（先手）和 B

如图，A 先走，走到 $2$，B 走到 $3$，接下去 A 可以选择走到 $4$ 或 $6$，若走到 $4$，接下去 B 可以走到终点，故不可取。若选择走到 $6$，那么 B 只能走到 $7$，A 可以走到终点。所以 A 有必胜策略。

#### 样例解释 $#2$

![](https://cdn.luogu.com.cn/upload/image_hosting/9yjnyye3.png)

如图，起点为 $1$，终点为 $5$ 时， A 和 B 会沿着 $1-2-3-1$ 的顺序轮流走。因为如果谁先走到 $4$，那么下一个人就可以走到终点。故谁都没有必胜策略。

起点为 $4$，终点为 $3$ 时，A 先走到 $5$，B 无路可走，故 B 失败。

#### 数据范围

对于 $10\%$ 的数据，保证图是一条链。

对于 $50\%$ 的数据，$1\leq n\leq 10^3$，$1\leq m\leq 2\times10^3$，$1\leq q\leq 10$。

对于 $70\%$ 的数据，$1\leq n\leq 10^5$，$1\leq m\leq 2\times10^5$，$1\leq q\leq 10$。

对于 $100\%$ 的数据，$1\leq n\leq 10^5$，$1\leq m\leq 5\times10^5$，$1\leq q\leq 500$。


---

---
title: "[COCI 2013/2014 #6] KOCKICE"
layout: "post"
diff: 普及+/提高
pid: P6874
tag: ['贪心', '2013', '排序', 'COCI（克罗地亚）']
---
# [COCI 2013/2014 #6] KOCKICE
## 题目背景

堆积木！
## 题目描述

Mirko 和 Slavko 在玩积木。他们俩都有自己的一堆砖头。一共有 $N$ 列砖头（其中 $N$ 为奇数）。

Mirko 桩的第 $i$ 列中有 $m_i$ 块砖，而 Slavko 每列有 $s_i$ 个。

他们决定创建两堆一样的砖头，这几堆的高度首先是严格下降，然后是严格上升（参见下方右图），相邻列的高度恰好相差 $1$（见图）。最低的列的左右两侧的砖头数量必须相同。

![](https://cdn.luogu.com.cn/upload/image_hosting/aeiop47b.png)

允许两种操作：

- 从某一列的顶部移除一块砖。
- 在某一列的顶部加上一块砖。

问在满足上述要求的情况下，最少要几次操作？
## 输入格式

输入的第一行包含一个奇数 $N$，即两个人砖头的堆数。

输入的第二行包含 $N$ 个整数 $m_i$，即 Mirko 堆中的列高。

输入的第三行包含 $N$ 个整数 $s_i$，即 Slavko 堆中的列高。
## 输出格式

输出所需的最少操作次数。
## 样例

### 样例输入 #1
```
3
1 2 3
3 2 2
```
### 样例输出 #1
```
3
```
### 样例输入 #2
```
5
2 3 0 1 4
3 3 2 3 1
```
### 样例输出 #2
```
10
```
## 提示

#### 样例 1 解释
Mirko 在其桩的第一列的顶部放置了两块砖，而 Slavko 在他桩的第三列的顶部放置了一块砖。

#### 【数据规模与约定】

- 对于 $40\%$ 的数据，满足 $1\le N\le 1000$，$0\le m_i,s_i\le 1000$。
- 对于 $100\%$ 的数据，满足 $1\le N\le 3\times 10^5$，$0\le m_i,s_i\le 10^{12}$。

#### 【说明】
**题目译自 [COCI2013-2014](https://hsin.hr/coci/archive/2013_2014/) [CONTEST #6](https://hsin.hr/coci/archive/2013_2014/contest6_tasks.pdf)  _T3 KOCKICE_。**


---

---
title: "[NOIP2020] 排水系统"
layout: "post"
diff: 普及+/提高
pid: P7113
tag: ['图论', '高精度', '2020', 'NOIP 提高组', '拓扑排序']
---
# [NOIP2020] 排水系统
## 题目描述

对于一个城市来说，排水系统是极其重要的一个部分。

有一天，小 C 拿到了某座城市排水系统的设计图。排水系统由 $n$ 个排水结点（它们从 $1 \sim n$ 编号）和若干个单向排水管道构成。每一个排水结点有若干个管道用于汇集其他排水结点的污水（简称为该结点的汇集管道），也有若干个管道向其他的排水结点排出污水（简称为该结点的排出管道）。

排水系统的结点中有 $m$ 个污水接收口，它们的编号分别为 $1, 2, \ldots , m$，污水只能从这些接收口流入排水系统，并且这些结点没有汇集管道。排水系统中还有若干个最终排水口，它们将污水运送到污水处理厂，没有排出管道的结点便可视为一个最终排水口。

现在各个污水接收口分别都接收了 $1$ 吨污水，污水进入每个结点后，会均等地从当前结点的每一个排出管道流向其他排水结点，而最终排水口将把污水排出系统。

现在小 C 想知道，在该城市的排水系统中，每个最终排水口会排出多少污水。该城市的排水系统设计科学，管道不会形成回路，即不会发生污水形成环流的情况。
## 输入格式

第一个两个用单个空格分隔的整数 $n, m$。分别表示排水结点数与接收口数量。  
接下来 $n$ 行，第 $i$ 行用于描述结点 $i$ 的所有排出管道。其中每行第一个整数 $d_i$ 表示其排出管道的数量，接下来 $d_i$ 个用单个空格分隔的整数 $a_1, a_2, \ldots , a_{d_i}$ 依次表示管道的目标排水结点。  
保证不会出现两条起始结点与目标结点均相同的管道。
## 输出格式

输出若干行，按照编号从小到大的顺序，给出每个最终排水口排出的污水体积。其中体积使用分数形式进行输出，即每行输出两个用单个空格分隔的整数 $p$，$q$，表示排出的污水体积为 $\frac{p}{q}$。要求 $p$ 与 $q$ 互素，$q = 1$ 时也需要输出 $q$。
## 样例

### 样例输入 #1
```
5 1
3 2 3 5
2 4 5
2 5 4
0
0

```
### 样例输出 #1
```
1 3
2 3

```
### 样例输入 #2
```
见附件中的 water/water2.in
```
### 样例输出 #2
```
见附件中的 water/water2.ans
```
### 样例输入 #3
```
见附件中的 water/water3.in
```
### 样例输出 #3
```
见附件中的 water/water3.ans
```
## 提示

**【样例 #1 解释】**

$1$ 号结点是接收口，$4, 5$ 号结点没有排出管道，因此是最终排水口。  
$1$ 吨污水流入 $1$ 号结点后，均等地流向 $2, 3, 5$ 号结点，三个结点各流入 $\frac{1}{3}$ 吨污水。  
$2$ 号结点流入的 $\frac{1}{3}$ 吨污水将均等地流向 $4, 5$ 号结点，两结点各流入 $\frac{1}{6}$ 吨污水。  
$3$ 号结点流入的 $\frac{1}{3}$ 吨污水将均等地流向 $4, 5$ 号结点，两结点各流入 $\frac{1}{6}$ 吨污水。  
最终，$4$ 号结点排出 $\frac{1}{6} + \frac{1}{6} = \frac{1}{3}$ 吨污水，$5$ 号结点排出 $\frac{1}{3} + \frac{1}{6} + \frac{1}{6} = \frac{2}{3}$ 吨污水。

**【数据范围】**

| 测试点编号 | $n \le$ | $m \le$ |
|:-:|:-:|:-:|
| $1 \sim 3$ | $10$ | $1$ |
| $4 \sim 6$ | ${10}^3$ | $1$ |
| $7 \sim 8$ | ${10}^5$ | $1$ |
| $9 \sim 10$ | ${10}^5$ | $10$ |

对于全部的测试点，保证 $1 \le n \le {10}^5$，$1 \le m \le 10$，$0 \le d_i \le 5$。

数据保证，污水在从一个接收口流向一个最终排水口的过程中，不会经过超过 $10$ 个中间排水结点（即接收口和最终排水口不算在内）。


---

---
title: "小 P 的星空"
layout: "post"
diff: 普及+/提高
pid: P7133
tag: ['模拟', '二分', '排序']
---
# 小 P 的星空
## 题目背景



>星依云渚溅溅，露零玉液涓涓，宝砌哀兰剪剪。碧天如练，光摇北斗阑干。
>
>—— 【元】孟昉《天净沙 · 星依云渚溅溅》

小 P 漫步于星空之下。

“摘下星星送给你，你就是我的全世界”。

“今夜，我不关心人类，我只想你”。
## 题目描述

将星空看作一个平面直角坐标系，小 P 所在的位置为 $(0,0)$，即坐标原点。天上共有 $n$ 颗星星，第 $i$ 颗星星的坐标为 $(x_i,y_i)$。

小 P 最初面向点 $(1,0)$，然后小 P 会进行 $m$ 次原地转动，第 $i$ 次转动后会面向点 $(u_i,v_i)$。

他可以选择逆时针转动或顺时针转动，当面向此次旋转最终将要面向的方向时，此次转动立即停止。

他相信，在转动过程中，越多的星星出现在他正前方，他【数据删除】。

小 P 想知道，每一次转动过程中他最多可以让多少星星出现在他正前方（包括转动初始方向和结束方向正前方看到的星星）。
## 输入格式

总共包括 $n+m+1$ 行。

第一行包含两个正整数 $n,m$，分别表示星星颗数和转动次数。

接下来的 $n$ 行，每行两个整数 $x_i,y_i$。

接下来的 $m$ 行，每行两个整数 $u_i,v_i$，意义如【题目描述】中所述。

每行的两个数字间由单个空格隔开，数据为 Linux 格式，行末保证没有多余空格。
## 输出格式

$m$ 行，每行一个整数。第 $i$ 行的整数表示第 $i$ 次转动的答案。
## 样例

### 样例输入 #1
```
5 2
1 0
1 1
2 2
-1 2
-2 -1
-1 1
-1 2
```
### 样例输出 #1
```
4
5
```
### 样例输入 #2
```
见下发文件 ex_star2.in
```
### 样例输出 #2
```
见下发文件 ex_star2.out
```
### 样例输入 #3
```
见下发文件 ex_star3.in
```
### 样例输出 #3
```
见下发文件 ex_star3.out
```
## 提示

样例1示意图如下：

![](https://cdn.luogu.com.cn/upload/image_hosting/h2t5eu1a.png)

橙色点为星星，绿色点小 P 第一次的转动位置。第一次转动，从 $(1,0)$ 转到 $(-1,1)$。若顺时针转动(蓝色区域，包括边界)，$(1,0)$, $(-2,-1)$，共计 $2$ 颗星星；而逆时针转动(绿色区域，包括边界)，$(1,0)$, $(1,1)$,$(2,2)$,$(-1,2)$，共计 $4$ 颗星星。

第二次转动，从 $(-1,1)$ 转到 $(-1,2)$，逆时针转动，$5$ 颗星星都会在转动过程中出现在小 P 正前方。

![](https://cdn.luogu.com.cn/upload/image_hosting/b22go7at.png)

除测试点 $24$ 和 $25$ 外，其他测试点保证所有坐标的绝对值 $\le 1000$。

对于前 $12$ 个测试点，保证原点到任意星星形成的射线上没有其他星星。

除 $23,25$ 测试点外，对于所有编号为奇数的测试点，保证小 P 初始面向方向和每次转动目标方向上没有任何星星。

除 $22,24$ 测试点外，对于所有编号为偶数的测试点，保证小 P 初始面向方向和每次转动目标方向上至少有一颗星星。

对于 $100\%$ 的数据，保证星星的坐标互不相同，保证坐标不会出现 $(0,0)$，保证不会出现转动初始方向等于结束方向。

样例 $3$ 满足偶数测试点的限制。


---

---
title: "[USACO20DEC] Rectangular Pasture S"
layout: "post"
diff: 普及+/提高
pid: P7149
tag: ['2020', 'USACO', '离散化', 'O2优化', '排序', '前缀和']
---
# [USACO20DEC] Rectangular Pasture S
## 题目描述

Farmer John 最大的牧草地可以被看作是一个由方格组成的巨大的二维方阵（想象一个巨大的棋盘）。现在，有 $N$ 头奶牛正占据某些方格（$1≤N≤2500$）。

Farmer John 想要建造一个可以包围一块矩形区域的栅栏；这个矩形必须四边与 $x$ 轴和 $y$ 轴平行，最少包含一个方格。请帮助他求出他可以包围在这样的区域内的不同的奶牛子集的数量。注意空集应当被计算为答案之一。 
## 输入格式

输入的第一行包含一个整数 $N$。以下 $N$ 行每行包含两个空格分隔的整数，表示一头奶牛所在方格的坐标 $(x,y)$。所有 $x$ 坐标各不相同，所有 $y$ 坐标各不相同。所有 $x$ 与 $y$ 的值均在 $0…10^9$ 范围内。 
## 输出格式

 输出 FJ 可以包围的奶牛的子集数量。可以证明这个数量可以用 64 位有符号整数型存储（例如 C/C++ 中的long long）。 
## 样例

### 样例输入 #1
```
4
0 2
1 0
2 3
3 5
```
### 样例输出 #1
```
13
```
## 提示

共有 $2^4$ 个子集。FJ 不能建造一个栅栏仅包围奶牛 $1$、$2$、$4$，或仅包围奶牛 $2$、$4$，或仅包围奶牛 $1$、$4$，所以答案为 $2^4-3=16-3=13$。 

 - 测试点 2-3 满足 $N≤20$。
 - 测试点 4-6 满足 $N≤100$。
 - 测试点 7-12 满足 $N≤500$。
 - 测试点 13-20 没有额外限制。

供题：Benjamin Qi 


---

---
title: "[USACO20DEC] Stuck in a Rut S"
layout: "post"
diff: 普及+/提高
pid: P7150
tag: ['贪心', '2020', 'USACO', 'O2优化', '排序']
---
# [USACO20DEC] Stuck in a Rut S
## 题目描述

Farmer John 最近扩大了他的农场，从奶牛们的角度看来这个农场相当于是无限大了！奶牛们将农场上放牧的区域想作是一个由正方形方格组成的无限大二维方阵，每个方格中均有美味的草（将每个方格看作是棋盘上的一个方格）。Farmer John 的 $N$ 头奶牛（$1≤N≤1000$）初始时位于不同的方格中，一部分朝向北面，一部分朝向东面。

每一小时，每头奶牛会执行以下二者之一：

 - 如果她当前所在的方格里的草已经被其他奶牛吃掉了，则她会停下（并从这个时刻开始一直保持停止）。
 - 吃完她当前所在的方格中的所有草，并向她朝向的方向移动一个方格。

经过一段时间，每头奶牛的身后会留下一条被啃秃了的轨迹。

如果两头奶牛在一次移动中移动到了同一个有草的方格，她们会分享这个方格中的草，并在下一个小时继续沿她们朝向的方向移动。

当 Farmer John 看到停止吃草的奶牛时会不高兴，他想要知道谁该为他停止吃草的奶牛受到责备。如果奶牛 $b$
停在了之前奶牛 $a$ 吃过草的一个方格，我们就称奶牛 $a$ 阻碍了奶牛 $b$。进一步地，如果奶牛 $a$ 阻碍了奶牛 $b$ 且奶牛 $b$ 阻碍了奶牛 $c$，我们认为奶牛 $a$ 也阻碍了奶牛 $c$（也就是说，「阻碍」关系具有传递性）。每头奶牛受到责备的程度与这头奶牛阻碍的奶牛数量一致。请计算每头奶牛受到责备的数量——也就是说，每头奶牛阻碍的奶牛数量。 
## 输入格式

输入的第一行包含 $N$。以下 $N$ 行，每行描述一头奶牛的起始位置，包含一个字符 N（表示朝向北面） 或 E（表示朝向东面），以及两个非负整数 $x$ 和 $y$（$0≤x≤10^9$，$0≤y≤10^9$）表示方格的坐标。所有 $x$ 坐标各不相同，所有 $y$ 坐标各不相同。

为了使方向和坐标尽可能明确，如果一头奶牛位于方格 $(x,y)$ 并向北移动，她会到达方格 $(x,y+1)$。如果她向东移动，她会到达方格 $(x+1,y)$。 
## 输出格式

输出 $N$ 行。输出的第 $i$ 行包含输入中的第 $i$ 头奶牛受到的责备的数量。 
## 样例

### 样例输入 #1
```
6
E 3 5
N 5 3
E 4 6
E 10 4
N 11 1
E 9 2
```
### 样例输出 #1
```
0
0
1
2
1
0

```
## 提示

在这个样例中，奶牛 3 阻碍了奶牛 2，奶牛 4 阻碍了奶牛 5，奶牛 5 阻碍了奶牛 6。根据传递性，奶牛 4 也阻碍了奶牛 6。 

 - 测试点 2-5 中，所有坐标不超过 $2000$。
 - 测试点 6-10 没有额外限制。

供题：Brian Dean 


---

---
title: "[COCI 2007/2008 #6] PRINCEZA"
layout: "post"
diff: 普及+/提高
pid: P7193
tag: ['模拟', '图论', '2007', 'O2优化', '排序', 'COCI（克罗地亚）']
---
# [COCI 2007/2008 #6] PRINCEZA
## 题目背景

对于 C 语言和 C++ 语言，请使用 `cin`，`scanf` 进行读入，否则可能会出现 $\color{purple}\mathsf{RE}$ & $\color{red}\mathsf{WA}$。
## 题目描述



Luka 把卡车停在湖边。 

Barica 在湖中居住，Barica 跳过漂浮在湖面上的 $n$ 种植物。 

Luka 知道许多民间故事，知道如果他亲吻 Barica，她会变成一个可爱的女孩子。但是，他需要先抓住她！

可以用一对坐标定义植物在湖面上的位置。 Barica 可以从 $(x, y)$ 植物中跳跃，$p$ 为任意正整数。

- 方向 A：$(x + p, y + p)$。
- 方向 B：$(x + p, y - p)$。
- 方向 C：$(x - p, y + p)$。
- 方向 D：$(x - p, y - p)$。

Barica 选择四个方向之一，然后沿所选方向跳到第一个植物上。 

如果在选定的方向上没有植物，Barica 将留在原处。

Barica 跳下后，她从水槽上跳下的植物消失了。

知道植物的位置和 Barica 选择的方向顺序后，Luka 希望确定 Barica 最终将位于植物的坐标。 Luka 将在她的位置等她，亲吻她。

编写一个解决 Luka 问题的程序，并帮助他将 Barica 变成美丽的公主。
## 输入格式

第一行，两个正整数 $n, k$，分别表示植物数和跳跃次数。

第二行，$k$ 个字母，`A`，`B`，`C` 或 `D`，表示她跳的方向。

接下来，$n$ 行的每行都包含两个整数 $x, y$，表示一棵植物的坐标。 Barica 最初位于第一颗植物。
## 输出格式

第一行，Barica 的最终坐标。
## 样例

### 样例输入 #1
```
7 5
ACDBB
5 6
8 9
4 13
1 10
7 4
10 9
3 7

```
### 样例输出 #1
```
7 4
```
### 样例输入 #2
```
6 12
AAAAAABCCCDD
1 1
2 2
3 3
4 4
5 3
6 2 

```
### 样例输出 #2
```
5 3
```
## 提示

#### 数据规模与约定
对于 $100\%$ 的数据，$1 \le n, k \le 10 ^ 5$，$0 \le x, y \le 10 ^ 9$。
#### 说明
- 本题满分 $60$ 分。
- 本题默认开启 O2 优化开关。
- 题目译自 [COCI2007-2008](https://hsin.hr/coci/archive/2007_2008/) [CONTEST #6](https://hsin.hr/coci/archive/2007_2008/contest6_tasks.pdf) T5 PRINCEZA，译者 @[tearing](https://www.luogu.com.cn/user/219791)。


---

---
title: "「TOCO Round 1」奇怪的排序"
layout: "post"
diff: 普及+/提高
pid: P7392
tag: ['排序', '排列组合', '逆元']
---
# 「TOCO Round 1」奇怪的排序
## 题目背景

欢喜不问天，风流不问天，温柔不问天，良辰不问天，良缘不问天。

问你不问天。
## 题目描述

情人节那天 $\color{orange}\texttt{Biadocy}$ 被虐得好惨，尤其是上流的公爵和小孩说什么《和你在一起的每一天，都叫情人节》。于是他找到了一个机会来报复。

现在有 $n$ 对情人编号为 $1\sim n$ 按任意顺序排成一列，$\color{orange}\texttt{Biadocy}$ 对他们执行了下面这段排序的伪代码。

![](https://cdn.luogu.com.cn/upload/image_hosting/yny3xh8d.png)

$\color{orange}\texttt{Biadocy}$ 想知道有多少种初始排列满足按照这段伪代码排序后情人们的编号有序。也许这能让他好受一点。
## 输入格式

第一行一个整数 $T$ 表示数据组数。

接下来 $T$ 行每行两个整数 $n,k$ 表示情人对数和第一次调用伪代码传入的参数。
## 输出格式

$T$ 行，每行一个整数，表示答案对 $10^9+7$ 取模的结果。
## 样例

### 样例输入 #1
```
3
3 1
10 2
1 0
```
### 样例输出 #1
```
3
25200
1
```
### 样例输入 #2
```
5
502520 0
502520 1
502520 2
502520 3
502520 4
```
### 样例输出 #2
```
1
218102685
429650441
770595802
584122358
```
## 提示

对于前 $10\%$ 的数据，$T=0$。  
对于前 $30\%$ 的数据，$T\leq 10$，$n\leq 7$。  
对于另外 $10\%$ 的数据，$k=0$。  
对于另外 $10\%$ 的数据，$k=100$。  
对于 $100\%$ 的数据，$0\leq T\leq 10^5$，$1\leq n\leq 10^6$，$0\leq k\leq 100$。


---

---
title: "「EZEC-10」Shape"
layout: "post"
diff: 普及+/提高
pid: P7715
tag: ['树状数组', '排序']
---
# 「EZEC-10」Shape
## 题目背景

规定 $(x,y)$ 表示第 $x$ 行第 $y$ 列的格子。
## 题目描述

小 A 有一个 $n\times m$ 的网格，一些为白色格子，剩余为黑色格子。

小 A 选择四个整数 $x_1,x_2,y_1,y_2$，满足如下条件：

1. $1\le x_1<x_2\le n$ 且 $1\le y_1<y_2\le m$。
2. $x_1+x_2$ 为偶数。

若 $(x_1,y_1)\to (x_2,y_1),(x_1,y_2)\to (x_2,y_2),(\frac{x_1+x_2}{2},y_1)\to (\frac{x_1+x_2}{2},y_2)$ 这三段中的格子均为白色，则称这三段构成的图形为 H 形。

小 A 想知道，这个网格中存在多少不同的 H 形。

**两个 H 形相同，当且仅当两个 H 形的 $x_1,x_2,y_1,y_2$ 均相同。**
## 输入格式

第一行两个整数 $n,m$。

后 $n$ 行每行 $m$ 个整数表示网格，其中 $0$ 代表白色，$1$ 代表黑色。
## 输出格式

一个整数，表示不同 H 形的数量。
## 样例

### 样例输入 #1
```
3 4
1 0 0 0
1 1 0 0
1 0 0 0
```
### 样例输出 #1
```
1
```
### 样例输入 #2
```
5 3
0 1 0
0 1 0
0 0 0
0 1 0
0 1 0
```
### 样例输出 #2
```
2
```
## 提示

**【样例 1 解释】**

$(x_1,x_2,y_1,y_2)=(1,3,3,4)$ 的 H 形符合。

**【样例 2 解释】**

$(x_1,x_2,y_1,y_2)=(1,5,1,3),(2,4,1,3)$ 的 H 形符合。

**【数据规模与约定】**

**本题采用捆绑测试。**

- Subtask 1（1 point）：$n=2$。
- Subtask 2（9 points）：$ n,m\le 50$。
- Subtask 3（10 points）：$ n,m\le 100$，**时限为 $500ms$**。
- Subtask 4（30 points）：$ n,m\le 500$。
- Subtask 5（50 points）：无特殊限制。

对于 $100\%$ 的数据，$2\le n,m\le 2\times 10^3$。


---

---
title: "[COCI 2015/2016 #2] ARTUR"
layout: "post"
diff: 普及+/提高
pid: P7860
tag: ['2015', 'Special Judge', '拓扑排序', 'COCI（克罗地亚）']
---
# [COCI 2015/2016 #2] ARTUR
## 题目描述

有 $n$ 根棍子放在桌面上，求一个将棍子向桌子 $x$ 轴边缘移动的顺序，使棍子不发生碰撞（棍子向桌子边缘移动的速度相同）。
## 输入格式

第一行一个整数 $N$，表示棍子的总数。

接下来 $N$ 行，每行四个整数 $x1_i,y1_i,x2_i,y2_i$，表示一根棍子两端的坐标。
## 输出格式

一行 $n$ 个整数，表示合法的棍子移动顺序。
## 样例

### 样例输入 #1
```
4
1 3 2 2
1 1 3 2
2 4 7 3
3 3 5 3

```
### 样例输出 #1
```
2 4 1 3
```
### 样例输入 #2
```
4
0 0 1 1
1 2 0 3
2 2 3 3
4 0 3 1

```
### 样例输出 #2
```
4 3 1 2
```
### 样例输入 #3
```
3
4 6 5 5
2 1 15 1
3 2 8 7

```
### 样例输出 #3
```
2 3 1
```
## 提示

**【样例 1 解释】**

如图，另一种移动顺序是 `2 1 4 3`。

![](https://cdn.luogu.com.cn/upload/image_hosting/6yeaxhnb.png)

**【数据范围】**

对于 $40\%$ 的数据，$1\le N\le 10$；

对于 $60\%$ 的数据，$1\le N\le 300$；

对于 $100\%$ 的数据，$1\le N\le 5000$，$0\le x1,y1,x2,y2\le 10^4$。

**【说明】**

**本题数据点得分依原题，满分 100**。

题目译自 [COCI 2015-2016](https://hsin.hr/coci/archive/2015_2016/) [CONTEST #2](https://hsin.hr/coci/archive/2015_2016/contest2_tasks.pdf) **T3 ARTUR**。


---

---
title: "『JROI-5』Autumn"
layout: "post"
diff: 普及+/提高
pid: P8088
tag: ['贪心', '二分', '2022', 'O2优化', '排序', '洛谷月赛']
---
# 『JROI-5』Autumn
## 题目背景

感谢 @[王熙文](/user/353688) 提供了一种优于标算的做法。
## 题目描述

**本题读入量较大，建议使用较快的读入方式，可以参考 [赛时公告板](https://www.luogu.com.cn/paste/lueudpd5)**


给定 $n$ 个数列，每个数列有 $m$ 个元素，第 $i$ 个数列第 $j$ 个元素为正整数 $a_{i,j}$。

你每次可以选择 $i_1,j_1$ 和 $i_2,j_2$，交换 $a_{i_1,j_1}$ 和 $a_{i_2,j_2}$。你至多可以进行 $x$ 次交换。

定义 $d_i$ 为第 $i$ 个数列中第 $k$ 大的元素。

请最小化 $\max\limits_{i=1}^n \{d_i\}$。（表示 $d_1,d_2,\cdots,d_n$ 中的最大值）
## 输入格式

第一行两个正整数 $n,m$。

接下来 $n$ 行每行 $m$ 个正整数，表示数列。

最后一行两个正整数 $k,x$。
## 输出格式

一行一个数，输出最小化的 $\max\limits_{i=1}^n \{d_i\}$。
## 样例

### 样例输入 #1
```
5 5
1 2 3 4 5
6 7 8 9 10
1 2 3 4 5
1 2 3 4 5
1 2 3 4 5
2 1
```
### 样例输出 #1
```
8
```
### 样例输入 #2
```
5 5
1 2 3 4 5
6 7 8 9 10
1 2 3 4 5
1 2 3 4 5
1 2 3 4 5
2 2
```
### 样例输出 #2
```
7
```
### 样例输入 #3
```
见附件
```
### 样例输出 #3
```
见附件
```
## 提示

对于样例 1，将 $a_{2,5}$ 和 $a_{1,5}$ 交换，可以证明，没有更优策略。
***
对于 $30\%$ 的数据，$x = 10^6,1\leq k\leq m$。

对于另外 $10\%$ 的数据，**所有的数都相等**。

对于另外 $30\%$ 的数据，$1\leq n,m\leq 2\times 10^3,1\leq k\leq m,a_{i,j}\leq 10^6,0\leq x\leq n\times m$。

对于 $100\%$ 的数据，$1\leq n,m\leq 2\times 10^3,1\leq k\leq m,1\leq a_{i,j}\leq 10^{18},0\leq x\leq n\times m$。




---

---
title: "声海 | Sea of Voices"
layout: "post"
diff: 普及+/提高
pid: P8148
tag: ['2022', 'O2优化', '排序']
---
# 声海 | Sea of Voices
## 题目背景

「真是，如梦似幻呢。」

“怎么？”

「我看见你从开始到现在的一切记忆；看见你，从一次次或欢喜或失落中走来。那些场景在我眼前浮现，像梦，却又那么模糊——我只听见那些声音，只感到那片声音的海洋将我环围… 你听得见吗？」

“当然。毕竟，它们是我的记忆啊。”

「或许，一次生命，便是一场发声的历程吧。我们诞生时的啼哭，便在向世界发出宣告降临的声音；在一次次挑战的过程中，我们向一切阻碍我们的事物唱出不屈的战歌；在日常的点滴中，我们向所珍视之人倾诉内心深处的话语… 这样的声音，这样的感情，是不是就是我们所生存世界的本质呢？」

“或许就是这样吧。纵使一路走来，我们看见了无尽的景色，但只有那些与我们内心共鸣的声音——或来自于自然、或来自于他人的灵魂——才会真正地改变我们自己。”

「是啊… 但愿，在这片声音的海洋里，你不会迷失你的方向。我期许着听见更多，关于你的声音。怀揣着这种信念，向前走下去吧。」

“你也一样。”

> We'll see creation come undone
>
> 我们会见证自己存在的印记被世界拂去
>
> These bones that bound us will be gone
>
> 而那些既有的束缚将不再留存
>
> We'll stir our spirits till we're one
>
> 我们会洗涤自己的灵魂直至合为一体
>
> Then soft as shadows we'll become
>
> 然后成为掠影，散失在虚无之中
## 题目描述

“但是… 曾有一些人，在我的生命里留下了重要的声音，我却无法回忆起了…”

「为什么呢？」

“不妨让我们把问题变得形式化一点。我想回忆起的声音有 $n$ 个，它们的共鸣度——非负整数 $a_i$，是单调不降的。最初它们互不干涉，但随着时间的推移，多个相邻的声音会交织在一起形成新的声音——也就是说，对于任意的 $1\le l\le r\le n$，第 $l$ 一直到第 $r$ 个声音会交织在一起形成新的声音，而这个声音的共鸣度便是这些声音共鸣度的总和。”

「也就是说，例如 $n=3$，$a=[1,2,4]$，那么最终 $\dfrac{3\times(3+1)}2=6$ 个声音的共鸣度分别是 $1,2,4,3,6,7$？」

“没错。现在我把最终所有声音的共鸣度无序地告诉你，你能帮我还原最开始 $n$ 个声音的共鸣度吗？”

「乐意之至。」

### 简要题意

$a$ 为长度为 $n$ 的非负整数序列，满足 $\forall 1<i\le n,a_{i-1}\le a_i$。现 **无序** 地给出 **可重集** $S=\left\{\sum_{k=l}^r a_k|1\le l\le r\le n\right\}$，试还原 $a$。
## 输入格式

第一行一个正整数 $n$，代表最初声音的个数。

接下来一行 $\dfrac{n\times(n+1)}2$ 个非负整数，表示现在所有声音的共鸣度（输入无序）。
## 输出格式

一行 $n$ 个非负整数，表示最初 $n$ 个声音共鸣度 $a_i$。
## 样例

### 样例输入 #1
```
3
1 2 3 4 6 7
```
### 样例输出 #1
```
1 2 4
```
### 样例输入 #2
```
5
1 3 4 7 8 9 10 11 15 17 18 19 24 27 28
```
### 样例输出 #2
```
1 3 7 8 9
```
## 提示

对于全部数据，有 $1\le n\le 2000$，$0\le a_i\le 10^5$。

Subtask 1（5 pts）：保证 $n=2$。

Subtask 2（15 pts）：保证 $n=3$。

Subtask 3（30 pts）：保证 $n\le 100$。

Subtask 4（50 pts）：无特殊限制。


---

---
title: "[USACO22OPEN] Visits S"
layout: "post"
diff: 普及+/提高
pid: P8269
tag: ['USACO', '2022', '拓扑排序', '连通块', '强连通分量', '基环树']
---
# [USACO22OPEN] Visits S
## 题目描述

Bessie 的 $N$（$2\le N\le 10^5$）个奶牛伙伴（编号为 $1\cdots N$）每一个都拥有自己的农场。对于每个 $1\le i\le N$，伙伴 i 想要访问伙伴 $a_i$（$a_i\neq i$）。

给定 $1\ldots N$ 的一个排列 $(p_1,p_2,\ldots, p_N)$，访问按以下方式发生。

对于 $1$ 到 $N$ 的每一个 $i$：

- 如果伙伴 $a_{p_i}$ 已经离开了她的农场，则伙伴 $p_i$ 仍然留在她的农场。
- 否则，伙伴 $p_i$ 离开她的农场去访问伙伴 $a_{p_i}$ 的农场。这次访问会产生快乐的哞叫 $v_{p_i}$ 次（$0\le v_{p_i}\le 10^9$）。


对于所有可能的排列 $p$，计算所有访问结束后可能得到的最大哞叫次数。
## 输入格式

输入的第一行包含 $N$。

对于每一个 $1\le i\le N$，第 $i+1$ 行包含两个空格分隔的整数 $a_i$ 和 $v_i$。
## 输出格式

输出一个整数，为所求的答案。

**注意这个问题涉及到的整数可能需要使用 64 位整数型（例如，C/C++ 中的 "long long"）。**
## 样例

### 样例输入 #1
```
4
2 10
3 20
4 30
1 40
```
### 样例输出 #1
```
90
```
## 提示

【样例解释】


如果 $p=(1,4,3,2)$，则

- 伙伴 $1$ 访问伙伴 $2$ 的农场，产生 $10$ 次哞叫。
- 伙伴 $4$ 看到伙伴 $1$ 已经离开了农场，所以无事发生。
- 伙伴 $3$ 访问伙伴 $4$ 的农场，又产生 $30$ 次哞叫。
- 伙伴 $2$ 看到伙伴 $3$ 已经离开了农场，所以无事发生。

这样总计得到了 $10+30=40$ 次哞叫。

另一方面，如果 $p=(2,3,4,1)$，则

- 伙伴 $2$ 访问伙伴 $3$ 的农场，产生 $20$ 次哞叫。
- 伙伴 $3$ 访问伙伴 $4$ 的农场，产生 $30$ 次哞叫。
- 伙伴 $4$ 访问伙伴 $1$ 的农场，产生 $40$ 次哞叫。
- 伙伴 $1$ 看到伙伴 $2$ 已经离开了农场，所以无事发生。

这样总计得到了 $20+30+40=90$ 次哞叫。可以证明这是所有可能的排列 $p$ 中访问结束后得到的最大可能的哞叫次数。


---

---
title: "[USACO23FEB] Equal Sum Subarrays G"
layout: "post"
diff: 普及+/提高
pid: P9127
tag: ['USACO', '2023', '排序', '线性递推']
---
# [USACO23FEB] Equal Sum Subarrays G
## 题目描述

**Note: The time limit for this problem is 3s, 1.5x the default.** 

FJ gave Bessie an array $a$ of length $N(2 \le N \le 500,−10^{15} \le a_i \le 10^{15})$ with all $\dfrac{N(N+1)}{2}$ contiguous subarray sums distinct. For each index $i \in [1,N]$, help Bessie compute the minimum amount it suffices to change ai by so that there are two different contiguous subarrays of a with equal sum. 
## 输入格式

The first line contains $N$.

The next line contains $a_1, \cdots ,a_N$
(the elements of $a$, in order). 
## 输出格式

One line for each index $i \in [1,N]$. 
## 样例

### 样例输入 #1
```
2
2 -3
```
### 样例输出 #1
```
2
3
```
### 样例输入 #2
```
3
3 -10 4
```
### 样例输出 #2
```
1
6
1
```
## 提示

### Explanation for Sample 1

Decreasing $a_1$ by $2$ would result in $a_1+a_2=a_2$. Similarly, increasing $a_2$ by $3$ would result in $a_1+a_2=a_1$. 

### Explanation for Sample 2

Increasing a1 or decreasing $a_3$ by $1$ would result in $a_1=a_3$. Increasing $a_2$ by $6$ would result in $a_1=a_1+a_2+a_3$. 

### SCORING

 - Input $3$: $N \le 40$
 - Input $4$: $N \le 80$
 - Inputs $5-7$: $N \le 200$
 - Inputs 8-16: No additional constraints.
## 题目翻译

### 题目描述

注意：本题的时间限制为 3 秒，为默认时间的 1.5 倍。

FJ 给了 Bessie 一个长度为 $N$ 的数组 $a$（$2 \leq N \leq 500, -10^{15} \leq a_i \leq 10^{15}$），其中所有 $\dfrac{N(N+1)}{2}$ 个连续子数组的和都是不同的。对于每个下标 $i \in [1,N]$，帮助 Bessie 计算最小的改变量，使得数组中存在两个不同的连续子数组的和相等。

### 输入格式

第一行包含一个整数 $N$，表示数组的长度。

第二行包含 $a_1,\cdots,a_N$，即数组 $a$ 的元素，按顺序给出。

### 输出格式

对于每个下标 $i \in [1,N]$，输出一行一个整数，表示改变 $a_i$ 的最小改变量。

### 样例 1 的解释

将 $a_1$ 减少 $2$，可以使得 $a_1+a_2=a_2$。类似地，将 $a_2$ 增加 $3$，可以使得 $a_1+a_2=a_1$。

### 样例 2 的解释

将 $a_1$ 增加 $1$ 或将 $a_3$ 减少 $1$，可以使得 $a_1=a_3$。将 $a_2$ 增加 $6$，可以使得 $a_1=a_1+a_2+a_3$。

### 评分标准

- 测试点 $3$：$N \leq 40$
- 测试点 $4$：$N \leq 80$
- 测试点 $5-7$：$N \leq 200$
- 测试点 $8-16$：无额外限制。


---

---
title: "「Cfz Round 1」Elevator"
layout: "post"
diff: 普及+/提高
pid: P9579
tag: ['动态规划 DP', '贪心', '线段树', '树状数组', '洛谷原创', 'O2优化', '排序', '洛谷月赛']
---
# 「Cfz Round 1」Elevator
## 题目背景

电梯是一个可以让人充分思考的空间。
## 题目描述

给定两个长度为 $n$ 的数组 $a,b$。我们称序列 $p$ 是满足条件的，设 $p$ 的长度为 $m$，当且仅当：

- $p_1=1$；  
- 对于所有的 $1\le i<m$，都有 $|p_i-p_{i+1}|=1$；  
- 对于所有的 $1\le k\le n$，都存在一个有序数对 $(i,j)$，满足 $1 \le i < j \le m$ 且 $p_i=a_k$，$p_j=b_k$。

你需要输出所有满足条件的序列 $p$ 中，$p$ 的长度的最小值。
## 输入格式

第一行一个整数 $n$。

接下来 $n$ 行，第 $i$ 行两个整数 $a_i,b_i$。
## 输出格式

一个整数，表示所有满足条件的序列 $p$ 中，$p$ 的长度的最小值。
## 样例

### 样例输入 #1
```
2
3 2
2 5
```
### 样例输出 #1
```
7
```
### 样例输入 #2
```
4
4 7
10 8
9 11
4 2
```
### 样例输出 #2
```
18
```
## 提示

#### 【样例解释 #1】

序列 $p$ 的长度的最小值为 $7$，此时的序列 $p$ 为 $\{1,2,3,2,3,4,5\}$。

#### 【数据范围】

对于所有数据，$1 \le n \le 5\times10^5$，$1 \le a_i,b_i \le 10^9$，保证 $a_i \neq b_i$。

**本题采用捆绑测试。**

|子任务编号|分值|$n \le$|特殊性质|
|:---:|:---:|:---:|:---:|
|$1$|$9$|$1$|无|
|$2$|$9$|$5\times10^5$|保证 $a_i < b_i$|
|$3$|$21$|$5\times10^5$|数据随机生成|
|$4$|$27$|$2000$|无|
|$5$|$34$|$5\times10^5$|无|


---

---
title: "『PG2』弯曲半平面直线同向图最大流"
layout: "post"
diff: 普及+/提高
pid: P9901
tag: ['图论', '贪心', '拓扑排序']
---
# 『PG2』弯曲半平面直线同向图最大流
## 题目描述

若能将有向图 $G=(V,E)$ 画在平面上，使得点在一条直线上，任意两条边（可以为弯曲的弧线）仅在重合顶点处相交，且边上的所有点都在直线同侧，且每条边的起点到终点的射线的方向相同，则称 $G$ 是弯曲半平面直线同向图。对于一个弯曲半平面直线同向图给定 $n$ 个点，$m$ 条有向边，给定每条边的容量，求从点 $s$ 到点 $t$ 的最大流。
## 输入格式

第一行包含四个正整数 $n$、$m$、$s$、$t$，用空格分隔，分别表示点的个数、有向边的个数、源点序号、汇点序号。

接下来 $m$ 行每行包含三个正整数 $u_i$、$v_i$、$c_i$，用空格分隔，表示第 $i$ 条有向边从 $u_i$ 出发，到达 $v_i$，容量为 $c_i$。


## 输出格式

一个整数，表示 $s$ 到 $t$ 的最大流。
## 样例

### 样例输入 #1
```
5 7 1 5
1 2 1
2 3 1
3 4 1
4 5 1
2 4 1
1 4 1
1 5 1
```
### 样例输出 #1
```
2
```
## 提示

无重边自环。

对于 $30\%$ 的数据 $n\leq 10^3$。

对于 $70\%$ 的数据 $n\leq 10^5$。

对于 $100\%$ 的数据 $2\leq n\leq 10^6$，$1\leq m\leq \min\{2\times 10^9,\dfrac{n(n-1)}{2}\}$，$1\leq c\leq 10^{12}$，$s\neq t$。

### 样例解释 1
![](https://cdn.luogu.com.cn/upload/image_hosting/9qletk0m.png)


---

---
title: "[USACO23DEC] Bovine Acrobatics S"
layout: "post"
diff: 普及+/提高
pid: P9977
tag: ['贪心', 'USACO', '堆', '2023', 'O2优化', '排序']
---
# [USACO23DEC] Bovine Acrobatics S
## 题目描述

Farmer John 决定让他的奶牛表演杂技！首先，FJ 为他的奶牛称重，发现她们有 $N$（$1\le N\le 2\times 10^5$）个不同的体重。具体来说，对于全部的 $i\in [1,N]$，有 $a_i$ 只奶牛的体重为 $w_i$ 单位（$1\le a_i\le 10^9, 1\le w_i\le 10^9$）。

他最出名的节目需要奶牛叠成**平衡的奶牛塔**。一座**奶牛塔**是一些奶牛，每只奶牛站在下一只奶牛身上。一座奶牛塔是**平衡的**，当且仅当每一只被踩着的奶牛，都比**直接**踩在它身上的那只奶牛重至少 $K$（$1\le K\le 10^9$）单位。每只奶牛都可以成为奶牛塔的一部分。

如果 FJ 想要创造最多 $M$（$1 \le M \le 10^9$）座奶牛塔，最多有多少只奶牛可以成为奶牛塔的一部分？
## 输入格式

第一行包含三个空格分隔的整数 $N$，$M$ 和 $K$。

接下来 $N$ 行，每行包含两个空格分隔的整数 $w_i$ 和 $a_i$。保证所有的 $w_i$ 是不同的。
## 输出格式

输出当 FJ 采用最佳方案时，奶牛塔中奶牛的最大数目。
## 样例

### 样例输入 #1
```
3 5 2
9 4
7 6
5 5
```
### 样例输出 #1
```
14
```
### 样例输入 #2
```
3 5 3
5 5
7 6
9 4
```
### 样例输出 #2
```
9
```
## 提示

### 样例解释 1

FJ 可以用体重为 $5,7,9$ 的奶牛创造四座平衡的奶牛塔，再用体重为 $5,7$ 的奶牛创造另一座。

### 样例解释 2

FJ 可以用体重为 $5,9$ 的奶牛创造四座平衡的奶牛塔，再用体重为 $7$ 的一只奶牛创造另一座。或者，他可以用体重为 $5,9$ 的奶牛创造四座平衡的奶牛塔，再用体重为 $5$ 的一只奶牛创造另一座。

### 测试点性质

- 测试点 $3-5$ 满足 $M \le 5000$ 且奶牛的总数不超过 $5000$。
- 测试点 $6-11$ 满足奶牛的总数不超过 $2\cdot 10^5$。
- 测试点 $12-17$ 没有额外限制。



---

---
title: "[USACO23DEC] Minimum Longest Trip G"
layout: "post"
diff: 普及+/提高
pid: P9981
tag: ['动态规划 DP', '倍增', 'USACO', '2023', 'O2优化', '拓扑排序', '哈希 hashing']
---
# [USACO23DEC] Minimum Longest Trip G
## 题目描述

Bessie 正在奶牛大陆上旅行。奶牛大陆由从 $1$ 到 $N$ 编号的 $N$（$2 \le N \le 2\cdot 10^5$）座城市和 $M$（$1 \le M \le 4\cdot 10^5$）条单向道路组成。第 $i$ 条路从城市 $a_i$ 通向城市 $b_i$，标签为 $l_i$。

由城市 $x_0$ 开始的长度为 $k$ 的旅程被定义为一个城市序列 $x_0,x_1,\ldots,x_k$，对于所有的 $0 \le i < k$，存在由城市 $x_i$ 到 $x_{i+1}$ 的路。保证在奶牛大路上不存在长度无限的旅程，不存在两条路连接一对相同的城市。

对于每座城市，Bessie 想知道从它开始的最长旅程。对于一些城市，从它们开始的最长旅程不唯一，Bessie 将选择其中道路标签序列字典序更小的旅程。一个序列比等长的另一个序列字典序更小，当且仅当在它们不同的第一个位置，前者比后者的元素更小。

输出 Bessie 在每座城市选择的旅途的长度和道路标签之和。
## 输入格式

第一行包含 $N$ 和 $M$。

接下来 $M$ 行，每行三个整数 $a_i,b_i,l_i$，代表一条由 $a_i$ 到 $b_i$，标签为 $l_i$ 的单向道路。
## 输出格式

输出 $N$ 行，第 $i$ 行包含由空格分隔的两个整数，表示 Bessie 选择的从城市 $i$ 开始的旅程的长度和道路标签之和。
## 样例

### 样例输入 #1
```
4 5
4 3 10
4 2 10
3 1 10
2 1 10
4 1 10
```
### 样例输出 #1
```
0 0
1 10
1 10
2 20
```
### 样例输入 #2
```
4 5
4 3 4
4 2 2
3 1 5
2 1 10
4 1 1
```
### 样例输出 #2
```
0 0
1 10
1 5
2 12
```
### 样例输入 #3
```
4 5
4 3 2
4 2 2
3 1 5
2 1 10
4 1 1
```
### 样例输出 #3
```
0 0
1 10
1 5
2 7
```
### 样例输入 #4
```
4 5
4 3 2
4 2 2
3 1 10
2 1 5
4 1 1
```
### 样例输出 #4
```
0 0
1 5
1 10
2 7
```
## 提示

### 样例解释 2

在下面的解释中，我们用 $a_i\xrightarrow{l_i} b_i$ 表示由城市 $a_i$ 通往 $b_i$，标签为 $l_i$ 的单向道路。

从城市 $4$ 出发有多条旅程，包含 $4\xrightarrow{4} 3\xrightarrow 5 1$，$4\xrightarrow 1 1$ 和 $4\xrightarrow 2 2\xrightarrow{10} 1$。在这些旅程中，$4\xrightarrow{4} 3\xrightarrow 5 1$ 和 $4\xrightarrow 2 2\xrightarrow{10} 1$ 是最长的。它们的长度均为 $2$，道路标签序列分别为 $[4,5]$ 和 $[2,10]$。$[2,10]$ 是字典序更小的那一个，它的和为 $12$。

### 测试点性质

- 测试点 $5-6$ 满足所有道路的标签相同。
- 测试点 $7-8$ 满足所有道路的标签不相同。
- 测试点 $9-10$ 满足 $N,M \le 5000$。
- 测试点 $11-20$ 没有额外限制。


---


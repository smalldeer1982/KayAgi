---
title: "[常州市赛 2023] 红绿灯"
layout: "post"
diff: 普及+/提高
pid: B4221
tag: ['2023', '数论', '江苏', '最大公约数 gcd', '中国剩余定理 CRT', '科创活动', '小学活动']
---
# [常州市赛 2023] 红绿灯
## 题目背景

搬运自 <http://czoj.com.cn/p/678>。数据为民间数据。
## 题目描述

小 X 家门前有两个红绿灯，小 X 做完了数学作业，闲着无聊便在窗边观察。他发现这两个红绿灯亮红灯和亮绿灯的时间是相等的，第一个红绿灯亮 $p$ 秒绿灯，再亮 $p$ 秒红灯……，第二个红绿灯亮 $q$ 秒绿灯，再亮 $q$ 秒红灯……，如此循环往复。

现在恰好两个红绿灯都从红灯变成了绿灯，小 X 想要知道未来的 $2\times p\times q$ 秒内，有多少秒满足两个红绿灯都亮绿灯。
## 输入格式

第一行 $2$ 个正整数 $p,q$，含义见题面。
## 输出格式

输出一行一个整数表示在未来的 $2\times p\times q$ 秒内，有多少秒满足两个红绿灯都亮绿灯。
## 样例

### 样例输入 #1
```
2 3
```
### 样例输出 #1
```
3
```
### 样例输入 #2
```
18 66
```
### 样例输出 #2
```
612
```
### 样例输入 #3
```
2 255
```
### 样例输出 #3
```
128
```
## 提示

### 样例 $\textbf 1$ 解释

在未来的 $12$ 秒内，第一个红绿灯在第 $1,2,5,6,9,10$ 秒亮绿灯。

第一个红绿灯在第 $1,2,3,7,8,9$ 秒亮绿灯。

在第 $1,2,9$ 秒时，同时亮绿灯，一共 $3$ 秒。

### 数据范围

本题共有 $12$ 个测试点。

|测试点编号|$p,q$|特殊性质|
|:-:|:-:|:-:|
|$1\sim3$|$1\le p,q\le 1000$|无|
|$4\sim5$|$1=p\le q\le 10^9$|无|
|$6\sim9$|$1\le p,q\le10^9$|$p\perp q$|
|$10\sim12$|$1\le p,q\le 10^9$|无|


---

---
title: "[NOIP 2009 提高组] Hankson 的趣味题"
layout: "post"
diff: 普及+/提高
pid: P1072
tag: ['数学', '2009', 'NOIP 提高组', '枚举', '最大公约数 gcd']
---
# [NOIP 2009 提高组] Hankson 的趣味题
## 题目描述

Hanks 博士是 BT（Bio-Tech，生物技术) 领域的知名专家，他的儿子名叫 Hankson。现在，刚刚放学回家的 Hankson 正在思考一个有趣的问题。

今天在课堂上，老师讲解了如何求两个正整数 $c_1$ 和 $c_2$ 的最大公约数和最小公倍数。现在 Hankson 认为自己已经熟练地掌握了这些知识，他开始思考一个“求公约数”和“求公倍数”之类问题的“逆问题”，这个问题是这样的：已知正整数 $a_0,a_1,b_0,b_1$，设某未知正整数 $x$ 满足：

1. $x$ 和 $a_0$ 的最大公约数是 $a_1$；

2. $x$ 和 $b_0$ 的最小公倍数是 $b_1$。

Hankson 的“逆问题”就是求出满足条件的正整数 $x$。但稍加思索之后，他发现这样的 $x$ 并不唯一，甚至可能不存在。因此他转而开始考虑如何求解满足条件的 $x$ 的个数。请你帮助他编程求解这个问题。

## 输入格式

第一行为一个正整数 $n$，表示有 $n$ 组输入数据。接下来的$ n$ 行每行一组输入数据，为四个正整数 $a_0,a_1,b_0,b_1$，每两个整数之间用一个空格隔开。输入数据保证 $a_0$ 能被 $a_1$ 整除，$b_1$ 能被 $b_0$ 整除。

## 输出格式

共 $n$ 行。每组输入数据的输出结果占一行，为一个整数。

对于每组数据：若不存在这样的 $x$，请输出 $0$，若存在这样的 $x$，请输出满足条件的 $x$ 的个数；
## 样例

### 样例输入 #1
```
2 
41 1 96 288 
95 1 37 1776 
```
### 样例输出 #1
```
6 
2
```
## 提示

**【样例解释】**

第一组输入数据，$x$ 可以是 $9,18,36,72,144,288$，共有 $6$ 个。

第二组输入数据，$x$ 可以是 $48,1776$，共有 $2$ 个。

**【数据范围】**

- 对于 $50\%$ 的数据，保证有 $1\leq a_0,a_1,b_0,b_1 \leq 10000$ 且 $n \leq 100$。
- 对于 $100\%$ 的数据，保证有 $1 \leq a_0,a_1,b_0,b_1 \leq 2 \times 10^9$ 且 $n≤2000$。

NOIP 2009 提高组 第二题



---

---
title: "[USACO25FEB] Transforming Pairs S"
layout: "post"
diff: 普及+/提高
pid: P11841
tag: ['USACO', '2025', '数论', '最大公约数 gcd']
---
# [USACO25FEB] Transforming Pairs S
## 题目描述

聪明奶牛 Bessie 发现了一种新的迷恋——数学魔法！一天，当她在 Farmer John 牧场的草地上小跑时，她偶然发现了两堆有魔法的干草。第一堆包含 $a$ 捆干草，第二堆包含 $b$ 捆干草（$1\le a,b\le 10^{18}$）。

在干草堆边上，半埋在泥土里，她发现了一卷古老的卷轴。当她展开卷轴时，发光的字母揭示了一个预言：

奉大草原之令，被选中者需令此平凡之干草堆转为恰好 $c$ 捆及 $d$ 捆——不可多，亦不可少。

Bessie 意识到她只能施展以下两种魔法：

- 她可以施法召唤新的干草捆以增加第一堆的大小，增加的数量等于当前第二堆的数量。
- 她可以施法召唤新的干草捆以增加第二堆的大小，增加的数量等于当前第一堆的数量。

她必须逐次执行这些操作，但可以任意顺序执行任意多次。她必须恰好使第一堆达到 $c$ 捆，第二堆达到 $d$ 捆（$1\le c,d\le 10^{18}$）。

对于 $T$（$1\le T\le 10^4$）个独立的测试用例中的每一个，输出实现预言所需的最小操作次数，或者如果不可能实现时输出 -1。
## 输入格式

输入的第一行包含 $T$。

以下 $T$ 行，每行包含四个整数 $a$，$b$，$c$，$d$。
## 输出格式

输出 $T$ 行，为每一个测试用例的答案。

## 样例

### 样例输入 #1
```
4
5 3 5 2
5 3 8 19
5 3 19 8
5 3 5 3
```
### 样例输出 #1
```
-1
3
-1
0
```
### 样例输入 #2
```
1
1 1 1 1000000000000000000
```
### 样例输出 #2
```
999999999999999999
```
## 提示

样例 1 解释：

在第一个测试用例中，由于 $b>d$，但操作只可能增加 $b$，因此不可能实现。

在第二个测试用例中，最初两堆有 $(5, 3)$ 捆。Bessie 可以将第一堆增加第二堆的数量，得到 $(8, 3)$ 捆。然后 Bessie 可以将第二堆增加第一堆的新数量，并执行该操作两次，得到 $(8, 11)$ 并最后得到 $(8, 19)$ 捆。这与 $c$ 和 $d$ 一致，且是达到目标的最小操作次数。

注意，第三个测试用例的答案与第二个不同，因为 $c$ 和 $d$ 的值交换了（堆的顺序有影响）。

在第四个测试用例中，不需要任何操作。

- 测试点 $3\sim 4$：$\max(c, d) \le 20 \cdot\min(a, b)$。
- 测试点 $5\sim 7$：$T \le 10$ 且 $a,b,c,d\le 10^6$。
- 测试点 $8\sim 12$：没有额外限制。


---

---
title: "又是毕业季II"
layout: "post"
diff: 普及+/提高
pid: P1414
tag: ['数学', '洛谷原创', '枚举', '最大公约数 gcd', '调和级数']
---
# 又是毕业季II
## 题目背景

“叮铃铃铃”，随着高考最后一科结考铃声的敲响，三年青春时光顿时凝固于此刻。毕业的欣喜怎敌那离别的不舍，憧憬着未来仍毋忘逝去的歌。一千多个日夜的欢笑和泪水，全凝聚在毕业晚会上，相信，这一定是一生最难忘的时刻！

## 题目描述

彩排了一次，老师不太满意。当然啦，取每位同学的号数来找最大公约数显然不太合理。于是老师给每位同学评了一个能力值。于是现在问题变为，从 $n$ 个学生中挑出 $k$ 个人使得他们的默契程度（即能力值的最大公约数）最大。但因为节目太多了，而且每个节目需要的人数又不知道。老师想要知道所有情况下能达到的最大默契程度是多少。这下子更麻烦了，还是交给你吧~

PS：一个数的最大公约数即本身。

## 输入格式

第一行一个正整数 $n$。

第二行为 $n$ 个空格隔开的正整数，表示每个学生的能力值。

## 输出格式

总共 $n$ 行，第 $i$ 行为 $k=i$ 情况下的最大默契程度。

## 样例

### 样例输入 #1
```
4
1 2 3 4

```
### 样例输出 #1
```
4
2
1
1

```
## 提示

【题目来源】

lzn 原创

【数据范围】

记输入数据中能力值的最大值为 $\textit{inf}$。

- 对于 $20\%$ 的数据，$n \leq 5$，$\textit{inf}\leq 10^3$；
- 对于另 $30\%$ 的数据，$n \leq 100$，$\textit{inf} \leq 10$；
- 对于 $100\%$ 的数据，$n \leq 10^4$，$\textit{inf} \leq 10^6$。


---

---
title: "[CQOI2014] 数三角形"
layout: "post"
diff: 普及+/提高
pid: P3166
tag: ['数学', '2014', '重庆', '各省省选', '最大公约数 gcd', '排列组合']
---
# [CQOI2014] 数三角形
## 题目描述

给定一个 $N\times M$ 的网格，请计算三点都在格点上的三角形共有多少个。注意三角形的三点不能共线。
## 输入格式

输入一行，包含两个空格分隔的正整数 $M$ 和 $N$。
## 输出格式

输出一个正整数，为所求三角形数量。

## 样例

### 样例输入 #1
```
2 2
```
### 样例输出 #1
```
76
```
## 提示

#### 数据规模与约定

对于全部的测试点，保证 $1\le N,M\le1000$。


---

---
title: "[POI 2019] Najmniejsza wspólna wielokrotność / 最小公倍数"
layout: "post"
diff: 普及+/提高
pid: P6659
tag: ['2019', '二分', 'POI（波兰）', '最大公约数 gcd']
---
# [POI 2019] Najmniejsza wspólna wielokrotność / 最小公倍数
## 题目背景

Byteasar 正在准备他的数学考试。
## 题目描述

老师跟他说考试题目中有关于最小公倍数 $\rm lcm$ 的题目，于是他找到了一道题练练手。

给定一个整数 $M$，求一个区间 $[a,b]$ 使得 $M$ 为这个区间所有数的最小公倍数。

因为您很强，所以 Byteasar 在解出来这道题的同时也想问问您这题的答案。

因为 Byteasar 非常爱问问题，所以他要问您 $z$ 组问题。
## 输入格式

第一行一个整数 $z$ 代表询问个数。    
接下来 $z$ 行每行一个整数 $M$ 代表一个询问。
## 输出格式

$z$ 行每行两个整数 $a,b$ 代表一个询问的答案。    
如果有多组解：

- 输出 $a$ 最小的
- 如果还有多组解输出 $b$ 最小的
## 样例

### 样例输入 #1
```
3
12
504
17
```
### 样例输出 #1
```
1 4
6 9
NIE
```
### 样例输入 #2
```
5
5
6
7
8
9
```
### 样例输出 #2
```
NIE
1 3
NIE
NIE
NIE
```
### 样例输入 #3
```
1
1000000
```
### 样例输出 #3
```
NIE
```
### 样例输入 #4
```
1
99999990000000
```
### 样例输出 #4
```
9999999 10000000
```
## 提示

#### 样例说明

对于样例 $1$ 的第一组数据，$12$ 为区间 $[1,4]$ 的最小公倍数。

另一组附加样例见附加文件的 sample.in 和 sample.out。

#### 数据规模与约定

**本题采用捆绑测试。**

- Subtask 1（18 pts）：$z \le 10$，$M \le 1000$。
- Subtask 2（20 pts）：$z\le 100$，$M \le 10^9$。
- Subtask 3（20 pts）：$z \le 100$，$M \le 10^{18}$。
- Subtask 4（42 pts）：无特殊限制。

对于 $100\%$ 的数据，$1 \le z\le 10^4$，$1 \le M \le 10^{18}$。

#### 说明

翻译自 [POI 2019](https://sio2.mimuw.edu.pl/c/oi27-1/dashboard/) A [Najmniejsza wspólna wielokrotność](https://sio2.mimuw.edu.pl/c/oi27-1/p/nww/)。


---

---
title: "[BalticOI 热身赛] Roses"
layout: "post"
diff: 普及+/提高
pid: P6767
tag: ['枚举', '最大公约数 gcd', 'BalticOI（波罗的海）']
---
# [BalticOI 热身赛] Roses
## 题目背景

因为特殊原因，本题目另外 $24$ 组数据请在 [这里](https://www.luogu.com.cn/problem/U127462) 提交。

Valentine 是人赢。
## 题目描述

现在 Valentine 要给他的 $N$ 个妹子买玫瑰花，现在 Valentine 面前有两家店，每一家店有无数朵玫瑰花，但是他们按束卖。第一家店一束花里有 $A$ 朵，每一束花要用 $B$ 块钱。第二家店一束花里有 $C$ 朵，每一束花要用 $D$ 块钱。

求 Valentine 至少买 $N$ 朵花最少需要花多少钱。

至少可以这么理解，假如 $M>N$，但是买 $M$ 朵花的钱比买 $N$ 朵花的少，Valentine 就会买 $M$ 朵花，并把多出来的花给其他妹子，没错，Valentine 很花心。
## 输入格式

一行五个整数 $N,A,B,C,D$，意义见题目所述。
## 输出格式

一行一个整数代表最小花费。
## 样例

### 样例输入 #1
```
5 1 4 3 6
```
### 样例输出 #1
```
12
```
### 样例输入 #2
```
22 2 3 10 14
```
### 样例输出 #2
```
31
```
## 提示

#### 样例说明

对于样例 $1$，Valentine 可以选择在第二家店买 $2$ 束花。

对于样例 $2$，Valentine 可以选择在第一家店买 $1$ 束花，在第二家店买 $2$ 束花。

#### 数据规模与约定

**本题采用捆绑测试。**

- Subtask 1（20 pts）：$N,A,B,C,D \le 1000$。
- Subtask 2（80 pts）：无特殊限制。

对于 $100\%$ 的数据，$1 \le N \le 10^{15}$，$1 \le A,B,C,D \le 10^5$，保证答案不超过 $10^{18}$。

#### 说明

翻译自 [BalticOI 2020 Day0 B Roses](http://www.boi2020.lv/data/tasks/en/day0/roses.pdf)。

与 BalticOI 2012 Day0 A 内容一致。


---

---
title: "「GMOI R1-T3」Number Pair"
layout: "post"
diff: 普及+/提高
pid: P8926
tag: ['数学', '数论', 'O2优化', '最大公约数 gcd']
---
# 「GMOI R1-T3」Number Pair
## 题目描述

我们定义满足如下条件的数对 $(x,y)$ 叫做奇妙数对：

$k \times \gcd(x,y)=\operatorname{lcm}(x,y)$ 并且 $P \le \gcd(x,y) \le Q$（保证 $P \le Q$）。

有 $T$ 组数据，对于每一组数据，给定 $k,P,Q$ 三个数，求符合条件的数对 $(x,y)$ 的对数。

**答案对 $10^9+7$ 取模。**
## 输入格式

**本题有多组数据。**

第一行一个整数 $T$，表示数据数量。

接下来 $T$ 行，每行三个整数 $k,P,Q$。
## 输出格式

对于每一组数据，给出对应答案，每组数据一行。


## 样例

### 样例输入 #1
```
5
10 1 3
30 1 5
997 24 35
34 39 99
210 1000 1001
```
### 样例输出 #1
```
12
40
24
244
32
```
## 提示

**注意并不寻常的时间限制。**

对于 $100\%$ 的数据 $1 \le k \le 10^{16}$，$1 \le T \le 50$，$1 \le P \le Q \le 2\times 10^9$。

| 测试点 | $k$ | $T$ | $P$ | $Q$ | 总分 |
| :----------: | :----------: | :----------: | :-------------: | :----------: | :----------: |
| $1\sim 3$ | $k \le 3$ | $T=1$ | $P=1$ | $Q=1$ | $15$ |
| $4\sim 8$ | $k \le 100$ | $T \le 8$ | $P \le 30$ |  $Q \le 30$ |$15$ |
| $9\sim 13$ | $k \le 10^3$ | $T \le 50$ | $P \le 500$ | $Q \le 500$ | $25$ |
| $14\sim 18$ | $k \le 10^{12}$ | $T \le 50$ | $P \le 10^4$ | $Q \le 10^4$ | $15$ |
| $19\sim 22$ | $k \le 10^{13}$ | $T \le 50$ | $P \le 10^6$ | $Q \le 10^6$ | $12$ |
| $23\sim 28$ | $k \le 10^{16}$ | $T \le 50$ | $P \le 2\times10^9$ | $Q \le 2\times10^9$ | $18$ |

**本题保证 $k$ 随机生成，并不存在极限卡人数据，时限已经开到 std 两倍，请各位选手放心。**


---


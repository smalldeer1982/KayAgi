---
title: "[LSOT-2] 胜者组"
layout: "post"
diff: 普及+/提高
pid: P10156
tag: ['动态规划 DP', '背包 DP']
---
# [LSOT-2] 胜者组
## 题目背景

进入胜者组就算胜利吗...

至少人们都这样说。
## 题目描述

小 H 的学校在 noip 结束后要决定踢出一些学生回去学文化课。

具体的，学校一共有 $n$ 个同学，留下了最多 $m$ 个学习信息学的名额。

学校里的同学组成了 $k$ 个小团体，其中第 $i$ 个同学属于第 $c_i$ 个小团体。

你每次可以钦定两个处于同一小团体的学生学习文化课。若你让学生 $i,j(c_i=c_j)$ 去学习文化课，学生会产生 $a_i+a_j+x\times|i-j|$ 的不满意度。这里 $x$ 是输入一开始给定的常数。

你需要让学生的不满意度最小化，或报告无法留下不多于 $m$ 个学习信息学的学生。
## 输入格式

第一行四个正整数 $n,m,k,x$。

接下来两行每行 $n$ 个整数分别表示 $a_i,c_i$。
## 输出格式

一行一个整数表示最小的不满意度。或输出 `Impossible` 表示无解。
## 样例

### 样例输入 #1
```
6 2 2 3
2 5 7 2 5 7
1 1 2 1 2 1
```
### 样例输出 #1
```
25
```
## 提示

样例解释：

分别钦定 $(1,2)$ 和 $(4,6)$ 学习文化课，不满意度为 $(2+5+3\times|1-2|)+(2+7+3\times|4-6|)=25$。

需要注意的是，一个同学不可以被钦定多次。

**「本题采用捆绑测试」**

- $\texttt{Subtask 1(15pts)：}n\le20$。
- $\texttt{Subtask 2(15pts)：}x=0$。
- $\texttt{Subtask 3(15pts)：}k=1$。
- $\texttt{Subtask 4(20pts)：}n\le 300$。
- $\texttt{Subtask 5(35pts)：}$无特殊性质。

对于全部的数据，$0\le a_i,x\le10^5$，$1\le c_i\le k\le n\le 5000$，$0\le m\le n$。


---

---
title: "[NOIP 2006 提高组] 金明的预算方案"
layout: "post"
diff: 普及+/提高
pid: P1064
tag: ['动态规划 DP', '2006', 'NOIP 提高组', '背包 DP']
---
# [NOIP 2006 提高组] 金明的预算方案
## 题目描述

金明今天很开心，家里购置的新房就要领钥匙了，新房里有一间金明自己专用的很宽敞的房间。更让他高兴的是，妈妈昨天对他说：“你的房间需要购买哪些物品，怎么布置，你说了算，只要不超过 $n$ 元钱就行”。今天一早，金明就开始做预算了，他把想买的物品分为两类：主件与附件，附件是从属于某个主件的，下表就是一些主件与附件的例子：

| 主件 | 附件 |
| :----------: | :----------: |
| 电脑 | 打印机，扫描仪 |
| 书柜 | 图书 |
| 书桌 | 台灯，文具 |
| 工作椅 | 无 |

如果要买归类为附件的物品，必须先买该附件所属的主件。每个主件可以有 $0$ 个、$1$ 个或 $2$ 个附件。每个附件对应一个主件，附件不再有从属于自己的附件。金明想买的东西很多，肯定会超过妈妈限定的 $n$ 元。于是，他把每件物品规定了一个重要度，分为 $5$ 等：用整数 $1 \sim 5$ 表示，第 $5$ 等最重要。他还从因特网上查到了每件物品的价格（都是 $10$ 元的整数倍）。他希望在不超过 $n$ 元的前提下，使每件物品的价格与重要度的乘积的总和最大。

设第 $j$ 件物品的价格为 $v_j$，重要度为 $w_j$，共选中了 $k$ 件物品，编号依次为 $j_1,j_2,\dots,j_k$，则所求的总和为：

$$v_{j_1} \times w_{j_1}+v_{j_2} \times w_{j_2}+ \dots +v_{j_k} \times w_{j_k}$$

请你帮助金明设计一个满足要求的购物单。

## 输入格式

第一行有两个整数，分别表示总钱数 $n$ 和希望购买的物品个数 $m$。

第 $2$ 到第 $(m + 1)$ 行，每行三个整数，第 $(i + 1)$ 行的整数 $v_i$，$p_i$，$q_i$ 分别表示第 $i$ 件物品的价格、重要度以及它对应的的主件。如果 $q_i=0$，表示该物品本身是主件。

## 输出格式

输出一行一个整数表示答案。
## 样例

### 样例输入 #1
```
1000 5
800 2 0
400 5 1
300 5 1
400 3 0
500 2 0

```
### 样例输出 #1
```
2200
```
## 提示

#### 数据规模与约定

对于全部的测试点，保证 $1 \leq n \leq 3.2 \times 10^4$，$1 \leq m \leq 60$，$0 \leq v_i \leq 10^4$，$1 \leq p_i \leq 5$，$0 \leq q_i \leq m$，答案不超过 $2 \times 10^5$。

NOIP 2006 提高组 第二题


---

---
title: "【MX-J1-T4】『FLA - III』Wrestle"
layout: "post"
diff: 普及+/提高
pid: P10784
tag: ['动态规划 DP', '二分', 'O2优化', '排序', '背包 DP', '前缀和', '双指针 two-pointer', '梦熊比赛']
---
# 【MX-J1-T4】『FLA - III』Wrestle
## 题目背景

原题链接：<https://oier.team/problems/J1D>。

---

在 2022 年末，疫情将西北某不知名知名学校的大多数学生关在家中上网课，安同学还不知道，他和语文老师的对决已然悄无声息地开始了——他每天早读和语文课都直接睡过去了。

安同学习惯起来穿好衣服、面对摄像头睡觉，摄像头只能拍到他的半个肩膀，就算被强制打开也不会暴露他在睡觉的事实，而且从来没有老师强制打开他的摄像头。而这个不凡的早晨，语文老师打开了他的摄像头，现在是早读时间，他在朦胧中被老师的关爱声叫醒，可惜为时已晚，老师已经愤怒。安同学决定假装网络卡顿，平复老师愤怒的心情。

老师，愤怒了！在安同学醒来后的某些时间段，她要呼叫他的真名，其余时间等他应答。与此同时安同学要打造网卡的假象，他可以在某些时间段内检查设备或者呼叫老师，其余时间静止或随机在画面中闪现，他在这些时间段内的行为称为表演。你的任务是帮助安同学在不激怒老师的情况下最大化表演时间。

因为安同学实在是太抽象了，原始题面受他影响变得也很抽象，这里只有形式化题面给你看。
## 题目描述

给定三个正整数 $n,m,k$ 和两组线段。第一组线段有权值，共 $n$ 条，是**红色**的；第二组线段没有权值，共 $m$ 条，是**蓝色**的。这些线段位于同一个数轴。

- 使用 $l,r,w$ 三个正整数表示一条从数轴上第 $l$ 个整点覆盖到第 $r$ 个整点，权值为 $w$ 的红色线段。**保证数轴上任意一个整点至多被红色线段覆盖一次。**

- 使用 $L,R$ 两个正整数表示一条从数轴上第 $L$ 个整点覆盖到第 $R$ 个整点，没有权值的蓝色线段。**保证数轴上任意一个整点至多被蓝色线段覆盖一次。**

如果一条红色线段从第 $l_0$ 个整点覆盖到第 $r_0$ 个整点，一条蓝色线段从第 $L_0$ 个整点覆盖到第 $R_0$ 个整点且 $\max(l_0,L_0) \leq \min(r_0,R_0)$，就认为这两条线段有交集，交集包含从第 $\max(l_0,L_0)$ 个整点到第 $\min(r_0,R_0)$ 个整点的全部 $\min(r_0,R_0)-\max(l_0,L_0)+1$ 个整点。你可以选择一些蓝色线段，一种合法的选择方案必须符合以下条件：

- 题目给定的每条红色线段至多与你选择的 $1$ 条蓝色线段有交集。

- 所有和**你选择的蓝色线段**有交集的红色线段权值之和不超过 $k$。

选择方案合法时，**你选择的蓝色线段**和**所有红色线段**的交集至多能包含多少个整点？
## 输入格式

第一行输入三个正整数 $n,m,k$。

接下来 $n$ 行，第 $i$ 行输入三个正整数 $l_i,r_i,w_i$ 表示一条红色线段。

接下来 $m$ 行，第 $i$ 行输入两个正整数 $L_i,R_i$ 表示一条蓝色线段。

**保证数轴上任意一个整点至多被红色线段覆盖一次。保证数轴上任意一个整点至多被蓝色线段覆盖一次。**
## 输出格式

输出一行一个整数表示答案。
## 样例

### 样例输入 #1
```
2 3 23
7 18 7
63 71 2
77 86
13 19
63 71

```
### 样例输出 #1
```
15

```
### 样例输入 #2
```
4 5 7
59 65 7
39 42 1
43 51 2
19 33 2
14 25
71 81
6 11
59 69
83 92

```
### 样例输出 #2
```
7

```
### 样例输入 #3
```
4 8 45
80 94 22
60 67 2
35 44 45
7 14 5
82 86
2 3
58 63
48 50
73 80
25 45
11 19
93 94

```
### 样例输出 #3
```
13

```
## 提示

**「样例解释 #1」**

![example](https://cdn.luogu.com.cn/upload/image_hosting/0mxbdlcn.png)

如图，选择输入的第 $2$ 条蓝色线段和第 $3$ 条蓝色线段。

第 $2$ 条蓝色线段与第 $1$ 条红色线段有交，交集包含从第 $13$ 个整点到第 $18$ 个整点的所有整点；第 $3$ 条蓝色线段与第 $2$ 条红色线段有交，交集包含从第 $63$ 个整点到第 $71$ 个整点的所有整点。

第 $1$ 条红色线段仅与第 $2$ 条蓝色线段有交，第 $2$ 条红色线段仅与第 $3$ 条蓝色线段有交；和被选择的蓝色线段有交的红色线段权值和为 $9$，方案合法。故答案为 $15$。

**「数据范围」**

**本题采用捆绑测试。**

|Subtask|$n \leq$|$m \leq$|$k \leq$|$l_i,r_i,L_i,R_i \leq$|分值|
|:-:|:-:|:-:|:-:|:-:|:-:|
|**#1**|$10$|$10$|$50$|$100$|$20$|
|**#2**|$200$|$200$|$200$|$10^5$|$30$|
|**#3**|$5000$|$5000$|$5000$|$10^9$|$30$|
|**#4**|$2 \times 10^5$|$5000$|$5000$|$10^9$|$20$|

对于 $100\%$ 的数据，$1 \leq n \leq 2 \times 10^5$，$1 \leq m,k \leq 5000$，$1 \leq l_i,r_i,L_i,R_i \leq 10^9$，$1 \leq w_i \leq k$，$l_i < r_i$，$L_i < R_i$。**保证数轴上任意一个整点至多被红色线段覆盖一次。保证数轴上任意一个整点至多被蓝色线段覆盖一次。**


---

---
title: "「QMSOI R1」 生熏鱼"
layout: "post"
diff: 普及+/提高
pid: P11069
tag: ['动态规划 DP', '搜索', '二分', 'O2优化', '背包 DP']
---
# 「QMSOI R1」 生熏鱼
## 题目背景

一切起源于一个叫神荀彧的武将...

[那这道题与神荀彧的关系在哪里呢？](https://www.luogu.com.cn/paste/pk12x8vh)

![](https://patchwiki.biligame.com/images/msgs/thumb/e/eb/1d6q6kksj6krwhaoqdoh3029glw4ypn.jpg/376px-%E7%A5%9E%E8%8D%80%E5%BD%A7-%E7%BB%8F%E5%85%B8%E5%BD%A2%E8%B1%A1.jpg)


## 题目描述

一共有 $n$ 种攻击，第 $i$ 种攻击会先让你得到 $a_i$ 点经验，然后让你失去 $b_i$ 点血量。

你将**依次**受到 $k$ 次攻击，其中，第 $i$ 次攻击的种类是 $c_i$，你的初始血量为 $m$。

为了获得更多的经验，你可以选择 $n$ 种攻击中的任意种，并防止你受到的第一次这种攻击，防止后既不会损失血量，也不会增加经验值。

现在你想知道的是在你的血量降到 $0$ 及以下前，最多能获得多少点经验。
## 输入格式

一行 4 个整数，分别代表 $n,m,k,s$，其中，$s$ 为随机种子，其它变量含义与题目描述相同。

因为本题输入数据过大，选手需要使用如下方式获取数据：
~~~cpp
const int M=1e9,C=1e5+5;
void read(){
    cin>>n>>m>>k>>s;
    mt19937 rand(s);
    for(int i=1;i<=n;i++)  a[i]=rand()%M+1,b[i]=rand()%C+1;
    for(int i=1;i<=k;i++)  c[i]=rand()%n+1;
}
~~~
数组含义与题目描述中相同。
## 输出格式

输出一行一个整数，表示你最多能获得多少点经验。
## 样例

### 样例输入 #1
```
2 100000 5 114514
```
### 样例输出 #1
```
3765807592
```
## 提示

### 样例解释

样例 $1$ 的数据中 $a=\{953888980,904140652\},b=\{6583,80624\},c=\{1,2,1,1,2\}$。

此时显然可以不防止任何攻击或者防止第一次类型 $2$ 的攻击获得 $953888980\times 3+904140652=3765807592$ 的经验值。

可以证明，不存在获得经验值更多的方案。

### 数据范围
**本题使用 subtask 进行捆绑测试**，每个 subtask 的具体分值如下：
| 子任务 | $n$ | $k$  | 分值 |
| :----------: | :----------: | :----------: | :----------: |
| $0$ | $\le 10$ | $\le 10^3$ | $20$ |
| $1$ | $\le 20$ | $\le 10^7$ |$30$ |
| $2$ | $\le 24$ | $\le 2\times 10^7$ |$50$ |

对于所有数据，满足 $1\le n \le 24$，$1 \le k \le 2\times 10^7$，$1\le s,m\le 10^9$。


---

---
title: "「Diligent-OI R1 D」DlgtTemplate"
layout: "post"
diff: 普及+/提高
pid: P11274
tag: ['动态规划 DP', '洛谷原创', 'Special Judge', '背包 DP', '洛谷月赛']
---
# 「Diligent-OI R1 D」DlgtTemplate
## 题目背景

棋盘是用板子做成的。这题是棋盘的题，所以……
## 题目描述

有一个 $1$ 行 $n$ 个格子的棋盘编号 $1\sim n$，上面每个格子写着一个得分 $a_i$。

现在你需要**从左到右**依次地选择一些格子，可以不选。有些格子选了之后，会将当前选的最靠前的 $b_i$ 个格子清除为未选格子，但你**不能**回去把这些格子重新选上。特殊地，如果该格子之前的已选格子不到 $b_i$ 个，那么该格子以及该格子以后的格子**不会**被清除为未选格子。

请你找出一种从左到右选择的方案，使得已选格子的得分之和最大。
## 输入格式

第一行输入 $n$，表示棋盘有 $n$ 个格子。

接下来一行 $n$ 个整数，依次表示第 $1\sim n$ 个格子的得分 $a_1\sim a_n$。

接下来一行 $n$ 个非负整数，依次表示第 $1\sim n$ 个格子的清除个数 $b_1\sim b_n$。
## 输出格式

你需要给出具体方案。

第一行输出非负整数 $k$，表示你选了 $k$ 个格子。

第二行 $k$ 个从小到大排列的正整数，表示你从左到右依次选择的格子编号。如果不选格子输出一个空行。

第三行输出 $ans$，表示你的最终答案。

Ns6 是很善良的。如果你不会求方案但答案正确，你也能得到测试点 $40\%$ 的分数。但这种情况下你也需要输出 $k$ 和 $k$ 个从小到大排列的正整数。
## 样例

### 样例输入 #1
```
6
1 1 4 5 1 4
1 0 0 2 1 1
```
### 样例输出 #1
```
4
1 2 3 4
9
```
### 样例输入 #2
```
13
-1 1 4 -5 -1 -4 1 9 -1 9 -8 -1 0
1 0 2 1 3 0 0 2 0 0 2 0 1
```
### 样例输出 #2
```
5
1 2 7 8 10 
19
```
### 样例输入 #3
```
3
-1 -1 0
0 1 2
```
### 样例输出 #3
```
0

0
```
### 样例输入 #4
```
6
1 1 4 5 1 4
1 1 1 3 0 1
```
### 样例输出 #4
```
2
4 5
6
```
## 提示

#### 【样例 #1 解释】

先选择第一个数 $1$，这时虽然 $b_1=1$，但是因为前面没有数，所以不会清除。

再选择第二个数 $1$，这时因为 $b_2=0$，所以不会清除。

再选择第三个数 $4$，这时因为 $b_3=0$，所以不会清除。

再选择第四个数 $5$，这时因为 $b_4=2$，所以选择的第一个数和第二个数会被清除为未选的数。

此时答案 $4+5=9$。方法不唯一。

#### 【数据范围与约定】

对于 $100\%$ 的数据，满足 $1\le n\le3000$，$|a_i|\le10^8$，$0\le b_i\le n$。

| Subtask 编号 | $n\le$ | 特殊性质 | 分值 |
| :----------: | :----------: | :----------: | :----------: |
| $0$ | $20$ | 无 | $25$ |
| $1$ | $500$ | 无 | $20$ |
| $2$ | $3000$ | $b_i>0$ | $5$ |
| $3$ | $3000$ | $b_i=0$ | $5$ |
| $4$ | $3000$ | $a_i=1$ | $15$ |
| $5$ | $3000$ | 无 | $30$ |


---

---
title: "垃圾陷阱"
layout: "post"
diff: 普及+/提高
pid: P1156
tag: ['动态规划 DP', '排序', '背包 DP']
---
# 垃圾陷阱
## 题目描述

卡门――农夫约翰极其珍视的一条 `Holsteins` 奶牛――已经落了到 “垃圾井” 中。“垃圾井” 是农夫们扔垃圾的地方，它的深度为 $D$（$2 \le D \le 100$）英尺。

卡门想把垃圾堆起来，等到堆得与井深同样高或比井深更高（即，垃圾高度总和 $\geq D$）时，她就能逃出井外了。另外，卡门可以通过吃一些垃圾来维持自己的生命。

每个垃圾都可以用来吃或堆放，并且堆放垃圾不用花费卡门的时间。

假设卡门预先知道了每个垃圾扔下的时间 $t$（$1 \le t \le 1000$），以及每个垃圾堆放的高度 $h$（$1 \le h \le 25$）和吃进该垃圾能增加维持生命的时间 $f$（$1 \le f \le 30$），要求出卡门最早能逃出井外的时间，假设卡门当前体内有足够持续 $10$ 小时的能量，如果卡门 $10$ 小时内（不含 $10$ 小时，维持生命的时间同）没有进食，卡门就将饿死。特别地，若体力值为 $0$ 时吃下垃圾或逃出井外也不会饿死。
## 输入格式

第一行为两个整数，$D$ 和 $G$（$1 \le G \le 100$），$G$ 为被投入井的垃圾的数量。

第二到第 $G+1$ 行每行包括三个整数：$T$（$1 \le T \le 1000$），表示垃圾被投进井中的时间；$F$（$1 \le F \le 30$），表示该垃圾能维持卡门生命的时间；和 $H$（$1 \le H \le 25$），该垃圾能垫高的高度。

## 输出格式

如果卡门可以爬出陷阱，输出一个整数，表示最早什么时候可以爬出；否则输出卡门最长可以存活多长时间。

## 样例

### 样例输入 #1
```
20 4
5 4 9
9 3 2
12 6 10
13 1 1
```
### 样例输出 #1
```
13
```
## 提示

**【样例说明】**

卡门堆放她收到的第一个垃圾：$\mathrm{height}=9$；

卡门吃掉她收到的第 $2$ 个垃圾，使她的生命从 $10$ 小时延伸到 $13$ 小时；

卡门堆放第 $3$ 个垃圾，$\mathrm{height}=19$；

卡门堆放第 $4$ 个垃圾，$\mathrm{height}=20$。



---

---
title: "[蓝桥杯 2025 省 B] 生产车间"
layout: "post"
diff: 普及+/提高
pid: P12136
tag: ['2025', '背包 DP', '树形 DP', '蓝桥杯省赛', 'bitset']
---
# [蓝桥杯 2025 省 B] 生产车间
## 题目背景

本题测试数据偏水
## 题目描述

小明正在改造一个生产车间的生产流水线。这个车间共有 $n$ 台设备，构成以 $1$ 为根结点的一棵树，结点 $i$ 有权值 $w_i$。其中叶节点的权值 $w_i$ 表示每单位时间将产出 $w_i$ 单位的材料并送往父结点，根结点的权值 $w_i$ 表示每单位时间内能打包多少单位成品，其他结点的权值 $w_i$ 表示每单位时间最多能加工 $w_i$ 单位的材料并送往父结点。

由于当前生产线中某些结点存在产能不够的问题导致生产线无法正常运行，即存在某些结点每单位时间收到的材料超过了当前结点的加工能力上限。小明计划删除一些结点使得所有结点都能正常运行。他想知道删除一些结点后根结点每单位时间内最多能打包多少单位的成品？
## 输入格式

输入共 $n + 1$ 行。

第一行为一个正整数 $n$。

第二行为 $n$ 个由空格分开的正整数 $w_1,w_2, \dots,w_n$。

后面 $n - 1$ 行，每行两个整数表示树上的一条边连接的两个结点。
## 输出格式

输出共一行，一个整数代表答案。
## 样例

### 样例输入 #1
```
9
9 7 3 7 1 6 2 2 7
1 2
1 3
2 4
2 5
2 6
6 7
6 8
6 9
```
### 样例输出 #1
```
8
```
## 提示

### 样例说明

删掉结点 $4$、$9$ 后生产线满足条件，根结点 $1$ 每单位时间将打包出 $8$ 单位的成品。

### 评测用例规模与约定

- 对于 $20\%$ 的评测用例，$2 \leq n \leq 100$。
- 对于 $100\%$ 的评测用例，$2 \leq n \leq 1000$，$1\leq w_i \leq 1000$。


---

---
title: "[蓝桥杯 2025 省 Java B] 2 的幂"
layout: "post"
diff: 普及+/提高
pid: P12160
tag: ['动态规划 DP', '2025', '数论', '背包 DP', '蓝桥杯省赛']
---
# [蓝桥杯 2025 省 Java B] 2 的幂
## 题目描述

小明很喜欢 $2$ 的幂，所以他想对一个长度为 $n$ 的正整数数组 $\{a_1, a_2, \dots, a_n\}$ 进行改造。他可以进行如下操作任意多次（可以是 $0$ 次）：任选一个数 $a_i$ 加上任意正整数，但不能使得加完之后的结果超过 $10^5$。

在操作任意次后，小明希望所有数的乘积是 $2^k$ 的倍数。他想知道总共需要加的数的总和至少是多少？
## 输入格式

输入共两行。
- 第一行为两个正整数 $n, k$。
- 第二行为 $n$ 个由空格分开的正整数 $a_1, a_2, \dots, a_n$。
## 输出格式

输出共 $1$ 行，一个整数表示答案。如果不能满足条件，输出 $-1$。
## 样例

### 样例输入 #1
```
3 9
19 10 3
```
### 样例输出 #1
```
12
```
## 提示

### 样例说明

将三个数分别加到 $24, 16, 4$，它们的乘积为 $1536 = 2^9 \times 3$，加的数的总和为 $5 + 6 + 1 = 12$。

### 评测用例规模与约定

- 对于 $20\%$ 的评测用例，$n, k \leq 10$。
- 对于 $100\%$ 的评测用例，$1\leq n \leq 500$，$1\leq k \leq 5000$，$1\leq a_i \leq 100000$。


---

---
title: "[蓝桥杯 2024 国 C] 循环位运算"
layout: "post"
diff: 普及+/提高
pid: P12316
tag: ['动态规划 DP', '2024', '背包 DP', '蓝桥杯国赛']
---
# [蓝桥杯 2024 国 C] 循环位运算
## 题目背景

蓝桥杯原题为 **做完 $m$ 次操作**，根据下载得到的测试数据分析应当为 **做了不超过 $m$ 次操作**。洛谷的题面根据实际测试数据进行编写。
## 题目描述

给定 $n$ 个数 $A_i$，每个数我们都将其视为一个 $32$ 位的二进制数。你可以进行 $m$ 次操作，每次选择任意一个数将其循环左移一次。

循环左移表示将某个数的二进制位均左移一位，同时最高位移动到最低位。例如对于一个 $8$ 位二进制数 $10010010$，循环左移一次后为 $00100101$，两次后为 $01001010$。

问做了**不超过** $m$ 次操作后，$n$ 个数的和最大是多少。
## 输入格式

输入的第一行包含两个整数 $n, m$，用一个空格分隔。

接下来 $n$ 行，每行包含一个整数 $A_i$。
## 输出格式

输出一行包含一个整数表示答案。
## 样例

### 样例输入 #1
```
3 9
2365587456
2399141888
9437184
```
### 样例输出 #1
```
7535067152
```
## 提示

### 评测用例规模与约定

- 对于 $30\%$ 的评测用例，$n, m \leq 12$；
- 对于 $60\%$ 的评测用例，$n, m \leq 100$；
- 对于所有评测用例，$1 \leq n, m \leq 1000$，$0 \leq A_i < 2^{32}$。


---

---
title: "有线电视网"
layout: "post"
diff: 普及+/提高
pid: P1273
tag: ['动态规划 DP', '树形数据结构', '递归', '背包 DP']
---
# 有线电视网
## 题目描述

某收费有线电视网计划转播一场重要的足球比赛。他们的转播网和用户终端构成一棵树状结构，这棵树的根结点位于足球比赛的现场，树叶为各个用户终端，其他中转站为该树的内部节点。

从转播站到转播站以及从转播站到所有用户终端的信号传输费用都是已知的，一场转播的总费用等于传输信号的费用总和。

现在每个用户都准备了一笔费用想观看这场精彩的足球比赛，有线电视网有权决定给哪些用户提供信号而不给哪些用户提供信号。

写一个程序找出一个方案使得有线电视网在不亏本的情况下使观看转播的用户尽可能多。

## 输入格式

输入文件的第一行包含两个用空格隔开的整数 $N$ 和 $M$，其中 $2 \le N \le 3000$，$1 \le M \le N-1$，$N$ 为整个有线电视网的结点总数，$M$ 为用户终端的数量。

第一个转播站即树的根结点编号为 $1$，其他的转播站编号为 $2$ 到 $N-M$，用户终端编号为 $N-M+1$ 到 $N$。

接下来的 $N-M$ 行每行表示—个转播站的数据，第 $i+1$ 行表示第 $i$ 个转播站的数据，其格式如下：

$K \ \ A_1 \ \ C_1 \ \ A_2 \ \ C_2 \ \ \ldots \ \ A_k \ \ C_k$

$K$ 表示该转播站下接 $K$ 个结点（转播站或用户），每个结点对应一对整数 $A$ 与 $C$ ，$A$ 表示结点编号，$C$ 表示从当前转播站传输信号到结点 $A$ 的费用。最后一行依次表示所有用户为观看比赛而准备支付的钱数。单次传输成本和用户愿意交的费用均不超过 10。

[](https://paste.ubuntu.com/p/xN9NRmYvpY/)
## 输出格式

输出文件仅一行，包含一个整数，表示上述问题所要求的最大用户数。

## 样例

### 样例输入 #1
```
5 3

2 2 2 5 3

2 3 2 4 3

3 4 2
```
### 样例输出 #1
```
2


```
## 提示

**样例解释**

![](https://cdn.luogu.com.cn/upload/image_hosting/7yj4u55m.png)

如图所示，共有五个结点。结点 ① 为根结点，即现场直播站，② 为一个中转站，③④⑤ 为用户端，共 $M$ 个，编号从 $N-M+1$ 到 $N$，他们为观看比赛分别准备的钱数为 $3$、$4$、$2$。

从结点 ① 可以传送信号到结点 ②，费用为 $2$；

也可以传送信号到结点 ⑤，费用为 $3$（第二行数据所示）；

从结点 ② 可以传输信号到结点 ③，费用为$2$；

也可传输信号到结点 ④，费用为 $3$（第三行数据所示）。

如果要让所有用户（③④⑤）都能看上比赛，则信号传输的总费用为：$2+3+2+3=10$，大于用户愿意支付的总费用 $3+4+2=9$，有线电视网就亏本了，而只让 ③④ 两个用户看比赛就不亏本了。

[](https://paste.ubuntu.com/p/H9BMGJvFHH/)


---

---
title: "多米诺骨牌"
layout: "post"
diff: 普及+/提高
pid: P1282
tag: ['动态规划 DP', '枚举', '背包 DP']
---
# 多米诺骨牌
## 题目描述

多米诺骨牌由上下 $2$ 个方块组成，每个方块中有 $1\sim6$ 个点。现有排成行的上方块中点数之和记为 $S_1$，下方块中点数之和记为 $S_2$，它们的差为 $\left|S_1-S_2\right|$。如图，$S1=6+1+1+1=9$，$S2=1+5+3+2=11$，$\left|S_1-S_2\right|=2$。每个多米诺骨牌可以旋转 $180°$，使得上下两个方块互换位置。请你计算最少旋转多少次才能使多米诺骨牌上下 $2$ 行点数之差达到最小。

![](https://cdn.luogu.com.cn/upload/pic/91.png)

对于图中的例子，只要将最后一个多米诺骨牌旋转 $180°$，即可使上下 $2$ 行点数之差为 $0$。
## 输入格式

输入文件的第一行是一个正整数 $n(1\leq n\leq 1000)$，表示多米诺骨牌数。接下来的 $n$ 行表示 $n$ 个多米诺骨牌的点数。每行有两个用空格隔开的正整数，表示多米诺骨牌上下方块中的点数 $a$ 和 $b$，且 $1\leq a,b\leq 6$。

## 输出格式

输出文件仅一行，包含一个整数。表示求得的最小旋转次数。

## 样例

### 样例输入 #1
```
4
6 1
1 5
1 3
1 2

```
### 样例输出 #1
```
1

```


---

---
title: "三角形牧场"
layout: "post"
diff: 普及+/提高
pid: P1284
tag: ['动态规划 DP', '贪心', '背包 DP']
---
# 三角形牧场
## 题目描述

和所有人一样，奶牛喜欢变化。它们正在设想新造型的牧场。奶牛建筑师 Hei 想建造围有漂亮白色栅栏的三角形牧场。她拥有 $n$ 块木板，每块的长度 $l_i$ 都是整数，她想用所有的木板围成一个三角形使得牧场面积最大。

请帮助 Hei 小姐构造这样的牧场，并计算出这个最大牧场的面积。
## 输入格式

第 $1$ 行：一个整数 $n$；

第 $2$ 到第 $(n + 1)$ 行，每行一个整数，第 $(i + 1)$ 行的整数 $l_i$ 表示第 $i$ 块木板的长度。
## 输出格式

仅一个整数：最大牧场面积乘以 $100$ 然后舍尾的结果。如果无法构建，输出 $-1$。
## 样例

### 样例输入 #1
```
5
1
1
3
3
4

```
### 样例输出 #1
```
692

```
## 提示

#### 样例输入输出 1 解释

$692=\text{舍尾后的}(100\times\text{三角形面积})$，此三角形为等边三角形，边长为 $4$。

#### 数据规模与约定

对于 $100\%$ 的数据，保证 $3\le n\le40$，$1\le l_i\le40$。


---

---
title: "烹调方案"
layout: "post"
diff: 普及+/提高
pid: P1417
tag: ['动态规划 DP', '排序', '背包 DP']
---
# 烹调方案
## 题目背景

由于你的帮助，火星只遭受了最小的损失。但 gw 懒得重建家园了，就造了一艘飞船飞向遥远的 earth 星。不过飞船飞到一半，gw 发现了一个很严重的问题：肚子饿了 ~。

gw 还是会做饭的，于是拿出了储藏的食物准备填饱肚子。gw 希望能在 $T$ 时间内做出最美味的食物，但是这些食物美味程度的计算方式比较奇葩，于是绝望的 gw 只好求助于你了。
## 题目描述

一共有 $n$ 件食材，每件食材有三个属性，$a_i$，$b_i$ 和 $c_i$，如果在 $t$ 时刻完成第 $i$ 样食材则得到 $a_i-t\times b_i$ 的美味指数，用第 $i$ 件食材做饭要花去 $c_i$ 的时间。

众所周知，gw 的厨艺不怎么样，所以他需要你设计烹调方案使得美味指数最大。
## 输入格式

第一行是两个正整数 $T$ 和 $n$，表示到达地球所需时间和食材个数。

- 下面一行 $n$ 个整数，$a_i$；
- 下面一行 $n$ 个整数，$b_i$；
- 下面一行 $n$ 个整数，$c_i$。
## 输出格式

输出最大美味指数。

## 样例

### 样例输入 #1
```
74 1
502
2
47

```
### 样例输出 #1
```
408
```
## 提示

### 数据范围及约定

- 对于 $40\%$ 的数据 $1 \le n \le 10$；
- 对于 $100\%$ 的数据 $1 \le n \le 50$。

所有数字均小于 $10^5$。

### 题目来源

tinylic 改编



---

---
title: "宝物筛选"
layout: "post"
diff: 普及+/提高
pid: P1776
tag: ['动态规划 DP', '单调队列', 'NOI 导刊', '背包 DP', '进制']
---
# 宝物筛选
## 题目描述

终于，破解了千年的难题。小 FF 找到了王室的宝物室，里面堆满了无数价值连城的宝物。

这下小 FF 可发财了，嘎嘎。但是这里的宝物实在是太多了，小 FF 的采集车似乎装不下那么多宝物。看来小 FF 只能含泪舍弃其中的一部分宝物了。

小 FF 对洞穴里的宝物进行了整理，他发现每样宝物都有一件或者多件。他粗略估算了下每样宝物的价值，之后开始了宝物筛选工作：小 FF 有一个最大载重为 $W$ 的采集车，洞穴里总共有 $n$ 种宝物，每种宝物的价值为 $v_i$，重量为 $w_i$，每种宝物有 $m_i$ 件。小 FF 希望在采集车不超载的前提下，选择一些宝物装进采集车，使得它们的价值和最大。
## 输入格式

第一行为一个整数 $n$ 和 $W$，分别表示宝物种数和采集车的最大载重。

接下来 $n$ 行每行三个整数 $v_i,w_i,m_i$。
## 输出格式

输出仅一个整数，表示在采集车不超载的情况下收集的宝物的最大价值。
## 样例

### 样例输入 #1
```
4 20
3 9 3
5 9 1
9 4 2
8 1 3
```
### 样例输出 #1
```
47
```
## 提示

对于 $30\%$ 的数据，$n\leq \sum m_i\leq 10^4$，$0\le W\leq 10^3$。

对于 $100\%$ 的数据，$n\leq \sum m_i \leq 10^5$，$0\le W\leq 4\times 10^4$，$1\leq n\le 100$。


---

---
title: "[NOIP 2014 提高组] 飞扬的小鸟"
layout: "post"
diff: 普及+/提高
pid: P1941
tag: ['动态规划 DP', '2014', 'NOIP 提高组', '枚举', '背包 DP']
---
# [NOIP 2014 提高组] 飞扬的小鸟
## 题目背景

NOIP2014 提高组 D1T3
## 题目描述

Flappy Bird 是一款风靡一时的休闲手机游戏。玩家需要不断控制点击手机屏幕的频率来调节小鸟的飞行高度，让小鸟顺利通过画面右方的管道缝隙。如果小鸟一不小心撞到了水管或者掉在地上的话，便宣告失败。

为了简化问题，我们对游戏规则进行了简化和改编:

游戏界面是一个长为 $n$，高为 $m$ 的二维平面，其中有 $k$ 个管道（忽略管道的宽度）。 

小鸟始终在游戏界面内移动。小鸟从游戏界面最左边任意整数高度位置出发，到达游戏界面最右边时，游戏完成。

小鸟每个单位时间沿横坐标方向右移的距离为 $1$，竖直移动的距离由玩家控制。如果点击屏幕，小鸟就会上升一定高度 $x$，每个单位时间可以点击多次，效果叠加；如果不点击屏幕，小鸟就会下降一定高度 $y$。小鸟位于横坐标方向不同位置时，上升的高度 $x$ 和下降的高度 $y$ 可能互不相同。

小鸟高度等于 $0$ 或者小鸟碰到管道时，游戏失败。小鸟高度为 $m$ 时，无法再上升。

现在,请你判断是否可以完成游戏。如果可以，输出最少点击屏幕数；否则，输出小鸟最多可以通过多少个管道缝隙。
## 输入格式

第 $1$ 行有 $3$ 个整数 $n, m, k$，分别表示游戏界面的长度，高度和水管的数量，每两个整数之间用一个空格隔开；

接下来的 $n$ 行，每行 $2$ 个用一个空格隔开的整数 $x$ 和 $y$，依次表示在横坐标位置 $0 \sim n-1$ 上玩家点击屏幕后，小鸟在下一位置上升的高度 $x$，以及在这个位置上玩家不点击屏幕时，小鸟在下一位置下降的高度 $y$。

接下来 $k$ 行，每行 $3$ 个整数 $p,l,h$，每两个整数之间用一个空格隔开。每行表示一个管道，其中 $p$ 表示管道的横坐标，$l$ 表示此管道缝隙的下边沿高度，$h$ 表示管道缝隙上边沿的高度（输入数据保证 $p$ 各不相同，但不保证按照大小顺序给出）。
## 输出格式

共两行。

第一行，包含一个整数，如果可以成功完成游戏，则输出 $1$，否则输出 $0$。

第二行，包含一个整数，如果第一行为 $1$，则输出成功完成游戏需要最少点击屏幕数，否则，输出小鸟最多可以通过多少个管道缝隙。
## 样例

### 样例输入 #1
```
10 10 6 
3 9  
9 9  
1 2  
1 3  
1 2  
1 1  
2 1  
2 1  
1 6  
2 2  
1 2 7 
5 1 5 
6 3 5 
7 5 8 
8 7 9 
9 1 3 

```
### 样例输出 #1
```
1
6


```
### 样例输入 #2
```
10 10 4 
1 2  
3 1  
2 2  
1 8  
1 8  
3 2  
2 1  
2 1  
2 2  
1 2  
1 0 2 
6 7 9 
9 1 4 
3 8 10  
```
### 样例输出 #2
```
0
3
```
## 提示

 
【输入输出样例说明】

如下图所示，蓝色直线表示小鸟的飞行轨迹，红色直线表示管道。

![](https://cdn.luogu.com.cn/upload/image_hosting/59alxbqi.png)

【数据范围】

对于 $30\%$ 的数据：$5 \leq n \leq 10, 5 \leq m \leq 10, k=0$，保证存在一组最优解使得同一单位时间最多点击屏幕 $3$ 次；

对于 $50\%$ 的数据：$5 \leq n \leq 20, 5 \leq m \leq 10$，保证存在一组最优解使得同一单位时间最多点击屏幕 $3$ 次；

对于 $70\%$ 的数据：$5 \leq n \leq 1000, 5 \leq m \leq 100$；

对于 $100\%$ 的数据：$5 \leq n \leq 10000$，$5 \leq m \leq 1000$，$0 \leq k < n$，$0 < x,y < m$，$0 < p < n$，$0 \leq l < h \leq m$， $l + 1 < h$。


---

---
title: "选学霸"
layout: "post"
diff: 普及+/提高
pid: P2170
tag: ['动态规划 DP', '并查集', '洛谷原创', '背包 DP']
---
# 选学霸
## 题目描述

老师想从 $n$ 名学生中选 $m$ 人当学霸，但有 $k$ 对人实力相当，如果实力相当的人中，一部分被选上，另一部分没有，同学们就会抗议。所以老师想请你帮他求出他该选多少学霸，才能既不让同学们抗议，又与原来的 $m$ 尽可能接近。
## 输入格式

第一行，三个正整数 $n,m,k$。

接下来 $k$ 行，每行 $2$ 个数，表示一对实力相当的人的编号（编号为 $1,2,\cdots n$）。
## 输出格式

共一行，表示既不让同学们抗议，又与原来的 $m$ 尽可能接近的选出学霸的数目。

如果有两种方案与 $m$ 的差的绝对值相等，选较小的一种。
## 样例

### 样例输入 #1
```
4 3 2
1 2
3 4
```
### 样例输出 #1
```
2
```
## 提示

对于 $100\%$ 的数据，满足 $1 \le n,m \le 2 \times 10^4$。


---

---
title: "[USACO14MAR] Mooo Moo S"
layout: "post"
diff: 普及+/提高
pid: P2214
tag: ['2014', 'USACO', '背包 DP', '栈']
---
# [USACO14MAR] Mooo Moo S
## 题目描述

Farmer John has completely forgotten how many cows he owns!  He is too embarrassed to go to his fields to count the cows, since he doesn't want the cows to realize his mental lapse.  Instead, he decides to count his cows secretly by planting microphones in the fields in which his cows tend to gather, figuring that he can determine the number of cows from the total volume of all the mooing he hears.

FJ's N fields (1 <= N <= 100) are all arranged in a line along a long straight road.  Each field might contain several types of cows; FJ owns cows that come from B different breeds (1 <= B <= 20), and a cow of breed i moos at a volume of V(i) (1 <= V(i) <= 100).  Moreover, there is a strong wind blowing down the road, which carries the sound of mooing in one direction from left to right: if the volume of mooing in some field is X, then in the next field this will contribute X-1 to the total mooing volume (and X-2 in the field after that, etc.). Otherwise stated, the mooing volume in a field is the sum of the contribution due to cows in that field, plus X-1, where X is the total mooing volume in the preceding field.

Given the volume of mooing that FJ records in each field, please compute the minimum possible number of cows FJ might own.

The volume FJ records in any field is at most 100,000.

### 题目背景
农夫约翰完全忘了他有多少头牛了！他不好意思到牧场里去数牛，因为他不想让牛意识到他的健忘。取而代之的是，他决定在奶牛聚集的牧场里安装麦克风，秘密计算出他能从中听到的所有牛叫声的总音量，以便以此确定奶牛的数量。
### 题目描述
$FJ$ 的 $N(1\le N\le 100)$ 个牧场都是沿着一条笔直的道路分布的。每一个牧场可能有许多种品种的奶牛； $FJ$ 拥有 $B(1\le B\le 20)$ 个不同品种的奶牛，而第 $i$ 种奶牛的叫声音量为 $V_i(1\le V_i \le 100)$ 。此外，有一股强风沿着道路吹来，将牛的叫声从左往右传递，如果某个牧场的总音量是 $x$ ，那么它将传递 $x-1$ 的音量到右边的下一个牧场。这就意味着，一个牧场里的总音量是处在该牧场的奶牛所发出的音量加上左边前一个牧场的总音量 $-1$ 。数据保证，每一个牧场内由该牧场所有奶牛所发出的总音量最多为$10^5$。
### 输入格式
第 $1$ 行：两个用空格分隔的整数 $N$ 和 $B$。      
第 $2...B+1$ 行：第 $i+1$ 行包含整数 $V_i$ 。        
第 $B+2...B+N+1$ 行：第 $B+i+1$ 行表示在第 $i$ 个牧场内所能监听到的总音量。
### 输出格式
共一行，即 $FJ$ 拥有的最小奶牛数量。

如果 FJ 不可能拥有一种牧场配置满足给出的条件，输出 `-1`。
### 说明/提示
#### 输入说明：
$FJ$ 拥有 $5$ 个牧场，每个牧场总音量从左到右分别为为$0、17、16、20、19$。 $FJ$ 有两种不同品种的奶牛；第一种奶牛的叫声音量是 $5$，第二种奶牛的叫声音量是 $7$ 。
#### 输出说明：
$2$ 号牧场场有  $2$ 头 $1$ 号品种的奶牛， $1$ 头 $2$ 号品种奶牛；还有一头牛在 $4$ 号牧场，共 $4$ 头奶牛。
## 输入格式

\* Line 1: The integers N and B.



\* Lines 2..1+B: Line i+1 contains the integer V(i).

\* Lines 2+B..1+B+N: Line 1+B+i contains the total volume of all mooing

in field i.

## 输出格式

\* Line 1: The minimum number of cows owned by FJ, or -1 if there is no

configuration of cows consistent with the input.

## 样例

### 样例输入 #1
```
5 2
5
7
0
17
16
20
19
```
### 样例输出 #1
```
4

```
## 提示

INPUT DETAILS:


FJ owns 5 fields, with mooing volumes 0,17,16,20,19.  There are two breeds

of cows; the first moos at a volume of 5, and the other at a volume of 7.

OUTPUT DETAILS:


There are 2 cows of breed #1 and 1 cow of breed #2 in field 2, and there is

another cow of breed #1 in field 4.


Source: USACO 2014 March Contest, Silver



---

---
title: "[USACO06DEC] Cow Roller Coaster S"
layout: "post"
diff: 普及+/提高
pid: P2854
tag: ['动态规划 DP', '2006', 'USACO', '背包 DP']
---
# [USACO06DEC] Cow Roller Coaster S
## 题目描述

The cows are building a roller coaster! They want your help to design as fun a roller coaster as possible, while keeping to the budget.

The roller coaster will be built on a long linear stretch of land of length L (1 ≤ L ≤ 1,000). The roller coaster comprises a collection of some of the N (1 ≤ N ≤ 10,000) different interchangable components. Each component i has a fixed length Wi (1 ≤ Wi ≤ L). Due to varying terrain, each component i can be only built starting at location Xi (0 ≤ Xi ≤ L - Wi). The cows want to string together various roller coaster components starting at 0 and ending at L so that the end of each component (except the last) is the start of the next component.

Each component i has a "fun rating" Fi (1 ≤ Fi ≤ 1,000,000) and a cost Ci (1 ≤ Ci ≤ 1000). The total fun of the roller coster is the sum of the fun from each component used; the total cost is likewise the sum of the costs of each component used. The cows' total budget is B (1 ≤ B ≤ 1000). Help the cows determine the most fun roller coaster that they can build with their budget.
## 输入格式

Line 1: Three space-separated integers: L, N and B.


Lines 2..N+1: Line i+1 contains four space-separated integers, respectively: Xi, Wi, Fi, and Ci.

## 输出格式

Line 1: A single integer that is the maximum fun value that a roller-coaster can have while staying within the budget and meeting all the other constraints. If it is not possible to build a roller-coaster within budget, output -1.

## 样例

### 样例输入 #1
```
5 6 10
0 2 20 6
2 3 5 6
0 1 2 1
1 1 1 3
1 2 5 4
3 2 10 2
```
### 样例输出 #1
```
17
```
## 提示

Taking the 3rd, 5th and 6th components gives a connected roller-coaster with fun value 17 and cost 7. Taking the first two components would give a more fun roller-coaster (25) but would be over budget.

## 题目翻译

**【题目描述】**

有 $n$ 条线段，每条线段只能放在数轴上的一个特定位置，并且第 $i$ 根线段有如下几个属性：$X_i$（该线段放在数轴上的起点），$W_i$（该线段长度），$F_i$（你若使用该线段你能获得的价值），$C_i$（你若使用该线段你所需要的费用）。现在让你从中选出一些线段，使得这些线段能够铺满数轴上的区间 $[0,L]$ 且线段必须首尾相接（也就是不能重叠，也不能空缺），并且所花费用和不超过 $B$，同时要使你收获的价值尽量大，请你找到这个方案。

**【输入格式】**

第一行三个整数 $L, n, B$。

接下来 $n$ 行，每行四个整数 $X_i, W_i, F_i, C_i$ 表示第 $i$ 根线段的四个属性。

**【输出格式】**

一个整数，表示你能获得的最大价值和。若无法满足上述要求，则输出 $-1$。


---

---
title: "[USACO09FEB] Stock Market G"
layout: "post"
diff: 普及+/提高
pid: P2938
tag: ['2009', 'USACO', '背包 DP', '最短路', '排列组合']
---
# [USACO09FEB] Stock Market G
## 题目描述

Despite their innate prudence, the cows took a beating in the home mortgage market and now are trying their hand at stocks. Happily, Bessie is prescient and knows not only today's S (2 <= S <= 50) stock prices but also the future stock prices for a total of D days (2 <= D <= 10).

Given the matrix of current and future stock prices on various days (1 <= PR\_sd <= 1,000) and an initial M (1 <= M <= 200,000) units of money, determine an optimal buying and selling strategy in order to maximize the gain realized by selling stock on the final day. Shares must be purchased in integer multiples, and you need not spend all the money (or any money). It is guaranteed that you will not be able to earn a profit of more than 500,000 units of money.

Consider the example below of a bull (i.e., improving) market, the kind Bessie likes most. In this case, S=2 stocks and D=3 days. The cows have 10 units of money to invest.

| Stock | Today's price | Tomorrow's price |    Two days hence Stock   |
| :---: | :-----------: | :--------------: | :--: |
|  $A$  |      10       |        15        |  15  |
|  $B$  |      13       |        11        |  20  |

If money is to be made, the cows must purchase stock 1 on day 1. Selling stock 1 on day 2 and quickly buying stock 2 yields 4 money in the bank and one share of 2. Selling stock 2 on the final day brings in 20 money for a total of 24 money when the 20 is added to the bank.

## 输入格式

\* Line 1: Three space-separated integers: S, D, and M

\* Lines 2..S+1: Line s+1 contains the D prices for stock s on days 1..D: PR\_sd

## 输出格式

\* Line 1: The maximum amount of money possible to have after selling on day D.

## 样例

### 样例输入 #1
```
2 3 10 
10 15 15 
13 11 20 

```
### 样例输出 #1
```
24 

```
## 题目翻译

# 题目描述

尽管奶牛天生谨慎，它们仍然在住房抵押信贷市场中大受打击，现在它们准备在股市上碰碰运气。贝西有内部消息，她知道 $S$ 只股票在今后 $D$ 天内的价格。

假设在一开始，她筹集了 $M$ 元钱，那么她该怎样操作才能赚到最多的钱呢？贝西在每天可以买卖多只股票，也可以多次买卖同一只股票，交易单位必须是整数，数量不限。举一个牛市的例子：

假设贝西有 $10$ 元本金，股票价格如下：

|  股票 | 今天的价格 | 明天的价格 | 后天的价格 |
| :-: | :---: | :---: | :---: |
| $A$ |   $10$  |   $15$  |   $15$  |
| $B$ |   $13$  |   $11$  |   $20$  |

最赚钱的做法是：今天买入 $A$ 股 $1$ 张，到明天把它卖掉并且买入 $B$ 股 $1$ 张，在后天卖掉 $B$ 股，这样贝西就有 $24$ 元了。

# 输入格式

第一行：三个整数 $S,D$ 和 $M$，$2\le S\le 50,2\le D\le 10,1\le M\le 200000$。

第二行到第 $S + 1$ 行：第 $i + 1$ 行有 $D$ 个整数：$P_{i,1}$ 到 $P_{i,D}$，表示第 $i$ 种股票在第一天到最后一天的售价，对所有 $1\le j\le D$，$1\le P_{i,j}\le 1000$。

# 输出格式

单个整数：表示奶牛可以获得的最大钱数，保证这个数不会超过 $500000$。


---

---
title: "[USACO10JAN] Cheese Towers S"
layout: "post"
diff: 普及+/提高
pid: P2979
tag: ['动态规划 DP', '2010', 'USACO', '枚举', '背包 DP']
---
# [USACO10JAN] Cheese Towers S
## 题目描述

Farmer John wants to save some blocks of his cows' delicious Wisconsin cheese varieties in his cellar for the coming winter. He has room for one tower of cheese in his cellar, and that tower's height can be at most T (1 <= T <= 1,000). The cows have provided him with a virtually unlimited number of blocks of each kind of N (1 <= N <= 100) different types of cheese (conveniently numbered 1..N). He'd like to store (subject to the constraints of height) the most

valuable set of blocks he possibly can. The cows will sell the rest to support the orphan calves association.

Each block of the i-th type of cheese has some value V\_i (1 <= V\_i <= 1,000,000) and some height H\_i (5 <= H\_i <= T), which is always a multiple of 5.

Cheese compresses. A block of cheese that has height greater than or equal to K (1 <= K <= T) is considered 'large' and will crush any and all of the cheese blocks (even other large ones) located below it in the tower. A crushed block of cheese doesn't lose any value, but its height reduces to just 4/5 of its old height. Because the height of a block of cheese is always a multiple of 5, the height of a crushed block of cheese will always be an integer. A block of cheese is either crushed or not crushed; having multiple large blocks above it does not crush it more. Only tall blocks of cheese crush other blocks; aggregate height of a tower does not affect whether a block is crushed or not.

What is the total value of the best cheese tower FJ can construct?

Consider, for example, a cheese tower whose maximum height can be 53 to be build from three types of cheese blocks. Large blocks are those that are greater than or equal to 25. Below is a chart of the values and heights of the various cheese blocks he stacks:

Type    Value      Height 

1      100         25

2       20          5

3       40         10

FJ constructs the following tower: 

Type Height Value 

top -> [1]   25    100

```cpp
[2]    4     20   <- crushed by [1] above 
[3]    8     40   <- crushed by [1] above 
[3]    8     40   <- crushed by [1] above 
bottom -> [3]    8     40   <- crushed by [1] above 
```
The topmost cheese block is so large that the blocks below it are crushed. The total height is:
```cpp
25 + 4 + 8 + 8 + 8 = 53 
The total height does not exceed 53 and thus is 'legal'. The total value is: 
100 + 20 + 40 + 40 + 40 = 240. 
This is the best tower for this particular set of cheese blocks. 
要建一个奶酪塔，高度最大为T。他有N块奶酪。第i块高度为Hi（一定是5的倍数），价值为Vi。一块高度>=K的奶酪被称为大奶酪，一个奶酪如果在它上方有大奶酪（多块只算一次），它的高度就会变成原来的4/5.。 很显然John想让他的奶酪他价值和最大。求这个最大值。
```
## 输入格式

\* Line 1: Three space-separated integers: N, T, and K

\* Lines 2..N+1: Line i+1 contains two space separated integers: V\_i and H\_i

## 输出格式

\* Line 1: The value of the best tower FJ can build

## 样例

### 样例输入 #1
```
3 53 25 
100 25 
20 5 
40 10 

```
### 样例输出 #1
```
240 

```
## 题目翻译

**【题目描述】**

FJ 要建一个奶酪塔，高度最大为 $T\ (1 \le T \le 10^3)$ 。他有 $N\ (1 \le N \le 10^2)$ 种奶酪。第 $i$ 种奶酪的高度为 $H_i\ (5\le H_i \le T\text{ 且 }5 \mid H_i)$ ，价值为 $V_i\ (1 \le V_i \le 10^6)$ 。一块高度 $H_i\ge K\ (1 \le K \le T)$ 的奶酪被称为大奶酪，如果一个奶酪上方有大奶酪（如果有多块就只算一次），这个奶酪的高度 $H_i$ 就会变成原来的 $\frac{4}{5}$。FJ 想让他的奶酪塔价值和最大。请你求出这个最大值。

例如，考虑一种奶酪塔，其最大高度可以是 $53$，可以用三种类型的奶酪块建造。大块是大于或等于 $25$ 的块。下面是他堆叠的各种奶酪块的值和高度的图表：

|类型|价值|高度|
| :----------: | :----------: | :----------: |
|1|100|25|
|2|20|5|
|3|40|10|

FJ建造了以下奶酪塔：

|类型|价值|高度|
| :----------: | :----------: | :----------: |
|1|100|25|
|2|20|4|
|3|40|8|
|3|40|8|
|3|40|8|

总高度是 $25 + 4 + 8 + 8 + 8 = 53$，除塔顶奶酪外，其余高度均被压低。总价值是 $100 + 20 + 40 + 40 + 40 = 240$。

**【输入格式】**

第1行为三个用空格隔开的整数 $N,T,K$。

第2至 $N+1$ 行中第 $i+1$ 行包含两个用空格隔开的整数 $V_i,H_i$。

**【输出格式】**

一行一个整数为奶酪塔的最大价值。


---

---
title: "赛斯石（赛后强化版）"
layout: "post"
diff: 普及+/提高
pid: P3983
tag: ['动态规划 DP', '2017', '背包 DP']
---
# 赛斯石（赛后强化版）
## 题目背景

```cpp
白露横江，水光接天，纵一苇之所如，凌万顷之茫然。——苏轼
```
真程海洋近来需要进购大批赛斯石，你或许会问，什么是赛斯石？

首先我们来了解一下赛斯，赛斯是一个重量单位，我们用$ si $作为其单位。比如$ 1 $赛斯就是$ 1si $。

而赛斯石有这样一个性质，它本来是一赛斯一赛斯单独存在的，但是用自然枪将其精化之后，它就会与其它经过精化的赛斯石进行合并，合并到合适的重量之后，便将其钝化，使其不再合并其它赛斯石，如果合错了，也可以用金刚刀将其切开（神奇的是你只能切成整数赛斯重量）。赛斯石的重量只能是**整数**赛斯重量，而不同赛斯重量的赛斯石的价格也是不一样的。

## 题目描述

现需上市$ Need $赛斯重量的赛斯石，卖家想算出这些赛斯石经过某种合并方式来获得的最大收益。然而目前有一个问题，市场在真程大殿附近（真程海洋中心位置），卖家需要租船送赛斯石过去（即不考虑卖家自己租船过去的费用），目前有十种船可以租，载重量从$ 1si $到$ 10si $，每艘船的租价也是有所不同的，如下表所示：

 ![](https://cdn.luogu.com.cn/upload/pic/10663.png) 

由于真程大殿附近有强烈的赛斯力，导致**无法对赛斯石进行任何操作**，商家将赛斯石运过来之后就只能按照之前合并好的卖。假设卖家不返回，且这些赛斯石全部能卖出去。现在卖家他要计算总盈利（设总盈利=赛斯石的总收益-租船所需总费用），请你设计一个程序，算出一种最佳方案，以获得**最大总盈利**。

## 输入格式

输入一共有两行

第一行有一个数据$ Need $（赛斯石的总量，单位：$ si $）

第二行有十个数据$ a_{1}\  ...\ a_{10} $（分别为$ 1si $到$ 10si $的赛斯石市场价格，单位：元）

## 输出格式

输出仅一行，包含一个整数，表示最大总盈利。

## 样例

### 样例输入 #1
```
11
1 6 11 17 23 27 33 35 38 43
```
### 样例输出 #1
```
32
```
### 样例输入 #2
```
7
1 5 14 18 20 28 31 34 39 42
```
### 样例输出 #2
```
21
```
## 提示

### 样例一说明：

将$ 11 $个单位赛斯石合并为一个$ 4si $的赛斯石和一个$ 7si $的赛斯石并且租两个载重分别为$ 4si $和$ 7si $的船，这样做为最佳方案，那么最大总盈利就是$ 32 $元。

### 注意：

对于所有输入数据，均在区间$ (0, 100000) $中，并且为整数；

保证卖家最大总盈利为正；

同一行中，每两个数据之间有一个空格。

赛后强化版于$ 2020 $年$ 10 $月$ 13 $日$ 19 $点$ 18 $分已强化完毕。



---

---
title: "不开心的金明"
layout: "post"
diff: 普及+/提高
pid: P3985
tag: ['模拟', '排序', '背包 DP', '进制', '洛谷月赛']
---
# 不开心的金明
## 题目描述

金明今天很不开心，家里购置的二手房就要领钥匙了，房里并没有一间他自己专用的很宽敞的房间。更让他不高兴的是，妈妈昨天对他说：“你需要购买哪些物品，怎么布置，你说了不算（有很大的限制），而且不超过 $W$ 元钱。”。今天一早金明就开始做预算，但是他想买的东西太多了，肯定会超过妈妈限定的 $W$ 元。于是，他把每件物品规定了一个重要度整数 $p_i$ 表示。他还从因特网上查到了每件物品的价格 $v_i$（都是整数元）。

妈妈看到购物单后进行了审查，要求购物单上所有的物品价格的极差（最贵的减去最便宜的）不超过 $3$（当然金明至今不知道为什么会这样）。他希望在不超过 $W$ 元（可以等于 $W$ 元）的前提下，使购买的重要度总和 $\sum p_i$ 的最大。


请你帮助金明设计一个满足要求的购物单，你只需要告诉我们重要度的最大的和。

## 输入格式

输入的第 $1$ 行，为两个正整数，用一个空格隔开：

$n,W$（其中 $W$ 表示总钱数，$n$ 为希望购买物品的个数。）

从第 $2$ 行到第 $n+1$ 行，第 $j$ 行给出了编号为 $j-1$ 的物品的基本数据，每行有 $2$ 个非负整数 $v_p$（其中 $v$ 表示该物品的价格，$p$ 表示该物品的重要度）
## 输出格式

输出只有一个正整数，为不超过总钱数的物品的重要度的总和的最大值。
## 样例

### 样例输入 #1
```
5 10
2 800
5 400
5 300
3 400
2 200

```
### 样例输出 #1
```
1600
```
## 提示

$1 \le N \le 100$。

$1 \le W \le 10^9$。

$1 \le v_i \le 10^9$。

对所有的 $i=1,2,3,…,N$，$\min(v_i) \le v_i \le \min(v_i)+3$。

$1 \le p_i \le 10^7$。



---

---
title: "[CEOI 2015] 世界冰球锦标赛 (Day2)"
layout: "post"
diff: 普及+/提高
pid: P4799
tag: ['搜索', '2015', 'CEOI（中欧）', '背包 DP']
---
# [CEOI 2015] 世界冰球锦标赛 (Day2)
## 题目描述

 **译自 [CEOI2015](https://ceoi2015.fi.muni.cz/tasks.php) Day2 T1「[Ice Hockey World Championship](https://ceoi2015.fi.muni.cz/day2/eng/day2task1-eng.pdf)」**

> 今年的世界冰球锦标赛在捷克举行。Bobek 已经抵达布拉格，他不是任何团队的粉丝，也没有时间观念。他只是单纯的想去看几场比赛。如果他有足够的钱，他会去看所有的比赛。不幸的是，他的财产十分有限，他决定把所有财产都用来买门票。

给出 Bobek 的预算和每场比赛的票价，试求：如果总票价不超过预算，他有多少种观赛方案。如果存在以其中一种方案观看某场比赛而另一种方案不观看，则认为这两种方案不同。
## 输入格式

第一行，两个正整数 $N$ 和 $M(1 \leq N \leq 40,1 \leq M \leq 10^{18})$，表示比赛的个数和 Bobek 那家徒四壁的财产。  

第二行，$N$ 个以空格分隔的正整数，均不超过 $10^{16}$，代表每场比赛门票的价格。
## 输出格式

输出一行，表示方案的个数。由于 $N$ 十分大，注意：答案 $\le 2^{40}$。

## 样例

### 样例输入 #1
```
5 1000
100 1500 500 500 1000
```
### 样例输出 #1
```
8
```
## 提示

#### 样例解释
八种方案分别是：

 - 一场都不看，溜了溜了  
 - 价格 $100$ 的比赛  
 - 第一场价格 $500$ 的比赛  
 - 第二场价格 $500$ 的比赛  
 - 价格 $100$ 的比赛和第一场价格 $500$ 的比赛  
 - 价格 $100$ 的比赛和第二场价格 $500$ 的比赛  
 - 两场价格 $500$ 的比赛  
 - 价格 $1000$ 的比赛

有十组数据，每通过一组数据你可以获得 10 分。各组数据的数据范围如下表所示：

|数据组号|$1-2$|$3-4$|$5-7$|$8-10$|
|-|:-:|:-:|:-:|:-:|
|$N \leq$|$10$|$20$|$40$|$40$|
|$M \leq$|$10^6$|$10^{18}$|$10^6$|$10^{18}$|


---

---
title: "[NOIP 2018 提高组] 货币系统"
layout: "post"
diff: 普及+/提高
pid: P5020
tag: ['动态规划 DP', '数学', '贪心', '2018', 'NOIP 提高组', '背包 DP']
---
# [NOIP 2018 提高组] 货币系统
## 题目背景

NOIP2018 提高组 D1T2
## 题目描述

在网友的国度中共有 $n$ 种不同面额的货币，第 $i$ 种货币的面额为 $a[i]$，你可以假设每一种货币都有无穷多张。为了方便，我们把货币种数为 $n$、面额数组为 $a[1..n]$ 的货币系统记作 $(n,a)$。 

在一个完善的货币系统中，每一个非负整数的金额 $x$ 都应该可以被表示出，即对每一个非负整数 $x$，都存在 $n$ 个非负整数 $t[i]$ 满足 $a[i] \times t[i]$ 的和为 $x$。然而， 在网友的国度中，货币系统可能是不完善的，即可能存在金额 $x$ 不能被该货币系统表示出。例如在货币系统 $n=3$, $a=[2,5,9]$ 中，金额 $1,3$ 就无法被表示出来。 

两个货币系统 $(n,a)$ 和 $(m,b)$ 是等价的，当且仅当对于任意非负整数 $x$，它要么均可以被两个货币系统表出，要么不能被其中任何一个表出。 

现在网友们打算简化一下货币系统。他们希望找到一个货币系统 $(m,b)$，满足 $(m,b)$ 与原来的货币系统 $(n,a)$ 等价，且 $m$ 尽可能的小。他们希望你来协助完成这个艰巨的任务：找到最小的 $m$。 
## 输入格式

输入文件的第一行包含一个整数 $T$，表示数据的组数。

接下来按照如下格式分别给出 $T$ 组数据。 每组数据的第一行包含一个正整数 $n$。接下来一行包含 $n$ 个由空格隔开的正整数 $a[i]$。
## 输出格式

输出文件共有 $T$ 行，对于每组数据，输出一行一个正整数，表示所有与 $(n,a)$ 等价的货币系统 $(m,b)$ 中，最小的 $m$。
## 样例

### 样例输入 #1
```
2 
4 
3 19 10 6 
5 
11 29 13 19 17 
```
### 样例输出 #1
```
2   
5  
```
## 提示

在第一组数据中，货币系统 $(2, [3,10])$ 和给出的货币系统 $(n, a)$ 等价，并可以验证不存在 $m < 2$ 的等价的货币系统，因此答案为 $2$。 在第二组数据中，可以验证不存在 $m < n$ 的等价的货币系统，因此答案为 $5$。 

【数据范围与约定】

![](https://cdn.luogu.com.cn/upload/pic/43160.png)  

对于 $100\%$ 的数据，满足 $1 ≤ T ≤ 20, n,a[i] ≥ 1$。 


---

---
title: "[BJOI2019] 排兵布阵"
layout: "post"
diff: 普及+/提高
pid: P5322
tag: ['动态规划 DP', '2019', '各省省选', '北京', 'O2优化', '背包 DP']
---
# [BJOI2019] 排兵布阵
## 题目描述

小 C 正在玩一款排兵布阵的游戏。在游戏中有 $n$ 座城堡，每局对战由两名玩家来争夺这些城堡。每名玩家有 $m$ 名士兵，可以向第 $i$ 座城堡派遣 $a_i$ 名士兵去争夺这个城堡，使得总士兵数不超过 $m$。   

如果一名玩家向第 $i$ 座城堡派遣的士兵数**严格**大于对手派遣士兵数的两倍，那么这名玩家就占领了这座城堡，获得 $i$ 分。  

现在小 C 即将和其他 $s$ 名玩家两两对战，这 $s$ 场对决的派遣士兵方案必须相同。小 C 通过某些途径得知了其他 $s$ 名玩家即将使用的策略，他想知道他应该使用什么策略来最大化自己的总分。   

由于答案可能不唯一，你只需要输出小 C 总分的最大值。
## 输入格式

输入第一行包含三个正整数 $s,n,m$，分别表示除了小 C 以外的玩家人数、城堡数和每名玩家拥有的士兵数。   
接下来 $s$ 行，每行 $n$ 个非负整数，表示一名玩家的策略，其中第 $i$ 个数 $a_i$ 表示这名玩家向第 $i$ 座城堡派遣的士兵数。


## 输出格式

输出一行一个非负整数，表示小 C 获得的最大得分。
## 样例

### 样例输入 #1
```
1 3 10
2 2 6
```
### 样例输出 #1
```
3
```
### 样例输入 #2
```
2 3 10
2 2 6
0 0 0
```
### 样例输出 #2
```
8
```
## 提示

**样例1解释：**  
小 C 的最佳策略为向第 $1$ 座城堡和第 $2$ 座城堡各派遣 $5$ 名士兵。 

**样例2解释：**  
小 C 的最佳策略之一为向第 $1$ 座城堡派遣 $2$ 名士兵，向第 $2$ 座城堡派遣 $5$ 名士兵，向第 $3$ 座城堡派遣 $1$ 名士兵。  

**数据范围：**   
对于 $10\%$ 的数据： $s=1,n \le 3,m \le 10$   
对于 $20\%$ 的数据： $s=1,n \le 10,m \le 100$   
对于 $40\%$ 的数据： $n\le 10,m\le 100$     
对于另外 $20\%$ 的数据： $s=1$     
对于 $100\%$ 的数据：  
$1\le s \le 100$  
$1\le n \le 100$  
$1\le m \le 20000$   
对于每名玩家 $a_i \ge 0$，$\sum\limits_{i=1}^n a_i \le m$   



---

---
title: "[SNOI2017] 英雄联盟"
layout: "post"
diff: 普及+/提高
pid: P5365
tag: ['2017', '各省省选', '背包 DP']
---
# [SNOI2017] 英雄联盟
## 题目描述

正在上大学的小皮球热爱英雄联盟这款游戏，而且打的很菜，被网友们戏称为「小学生」。

现在，小皮球终于受不了网友们的嘲讽，决定变强了，他变强的方法就是：买皮肤！

小皮球只会玩  $\text{N}$ 个英雄，因此，他也只准备给这 $\text{N}$ 个英雄买皮肤，并且决定，以后只玩有皮肤的英雄。

这 $\text{N}$ 个英雄中，第 $\text{i}$ 个英雄有 $K_i$ 款皮肤，价格是每款 $C_i$ Q 币（同一个英雄的皮肤价格相同）。

为了让自己看起来高大上一些，小皮球决定给同学们展示一下自己的皮肤，展示的思路是这样的：对于有皮肤的每一个英雄，随便选一个皮肤给同学看。

比如，小皮球共有 5 个英雄，这 5 个英雄分别有 $\text{0,0,3,2,4}$ 款皮肤，那么，小皮球就有 $3 \times 2 \times 4 = 24$ 种展示的策略。

现在，小皮球希望自己的展示策略能够至少达到  $\text{M}$ 种，请问，小皮球至少要花多少钱呢？
## 输入格式

第一行，两个整数 $\text{N,M}$。

第二行，$\text{N}$ 个整数，表示每个英雄的皮肤数量 $K_i$。

第三行，$\text{N}$ 个整数，表示每个英雄皮肤的价格 $C_i$。
## 输出格式

一个整数，表示小皮球达到目标最少的花费。
## 样例

### 样例输入 #1
```
3 24
4 4 4
2 2 2
```
### 样例输出 #1
```
18
```
## 提示

**样例解释**

每一个英雄都只有4款皮肤，每款皮肤2 Q币，那么每个英雄买3款皮肤，$3 \times 3 \times 3 \ge 24$，共花费 $6 \times 3$ Q币。

**数据范围**

共 10 组数据，第 $\text{i}$ 组数据满足：$\text{N} \le \max(5, \log_2^4i)$

$\text{100}\%$ 的数据：$\text{M} \le 10^{17}, 1 \le K_i \le 10, 1 \le C_i \le 199$。保证有解。


---

---
title: "[CSP-J2019] 纪念品"
layout: "post"
diff: 普及+/提高
pid: P5662
tag: ['动态规划 DP', '2019', '背包 DP', 'CSP-J 入门级']
---
# [CSP-J2019] 纪念品
## 题目描述

小伟突然获得一种超能力，他知道未来 $T$ 天 $N$ 种纪念品每天的价格。某个纪念品的价格是指购买一个该纪念品所需的金币数量，以及卖出一个该纪念品换回的金币数量。

每天，小伟可以进行以下两种交易**无限次**：
1. 任选一个纪念品，若手上有足够金币，以当日价格购买该纪念品；
2. 卖出持有的任意一个纪念品，以当日价格换回金币。

每天卖出纪念品换回的金币可以**立即**用于购买纪念品，当日购买的纪念品也可以**当日卖出**换回金币。当然，一直持有纪念品也是可以的。

$T$ 天之后，小伟的超能力消失。因此他一定会在第 $T$ 天卖出**所有**纪念品换回金币。

小伟现在有 $M$ 枚金币，他想要在超能力消失后拥有尽可能多的金币。 
 
## 输入格式

第一行包含三个正整数 $T, N, M$，相邻两数之间以一个空格分开，分别代表未来天数 $T$，纪念品数量 $N$，小伟现在拥有的金币数量 $M$。

接下来 $T$ 行，每行包含 $N$ 个正整数，相邻两数之间以一个空格分隔。第 $i$ 行的 $N$ 个正整数分别为 $P_{i,1},P_{i,2},\dots,P_{i,N}$，其中 $P_{i,j}$ 表示第 $i$ 天第 $j$ 种纪念品的价格。
## 输出格式

输出仅一行，包含一个正整数，表示小伟在超能力消失后最多能拥有的金币数量。
 
## 样例

### 样例输入 #1
```
6 1 100
50
20
25
20
25
50
```
### 样例输出 #1
```
305
```
### 样例输入 #2
```
3 3 100
10 20 15
15 17 13
15 25 16
```
### 样例输出 #2
```
217
```
## 提示

**样例 1 说明**

最佳策略是：

第二天花光所有 $100$ 枚金币买入 $5$ 个纪念品 $1$；

第三天卖出 $5$ 个纪念品 $1$，获得金币 $125$ 枚；

第四天买入 $6$ 个纪念品 $1$，剩余 $5$ 枚金币；

第六天必须卖出所有纪念品换回 $300$ 枚金币，第四天剩余 $5$ 枚金币，共 $305$ 枚金币。

超能力消失后，小伟最多拥有 $305$ 枚金币。

**样例 2 说明**

最佳策略是：

第一天花光所有金币买入 $10$ 个纪念品 $1$；

第二天卖出全部纪念品 $1$ 得到 $150$ 枚金币并买入 $8$ 个纪念品 $2$ 和 $1$ 个纪念品 $3$，剩余 $1$ 枚金币；

第三天必须卖出所有纪念品换回 $216$ 枚金币，第二天剩余 $1$ 枚金币，共 $217$ 枚金币。

超能力消失后，小伟最多拥有 $217$ 枚金币。


**数据规模与约定**

对于 $10\%$ 的数据，$T = 1$。

对于 $30\%$ 的数据，$T \leq 4, N \leq 4, M \leq 100$，所有价格 $10 \leq P_{i,j} \leq 100$。

另有 $15\%$ 的数据，$T \leq 100, N = 1$。

另有 $15\%$ 的数据，$T = 2, N \leq 100$。

对于 $100\%$ 的数据，$T \leq 100, N \leq 100, M \leq 10^3$，所有价格 $1 \leq P_{i,j} \leq 10^4$，数据保证任意时刻，小伟手上的金币数不可能超过 $10^4$。


---

---
title: "[RC-04] 子集积"
layout: "post"
diff: 普及+/提高
pid: P7224
tag: ['动态规划 DP', 'O2优化', '背包 DP']
---
# [RC-04] 子集积
## 题目描述

给出 $n$ 个整数 $a_1\sim a_n$，它们构成的多重集中，有几个子集的元素积大于 $m$？（空集的元素积等于 $1$）

两个子集不同，当且仅当它们中包含元素的 **下标** 不同。

答案很大，因此请输出它对 $998244353$ 取模的值。
## 输入格式

第一行两个整数 $n,m$。

接下来一行 $n$ 个正整数 $a_1\sim a_n$，描述这个多重集。
## 输出格式

一行一个整数，为答案对 $998244353$ 取模的值。
## 样例

### 样例输入 #1
```
4 4
1 1 2 3
```
### 样例输出 #1
```
4
```
### 样例输入 #2
```
20 123456
1 5 12 24 189893 233333 2 22 134 3284 28456 261 50 10 1 2 2 2 2 22
```
### 样例输出 #2
```
1036360
```
## 提示

【样例 $1$ 解释】

以下子集符合要求：$\{a_3,a_4\}$，$\{a_1,a_3,a_4\}$，$\{a_2,a_3,a_4\}$，$\{a_1,a_2,a_3,a_4\}$。

【数据范围】

对于所有数据，$0\le n,m\le 10^6$，$1\le a_i\le 10^6$。

详细数据范围如下表：

| 测试点编号 | $n$ | $m$ | $a_i$ | 每测试点分数 |
| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |
| $1$ | $=0$ |  |  | $1$ |
| $2$ |  | $=0$ |  | $1$ |
| $3\sim 6$ | $\le 22$ |  |  | $4$ |
| $7\sim 10$ | $\le 1000$ | $\le 1000$ |  | $4$ |
| $11\sim 14$ |  |  | 互不相同 | $4$ |
| $15\sim 19$ | $\le 2\times 10^5$ | $\le 2\times 10^5$ |  | $5$ |
| $20\sim 24$ |  |  |  | $5$ |


---

---
title: "小挖的买花"
layout: "post"
diff: 普及+/提高
pid: P8548
tag: ['动态规划 DP', '背包 DP']
---
# 小挖的买花
## 题目背景

小挖喜欢买花，但是 ta 太懒了！所以这个任务全权交给了你。
## 题目描述

花店里只有 $n$ 株花，每一株花都有三个属性：价格 $cost_i$、美丽度 $be_i$、新鲜程度 $fr_i$。

小挖每次都有不同的要求。准确来说，对于第 $j$ 次买花，你手里的钱**至多能买下总价为 $c_j$ 的花**。同时，小挖还要求购买花的**新鲜程度总和大于等于 $f_j$**。而小挖希望知道，在满足 ta 给出的条件后，购买**花的美丽度总和**的最大值是多少？


小挖一共要让你买 $q$ 次花，你能否正确回答 ta 的问题呢？询问彼此独立。
## 输入格式

第 $1$ 行，共两个正整数 $n,q$。

第 $2\sim n+1$ 行，每行三个正整数 $cost_i,fr_i,be_i$，分别表示一株花的三个属性。

第 $n+2\sim n+q+1$ 行，每行两个正整数 $c_j,f_j$，表示每次买花时的要求。
 	 	 
## 输出格式

共 $q$ 行，每行一个整数，表示美丽度总和的最大值。
## 样例

### 样例输入 #1
```
5 1
2 4 5
4 3 3
1 3 2
3 4 3
3 2 5
10 10

```
### 样例输出 #1
```
15

```
## 提示

对于 $20\%$ 的数据，$3\leq n,q\leq 16$。

对于 $40\%$ 的数据，$3\leq n,q\leq 30$，$0\leq c_j,f_j\leq 50$。

对于 $60\%$ 的数据，$3\leq n\leq 100$，$1\leq q\leq 5\times 10^4$，$0\leq cost_i,fr_i,c_j,f_j\leq 100$。

对于另外 $20\%$ 的数据，对于每次买花，都有 $f_j=0$。

对于 $100\%$ 的数据，$3\leq n\leq 500$，$\boldsymbol{1\leq q\leq 10^6}$，$0\leq cost_i,fr_i,c_j,f_j\leq 500$，$1\leq be_i \leq 10^6$。


---

---
title: "「NnOI R1-T3」元组"
layout: "post"
diff: 普及+/提高
pid: P9414
tag: ['O2优化', '背包 DP', '树形 DP']
---
# 「NnOI R1-T3」元组
## 题目背景

小 L 很喜欢树，很喜欢 $ \operatorname{LCA} $，很喜欢有序元组，于是有了这样一道题。
## 题目描述

对于一棵 $ n $ 点有根树（根为 $ 1 $），定义有序 $ p $ 元组 $ (a_1,a_2,......,a_p) $ 为 $ k $ 级 $ \operatorname{LCA} $ $ p $ 元组当且仅当：

* $ 1 \le a_1<a_2<......<a_p \le n $

* 存在 $ x $ 使得对于任意有序严格递增 $ k $ 元组 $ b \subseteq a $ 均满足 $ \operatorname{LCA}_{i=1}^{k}\{b_i\} = x $。

注意，$ \operatorname{LCA}(x,y) $ 指树上 $ x $ 点和 $ y $ 点的最近公共祖先，且 $ \operatorname{LCA}_{i=1}^{k}\{b_i\} $ 指的是所有的 $ b_i $ 的 $ \operatorname{LCA} $。

求出 $ k $ 级 $ \operatorname{LCA} $ $ p $ 元组的个数，对 $ 10^9+7 $ 取模。
## 输入格式

第一行一个整数 $ n,p,k $。

接下来 $ n-1 $ 行，每行两个整数代表一条边的两个端点的编号。
## 输出格式

输出一个整数代表要求的答案。
## 样例

### 样例输入 #1
```
6 4 3
1 2
2 3
3 4
3 5
3 6
```
### 样例输出 #1
```
1
```
### 样例输入 #2
```
6 3 2
1 2
1 3
1 4
1 5
1 6
```
### 样例输出 #2
```
20
```
### 样例输入 #3
```
6 4 2
1 2
1 3
2 4
2 5
3 6
```
### 样例输出 #3
```
0
```
## 提示

**【样例 1 解释】**

对于样例 $ 1 $，我们发现符合要求的 $ 4 $ 元组只有 $ (3,4,5,6) $。

**【数据规模与约定】**

对于 $ 100\% $ 的数据，$ 2 \le n \le 5000 $，$ 2 \le k \le p \le n $。

**提示：本题开启捆绑测试。**

* Subtask 1（10 pts）：$ n \le 10 $。
* Subtask 2（20 pts）：$ n \le 20 $。
* Subtask 3（30 pts）：$ n \le 500 $。
* Subtask 4（10 pts）：$ 1 $ 和所有点存在直接连边。
* Subtask 5（30 pts）：无特殊限制。

**【贡献名单】**

data&check：EstasTonne。（主题库里这个题下一个题号的出题人）


---

---
title: "『STA - R3』Aulvwc"
layout: "post"
diff: 普及+/提高
pid: P9509
tag: ['动态规划 DP', 'O2优化', '背包 DP', '随机化']
---
# 『STA - R3』Aulvwc
## 题目背景

统计学是一门古老而迷人的学科。

传说早在若干年前，一位名为惠普的神灵来到地球，发现了人类——另一种有智慧的物种……

**已加入 Hack 数据，位于 Subtask 5，不计分。**
## 题目描述

定义一个序列 $\{a_n\}$ 是分部平均的，当且仅当存在一个 $\{1,2,\cdots,n\}$ 的划分 $S_1,S_2,\cdots,S_k$（其中 $k>1$），满足对于每个整数 $1\le i\le k$，序列 $\{a\}$ 中以 $S_i$ 为下标的元素之平均数都是相等的**整数**。

现在，给定序列 $\{a_n\}$，问它是否是分部平均的。

如果你对于一些定义不很清楚，可以查阅最后的「提示」部分。


## 输入格式

第一行，一个正整数 $q$，表示询问组数。

对于每组询问，第一行一个正整数 $n$，描述序列长度。第二行 $n$ 个整数，表示序列 $\{a_n\}$。
## 输出格式

$q$ 行，对于每组询问，如果序列是分部平均的，则输出 `Yes`，否则输出 `No`。
## 样例

### 样例输入 #1
```
4
5
1 1 1 1 1
5
1 2 3 4 5
5
1 1 1 1 6
5
-1 0 1 0 1
```
### 样例输出 #1
```
Yes
Yes
No
No
```
## 提示

### 提示
一个集合 $S$ 的划分定义为一组集合 $U_1,U_2,\cdots,U_k$，满足：
- 对于所有 $i\neq j$，有 $U_i\cap U_j=\varnothing$。
- $U_1\cup U_2\cup\cdots\cup U_k=S$。

一个序列 $\{x_n\}$ 的平均数定义为：
$$\bar x=\dfrac{x_1+x_2+\cdots+x_n}{n}=\dfrac 1n\sum_{i=1}^nx_i$$
### 样例解释
第一组数据的一种划分方案：$\{1\},\{2\},\{3\},\{4\},\{5\}$。

第二组数据的一种划分方案：$\{1,5\},\{2,4\},\{3\}$。

注意：划分方案所提供的集合是下标集合。

### 数据范围

**本题采用捆绑测试及子任务依赖。**
$$
\newcommand{\arraystretch}{1.5}
\begin{array}{c|c|c|c|c}\hline\hline
\textbf{Subtask} & \bm{n}\le & \textbf{分值} & \textbf{特殊性质}&\textbf{依赖子任务}\\\hline
\textsf{1} & 10 & 5 & \\\hline
\textsf{2} & 10^3 & 20 & \sum a_i=0 \\\hline
\textsf{3} & 100 & 25 & & \sf1\\\hline
\textsf{4} & 10^3 & 50 & & \sf1\texttt{,}\ 3\\\hline
\end{array}
$$

对于全部数据，$1\le q\le 10$，$2\le n\le 10^3$，$|a_i|\le 5\times10^3$。


---


---
title: "「Cfz Round 9」Rose"
layout: "post"
diff: 普及+/提高
pid: P11207
tag: ['模拟', '递推', '洛谷原创', 'O2优化', '洛谷比赛']
---
# 「Cfz Round 9」Rose
## 题目描述

你和她正在进行一个游戏。

你和她各有 $n$ 张**有序的**卡牌，每张卡牌的颜色可能为粉色、紫色或白色。

**从她开始**，你和她需要各自按照卡牌的顺序，轮流打出手里的卡牌。打出的卡牌将会被移至牌堆中。

若某个人打出卡牌后，牌堆中三种颜色的卡牌的数量相同，则这个人获胜，游戏结束。若你和她的卡牌都打完后，还没有人获胜，则游戏平局。

在游戏开始前，你可以进行若干次操作。每次操作，你可以给任意一个人的任意一张卡牌更换颜色。

你想求出，你至少需要进行多少次操作才能**使她获胜**。可以证明，一定存在至少一种可以使她获胜的操作方案。
## 输入格式

**本题有多组测试数据。**

输入的第一行包含一个正整数 $T$，表示测试数据组数。

接下来依次输入每组测试数据。对于每组测试数据：

- 第一行一个正整数 $n$。
- 第二行一个长度为 $n$ 的字符串 $s$，描述**她**的卡牌：
  - 若 $s_i$ 为 `P`，则表示她的第 $i$ 张卡牌的颜色为粉色；
  - 若 $s_i$ 为 `V`，则表示她的第 $i$ 张卡牌的颜色为紫色；
  - 若 $s_i$ 为 `W`，则表示她的第 $i$ 张卡牌的颜色为白色。
- 第三行一个长度为 $n$ 的字符串 $t$，描述**你**的卡牌：
  - 若 $t_i$ 为 `P`，则表示你的第 $i$ 张卡牌的颜色为粉色；
  - 若 $t_i$ 为 `V`，则表示你的第 $i$ 张卡牌的颜色为紫色；
  - 若 $t_i$ 为 `W`，则表示你的第 $i$ 张卡牌的颜色为白色。
  
其中，$s_i$ 表示字符串 $s$ 的第 $i$ 个字符，$t_i$ 同理。
## 输出格式

对于每组测试数据，输出一行一个整数，表示你使她获胜所至少需要进行的操作的次数。若你不需要进行操作就能使她获胜，则你需要输出 $0$。

可以证明，一定存在至少一种可以使她获胜的操作方案。
## 样例

### 样例输入 #1
```
3
2
PW
VP
5
PPWWP
PWVWV
6
WVPPWW
VVPVWP
```
### 样例输出 #1
```
0
2
1
```
## 提示

#### 「样例解释 #1」

对于第 $1$ 组测试数据，不需要进行操作就能使她获胜。

对于第 $2$ 组测试数据，一种可能的操作方案为将她的第 $4$ 张卡牌和第 $5$ 张卡牌的颜色均更换为紫色。

对于第 $3$ 组测试数据，一种可能的操作方案为将你的第 $4$ 张卡牌的颜色更换为白色。

#### 「数据范围」

对于所有测试数据，保证：

- $1 \le T \le 30$；
- $2 \le n \le 10^5$；
- 对于所有不大于 $n$ 的正整数 $i$，满足 $s_i$ 和 $t_i$ 均为 `PVW` 中的某个字符。

**本题采用捆绑测试。**

- Subtask 0（18 points）：$n \le 6$。
- Subtask 1（20 points）：$n \le 1000$。
- Subtask 2（12 points）：对于任意不大于 $n$ 的正整数 $i$，都满足 $s_i \ne t_i$。
- Subtask 3（25 points）：若你不进行任何操作，则你不会获胜。
- Subtask 4（25 points）：无特殊限制。


---

---
title: "[PumpkinOI Round 1] 递推"
layout: "post"
diff: 普及+/提高
pid: P11617
tag: ['数学', '递推', '2025', 'Special Judge', 'O2优化', '生成函数', 'Ad-hoc', '洛谷比赛']
---
# [PumpkinOI Round 1] 递推
## 题目背景

>一个简单的问题，什么是递推？
## 题目描述

定义一个数列 $\{a_0 \dots a_{n - 1} \}$ 的递推式为满足下式的序列 $\{r_0\dots r_m\}$：

$$\sum_{j = 0} ^ m r_j a_{i - j} = 0, \forall i \ge m$$

$m$ 称为该递推式的阶数。特别地，$r_0\neq 0$。

给你一个无限长的数列 $\{a_i\}$ 的前 $n$ 项以及数列 $\{a_i\}$ 的一个阶数为 $n$ 的递推式 $\{b_i\}$。

要求求出数列 $\{a_i\}$ 的所有项之和。答案对 $998244353$ 取模。

可以证明，对于任意一个模 $998244353$ 意义下输入，都存在实数意义下的一个对应数列的答案是收敛的。
## 输入格式

第一行一个正整数 $n$。

第二行输入 $n$ 个整数，表示序列 $\{a_i\}$ 的前 $n$ 项即 $\{a_0 \dots a_{n-1}\}$ 在模 $998244353$ 意义下的值。

第三行输入 $n+1$ 个整数，表示递推式 $\{b_0\dots b_n\}$ 在模 $998244353$ 意义下的值。
## 输出格式

输出一行一个整数，表示数列 $\{a_i\}$ 的所有项之和对 $998244353$ 取模的结果。

保证答案可以在模 $998244353$ 意义下表示，即如果最终的答案为分数 $\frac qp$（可以证明答案肯定是一个有理数），保证 $p\not\equiv0\pmod {998244353}$。
## 样例

### 样例输入 #1
```
1
1
1 499122176

```
### 样例输出 #1
```
2

```
### 样例输入 #2
```
2
1 1
1 199648870 99824435

```
### 样例输出 #2
```
14
```
### 样例输入 #3
```
1
1
1 499122177

```
### 样例输出 #3
```
665496236

```
## 提示

**样例解释 #1**

$499122176\equiv -\frac12\pmod {998244353}$。

$\forall i\ge n,a_i-\frac12\times a_{i-1}=0$ 即 $a_i=\frac12\times a_{i-1}$，即数列 $\{a_i\}$ 是等比数列 $1,\frac12,\frac14,\dots$。其和收敛于 $2$。

**样例解释 #2**

$199648870\equiv -0.6\pmod {998244353},99824435\equiv -0.3\pmod {998244353}$。

$\forall i\ge n,a_i-0.6\times a_{i-1}-0.3\times a_{i-2}=0$ 即 $a_i=0.6\times a_{i-1}+0.3\times a_{i-2}$。经计算，其和收敛于 $14$。

**本题使用子任务捆绑/依赖**

对于所有子任务，$1\le n\le5\times 10^3$， $0\le a_i,b_i< 998244353$。特别地，$b_0\neq 0$。

| 子任务编号 | 分值 | $n\le$ | 依赖 |
| :-----------: | :-----------: | :-----------: | :-----------: |
| $1$ | $30$ | $1$ | 无 |
| $2$ | $30$ | $2$ | $1$ |
| $3$ | $40$ | $5\times 10^3$ | $1,2$ |



---

---
title: "矩形"
layout: "post"
diff: 普及+/提高
pid: P1191
tag: ['递推', '枚举']
---
# 矩形
## 题目描述

给出一个 $n \times n$ 的矩阵，矩阵中，有些格子被染成白色，有些格子被染成黑色，现要求矩阵中白色**矩形**的数量。
## 输入格式

第一行，一个整数 $n$，表示矩形的大小。

接下来 $n$ 行，每行 $n$ 个字符，这些字符为 $\verb!W!$ 或 $\verb!B!$。其中 $\verb!W!$ 表示白格，$\verb!B!$ 表示黑格。

## 输出格式

一个正整数，为白色矩形数量。

## 样例

### 样例输入 #1
```
4
WWBW
BBWB
WBWW
WBWB
```
### 样例输出 #1
```
15
```
## 提示

对于$30\%$的数据，$n ≤ 50$；

对于$100\%$的数据，$n ≤ 150$；



---

---
title: "诸侯安置"
layout: "post"
diff: 普及+/提高
pid: P1240
tag: ['递推']
---
# 诸侯安置
## 题目描述

很久以前，有一个强大的帝国，它的国土成正方形状，如图所示。

这个国家有若干诸侯。由于这些诸侯都曾立下赫赫战功，国王准备给他们每人一块封地（正方形中的一格）。但是，这些诸侯又非常好战，当两个诸侯位于同一行或同一列时，他们就会开战。如下图为 $n＝3$ 时的国土，阴影部分表示诸侯所处的位置。前两幅图中的诸侯可以互相攻击，第三幅则不可以。

![](https://cdn.luogu.com.cn/upload/image_hosting/7h9ptqlv.png)

国王自然不愿意看到他的诸侯们互相开战，致使国家动荡不安。  因此，他希望通过合理的安排诸侯所处的位置，使他们两两之间都不能攻击。

现在，给出正方形的边长 $n$，以及需要封地的诸侯数量 $k$，要求你求出所有可能的安置方案数。（满足 $n\le100$，$k\le2n^2-2n+1$）

由于方案数可能很多，你只需要输出方案数除以 $504$ 的余数即可。

## 输入格式

仅一行，两个整数 $n$ 和 $k$，中间用一空格隔开。

## 输出格式

一个整数，表示方案数除以 $504$ 的余数。

## 样例

### 样例输入 #1
```
2 2


```
### 样例输出 #1
```
4
```
## 提示

注意：镜面和旋转的情况属于不同的方案。


---

---
title: "小 a 和 uim 之大逃离"
layout: "post"
diff: 普及+/提高
pid: P1373
tag: ['动态规划 DP', '递推', '洛谷原创']
---
# 小 a 和 uim 之大逃离
## 题目背景

小 a 和 uim 来到雨林中探险。突然一阵北风吹来，一片乌云从北部天边急涌过来，还伴着一道道闪电，一阵阵雷声。刹那间，狂风大作，乌云布满了天空，紧接着豆大的雨点从天空中打落下来，只见前方出现了一个披头散发、青面獠牙的怪物，低沉着声音说：“呵呵，既然你们来到这，只能活下来一个！”。小 a 和他的小伙伴都惊呆了！

## 题目描述

瞬间，地面上出现了一个 $n\times m$ 的巨幅矩阵，矩阵的每个格子上有一坨 $0\sim k$ 不等量的魔液。

怪物各给了小 a 和 uim 一个魔瓶，说道，你们可以从矩阵的任一个格子开始，每次向右或向下走一步，从任一个格子结束。开始时小 a 用魔瓶吸收地面上的魔液，下一步由 uim 吸收，如此交替下去，并且要求最后一步必须由 uim 吸收。魔瓶只有 $k$ 的容量，也就是说，如果装了 $k+1$ 那么魔瓶会被清空成零，如果装了 $k+2$ 就只剩下 $1$，依次类推。

怪物还说道，最后谁的魔瓶装的魔液多，谁就能活下来。小 a 和 uim 感情深厚，情同手足，怎能忍心让小伙伴离自己而去呢？沉默片刻，小 a 灵机一动，如果他俩的魔瓶中魔液一样多，不就都能活下来了吗？小 a 和他的小伙伴都笑呆了！

现在他想知道他们都能活下来有多少种方法。
## 输入格式

第一行，三个空格隔开的整数 $n,m,k$。

接下来 $n$ 行，$m$ 列，表示矩阵每一个的魔液量。同一行的数字用空格隔开。

## 输出格式

一个整数，表示方法数。由于可能很大，输出对 $1,000,000,007$ 取余后的结果。
## 样例

### 样例输入 #1
```
2 2 3
1 1
1 1

```
### 样例输出 #1
```
4

```
## 提示

【题目来源】

lzn 改编

【样例解释】

样例解释：四种方案是：$(1,1)\to (1,2)$，$(1,1)\to (2,1)$，$(1,2)\to (2,2)$，$(2,1)\to (2,2)$。

【数据范围】

对于 $20\%$ 的数据，$n,m\leq 10$，$k\leq2$；

对于 $50\%$ 的数据，$n,m\leq 100$，$k\leq5$；

对于 $100\%$ 的数据，$1 \leq n,m\leq 800$，$1\leq k\leq 15$。



---

---
title: "「CZOI-R6」游戏"
layout: "post"
diff: 普及+/提高
pid: P13789
tag: ['数学', '递推', 'O2优化']
---
# 「CZOI-R6」游戏
## 题目描述

有一片 $n\times m$ 的空地，CaiZi 定好了两个常数 $k_1, k_2$，决定在这片空地进行 $q$ 局游戏。

每局游戏内，CaiZi 会先选择空地内某点 $(x_i, y_i)$，设定一个基准得分 $u_i$。随后，对于空地内所有点 $(a, b)\;(1 \leq a \leq n, 1 \leq b \leq m)$，其在该局游戏的得分为 $u_i + k_1 \cdot \lvert x_i - a \rvert + k_2 \cdot \lvert y_i - b\rvert$。

作为观战方，你想要对每个位置 $(i, j) (1 \leq i \leq n, 1 \leq j \leq m)$ 求出其在 $q$ 局游戏中得分的 **最大值**。

**注意 $\boldsymbol{k_1, k_2}$ 未必为正数，详见各子任务约束范围**。
## 输入格式

第一行 $5$ 个整数，依次为 $n,m,q,k_1,k_2$。

接下来 $q$ 行，第 $i$ 行 $3$ 个整数，依次为 $x_i,y_i,u_i$。
## 输出格式

令位置 $(i, j)$ 在所有游戏中得分的最大值为 $f_{i,j}$。

为了减少输出量，你仅需要输出一行一个整数

$$ \left(\sum_{i=1}^n \sum_{j=1}^m f_{i,j} \cdot 131^{(i-1) \times m+j} \right) \bmod{2^{64}} $$

即可。如果你使用 C++ 语言，`unsigned long long` 类型的自然溢出能够自动达到对 $2^{64}$ 取模的效果。

**保证正解不依赖于此输出方式，即能够独立求出所有 $\boldsymbol{f_{i,j}}$ 的值**。
## 样例

### 样例输入 #1
```
3 3 3 1 1
1 1 1
3 2 1
3 3 2
```
### 样例输出 #1
```
1817640486886175503
```
### 样例输入 #2
```
4 5 3 2 -3
3 2 7
1 5 1
2 4 3

```
### 样例输出 #2
```
15847710135880645119
```
## 提示

**【样例解释】**

对于第一组数据，加密前各个位置的得分最大值依次为

$$ \begin{bmatrix} 6 &5 &4 \\ 5 &4 &4 \\ 4 &4 &5 \end{bmatrix}. $$

对于第二组数据，加密前各个位置的得分最大值依次为

$$ \begin{bmatrix} 8 &11 &8 &5 &2 \\ 6 &9 &6 &3 &3 \\ 4 &7 &4 &5 &5 \\ 6 &9 &6 &7 &7 \end{bmatrix}. $$

---

**【数据范围】**

- Subtask #1（$10\ \text{pts}$）：$n, m, q \le 100$。
- Subtask #2（$20\ \text{pts}$）：$k_1=0$。
- Subtask #3（$20\ \text{pts}$）：$n,m\le10^3$，$k_1,k_2 < 0$。
- Subtask #4（$20\ \text{pts}$）：$q$ 局游戏的 $u_i$ 相同。
- Subtask #5（$30\ \text{pts}$）：无特殊限制。

对于 $100\%$ 的数据，$1\le x_i\le n\le3\times10^3$，$1\le y_i\le m\le3\times10^3$，$1\le q\le10^6$，$|k_1|,|k_2|,|u_i|\le10^9$。


---

---
title: "创意吃鱼法"
layout: "post"
diff: 普及+/提高
pid: P1736
tag: ['动态规划 DP', '搜索', '递推']
---
# 创意吃鱼法
## 题目背景

感谢@throusea 贡献的两组数据
## 题目描述

回到家中的猫猫把三桶鱼全部转移到了她那长方形大池子中，然后开始思考：到底要以何种方法吃鱼呢（猫猫就是这么可爱，吃鱼也要想好吃法 ^\_\*）。她发现，把大池子视为 $01$ 矩阵（$0$ 表示对应位置无鱼，$1$ 表示对应位置有鱼）有助于决定吃鱼策略。

在代表池子的 $01$ 矩阵中，有很多的正方形子矩阵，如果某个正方形子矩阵的某条对角线上都有鱼，且此正方形子矩阵的其他地方无鱼，猫猫就可以从这个正方形子矩阵“对角线的一端”下口，只一吸，就能把对角线上的那一队鲜鱼吸入口中。

猫猫是个贪婪的家伙，所以她想一口吃掉尽量多的鱼。请你帮猫猫计算一下，她一口下去，最多可以吃掉多少条鱼？

## 输入格式

第一行有两个整数 $n$ 和 $m$（$n,m≥1$），描述池塘规模。接下来的 $n$ 行，每行有 $m$ 个数字（非 $0$ 即 $1$）。每两个数字之间用空格隔开。


## 输出格式

只有一个整数——猫猫一口下去可以吃掉的鱼的数量，占一行，行末有回车。

## 样例

### 样例输入 #1
```
4 6
0 1 0 1 0 0
0 0 1 0 1 0
1 1 0 0 0 1
0 1 1 0 1 0

```
### 样例输出 #1
```
3
```
## 提示

右上角的
```
1 0 0
0 1 0
0 0 1
```

### 数据范围及约定


- 对于 $30\%$ 的数据，有 $1\le n,m\le 100$；
- 对于 $60\%$ 的数据，有 $1\le n,m\le 1000$；
- 对于 $100\%$ 的数据，有 $1\le n,m\le 2500$。


---

---
title: "符文之语"
layout: "post"
diff: 普及+/提高
pid: P1773
tag: ['动态规划 DP', '递推', 'NOI 导刊', '枚举']
---
# 符文之语
## 题目背景

传说中珠穆朗玛峰下有座古代人修建的神庙，神庙的地下室里有古代王室的遗产，但数千年来从未有人到达过……探险者小 FF 一直梦想成为世界上最富有的人和最杰出的探险家并被永载史册。在证明了这个洞确实存在后，小 FF 做好了充足准备，来到了神庙。
## 题目描述

当小 FF 来到神庙时，神庙已经破败不堪了。但神庙的中央有一个光亮如新的石台。小 FF 走近石台，发现石台上有一个数串，而数串的上方刻着一串古老的符文之语。精通古符文之语的小 FF 不费吹灰之力就读懂了文章的意思，其大意是：

对于石台上的一串数字，你可以在适当的位置加入乘号（设加了 $k$ 个，当然也可不加，即分成 $k+1$ 个部分），设这 $k+1$ 个部分的乘积（如果 $k=0$，则乘积即为原数串的值）对 $m$ 的余数（即 $\bmod\ m$）为 $x$；

现求 $x$ 能达到的最小值及该情况下 $k$ 的最小值，以及 $x$ 能达到的最大值及该情况下的 $k$ 的最小值（可以存在 $x$ 的最小值与最大值相同的情况）。

小 FF 还知道，如果他找到了正确的答案，那么就可以通往神庙的下层了。但这个问题似乎不太好解决，小 FF 就找到了你，并答应找到财宝以后和你二八分（当然你拿二……）。
## 输入格式

第一行为数串，且数串中不存在 $0$；

第二行为 $m$。
## 输出格式

四个数，分别为 $x$ 的最小值和该情况下的 $k$，以及 $x$ 的最大值和该情况下的 $k$，相邻两个数之间用一个空格隔开。
## 样例

### 样例输入 #1
```
4421

22


```
### 样例输出 #1
```
0 1 21 0
```
## 提示

记 $L$ 表示字符串的长度。

- 对于 $30\%$ 的数据：$2 \le L \le 50$；
- 对于 $100\%$ 的数据：$2 \le L \le 1000$，$2 \le m \le 50$。

NOI 导刊 $2010$ 提高（$02$）


---

---
title: "猴子选大王数据再加强版"
layout: "post"
diff: 普及+/提高
pid: P1826
tag: ['递推', '洛谷原创']
---
# 猴子选大王数据再加强版
## 题目描述

有 $n$ 只猴子围成一圈，顺时针编号依次为 $1, 2, 3,\cdots, n$。从第一只猴子开始，不断进行如下操作：顺时针数恰好 $m$ 只猴子，使其出列，再从下一只猴子开始重新计数，如此循环，直到最后只剩下一只猴子。最后剩下来的猴子是这局游戏的获胜者。

现在你需要对于 $n=a,a+1,\cdots,b$ 计算出哪只猴子成为获胜者的次数最多，输出对应的编号。如果有多只猴子成为获胜者的次数均最多，将它们的编号从小到大输出。

## 输入格式

输入共一行三个数 $a, b, m$，如题。

## 输出格式

输出共两行。

第一行输出获胜次数最多的猴子获胜的次数。

第二行输出若干个数，为猴子的编号。

## 样例

### 样例输入 #1
```
1 10 3
```
### 样例输出 #1
```
4

1
```
## 提示

### 样例解释

| $n=$ | $1$ | $2$ | $3$ | $4$ | $5$ | $6$ | $7$ | $8$ | $9$ | $10$ |
| :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: |
| **大王编号** | $1$ | $2$ | $2$ | $1$ | $4$ | $1$ | $4$ | $7$ | $1$ | $4$ |

因此最多的是 $1$ 号，共获胜了 $4$ 回。

### 数据规模与约定

对于 $100\%$ 的数据，保证 $1 \leq a \leq b \leq 10 ^ 6$，$m \leq 3000$。



---

---
title: "斐波那契数列"
layout: "post"
diff: 普及+/提高
pid: P1962
tag: ['数学', '递推', '矩阵运算', '矩阵乘法']
---
# 斐波那契数列
## 题目描述

大家都知道，斐波那契数列是满足如下性质的一个数列：

$$F_n = \left\{\begin{aligned} 1 \space (n \le 2) \\ F_{n-1}+F_{n-2} \space (n\ge 3) \end{aligned}\right.$$


请你求出 $F_n \bmod 10^9 + 7$ 的值。

## 输入格式

一行一个正整数 $n$
## 输出格式

输出一行一个整数表示答案。
## 样例

### 样例输入 #1
```
5
```
### 样例输出 #1
```
5
```
### 样例输入 #2
```
10
```
### 样例输出 #2
```
55
```
## 提示

【数据范围】    
对于 $60\%$ 的数据，$1\le n \le 92$；   
对于 $100\%$ 的数据，$1\le n < 2^{63}$。



---

---
title: "[NOIP 2013 普及组] 小朋友的数字"
layout: "post"
diff: 普及+/提高
pid: P1982
tag: ['动态规划 DP', '高精度', '递推', '2013', 'NOIP 普及组']
---
# [NOIP 2013 普及组] 小朋友的数字
## 题目背景

NOIP2013 普及组 T3
## 题目描述

有 $n$ 个小朋友排成一列。每个小朋友手上都有一个数字，这个数字可正可负。规定每个小朋友的特征值等于排在他前面（包括他本人）的小朋友中连续若干个（最少有一个）小朋友手上的数字之和的最大值。

作为这些小朋友的老师，你需要给每个小朋友一个分数，分数是这样规定的：第一个小朋友的分数是他的特征值，其它小朋友的分数为排在他前面的所有小朋友中（不包括他本人），小朋友分数加上其特征值的最大值。

请计算所有小朋友分数的最大值，输出时保持最大值的符号，将其绝对值对 $p$ 取模后输出。

## 输入格式

第一行包含两个正整数 $n,p$，之间用一个空格隔开。

第二行包含 $n$ 个数，每两个整数之间用一个空格隔开，表示每个小朋友手上的数字。

## 输出格式

一个整数，表示最大分数对 $p$ 取模的结果。

## 样例

### 样例输入 #1
```
5 997
1 2 3 4 5

```
### 样例输出 #1
```
21

```
### 样例输入 #2
```
5 7
-1 -1 -1 -1 -1

```
### 样例输出 #2
```
-1

```
## 提示

**样例解释 1**

小朋友的特征值分别为 $1,3,6,10,15$，分数分别为 $ 1,2,5,11,21$，最大值 $21$ 对 $997$ 的模是 $21$。

**样例解释 2**

小朋友的特征值分别为 $-1,-1,-1,-1,-1$，分数分别为$-1,-2,-2,-2,-2$，最大值 $-1$ 对 $7$ 的模为 $-1$，输出 $-1$。

**【数据范围】**

对于 $50\%$ 的数据，$1 \le n \le 1000$，$1 \le p \le 1000$，所有数字的绝对值不超过 $1000$；

对于 $100\%$ 的数据，$1 \le n \le {10}^6$，$1 \le p \le {10}^9$，其他数字的绝对值均不超过 ${10}^9$。


---

---
title: "[ZJOI2010] 数字计数"
layout: "post"
diff: 普及+/提高
pid: P2602
tag: ['动态规划 DP', '递推', '2010', '各省省选', '浙江', '深度优先搜索 DFS', '数位 DP']
---
# [ZJOI2010] 数字计数
## 题目描述

给定两个正整数 $a$ 和 $b$，求在 $[a,b]$ 中的所有整数中，每个数码(digit)各出现了多少次。
## 输入格式

仅包含一行两个整数 $a,b$，含义如上所述。
## 输出格式

包含一行十个整数，分别表示 $0\sim 9$ 在 $[a,b]$ 中出现了多少次。
## 样例

### 样例输入 #1
```
1 99

```
### 样例输出 #1
```
9 20 20 20 20 20 20 20 20 20

```
## 提示

#### 数据规模与约定

- 对于 $30\%$ 的数据，保证 $a\le b\le10^6$；
- 对于 $100\%$ 的数据，保证 $1\le a\le b\le 10^{12}$。


---

---
title: "[USACO09OPEN] Work Scheduling G"
layout: "post"
diff: 普及+/提高
pid: P2949
tag: ['贪心', '递推', '2009', 'USACO', '优先队列']
---
# [USACO09OPEN] Work Scheduling G
## 题目描述

Farmer John has so very many jobs to do! In order to run the farm efficiently, he must make money on the jobs he does, each one of which takes just one time unit.

His work day starts at time 0 and has 1,000,000,000 time units (!).  He currently can choose from any of N (1 <= N <= 100,000) jobs

conveniently numbered 1..N for work to do. It is possible but

extremely unlikely that he has time for all N jobs since he can only work on one job during any time unit and the deadlines tend to fall so that he can not perform all the tasks.

Job i has deadline D\_i (1 <= D\_i <= 1,000,000,000). If he finishes job i by then, he makes a profit of P\_i (1 <= P\_i <= 1,000,000,000).

What is the maximum total profit that FJ can earn from a given list of jobs and deadlines?  The answer might not fit into a 32-bit integer.



## 输入格式

\* Line 1: A single integer: N

\* Lines 2..N+1: Line i+1 contains two space-separated integers: D\_i and P\_i

## 输出格式

\* Line 1: A single number on a line by itself that is the maximum possible profit FJ can earn.

## 样例

### 样例输入 #1
```
3 
2 10 
1 5 
1 7 

```
### 样例输出 #1
```
17 

```
## 提示

Complete job 3 (1,7) at time 1 and complete job 1 (2,10) at time 2 to maximize the earnings (7 + 10 -> 17).

## 题目翻译

约翰有太多的工作要做。为了让农场高效运转，他必须靠他的工作赚钱，每项工作花一个单位时间。 他的工作日从 $0$ 时刻开始，有 $10^9$ 个单位时间。在任一时刻，他都可以选择编号 $1$ 到 $N$ 的 $N(1 \leq N \leq 10^5)$ 项工作中的任意一项工作来完成。 因为他在每个单位时间里只能做一个工作，而每项工作又有一个截止日期，所以他很难有时间完成所有N个工作，虽然还是有可能。 对于第 $i$ 个工作，有一个截止时间 $D_i(1 \leq D_i \leq 10^9)$，如果他可以完成这个工作，那么他可以获利 $P_i( 1\leq P_i\leq 10^9 )$. 在给定的工作利润和截止时间下，约翰能够获得的利润最大为多少.


---

---
title: "[USACO09OPEN] Grazing2 S"
layout: "post"
diff: 普及+/提高
pid: P2954
tag: ['动态规划 DP', '递推', '2009', 'USACO', '单调队列']
---
# [USACO09OPEN] Grazing2 S
## 题目描述

Farmer John has N (2 <= N <= 1,500) prize milk cows conveniently numbered 1..N. His newly-painted barn has S (N <= S <= 1,000,000) stalls (conveniently numbered 1..S) in a single long line; each stall is a unit distance from its neighboring stall(s).

The cows have made their way to the stalls for a rest; cow i is in stall P\_i. Antisocial as they are, the cows get grumpy if they are situated in stalls very close to each other, so Farmer John wants to move the cows to be as spread out as possible.

FJ wants to make sure that the N - 1 distances between adjacent cows are as large as possible, and he would also like them to be similar to each other (i.e., close to equi-distant spacing).

In particular, FJ would like all distances between adjacent cows to be at most 1 different from (S - 1) / (N - 1), where integer division is used. Moreover, he would like as many of these distances as possible to be exactly equal to (S - 1) / (N - 1) [integer

division]. Thus, with four cows and eight stalls, one can place the cows at positions 1, 3, 5, 8 or 1, 3, 6, 8 but not at 1, 2, 4, 7 or 1, 2, 4, 8.

Help FJ spread the cows as efficiently as possible by calculating and reporting the minimum total distance that the cows have to move in order to achieve proper spacing. Ignore the distance it takes for a cow to enter or exit a stall.

约翰有N(2≤N≤1500)头奶牛，S(N≤S≤1,000,000)个一字排开的牛棚．相邻牛棚间的距离恰好为1．

奶牛们已经回棚休息，第i只奶牛现在待在牛棚Pi．如果两只奶牛离得太近，会让奶牛们变得很暴躁．所以约翰想给一些奶牛换一个棚，让她们之间的距离变得尽量大，并且尽管接近．令d=Trunc((s-1)/(n-1))

所以约翰希望最终的奶牛的状态是：两只相邻奶牛间的距离与d之差不超过1，而且让尽量多的间距等于d．因此，对于4只奶牛8个棚的情况，1，3，5，8或1，3，6，8这样的安置情况是允许的，而1，2，4，7或1，2，4，8这样的情况是不允许的．    帮助约翰移动奶牛，让所有奶牛的移动距离之和最小，同时让最终的安置情况符合约翰心意．

## 输入格式

\* Line 1: Two space-separated integers: N and S

\* Lines 2..N+1: Line i+1 contains the single integer: P\_i

## 输出格式

\* Line 1: A single integer: the minimum total distance the cows have to travel. This number is guaranteed to be under 1,000,000,000 (thus fitting easily into a signed 32-bit integer).

## 样例

### 样例输入 #1
```
5 10 
2 
8 
1 
3 
9 

```
### 样例输出 #1
```
4 

```
## 提示

1   2   3   4   5   6   7   8   9  10

Cow Locs     | A | B | C | . | . | . | . | D | E | . | 

Cows move from stall 2 to 3, 3 to 5, and 9 to 10. The total distance moved is 1 + 2 + 1 = 4. The final positions of the cows are in stalls 1, 3, 5, 8, and 10.

1   2   3   4   5   6   7   8   9  10

Init Stall     | A | B | C | . | . | . | . | D | E | . | 
Final Stall    | A | . | B | . | C | . | . | D | . | E | 
Distance moved | 0 | . | 1 | . | 2 | . | . | 0 | . | 1 | 


---

---
title: "[USACO10DEC] Treasure Chest S"
layout: "post"
diff: 普及+/提高
pid: P3004
tag: ['动态规划 DP', '递推', '2010', 'USACO']
---
# [USACO10DEC] Treasure Chest S
## 题目描述

Bessie and Bonnie have found a treasure chest full of marvelous gold coins! Being cows, though, they can't just walk into a store and buy stuff, so instead they decide to have some fun with the coins.

The N (1 <= N <= 5,000) coins, each with some value C\_i (1 <= C\_i <= 5,000) are placed in a straight line. Bessie and Bonnie take turns, and for each cow's turn, she takes exactly one coin off of either the left end or the right end of the line. The game ends when there are no coins left.

Bessie and Bonnie are each trying to get as much wealth as possible for themselves. Bessie goes first. Help her figure out the maximum value she can win, assuming that both cows play optimally.

Consider a game in which four coins are lined up with these values:

30  25  10  35

Consider this game sequence:

Bessie    Bonnie       New Coin

Player   Side   CoinValue   Total     Total         Line

Bessie   Right     35        35         0       30  25  10

Bonnie   Left      30        35        30         25  10

Bessie   Left      25        60        30           10

Bonnie   Right     10        60        40           --

This is the best game Bessie can play.

小 A 和小 B 在玩游戏。

初始时，有 $n$ 个硬币被摆成了一行，从左至右数第 $i$ 个硬币的价值为 $c_i$。

小 A 和小 B 每人一回合，在一个人的回合中，他可以选择**当前**硬币序列最左侧或者最右侧的硬币，并将他从序列中取出，将其价值累加到自己获得的累计价值中，然后进行另一个人的回合。当硬币全部被取走时，游戏结束。

请求出在双方都尽可能的使自己累计价值最大的情况下，若由小 A 进行第一回合，那么他能获得的累计价值最大是多少。
## 输入格式

输入的第一行是一个整数 $n$，代表硬币的个数。

第 $2$ 到第 $(n + 1)$ 行，每行一个整数，第 $(i + 1)$ 行的整数代表第 $i$ 个硬币的价值 $c_i$。
## 输出格式

输出一行一个整数，代表小 A 能获得的最大累计价值。
## 样例

### 样例输入 #1
```
4 
30 
25 
10 
35 

```
### 样例输出 #1
```
60 

```
## 提示

#### 输入输出样例 $1$ 解释

初始时，硬币序列为 $\{30,~25,~10,~35\}$。

第一回合，小 A 取走最右侧的硬币，序列变为 $\{30,~25,~10\}$，小 A 的累加价值为 $35$。

第二回合，小 B 取走最左侧的硬币，序列变为 $\{25,~10\}$，小 B 的累加价值为 $30$。

第三回合，小 A 取走最左侧的硬币，序列变为 $\{10\}$，小 A 的累加价值为 $35 + 25 = 60$。

第四回合，小 B 取走最左侧的硬币，序列变为空，小 B 的累加价值为 $30 + 10 = 40$，游戏结束。

小 A 获得的最大累计价值为 $60$。

#### 数据范围与约定

对于全部的测试点，$1 \leq n \leq 5 \times 10^3$，$1 \leq c_i \leq 5 \times 10^3$。

**提示：请注意，本题的空间限制为 $64$ Mib。**


---

---
title: "三只小猪"
layout: "post"
diff: 普及+/提高
pid: P3904
tag: ['高精度', '递推', '组合数学', '排列组合', '线性递推']
---
# 三只小猪
## 题目背景

你听说过三只小猪的故事吗？这是一个经典的故事。很久很久以前，有三只小猪。第一只小猪用稻草建的房子，第二个小猪用木棍建的房子，第三个小猪则使用砖做为材料。一只大灰狼想吃掉它们并吹倒了稻草和木棍建的房子。但是砖盖的房子很结实，狼最终也没有破坏掉，最后小猪们战胜了大灰狼并把它尾巴烧掉了。

## 题目描述

为了自己的安全，小猪们又建造了一个新砖房。但是现在问题出现了，怎样把三个小猪分配到两个房子里呢？第三只小猪是三只小猪中最聪明的一只，为了不浪费任何一个房子，它总共考虑了三种方案，如下图

 ![](https://cdn.luogu.com.cn/upload/pic/6862.png) 

“但是将来怎么办呢？”第三只小猪知道将来随着成员的增多，它们将会盖更多的房子。它想知道给定了房子和猪的数目后，房子的分配方案有多少，但这个问题对于它来说，很明显有点难了，你能帮小猪解决这个问题吗？

## 输入格式

输入文件piggy.in，仅有一行，包含两个整数n和m，分别表示小猪的数目和房间数（1≤n≤50，0≤m≤50）。

## 输出格式

输出文件piggy.out，仅一个整数，表示将n只小猪安置在m个房间且没有房间空闲的方案数。

## 样例

### 样例输入 #1
```
4 2
```
### 样例输出 #1
```
7
```
### 样例输入 #2
```
6 7
```
### 样例输出 #2
```
0
```


---

---
title: "[Code+#1] 找爸爸"
layout: "post"
diff: 普及+/提高
pid: P4059
tag: ['动态规划 DP', '递推', 'O2优化', 'Code+']
---
# [Code+#1] 找爸爸
## 题目描述

小 A 最近一直在找自己的爸爸，用什么办法呢，就是 DNA 比对。

小 A 有一套自己的 DNA 序列比较方法，其最终目标是最大化两个 DNA 序列的相似程度，具体步骤如下：


1. 给出两个 DNA 序列，第一个长度为 $n$，第二个长度为 $m$。

2. 在两个序列的任意位置插入任意多的空格，使得两个字符串长度相同

3. 逐位进行匹配，**如果两个序列相同位置上的字符都不是空格**，假设第一个是 $x$，第二个是 $y$，那么他们的相似程度由 $d(x,y)$ 定义。对于两个序列中任意一段极长的长度为 $k$ 的连续空格，我们定义这段空格的相似程度为 $g(k)=-A-B(k-1)$。


那么最终两个序列的相似程度就是所有的 $d(x,y)$ 加上所有的极长空格段的相似程度之和。

现在小 A 通过某种奥妙重重的方式得到了小 B 的 DNA 序列中的一段，他想请你帮他算一下小 A 的 DNA 序列和小 B 的 DNA 序列的最大相似程度。

## 输入格式

输入第 $1$ 行一个字符串，表示小 A 的 DNA 序列。

输入第 $2$ 行一个字符串，表示小 B 的 DNA 序列。

接下来 $4$ 行，每行 $4$ 个整数，用空格隔开，表示 $d$ 数组，具体顺序如下所示。

```plain
d(A,A) d(A,T) d(A,G) d(A,C)
d(T,A) d(T,T) d(T,G) d(T,C)
d(G,A) d(G,T) d(G,G) d(G,C)
d(C,A) d(C,T) d(C,G) d(C,C)
```
最后一行两个用空格隔开的正整数 $A,B$，意义如题中所述。

## 输出格式

输出共一行，表示两个序列的最大相似程度。

## 样例

### 样例输入 #1
```
ATGG
ATCC
5 -4 -4 -4 
-4 5 -4 -4 
-4 -4 5 -4 
-4 -4 -4 5 
2 1
```
### 样例输出 #1
```
4
```
## 提示

### 样例解释

首先，将序列补成如下形式（"-"代表空格）

```cpp
ATGG--
AT--CC
```
然后所有 $d(x,y)$ 的和为 $d(A,A)+d(T,T)=10$

所有极长连续空格段的相似程度之和为 $g(2)+g(2)=-6$

总和为 $4$，可以验证，这是相似程度最大的情况。

对于所有测试点，有 $0< B<A \le 1000, -1000\le d(x,y)\le 1000,d(x,y)=d(y,x)$，序列只包含${A,T,G,C}$四种字符。

 ![](https://cdn.luogu.com.cn/upload/pic/12822.png) 

来自 CodePlus 2017 11 月赛，清华大学计算机科学与技术系学生算法与竞赛协会 荣誉出品。

Credit：idea/卢政荣 命题/卢政荣 验题/何昊天

Git Repo：https://git.thusaac.org/publish/CodePlus201711

感谢腾讯公司对此次比赛的支持。



---

---
title: "山区建小学"
layout: "post"
diff: 普及+/提高
pid: P4677
tag: ['动态规划 DP', '递推', '前缀和']
---
# 山区建小学
## 题目描述

政府在某山区修建了一条道路，恰好穿越总共 $n$ 个村庄的每个村庄一次，没有回路或交叉，任意两个村庄只能通过这条路来往。已知任意两个相邻的村庄之间的距离为 $d_i$（$d_i$ 为正整数），其中，$0<i<n$。为了提高山区的文化素质，政府又决定从 $n$ 个村中选择 $m$ 个村建小学。请根据给定的 $n$、$m$ 以及所有相邻村庄的距离，选择在哪些村庄建小学，才使得所有村到最近小学的距离总和最小，计算最小值。
## 输入格式

第一行为 $n$ 和 $m$，其间用空格间隔。

第二行为 $n-1$ 个整数，依次表示从一端到另一端的相邻村庄的距离，整数之间以空格间隔。

例如

```
10 3
2 4 6 5 2 4 3 1 3
```

表示在 $10$ 个村庄中建 $3$ 所学校。第 $1$ 个村庄与第 $2$ 个村庄距离为 $2$，第 $2$ 个村庄与第 $3$ 个村庄距离为 $4$，第 $3$ 个村庄与第 $4$ 个村庄距离为 $6$，...，第 $9$ 个村庄到第 $10$ 个村庄的距离为 $3$。
## 输出格式

各村庄到最近学校的距离之和的最小值。
## 样例

### 样例输入 #1
```
10 2
3 1 3 1 1 1 1 1 3
```
### 样例输出 #1
```
18
```
## 提示

$1 \le m \le n < 500$，$1 \le d_i \le 100$。


---

---
title: "P哥破解密码"
layout: "post"
diff: 普及+/提高
pid: P4838
tag: ['递推', 'O2优化', '矩阵乘法']
---
# P哥破解密码
## 题目背景

P 哥是一个经常丢密码条的男孩子。

在 ION8102 赛场上，P 哥又弄丢了密码条，笔试满分的他当然知道这可是要扣 $5$ 分作为惩罚的，于是他开始破解 IONXunil 系统的密码。
## 题目描述

定义一个串合法，当且仅当串只由 $\verb!A!$ 和 $\verb!B!$ 构成，且没有连续的 $3$ 个 $\verb!A!$。P 哥知道，密码就是长度为 $N$ 的合法字符串数量对 $19260817$ 取模的结果。但是 P 哥不会算，所以他只能把 $N$ 告诉你，让你来算。

至于为什么要对这个数取模，好像是因为纪念某个人，但到底是谁，P 哥也不记得了。

然而他忘记字符串长度 $N$ 应该是多少了，于是他准备试 $M$ 组数据。
## 输入格式

第一行给出一个整数 $M$ 表示询问次数。

接下来 $M$ 行每行给出一个正整数 $N$，表示该组询问中字符串的长度。
## 输出格式

对于每一次询问输出一行一个整数表示答案。
## 样例

### 样例输入 #1
```
3
1
3
6

```
### 样例输出 #1
```
2
7
44

```
## 提示

### 样例部分解释 :。

长度为 $1$ 时只有 $\verb!A!$ 和 $\verb!B!$ 两种排列，都是合法的。

长度为 $3$ 时除了 $\verb!AAA!$ 是不合法的其他都是可以的，故有 $2^3-1$ 种。

### 数据范围。

- 对于 $20\%$ 数据，全部 $N\leq20$，$M\leq2$；
- 对于 $70\%$ 数据，全部 $N\leq10^7$；
- 对于 $100\%$ 数据，全部 $N\leq10^9$，$M\leq10$。


---

---
title: "选择客栈 加强版"
layout: "post"
diff: 普及+/提高
pid: P6032
tag: ['递推']
---
# 选择客栈 加强版
## 题目描述

丽江河边有 $n$ 家很有特色的客栈，客栈按照其位置顺序从 $1$ 到 $n$ 编号。

每家客栈都按照某一种色调进行装饰（总共 $k$ 种，用整数 $0 \sim k-1$ 表示），且每家客栈都设有一家咖啡店，每家咖啡店均有各自的最低消费。

两位游客一起去丽江旅游，他们喜欢相同的色调，又想尝试两个不同的客栈，因此决定分别住在色调相同的两家客栈中。

晚上，他们打算选择一家咖啡店喝咖啡，要求咖啡店位于两人住的两家客栈之间（包括他们住的客栈），且咖啡店的最低消费不超过 $p$ 。

他们想知道总共有多少种选择住宿的方案，保证晚上可以找到一家最低消费不超过 $p$ 元的咖啡店小聚。 
## 输入格式

输入共 $n+1$ 行。

第一行三个整数 $n,k,p$，每两个整数之间用一个空格隔开，分别表示客栈的个数，色调的数目和能接受的最低消费的最高值。

接下来的 $n$ 行，第 $i+1$ 行两个整数，之间用一个空格隔开，分别表示 $i$ 号客栈的装饰色调和 $i$ 号客栈的咖啡店的最低消费。
## 输出格式

输出一行一个整数，表示可选的住宿方案的总数。
## 样例

### 样例输入 #1
```
5 2 3
0 5
1 3
0 2
1 4
1 5
```
### 样例输出 #1
```
3
```
## 提示

【样例解释】 

$$
\def\arraystretch{1.5}
\begin{array}{|c|c|c|c|c|c|}\hline
\textsf{客栈编号} & \text{①} & \text{②} & \text{③} & \text{④} & \text{⑤} \\\hline
\textsf{色调} & 0 & 1 & 0 & 1 & 1 \\\hline
\textsf{最低消费} & 5 & 3 & 2 & 4 & 5 \\ \hline
\end{array}$$


二人要住同样色调的客栈，所有可选的住宿方案包括：住客栈①③，②④，②⑤，④⑤。

但是若选择住 ④⑤ 号客栈的话，④⑤ 号客栈之间的咖啡店的最低消费是 $4$，而两人能承受的最低消费是 $3$ 元，所以不满足要求。因此只有前 $3$ 种方案可选。

【数据范围】  
对于 $25\%$ 的数据，$n\leq 100$；  
对于 $40\%$ 的数据，$n\leq 1000$；   
对于 $80\%$ 的数据，$n\leq 2 \times 10^5$，$k \leq 50$；   
对于 $100\%$ 的数据，$2\leq n\leq2\times 10^6$，$1 \le k\leq 10^4$，$0\leq p\leq 100$，$0\leq$ 最低消费 $\leq 100$ 。


---

---
title: "[USACO20FEB] Help Yourself G"
layout: "post"
diff: 普及+/提高
pid: P6146
tag: ['递推', '2020', 'USACO', '组合数学', '前缀和']
---
# [USACO20FEB] Help Yourself G
## 题目描述

在一个数轴上有 $N$ 条线段，第 $i$ 条线段覆盖了从 $l_i$ 到 $r_i$ 的所有实数（包含 $l_i$ 和 $r_i$）。

定义若干条线段的**并**为一个包含了所有被至少一个线段覆盖的点的集合。

定义若干条线段的**复杂度**为这些线段的并形成的连通块的数目。

现在 Bessie 想要求出给定 $N$ 条线段的所有子集（共有 $2^N$ 个）的复杂度之和对 $10^9+7$ 取模的结果。

你也许猜到了，你需要帮 Bessie 解决这个问题。但不幸的是，你猜错了！在这道题中你就是 Bessie，而且没有人来帮助你。一切就靠你自己了！
## 输入格式

第一行一个整数 $N$（$1 \leq N \leq 10^5$）。

接下来 $N$ 行，每行两个整数 $l_i,r_i$，描述一条线段。保证 $1 \leq l_i \lt r_i \leq 2N$，且任意两个端点都不在同一位置上。
## 输出格式

输出所求答案对 $10^9+7$ 取模的结果。
## 样例

### 样例输入 #1
```
3
1 6
2 3
4 5
```
### 样例输出 #1
```
8
```
## 提示

### 样例解释

所有非空子集的复杂度如下所示（显然空集的复杂度为零）：
$$
\{[1,6]\} \implies 1, \{[2,3]\} \implies 1, \{[4,5]\} \implies 1
$$

$$
\{[1,6],[2,3]\} \implies 1, \{[1,6],[4,5]\} \implies 1, \{[2,3],[4,5]\} \implies 2
$$

$$
\{[1,6],[2,3],[4,5]\} \implies 1
$$

故答案为 $1+1+1+1+1+2+1=8$。

### 子任务

- 测试点 $2 \sim 3$ 满足 $N \leq 16$；
- 测试点 $4 \sim 7$ 满足 $N \leq 1000$；
- 测试点 $8 \sim 12$ 没有特殊限制。


---

---
title: "樱花，还有你"
layout: "post"
diff: 普及+/提高
pid: P6394
tag: ['动态规划 DP', '递推', '2020', '前缀和']
---
# 樱花，还有你
## 题目背景

Dear Ling,   
&emsp;&emsp;呐，你知道吗？听说樱花飘落的速度是秒速五厘米哦。    
&emsp;&emsp;……所以，再等等吧！三月，武汉大学，樱花就快来了呢。  
&emsp;&emsp;你一定会陪我一起看吧，在酥软的阳光下，我会悄悄牵起你的手，感受你熟悉的温度，糟糕，脸儿也不小心被粉嫩嫩的樱花映红的呢。  
&emsp;&emsp;对了，一定记得带口罩！你那时还是有些虚弱吧。但天依会保护你的！  
&emsp;&emsp;还有啊，樱花还可以做好多好多的点心呢！收集一些飘落樱花吧，我想喝樱花茶，还想吃樱饼，你一定要亲手给我做嗷！
## 题目描述

**与题意有关的句子已加粗。**

但别急，我们就这样彳亍而行吧，**需不着停留或回头**，前面不是**还有 $k$ 棵樱花树么**？我算了算，你可要收集**恰好 $n$ 朵樱花**。我还发现，在第 $i$ 棵树下**最多**能收集到 $s_i$ 朵樱花（收集了 $0$ 朵樱花也算收集了樱花）。  

呐，考考你吧！你有多少种方案能够收集到**恰好 $n$ 朵樱花**呢？

**特殊地，如果你收集不到 $n$ 朵樱花，请告诉我 `impossible`。**   

注意：如果你早早地收集到了 $n$ 朵樱花，你可以立刻告诉我，也可以陪我继续向前走，一直到第 $k$ 棵樱花树下收集了樱花后就必须交差啦！期间你在任何一棵树收集完樱花后就告诉我，形成的方案都是不同的哦！
## 输入格式

第一行两个正整数 $n,k$，表示要收集 $n$ 朵樱花，而前方还有 $k$ 棵樱花树。  

接下来一行 $k$ 个正整数 $s_1,s_2,\cdots,s_k$，其中 $s_i$ 表示最多在第 $i$ 棵樱花树下收集到 $s_i$ 朵樱花。
## 输出格式

一行一个整数，表示恰好收集到 $n$ 朵樱花的方案数。      

**由于答案可能太大，请输出答案对 $10086001$ 取模后的值。**

特殊地，如果收集不到 $n$ 朵樱花，请输出一个字符串 `impossible`。
## 样例

### 样例输入 #1
```
3 4
1 1 1 1
```
### 样例输出 #1
```
5
```
### 样例输入 #2
```
10 9
9 6 8 7 9 6 5 4 3
```
### 样例输出 #2
```
68345
```
### 样例输入 #3
```
10 5
2 2 2 2 1
```
### 样例输出 #3
```
impossible
```
## 提示

#### 样例解释 #1
我们以下列方式表示一种方案：$(a_1,a_2,\cdots,a_{len})$，其中 $\sum_{i=1}^{len} a_i =n$，$len$ 表示在第 $len$ 棵樱花树下收集完樱花后就交差了，$a_i$ 表示在第 $i$ 棵树下收集了 $a_i$ 朵樱花。

那么有下列 $5$ 种方案：$(1,1,1)$，$(1,1,1,0)$，$(0,1,1,1)$，$(1,0,1,1)$，$(1,1,0,1)$。

---

#### 样例解释 #3
最多能收集到 $9$ 朵樱花，所以不能收集到 $10$ 朵樱花，输出 `impossible`。

---

#### 数据范围
**本题采用捆绑测试。**
- Subtask 1（5 Points），$\sum s_i < n$。
- Subtask 2（20 Points），$n,k \leq 20$。
- Subtask 3（55 Points），$n,k \leq 5\times 10^2$。
- Subtask 4（20 Points），$n,k \leq 5\times 10^3$。

对于 $100\%$ 的数据，$1 \leq n,k \leq 5\times 10^3$，$0 \leq s_i \leq n$。

---

#### 题目背景 ( 续 )
&emsp;&emsp;何等聪明的你一定会站在某棵树下，捧着 $n$ 朵可爱的樱花，像孩子似的向我邀功吧。  
&emsp;&emsp;那就别怪我成全你哦，我会轻跳起来，环住你的脖子，揭起你的口罩，尝一尝你的嘴唇。  
&emsp;&emsp;你会不会说，“像樱花一样甜”呢？  
&emsp;&emsp;反正，我的脸一定已经像樱花一样红了吧。  
&emsp;&emsp;……  
&emsp;&emsp;当你看到这封信，别哭呀……  
&emsp;&emsp;冬天从这座城市夺走的，春天会补偿我们的。  
&emsp;&emsp;待你好了，陪我去看樱花，可好？  

Yours,   
Yi


---

---
title: "「EZEC-2」机器"
layout: "post"
diff: 普及+/提高
pid: P6601
tag: ['递推', '二项式定理', '概率论', '矩阵乘法', '逆元']
---
# 「EZEC-2」机器
## 题目背景

tlx 喜欢科幻小说。   

>小宇宙中只剩下漂流瓶和生态球。漂流瓶隐没于黑暗里,在一千米见方的宇宙中,只有生态球里的小太阳发出一点光芒。在这个小小的生命世界中,几只清澈的水球在零重力环境中静静地飘浮着,有一条小鱼从一只水球中蹦出,跃入另一只水球,轻盈地穿游于绿藻之间。在一小块陆地上的草丛中,有一滴露珠从一片草叶上脱离,旋转着飘起,向太空中折射出一缕晶莹的阳光。    
>$\qquad \qquad \qquad \qquad \qquad \qquad \qquad\qquad\qquad\qquad\qquad\qquad\qquad --$《三体》    

在另一个宇宙，将是另一番奇景吧。    

在那里，重力似乎变得微不足道了，引力机器成了司空见惯的东西。

引力机器装置内并没有重力，即若有物体在机器上运动，运动过程中只受机器给予的引力，这个力有一定几率使物体向施力物体快速移动，达到一定动力时就可以实现瞬移。


## 题目描述

一个引力机器由一个光滑圆轨道和 $2n$ 个小孔组成（小孔按**逆时针**从 $1$ 到 $2n$ 编号，每两个相邻的小孔所夹的**劣弧**度数为 $\dfrac{\pi}{n}$ ），每个小孔与和其夹角为 $\pi$ 的另一个小孔有通道相连，比如当 $n=2$ 时，$1$ 号孔和 $3$ 号孔相连。

当 $n=2$ 时，这个装置的构造大概是这样的：
 
 ![](https://cdn.luogu.com.cn/upload/image_hosting/el8alxde.png) 
 
现在我们在 $1$ 号孔处放一个小球，使它一直**沿逆时针方向做匀速圆周运动**，在不瞬移的情况下，每一秒恰好能从一个小孔运动至下一个小孔。

由于未来实验室构造奇特（内部的引力提供装置太神了！），每经过一个小孔时，有 $p$ 的概率**立刻瞬移**（即不花费时间）到通道对面的小孔并继续沿逆时针方向做匀速圆周运动，也就是有 $1-p$ 的概率继续沿圆周向下一个小孔运动。

值得注意的是，**每一单位时刻，小球只能瞬移一次**。  

简单地说，若某一时刻小球在小孔 $i$，则下一时刻它可能运动到小孔 $i \bmod 2n + 1$ 或 $(i + n) \bmod 2n + 1$，概率分别为 $1-p$ 和 $p$。

现在 tlx 有两个一模一样的引力机器，两个小球同时从 $1$ 号孔开始运动。他会**随机**（所有可能选择的概率相同）选择一个二元组 $(i,j)( 1\leqslant i\leqslant 2n,0\leqslant j\leqslant t,i,j\in \mathbb Z$ ) 分别代表小孔编号和时间，你需要求出时间为 $j$ 时两个引力机器的小孔 $i$ **同时**有小球**停留（运动经过小孔但瞬移到对面了不算停留）** 的概率。

注意：**小球刚开始运动时也可能瞬移到对面的小孔。**   

为方便计算，我们规定：所有概率都是在模 $10^9+7$ 意义下的。      
## 输入格式

输入数据共一行，三个整数 $n,p,t$，分别代表引力装置的小孔数的一半，瞬移的概率对 $10^9+7$ 取模的结果，选择的时间的范围的上界。
## 输出格式

共一行，一个整数，代表两个小球同时经过所选位置的概率对 $10^9+7$ 取模的结果。
## 样例

### 样例输入 #1
```
2 500000004 1
```
### 样例输出 #1
```
125000001
```
### 样例输入 #2
```
6 114514 11
```
### 样例输出 #2
```
756497239
```
## 提示

**【数据范围与约定】** 

**本题采用捆绑测试。**    

具体计分方式如下：   

- Subtask $1$ ($7$ points)：满足 $p\in \{0,1\}$；  
- Subtask $2$ ($13$ points)：满足 $t\leqslant 20,n\leqslant50$；  
- Subtask $3$ ($20$ points)：满足 $t\leqslant 10^3,n\leqslant50$；  
- Subtask $4$ ($10$ points)：满足 $t\leqslant 10^3$；  
- Subtask $5$ ($10$ points)：满足 $t\leqslant 10^6$；
- Subtask $6$ ($15$ points)：满足 $n\leqslant50$；
- Subtask $7$ ($25$ points)：无特殊限制。


对于 $100\%$ 的数据，满足 $2\leqslant n\leqslant 500$，$0\leqslant p\leqslant 10^9+6$，$0\leqslant t \leqslant 10^9$。  

**注意：不做说明的数据范围即为极限数据范围。**

**【样例解释 #1】**  

$500000004$ 是模 $10^9+7$ 意义下的 $\dfrac{1}{2}$。 

下面为了方便，记 $P(i,j)$ 为选择的二元组为 $(i,j)$ 时的概率。    

所有概率不为 $0$ 的二元组有：   
$P(1,0)=\dfrac{1}{4},P(3,0)=\dfrac{1}{4},P(2,1)=\dfrac{1}{4},P(4,1)=\dfrac{1}{4}$。    

所有可以选择的二元组有：   
$(1,0),(1,1),(2,0),(2,1),(3,0),(3,1),(4,0),(4,1)$，共 $8$ 种。    

所以总的概率：  
$$P=\dfrac{1}{8}×\dfrac{1}{4}×4+\dfrac{1}{8}×0×4=\dfrac{1}{8}$$

在模 $10^9+7$ 意义下为 $125000001$，即为输出的答案。

------------

**【其他提示】**

1. 如果你不了解分数取模，可以查看[这里](https://www.luogu.com.cn/problem/P2613)。  

2. 如果你不明白题目中角度的表示方法，可以查看[弧度制](https://baike.baidu.com/item/弧度制/3315973?fr=aladdin)。




---

---
title: "「Stoi2031」枫"
layout: "post"
diff: 普及+/提高
pid: P7485
tag: ['数学', '递推']
---
# 「Stoi2031」枫
## 题目背景

> 缓缓飘落的枫叶像思念 为何挽回要赶在冬天来之前 爱你穿越时间 两行来自秋末的眼泪 让爱渗透了地面 我要的只是你在我身边 ——《枫》
## 题目描述

冬很喜欢枫叶。她家门前有一棵枫树，树上落下了 $n$ 片叶子。冬将它们编号为 $1$ 到 $n$。她希望这些枫叶不要这样被人踩碎后烂在地里，所以决定把它们捡起来。她称将剩余未捡起来的枫叶按编号从小到大或从大到小的顺序排序后，先捡起第一片枫叶，然后每隔 $k$ 片捡起一片称为一次 **挽回**。她会一直进行 **挽回**，第一次 **挽回** 从小到大，之后每次 **挽回** 的顺序都和上次不同（即上次从小到大这次就从大到小，反之亦然），直到最后一片枫叶也被捡起。她认为最后一片捡起的枫叶代表了 **思念**，能带来幸福。她希望获得更多的幸福，所以她会很多次地问你 $n$ 和 $k$ 取某两个值时她得到的 **思念** 的编号。
## 输入格式

第一行为数据组数 $t$，满足 $t=i$，$i$ 为数据点编号。

第 $2$ 到 $t+1$ 行，每行开头两个数 $q,m$，表示她要取 $q$ 次，每次的枫叶数 $n$ 不超过 $m$。接着输入 $q$ 个数表示每次的枫叶数 $n$。第 $x$ 行的所有询问中 $k=x-1$。
## 输出格式

对于每行输出 $q$ 个数，表示每次询问的答案。
## 样例

### 样例输入 #1
```
1
2 3 1 3

```
### 样例输出 #1
```
1 2

```
### 样例输入 #2
```
2
2 3 1 3
3 7 2 4 7

```
### 样例输出 #2
```
1 2
2 2 5

```
### 样例输入 #3
```
3
2 3 1 3
3 7 2 4 7
7 10 1 2 3 6 7 8 10

```
### 样例输出 #3
```
1 2
2 2 5
1 2 2 3 4 6 6

```
## 提示

#### 简述版题意：

给定 $n,k$，对 $1,2,\dots,n$ 一直操作，每次操作交替从小到大或从大到小的顺序取走当前的第 $(k+1)x+1$ 个数（$x \in \mathbb{Z_{\ge 0}}$ 且 $(k+1)x+1$ 不超过剩余数总数），求最后一个取走的数的编号。多次询问。

#### 样例解释：

限于篇幅，只对样例 $2$ 作解释。

对于第 $2$ 行：

对于第一次询问，地上只有 $1$ 片枫叶，此即 **思念**。

对于第二次询问，冬第一次 **挽回** 时依次捡起了 $1,3$ 两片枫叶，转身后只剩下 $2$，即 **思念**。

对于第 $3$ 行：

对于第一次询问，冬第一次 **挽回** 时捡起了 $1$ 号枫叶，转身后剩下 $2$，即 **思念**。

对于第二次询问，冬第一次 **挽回** 时捡起了 $1,4$ 两片枫叶，第二次 **挽回** 捡起了 $3$，剩下 $2$，即 **思念**。

对于第三次询问，冬第一次捡起了 $1,4,7$，第二次捡起了 $6,2$，第三次捡起了 $3$，此时剩下 $5$，即 **思念**。

#### 数据范围：

**本题每个数据点（除第 $1$ 个外）输入数据除数据组数 $t$ 以及最后一行（第 $t+1$ 行）外与前一个数据点输入数据完全相同。各个数据点的数据范围及特殊限制如下。**

| Testdata No. | $q \le$ | $m \le$ | 特殊限制 | 分值 |
| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |
| $1$ | $2$ | $3$ | 为样例 $1$ | $3$ |
| $2$ | $3$ | $7$ | 为样例 $2$ | $7$ |
| $3$ | $7$ | $10$ | 为样例 $3$ | $3$ |
| $4$ | $10$ | $30$ | 无 | $3$ |
| $5$ | $30$ | $70$ | 无 | $7$ |
| $6$ | $70$ | $100$ | 无 | $7$ |
| $7$ | $100$ | $300$ | 无 | $7$ |
| $8$ | $300$ | $700$ | 无 | $10$ |
| $9$ | $700$ | $10^3$ | 无 | $3$ |
| $10$ | $10^3$ | $3 \times 10^3$ | 无 | $3$ |
| $11$ | $3 \times 10^3$ | $7 \times 10^3$ | 无 | $1$ |
| $12$ | $7 \times 10^3$ | $10^4$ | 无 | $13$ |
| $13$ | $10^4$ | $3 \times 10^4$ | 无 | $3$ |
| $14$ | $3 \times 10^4$ | $7 \times 10^4$ | 无 | $3$ |
| $15$ | $7 \times 10^4$ | $10^5$ | 无 | $10$ |
| $16$ | $10^5$ | $3 \times 10^5$ | 无 | $13$ |
| $17$ | $3 \times 10^5$ | $7 \times 10^5$ | 无 | $1$ |
| $18$ | $7 \times 10^5$ | $10^6$ | 无 | $3$ |

**本题读入量较大，可以选择使用比赛描述中的快速读入模板以加快读入速度。**


---

---
title: "〈 TREEのOI 2022 Spring 〉Counting By Ternary"
layout: "post"
diff: 普及+/提高
pid: P8308
tag: ['数学', '递推', 'O2优化', '前缀和', '分块']
---
# 〈 TREEのOI 2022 Spring 〉Counting By Ternary
## 题目背景

黑土地上，一棵小苗破土而出。

几个月里，它吮吸着甘甜的雨露，享受着温暖的阳光，愈发翠绿了起来。

![](https://cdn.pixabay.com/photo/2019/03/05/12/52/plant-4036131_960_720.jpg)

它越长越高，越长越壮，似乎要突破云霄。

它长成了一棵大树，渴望着去天空中，看一看这美丽的世界。

![](https://cdn.pixabay.com/photo/2015/02/24/15/41/wolf-647528_960_720.jpg)
## 题目描述

**请留意本题并不寻常的时空限制。**

给定一个数 $x$，用如下规则建立一棵有根树：

- 根节点为 $\lang0,x\rang$。  

- 对于一个节点 $\lang i,j\rang$，若 $j < 3$，则它是叶子节点，否则它的子节点为对于任意 $1 \le k$ 且 $j$ 的位数 $\ge k$， $\lang j_k, k\rang$，其中 $j_k$ 为它三进制表示从左向右的第 $k$ 位。  

求这棵树的叶子节点的数目。
## 输入格式

一行两个整数 $p, q$，表示 $x = p^q$。
## 输出格式

一行一个整数，即为所求。  

题目保证答案在 $\tt int64$ 范围内。
## 样例

### 样例输入 #1
```
9 1
```
### 样例输出 #1
```
4
```
### 样例输入 #2
```
27 1
```
### 样例输出 #2
```
6
```
## 提示



**本题采用 SubTask 捆绑测试。**

| SubTask 编号 | 分值 | 特殊性质 |
| :-----------: | :-----------: | :-----------: |
| $0$ | $10$ | $p\le 3^{15}$，$q=1$ |
| $1$ | $10$ | $p\le 3^{35}$，$q=1$ |
| $2$ | $20$ | $p=3$，$q\le 3^{15}$ |
| $3$ | $60$ | $p=3$，$q\le 3^{35}$ |


对于 $100\%$ 的数据，$p^q \le 3^{3^{35}}$（$10^{10^9} \lt 3^{3^{35} } \lt 10^{2.5 \times 10^9}$），保证 $p = 3^l(l\in \mathbb N^+)$。 



---

---
title: "[USACO23FEB] Equal Sum Subarrays G"
layout: "post"
diff: 普及+/提高
pid: P9127
tag: ['USACO', '2023', '排序', '线性递推']
---
# [USACO23FEB] Equal Sum Subarrays G
## 题目描述

**Note: The time limit for this problem is 3s, 1.5x the default.** 

FJ gave Bessie an array $a$ of length $N(2 \le N \le 500,−10^{15} \le a_i \le 10^{15})$ with all $\dfrac{N(N+1)}{2}$ contiguous subarray sums distinct. For each index $i \in [1,N]$, help Bessie compute the minimum amount it suffices to change ai by so that there are two different contiguous subarrays of a with equal sum. 
## 输入格式

The first line contains $N$.

The next line contains $a_1, \cdots ,a_N$
(the elements of $a$, in order). 
## 输出格式

One line for each index $i \in [1,N]$. 
## 样例

### 样例输入 #1
```
2
2 -3
```
### 样例输出 #1
```
2
3
```
### 样例输入 #2
```
3
3 -10 4
```
### 样例输出 #2
```
1
6
1
```
## 提示

### Explanation for Sample 1

Decreasing $a_1$ by $2$ would result in $a_1+a_2=a_2$. Similarly, increasing $a_2$ by $3$ would result in $a_1+a_2=a_1$. 

### Explanation for Sample 2

Increasing a1 or decreasing $a_3$ by $1$ would result in $a_1=a_3$. Increasing $a_2$ by $6$ would result in $a_1=a_1+a_2+a_3$. 

### SCORING

 - Input $3$: $N \le 40$
 - Input $4$: $N \le 80$
 - Inputs $5-7$: $N \le 200$
 - Inputs 8-16: No additional constraints.
## 题目翻译

### 题目描述

注意：本题的时间限制为 3 秒，为默认时间的 1.5 倍。

FJ 给了 Bessie 一个长度为 $N$ 的数组 $a$（$2 \leq N \leq 500, -10^{15} \leq a_i \leq 10^{15}$），其中所有 $\dfrac{N(N+1)}{2}$ 个连续子数组的和都是不同的。对于每个下标 $i \in [1,N]$，帮助 Bessie 计算最小的改变量，使得数组中存在两个不同的连续子数组的和相等。

### 输入格式

第一行包含一个整数 $N$，表示数组的长度。

第二行包含 $a_1,\cdots,a_N$，即数组 $a$ 的元素，按顺序给出。

### 输出格式

对于每个下标 $i \in [1,N]$，输出一行一个整数，表示改变 $a_i$ 的最小改变量。

### 样例 1 的解释

将 $a_1$ 减少 $2$，可以使得 $a_1+a_2=a_2$。类似地，将 $a_2$ 增加 $3$，可以使得 $a_1+a_2=a_1$。

### 样例 2 的解释

将 $a_1$ 增加 $1$ 或将 $a_3$ 减少 $1$，可以使得 $a_1=a_3$。将 $a_2$ 增加 $6$，可以使得 $a_1=a_1+a_2+a_3$。

### 评分标准

- 测试点 $3$：$N \leq 40$
- 测试点 $4$：$N \leq 80$
- 测试点 $5-7$：$N \leq 200$
- 测试点 $8-16$：无额外限制。


---

---
title: "「KDOI-06-S」消除序列"
layout: "post"
diff: 普及+/提高
pid: P9744
tag: ['递推', '2023', '洛谷原创', 'O2优化', '前缀和', '洛谷月赛']
---
# 「KDOI-06-S」消除序列
## 题目描述

小 M 有一个长度为 $n$ 的序列 $v_1,v_2,\ldots,v_n$，初始时，所有元素的值均为 $1$。

你有 $3$ 种作用在这个序列上的操作：

1. 选择一个下标 $i$（$1\le i\le n$），并且将 $v_1,v_2,\ldots,v_i$ 的值全部设为 $0$，这种操作的代价是 $a_i$；
2. 选择一个下标 $i$（$1\le i\le n$），并且将 $v_i$ 的值设为 $0$，这种操作的代价是 $b_i$；
3. 选择一个下标 $i$（$1\le i\le n$），并且将 $v_i$ 的值设为 $1$，这种操作的代价是 $c_i$。

现在有 $q$ 次询问，每次询问中给定一个集合 $P$，你希望进行若干次操作（可能为 $0$），使得：序列 $v$ 中下标位于该集合的元素的值为 $1$，其余位置的值为 $0$。**形式化地说，对于任意 $\bm{1\le i\le n}$，若 $\bm{i\in P}$，则 $\bm{v_i=1}$，否则 $\bm{v_i=0}$。** 并且，你需要最小化这次询问中所有操作的总代价。

注意，询问是相互独立的，也就是说，每次询问结束后，序列 $v$ 将会回到初始状态，即所有元素的值全都变为 $1$。
## 输入格式

从标准输入读入数据。

输入的第一行包含一个正整数 $n$，表示序列 $v$ 的长度。

第二行包含 $n$ 个非负整数 $a_1,a_2,\ldots,a_n$，表示第一种操作的代价。

第三行包含 $n$ 个非负整数 $b_1,b_2,\ldots,b_n$，表示第二种操作的代价。

第四行包含 $n$ 个非负整数 $c_1,c_2,\ldots,c_n$，表示第三种操作的代价。

第五行包含一个正整数 $q$，表示询问次数。

接下来的 $q$ 行中，第 $i$ 行包含以下内容：

+ 开头一个非负整数 $m$，表示第 $i$ 次询问中集合 $P$ 的大小；
+ 接下来有 $m$ 个正整数 $p_1,p_2,\ldots,p_m$，依次表示集合 $P$ 中每个元素的值，保证对于任意 $1\le i<m$，都有 $p_i<p_{i+1}$。
## 输出格式

输出到标准输出。

输出共 $q$ 行，第 $i$ 行包含一个非负整数，表示第 $i$ 次询问中操作总代价的最小值。
## 样例

### 样例输入 #1
```
5
1 13 6 0 6
2 4 1 0 5
3 4 1 2 1
7
1 4
2 1 5
1 4
2 2 3
5 1 2 3 4 5
1 5
2 3 4
```
### 样例输出 #1
```
7
3
7
6
0
0
8
```
### 样例输入 #2
```
7
10 1 6 9 4 2 4 
0 5 2 3 0 1 4 
4 1 4 1 5 3 5 
6
3 1 3 6 
2 2 6 
4 3 4 5 7 
1 4 
2 3 7 
3 3 5 6
```
### 样例输出 #2
```
12
8
2
5
5
8
```
### 样例输入 #3
```
10
6 10 7 2 8 4 6 4 8 7
4 0 6 7 8 4 8 2 10 5
4 10 6 1 4 7 5 3 8 7
1
0
```
### 样例输出 #3
```
7
```
## 提示

**【样例解释 #1】**

对于第一次询问，可以按顺序执行如下操作：

+ 在 $i=4$ 处执行操作 $1$，在这之后，序列 $v$ 变为 $[0,0,0,0,1]$，代价为 $0$；
+ 在 $i=4$ 处执行操作 $3$，在这之后，序列 $v$ 变为 $[0,0,0,1,1]$，代价为 $2$；
+ 在 $i=5$ 处执行操作 $2$，在这之后，序列 $v$ 变为 $[0,0,0,1,0]$，代价为 $5$。

所以总代价为 $0+2+5=7$，可以证明，不存在更小的总代价。

**【样例解释 #3】**

对于这个样例中的唯一一次询问，可以选择在 $i=10$ 处执行操作 $1$，总代价为 $a_{10}=7$。

**【样例 #4】**

见选手目录下的 `reserve/reserve4.in` 与 `reserve/reserve4.ans`。

**【样例 #5】**

见选手目录下的 `reserve/reserve5.in` 与 `reserve/reserve5.ans`。

这个样例满足测试点 $8\sim 11$ 的条件限制。

**【样例 #6】**

见选手目录下的 `reserve/reserve6.in` 与 `reserve/reserve6.ans`。

这个样例满足测试点 $14\sim 15$ 的条件限制。

**【样例 #7】**

见选手目录下的 `reserve/reserve7.in` 与 `reserve/reserve7.ans`。

这个样例满足测试点 $16$ 的条件限制。

**【样例 #8】**

见选手目录下的 `reserve/reserve8.in` 与 `reserve/reserve8.ans`。

这个样例满足测试点 $17\sim 20$ 的条件限制。

***

**【数据范围】**

记 $\sum m$ 为单测试点内所有询问 $m$ 的值之和。

对于所有数据保证：$1 \leq n \leq 5\times 10^5$，$0\le m \le n$，$0 \leq \sum m \leq 5 \times 10^5$，$1\le q\le \max(n,\sum m)$，$0 \le a_i, b_i, c_i \le 10^9$，$1\le p_i \le n$。

| 测试点编号 | $n \le$ | $m \le$ | $\sum m \le$| 是否有特殊性质 |
|:--:|:--:|:--:|:--:|:--:|
| $1 \sim 2$ | $5 \times 10^5$ | $0$ | $0$ | 否 |
| $3 \sim 4$ | $7$ | $7$ | $15$ | 否 |
| $5 \sim 6$ | $2 \times 10^3$ | $1$ | $2 \times 10^3$ | 否 |
| $7$ | $2 \times 10^3$ | $2 \times 10^3$ | $2 \times 10^3$ | 是 |
| $8 \sim 11$ | $2 \times 10^3$ | $2\times 10^3$ | $2 \times 10^3$ | 否 |
| $12 \sim 13$ | $5 \times 10^4$ | $5 \times 10^4$ | $5 \times 10^4$ | 否 |
| $14 \sim 15$ | $5 \times 10^5$ | $1$ | $5 \times 10^5$ | 否 |
| $16$ | $5 \times 10^5$ | $5 \times 10^5$ | $5 \times 10^5$ | 是 |
| $17 \sim 20$ | $5 \times 10^5$ | $5 \times 10^5$ | $5 \times 10^5$ | 否 |

特殊性质：对于任意 $1\le i\le n$，保证 $c_i = 0$。

**【提示】**

本题输入输出量较大，请使用适当的 I/O 方式。


---


---
title: "分解质因子 2"
layout: "post"
diff: 普及-
pid: B3715
tag: ['数论', '素数判断,质数,筛法']
---
# 分解质因子 2
## 题目描述

给定一个正整数 $n$，设 $n = p_1 \times p_2 \times \dots p_k$，其中 $p_i$ 均为质数，对 $1 \leq i < k$，$p_i \leq p_{i + 1}$。

可以证明，序列 $p_i$ 是唯一的。

对每个给定的 $n$，请你求出 $p_1, p_2, \dots p_k$。
## 输入格式

**本题单测试点内有多组测试数据**。

第一行是一个整数，表示测试数据组数 $T$。

接下来 $T$ 行，每行一个整数，表示一组数据的 $n$。
## 输出格式

对每组数据，输出一行若干个用空格隔开的整数，依次表示 $p_1, p_2, \dots p_k$。
## 样例

### 样例输入 #1
```
9
2
3
4
5
6
7
8
9
10
```
### 样例输出 #1
```
2
3
2 2
5
2 3
7
2 2 2
3 3
2 5
```
## 提示

### 数据规模与约定

对全部的测试点，保证 $1 \leq T \leq 10$，$1 \leq n \leq 10^{12}$。


---

---
title: "[信息与未来 2018] 素数方阵"
layout: "post"
diff: 普及-
pid: B3738
tag: ['模拟', '2018', '江苏', '素数判断,质数,筛法', '信息与未来']
---
# [信息与未来 2018] 素数方阵
## 题目描述

把前 $n^2$ 个素数从左上角开始按右、下、左、上、右、下、左、上……的顺序填入 $n×n$ 的方阵就得到了蛇形素数方阵。以下是 $n = 4$ 和 $n = 5$ 的蛇形素数方阵：

![](https://cdn.luogu.com.cn/upload/image_hosting/sgevwlzo.png)

给出 $n$，你的任务是求出 $n × n$ 的蛇形素数方阵，并输出其中某个方格中的数值。

素数，又称质数，是指除 $1$ 和其自身之外，没有其他约数的大于 $1$ 的正整数。
## 输入格式

输入一行三个正整数 $n,x,y$。

## 输出格式

输出一行一个整数，表示 $n×n$ 蛇形素数方阵第 $x$ 行第 $y$ 列中的数字。
## 样例

### 样例输入 #1
```
5 1 4
```
### 样例输出 #1
```
7
```
### 样例输入 #2
```
5 4 3
```
### 样例输出 #2
```
79
```
## 提示

### 样例解释
参考上图 $n = 5$。
### 数据规模
所有数据满足 $1 ≤ x,y\le n ≤ 20$。

> 本题原始满分为 $15\text{pts}$。


---

---
title: "[GESP202312 五级] 小杨的幸运数"
layout: "post"
diff: 普及-
pid: B3929
tag: ['二分', '2023', '素数判断,质数,筛法', 'GESP']
---
# [GESP202312 五级] 小杨的幸运数
## 题目描述

小杨认为，所有大于等于 $a$ 的完全平方数都是他的超级幸运数。

小杨还认为，所有超级幸运数的倍数都是他的幸运数。自然地，小杨的所有超级幸运数也都是幸运数。

对于一个非幸运数，小杨规定，可以将它一直 $+1$，直到它变成一个幸运数。我们把这个过程叫做幸运化。例如，如果$a=4$，那么 $4$ 是最小的幸运数，而 $1$ 不是，但我们可以连续对 $1$ 做 $3$ 次 $+1$ 操作，使其变为 $4$，所以我们可以说， $1$幸运化后的结果是 $4$。

现在，小杨给出 $N$ 个数，请你首先判断它们是不是幸运数；接着，对于非幸运数，请你将它们幸运化。
## 输入格式

第一行 $2$ 个正整数 $a, N$。

接下来 $N$ 行，每行一个正整数 $x$ ，表示需要判断（幸运化）的数。
## 输出格式

输出 $N$ 行，对于每个给定的 $x$ ，如果它是幸运数，请输出 `lucky`，否则请输出将其幸运化后的结果。
## 样例

### 样例输入 #1
```
2 4 
1 
4 
5 
9
```
### 样例输出 #1
```
4 
lucky 
8 
lucky
```
### 样例输入 #2
```
16 11 
1 
2 
4 
8 
16 
32 
64 
128 
256 
512
1024
```
### 样例输出 #2
```
16 
16 
16 
16 
lucky 
lucky 
lucky 
lucky 
lucky 
lucky 
lucky
```
## 提示

**样例解释 1**

虽然是完全平方数，但它小于 $a$，因此它并不是超级幸运数，也不是幸运数。将其进行 $3$ 次 $+1$ 操作后，最终得到幸运数 $4$。4是幸运数，因此直接输出 `lucky` 。

$5$ 不是幸运数，将其进行 $3$ 次 $+1$ 操作后，最终得到幸运数 $8$。

$9$ 是幸运数，因此直接输出 `lucky` 。

**数据规模**

对于 $30\%$ 的测试点，保证 $a,x \le 100,N \le 100$。

对于 $60\%$ 的测试点，保证 $a,x \le 10^6$。

对于所有测试点，保证 $a \le 1,000,000$；保证 $N \le 2 \times 10^5$；保证 $1 \le x \le 1,000,001$。


---

---
title: "[GESP202403 五级] B-smooth 数"
layout: "post"
diff: 普及-
pid: B3969
tag: ['2024', '素数判断,质数,筛法', 'GESP']
---
# [GESP202403 五级] B-smooth 数
## 题目描述

小杨同学想寻找一种名为 $ B $-smooth 数的正整数。 

如果一个正整数的最大质因子不超过 $ B $，则该正整数为 $ B $-smooth 数。小杨同学想知道，对于给定的 $ n $ 和 $ B $，有多少个不超过 $ n $ 的 $ B $-smooth 数。
## 输入格式

第一行包含两个正整数 $ n $ 和 $ B $，含义如题面所示。
## 输出格式

输出一个非负整数，表示不超过 $ n $ 的 $ B $-smooth 数的数量。
## 样例

### 样例输入 #1
```
10 3
```
### 样例输出 #1
```
7
```
## 提示

### 数据规模与约定

| 子任务 | 得分 | $n \leq $ | $B$ |
| :-: | :-: | :-: | :-: |
| $1$ | $30$ | $10^3$ | $1 \leq B \leq 10^3$ |
| $2$ | $30$ | $10^6$ | $\sqrt n \leq B \leq 10^6$ |
| $3$ | $40$ | $10^6$ | $1 \leq B \leq 10^6$ | 

对全部的测试数据，保证 $1 \leq n, B \leq 10^6$。


---

---
title: "[信息与未来 2014] 连续非素数子序列的最大长度"
layout: "post"
diff: 普及-
pid: B4130
tag: ['2014', '江苏', '枚举', '素数判断,质数,筛法', '信息与未来']
---
# [信息与未来 2014] 连续非素数子序列的最大长度
## 题目描述

给出一个正整数 $n$，求在数列 $\{2,3,\cdots,n\}$
中，连续非素数子序列的最大长度。
## 输入格式

一个整数 $n$。
## 输出格式

一个整数，表示连续非素数子序列的最大长度。
## 样例

### 样例输入 #1
```
12
```
### 样例输出 #1
```
3
```
### 样例输入 #2
```
30
```
### 样例输出 #2
```
5
```
## 提示

### 样例 $\textbf1$ 解释
| 连续非素数子序列 | 长度 |
| :----------: | :----------: |
| $\{4\}$ | $1$ |
| $\{6\}$ | $1$ |
| $\{8,9,10\}$ | $3$ |
| $\{12\}$ | $1$ |

其中，最大长度为 $3$，即有连续的 $3$ 个非素数。
### 数据范围
$2\le n\le 5\times10^6$。


---

---
title: "[常州市赛 2024] 最小值"
layout: "post"
diff: 普及-
pid: B4224
tag: ['2024', '江苏', '素数判断,质数,筛法', '分支结构', '科创活动', '小学活动']
---
# [常州市赛 2024] 最小值
## 题目背景

搬运自 <http://czoj.com.cn/p/950>。数据为民间数据。
## 题目描述

素数是指一个大于 $1$ 的自然数，除了 $1$ 和它本身外，不能被其他自然数整除，换句话说就是该数除了 $1$ 和它本身以外不再有其他的因数。比如 $2,3,5,7,11,13\cdots$ 都是素数，而 $4,6,8,9,10\cdots$ 都是合数（有 $3$ 个以上因数）。特别地，$0$ 和 $1$ 既不是素数，也不是合数。

小 Y 想知道最小的素数，那当然是 $2$。不过他加上了一些限制，就是只通过某些数字构成的素数最小是多少？比如只通过 $3$ 构成的最小的素数是 $3$，只通过 $1$ 构成的最小的素数是 $11$，只通过 $8$ 和 $9$ 构成的最小的素数是 $89$ 等等。另外需要特别指出的是：给出的数字无须全部用到，比如只通过 $3$ 和 $5$ 构成的最小的素数是 $3$，而不是 $53$。
## 输入格式

第一行一个正整数 $n$，表示可以使用的数字的个数。

第二行 $n$ 个个位数字，表示可以使用哪些数字。
## 输出格式

一行一个素数表示构成的素数最小是多少，若是无法通过给出的数字构成素数，则输出 `-1`。


## 样例

### 样例输入 #1
```
2
3 5
```
### 样例输出 #1
```
3
```
### 样例输入 #2
```
1
1
```
### 样例输出 #2
```
11
```
### 样例输入 #3
```
3
8 0 9
```
### 样例输出 #3
```
89
```
### 样例输入 #4
```
4
2 3 4 5
```
### 样例输出 #4
```
2
```
## 提示

对于所有数据，$1\le n\le10$，保证可以使用的数字互不相同。

|测试点编号|$n$|
|:-:|:-:|
|$1\sim3$|$=1$|
|$4\sim7$|$=2$|
|$8\sim10$|$\le 10$|


---

---
title: "[朝阳区小学组 2019] factorization"
layout: "post"
diff: 普及-
pid: B4266
tag: ['2019', '北京', '素数判断,质数,筛法', '科创活动', '小学活动']
---
# [朝阳区小学组 2019] factorization
## 题目背景

数据为洛谷自造。
## 题目描述

Adleman 非常喜欢数学，最近他遇到了一个棘手的问题：对于一个正整数 $A$，Adleman 发现一些自然数的质因子分解式中没有大于 $A$ 的因子，这样的自然数非常的特殊。Adleman 想知道对于给定的正整数 $A$，一个区间 $[N, N+M]$ 内所有满足上述条件的自然数的个数。
## 输入格式

$3$ 个用空格分开的整数 $N,M,A$。
## 输出格式

一个整数，表示对于给定的正整数 $A$，区间 $[N, N+M]$ 内特殊自然数的个数。
## 样例

### 样例输入 #1
```
30 10 5
```
### 样例输出 #1
```
4
```
## 提示

### 样例解释

$[30, 40]$ 之间的数质因子分解式如下：
- $30=2\times 3\times 5$
- $31=1\times 31$
- $32=2\times 2\times 2\times 2\times 2$
- $33=3\times 11$
- $34=2\times 17$
- $35=5\times 7$
- $36=2\times 2\times 3\times 3$
- $37=1\times 37$
- $38=2\times 19$
- $39=3\times 13$
- $40=2\times 2\times 2\times 5$

其中 $30,32,36,40$ 的质因子分解式中没有大于 $5$ 的因子，所以一共有 $4$ 个。

### 数据范围

- $50\%$ 的数据满足：$1\leq N,M,A\leq 5000$；
- $100\%$ 的数据满足：$1\leq N,M,A≤50\,000$；


---

---
title: "[NOIP 2002 普及组] 选数"
layout: "post"
diff: 普及-
pid: P1036
tag: ['搜索', '2002', 'NOIP 普及组', '深度优先搜索 DFS', '素数判断,质数,筛法']
---
# [NOIP 2002 普及组] 选数
## 题目描述

已知 $n$ 个整数 $x_1,x_2,\cdots,x_n$，以及 $1$ 个整数 $k$（$k<n$）。从 $n$ 个整数中任选 $k$ 个整数相加，可分别得到一系列的和。例如当 $n=4$，$k=3$，$4$ 个整数分别为 $3,7,12,19$ 时，可得全部的组合与它们的和为：

$3+7+12=22$

$3+7+19=29$

$7+12+19=38$

$3+12+19=34$

现在，要求你计算出和为素数共有多少种。

例如上例，只有一种的和为素数：$3+7+19=29$。
## 输入格式

第一行两个空格隔开的整数 $n,k$（$1 \le n \le 20$，$k<n$）。

第二行 $n$ 个整数，分别为 $x_1,x_2,\cdots,x_n$（$1 \le x_i \le 5\times 10^6$）。

## 输出格式

输出一个整数，表示种类数。
## 样例

### 样例输入 #1
```
4 3
3 7 12 19

```
### 样例输出 #1
```
1

```
## 提示

**【题目来源】**

NOIP 2002 普及组第二题


---

---
title: "阶乘分解"
layout: "post"
diff: 普及-
pid: P10495
tag: ['素数判断,质数,筛法']
---
# 阶乘分解
## 题目描述

给定整数 $N (3 \le N \le 10^6)$，试把阶乘 $N!$ 分解质因数，按照算术基本定理的形式输出分解结果中的 $p_i$ 和 $c_i$ 即可。

## 输入格式

一个整数 $N$。

## 输出格式

$N!$ 分解质因数后的结果，共若干行，每行一对 $p_i, c_i$，表示含有 $p_i^{c_i}$ 项。按照 $p_i$ 从小到大的顺序输出。

## 样例

### 样例输入 #1
```
5
```
### 样例输出 #1
```
2 3
3 1
5 1
```


---

---
title: "[NOIP 2012 普及组] 质因数分解"
layout: "post"
diff: 普及-
pid: P1075
tag: ['数学', '2012', 'NOIP 普及组', '素数判断,质数,筛法']
---
# [NOIP 2012 普及组] 质因数分解
## 题目描述

已知正整数 $n$ 是两个不同的质数的乘积，试求出两者中较大的那个质数。

## 输入格式

输入一个正整数 $n$。

## 输出格式

输出一个正整数 $p$，即较大的那个质数。

## 样例

### 样例输入 #1
```
21
```
### 样例输出 #1
```
7
```
## 提示

$1 \le n\le 2\times 10^9$

NOIP 2012 普及组 第一题



---

---
title: "[NOIP 2008 提高组] 笨小猴"
layout: "post"
diff: 普及-
pid: P1125
tag: ['2008', 'NOIP 提高组', '素数判断,质数,筛法']
---
# [NOIP 2008 提高组] 笨小猴
## 题目描述

笨小猴的词汇量很小，所以每次做英语选择题的时候都很头疼。但是他找到了一种方法，经试验证明，用这种方法去选择选项的时候选对的几率非常大！

这种方法的具体描述如下：假设 $\text{maxn}$ 是单词中出现次数最多的字母的出现次数，$\text{minn}$ 是单词中出现次数最少的字母的出现次数，如果 $\text{maxn}-\text{minn}$ 是一个质数，那么笨小猴就认为这是个 Lucky Word，这样的单词很可能就是正确的答案。

## 输入格式

一个单词，其中只可能出现小写字母，并且长度小于 $100$。

## 输出格式

共两行，第一行是一个字符串，假设输入的的单词是 Lucky Word，那么输出 `Lucky Word`，否则输出 `No Answer`；

第二行是一个整数，如果输入单词是 `Lucky Word`，输出 $\text{maxn}-\text{minn}$ 的值，否则输出 $0$。

## 样例

### 样例输入 #1
```
error
```
### 样例输出 #1
```
Lucky Word
2
```
### 样例输入 #2
```
olympic
```
### 样例输出 #2
```
No Answer
0
```
## 提示

【输入输出样例 1 解释】

单词 `error` 中出现最多的字母 $\texttt r$ 出现了 $3$ 次，出现次数最少的字母出现了 $1$ 次，$3-1=2$，$2$ 是质数。

【输入输出样例 2 解释】

单词 `olympic` 中出现最多的字母 $\texttt i$ 出现了 $1$ 次，出现次数最少的字母出现了 $1$ 次，$1-1=0$，$0$ 不是质数。

（本处原题面错误已经修正）

noip2008 提高第一题



---

---
title: "「TPOI-1A」鞋子特大号"
layout: "post"
diff: 普及-
pid: P11747
tag: ['数学', '贪心', 'O2优化', '素数判断,质数,筛法']
---
# 「TPOI-1A」鞋子特大号
## 题目背景

![](https://cdn.luogu.com.cn/upload/image_hosting/71n3gd2r.png)

You may click here to read English statement.

> 我戴着圆顶礼帽 鞋子特大号
>
> 我手拿拐杖留着胡子 大家好
>
> 别什么你都想要快乐却找不到
>
> 幽默是挫折中优雅的礼貌
>
> ——周杰伦《[鞋子特大号](https://www.bilibili.com/video/BV1Wt4y1P74C)》
## 题目描述

给定一个数 $x$，你可以对其进行以下操作若干次，直到无法再操作：

- 选择一个数 $y$ 满足 $1 \le y < x$ 且 $\gcd(x,y) \not = 1$，并将 $x$ 变为 $\gcd(x,y)$。

现在有以下两种询问共 $T$ 个：

- `1 x`：给定 $x$，求 $x$ 最多能进行几次操作；

- `2 q`：给定 $q$，求出一个**最小的** $x$，使得 $x$ 最多能进行恰好 $q$ 次操作。

## 输入格式

第一行，一个整数 $T$，表示询问个数。

接下来 $T$ 行，每行一次询问，保证格式一定为 `1 x` 或 `2 q`。
## 输出格式

共 $T$ 行，每行一个整数，表示询问的答案。
## 样例

### 样例输入 #1
```
2
1 2310
2 6
```
### 样例输出 #1
```
4
128
```
## 提示

【样例 #1 解释】

对于 `1 2310`，以下是其中一种操作方式：

- 选择 $y=1890$，则此时 $x=\gcd(2310,1890)=210$；
- 选择 $y=84$，则此时 $x=\gcd(210,84)=42$；
- 选择 $y=18$，则此时 $x=\gcd(42,18)=6$；
- 选择 $y=2$，则此时 $x=\gcd(6,2)=2$。

此时无法再操作，所以结果为 $4$。

可以证明不存在一种方法可以操作超过 $4$ 次。

---

对于 `2 6`，可以证明，无法找出一个比 $128$ 小的数，使得其可以进行 $6$ 次操作。

【数据范围】

**本题采用捆绑测试。你只有通过一个子任务内的所有测试点，该子任务才会得分。**

|$\text{Subtask}$|特殊性质|分值|
|:-:|:-:|:-:|
|$0$|样例|$0$|
|$1$|$T \le 2,2 \le x \le 100,q \le 5$|$40$|
|$2$|$T \le 10^5,x \le 10^3,q \le 25$|$30$|
|$3$|无特殊性质|$30$|

对于 $100\%$ 的数据，$1 \le T \le 10^5$，$1 \le x \le 10^6$，$1 \le q \le 62$。


---

---
title: "[蓝桥杯 2025 省 Java B] 魔法科考试"
layout: "post"
diff: 普及-
pid: P12157
tag: ['2025', '素数判断,质数,筛法', '蓝桥杯省赛']
---
# [蓝桥杯 2025 省 Java B] 魔法科考试
## 题目描述

小明正在参加魔法科的期末考试，考生需要根据给定的口诀组合出有效的魔法。其中，老师给定了 $n$ 个上半部分口诀 $a_1, a_2, \dots , a_n$ 和 $m$ 个下半部分口诀 $b_1, b_2, \dots , b_m$，均用整数表示。完整的口诀包含一个上半部分口诀和一个下半部分口诀，当选用两个口诀 $a_i$ 和 $b_j$，将组合出完整口诀 $S = a_i + b_j$。

当 $S$ 满足 $S \leq n + m$ 且 $S$ 为质数时，魔法是有效的。魔法的种类只和 $S$ 的大小有关。如果每个上半部分口诀和每个下半部分口诀在不同的组合中可以重复使用，小明想知道一共可能组合出多少种不同的有效魔法？
## 输入格式

输入共三行。
- 第一行为两个正整数 $n, m$。
- 第二行为 $n$ 个由空格分开的正整数 $a_1, a_2, \dots , a_n$。
- 第三行为 $m$ 个由空格分开的正整数 $b_1, b_2, \dots , b_m$。
## 输出格式

输出共 $1$ 行，一个整数表示答案。
## 样例

### 样例输入 #1
```
3 4
2 3 10
3 4 5 1
```
### 样例输出 #1
```
3
```
## 提示

### 样例说明

可以组合出 $3,5,7$ 这三个有效魔法。

### 评测用例规模与约定

- 对于 $20\%$ 的评测用例，$n, m \leq 200$。
- 对于 $60\%$ 的评测用例，$n, m \leq 2000$。
- 对于 $100\%$ 的评测用例，$1\leq n, m \leq 20000$，$1\leq a_i, b_i \leq 20000$。


---

---
title: "[USACO1.5] 回文质数 Prime Palindromes"
layout: "post"
diff: 普及-
pid: P1217
tag: ['USACO', '素数判断,质数,筛法']
---
# [USACO1.5] 回文质数 Prime Palindromes
## 题目描述

因为 $151$ 既是一个质数又是一个回文数（从左到右和从右到左是看一样的），所以 $151$ 是回文质数。

写一个程序来找出范围 $[a,b] (5 \le a < b \le 100,000,000)$（一亿）间的所有回文质数。
## 输入格式

第一行输入两个正整数 $a$ 和 $b$。
## 输出格式

输出一个回文质数的列表，一行一个。

## 样例

### 样例输入 #1
```
5 500

```
### 样例输出 #1
```
5
7
11
101
131
151
181
191
313
353
373
383

```
## 提示

Hint 1: Generate the palindromes and see if they are prime.

提示 1: 找出所有的回文数再判断它们是不是质数（素数）.


Hint 2: Generate palindromes by combining digits properly. You might need more than one of the loops like below.

提示 2: 要产生正确的回文数，你可能需要几个像下面这样的循环。


题目翻译来自NOCOW。

USACO Training Section 1.5


产生长度为 $5$ 的回文数：

```cpp
for (d1 = 1; d1 <= 9; d1+=2) {    // 只有奇数才会是素数
     for (d2 = 0; d2 <= 9; d2++) {
         for (d3 = 0; d3 <= 9; d3++) {
           palindrome = 10000*d1 + 1000*d2 +100*d3 + 10*d2 + d1;//(处理回文数...)
         }
     }
 }

```


---

---
title: "[USACO1.5] 特殊的质数肋骨 Superprime Rib"
layout: "post"
diff: 普及-
pid: P1218
tag: ['数学', '递推', 'USACO', '素数判断,质数,筛法']
---
# [USACO1.5] 特殊的质数肋骨 Superprime Rib
## 题目描述

农民约翰的母牛总是产生最好的肋骨。你能通过农民约翰和美国农业部标记在每根肋骨上的数字认出它们。 

农民约翰确定他卖给买方的是真正的质数肋骨，是因为从右边开始切下肋骨，每次还剩下的肋骨上的数字都组成一个质数。  

举例来说：$7\ 3\ 3\ 1$ 全部肋骨上的数字 $7331$ 是质数；三根肋骨 $733$ 是质数；二根肋骨 $73$ 是质数；当然,最后一根肋骨 $7$ 也是质数。$7331$ 被叫做长度 $4$ 的特殊质数。  

写一个程序对给定的肋骨的数目 $n$，求出所有的特殊质数。$1$ 不是质数。
## 输入格式

一行一个正整数 $n$。


## 输出格式

按顺序输出长度为 $n$ 的特殊质数,每行一个。

## 样例

### 样例输入 #1
```
4

```
### 样例输出 #1
```
2333
2339
2393
2399
2939
3119
3137
3733
3739
3793
3797
5939
7193
7331
7333
7393

```
## 提示

【数据范围】  
对于 $100\%$ 的数据，$1\le n \le 8$。

题目翻译来自NOCOW。

USACO Training Section 1.5



---

---
title: "哥德巴赫猜想（升级版）"
layout: "post"
diff: 普及-
pid: P1579
tag: ['数学', '枚举', '素数判断,质数,筛法']
---
# 哥德巴赫猜想（升级版）
## 题目背景

1742 年 6 月 7 日，哥德巴赫写信给当时的大数学家欧拉，正式提出了以下的猜想：任何一个大于 $9$ 的奇数都可以表示成 $3$ 个质数之和。质数是指除了 $1$ 和本身之外没有其他约数的数，如 $2$ 和 $11$ 都是质数，而 $6$ 不是质数，因为 $6$ 除了约数 $1$ 和 $6$ 之外还有约数 $2$ 和 $3$。**需要特别说明的是 $1$ 不是质数。**

这就是哥德巴赫猜想。欧拉在回信中说，他相信这个猜想是正确的，但他不能证明。

从此，这道数学难题引起了几乎所有数学家的注意。哥德巴赫猜想由此成为数学皇冠上一颗可望不可及的“明珠”。
## 题目描述

现在请你编一个程序验证哥德巴赫猜想。

先给出一个奇数 $n$，要求输出 $3$ 个质数，这 $3$ 个质数之和等于输入的奇数。
## 输入格式

仅有一行，包含一个正奇数 $n$，其中 $9 < n < 20000$。
## 输出格式

仅有一行，输出 $3$ 个质数，这 $3$ 个质数之和等于输入的奇数。相邻两个质数之间用一个空格隔开，最后一个质数后面没有空格。如果表示方法不唯一，请输出第一个质数最小的方案，如果第一个质数最小的方案不唯一，请输出第一个质数最小的同时，第二个质数最小的方案。
## 样例

### 样例输入 #1
```
2009
```
### 样例输出 #1
```
3 3 2003
```


---

---
title: "A+B Problem（升级版）"
layout: "post"
diff: 普及-
pid: P1581
tag: ['模拟', '字符串', '高精度', '素数判断,质数,筛法']
---
# A+B Problem（升级版）
## 题目背景

小明这在写作业，其中有一道A+B Problem ，他想啊想啊想，就是想不出来，于是就找到了会编程的你......

## 题目描述

这里的 $A+B$ 是很奇特的。它是按质数的顺序来进位的。例如：$1,0+2,1$ ＝ $1,0,1$（用 $\verb!,!$ 来分隔每一位）。个位是 $2$ 进制，十位是 $3$ 进制，百位是 $5$ 进制，千位是 $7$ 进制，万位是 $11$ 进制……两个加数的最高位是万位（万位可能有两位）。
## 输入格式

输入一个形如 $1,0+2,1$ 字符串 $s$。
## 输出格式

输出相加后的结果。


## 样例

### 样例输入 #1
```
1,0+2,1
```
### 样例输出 #1
```
1,0,1
```


---

---
title: "A+B Problem（再升级）"
layout: "post"
diff: 普及-
pid: P1832
tag: ['动态规划 DP', '数学', '递推', '洛谷原创', '背包 DP', '素数判断,质数,筛法']
---
# A+B Problem（再升级）
## 题目背景

题目名称是吸引你点进来的。

实际上该题还是很水的。

## 题目描述

- $1+1=?$ 显然是 $2$。
- $a+b=?$ P1001 回看不谢。
- 哥德巴赫猜想 似乎已呈泛滥趋势。

_以上纯属个人吐槽_

给定一个正整数 $n$，求将其分解成若干个素数之和的方案总数。


## 输入格式

一行一个正整数 $n$。

## 输出格式

一行一个整数表示方案总数。
## 样例

### 样例输入 #1
```
7
```
### 样例输出 #1
```
3
```
### 样例输入 #2
```
20
```
### 样例输出 #2
```
26
```
## 提示

### 样例解释

存在如下三种方案：

- $7=7$。
- $7=2+5$。
- $7=2+2+3$。

### 数据范围及约定

- 对于 $30\%$ 的数据 $1\le n\le 10$。
- 对于 $100\%$ 的数据，$1\le n\le 10^3$。



---

---
title: "[AHOI2001] 质数和分解"
layout: "post"
diff: 普及-
pid: P2563
tag: ['2001', '各省省选', '安徽', '背包 DP', '素数判断,质数,筛法']
---
# [AHOI2001] 质数和分解
## 题目描述

任何大于 $1$ 的自然数 $n$ 都可以写成若干个大于等于 $2$ 且小于等于 $n$ 的质数之和表达式(包括只有一个数构成的和表达式的情况)，并且可能有不止一种质数和的形式。例如，$9$ 的质数和表达式就有四种本质不同的形式：

$9 = 2 + 5 + 2 = 2 + 3 + 2 + 2 = 3 + 3 + 3 = 2 + 7$ 。

这里所谓两个本质相同的表达式是指可以通过交换其中一个表达式中参加和运算的各个数的位置而直接得到另一个表达式。

试编程求解自然数 $n$ 可以写成多少种本质不同的质数和表达式。

## 输入格式

文件中的每一行存放一个自然数 $n(2 \leq n \leq 200)$ 。

## 输出格式

依次输出每一个自然数 $n$ 的本质不同的质数和表达式的数目。

## 样例

### 样例输入 #1
```
2
200
```
### 样例输出 #1
```
1
9845164
```


---

---
title: "斐波那契数列（升级版）"
layout: "post"
diff: 普及-
pid: P2626
tag: ['模拟', '递推', '素数判断,质数,筛法']
---
# 斐波那契数列（升级版）
## 题目背景

大家都知道，斐波那契数列是满足如下性质的一个数列： 

- $f(1) = 1$
- $f(2) = 1$ 
- $f(n) = f(n-1) + f(n-2)$（$n > 2$ 且 $n$ 为整数）。

## 题目描述

请你求出第 $n$ 个斐波那契数列的数 $\bmod\,2^{31}$ 之后的值，并把它分解质因数。

## 输入格式

输入一个正整数 $n$。
## 输出格式

把第 $n$ 个斐波那契数列的数分解质因数。

## 样例

### 样例输入 #1
```
5
```
### 样例输出 #1
```
5=5
```
### 样例输入 #2
```
6
```
### 样例输出 #2
```
8=2*2*2
```
## 提示

$n \le 48$


---

---
title: "【模板】线性筛素数"
layout: "post"
diff: 普及-
pid: P3383
tag: ['数学', 'O2优化', '素数判断,质数,筛法']
---
# 【模板】线性筛素数
## 题目背景

本题已更新，从判断素数改为了查询第 $k$ 小的素数  
提示：如果你使用  `cin` 来读入，建议使用 `std::ios::sync_with_stdio(0)` 来加速。
## 题目描述

如题，给定一个范围 $n$，有 $q$ 个询问，每次输出第 $k$ 小的素数。

## 输入格式

第一行包含两个正整数 $n,q$，分别表示查询的范围和查询的个数。

接下来 $q$ 行每行一个正整数 $k$，表示查询第 $k$ 小的素数。
## 输出格式

输出 $q$ 行，每行一个正整数表示答案。
## 样例

### 样例输入 #1
```
100 5
1
2
3
4
5
```
### 样例输出 #1
```
2
3
5
7
11
```
## 提示

【数据范围】  
对于 $100\%$ 的数据，$n = 10^8$，$1 \le q \le 10^6$，保证查询的素数不大于 $n$。

Data by NaCly\_Fish.



---

---
title: "素数个数"
layout: "post"
diff: 普及-
pid: P3912
tag: ['数学', '枚举', '素数判断,质数,筛法']
---
# 素数个数
## 题目描述

求 $1,2,\cdots,N$ 中素数的个数。

## 输入格式

一行一个整数 $N$。

## 输出格式

一行一个整数，表示素数的个数。

## 样例

### 样例输入 #1
```
10
```
### 样例输出 #1
```
4
```
## 提示

对于 $40\%$ 的数据，$1 \le N \le 10^6$。

对于 $80\%$ 的数据，$1 \le N \le 10^7$。

对于 $100\%$ 的数据，$1 \le N \le 10^8$。



---

---
title: "【深基4.例13】质数口袋"
layout: "post"
diff: 普及-
pid: P5723
tag: ['素数判断,质数,筛法']
---
# 【深基4.例13】质数口袋
## 题目描述

小 A 有一个质数口袋，里面可以装各个质数。他从 $2$ 开始，依次判断各个自然数是不是质数，如果是质数就会把这个数字装入口袋。

口袋的负载量就是口袋里的所有数字之和。

但是口袋的承重量有限，装的质数的和不能超过 $L$。给出 $L$，请问口袋里能装下几个质数？将这些质数从小往大输出，然后输出最多能装下的质数的个数，数字之间用换行隔开。
## 输入格式

一行一个正整数 $L$。
## 输出格式

将这些质数从小往大输出，然后输出最多能装下的质数个数。
## 样例

### 样例输入 #1
```
100
```
### 样例输出 #1
```
2
3
5
7
11
13
17
19
23
9
```
### 样例输入 #2
```
5
```
### 样例输出 #2
```
2
3
2
```
### 样例输入 #3
```
11
```
### 样例输出 #3
```
2
3
5
3
```
## 提示

数据保证，$1 \le L \le {10}^5$。


---

---
title: "[COCI 2019/2020 #1] Lutrija"
layout: "post"
diff: 普及-
pid: P7200
tag: ['2019', 'Special Judge', '深度优先搜索 DFS', '素数判断,质数,筛法', 'COCI（克罗地亚）']
---
# [COCI 2019/2020 #1] Lutrija
## 题目背景

Vedran 在赌输彩票之后，无意之间打开了 COCI 的频道。只要完成 COCI 给出的任务，他就能够免除前往新加坡 IOI2020 现场的费用。

不幸的是，Vedran 已经老了，于是你决定帮帮他。
## 题目描述

给定两个素数 $A,B$。你需要给出一个开头和结尾分别为 $A$ 和 $B$ 的序列，使得其所有元素均为素数，并且相邻两个元素之间的差值也为素数。
## 输入格式

输入两个素数 $A,B$。
## 输出格式

如果任务不可能完成，即没有满足条件的序列（以下称为有解），则只输出 `-1`。

否则，在第一行输出序列的元素个数，并在第二行输出所有元素。

如果有解，则你的构造必须满足下列二者之一：

- 序列元素个数不超过 $30$
- 任何一个元素都不超过 $10^{15}$。

如果有多组解，则输出任意一种。
## 样例

### 样例输入 #1
```
13 11
```
### 样例输出 #1
```
2
13 11
```
### 样例输入 #2
```
37 11
```
### 样例输出 #2
```
-1
```
### 样例输入 #3
```
2 17
```
### 样例输出 #3
```
3
2 19 17
```
## 提示

#### 数据规模及约定

对于 $20\%$ 的数据，如果有解，则必定有一种解，满足元素的个数不超过 $3$，且其中的所有元素都不超过 $1000$。

对于另外 $40\%$ 的数据，$2 \le A,B \le 1000$。

对于 $100\%$ 的数据，$2 \le A,B \le 10^{14},A \neq B$。

#### 说明

**本题分值按 COCI 原题设置，满分 $70$。**

由于平均下来每个测试点为 $2.5$ 分，因而将其中一半的测试点设置为 $2$ 分，另一半设置为 $3$ 分。

本题使用非官方的 [Special Judge](https://www.luogu.com.cn/paste/hrj05be5)，欢迎大家 hack（可私信或直接发帖）。

**题目译自 [COCI2019-2020](https://hsin.hr/coci/archive/2019_2020/) [CONTEST #1](https://hsin.hr/coci/archive/2019_2020/contest1_tasks.pdf)  _T2 Lutrija_ 。**


---

---
title: "[蓝桥杯 2021 省 AB2] 完全平方数"
layout: "post"
diff: 普及-
pid: P8754
tag: ['2021', '数论', '素数判断,质数,筛法', '蓝桥杯省赛']
---
# [蓝桥杯 2021 省 AB2] 完全平方数
## 题目描述

一个整数 $a$ 是一个完全平方数，是指它是某一个整数的平方，即存在一个 整数 $b$，使得 $a=b^{2}$ 。

给定一个正整数 $n$，请找到最小的正整数 $x$，使得它们的乘积是一个完全平方数。
## 输入格式

输入一行包含一个正整数 $n$。
## 输出格式

输出找到的最小的正整数 $x$。
## 样例

### 样例输入 #1
```
12
```
### 样例输出 #1
```
3
```
### 样例输入 #2
```
15
```
### 样例输出 #2
```
15 
```
## 提示

对于 $30 \%$ 的评测用例, $1 \leq n \leq 1000$，答案不超过 $1000$。

对于 $60 \%$ 的评测用例，$1 \leq n \leq 10^{8}$，答案不超过 $10^{8}$。

对于所有评测用例，$1 \leq n \leq 10^{12}$，答案不超过 $10^{12}$。

蓝桥杯 2021 第二轮省赛 A 组 G 题（B 组 H 题）。


---


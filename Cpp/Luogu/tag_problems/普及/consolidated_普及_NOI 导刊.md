---
title: "最接近神的人"
layout: "post"
diff: 普及/提高-
pid: P1774
tag: ['线段树', '树状数组', '递归', 'NOI 导刊', '排序']
---
# 最接近神的人
## 题目描述

破解了符文之语，小 FF 开启了通往地下的道路。当他走到最底层时，发现正前方有一扇巨石门，门上雕刻着一幅古代人进行某种活动的图案。而石门上方用古代文写着“神的殿堂”。小 FF 猜想里面应该就有王室的遗产了。但现在的问题是如何打开这扇门……。

仔细研究后，他发现门上的图案大概是说：古代人认为只有智者才是最容易接近神明的。而最聪明的人往往通过一种仪式选拔出来。仪式大概是指，即将隐退的智者为他的候选人写下一串无序的数字，并让他们进行一种操作，即交换序列中相邻的两个元素。而用最少的交换次数使原序列变成不下降序列的人即是下一任智者。

小 FF 发现门上同样有着 $n$ 个数字。于是他认为打开这扇门的秘诀就是找到让这个序列变成不下降序列所需要的最小次数。但小 FF 不会……只好又找到了你，并答应事成之后与你三七分……
## 输入格式

第一行为一个整数 $n$，表示序列长度。

第二行为 $n$ 个整数，表示序列中每个元素。
## 输出格式

一个整数 $\mathit{ans}$，即最少操作次数。

## 样例

### 样例输入 #1
```
4
2 8 0 3

```
### 样例输出 #1
```
3
```
## 提示

### 数据范围及约定

- 对于 $30\%$ 的数据 $1≤n≤10^4$。
- 对于 $100\%$ 的数据 $1≤n≤5\times 10^5$，$A_i\in [-2^{31}, 2^{31})$。

### 样例解释

开始序列为 $[2,8,0,3]$，目标序列为 $[0, 2, 3, 8]$，可进行三次操作的目标序列：

1. 交换 $(8,0)$，序列变成 $[2,0,8,3]$；
2. 交换 $(2,0)$，序列变成 $[0,2,8,3]$；
3. 交换 $(8,3)$，序列变成 $[0,2,3,8]$。



---

---
title: "跑步"
layout: "post"
diff: 普及/提高-
pid: P1793
tag: ['NOI 导刊']
---
# 跑步
## 题目描述

新牛到部队，CG 要求它们每天早上搞晨跑，从 $A$ 农场跑到 $B$ 农场。从 $A$ 农场到 $B$ 农场中有 $n-2$ 个路口，分别标上号，$A$ 农场为 $1$ 号，$B$ 农场为 $n$ 号，路口分别为 $2,3,4,\cdots,n-1$ 号，从 $A$ 农场到 $B$ 农场有很多条路径可以到达，而 CG 发现有的路口是必须经过的，即每条路径都经过的路口，CG 要把它们记录下来，这样 CG 就可以先到那个路口，观察新牛们有没有偷懒，而你的任务就是找出所有必经路口。
## 输入格式

第一行两个用空格隔开的整数 $n\ (3 \le n \le 2000)$ 和 $e\ (1 \le e \le 8000)$。

接下来从第 $2$ 到第 $e+1$ 行，每行两个用空格隔开的整数 $p$ 和 $q$，表示路口 $p$ 和 $q$ 之间有路径直达。

输入数据保证必经路口一定存在，并且每个路口都和 $A$ 农场、$B$ 农场相连通。
## 输出格式

第一行一个整数 $m$，表示必经路口的数目。

第二行按从小到大的顺序依次输出每个必经路口的编号，每两个数之间用一个空格隔开。
## 样例

### 样例输入 #1
```
6 6

1 2

2 4

2 3

3 5

4 5

5 6


```
### 样例输出 #1
```
2

2 5


```


---

---
title: "装备运输"
layout: "post"
diff: 普及/提高-
pid: P1794
tag: ['动态规划 DP', 'NOI 导刊', '背包 DP']
---
# 装备运输
## 题目描述

德国放松对英国的进攻后，把矛头指向了东边——苏联。$1943$ 年初，东线的战斗进行到白热化阶段。据可靠情报，$90$ 余万德国军队在库尔斯克准备发动浩大攻势。因此，朱可夫元帅要求你立即从远东的军工厂运输大量装备支援库尔斯克前线。列车司机告诉你，一趟列车最多可以容纳 $V$ 体积的武器装备，但是你可能不能装满，因为列车承受不了那么大的重量，一趟列车最多可以承载 $G$ 单位的重量。同时，军工厂仓库提供给你一份装备清单，详细记录了每件装备的体积、重量和火力。为了有效支援朱可夫元帅，你要找到一种方案，使得总火力值最大。
## 输入格式

第一行两个整数 $V$ 和 $G$，表示最大体积和重量。

第二行一个整数 $N$，表示仓库有 $N$ 件装备。

第三到 $N+2$ 行，每行 $3$ 个数 $T_i,V_i,G_i$，表示各装备的火力值、体积和重量。
## 输出格式

输出一个数，表示可能获得的最大火力值。

## 样例

### 样例输入 #1
```
6 5 
4
10 2 2
20 3 2 
40 4 3 
30 3 3 

```
### 样例输出 #1
```
50

```
## 提示

对于 $100\%$ 的数据，$1\le V, G, N \le 500$，$1 \leq T_i, V_i, G_i \leq 10^9$。


---

---
title: "小明搬家"
layout: "post"
diff: 普及/提高-
pid: P1798
tag: ['NOI 导刊']
---
# 小明搬家
## 题目描述

小明要搬家了，大家都来帮忙。

小明现在住在第 $N$ 楼，总共 $K$ 个人要把 $M$ 个大箱子搬上 $N$ 楼。

最开始 $M$ 个箱子都在 $1$ 楼，但是经过一段混乱的搬运已经乱掉了。最后大家发现这样混乱地搬运过程效率太低了，于是总结出了提高效率的方法。

大家的速度都是每分钟上（或下）一层楼。所有向上走的人手中都拿一个箱子，所有向下走的人手中都不拿箱子。到达第 $N$ 层立刻放下箱子向下走，到达第 $1$ 层立刻拿起箱子向上走。当一个人向上走，另一人向下走而在楼道里相遇时，向上走的人将手中的箱子交给另一人，两人同时反向。即原来拿箱子向上走的人不拿箱子向下走，原来不拿箱子向下走的人现拿着箱子向上走。

求将所有箱子搬完所需的最短时间。
## 输入格式

第一行 $N, K, M$，分别表示楼层数、人数、还放在一楼地上的箱子数。

接下来 $K$ 行，每行两个数 $A_i,B_i$。

$A_i$ 表示第 $i$ 人现所在的楼层数，$B_i$ 为 $0$ 或 $1$，为 $0$ 表示第 $i$ 人正拿着箱子向上走，为 $1$ 表示第 $i$ 人不拿箱子向下走。

输入满足没有任意两人正在同一楼层，在第 $1$ 层的人一定正拿着箱子向上走，在第 $N$ 层的人一定正不拿箱子向下走。
## 输出格式

仅包含一个整数，为搬完箱子的时间。

## 样例

### 样例输入 #1
```
5 2 4

1 0

3 0


```
### 样例输出 #1
```
20
```
## 提示

对于 $30\%$ 的数据，$K \leq 100$，$M \leq 100$；

对于 $60\%$ 的数据，$K \leq 1000$，$M \leq 10^9$;

对于 $100\%$ 的数据，$N \le 10^9$，$K \le 5 \times 10^5$，$M \le 10^9$。


---

---
title: "跑步"
layout: "post"
diff: 普及/提高-
pid: P1806
tag: ['动态规划 DP', '数学', 'NOI 导刊', '组合数学']
---
# 跑步
## 题目描述

路人甲准备跑 $n$ 圈来锻炼自己的身体，他准备分多次（$\gt1$）跑完，每次都跑正整数圈，然后休息下再继续跑。

为了有效地提高自己的体能，他决定每次跑的圈数都必须比上次跑的多。

可以假设他刚开始跑了 $0$ 圈，那么请问他可以有多少种跑完这 $n$ 圈的方案？
## 输入格式

一行一个整数，代表 $n$。
## 输出格式

一个整数表示跑完这 $n$ 圈的方案数。
## 样例

### 样例输入 #1
```
212
```
### 样例输出 #1
```
995645335
```
## 提示

#### 数据规模与约定

对于 $100\%$ 的数据，保证 $5\le n\le 500$。


---

---
title: "最长路"
layout: "post"
diff: 普及/提高-
pid: P1807
tag: ['图论', 'NOI 导刊', '广度优先搜索 BFS', '拓扑排序']
---
# 最长路
## 题目描述

设 $G$ 为有 $n$ 个顶点的带权有向无环图，$G$ 中各顶点的编号为 $1$ 到 $n$，请设计算法，计算图 $G$ 中 $1, n$ 间的最长路径。
## 输入格式

输入的第一行有两个整数，分别代表图的点数 $n$ 和边数 $m$。

第 $2$ 到第 $(m + 1)$ 行，每行 $3$ 个整数 $u, v, w$（$u<v$），代表存在一条从 $u$ 到  $v$ 边权为 $w$ 的边。
## 输出格式

输出一行一个整数，代表 $1$ 到 $n$ 的最长路。

若 $1$ 无法到达 $n$，请输出 $-1$。
## 样例

### 样例输入 #1
```
2 1
1 2 1
```
### 样例输出 #1
```
1
```
## 提示

**【数据规模与约定】**

- 对于 $20\%$的数据，$n \leq 100$，$m \leq 10^3$。
- 对于 $40\%$ 的数据，$n \leq 10^3$，$m \leq 10^{4}$。
- 对于 $100\%$ 的数据，$1 \leq n \leq 1500$，$0 \leq m \leq 5 \times 10^4$，$1 \leq u, v \leq n$，$-10^5 \leq w \leq 10^5$。


---

---
title: "素数密度"
layout: "post"
diff: 普及/提高-
pid: P1835
tag: ['NOI 导刊', '枚举', '素数判断,质数,筛法']
---
# 素数密度
## 题目背景

UPD:

- 2024.8.12：加入一组 Hack 数据。
## 题目描述

 给定 $L,R$，请计算区间 $[L,R]$ 中素数的个数。

   $1\leq L\leq R < 2^{31}$，$R-L\leq 10^6$。
## 输入格式

第一行，两个正整数 $L$ 和 $R$。
## 输出格式

一行，一个整数，表示区间中素数的个数。

## 样例

### 样例输入 #1
```
2 11
```
### 样例输出 #1
```
5
```


---

---
title: "Play with Power"
layout: "post"
diff: 普及/提高-
pid: P1839
tag: ['NOI 导刊']
---
# Play with Power
## 题目描述

Masha 和 Stas 正在玩一个游戏。在游戏的开始，给出一个数  $n$，同时有两个正整数  $a,b$，初始时满足 $a^b\le n$。

Masha 先手。每一回合，玩家要将 $a,b$ 的其中一个数加上  $1$，但不能使 $a^b>n$，否则该玩家输。

现在，Masha 想知道，假如两人都使用最优策略，对于同一个 $n$ 和不同的 $a,b$，谁将获胜呢？

## 输入格式

第一行一个数  $n$。

第二行一个数  $t$，表示数据组数。

接下来  $t$ 行，每行两个数  $a,b$，描述每组数据。

## 输出格式

共  $t$ 行，对于每组数据：

- 若 Masha 获胜，输出 `Masha`。
- 若 Stas 获胜，输出 `Stas`。
- 若平手，输出 `Missing`。
## 样例

### 样例输入 #1
```
9 

2 

2  2 

1  4 
```
### 样例输出 #1
```
Masha 

Missing
```
## 提示

#### 数据规模与约定

- 对于  $30\%$ 的数据，有  $1\le n\le 2\cdot10^3$。
- 对于  $100\%$ 的数据，有  $1\le n\le 10^8$， $1\le t\le 100$， $1\le a,b,a^b\le n$。


---

---
title: "Color the Axis"
layout: "post"
diff: 普及/提高-
pid: P1840
tag: ['并查集', 'NOI 导刊']
---
# Color the Axis
## 题目描述

在一条数轴上有 $n$ 个点，分别是 $1,2,\ldots,n$。一开始所有的点都被染成黑色。接着我们进行 $m$ 次操作，第 $i$ 次操作将 $[l_i,r_i]$ 这些点染成白色。请输出每个操作执行后剩余黑色点的个数。
## 输入格式

输入一行为 $n$ 和 $m$。下面 $m$ 行每行两个数 $l_i$，$r_i$。
## 输出格式

输出 $m$ 行，为每次操作后剩余黑色点的个数。
## 样例

### 样例输入 #1
```
10 3   
3 3   
5 7   
2 8     
```
### 样例输出 #1
```
9     
6     
3
```
## 提示

- 对于 $30\%$ 的数据，有 $1\le n\le2000$，$1\le m\le2000$；
- 对于 $100\%$ 的数据，有 $1\le l_i\le r_i\le n\le 2\times 10^5$，$1\le m\le 2\times10^5$。


---

---
title: "影像之结构化特征"
layout: "post"
diff: 普及/提高-
pid: P1845
tag: ['NOI 导刊']
---
# 影像之结构化特征
## 题目描述

在影像比对中，有一种方法是利用影像中的边缘（edge）信息，计算每个边缘资讯中具有代表性的结构化特征，以作为比对两张影像是否相似的判断标准。Water-filling 方法是从每个边缘图的一个端点开始，绕着相连的边缘点走并依序编号。若走到某一步时，遇到一个以上不同的连接点，则分成不同路径同时继续走，直到没有任何连接点为止。如果一个点和另一个点为上下左右相邻，就称为连接。

例如，在图 $1$ 的影像中包含三个边缘图，每个边缘图由一些互相连接的边缘点构成。图中以黑色的方块代表边缘点，白色的方块代表背景。在 Water-filling 方法中，首先，从第一行（row）开始，由左至右，由上至下，先找到第一个黑点并编号为 $1$。接着，找 $1$ 的下一个尚未编号的连接点并编号为 $2$。依此方法继续往下一个点前进依次编号。在编号 $6$ 的点之后有两个尚未编号的连接点，此时，则分为两条路线，并同时编号为 $7$ 继续往下走。当走到没有任何的相连点时，则结束现有边缘图的编号，并继续对影像中的其它边缘图编号。走完图 $1$ 所有边缘图后所得到的编号如图 $2$ 所示。所以，走完这三个边缘图所需要的步数分别为 $12$、 $7$ 及 $3$；所以，$12$、$7$ 及 $3$ 可以作为代表此张影像的结构化特征。请注意：位于斜对角上的两点不能算做连接，如：

![](https://cdn.luogu.com.cn/upload/pic/704.png)

请写一个程序计算每个影像中，以 Water-filling 方法走完其中所有的边缘图后，将每个边缘图需走的步数依走访的顺序列出。
## 输入格式

输入文件包含一个正方形的影像。每组影像以图的宽度 $n$ 开头 $(1 \le n \le 1000)$。接下来的 $n$ 行代表影像的内容：$0$ 表示背景的白点，$1$ 表示黑色的边缘点。
## 输出格式

对每一个输入的影像，以 Water-filling 方法走完所有的边缘图后，先印出此张影像中共有几个边缘图。接着，将每个边缘图需走的步数按升序列出。
## 样例

### 样例输入 #1
```
10 
0000000000 
0011110000 
0000010000 
0011111000 
0010110100 
0010010110 
0011110010 
0100010010 
0100000110 
0100000000 
```
### 样例输出 #1
```
3 
3 
7 
12
```


---

---
title: "发射站"
layout: "post"
diff: 普及/提高-
pid: P1901
tag: ['NOI 导刊', '栈', '单调栈']
---
# 发射站
## 题目描述

某地有 $N$ 个能量发射站排成一行，每个发射站 $i$ 都有不相同的高度 $H_i$，并能向两边（两端的发射站只能向一边）同时发射能量值为 $V_i$ 的能量，发出的能量只被两边**最近的且比它高**的发射站接收。显然，每个发射站发来的能量有可能被 $0$ 或 $1$ 或 $2$ 个其他发射站所接受。

请计算出接收最多能量的发射站接收的能量是多少。

## 输入格式

第 $1$ 行一个整数 $N$。

第 $2$ 到 $N+1$ 行，第 $i+1$ 行有两个整数 $H_i$ 和 $V_i$，表示第 $i$ 个发射站的高度和发射的能量值。
## 输出格式

输出仅一行，表示接收最多能量的发射站接收到的能量值。答案不超过 32 位带符号整数的表示范围。

## 样例

### 样例输入 #1
```
3
4 2 
3 5 
6 10

```
### 样例输出 #1
```
7
```
## 提示

对于 $40\%$ 的数据，$1\le N\le 5000,1\le H_i\le 10^5,1\le V_i\le 10^4$。

对于 $70\%$ 的数据，$1\le N\le 10^5,1\le H_i\le 2\times 10^9,1\le V_i\le 10^4$。

对于 $100\%$ 的数据，$1\le N\le 10^6,1\le H_i\le 2\times 10^9,1\le V_i\le 10^4$。


---

---
title: "最长括号匹配"
layout: "post"
diff: 普及/提高-
pid: P1944
tag: ['字符串', '动态规划 DP', 'NOI 导刊']
---
# 最长括号匹配
## 题目描述

对一个由(,),[,]括号组成的字符串，求出其中最长的括号匹配子串。具体来说，满足如下条件的字符串成为括号匹配的字符串：

  1.(),[]是括号匹配的字符串。

2.若A是括号匹配的串，则(A),[A]是括号匹配的字符串。

3.若A,B是括号匹配的字符串，则AB也是括号匹配的字符串。

例如：(),[],([]),()()都是括号匹配的字符串，而][,[(])则不是。

字符串A的子串是指由A中连续若干个字符组成的字符串。

例如，A,B,C,ABC,CAB,ABCABCd都是ABCABC的子串。空串是任何字符串的子串。

## 输入格式

输入一行，为一个仅由()[]组成的非空字符串。

## 输出格式

输出也仅有一行，为最长的括号匹配子串。若有相同长度的子串，输出位置靠前的子串。

## 样例

### 样例输入 #1
```
([(][()]]()

```
### 样例输出 #1
```
[()]

```
### 样例输入 #2
```
())[]
```
### 样例输出 #2
```
()
```
## 提示

【数据范围】

对20%的数据，字符串长度<=100.

对50%的数据，字符串长度<=10000.

对100%的数据，字符串长度<=1000000.



---

---
title: "遗址"
layout: "post"
diff: 普及/提高-
pid: P1959
tag: ['搜索', 'NOI 导刊']
---
# 遗址
## 题目描述

很久很久以前有一座寺庙，从上往下看寺庙的形状正好是一个正方形，由 $4$ 个角上竖立的圆柱搭建而成。现在圆柱都倒塌了，只在地上留下圆形的痕迹，可是现在地上有很多这样的痕迹，专家说一定是最大的那个。

写一个程序，给出圆柱的坐标，找出由 $4$ 个圆柱构成的最大的正方形，因为这就是寺庙的位置，要求计算出最大的面积。注意正方形的边不一定平行于坐标轴。

例如图有 $10$ 根柱子，其中 $(4,2),\allowbreak(5,2),\allowbreak(5,3),\allowbreak(4,3)$ 可以形成一个正方形，$(1,1),\allowbreak(4,0),\allowbreak(5,3),\allowbreak(2,4)$ 也可以，后者是其中最大的，面积为 $10$。

![](https://cdn.luogu.com.cn/upload/image_hosting/pjic0frl.png)

## 输入格式

第一行包含一个 $N(1\leq N\leq 3000)$，表示柱子的数量。

接下来 $N$ 行，每行有两个空格隔开的整数表示柱子的坐标（坐标值在 $0$ 到 $5000$ 之间），柱子的位置互不相同。
## 输出格式

如果存在正方形，输出最大的面积，否则输出 $0$。
## 样例

### 样例输入 #1
```
10
9 4
4 3
1 1
4 2
2 4
5 8
4 0
5 3
0 5
5 2

```
### 样例输出 #1
```
10
```
## 提示


【数据范围】

$30\%$ 满足：$1\leq N \leq100$。

$60\%$ 满足：$1\leq N \leq500$。

$100\%$ 满足：$1\leq N \leq3000$。



---

---
title: "郁闷的记者"
layout: "post"
diff: 普及/提高-
pid: P1960
tag: ['图论', 'NOI 导刊', 'Special Judge']
---
# 郁闷的记者
## 题目描述

你是一个体育报社的记者，你接受到一个艰难的任务：有 $N$ 支足球队参加足球比赛，现在给你一些比赛的结果，需要你给出各支球队的排名，从 $1$ 到 $N$。

以下是给你的一些信息：

 1. 没有平局；
 2. 不同的球队排名不能相同；
 3. 对于所有满足 $1 \le a<b \le N$，第 $a$ 名的球队一定可以打败第 $b$ 名的球队。

给你部分比赛结果，要求给出排名，并且判断是否存在另一种排名方法满足给你的比赛结果。

## 输入格式

第一行输入 $N(1 \le N \le 5000)$，表示球队的数量，编号为 $1$ 到 $N$。

第二行输入 $M(1 \le M \le 100,000)$，表示给出的比赛场数。

接下来 $M$ 行，每行两个整数 $X_i$，$Y_i$，表示 $X_i$ 能打败 $Y_i$。

## 输出格式

输出包含 $N+1$ 行，前 $N$ 行描述球队的排名，第 $i$ 个数表示第 $i$ 名的球队，第 $N+1$ 行包含一个整数，如果为 $0$ 表示不存在其他的排名方法，如果为 $1$ 表示还有其他的排名方法。

## 样例

### 样例输入 #1
```
3
2
2 1
2 3
```
### 样例输出 #1
```
2
1
3
1

```
## 提示

【数据范围】

$30\%$ 的数据满足：$1 \le N \le7$，$1 \le M \le 15$

$60\%$的数据满足：$1 \le N \le 100$，$1 \le M \le 2000$

$100\%$ 的数据满足：$1 \le N \le 5000$，$1 \le M \le 100000$


本题已加入spj，如果输出的最后一行错误将会提示 `Your decide is wrong!`

如果存在多种排名情况，排名错误将会提示 `Wrong ranks!`

如果情况固定且您的答案错误将会提示 `In line X,Your ans is wrong:expected = X,found = Y`



---

---
title: "棋盘游戏"
layout: "post"
diff: 普及/提高-
pid: P5877
tag: ['NOI 导刊']
---
# 棋盘游戏
## 题目描述

为了增强幼儿园小朋友的数数能力，小虎老师给了一个家庭游戏作业。让小虎那一块空的围棋盘，随机在一些方格中放些棋子（有黑白两种颜色），如果一个方格和它的上、下、左、右四个方格之一有相同颜色的棋子，则认为两个格子是相互连通的。这期间，要求小虎不断统计共有多少个连通块。

如下图是一个 $5\times 9$ 的一块棋盘，其中 `.` 表示空格，`*` 表示黑棋子，`@`表示白棋子。

则有 $4$ 块连通子块。
```
.  .  .  .  .  .  .  .  .
.  .  *  *  .  .  @  @  .
.  *  *  @  @  .  @  @  .
.  .  *  @  .  .  *  .  .
.  .  .  .  .  .  .  .  .
```

哥哥大虎在一边看一边想，如果棋盘是 $N\times N$ 的，共放了 $M$ 个棋子，如何使用计算机解决这个问题呢？
## 输入格式

第一行两个整数：$N,M$。

接下来有 $M$ 行，每行三个整数：$c, x, y$。分别表示依次放入棋子的颜色（$0$ 表示白色，$1$ 表示黑色）、要放入格子的横坐标和格子的纵坐标。

## 输出格式

共 $M$ 行。第 $i$ 行一个整数，表示放入第 $i$ 个棋子后，当前有多少个棋子连通块。
## 样例

### 样例输入 #1
```
3 5    
1 1 1  
1 1 2  
0 2 2  
1 3 1  
1 2 1  

```
### 样例输出 #1
```
1 
1 
2 
3 
2

```
### 样例输入 #2
```
3 5
1 1 2
1 2 1
1 3 2
1 2 3
1 2 2

```
### 样例输出 #2
```
1
2
3
4
1

```
## 提示

对于 $30\%$ 数据：$1\le N \le 10$。

对于 $60\%$ 数据：$1\le N\le 100$。

对于 $100\%$ 数据：$1\le N\le 500$，$1\le M \le N \times N$，$ 0 \le c \le 1$，$ 1\le x, y \le N$。


---


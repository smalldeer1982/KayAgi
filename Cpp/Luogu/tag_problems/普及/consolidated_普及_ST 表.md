---
title: "[常州市赛 2023] 积木"
layout: "post"
diff: 普及/提高-
pid: B4222
tag: ['动态规划 DP', '二分', '2023', '江苏', '前缀和', 'ST 表', '科创活动', '小学活动']
---
# [常州市赛 2023] 积木
## 题目背景

搬运自 <http://czoj.com.cn/p/679>。数据为民间数据。
## 题目描述

小 X 在地上玩积木，每块积木都是一个 $1\times 1\times 1$ 的正方体。地面可以看成一个 $n\times m$ 的网格，其中每一小格内都整齐地从下到上堆着若干块积木。其中第 $i$ 行第 $j$ 列中有 $h_{i,j}$ 块积木。

现在小 X 想要拿走一些积木，使得剩下来到积木组成一个正方体，正方体指的是长、宽、高都相同的长方体。

小 X 想问你他最少拿掉多少块积木才能使得最后剩下来的积木组成一个正方体。
## 输入格式

第一行，$2$ 个整数 $n$ 和 $m$ 表示地面的大小。 接下来 $n$ 行，每行 $m$ 个非负整数。第 $i$ 行第 $j$ 个数表示 $h_{i,j}$。
## 输出格式

一行一个整数表示答案。
## 样例

### 样例输入 #1
```
3 3 
2 2 1 
3 2 2 
3 1 2
```
### 样例输出 #1
```
10
```
### 样例输入 #2
```
5 5 
4 4 3 4 3
3 4 3 3 3 
3 3 1 4 4 
3 4 4 3 3 
4 3 4 4 4
```
### 样例输出 #2
```
77
```
## 提示

本题共有 $12$ 个测试点。

|测试点编号|$n,m$|$h_{i,j}$|
|:-:|:-:|:-:|
|$1\sim3$|$1\le n,m\le50$|$0\le h_{i,j}\le1000$|
|$4\sim6$|$1\le n,m\le200$|$0\le h_{i,j}\le 1000$|
|$7\sim9$|$1\le n,m\le1000$|$0\le h_{i,j}\le 20$|
|$10\sim12$|$1\le n,m\le1000$|$0\le h_{i,j}\le1000$|


---

---
title: "切蛋糕"
layout: "post"
diff: 普及/提高-
pid: P1714
tag: ['单调队列', '前缀和', '队列', 'ST 表']
---
# 切蛋糕
## 题目描述

今天是小 Z 的生日，同学们为他带来了一块蛋糕。这块蛋糕是一个长方体，被用不同色彩分成了 $n$ 个相同的小块，每小块都有对应的幸运值。

小 Z 作为寿星，自然希望吃到的蛋糕的幸运值总和最大，但小 Z 最多又只能吃 $m(m\le n)$ 小块的蛋糕。

请你帮他从这 $n$ 小块中找出**连续**的 $k(1 \le k\le m)$ 块蛋糕，使得其上的总幸运值最大。

**形式化地**，在数列 $\{p_n\}$ 中，找出一个子段 $[l,r](r-l+1\le m)$，最大化 $\sum\limits_{i=l}^rp_i$。
## 输入格式

第一行两个整数 $n,m$。分别代表共有 $n$ 小块蛋糕，小 Z 最多只能吃 $m$ 小块。

第二行 $n$ 个整数，第 $i$ 个整数 $p_i$ 代表第 $i$ 小块蛋糕的幸运值。
## 输出格式

仅一行一个整数，即小 Z 能够得到的最大幸运值。
## 样例

### 样例输入 #1
```
5 2
1 2 3 4 5
```
### 样例输出 #1
```
9
```
### 样例输入 #2
```
6 3
1 -2 3 -4 5 -6
```
### 样例输出 #2
```
5
```
## 提示

#### 数据规模与约定

- 对于 $20\%$ 的数据，有 $1\le n\le100$。
- 对于 $100\%$ 的数据，有 $1\le n\le5\times 10^5$，$|p_i|≤500$。

保证答案的绝对值在 $[0,2^{31}-1]$ 之内。


---

---
title: "忠诚"
layout: "post"
diff: 普及/提高-
pid: P1816
tag: ['线段树', '倍增', 'ST 表']
---
# 忠诚
## 题目描述

老管家是一个聪明能干的人。他为财主工作了整整  $10$ 年。财主为了让自已账目更加清楚，要求管家每天记  $k$ 次账。由于管家聪明能干，因而管家总是让财主十分满意。但是由于一些人的挑拨，财主还是对管家产生了怀疑。于是他决定用一种特别的方法来判断管家的忠诚，他把每次的账目按  $1, 2, 3 \ldots$ 编号，然后不定时的问管家问题，问题是这样的：在   $a$ 到  $b$ 号账中最少的一笔是多少？为了让管家没时间作假，他总是一次问多个问题。
## 输入格式

输入中第一行有两个数  $m, n$，表示有  $m$ 笔账  $n$ 表示有  $n$ 个问题。

第二行为  $m$ 个数，分别是账目的钱数。

后面  $n$ 行分别是  $n$ 个问题，每行有   $2$ 个数字说明开始结束的账目编号。
## 输出格式

在一行中输出每个问题的答案，以一个空格分割。
## 样例

### 样例输入 #1
```
10 3
1 2 3 4 5 6 7 8 9 10
2 7
3 9
1 10
```
### 样例输出 #1
```
2 3 1
```
## 提示

对于 $100\%$ 的数据，$m \leq 10^5$，$n \leq 10^5$。


---

---
title: "质量检测"
layout: "post"
diff: 普及/提高-
pid: P2251
tag: ['数学', '单调队列', 'ST 表']
---
# 质量检测
## 题目描述

为了检测生产流水线上总共 $N$ 件产品的质量，我们首先给每一件产品打一个分数 $A$ 表示其品质，然后统计前 $M$ 件产品中质量最差的产品的分值 $Q[m] = min\{A_1, A_2, ... A_m\}$，以及第 2 至第 $M + 1$ 件的 $Q[m + 1], Q[m + 2] $... 最后统计第 $N - M + 1$ 至第 $N$ 件的 $Q[n]$。根据 $Q$ 再做进一步评估。

请你尽快求出 $Q$ 序列。

## 输入格式

输入共两行。

第一行共两个数 $N$、$M$，由空格隔开。含义如前述。

第二行共 $N$ 个数，表示 $N$ 件产品的质量。

## 输出格式

输出共 $N - M + 1$ 行。

第 1 至 $N - M + 1$ 行每行一个数，第 $i$ 行的数 $Q[i + M - 1]$。含义如前述。

## 样例

### 样例输入 #1
```
10 4
16 5 6 9 5 13 14 20 8 12

```
### 样例输出 #1
```
5
5
5
5
5
8
8

```
## 提示

[数据范围]

30%的数据，$N \le 1000$

100%的数据，$N \le 100000$

100%的数据，$M \le N, A \le 1 000 000$



---

---
title: "[USACO06NOV] Bad Hair Day S"
layout: "post"
diff: 普及/提高-
pid: P2866
tag: ['2006', 'USACO', '栈', 'ST 表', '单调栈']
---
# [USACO06NOV] Bad Hair Day S
## 题目描述


农夫约翰有 $N$ 头奶牛正在过乱头发节。

每一头牛都站在同一排面朝右，它们被从左到右依次编号为 $1, 2, \cdots, N$。编号为 $i$ 的牛身高为 $h_i$。第 $N$ 头牛在最前面，而第 $1$ 头牛在最后面。

对于第 $i$ 头牛**前面**的第 $j$ 头牛，如果 $h_i>h_{i+1}, h_i>h_{i+2}, \cdots, h_i>h_j$，那么认为第 $i$ 头牛可以看到第 $i+1$ 到第 $j$ 头牛。

定义 $C_i$ 为第 $i$ 头牛所能看到的牛的数量。请帮助农夫约翰求出 $C _ 1 + C _ 2 + \cdots + C _ N$。

## 输入格式

输入共 $N + 1$ 行。

第一行为一个整数 $N$，代表牛的个数。  
接下来 $N$ 行，每行一个整数 $a _ i$，分别代表第 $1, 2, \cdots, N$ 头牛的身高。
## 输出格式

输出共一行一个整数，代表 $C _ 1 + C _ 2 + \cdots + C _ N$。
## 样例

### 样例输入 #1
```
6
10
3
7
4
12
2
```
### 样例输出 #1
```
5
```
## 提示

### 数据规模与约定

对于 $100\%$ 的数据，保证 $1 \leq N \leq 8 \times 10 ^ 4$，$1 \leq h _ i \leq 10 ^ 9$。


---

---
title: "[USACO07JAN] Balanced Lineup G"
layout: "post"
diff: 普及/提高-
pid: P2880
tag: ['2007', 'USACO', '树状数组', 'ST 表']
---
# [USACO07JAN] Balanced Lineup G
## 题目描述

For the daily milking, Farmer John's N cows (1 ≤ N ≤ 50,000) always line up in the same order. One day Farmer John decides to organize a game of Ultimate Frisbee with some of the cows. To keep things simple, he will take a contiguous range of cows from the milking lineup to play the game. However, for all the cows to have fun they should not differ too much in height.

Farmer John has made a list of Q (1 ≤ Q ≤ 180,000) potential groups of cows and their heights (1 ≤ height ≤ 1,000,000). For each group, he wants your help to determine the difference in height between the shortest and the tallest cow in the group.

每天,农夫 John 的 $n(1\le n\le 5\times 10^4)$ 头牛总是按同一序列排队。

有一天, John 决定让一些牛们玩一场飞盘比赛。他准备找一群在队列中位置连续的牛来进行比赛。但是为了避免水平悬殊，牛的身高不应该相差太大。John 准备了 $q(1\le q\le 1.8\times10^5)$ 个可能的牛的选择和所有牛的身高 $h_i(1\le h_i\le 10^6,1\le i\le n)$。他想知道每一组里面最高和最低的牛的身高差。
## 输入格式

Line 1: Two space-separated integers, N and Q.


Lines 2..N+1: Line i+1 contains a single integer that is the height of cow i


Lines N+2..N+Q+1: Two integers A and B (1 ≤ A ≤ B ≤ N), representing the range of cows from A to B inclusive.

第一行两个数 $n,q$。

接下来 $n$ 行，每行一个数 $h_i$。

再接下来 $q$ 行，每行两个整数 $a$ 和 $b$，表示询问第 $a$ 头牛到第 $b$ 头牛里的最高和最低的牛的身高差。

## 输出格式

Lines 1..Q: Each line contains a single integer that is a response to a reply and indicates the difference in height between the tallest and shortest cow in the range.

输出共 $q$ 行，对于每一组询问，输出每一组中最高和最低的牛的身高差。
## 样例

### 样例输入 #1
```
6 3
1
7
3
4
2
5
1 5
4 6
2 2
```
### 样例输出 #1
```
6
3
0
```


---

---
title: "【模板】ST 表 && RMQ 问题"
layout: "post"
diff: 普及/提高-
pid: P3865
tag: ['O2优化', 'ST 表']
---
# 【模板】ST 表 && RMQ 问题
## 题目背景

这是一道 ST 表经典题——静态区间最大值

**请注意最大数据时限只有 0.8s，数据强度不低，请务必保证你的每次查询复杂度为 $O(1)$。若使用更高时间复杂度算法不保证能通过。**

如果您认为您的代码时间复杂度正确但是 TLE，可以尝试使用快速读入：

```cpp
inline int read()
{
	int x=0,f=1;char ch=getchar();
	while (ch<'0'||ch>'9'){if (ch=='-') f=-1;ch=getchar();}
	while (ch>='0'&&ch<='9'){x=x*10+ch-48;ch=getchar();}
	return x*f;
}
```

函数返回值为读入的第一个整数。

**快速读入作用仅为加快读入，并非强制使用。**
## 题目描述

给定一个长度为 $N$ 的数列，和 $ M $ 次询问，求出每一次询问的区间内数字的最大值。

## 输入格式

第一行包含两个整数 $N,M$，分别表示数列的长度和询问的个数。

第二行包含 $N$ 个整数（记为 $a_i$），依次表示数列的第 $i$ 项。

接下来 $M$ 行，每行包含两个整数 $l_i,r_i$，表示查询的区间为 $[l_i,r_i]$。
## 输出格式

输出包含 $M$ 行，每行一个整数，依次表示每一次询问的结果。

## 样例

### 样例输入 #1
```
8 8
9 3 1 7 5 6 0 8
1 6
1 5
2 7
2 6
1 8
4 8
3 7
1 8
```
### 样例输出 #1
```
9
9
7
7
9
8
7
9
```
## 提示

对于 $30\%$ 的数据，满足 $1\le N,M\le 10$。

对于 $70\%$ 的数据，满足 $1\le N,M\le {10}^5$。

对于 $100\%$ 的数据，满足 $1\le N\le {10}^5$，$1\le M\le 2\times{10}^6$，$a_i\in[0,{10}^9]$，$1\le l_i\le r_i\le N$。


---


---
title: "[USACO18OPEN] Milking Order B"
layout: "post"
diff: 普及/提高-
pid: P10123
tag: ['贪心', '2018', 'USACO']
---
# [USACO18OPEN] Milking Order B
## 题目描述

Farmer John 的 $N$ 头奶牛（$2\le N\le 100$），方便起见仍然编号为 $1\ldots N$，正好闲得发慌。因此，她们发展了一个与 Farmer John 每天早上为她们挤牛奶的时候的排队顺序相关的复杂的社会结构。经过若干周的研究，Farmer John 发现这个结构基于两个关键特性。

首先，由于奶牛们的社会阶层，某些奶牛会坚持要在其他奶牛之前挤奶，基于她们的社会地位等级。比方说，如果奶牛 $3$ 有最高的地位，奶牛 $2$ 位于中等地位，奶牛 $5$ 是低地位，那么奶牛 $3$ 会最早挤奶，然后是奶牛 $2$，最后是奶牛 $5$。

然后，有些奶牛只允许她们在排队顺序中一个特定的位置挤奶。比方说，奶牛 $4$ 可能坚持要在所有奶牛中的第二位挤奶。

幸运的是，Farmer John 总是能够以一种满足所有这些情况的顺序给他的奶牛们挤奶。

不幸的是，奶牛 $1$ 最近生病了，所以 Farmer John 想要尽早给这头奶牛挤奶，使得她可以回到牛棚获得急需的休息。请帮助 Farmer John 求出奶牛 $1$ 可以在挤奶顺序中出现的最早位置。 
## 输入格式

第一行包含 $N$，$M$（$1\le M<N$），和 $K$（$1\le K<N$），表示 Farmer John 有 $N$ 头奶牛，其中 $M$ 头形成了社会阶层，$K$ 头需要在挤奶顺序中处于一个特定的位置。下一行包含 $M$ 个不同的整数 $m_i$（$1\le m_i\le N$）。在这一行出现的奶牛必须以与她们在这行出现的顺序相同的顺序进行挤奶。下面 $K$ 行，每行包含两个整数 $c_i$（$1\le c_i\le N$）和 $p_i$（$1\le p_i\le N$），表示奶牛 $c_i$ 一定要在第 $p_i$ 位进行挤奶。

输入数据保证在这些限制之下，Farmer John 能够建立一个符合要求的挤奶顺序。 
## 输出格式

输出奶牛 $1$ 可以在挤奶顺序中出现的最早位置。 
## 样例

### 样例输入 #1
```
6 3 2
4 5 6
5 3
3 1
```
### 样例输出 #1
```
4
```
## 提示

在这个例子中，Farmer John 有六头奶牛，其中奶牛 $1$ 生病了。他的挤奶顺序应该为奶牛 $4$ 在奶牛 $5$ 之前，奶牛 $5$ 在奶牛 $6$ 之前。此外，Farmer John 必须要第一个给奶牛 $3$ 挤奶，第三个给奶牛 $5$ 挤奶。

FJ 必须第一个给奶牛 $3$ 挤奶，由于奶牛 $4$ 必须要在奶牛 $5$ 之前，奶牛 $4$ 一定是第二个挤奶的，然后奶牛 $5$ 第三个。于是，奶牛 $1$ 最早在挤奶顺序中出现的位置是第四个。 


---

---
title: "[USACO18OPEN] Family Tree B"
layout: "post"
diff: 普及/提高-
pid: P10124
tag: ['模拟', '2018', 'USACO']
---
# [USACO18OPEN] Family Tree B
## 题目描述

Farmer John 拥有一个传承数代的家族经营的农场，其中的奶牛的根源同样也可以在这个农场中追溯数代。通过检索古老的记录，Farmer John 好奇于现在的这群奶牛互相之间是什么关系。请帮帮他！ 
## 输入格式

输入的第一行包含 $N$（$1\le N\le 100$），之后是两头奶牛的名字。每头奶牛的名字都是由至多 $10$ 个大写字母（`A-Z`）组成的字符串。Farmer John 好奇于这行输入中这两头奶牛之间的关系。

接下来的 $N$ 行，每行包含两头奶牛的名字 $X$ 和 $Y$，表示 $X$ 是 $Y$ 的母亲。 
## 输出格式

输出包含一行，表示输入第一行指定的两头奶牛之间的关系（简单起见，在下面的例子中，将这两头奶牛称为 BESSIE 和 ELSIE）。下面是可能出现的不同种类的关系：

- 如果BESSIE和ELSIE的母亲是同一头奶牛，输出 `SIBLINGS`。
- BESSIE 可能是 ELSIE 的直系后代，也就是说 ELSIE 是BESSIE 的母亲（`mother`），外祖母（`grand-mother`），外曾外祖母（`great-grand-mother`），外曾外曾外祖母（`great-great-grand-mother`），等等。如果是这种情况，输出 `ELSIE is the (relation) of BESSIE`，其中 `(relation)` 是适当的关系，比如 `great-great-grand-mother`。
- 如果 ELSIE 不是 BESSIE 的某个祖先或姐妹，但是是 BESSIE 的某个祖先的孩子，那么 ELSIE 就是 BESSIE 的姨母（`aunt`）。（译者注：英语原题在这里表述有误，供题人已作出声明。）如果 ELSIE 是 BESSIE 的外祖母的孩子，输出 `ELSIE is the aunt of BESSIE`；如果 ELSIE 是 BESSIE 的外曾外祖母的孩子，输出 `ELSIE is the great-aunt of BESSIE`；如果 ELSIE 是 BESSIE 的外曾外曾外祖母的孩子，输出 `ELSIE is the great-great-aunt of BESSIE`；以此类推。
- 如果 BESSIE 和 ELSIE 有任何其他的亲戚关系（也就是说，她们有共同的祖先），她们就是表姐妹，输出 `COUSINS`。
- 如果 BESSIE 和 ELSIE 既没有共同的祖先，其中任何一头也不是另一头的直系后代，输出 `NOT RELATED`。

下图描述了上述关系，你只需考虑这些关系。观察到有一些像是“甥女（`niece`）”（姊妹的女儿）的关系是不必要的，这是由于如果 BESSIE 是 ELSIE 的甥女，那么 ELSIE 就是 BESSIE 的姨母。

![](https://cdn.luogu.com.cn/upload/image_hosting/xvfjp4u5.png)
## 样例

### 样例输入 #1
```
7 AA BB
MOTHER AA
GGMOTHER BB
MOTHER SISTER
GMOTHER MOTHER
GMOTHER AUNT
AUNT COUSIN
GGMOTHER GMOTHER
```
### 样例输出 #1
```
BB is the great-aunt of AA
```


---

---
title: "[USACO24JAN] Balancing Bacteria B"
layout: "post"
diff: 普及/提高-
pid: P10133
tag: ['USACO', '2024', '差分']
---
# [USACO24JAN] Balancing Bacteria B
## 题目描述

Farmer John 有 $N$（$1\le N\le 2\cdot 10^5$）块草地排成一行，其中草地 $i$ 的细菌水平与健康草的细菌水平相差 $a_i$（$−10^{15}\le a_i\le 10^{15}$）。例如，如果 $a_i=−3$，则草地 $i$ 的细菌水平比正常水平低 $3$，需要额外添加恰好 $3$ 个单位的细菌才能将其提高到被认为是健康的程度。

Farmer John 想要确保每一块草地都被修复至健康的细菌水平。方便的是，他有两种品牌的农药可以喷洒在他的田地里，一种可以添加细菌，另一种可以去除细菌。当 Farmer John 喷洒任一类型的农药时，他站在草地 $N$（最右边的草地）并为他的喷雾器选择功率等级 $L$（$1\le L\le N$）。

喷雾器对靠近 Farmer John 的草地效果最大，随着距离增加效果逐渐减弱。如果 Farmer John 选择添加细菌的农药，则 $L$ 单位的细菌将被添加至草地 $N$，$L−1$ 单位添加至草地 $N−1$，$L−2$ 单位添加至草地 $N−2$，以此类推。草地 $1\ldots N−L$ 不会得到任何细菌，因为喷雾器设置的功率不足以到达它们。类似地，如果 Farmer John 选择去除细菌的农药，则 $L$ 单位的细菌将被从草地 $N$ 去除，$L−1$ 单位被从草地 $N−1$ 去除，以此类推。同样，草地 $1\ldots N−L$ 将不受影响。

求 Farmer John 使用喷雾器的最少次数，使得每块草地都具有健康草的推荐细菌值。输入保证答案不超过 $10^9$。

**注意这个问题涉及到的整数可能需要使用 64 位整数型（例如，C/C++ 中的 "long long"）。**
## 输入格式

输入的第一行包含 $N$。

第二行包含 $N$ 个整数 $a_1\ldots a_N$，为每块草地的初始细菌水平。 
## 输出格式

输出一个整数，为使每块草地都具有健康草的推荐的细菌值所需使用喷雾器的最少次数。 
## 样例

### 样例输入 #1
```
2
-1 3
```
### 样例输出 #1
```
6
```
### 样例输入 #2
```
5
1 3 -2 -7 5
```
### 样例输出 #2
```
26
```
## 提示

### 样例解释 1

使用去除细菌的农药，功率等级为 $1$，使用五次。然后使用添加细菌的农药，功率等级为 $2$，使用一次。

### 测试点性质

- 测试点 $3-5$：$N\le 10^3$，答案不超过 $10^3$。
- 测试点 $6-10$：$N\le 10^3$。
- 测试点 $11-15$：没有额外限制。


---

---
title: "[USACO24JAN] Potion Farming S"
layout: "post"
diff: 普及/提高-
pid: P10135
tag: ['USACO', '2024', '树形 DP']
---
# [USACO24JAN] Potion Farming S
## 题目描述

你正在玩你最喜欢的手机游戏。为了有机会击败传说中的奶牛 Boss，你正在试着刷药水。游戏地图是由 $N$（$2\le N\le 10^5$）个编号为 $1\ldots N$ 的房间组成，由 $N−1$ 条边连接，形成一棵树。

你可以通过一系列的「遍历」来探索地图。一次遍历是从房间 $1$ 到树中任何其他房间的一条简单路径。当你完成一次遍历后，你可以从房间 $1$ 再次开始遍历。一旦地图的每个房间都被至少一次遍历访问过，这个地图就通关了。你的主要目标是以最小的遍历次数通关这一地图。

你的次要目标是刷到尽可能多的药水。在一次遍历开始前，地图上的某个房间内会生成一瓶药水。你可以通过在当次遍历中访问生成药水的房间来拾取药水。如果你没有拾取药水，那么当次遍历结束它就会消失，你无法在未来的遍历中拾取它。

由于你是一位聪明的程序员，在查看游戏文件后，你成功知道了在接下来的 $N$ 次遍历之前药水的出现位置。如果你以最小的遍历次数通关地图，你可以从地图内刷到的最大药水数量是多少？ 
## 输入格式

输入的第一行包含一个整数 $N$，为地图内的房间数量。

以下一行包含 $N$ 个空格分隔的整数 $p_1p_2\ldots p_N$，其中 $p_i$ 为第 $i$ 次遍历之前药水出现的房间。

最后 $N−1$ 行每行包含两个空格分隔的整数 $a\ b$（$1\le a,b\le N$），表示房间 $a$ 和 $b$ 之间的一条边。输入保证所有边形成一棵树。
## 输出格式

输出一行，包含一个整数，为以最小的遍历次数可以从地图内刷到的最大药水数量。 
## 样例

### 样例输入 #1
```
5
5 4 3 2 1
1 2
1 3
3 4
3 5
```
### 样例输出 #1
```
2
```
## 提示

### 样例解释 1

在这个测试用例中，通关地图所需的最小遍历次数为 $3$。

一个在三次遍历中拾取两瓶药水的最佳方案如下：

- 遍历 $1$：$1\to 3\to 5$（于房间 $5$ 拾取药水）
- 遍历 $2$：$1\to 3\to 4$（于房间 $4$ 拾取药水）
- 遍历 $3$：$1\to 2$（被迫通关地图，无视房间 $3$ 的药水）

或者，我们也可以计划我们的遍历如下：

- 遍历 $1$：$1\to 2$（没有药水）
- 遍历 $2$：$1\to 3\to 4$（于房间 $4$ 拾取药水）
- 遍历 $3$：$1\to 3\to 5$（于房间 $3$ 拾取药水）

### 测试点性质

- 测试点 $2-7$：$N\le 1000$。
- 测试点 $8-15$：没有额外限制。


---

---
title: "[USACO24OPEN] Walking Along a Fence B"
layout: "post"
diff: 普及/提高-
pid: P10275
tag: ['模拟', 'USACO', '2024']
---
# [USACO24OPEN] Walking Along a Fence B
## 题目描述

Farmer John 的 $N$ 头奶牛（$1\le N\le 10^5$）每头都喜欢日常沿围着牧场的栅栏散步。

栅栏由 $P$ 根柱子组成（$4\le P\le 2\cdot 10^5$，$P$ 为偶数），每根柱子的位置是 FJ 农场地图上的一个不同的二维坐标点 $(x,y)$（$0\le x,y\le 1000$）。每根柱子通过垂直或水平线段的栅栏连接到两根相邻的柱子，因此整个栅栏可以被视为各边平行于 $x$ 轴或 $y$ 轴的一个多边形（最后一根柱子连回第一根柱子，确保围栏形成一个包围牧场的闭环）。栅栏多边形是「规则的」，体现在栅栏段仅可能在其端点处重合，每根柱子恰好属于两个栅栏段，同时每两个在端点处相交的栅栏段都是垂直的。

每头奶牛的日常散步都有一个偏好的起始和结束位置，均为沿栅栏的某个点（可能在柱子处，也可能不在）。每头奶牛日常散步时沿着栅栏行走，从起始位置开始，到结束位置结束。由于栅栏形成闭环，奶牛有两条路线可以选择。由于奶牛是一种有点懒的生物，每头奶牛都会选择距离较短的方向沿栅栏行走（如果并列，奶牛可以选择任一方向）。

求每头奶牛行走的距离。 
## 输入格式

输入的第一行包含 $N$ 和 $P$。以下 $P$ 行的每一行包含两个整数，以顺时针或逆时针顺序表示栅栏柱子的位置。以下 $N$ 行的每一行包含四个整数 $x_1\ y_1\ x_2\ y_2$，表示一头奶牛的起始位置 $(x_1,y_1)$ 和结束位置 $(x_2,y_2)$。 
## 输出格式

输出 $N$ 个整数，为每头奶牛行走的距离。 
## 样例

### 样例输入 #1
```
5 4
0 0
2 0
2 2
0 2
0 0 0 2
0 2 1 0
2 1 0 2
1 0 1 2
1 2 1 0
```
### 样例输出 #1
```
2
3
3
4
4
```
## 提示

### 样例解释

第一头奶牛可以直接从 $(0,0)$ 走到 $(0,2)$。

第二头奶牛可以从 $(0,2)$ 走到 $(0,0)$，然后走到 $(1,0)$。

第四头奶牛有两条长度相等的可能路线：$(1,0)\to (0,0)\to (0,2)\to (1,2)$ 和 $(1,0)\to (2,0)\to (2,2)\to (1,2)$。

### 测试点性质

- 测试点 $2-6$：$0\le x,y\le 100$ 且 $N\le 100$。
- 测试点 $7-11$：没有额外限制。


---

---
title: "[USACO24OPEN] Farmer John's Favorite Permutation B"
layout: "post"
diff: 普及/提高-
pid: P10276
tag: ['数学', 'USACO', '2024']
---
# [USACO24OPEN] Farmer John's Favorite Permutation B
## 题目描述

Farmer John 有一个长为 $N$（$2\le N\le 10^5$）的排列 $p$，包含从 $1$ 到 $N$ 的每个正整数恰好一次。然而，Farmer Nhoj 闯入了 FJ 的牛棚并拆散了 $p$。为了不至于太过残忍，FN 写了一些能够帮助 FJ 重建 $p$ 的提示。当 $p$ 中剩余多于一个元素时，FN 会执行以下操作：

令 $p$ 的剩余元素为 $p_1^\prime,p_2^\prime,\ldots,p_n^\prime$，

- 如果 $p_1^\prime>p_n^\prime$，他写下 $p_2^\prime$ 并从排列中删除 $p_1^\prime$。
- 否则，他写下 $p_{n−1}^\prime$ 并从排列中删除 $p_n^\prime$。

最终，Farmer Nhoj 将按顺序写下 $N−1$ 个整数 $h_1,h_2,\ldots,h_{N−1}$。给定 $h$，Farmer John 希望得到你的帮助重建与 Farmer Nhoj 的提示相一致的最小字典序 $p$，或者判断 Farmer Nhoj 一定犯了错误。我们知道，给定两个排列 $p$ 和 $p^\prime$，如果在第一个两者不同的位置 $i$ 处有 $p_i<p_i^\prime$，则 $p$ 的字典序小于 $p^\prime$。
## 输入格式

每个测试点包含 $T$ 个独立的测试用例（$1\le T\le 10$）。每个测试用例的描述如下：

第一行包含 $N$。

第二行包含 $N−1$ 个整数 $h_1,h_2,\ldots,h_{N−1}$（$1\le h_i\le N$）。
## 输出格式

输出 $T$ 行，每个测试用例一行。

如果存在与 $h$ 相一致的 $1\ldots N$ 的排列 $p$，输出字典顺序最小的 $p$。如果不存在这样的 $p$，输出 $-1$。 
## 样例

### 样例输入 #1
```
5
2
1
2
2
4
1 1 1
4
2 1 1
4
3 2 1
```
### 样例输出 #1
```
1 2
-1
-1
3 1 2 4
1 2 3 4
```
## 提示

对于第四个测试用例，如果 $p=[3,1,2,4]$ 则 FN 将写下 $h=[2,1,1]$。

```plain
p' = [3,1,2,4]
p_1' < p_n' -> h_1 = 2
p' = [3,1,2]
p_1' > p_n' -> h_2 = 1
p' = [1,2]
p_1' < p_n' -> h_3 = 1
p' = [1]
```

注意排列 $p=[4,2,1,3]$ 也会产生同样的 $h$，但 $[3,1,2,4]$ 字典序更小。

对于第二个测试用例，不存在与 $h$ 相一致的 $p$；$p=[1,2]$ 和 $p=[2,1]$ 均会产生 $h=[1]$，并非 $h=[2]$。

### 测试点性质

- 测试点 $2$：$N\le 8$。
- 测试点 $3-6$：$N\le 100$。
- 测试点 $7-11$：没有额外限制。


---

---
title: "[USACO06FEB] Backward Digit Sums G/S"
layout: "post"
diff: 普及/提高-
pid: P1118
tag: ['搜索', '2006', 'USACO', '枚举', '深度优先搜索 DFS']
---
# [USACO06FEB] Backward Digit Sums G/S
## 题目描述

`FJ` and his cows enjoy playing a mental game. They write down the numbers from $1$ to$ N(1 \le N  \le 10)$ in a certain order and then sum adjacent numbers to produce a new list with one fewer number.  They repeat this until only a single number is left.  For example, one instance of the game (when $N=4$) might go like this:

```cpp
    3   1   2   4
      4   3   6
        7   9
         16
```
Behind `FJ`'s back, the cows have started playing a more difficult game, in which they try to determine the starting sequence from only the final total and the number $N$.  Unfortunately, the game is a bit above `FJ`'s mental arithmetic capabilities.


Write a program to help `FJ` play the game and keep up with the cows.


## 输入格式

共一行两个正整数 $n,sum$。

## 输出格式

输出包括一行，为字典序最小的那个答案。

当无解的时候，请什么也不输出。

## 样例

### 样例输入 #1
```
4 16
```
### 样例输出 #1
```
3 1 2 4
```
## 提示

- 对于 $40\%$ 的数据，$1\le n\le 7$；  
- 对于 $80\%$ 的数据，$1\le n \le 10$；
- 对于 $100\%$ 的数据，$1\le n \le 12$，$1\le sum\le 12345$。

## 题目翻译


有这么一个游戏：

写出一个 $1\sim n$ 的排列 $a$，然后每次将相邻两个数相加，构成新的序列，再对新序列进行这样的操作，显然每次构成的序列都比上一次的序列长度少 $1$，直到只剩下一个数字位置。

下面是一个例子：

- $3,1,2,4$；
- $4,3,6$；
- $7,9$；
- $16$。

最后得到 $16$ 这样一个数字。

现在想要倒着玩这样一个游戏，如果知道 $n$，以及最后得到的数字的大小 $sum$，请你求出最初序列 $a_i$（应该是一个 $1\sim n$ 的排列）。若答案有多种可能，则输出字典序最小的那一个。

我们称序列 $a=\lang a_1,a_2,\cdots,a_n\rang$ 的字典序小于序列 $b=\lang b_1,b_2,\cdots,b_n\rang$ 的字典序，当且仅当存在一个位置 $p$，满足 $a_1=b_1,a_2=b_2,\cdots,a_{p-1}=b_{p-1},a_p<b_p$。


---

---
title: "[USACO3.2] 阶乘问题"
layout: "post"
diff: 普及/提高-
pid: P1134
tag: ['数学', 'USACO']
---
# [USACO3.2] 阶乘问题
## 题目描述

也许你早就知道阶乘的含义，$N$ 阶乘是由 $1$ 到 $N$ 相乘而产生，如：

$$12!=1\times 2\times 3\times 4\times 5\times 6\times 7\times 8\times 9\times 10\times 11\times  12=479{,}001{,}600$$

$12$ 的阶乘最右边的非零位为 $6$。

写一个程序，计算 $N\ (1\le N\le5\times 10^7)$ 阶乘的最右边的非零位的值。

**注意**：$10{,}000{,}000!$ 的末尾有 $2499999$ 个零。
## 输入格式

仅一行包含一个正整数 $N$。

## 输出格式

一个整数，表示最右边的非零位的值。

## 样例

### 样例输入 #1
```
12
```
### 样例输出 #1
```
6
```
## 提示

USACO Training Section 3.2



---

---
title: "[USACO24DEC] Roundabount Rounding B"
layout: "post"
diff: 普及/提高-
pid: P11449
tag: ['数学', 'USACO', '2024']
---
# [USACO24DEC] Roundabount Rounding B
## 题目描述

奶牛 Bessie 回到学校了！她开始做她的数学作业，在作业中她被要求将正整数四舍五入到 $10$ 的幂。

要将一个正整数 $a$ 四舍五入到最接近的 $10^b$，其中 $b$ 为正整数，Bessie 首先找到从右往左数第 $b$ 个数位。令 $x$ 为这个数位。

如果 $x≥5$，Bessie 将 $a$ 增加 $10^b$。

然后，Bessie 将从右侧开始直至第 $b$ 个数位的所有数位均设置为 $0$。

例如，如果 Bessie 想要将 $456$ 四舍五入到最接近的 $10^2$（百位），Bessie 会首先找到从右往左数第 $2$ 个数位 $5$。这意味着 $x=5$。然后由于 $x≥5$，Bessie 将 $a$ 增加 $100$。最后，Bessie 将 $a$ 中从右侧开始直至第 $2$ 个数位的所有数位设置为 $0$，结果为 $500$。

但是，如果 Bessie 将 $446$ 四舍五入到最接近的 $10^2$，她将得到 $400$。

在看了 Bessie 的作业后，Elsie 认为她已经发明了一种新的舍入方式：链式舍入。要链式舍入到最接近的 $10^b$，Elsie 将首先舍入到最接近的 $10^1$，然后舍入到最接近的 $10^2$
，以此类推，直至舍入到最接近的 $10^b$。

Bessie 认为 Elsie 是错误的，但她太忙于数学作业，无法确认她的怀疑。她请你计算出存在多少个不小于 $2$ 且不超过 $N$ 的整数 $x$（$1≤N≤10^9$），使得将 $x$ 四舍五入到最接近的 $10^P$ 与链式舍入到最接近的 $10^P$ 的结果不同，其中 $P$ 是满足 $10^P≥x$ 的最小整数。
## 输入格式

你需要回答多个测试用例。

输入的第一行包含一个整数 $T$（$1≤T≤10^5$），为测试用例的数量。以下是 $T$ 个测试用例。

每个测试用例的输入仅有一行，包含一个整数 $N$。输入保证同一测试点中的所有 $N$ 各不相同。
## 输出格式

输出 $T$ 行，第 $i$ 行包含第 $i$ 个测试用例的答案。每行包含一个整数，表示存在多少个不小于 $2$ 且不超过 $N$ 的整数在使用两种舍入方法时会得到不同的结果。
## 样例

### 样例输入 #1
```
4
1
100
4567
3366
```
### 样例输出 #1
```
0
5
183
60
```
## 提示

### 样例解释
考虑样例中的第二个测试用例。$48$ 应当被计算在内，因为 $48$ 链式舍入到最接近的 $10^2$ 是 $100$（$48→50→100
$），但 $48$ 四舍五入到最接近的 $10^2$ 是 $0$。

在第三个测试用例中，$48$ 和 $480$ 是两个被计算在内的整数。$48$ 链式舍入到 $100$ 而不是 $0$，$480$ 链式舍入到 $1000$ 而不是 $0$。但是，$67$ 不被计算在内，因为它链式舍入到 $100$，与 $67$ 四舍五入到最接近的 $10^2$ 相同。

### 测试点性质
- 测试点 1：样例。
- 测试点 2-4：$N≤10^3$。
- 测试点 5-7：$N≤10^6$。
- 测试点 8-13：没有额外限制。


---

---
title: "[USACO24DEC] It's Mooin' Time B"
layout: "post"
diff: 普及/提高-
pid: P11451
tag: ['字符串', 'USACO', '2024']
---
# [USACO24DEC] It's Mooin' Time B
## 题目描述

Farmer John 正在试图向 Elsie 描述他最喜欢的 USACO 竞赛，但她很难理解为什么他这么喜欢它。他说「竞赛中我最喜欢的部分是 Bessie 说 『现在是哞哞时间』并在整个竞赛中一直哞哞叫」。

Elsie 仍然不理解，所以 Farmer John 将竞赛以文本文件形式下载，并试图解释他的意思。竞赛被定义为一个长度为 $N$（$3≤N≤20000$）的小写字母字符串。一种哞叫一般地定义为子串 $c_ic_jc_j$，其中某字符 $c_i$ 之后紧跟着 $2$ 个某字符 $c_j$，且 $c_i≠c_j$。根据 Farmer John 的说法，Bessie 哞叫了很多，所以如果某种哞叫在竞赛中出现了至少 $F$（$1≤F≤N$）次，那可能就是 Bessie 发出的。

然而，Farmer John 的下载可能损坏，文本文件可能存在至多一个字符与原始文件不同。将可能的误差考虑在内，输出所有可能是 Bessie 发出的哞叫，按字典序顺序排序。
## 输入格式

输入的第一行包含 $N$ 和 $F$，表示字符串的长度以及 Bessie 的哞叫的频次下限。

第二行包含一个长度为 $N$ 的小写字母字符串，表示竞赛。
## 输出格式

输出可能是 Bessie 发出的哞叫的数量，以下是按字典序排序的哞叫列表。每行输出一种哞叫。
## 样例

### 样例输入 #1
```
10 2
zzmoozzmoo
```
### 样例输出 #1
```
1
moo
```
### 样例输入 #2
```
17 2
momoobaaaaaqqqcqq
```
### 样例输出 #2
```
3
aqq
baa
cqq
```
### 样例输入 #3
```
3 1
ooo
```
### 样例输出 #3
```
25
aoo
boo
coo
doo
eoo
foo
goo
hoo
ioo
joo
koo
loo
moo
noo
poo
qoo
roo
soo
too
uoo
voo
woo
xoo
yoo
zoo
```
## 提示

### 样例 #1 解释

在这个样例中，任何字符变化都不会影响答案。唯一 Bessie 可能发出的哞叫是 $\tt{moo}$。

### 样例 #2 解释

在这个样例中，位置 $8$（从零开始索引）的 $\tt{a}$ 可能是由 $\tt b$ 损坏导致的，这使得 $\tt baa$ 成为一种 Bessie 发出两次的可能的哞叫。此外，位置 $11$ 的 $\tt q$ 可能是由 $\tt c$ 损坏导致的，这使得 $\tt cqq$ 成为一种 Bessie 可能的哞叫。$\tt aqq$ 可以通过将 $\tt c$ 换成 $\tt a$ 来达到。

### 测试点性质
- 测试点 1-3：样例。
- 测试点 4-8：$N≤100$。
- 测试点 9-13：没有额外限制。


---

---
title: "[USACO24DEC] Cake Game S"
layout: "post"
diff: 普及/提高-
pid: P11452
tag: ['贪心', 'USACO', '2024', '前缀和']
---
# [USACO24DEC] Cake Game S
## 题目描述

Bessie 和 Elsie 发现了一行 $N$ 个蛋糕（$2≤N≤5⋅10^5$
，$N$ 为偶数），大小依次为 $a_1,a_2,\cdots,a_N$（$1≤a_i≤10^9$）。

两头奶牛都想吃到尽可能多的蛋糕。但是，作为非常文明的奶牛，她们决定玩一个游戏来分割蛋糕！游戏在两头奶牛之间轮流进行回合。每个回合进行以下两者之一：

1. Bessie 选择两个相邻的蛋糕并将它们堆叠起来，制造大小为两者大小之和的一个新蛋糕。
2. Elsie 选择最左边或最右边的蛋糕藏起来。

当只剩下一个蛋糕时，Bessie 吃掉它，而 Elsie 吃掉她藏起来的所有蛋糕。如果两头奶牛都采取最优策略以最大化她们吃到的蛋糕量，并且 Bessie 先进行回合，那么每头奶牛将会吃到多少蛋糕？
## 输入格式

每个测试点包含 $T$（$1≤T≤10$）个独立的测试用例。输入保证一个测试点中的所有 $N$ 之和不超过 $10^6$。

每个测试用例的格式如下。

第一行包含 $N$。下一行包含 $N$ 个空格分隔的整数 $a_1,a_2,\cdots,a_N$。
## 输出格式

对于每个测试用例，输出一行，包含 $b$ 和 $e$，表示 Bessie 和 Elsie 在两头奶牛都采取最优策略的情况下分别吃到的蛋糕量。
## 样例

### 样例输入 #1
```
2
4
40 30 20 10
4
10 20 30 40
```
### 样例输出 #1
```
60 40
60 40
```
## 提示

### 样例解释

对于第一个测试用例，在最优策略下，

Bessie 将堆叠中间两个蛋糕。现在蛋糕的大小为 $[40,50,10]$。

Elsie 将吃掉最左边的蛋糕。现在剩余的蛋糕的大小为 $[50,10]$。

Bessie 堆叠剩余的两个蛋糕。

Bessie 将吃到 $30+20+10=60$ 的蛋糕，而 Elsie 将吃到 $40$ 的蛋糕。

第二个测试用例是第一个测试用例反转的情况，因此答案相同。

### 测试点性质

- 测试点 1：样例。
- 测试点 2：所有 $a_i$ 相等。
- 测试点 3：$N≤10$。
- 测试点 4-7：$N≤5000$。
- 测试点 8-11：没有额外限制。


---

---
title: "[USACO25JAN] It's Mooin' Time II B"
layout: "post"
diff: 普及/提高-
pid: P11668
tag: ['USACO', '2025']
---
# [USACO25JAN] It's Mooin' Time II B
## 题目描述

Farmer John 正在试图向 Elsie 描述他最喜欢的 USACO 竞赛，但她很难理解为什么他这么喜欢它。他说「竞赛中我最喜欢的部分是 Bessie 说 『现在是哞哞时间』并在整个竞赛中一直哞哞叫」。

Elsie 仍然不理解，所以 Farmer John 将竞赛以文本文件形式下载，并试图解释他的意思。竞赛被定义为一个包含 $N$（$1\le N\le 10^6$）个整数的数组 $a_1, a_2, \dots, a_N$（$1\le a_i\le N$）。Farmer John 定义哞叫为一个包含三个整数的数组，其中第二个整数等于第三个整数，但不等于第一个整数。一种哞叫被称为在竞赛中发生，如果可以从数组中移除整数，直到只剩下这一哞叫。

由于 Bessie 据称「在整个竞赛中一直哞哞叫」，请帮助 Elsie 计算竞赛中发生的不同哞叫的数量！两种哞叫是不同的，如果它们并非由相同的整数以相同的顺序组成。
## 输入格式

输入的第一行包含 $N$。

第二行包含 $N$ 个空格分隔的整数 $a_1,a_2,\dots,a_N$。
## 输出格式

输出竞赛中发生的不同哞叫的数量。

**注意这个问题涉及到的整数可能需要使用 64 位整数型（例如，Java 中的 "long"，C/C++ 中的 "long long"）。**
## 样例

### 样例输入 #1
```
6
1 2 3 4 4 4
```
### 样例输出 #1
```
3
```
## 提示

### 样例解释

竞赛包含三种不同的哞叫："1 4 4"，"2 4 4" 和 "3 4 4"。

### 子任务

- 测试点 2-4：$N\le 10^2$。
- 测试点 5-7：$N\le 10^4$。
- 测试点 8-11：没有额外限制。


---

---
title: "[USACO25JAN] Cow Checkups B"
layout: "post"
diff: 普及/提高-
pid: P11669
tag: ['USACO', '2025']
---
# [USACO25JAN] Cow Checkups B
## 题目描述

**注意：我们建议使用 Python 以外的其他语言以获得本题目的全部分数。**

Farmer John 的 $N$（$1 \leq N \leq 7500$）头奶牛站成一行，奶牛 $1$ 在队伍的最前面，奶牛 $N$ 在队伍的最后面。FJ 的奶牛也有许多不同的品种。他用从 $1$ 到 $N$ 的整数来表示每一品种。队伍从前到后第 $i$ 头奶牛的品种是 $a_i$（$1 \leq a_i \leq N$）。

FJ 正在带他的奶牛们去当地的奶牛医院进行体检。然而，奶牛兽医非常挑剔，仅愿意当队伍中第 $i$ 头奶牛为品种 $b_i$（$1 \leq b_i \leq N$）时对其进行体检。

FJ 很懒惰，不想完全重新排列他的奶牛。他将执行以下操作恰好一次。

选择两个整数 $l$ 和 $r$，使得 $1 \leq l \le r \leq N$。反转队伍中第 $l$ 头奶牛到第 $r$ 头奶牛之间的奶牛的顺序。
FJ 想要衡量这种方法有多少效果。对于每一个 $c=0 \ldots N$，请帮助 FJ 求出使得恰好 $c$ 头奶牛被检查的不同操作 $(l,r)$ 的数量。两种操作 $(l_1,r_1)$ 和 $(l_2,r_2)$ 不同，当且仅当 $l_1 \neq l_2$ 或者 $r_1 \neq r_2$。
## 输入格式

输入的第一行包含 $N$。

第二行包含 $a_1, a_2, \ldots, a_N$。

第三行包含 $b_1, b_2, \ldots, b_N$。
## 输出格式

输出 $N+1$ 行，第 $i$ 行包含使得 $i-1$ 头奶牛被检查的不同操作 $(l,r)$ 的数量。
## 样例

### 样例输入 #1
```
3
1 3 2
3 2 1
```
### 样例输出 #1
```
3
3
0
0
```
### 样例输入 #2
```
3
1 2 3
1 2 3
```
### 样例输出 #2
```
0
3
0
3
```
### 样例输入 #3
```
7
1 3 2 2 1 3 2
3 2 2 1 2 3 1
```
### 样例输出 #3
```
0
6
14
6
2
0
0
0
```
## 提示

### 样例解释


#### 样例 #1：

如果 FJ 选择 $(l=1,r=1)$，$(l=2,r=2)$ 或 $(l=3,r=3)$，则没有奶牛将会被检查。注意这些操作并没有改变奶牛的位置。
以下操作会导致一头奶牛被检查。

- $(l=1,r=2)$：FJ 反转第一头和第二头奶牛的顺序，因此新队伍中每头奶牛的品种将为 $[3,1,2]$。第一头奶牛将会被检查。
- $(l=2,r=3)$：FJ 反转第二头和第三头奶牛的顺序，因此新队伍中每头奶牛的品种将为 $[1,2,3]$。第二头奶牛将会被检查。
- $(l=1,r=3)$：FJ 反转第一头，第二头和第三头奶牛的顺序，因此新队伍中每头奶牛的品种将为 $[2,3,1]$。第三头奶牛将会被检查。

#### 样例 #2

三种导致 $3$ 头奶牛被检查的可能操作为 $(l=1,r=1)$，$(l=2,r=2)$ 和 $(l=3,r=3)$。

#### 样例 #3

两种导致 $4$ 头奶牛被检查的可能操作为 $(l=4,r=5)$ 和 $(l=5,r=7)$。

### 子任务
- 测试点 4-6: $N\le 100$
- 测试点 7-13: 无特殊限制


---

---
title: "[USACO1.2] 方块转换 Transformations"
layout: "post"
diff: 普及/提高-
pid: P1205
tag: ['搜索', 'USACO']
---
# [USACO1.2] 方块转换 Transformations
## 题目描述

一块 $n \times n$ 正方形的黑白瓦片的图案要被转换成新的正方形图案。写一个程序来找出将原始图案按照以下列转换方法转换成新图案的最小方式：

- 转 $90\degree$：图案按顺时针转 $90\degree$。

- 转 $180\degree$：图案按顺时针转 $180\degree$。

- 转 $270\degree$：图案按顺时针转 $270\degree$。

- 反射：图案在水平方向翻转（以中央铅垂线为中心形成原图案的镜像）。

- 组合：图案在水平方向翻转，然后再按照 $1 \sim 3$ 之间的一种再次转换。

- 不改变：原图案不改变。

- 无效转换：无法用以上方法得到新图案。

如果有多种可用的转换方法，请选择序号最小的那个。

只使用上述 $7$ 个中的一个步骤来完成这次转换。

## 输入格式

第一行一个正整数 $n$。   

然后 $n$ 行，每行 $n$ 个字符，全部为 `@` 或 `-`，表示初始的正方形。

接下来 $n$ 行，每行 $n$ 个字符，全部为 `@` 或 `-`，表示最终的正方形。


## 输出格式

单独的一行包括 $1 \sim 7$ 之间的一个数字（在上文已描述）表明需要将转换前的正方形变为转换后的正方形的转换方法。


## 样例

### 样例输入 #1
```
3
@-@
---
@@-
@-@
@--
--@

```
### 样例输出 #1
```
1

```
## 提示

【数据范围】  
对于 $100\%$ 的数据，$1\le n \le 10$。

题目翻译来自 NOCOW。

USACO Training Section 1.2



---

---
title: "[USACO1.3] 修理牛棚 Barn Repair"
layout: "post"
diff: 普及/提高-
pid: P1209
tag: ['搜索', '贪心', 'USACO', '排序']
---
# [USACO1.3] 修理牛棚 Barn Repair
## 题目描述

在一个月黑风高的暴风雨夜，Farmer John 的牛棚的屋顶、门被吹飞了 好在许多牛正在度假，所以牛棚没有住满。   

牛棚一个紧挨着另一个被排成一行，牛就住在里面过夜。有些牛棚里有牛，有些没有。 所有的牛棚有相同的宽度。   

自门遗失以后，Farmer John 必须尽快在牛棚之前竖立起新的木板。他的新木材供应商将会供应他任何他想要的长度，但是吝啬的供应商只能提供有限数目的木板。 Farmer John 想将他购买的木板总长度减到最少。

给出 $m,s,c$，表示木板最大的数目、牛棚的总数、牛的总数；以及每头牛所在牛棚的编号，请算出拦住所有有牛的牛棚所需木板的最小总长度。

## 输入格式

一行三个整数 $m,s,c$，意义如题目描述。   
接下来 $c$ 行，每行包含一个整数，表示牛所占的牛棚的编号。

## 输出格式

输出一行一个整数，表示所需木板的最小总长度。

## 样例

### 样例输入 #1
```
4 50 18
3 
4 
6 
8 
14
15 
16 
17 
21
25 
26 
27 
30 
31 
40 
41 
42 
43

```
### 样例输出 #1
```
25

```
## 提示

【数据范围】  
对于 $100\%$ 的数据，$1\le m \le 50$，$1\le c \le s \le 200$。 

USACO Training Section 1.3



---

---
title: "[USACO1.3] 最长的回文 Calf Flac"
layout: "post"
diff: 普及/提高-
pid: P1210
tag: ['字符串', '搜索', 'USACO', '枚举']
---
# [USACO1.3] 最长的回文 Calf Flac
## 题目描述

据说如果你给无限只母牛和无限台巨型便携式电脑（有非常大的键盘 ), 那么母牛们会制造出世上最棒的回文。你的工作就是去寻找这些牛制造的奇观（最棒的回文）。

在寻找回文时不用理睬那些标点符号、空格（但应该保留下来以便做为答案输出）, 只用考虑字母 ${\tt A}\sim {\tt Z}$ 和 ${\tt a}\sim {\tt z}$。要你寻找的最长的回文的文章是一个不超过 $20{,}000$ 个字符的字符串。我们将保证最长的回文不会超过 $2{,}000$ 个字符（在除去标点符号、空格之前）。
## 输入格式

输入文件不会超过 $20,000$ 字符。这个文件可能一行或多行，但是每行都不超过 $80$ 个字符（不包括最后的换行符）。
## 输出格式

输出的第一行应该包括找到的最长的回文的长度。

下一行或几行应该包括这个回文的原文（没有除去标点符号、空格），把这个回文输出到一行或多行（如果回文中包括换行符）。

如果有多个回文长度都等于最大值，输出最前面出现的那一个。

## 样例

### 样例输入 #1
```
Confucius say: Madam, I'm Adam. 
```
### 样例输出 #1
```
11
Madam, I'm Adam
```
## 提示

题目翻译来自NOCOW。

USACO Training Section 1.3



---

---
title: "[USACO1.4] 母亲的牛奶 Mother's Milk"
layout: "post"
diff: 普及/提高-
pid: P1215
tag: ['搜索', 'USACO']
---
# [USACO1.4] 母亲的牛奶 Mother's Milk
## 题目描述

农民约翰有三个容量分别是 $a,b,c$ 升的桶。  

最初，$a,b$ 桶都是空的，而 $c$ 桶是装满牛奶的。有时，农民把牛奶从一个桶倒到另一个桶中，直到被灌桶装满或原桶空了。  

当然每一次灌注都是完全的。由于节约，牛奶不会有丢失。

写一个程序去帮助农民找出当 $a$ 桶是空的时候，$c$ 桶中牛奶所剩量的所有可能性。

## 输入格式

单独的一行包括三个整数 $a,b,c$。

## 输出格式

只有一行，升序地列出当 $a$ 桶是空的时候，$c$ 桶牛奶所剩量的所有可能性。

## 样例

### 样例输入 #1
```
8 9 10

```
### 样例输出 #1
```
1 2 8 9 10

```
### 样例输入 #2
```
2 5 10
```
### 样例输出 #2
```
5 6 7 8 9 10
```
## 提示

【数据范围】  
对于 $100\%$ 的数据，$1\le a,b,c \le 20$。

题目翻译来自NOCOW。

USACO Training Section 1.4



---

---
title: "[USACO1.5] 八皇后 Checker Challenge"
layout: "post"
diff: 普及/提高-
pid: P1219
tag: ['搜索', 'USACO', '深度优先搜索 DFS']
---
# [USACO1.5] 八皇后 Checker Challenge
## 题目描述

一个如下的 $6 \times 6$ 的跳棋棋盘，有六个棋子被放置在棋盘上，使得每行、每列有且只有一个，每条对角线（包括两条主对角线的所有平行线）上至多有一个棋子。

![](https://cdn.luogu.com.cn/upload/image_hosting/3h71x0yf.png)

上面的布局可以用序列 $2\ 4\ 6\ 1\ 3\ 5$ 来描述，第 $i$ 个数字表示在第 $i$ 行的相应位置有一个棋子，如下：

行号 $1\ 2\ 3\ 4\ 5\ 6$

列号 $2\ 4\ 6\ 1\ 3\ 5$

这只是棋子放置的一个解。请编一个程序找出所有棋子放置的解。  
并把它们以上面的序列方法输出，解按字典顺序排列。  
请输出前 $3$ 个解。最后一行是解的总个数。


## 输入格式

一行一个正整数 $n$，表示棋盘是 $n \times n$ 大小的。


## 输出格式

前三行为前三个解，每个解的两个数字之间用一个空格隔开。第四行只有一个数字，表示解的总数。

## 样例

### 样例输入 #1
```
6

```
### 样例输出 #1
```
2 4 6 1 3 5
3 6 2 5 1 4
4 1 5 2 6 3
4

```
## 提示

【数据范围】  
对于 $100\%$ 的数据，$6 \le n \le 13$。

题目翻译来自NOCOW。

USACO Training Section 1.5



---

---
title: "[USACO09OCT] Heat Wave G"
layout: "post"
diff: 普及/提高-
pid: P1339
tag: ['图论', '2009', 'USACO', '福建省历届夏令营', '最短路']
---
# [USACO09OCT] Heat Wave G
## 题目描述

有一个 $n$ 个点 $m$ 条边的无向图，请求出从 $s$ 到 $t$ 的最短路长度。
## 输入格式

第一行四个正整数 $n,m,s,t$。
接下来 $m$ 行，每行三个正整数 $u,v,w$，表示一条连接 $u,v$，长为 $w$ 的边。

## 输出格式

输出一行一个整数，表示答案。
## 样例

### 样例输入 #1
```
7 11 5 4
2 4 2
1 4 3
7 2 2
3 4 3
5 7 5
7 3 3
6 1 1
6 3 4
2 4 3
5 6 3
7 2 1
```
### 样例输出 #1
```
7
```
## 提示

【数据范围】  
对于 $100\%$ 的数据，$1\le n \le 2500$，$1\le m \le 6200$，$1\le w \le 1000$。

【样例说明】   
$5 \to 6 \to 1 \to 4$ 为最短路，长度为 $3+1+3 = 7$。




---

---
title: "[USACO1.3] 虫洞 wormhole"
layout: "post"
diff: 普及/提高-
pid: P1444
tag: ['图论', 'USACO', '枚举']
---
# [USACO1.3] 虫洞 wormhole
## 题目描述

Farmer John 周末进行高能物理实验的结果却适得其反，导致 $n$ 个虫洞出现在农场上，农场是一个二维平面，没有两个虫洞处于同一位置。

根据他的计算，FJ 知道他的虫洞两两配对，形成 $\dfrac{n}{2}$ 对配对。例如，如果 $A$ 和 $B$ 的虫洞连接成一对，进入虫洞 $A$ 的任何物体将从虫洞 $B$ 出去，方向不变；反之亦然。  

然而这可能发生相当令人不快的后果。例如，假设有两个成对的虫洞 $A(1,1)$ 和 $B(3,1)$，Bessie 从 $(2,1)$ 开始朝着 $x$ 正方向移动。Bessie 将进入虫洞 $B(3,1)$，从 $A(1,1)$ 出去，然后再次进入 $B$，困在一个无限循环中！

FJ 知道他的农场里每个虫洞的确切位置。他知道 Bessie 总是向 $x$ 正方向走进来，虽然他不记得贝茜的当前位置。  

请帮助 FJ 计算有多少种虫洞配对方案，使得存在一个位置，使得 Bessie 从该位置出发，会被困在一个无限循环中。
## 输入格式

第一行一个正整数 $n$，表示虫洞数量。

接下来 $n$ 行，每行两个整数 $x,y$，表示一个虫洞的坐标。
## 输出格式

输出一行一个整数表示答案。

## 样例

### 样例输入 #1
```
4
0 0
1 0
1 1
0 1
```
### 样例输出 #1
```
2
```
## 提示

### 数据范围
对于 $100\%$ 的数据，$2\le n \le 12$，$0 \le x,y \le 10^9$。  
保证 $n$ 为偶数。

### 样例解释

将虫洞编号为 $1 \sim 4$，然后通过将 $1,2$ 和 $3,4$ 匹配，如果 Bessie 从 $(0,0)$ 到 $(1,0)$ 之间的任意位置出发，她会陷入无限循环中。

相似的，在相同的起始点，如果配对是 $1,3$ 和 $2,4$，贝茜也会陷入循环。（如果贝西从 $3$ 进去，$1$ 出来，她会走向 $2$ ，然后被传送到 $4$，最后又回到 $3$）

仅有 $1,4$ 和 $2,3$ 的配对允许贝茜从任何二维平面上的点向 $x$ 正方向走，而不出现无限循环。

题面翻译摘自 NOCOW


---

---
title: "[USACO2.1] 海明码 Hamming Codes"
layout: "post"
diff: 普及/提高-
pid: P1461
tag: ['搜索', 'USACO', '进制', '位运算']
---
# [USACO2.1] 海明码 Hamming Codes
## 题目描述

给出 $n,b,d$，要求找出 $n$ 个由 $0,1$ 组成的编码，每个编码有 $b$ 位），使得两两编码之间至少有 $d$ 个单位的 “Hamming距离”。“  

Hamming距离”是指对于两个编码，他们二进制表示法中的不同二进制位的数目。看下面的两个编码 `0x554` 和 `0x234`（十六进制数）

```
0x554 = 0101 0101 0100
0x234 = 0010 0011 0100
不同位    xxx  xx
```

因为有五个位不同，所以“Hamming距离”是 $5$。

## 输入格式

一行，包括 $n,b,d$。

## 输出格式

$n$ 个编码（用十进制表示），要排序，十个一行。  
如果有多解，你的程序要输出这样的解：假如把它化为 $2^b$ 进制数，它的值要最小。

## 样例

### 样例输入 #1
```
16 7 3
```
### 样例输出 #1
```
0 7 25 30 42 45 51 52 75 76
82 85 97 102 120 127
```
## 提示

【数据范围】  
对于 $100\%$ 的数据，$1\le n \le 64$，$1\le b \le 8$，$1\le d \le 7$。

请解释：“必须与其他所有的数相比，Hamming 距离都符合要求，这个数才正确”

答：如样例输出，$0,7$，$0,25$，比较都符合海明码，同样 $7,25$，$7,30$，比较也符合要求，以此类推。题中至少有 $d$ 个单位，意思就是大于等于 $d$ 个单位的都可以。


USACO 2.1

翻译来自NOCOW



---

---
title: "[USACO2.2] 序言页码 Preface Numbering"
layout: "post"
diff: 普及/提高-
pid: P1465
tag: ['搜索', 'USACO', '枚举']
---
# [USACO2.2] 序言页码 Preface Numbering
## 题目描述

给定 $n$，求 $1 \sim n$ 的 **罗马数字** 表示中，各个字符出现了多少次。

比如 $n = 5$，表示为  I, II, III, IV, V。总共有 $7$ 个 I 出现，$2$ 个 V 出现。

## 输入格式

一个整数 $n$。

## 输出格式

每行一个字符和一个数字 $k$，表示这个字符出现了 $k$ 次。字符必须按罗马数字表中的递增顺序输出。

## 样例

### 样例输入 #1
```
5

```
### 样例输出 #1
```
I 7
V 2
```
## 提示

【数据范围】  
对于 $100\%$ 的数据，$1\le n \le 3500$。

翻译来自NOCOW

USACO 2.2



---

---
title: "[USACO2.2] 集合 Subset Sums"
layout: "post"
diff: 普及/提高-
pid: P1466
tag: ['递推', 'USACO', '背包 DP']
---
# [USACO2.2] 集合 Subset Sums
## 题目描述

对于从 $1\sim n$ 的连续整数集合，能划分成两个子集合，且保证每个集合的数字和是相等的。举个例子，如果 $n=3$，对于 $\{1,2,3\}$ 能划分成两个子集合，每个子集合的所有数字和是相等的：

$\{3\}$ 和 $\{1,2\}$ 是唯一一种分法（交换集合位置被认为是同一种划分方案，因此不会增加划分方案总数）  
如果 $n=7$，有四种方法能划分集合 $\{1,2,3,4,5,6,7 \}$，每一种分法的子集合各数字和是相等的:

$\{1,6,7\}$ 和 $\{2,3,4,5\}$  
$\{2,5,7\}$ 和 $\{1,3,4,6\}$  
$\{3,4,7\}$ 和 $\{1,2,5,6\}$  
$\{1,2,4,7\}$ 和 $\{3,5,6\}$  

给出 $n$，你的程序应该输出划分方案总数。
## 输入格式

输入文件只有一行，且只有一个整数 $n$

## 输出格式

输出划分方案总数。

## 样例

### 样例输入 #1
```
7

```
### 样例输出 #1
```
4

```
## 提示

【数据范围】  
对于 $100\%$ 的数据，$1\le n \le 39$。

翻译来自NOCOW

USACO 2.2



---

---
title: "[USACO2.3] 零的数列 Zero Sum"
layout: "post"
diff: 普及/提高-
pid: P1473
tag: ['字符串', '搜索', '数学', 'USACO', '进制']
---
# [USACO2.3] 零的数列 Zero Sum
## 题目描述

请考虑一个由 $1$ 到 $N$ 的数字组成的递增数列：$1, 2, 3, \ldots, N$。

现在请在数列中插入 `+` 表示加，或者 `-` 表示减，` `（空格） 表示空白（例如 `1-2 3` 就等于 `1-23`），来将每一对数字组合在一起（请不要在第一个数字前插入符号）。

计算该表达式的结果并判断其值是否为 $0$。 请你写一个程序找出所有产生和为零的长度为N的数列。

## 输入格式

单独的一行表示整数 $N$（$3 \leq N \leq 9$）。

## 输出格式

按照 ASCI I码的顺序，输出所有在每对数字间插入 `+`，`-`，` `（空格） 后能得到结果为零的数列。

## 样例

### 样例输入 #1
```
7

```
### 样例输出 #1
```
1+2-3+4-5-6+7
1+2-3-4+5+6-7
1-2 3+4+5+6+7
1-2 3-4 5+6 7
1-2+3+4-5+6-7
1-2-3-4-5+6+7
```
## 提示

翻译来自NOCOW

USACO 2.3



---

---
title: "[USACO2.3] Money System / [USACO07OCT]Cow Cash G"
layout: "post"
diff: 普及/提高-
pid: P1474
tag: ['动态规划 DP', '2007', 'USACO']
---
# [USACO2.3] Money System / [USACO07OCT]Cow Cash G
## 题目描述

母牛们不但创建了它们自己的政府而且选择了建立了自己的货币系统。由于它们特殊的思考方式，它们对货币的数值感到好奇。

传统地，一个货币系统是由 $1,5,10,20,25,50,100$ 的单位面值组成的。

母牛想知道有多少种不同的方法来用货币系统中的货币来构造一个确定的数值。

举例来说, 使用一个货币系统 $(1,2,5,10, \ldots)$ 产生 $18$ 单位面值的一些可能的方法是：$18 \times 1, 9 \times 2, 8 \times 2+2 \times 1, 3 \times 5+2+1$，等等。

写一个程序来计算有多少种方法用给定的货币系统来构造一定数量的面值。保证总数在 $64$ 位带符号整数的范围内。

## 输入格式

第一行两个整数：货币系统中货币的种类数目 $V$（$1 \leq V \leq 25$）。要构造的数量钱是 $N$（$1 \leq N \leq 10,000$）。

第二行 $V$ 个整数，代表所有可用的货币的面值。
## 输出格式

单独的一行，包含用这 $V$ 种硬币凑足 $N$ 单位货币的方案数。

## 样例

### 样例输入 #1
```
3 10
1 2 5

```
### 样例输出 #1
```
10

```
## 提示

翻译来自NOCOW

USACO 2.3



---

---
title: "[USACO2.3] 控制公司 Controlling Companies"
layout: "post"
diff: 普及/提高-
pid: P1475
tag: ['搜索', 'USACO']
---
# [USACO2.3] 控制公司 Controlling Companies
## 题目描述

有些公司是其他公司的部分拥有者，因为他们获得了其他公司发行的股票的一部分。

据说，如果至少满足了以下三个条件之一，公司 $A$ 就可以控制公司 $B$ 了：

- 公司 $A$ = 公司 $B$。
- 公司 $A$ 拥有大于 $50\%$ 的公司 $B$ 的股票。
- 公司 $A$ 控制 $K$（$K \geq 1$）个公司，记为 $C_1, \ldots, C_K$，每个公司 $C_i$ 拥有 $x_i\%$ 的公司 $B$ 的股票，并且 $x_1+ \ldots + x_K \gt 50\%$。

给你一个表，每行包括三个数 $i,j,p$：表明公司 $i$ 享有公司 $j$ 的 $p\%$ 的股票。计算所有的数对 $(h,s)$，表明公司 $h$ 控制公司 $s$。至多有 $100$ 个公司。
## 输入格式

第一行一个整数 $N$，表明表格的行数。

接下来 $N$ 行，每行三个整数 $i,j,p$，表示 $i$ 公司拥有 $j$ 公司 $p\%$ 的股份。
## 输出格式

输出零个或更多个的控制其他公司的公司。每行包括两个整数 $A,B$，表示 $A$ 公司控制了 $B$ 公司。将输出的数对以 $A$ 为第一关键字，$B$ 为第二关键字升序排列。

请不要输出控制自己的公司（即你输出的数对均要满足 $A \neq B$）。
## 样例

### 样例输入 #1
```
3
1 2 80
2 3 80
3 1 20
```
### 样例输出 #1
```
1 2
1 3
2 3
```
## 提示

翻译来自NOCOW

USACO 2.3



---

---
title: "[USACO2.4] 两只塔姆沃斯牛 The Tamworth Two"
layout: "post"
diff: 普及/提高-
pid: P1518
tag: ['模拟', 'USACO']
---
# [USACO2.4] 两只塔姆沃斯牛 The Tamworth Two
## 题目描述

两只牛逃跑到了森林里。Farmer John 开始用他的专家技术追捕这两头牛。你的任务是模拟他们的行为（牛和 John）。

追击在 $10 \times 10$ 的平面网格内进行。一个格子可以是：一个障碍物，两头牛（它们总在一起），或者 Farmer John。两头牛和 Farmer John 可以在同一个格子内（当他们相遇时），但是他们都不能进入有障碍的格子。

一个格子可以是：
- `.` 空地；
- `*` 障碍物；
- `C` 两头牛；
- `F` Farmer John。

这里有一个地图的例子：

```plain
*...*.....
......*...
...*...*..
..........
...*.F....
*.....*...
...*......
..C......*
...*.*....
.*.*......
```

牛在地图里以固定的方式游荡。每分钟，它们可以向前移动或是转弯。如果前方无障碍（地图边沿也是障碍），它们会按照原来的方向前进一步。否则它们会用这一分钟顺时针转 90 度。 同时，它们不会离开地图。

Farmer John 深知牛的移动方法，他也这么移动。

每次（每分钟）Farmer John 和两头牛的移动是同时的。如果他们在移动的时候穿过对方，但是没有在同一格相遇，我们不认为他们相遇了。当他们在某分钟末在某格子相遇，那么追捕结束。

读入十行表示地图。每行都只包含 10 个字符，表示的含义和上面所说的相同。保证地图中只有一个 `F` 和一个 `C`。`F` 和 `C` 一开始不会处于同一个格子中。

计算 Farmer John 需要多少分钟来抓住他的牛，假设牛和 Farmer John 一开始的行动方向都是正北（即上）。 如果 John 和牛永远不会相遇，输出 0。
## 输入格式

输入共十行，每行 10 个字符，表示如上文描述的地图。

## 输出格式

输出一个数字，表示 John 需要多少时间才能抓住牛们。如果 John 无法抓住牛，则输出 0。
## 样例

### 样例输入 #1
```
*...*.....
......*...
...*...*..
..........
...*.F....
*.....*...
...*......
..C......*
...*.*....
.*.*......
```
### 样例输出 #1
```
49
```
## 提示

翻译来自NOCOW

USACO 2.4



---

---
title: "[USACO2.4] 穿越栅栏 Overfencing"
layout: "post"
diff: 普及/提高-
pid: P1519
tag: ['搜索', 'USACO']
---
# [USACO2.4] 穿越栅栏 Overfencing
## 题目描述

Farmer John 在外面的田野上搭建了一个巨大的用栅栏围成的迷宫。幸运的是，他在迷宫的边界上留出了两段栅栏作为迷宫的出口。更幸运的是，他所建造的迷宫是一个“完美的”迷宫：即你能从迷宫中的任意一点找到一条走出迷宫的路。

给定迷宫的宽度 $W$（$1 \leq W \leq 38$）及高度 $H$（$1 \leq H \leq 100$）。$2 \times H+1$ 行，每行 $2 \times W+1$ 的字符以下面给出的格式表示一个迷宫。然后计算从迷宫中最“糟糕”的那一个点走出迷宫所需的步数（即使从这一点以最优的方式走向最靠近的出口，它仍然需要最多的步数）。

当然了，牛们只会水平或垂直地在 X 或 Y 轴上移动，他们从来不走对角线。每移动到一个新的方格算作一步（包括移出迷宫的那一步）。

这是一个 $W=5,H=3$ 的迷宫：

```plain
+-+-+-+-+-+
|         |
+-+ +-+ + +
|     | | |
+ +-+-+ + +
| |     |  
+-+ +-+-+-+
```
如上图的例子，栅栏的柱子只出现在奇数行或奇数列。每个迷宫只有两个出口。
## 输入格式

第一行两个整数 $W,H$。

接下来 $2 \times H+1$ 行：每行 $2 \times W+1$ 个字符，描述一个迷宫。

## 输出格式

输出一个单独的整数，表示最坏情况下牛走出迷宫的最小步数。

## 样例

### 样例输入 #1
```
5 3
+-+-+-+-+-+
|         |
+-+ +-+ + +
|     | | |
+ +-+-+ + +
| |     |  
+-+ +-+-+-+
```
### 样例输出 #1
```
9

```
## 提示

翻译来自NOCOW

USACO 2.4



---

---
title: "[USACO2.4] 回家 Bessie Come Home"
layout: "post"
diff: 普及/提高-
pid: P1529
tag: ['图论', 'USACO', '最短路']
---
# [USACO2.4] 回家 Bessie Come Home
## 题目描述

现在是晚餐时间，而母牛们在外面分散的牧场中。 

Farmer John 按响了电铃，所以她们开始向谷仓走去。 你的工作是要指出哪只母牛会最先到达谷仓（在给出的测试数据中，总会**有且只有**一只最快的母牛）。在挤奶的时候（晚餐前），每只母牛都在她自己的牧场上，一些牧场上可能没有母牛。

每个牧场由一条条道路和一个或多个牧场连接（可能包括自己）。有时，两个牧场（可能是字母相同的）之间会有超过一条道路相连。至少有一个牧场和谷仓之间有道路连接。因此，所有的母牛最后都能到达谷仓，并且母牛总是走最短的路径。当然，母牛能向着任意一方向前进，并且她们以相同的速度前进。牧场被标记为 $\texttt{a} \ldots \texttt{z}$ 和 $\texttt{A} \ldots \texttt{Y}$，在用大写字母表示的牧场中有一只母牛，小写字母中则没有。 谷仓的标记是 $\texttt{Z}$，注意没有母牛在谷仓中。

**注意 $\texttt{m}$ 和 $\texttt{M}$ 不是同一个牧场**。
## 输入格式

第一行一个整数 $P$（$1\leq P \leq 10^4$），表示连接牧场（谷仓）的道路的数目。

接下来 $P$ 行，每行用空格分开的两个字母和一个正整数：被道路连接牧场的标号和道路的长度（道路长度均不超过 $10^3$）。

## 输出格式

单独的一行包含二个项目：最先到达谷仓的母牛所在的牧场的标号，和这只母牛走过的路径的长度。
## 样例

### 样例输入 #1
```
5
A d 6
B d 3
C e 9
d Z 8
e Z 3
```
### 样例输出 #1
```
B 11

```
## 提示

翻译来自 NOCOW

USACO 2.4



---

---
title: "[USACO2.4] 分数化小数 Fractions to Decimals"
layout: "post"
diff: 普及/提高-
pid: P1530
tag: ['模拟', '数学', 'USACO']
---
# [USACO2.4] 分数化小数 Fractions to Decimals
## 题目描述

写一个程序，输入一个形如 $\dfrac{N}{D}$ 的分数，输出它的小数形式。如果小数有循环节的话，把循环节放在一对圆括号中。

例如，$\dfrac{1}{3}=0.33333333\ldots$ 写成 $0.(3)$，$\dfrac{41}{333}= 0.123123123\ldots$ 写成 $0.(123)$，整数 $x$ 写成 $x.0$。
## 输入格式

输入包含两个整数 $N$ 和 $D$（$1 \leq N,D \leq 10^5$）。
## 输出格式

输出按照上面规则计算出的小数表达式。如果结果长度大于 $76$，每行输出 $76$ 个字符。
## 样例

### 样例输入 #1
```
45 56
```
### 样例输出 #1
```
0.803(571428)
```
## 提示

翻译来自NOCOW

USACO 2.4



---

---
title: "[USACO08MAR] Cow Travelling S"
layout: "post"
diff: 普及/提高-
pid: P1535
tag: ['搜索', '2008', 'USACO', '剪枝']
---
# [USACO08MAR] Cow Travelling S
## 题目描述

奶牛们在被划分成 $N$ 行 $M$ 列（$2 \leq N,M \leq 100$）的草地上游走， 试图找到整块草地中最美味的牧草。

Farmer John 在某个时刻看见贝茜在位置 $(R_1, C_1)$，恰好 $T$（$0 \lt T \leq 15$）秒后，FJ 又在位置 $(R_2, C_2)$ 与贝茜撞了正着。FJ 并不知道在这 $T$ 秒内贝茜是否曾经到过 $(R_2, C_2)$，他能确定的只是，现在贝茜在那里。

设 $S$ 为奶牛在 $T$ 秒内从 $(R_1, C_1)$ 走到 $(R_2, C_2)$ 所能选择的路径总数，FJ 希望有一个程序来帮他计算这个值。每一秒内，奶牛会水平或垂直地移动 $1$ 单位距离（奶牛总是在移动，不会在某秒内停在它上一秒所在的点）。草地上的某些地方有树，自然，奶牛不能走到树所在的位置，也不会走出草地。

现在你拿到了一张整块草地的地形图，其中 `.` 表示平坦的草地，`*` 表示挡路的树。你的任务是计算出，一头在 $T$ 秒内从 $(R_1, C_1)$ 移动到 $(R_2, C_2)$ 的奶牛可能经过的路径有哪些。
## 输入格式

第一行包含 $3$ 个用空格隔开的整数：$N,M,T$。

接下来 $N$ 行：第 $i$ 行为 $M$ 个连续的字符，描述了草地第 $i$ 行各点的情况，保证字符是 `.` 和 `*` 中的一个。

最后一行 $4$ 个整数 $R_1,C_1,R_2,C_2$。
## 输出格式

输出从 $(R_1, C_1)$ 移动到 $(R_2, C_2)$ 的方案数。
## 样例

### 样例输入 #1
```
4 5 6
...*.
...*.
.....
.....
1 3 1 5
```
### 样例输出 #1
```
1

```
## 提示

奶牛在 $6$ 秒内从 $(1,3)$ 走到 $(1,5)$ 的方法只有一种，绕过她面前的树。


---

---
title: "[USACO3.1] 最短网络 Agri-Net"
layout: "post"
diff: 普及/提高-
pid: P1546
tag: ['图论', '贪心', 'USACO', '并查集', '生成树']
---
# [USACO3.1] 最短网络 Agri-Net
## 题目背景

Farmer John 被选为他们镇的镇长！他其中一个竞选承诺就是在镇上建立起互联网，并连接到所有的农场。当然，他需要你的帮助。

## 题目描述

FJ 已经给他的农场安排了一条高速的网络线路，他想把这条线路共享给其他农场。为了用最小的消费，他想铺设最短的光纤去连接所有的农场。

你将得到一份各农场之间连接费用的列表，你必须找出能连接所有农场并所用光纤最短的方案。每两个农场间的距离不会超过 $10^5$。
## 输入格式

第一行农场的个数 $N$（$3 \leq N \leq 100$）。

接下来是一个 $N \times N$ 的矩阵，表示每个农场之间的距离。理论上，他们是 $N$ 行，每行由 $N$ 个用空格分隔的数组成，实际上，由于每行 $80$ 个字符的限制，因此，某些行会紧接着另一些行。当然，对角线将会是 $0$，因为不会有线路从第 $i$ 个农场到它本身。
## 输出格式

只有一个输出，其中包含连接到每个农场的光纤的最小长度。

## 样例

### 样例输入 #1
```
4
0 4 9 21
4 0 8 17
9 8 0 16
21 17 16 0
```
### 样例输出 #1
```
28
```
## 提示

题目翻译来自NOCOW。

USACO Training Section 3.1



---

---
title: "[USACO05MAR] Out of Hay S"
layout: "post"
diff: 普及/提高-
pid: P1547
tag: ['图论', '贪心', '2005', 'USACO', '并查集', '生成树', '连通块']
---
# [USACO05MAR] Out of Hay S
## 题目描述

Bessie 计划调查 $N$（$2 \leq N \leq 2\,000$）个农场的干草情况，它从 $1$ 号农场出发。农场之间总共有 $M$（$1 \leq M \leq 10^4$）条双向道路，所有道路的总长度不超过 $10^9$。有些农场之间存在着多条道路，所有的农场之间都是连通的。

Bessie 希望计算出该图中最小生成树中的最长边的长度。

## 输入格式

第一行两个整数 $N,M$。

接下来 $M$ 行，每行三个用空格隔开的整数 $A_i,B_i,L_i$，表示 $A_i,B_i$ 之间有一条道路，长度为 $L_i$。
## 输出格式

一个整数，表示最小生成树中的最长边的长度。

## 样例

### 样例输入 #1
```
3 3
1 2 23
2 3 1000
1 3 43
```
### 样例输出 #1
```
43
```


---

---
title: "[USACO08OCT] Watering Hole G"
layout: "post"
diff: 普及/提高-
pid: P1550
tag: ['图论', '贪心', '2008', 'USACO']
---
# [USACO08OCT] Watering Hole G
## 题目描述

Farmer John 的农场缺水了。

他决定将水引入到他的 $n$ 个农场。他准备通过挖若干井，并在各块田中修筑水道来连通各块田地以供水。在第 $i$ 号田中挖一口井需要花费 $W_i$ 元。连接 $i$ 号田与 $j$ 号田需要 $P_{i,j}$（$P_{j,i}=P_{i,j}$）元。

请求出 FJ 需要为使所有农场都与有水的农场相连或拥有水井所需要的最少钱数。
## 输入格式

第一行为一个整数 $n$。

接下来 $n$ 行，每行一个整数 $W_i$。

接下来 $n$ 行，每行 $n$ 个整数，第 $i$ 行的第 $j$ 个数表示连接 $i$ 号田和 $j$ 号田需要的费用 $P_{i,j}$。
## 输出格式

输出最小开销。

## 样例

### 样例输入 #1
```
4
5
4
4
3
0 2 2 2
2 0 3 3
2 3 0 4
2 3 4 0
```
### 样例输出 #1
```
9
```
## 提示

对于 $100\%$ 的数据，$1 \leq n \leq 300$，$1 \leq W_i \leq 10^5$，$0 \leq P_{i,j} \leq 10^5$。


---

---
title: "尴尬的数字"
layout: "post"
diff: 普及/提高-
pid: P1555
tag: ['模拟', '数学', 'USACO', '枚举', '进制']
---
# 尴尬的数字
## 题目背景

Bessie 刚刚学会了不同进制数之间的转换，但是她总是犯错误，因为她的两个前蹄不能轻松的握住钢笔。

## 题目描述

每当 Bessie 将一个数转换成新的进制时，她总会写错一位数字。例如，她将 14 转化成 2 进制数，正确的结果是 1110，但她可能会写成 0110 或 1111。Bessie 从不会意外的增加或删减数字，所以她可能会写出以 0 开头的错误数字。

给出 Bessie 转换后 $N$ 的 2 进制形式和 3 进制形式，请计算出 $N$ 的正确数值（用十进制表示）。$N$ 可能会达到 $10^9$，输入数据保证解的存在唯一性。

## 输入格式

第一行，$N$ 的 2 进制表示（有一位是错误的数字）。

第二行，$N$ 的 3 进制表示（有一位是错误的数字）。
## 输出格式

$N$ 的正确值。

## 样例

### 样例输入 #1
```
1010
212
```
### 样例输出 #1
```
14
```


---

---
title: "逛画展"
layout: "post"
diff: 普及/提高-
pid: P1638
tag: ['二分', 'USACO', '单调队列', '队列', '双指针 two-pointer']
---
# 逛画展
## 题目描述


博览馆正在展出由世上最佳的 $m$ 位画家所画的图画。

游客在购买门票时必须说明两个数字，$a$ 和 $b$，代表他要看展览中的第 $a$ 幅至第 $b$ 幅画（包含 $a,b$）之间的所有图画，而门票的价钱就是一张图画一元。

Sept 希望入场后可以看到所有名师的图画。当然，他想最小化购买门票的价格。

请求出他购买门票时应选择的 $a,b$，数据保证一定有解。

若存在多组解，**输出 $a$ 最小的那组**。
## 输入格式

第一行两个整数 $n,m$，分别表示博览馆内的图画总数及这些图画是由多少位名师的画所绘画的。

第二行包含 $n$ 个整数 $a_i$，代表画第 $i$ 幅画的名师的编号。

## 输出格式

一行两个整数 $a,b$。
## 样例

### 样例输入 #1
```
12 5
2 5 3 1 3 2 4 1 1 5 4 3

```
### 样例输出 #1
```
2 7
```
## 提示

#### 数据规模与约定

- 对于 $30\%$ 的数据，有 $n\le200$，$m\le20$。
- 对于 $60\%$ 的数据，有 $n\le10^5$，$m\le10^3$。
- 对于 $100\%$ 的数据，有 $1\leq n\le10^6$，$1 \leq a_i \leq m\le2\times10^3$。


---

---
title: "[USACO07OCT] Obstacle Course S"
layout: "post"
diff: 普及/提高-
pid: P1649
tag: ['动态规划 DP', '图论', '2007', 'USACO', '广度优先搜索 BFS']
---
# [USACO07OCT] Obstacle Course S
## 题目描述

Consider an N x N (1 <= N <= 100) square field composed of 1

by 1 tiles. Some of these tiles are impassible by cows and are marked with an 'x' in this 5 by 5 field that is challenging to navigate:

```cpp
. . B x . 
. x x A . 
. . . x . 
. x . . . 
. . x . . 
```
Bessie finds herself in one such field at location A and wants to move to location B in order to lick the salt block there.  Slow, lumbering creatures like cows do not like to turn and, of course, may only move parallel to the edges of the square field. For a given field, determine the minimum number of ninety degree turns in any path from A to B. The path may begin and end with Bessie facing in any direction. Bessie knows she can get to the salt lick.


## 输入格式

第一行一个整数 $N$,下面 $N$ 行，每行 $N$ 个字符，只出现字符：$\verb!.!,\verb!x!,\verb!A!,\verb!B!$，表示上面所说的矩阵格子，每个字符后有一个空格。

## 输出格式

一个整数：最少转弯次数。如果不能到达，输出 $-1$。

## 样例

### 样例输入 #1
```
3
. x A
. . .
B x .
```
### 样例输出 #1
```
2
```
## 提示

只可以上下左右四个方向行走，并且不能走出这些格子之外。开始和结束时的方向可以任意。

### 数据范围及约定

对于全部数据，保证 $2\le N\le 100$。

## 题目翻译

$N\times N\ (1\le N\le 100)$ 方格中，$\verb!x!$ 表示不能行走的格子，$\verb!.!$ 表示可以行走的格子。卡门很胖，故而不好转弯。现在要从 $A$ 点走到 $B$ 点，请问最少要转 $90$ 度弯多少次？


---

---
title: "[USACO04DEC] Bad Cowtractors S"
layout: "post"
diff: 普及/提高-
pid: P1669
tag: ['2004', 'USACO', '生成树']
---
# [USACO04DEC] Bad Cowtractors S
## 题目描述

奶牛贝茜被雇去建设 $N(2\le N\le 10^3)$ 个牛棚间的互联网。她已经勘探出 $M(1\le M\le 2\times 10^4)$ 条可建的线路，每条线路连接两个牛棚，而且会花费 $C(1\le C\le 10^5)$。农夫约翰吝啬得很，他希望建设费用最少甚至他都不想给贝茜工钱。贝茜得知工钱要告吹，决定报复。她打算选择建一些线路，把所有牛棚连接在一起，让约翰花费最大。但是她不能造出环来，这样约翰就会发现。
## 输入格式

第 $1$ 行：$N$，$M$。

第 $2$ 到 $M+1$ 行：三个整数，表示一条可能线路的两个端点和费用。
## 输出格式

一行，表示最大的花费。如果不能建成合理的线路，就输出 $-1$。
## 样例

### 样例输入 #1
```
5 8
1 2 3
1 3 7
2 3 10
2 4 4
2 5 8
3 4 6
3 5 2
4 5 17
```
### 样例输出 #1
```
42
```
## 提示

$2\le N\le 10^3$，$1\le M\le 2\times 10^4$，$1\le C\le 10^5$。


---

---
title: "[USACO05FEB] Rigging the Bovine Election S"
layout: "post"
diff: 普及/提高-
pid: P1671
tag: ['搜索', '2005', 'USACO']
---
# [USACO05FEB] Rigging the Bovine Election S
## 题目描述

农场被划分为 $5\times 5$ 的格子，每个格子中都有一头奶牛，并且只有荷斯坦（标记为 `H`）和杰西（标记为 `J`）两个品种。如果一头奶牛在另一头上下左右四个格子中的任一格里，我们说它们相连。奶牛要大选了。现在杰西奶牛们想选择 $7$ 头相连的奶牛，划成一个竞选区，使得其中它们品种的奶牛比荷斯坦的多。

要求你编写一个程序求出方案总数。

## 输入格式

$5$ 行，表示农场的情况。
## 输出格式

输出划区方案总数。
## 样例

### 样例输入 #1
```
HHHHH
JHJHJ
HHHHH
HJHHJ
HHHHH
```
### 样例输出 #1
```
2
```


---

---
title: "[USACO05FEB] Feed Accounting S"
layout: "post"
diff: 普及/提高-
pid: P1672
tag: ['2005', 'USACO', '差分']
---
# [USACO05FEB] Feed Accounting S
## 题目描述

约翰想知道上一船饲料是什么时候运到的。在饲料运到之前，他的牛正好把仓库里原来的饲料全吃光了。他收到运来的 $F1(1\le F1\le 10^6)$ 千克饲料。遗憾的是，他已经不记得这是哪一天的事情了。到第 $D(1\le D\le 2\times 10^3)$ 天为止，仓库里还剩下 $F2(1\le F2\le F1)$ 千克饲料。

约翰养了 $C(1\le C\le 100)$ 头牛，每头牛每天都吃掉恰好 $1$ 千克饲料。由于不同的原因，牛们从某一天开始在仓库吃饲料，又在某一天离开仓库，所以不同的两天可能会有差距很大的饲料消耗量。每头牛在来的那天和离开的那天都在仓库吃饲料。给出今天的日期 $D$，写一个程序，判断饲料**最近**一次运到是在什么时候。今天牛们已经吃过饲料了，并且饲料运到的那天牛们还没有吃过饲料。

**如果最终的答案有多个可能，请输出最大的（即，最近的）那一个。**
## 输入格式

第 $1$ 行：四个整数 $C$，$F1$，$F2$，$D$，用空格隔开。

第 $2$ 到 $C+1$ 行：每行是用空格隔开的两个数字，分别表示一头牛来仓库吃饲料的时间和离开的时间。
## 输出格式

一个正整数，即上一船饲料运到的时间。
## 样例

### 样例输入 #1
```
3 14 4 10
1 9
5 8
8 12
```
### 样例输出 #1
```
6
```
## 提示

### 样例解释

上一次运来了 $14$ 千克饲料，现在饲料还剩下 $4$ 千克。最近 $10$ 天里，有 $3$ 头牛来吃过饲料。

约翰在第 $6$ 天收到 $14$ 千克饲料，当天吃掉 $2$ 千克，第 $7$ 天吃掉 $2$ 千克，第 $8$ 天吃掉 $3$ 千克，第 $9$ 天吃掉 $2$ 千克，第 $10$ 天吃掉 $1$ 千克，正好还剩 $4$ 千克。

### 数据规模

$1\le F2\le F1\le 10^6$，$1\le D\le 2\times 10^3$，$1\le C\le 100$。


---

---
title: "[USACO05FEB] Part Acquisition S"
layout: "post"
diff: 普及/提高-
pid: P1673
tag: ['2005', 'USACO', '最短路']
---
# [USACO05FEB] Part Acquisition S
## 题目描述

奶牛们接到了寻找一种新型挤奶机的任务，为此它们准备依次经过 $N(1\le N\le 5\times 10^4)$ 颗行星，在行星上进行交易。为了方便，奶牛们已经给可能出现的 $K(1\le K\le 10^3)$ 种货物进行了由 $1$ 到 $K$ 的标号。由于这些行星都不是十分发达。没有流通的货币，所以在每个市场里都只能用固定的一种货物去换取另一种货物。奶牛们带着一种上好的饲料从地球出发，希望在使用的物品的种类数量最少的情况下，最终得到所需要的机器。饲料的标号为 $1$，所需要的机器的标号为 $K$。如果任务无法完成，输出 $-1$。
## 输入格式

第 $1$ 行是两个数字 $N$ 和 $K$。

第 $2$ 到 $N+1$ 行，每行是两个数字 $A_i$ 和 $B_i$，表示第 $i$ 颗行星为得到 $A_i$ 愿意提供 $B_i$。
## 输出格式

输出最少经手物品数。
## 样例

### 样例输入 #1
```
6 5
1 3
3 2
2 3
3 1
2 5
5 4
```
### 样例输出 #1
```
4
```
## 提示

奶牛们至少需要 $4$ 种不同标号的物品，先用 $1$ 去交换 $3$，再用 $3$ 去交换 $2$，最后用 $2$ 交换得到 $5$。

$1\le N\le 5\times 10^4$，$1\le K\le 10^3$。


---

---
title: "[USACO19FEB] The Great Revegetation B"
layout: "post"
diff: 普及/提高-
pid: P1694
tag: ['贪心', '2019', 'USACO', 'O2优化']
---
# [USACO19FEB] The Great Revegetation B
## 题目描述

长时间的干旱使得 Farmer John 的 $N$ 块草地上牧草匮乏。随着雨季即将到来，现在应当是重新种植的时候了。

在 Farmer John 的储物棚里有四个桶，每个桶里装着一种不同的草种。他想要在每块草地上播种其中一种草。作为一名奶农，Farmer John 想要确保他的每头奶牛都能得到丰富的食谱。他的 $M$ 头奶牛每一头都有两块喜爱的草地，他想要确保这两块草地种植不同种类的草，从而每头奶牛都可以有两种草可供选择。Farmer John 知道没有一块草地受到多于 $3$ 头奶牛的喜爱。

请帮助 Farmer John 选择每块草地所种的草的种类，使得所有奶牛的营养需求都得到满足。 
## 输入格式

输入的第一行包含 $2 \leq N \leq 100$ 和 $1 \leq M \leq 150$。以下 $M$ 行，每行包含两个范围为 $1 \dots N$ 的整数，为 Farmer John 的一头奶牛喜欢的两块草地。
## 输出格式

输出一个 $N$ 位数，每一位均为 $1\ldots 4$ 之一，表示每一块草地上所种的草的种类。第一位对应草地 $1$ 的草的种类，第二位对应草地 $2$，以此类推。如果有多种可行的解，只需输出所有解中最小的 $N$ 位数。 
## 样例

### 样例输入 #1
```
5 6
4 1
4 2
4 3
2 5
1 2
1 5
```
### 样例输出 #1
```
12133
```


---

---
title: "[USACO19OPEN] Cow Evolution B"
layout: "post"
diff: 普及/提高-
pid: P1701
tag: ['2019', 'USACO', 'O2优化', '树的遍历']
---
# [USACO19OPEN] Cow Evolution B
## 题目描述

现在是 3019 年，在过去的一千年里发生了不计其数的牛类进化，产生了具有各种有趣特性的奶牛。

牛类进化的记录可以用一棵树来表示，起源是位于树根位置的没有特殊特性的奶牛。树上每一个产生后代的结点，有可能所有的奶牛都进化出了一种新的特性（比如说喷火（fire breathing），如下图所示，其中所有斑点（spots）奶牛最后都能喷火），或者是奶牛种群产生了分支进化，其中有些进化出了新的特性（比如，飞（flying）），有的没有。 

![](https://cdn.luogu.com.cn/upload/image_hosting/q7v0zhg4.png)

树底部的叶结点表示 3019 年所有产生的奶牛的子种群。没有不同的叶结点（子种群）具有完全相同的一组特性。例如，子种群 #1 是没有特殊特性的奶牛，子种群 #3 是能够心灵感应的（telepathic）会飞的奶牛。相比之下，子种群 #2 是会飞但不能心灵感应的奶牛。子种群 #3 是唯一既会飞又会心灵感应的。

像上图这样每一种进化出的新特性都恰好在树中的一条边上产生（也就是说，在整个进化历史中仅在一个时间点产生），这样的进化树被称为是“合法的”。例如，如果斑点这一特性在两个不同分支中均进化产生，这棵进化树就不是合法的。给定 3019 年奶牛子种群的描述，请判断是否这可以由一棵合法的进化树所解释。 
## 输入格式

输入的第一行包含子种群的数量 $N$（$2\le N\le 25$）。以下 $N$ 行每行描述一个子种群。每行包含一个整数 $K$（$0\le K\le 25$），之后是 $K$ 个该子种群奶牛所拥有的特性。特性是由至多 $20$ 个小写字母（`a..z`）组成的字符串。没有两个子种群拥有完全相同的特性。 
## 输出格式

 如果可能构造一棵可以解释所有子种群产生途径的进化树，输出 `yes`，否则输出 `no`。 
## 样例

### 样例输入 #1
```
4
2 spots firebreathing
0
1 flying
2 telepathic flying
```
### 样例输出 #1
```
yes
```
## 提示

### 样例解释 1


这个输入样例与上图所示的合法进化树一致。 


---

---
title: "H数"
layout: "post"
diff: 普及/提高-
pid: P1748
tag: ['模拟', '数学', '线性数据结构', 'USACO']
---
# H数
## 题目描述

所谓 H 数，是指只含有 $2,3,5,7$ 这些质因数的数，如 $630$ 是 H 数，而 $22$ 不是。

现在要求输出第 $n$ 个 H 数，为了方便起见将 $H[1]$ 定为 $1$。已知 $n$ 不超过 $10000$，最后数据在 int64 范围之内。

## 输入格式

一个数 $n$(如题目)

## 输出格式

第 $n$ 个H数

## 样例

### 样例输入 #1
```
30
```
### 样例输出 #1
```
49
```
### 样例输入 #2
```
1
```
### 样例输出 #2
```
1
```
## 提示

穷举会爆掉，要用生成法，最好加优化，不然空间复杂度比较大



---

---
title: "[USACO07FEB] Cow Party S"
layout: "post"
diff: 普及/提高-
pid: P1821
tag: ['图论', '2007', 'USACO', 'O2优化', '最短路']
---
# [USACO07FEB] Cow Party S
## 题目描述

寒假到了，$n$ 头牛都要去参加一场在编号为 $x$ 的牛的农场举行的派对，农场之间有 $m$ 条有向路，每条路都有一定的长度。

每头牛参加完派对后都必须回家，无论是去参加派对还是回家，每头牛都会选择最短路径，求这 $n$ 头牛的最短路径（一个来回）中最长的一条路径长度。

## 输入格式

第一行有三个整数，分别表示牛的数量 $n$，道路数 $m$ 和派对农场编号 $x$。  
接下来 $m$ 行，每行三个整数 $u, v, w$，表示存在一条由 $u$ 通向 $v$ 的长度为 $w$ 的道路。
## 输出格式

输出一行一个整数表示答案。
## 样例

### 样例输入 #1
```
4 8 2
1 2 4
1 3 2
1 4 7
2 1 1
2 3 5
3 1 2
3 4 4
4 2 3

```
### 样例输出 #1
```
10
```
## 提示

### 样例 1 解释
![](https://cdn.luogu.com.cn/upload/image_hosting/rl3com2y.png)

### 数据规模与约定

对于全部的测试点，保证 $1 \leq x \leq n \leq 10^3$，$1 \leq m \leq 10^5$，$1 \leq u,v \leq n$，$1 \leq w \leq 10^2$，保证从任何一个结点出发都能到达 $x$ 号结点，且从 $x$ 出发可以到达其他所有节点。


---

---
title: "[USACO11OPEN] Corn Maze S"
layout: "post"
diff: 普及/提高-
pid: P1825
tag: ['模拟', '搜索', '2011', 'USACO', '广度优先搜索 BFS', '最短路']
---
# [USACO11OPEN] Corn Maze S
## 题目描述

This past fall, Farmer John took the cows to visit a corn maze. But this wasn't just any corn maze: it featured several gravity-powered teleporter slides, which cause cows to teleport instantly from one point in the maze to another. The slides work in both directions: a cow can slide from the slide's start to the end instantly, or from the end to the start. If a cow steps on a space that hosts either end of a slide, she must use the slide.

The outside of the corn maze is entirely corn except for a single exit.

The maze can be represented by an N x M (2 <= N <= 300; 2 <= M <= 300) grid. Each grid element contains one of these items:

\* Corn (corn grid elements are impassable) 

\* Grass (easy to pass through!) 

\* A slide endpoint (which will transport a cow to the other endpoint) 

\* The exit

A cow can only move from one space to the next if they are adjacent and neither contains corn. Each grassy space has four potential neighbors to which a cow can travel. It takes 1 unit of time to move from a grassy space to an adjacent space; it takes 0 units of time to move from one slide endpoint to the other.

Corn-filled spaces are denoted with an octothorpe (#). Grassy spaces are denoted with a period (.). Pairs of slide endpoints are denoted with the same uppercase letter (A-Z), and no two different slides have endpoints denoted with the same letter. The exit is denoted with the equals sign (=).

Bessie got lost. She knows where she is on the grid, and marked her current grassy space with the 'at' symbol (@). What is the minimum time she needs to move to the exit space?

## 输入格式

第一行：两个用空格隔开的整数 $N$ 和 $M$。

第 $2\sim N+1$ 行：第 $i+1$ 行描述了迷宫中的第 $i$ 行的情况（共有$M$个字符，每个字符中间没有空格）。
## 输出格式

一个整数，表示起点到出口所需的最短时间。
## 样例

### 样例输入 #1
```
5 6
###=##
#.W.##
#.####
#.@W##
######

```
### 样例输出 #1
```
3
```
## 提示

例如以下矩阵，$N=5,M=6$。

```plain
###=##
#.W.##
#.####
#.@W##
######
```

唯一的一个装置的结点用大写字母 $\tt{W}$ 表示。

最优方案为：先向右走到装置的结点，花费一个单位时间，再到装置的另一个结点上，花费 $0$ 个单位时间，然后再向右走一个，再向上走一个，到达出口处，总共花费了 $3$ 个单位时间。
## 题目翻译

奶牛们去一个 $N\times M$ 玉米迷宫，$2 \leq N \leq 300,2 \leq M \leq300$。

迷宫里有一些传送装置，可以将奶牛从一点到另一点进行瞬间转移。这些装置可以双向使用。

如果一头奶牛处在这个装置的起点或者终点，这头奶牛就必须使用这个装置，奶牛在传送过后不会立刻进行第二次传送，即不会卡在传送装置的起点和终点之间来回传送。

玉米迷宫除了唯一的一个出口都被玉米包围。

迷宫中的每个元素都由以下项目中的一项组成：

1. 玉米，`#` 表示，这些格子是不可以通过的。
1. 草地，`.` 表示，可以简单的通过。
1. 传送装置，每一对大写字母 $\tt{A}$ 到 $\tt{Z}$ 表示。
1. 出口，`=` 表示。
1. 起点， `@` 表示

奶牛能在一格草地上可能存在的四个相邻的格子移动，花费 $1$ 个单位时间。从装置的一个结点到另一个结点不花时间。


---

---
title: "[USACO3.2] 香甜的黄油 Sweet Butter"
layout: "post"
diff: 普及/提高-
pid: P1828
tag: ['图论', 'USACO', '队列']
---
# [USACO3.2] 香甜的黄油 Sweet Butter
## 题目描述

Farmer John 发现了做出全威斯康辛州最甜的黄油的方法：糖。

把糖放在一片牧场上，他知道 $N$ 只奶牛会过来舔它，这样就能做出能卖好价钱的超甜黄油。当然，他将付出额外的费用在奶牛上。

Farmer John 很狡猾。像以前的 Pavlov，他知道他可以训练这些奶牛，让它们在听到铃声时去一个特定的牧场。他打算将糖放在那里然后下午发出铃声，以至他可以在晚上挤奶。

Farmer John 知道每只奶牛都在各自喜欢的牧场（一个牧场不一定只有一头牛）。给出各头牛在的牧场和牧场间的路线，找出使所有牛到达的路程和最短的牧场（他将把糖放在那）。
## 输入格式

第一行包含三个整数 $N,P,C$，分别表示奶牛数、牧场数和牧场间道路数。

第二行到第 $N+1$ 行，每行一个整数，其中第 $i$ 行的整数表示第 $i-1$ 头奶牛所在的牧场号。

第 $N+2$ 行到第 $N+C+1$ 行，每行包含三个整数 $A,B,D$，表示牧场号为 $A$ 和 $B$ 的两个牧场之间有一条长度为 $D$ 的双向道路相连。
## 输出格式

输出一行一个整数，表示奶牛必须行走的最小的距离和。
## 样例

### 样例输入 #1
```
3 4 5
2
3
4
1 2 1
1 3 5
2 3 7
2 4 3
3 4 5
```
### 样例输出 #1
```
8
```
## 提示

**数据范围**

对于所有数据，$1 \le N \le 500$，$2 \le P \le 800$，$1 \le A,B \le P$，$1 \le C \le 1450$，$1 \le D \le 255$。

---

**样例解释**

作图如下：

```cpp
          P2  
P1 @--1--@ C1
         |
         | 
       5  7  3
         |   
         |     C3
       C2 @--5--@
          P3    P4
```

把糖放在4号牧场最优。


---

---
title: "[USACO05NOV] 奶牛玩杂技"
layout: "post"
diff: 普及/提高-
pid: P1842
tag: ['贪心', 'USACO']
---
# [USACO05NOV] 奶牛玩杂技
## 题目背景

Farmer John 养了 $N$ 头牛，她们已经按 $1\sim N$ 依次编上了号。FJ 所不知道的是，他的所有牛都梦想着从农场逃走，去参加马戏团的演出。可奶牛们很快发现她们那笨拙的蹄子根本无法在钢丝或晃动的的秋千上站稳（她们还尝试过把自己装在大炮里发射出去，但可想而知，结果是悲惨的） 。最终，她们决定练习一种最简单的杂技：把所有牛都摞在一起， 比如说， 第一头牛站在第二头的身上， 同时第二头牛又站在第三头牛的身上...最底下的是第 $N$ 头牛。
## 题目描述

每头牛都有自己的体重以及力量，编号为 $i$ 的奶牛的体重为 $W_i$，力量为 $S_i$。

当某头牛身上站着另一些牛时它就会在一定程度上被压扁，我们不妨把它被压扁的程度叫做它的压扁指数。对于任意的牛，她的压扁指数等于摞在她上面的所有奶牛的总重（当然不包括她自己）减去它的力量。奶牛们按照一定的顺序摞在一起后， 她们的总压扁指数就是被压得最扁的那头奶牛的压扁指数。

你的任务就是帮助奶牛们找出一个摞在一起的顺序，使得总压扁指数最小。
## 输入格式

第一行一个整数 $N$。

接下来 $N$ 行，每行两个整数 $W_i$ 和 $S_i$。
## 输出格式

一行一个整数表示最小总压扁指数。
## 样例

### 样例输入 #1
```
3
10 3
2 5
3 3
```
### 样例输出 #1
```
2
```
## 提示

对于 $100\%$ 的数据，$1 \le N \le 5\times 10^4$，$1 \le W_i \le 10^4$，$1 \le S_i \le 10^9$。


---

---
title: "[USACO09NOV] Job Hunt S"
layout: "post"
diff: 普及/提高-
pid: P1938
tag: ['图论', '2009', 'USACO', '最短路']
---
# [USACO09NOV] Job Hunt S
## 题目描述

Bessie is running out of money and is searching for jobs. Farmer John knows this and wants the cows to travel around so he has imposed a rule that his cows can only make D (1 <= D <= 1,000) dollars in a city before they must work in another city. Bessie can, however, return to a city after working elsewhere for a while and again earn the D dollars maximum in that city. There is no limit on the number of times Bessie can do this.

Bessie's world comprises P (1 <= P <= 150) one-way paths connecting C (2 <= C <= 220) cities conveniently numbered 1..C. Bessie is currently in city S (1 <= S <= C). Path i runs one-way from city A\_i to city B\_i (1 <= A\_i <= C; 1 <= B\_i <= C) and costs nothing to traverse.

To help Bessie, Farmer John will give her access to his private jet service. This service features F (1 <= F <= 350) routes, each of which is a one way flight from one city J\_i to a another K\_i (1 <= J\_i <= C; 1 <= K\_i <= C) and which costs T\_i (1 <= T\_i <= 50,000) dollars. Bessie can pay for the tickets from future earnings if she doesn't have the cash on hand.

Bessie can opt to retire whenever and wherever she wants. Given an unlimited amount of time, what is the most money that Bessie can make presuming she can make the full D dollars in each city she can travel to?  Print -1 if there is no limit to this amount.

奶牛们正在找工作。农场主约翰知道后，鼓励奶牛们四处碰碰运气。而且他还加了一条要求：一头牛在一个城市最多只能赚D（1≤D≤1000）美元，然后它必须到另一座城市工作。当然，它可以在别处工作一阵子后又回到原来的城市再最多赚D美元。而且这样的往返次数没有限制。

城市间有P（1≤P≤150）条单向路径连接，共有C（2≤C≤220）座城市，编号从1到C。奶牛贝茜当前处在城市S（1≤S≤C）。路径i从城市A\_i到城市B\_i（1≤A\_i≤C，1≤B\_i≤C），在路径上行走不用任何花费。

为了帮助贝茜，约翰让它使用他的私人飞机服务。这项服务有F条（1≤F≤350）单向航线，每条航线是从城市J\_i飞到另一座城市K\_i（1≤J\_i≤C，1≤K\_i≤C），费用是T\_i（1≤T\_i≤50000）美元。如果贝茜手中没有现钱，可以用以后赚的钱来付机票钱。

贝茜可以选择在任何时候，在任何城市退休。如果在工作时间上不做限制，贝茜总共可以赚多少钱呢？如果赚的钱也不会出现限制，就输出-1。

## 输入格式

第一行：5个用空格分开的整数D，P，C，F，S。

第2到第P+1行：第i+1行包含2个用空格分开的整数，表示一条从城市A\_i到城市B\_i的单向路径。

接下来F行，每行3个用空格分开的整数，表示一条从城市J\_i到城市K\_i的单向航线，费用是T\_i。

## 输出格式

一个整数，在上述规则下最多可以赚到的钱数。

## 样例

### 样例输入 #1
```
100 3 5 2 1
1 5
2 3
1 4
5 2 150
2 5 120

```
### 样例输出 #1
```
250
```
## 提示

This world has five cities, three paths and two jet routes. Bessie starts out in city 1, and she can only make 100 dollars in each city before moving on.


Bessie can travel from city 1 to city 5 to city 2 to city 3, and make a total of 4\*100 - 150 = 250 dollars.


Source: USACO 2009 November Silver

这个世界上有五个城市，三条单向路径和两条单向航线。贝茜从一号城市开始她的旅行，她在离开一个城市前最多只能在这个城市赚100美元。


贝茜可以通过从一号城市-->五号城市-->二号城市-->三号城市的旅行赚到4\*100-150=250美元。


(注:在四个城市各赚100美元,从五号城市飞到二号城市花掉150美元)


来源:USACO 2009 十一月银组



---

---
title: "Blink"
layout: "post"
diff: 普及/提高-
pid: P2203
tag: ['模拟', '搜索', 'USACO']
---
# Blink
## 题目描述

Farmer John 对于农场里昏暗的灯光很不满，于是他刚刚装上一个装饰精美的新吊灯。

这个吊灯由 $N(3 \le N \le 16)$ 个灯组成，并排成一个**圆圈**。

奶牛们对于这个新的发光装置很有兴趣。他们喜欢玩这样的一个游戏：

在在时刻 $T$ 时，对于每一盏灯 $i$，如果在时刻 $T-1$ 时，$i$ 左边的灯 $(1<i\le n$ 时为 $i-1$，$i=1$ 时，为 $n)$ 是开的，那么**改变第 $i$ 盏灯的状态**，否则不做操作。

他们会在 $B(1 \le B \le 10^{15})$ 个单位的时间里一直进行这样的操作。

**请注意，$B$ 可能会超过一般的 $32$ 位整数的范围。**

现在已知每一个灯的初始状态，请计算出在经过 $B$ 个单位的时间后，每一个灯的状态。
## 输入格式

第 $1$ 行是两个整数，$N$ 和 $B$。

第 $2 \sim 1+N$ 中，第 $i+1$ 行描述了灯的初始状态，用 $0$ (关) 与 $1$ (开) 表示。

## 输出格式

$N$ 行，第 $i$ 行应输出一个整数，描述灯的最终状态，用 $0$ (关) 与 $1$ (开) 表示。
## 样例

### 样例输入 #1
```
5 6

1

0

0

0

0
```
### 样例输出 #1
```
1

1

1

0

1
```
## 提示

样例输出解释：

下面是样例输出的模拟

```cpp
Time T=0: 1 0 0 0 0
Time T=1: 1 1 0 0 0
Time T=2: 1 0 1 0 0
Time T=3: 1 1 1 1 0
Time T=4: 1 0 0 0 1
Time T=5: 0 1 0 0 1
Time T=6: 1 1 1 0 1


---

---
title: "Photo"
layout: "post"
diff: 普及/提高-
pid: P2207
tag: ['搜索', 'USACO']
---
# Photo
## 题目描述

Farmer John 打算给他的 $n$ 头奶牛照相。

他们排成一条线，并且依次取 $1\sim n$ 作为编号。

每一张照片可以拍摄到这列奶牛中一个连续的区间中的奶牛。

对于每一头奶牛，FJ 都想要让 Ta 至少出现在一张照片里。

不幸的是，有 $k$ 对关系不好的奶牛，他们拒绝出现在同一张照片里。

已知所有关系不好的奶牛所在的位置，请计算出 FJ 需要的最小需要拍摄的照片数量。
## 输入格式

第一行：两个整数:$n$，$k$。

第 $2\ldots k+1$ 行中，第 $i+1$ 行有两个整数，记为 $a_i$ 与 $b_i$。它们代表着处在队列中第 $a_i$ 头奶牛与第 $b_i$ 头奶牛是关系不好的，它们不能出现在同一张照片里。
## 输出格式

一个整数，代表 FJ 需要的最小需要拍摄的照片数量。
## 样例

### 样例输入 #1
```
7 3
1 3
2 4
5 6

```
### 样例输出 #1
```
3
```
## 提示

#### 样例输入输出 1 解释

FJ 可以只拍三张照片：$[1,2]$，$[3,5]$，$[6,7]$。

---

#### 数据规模与约定

对于 $100\%$ 的数据，保证 $2\le n\le10^9$，$1\le k\le1000$，$1 \leq a_i, b_i \leq n$。


---

---
title: "[USACO14MAR] Watering the Fields S"
layout: "post"
diff: 普及/提高-
pid: P2212
tag: ['2014', 'USACO', '生成树']
---
# [USACO14MAR] Watering the Fields S
## 题目描述

Due to a lack of rain, Farmer John wants to build an irrigation system to


send water between his N fields (1 <= N <= 2000).

Each field i is described by a distinct point (xi, yi) in the 2D plane,

with 0 <= xi, yi <= 1000.  The cost of building a water pipe between two

fields i and j is equal to the squared Euclidean distance between them:



(xi - xj)^2 + (yi - yj)^2

FJ would like to build a minimum-cost system of pipes so that all of his

fields are linked together -- so that water in any field can follow a

sequence of pipes to reach any other field.


Unfortunately, the contractor who is helping FJ install his irrigation

system refuses to install any pipe unless its cost (squared Euclidean


length) is at least C (1 <= C <= 1,000,000).  

Please help FJ compute the minimum amount he will need pay to connect all

his fields with a network of pipes.


给定 $n$ 个点，第 $i$ 个点的坐标为 $(x_i,y_i)$，如果想连通第 $i$ 个点与第 $j$ 个点，需要耗费的代价为两点的距离。第 $i$ 个点与第 $j$ 个点之间的距离使用欧几里得距离的平方进行计算，即：
$$(x_i-x_j)^2+(y_i-y_j)^2$$
我们规定耗费代价小于 $c$ 的两点无法连通，求使得每两点都能连通下的最小代价，如果无法连通输出 `-1`。
## 输入格式

\* Line 1: The integers N and C.


\* Lines 2..1+N: Line i+1 contains the integers xi and yi.

第一行两个整数 $n,c$ 代表点数与想要连通代价不能少于的一个数。   
接下来 $n$ 行每行两个整数 $x_i,y_i$ 描述第 $i$ 个点。
## 输出格式

\* Line 1: The minimum cost of a network of pipes connecting the

fields, or -1 if no such network can be built.

一行一个整数代表使得每两点都能连通下的最小代价，如果无法连通输出 `-1`。
## 样例

### 样例输入 #1
```
3 11
0 2
5 0
4 3
```
### 样例输出 #1
```
46
```
## 提示

INPUT DETAILS:


There are 3 fields, at locations (0,2), (5,0), and (4,3).  The contractor

will only install pipes of cost at least 11.

OUTPUT DETAILS:


FJ cannot build a pipe between the fields at (4,3) and (5,0), since its

cost would be only 10.  He therefore builds a pipe between (0,2) and (5,0)


at cost 29, and a pipe between (0,2) and (4,3) at cost 17.  

Source: USACO 2014 March Contest, Silver

### 数据规模与约定

对于 $100\%$ 的数据，$1 \le n \le 2000$，$0 \le x_i,y_i \le 1000$，$1 \le c \le 10^6$。

### 说明

Translated by 一只书虫仔。


---

---
title: "[USACO14MAR] The Lazy Cow S"
layout: "post"
diff: 普及/提高-
pid: P2213
tag: ['图论', '2014', 'USACO', '生成树', '前缀和']
---
# [USACO14MAR] The Lazy Cow S
## 题目描述

It's a hot summer day, and Bessie the cow is feeling quite lazy.  She wants

to locate herself at a position in her field so that she can reach as much

delicious grass as possible within only a short distance.


The field Bessie inhabits is described by an N by N grid of square cells

(1 <= N <= 400).  The cell in row r and column c (1 <= r,c <= N) contains

G(r,c) units of grass (0 <= G(r,c) <= 1000).  From her initial square in

the grid, Bessie is only willing to take up to K steps (0 <= K <= 2\*N).

Each step she takes moves her to a cell that is directly north, south,

east, or west of her current location.


For example, suppose the grid is as follows, where (B) describes Bessie's

```cpp
50    5     25*   6     17    
14    3*    2*    7*    21    
99*   10*   1*(B) 2*    80*    
8     7*    5*    23*   11   
10    0     78*   1     9        
```

initial position (here, in row 3, column 3):

If K=2, then Bessie can only reach the locations marked with \*s.

Please help Bessie determine the maximum amount of grass she can reach, if

she chooses the best possible initial location in the grid.

奶牛贝茜非常懒惰，她希望在她的地盘内找到一点最佳位置居住，以便在有限的步数内可以吃到尽量多的青草。

她的地盘是一个 $N \times N(1\le N \le 400)$ 的矩阵，第 $r$ 行 $c$ 列包含 $G(r,c)$ 单位的青草 $(0 \le G(r,c) \le 1000)$。从她的居住点，她最多愿意走 $K$ 步 $(0 \le K \le 2 \times N)$，每一步她可以走到上与她相邻的某个格子。
## 输入格式

\* Line 1: The integers N and K.


\* Lines 2..1+N: Line r+1 contains N integers describing row r of the

grid.
## 输出格式

\* Line 1: The maximum amount of grass Bessie can reach, if she chooses

the best possible initial location (the location from which

she can reach the most grass).

## 样例

### 样例输入 #1
```
5 2
50 5 25 6 17
14 3 2 7 21
99 10 1 2 80
8 7 5 23 11
10 0 78 1 9

```
### 样例输出 #1
```
342
```
## 提示

OUTPUT DETAILS:


In the example above, Bessie can reach 342 total units of grass if she

locates herself in the middle of the grid.


Source: USACO 2014 March Contest, Silver



---

---
title: "[USACO14JAN] Recording the Moolympics S"
layout: "post"
diff: 普及/提高-
pid: P2255
tag: ['贪心', '2014', 'USACO', '排序']
---
# [USACO14JAN] Recording the Moolympics S
## 题目描述

Being a fan of all cold-weather sports (especially those involving cows),Farmer John wants to record as much of the upcoming winter Moolympics as possible.


The television schedule for the Moolympics consists of N different programs(1 <= N <= 150), each with a designated starting time and ending time.  FJ has a dual-tuner recorder that can record two programs simultaneously.

Please help him determine the maximum number of programs he can record in total.

农民约翰热衷于所有寒冷天气的运动（尤其是涉及到牛的运动）， 农民约翰想录下尽可能多的电视节目。 moolympics 的节目时间表有 $N$ 个不同的节目 （$1\le N\le 150$），每个节目给定开始时间和结束时间。FJ 有一个双调谐器录音机，可以同时录制两个节目。 请帮助他确定他能录制的节目的最大数量。

## 输入格式

\* Line 1: The integer N.


\* Lines 2..1+N: Each line contains the start and end time of a single program (integers in the range 0..1,000,000,000).

- 第 $1$ 行：整数 $N$。 
- 第 $2$ 到第 $N+1$ 行：每行包含单个节目的开始和结束时间（范围为 $0…1000000000$ 的整数）。
## 输出格式

\* Line 1: The maximum number of programs FJ can record.

仅一行，FJ可以记录的最大节目数量。  
## 样例

### 样例输入 #1
```
6
0 3
6 7
3 10
1 5
2 8
1 9
```
### 样例输出 #1
```
4
```
## 提示

INPUT DETAILS:


The Moolympics broadcast consists of 6 programs.  The first runs from time 0 to time 3, and so on.


OUTPUT DETAILS:


FJ can record at most 4 programs.  For example, he can record programs 1 and 3 back-to-back on the first tuner, and programs 2 and 4 on the second tuner.


Source: USACO 2014 January Contest, Silver



---

---
title: "[USACO14JAN] Bessie Slows Down S"
layout: "post"
diff: 普及/提高-
pid: P2338
tag: ['模拟', '贪心', '2014', '线性数据结构', 'USACO']
---
# [USACO14JAN] Bessie Slows Down S
## 题目背景

奶牛题

## 题目描述

Bessie the cow is competing in a cross-country skiing event at the winter Moolympic games.  She starts out at a speed of 1 meter per second. However, as she becomes more tired over time, she begins to slow down. Each time Bessie slows down, her speed decreases: she moves at 1/2 meter per second after slowing down once, then 1/3 meter per second after slowing down twice, and so on.

You are told when and where Bessie slows down, in terms of a series of events.  An event like this:

T 17
means that Bessie slows down at a specific time -- here, 17 seconds into the race.  An event like this:

D 10
means that Bessie slows down at a specific distance from the start -- in this case, 10 meters.

Given a list of N such events (1 <= N <= 10,000), please compute the amount of time, in seconds, for Bessie to travel an entire kilometer.  Round your answer to the nearest integer second (0.5 rounds up to 1).

贝西正在参加一项滑雪比赛。她从起点出发的时候，速度恒定为每秒 1 米。然而，随着比赛进程的增加，她会犯很多错误，每次失误都会使她的速度下降。当她第一次失误后，速度会下降到每秒1/2 米，第二次失误后，速度会下降到每秒 1/3 米，第 k 次失误后，速度会下降到每秒 1/(k + 1) 米。

约翰记录了贝西的所有失误，一共有 N 个。有两种失误，一种发生在比赛开始后的某个时间点，另一种发生在赛道的某个位置上。有时，贝西可能在某个时间点到达某个位置，而恰好在这个时间点和位置上都有一次失误的记录，这两个记录要算作不同的失误，会对贝西的速度造成两次影响。比赛的终点距离起点有 1000 米，请问贝西需要多少时间才能滑过终点？

## 输入格式

第一行：单个整数 N ，1 ≤ N ≤ 10000

第二行到第 N + 1 行：每行开头有个大写字母，代表贝西的一个失误类型：

– 如果是 T，接下来会有一个整数 S，表示在比赛开始后的第 S 秒钟整发生了一次失误，

1 ≤ S ≤ 10^7

– 如果是 D，接下来会有一个整数 X，表示在距离起点 X 米处发生了一次失误，1 ≤ X ≤

1000
## 输出格式

单个整数：表示贝西需要多少秒才能滑到终点，如果精确的时间不是整数，则用四舍五入的方

法向最接近的整数取整

## 样例

### 样例输入 #1
```
2
T 30
D 10
```
### 样例输出 #1
```
2970
```
## 提示

前 10 秒，贝西的速度是每秒 1 米，她滑了 10 米。然后她遭遇了第一次失误，在接下

来的 20 秒内，她又滑了 10 米。之后她遭遇了第二次失误，还剩下 980 米，所以她共计花去

10 + 20 + 2940 = 2970 秒才完成比赛



---

---
title: "[USACO03FALL] Cow Exhibition G"
layout: "post"
diff: 普及/提高-
pid: P2340
tag: ['动态规划 DP', '2003', 'USACO']
---
# [USACO03FALL] Cow Exhibition G
## 题目背景



## 题目描述

奶牛想证明它们是聪明而风趣的。为此，贝西筹备了一个奶牛博览会，她已经对 $N$ 头奶牛进行了面试，确定了每头奶牛的智商和情商。

贝西有权选择让哪些奶牛参加展览。由于负的智商或情商会造成负面效果，所以贝西不希望出展奶牛的智商之和小于零，或情商之和小于零。满足这两个条件下，她希望出展奶牛的智商与情商之和越大越好，请帮助贝西求出这个最大值。

## 输入格式

第一行：单个整数 $N$，$1 \le N \le 400$。

第二行到第 $N+1$ 行：第 $i+1$ 行有两个整数：$S_i$ 和 $F_i$，表示第 $i$ 头奶牛的智商和情商，− $1000 \le S_i;F_i \le 1000$。
## 输出格式

输出单个整数：表示情商与智商和的最大值。贝西可以不让任何奶牛参加展览，如果这样做是最好的，输出 $0$。
## 样例

### 样例输入 #1
```
5
-5 7
8 -6
6 -3
2 1
-8 -5
```
### 样例输出 #1
```
8
```
## 提示

选择第一头，第三头，第四头奶牛，智商和为−5+6+2 = 3，情商和为7−3+1 = 5。再加

入第二号奶牛可使总和提升到10，不过由于情商和变成负的了，所以是不允许的



---

---
title: "[USACO04OPEN] MooFest G"
layout: "post"
diff: 普及/提高-
pid: P2345
tag: ['模拟', '2004', 'USACO', '树状数组', 'cdq 分治']
---
# [USACO04OPEN] MooFest G
## 题目背景

[P5094 [USACO04OPEN] MooFest G 加强版](https://www.luogu.com.cn/problem/P5094)

## 题目描述

约翰的 $n$ 头奶牛每年都会参加“哞哞大会”。

哞哞大会是奶牛界的盛事。集会上的活动很多，比如堆干草，跨栅栏，摸牛仔的屁股等等。

它们参加活动时会聚在一起，第 $i$ 头奶牛的坐标为 $x_i$，没有两头奶牛的坐标是相同的。

奶牛们的叫声很大，第 $i$ 头和第 $j$ 头奶牛交流，会发出
$\max\{v_i,v_j\}\times |x_i − x_j |$ 
的音量，其中 $v_i$ 和 $v_j$ 分别是第 $i$ 头和第 $j$ 头奶牛的听力。

假设每对奶牛之间同时都在说话，请计算所有奶牛产生的音量之和是多少。
## 输入格式

第一行：单个整数 $n$，$1\le n\le2\times 10^4$

第二行到第 $n + 1$ 行：第 $i + 1$ 行有两个整数 $v_i$ 和 $x_i$（$1\le v_i,x_i\le2\times 10^4$）。
## 输出格式

单个整数：表示所有奶牛产生的音量之和
## 样例

### 样例输入 #1
```
4
3 1
2 5
2 6
4 3
```
### 样例输出 #1
```
57
```


---

---
title: "[USACO07FEB] Bronze Lilypad Pond B"
layout: "post"
diff: 普及/提高-
pid: P2385
tag: ['2007', 'USACO']
---
# [USACO07FEB] Bronze Lilypad Pond B
## 题目描述

为了让奶牛们娱乐和锻炼，农夫约翰建造了一个美丽的池塘。这个长方形的池子被分成了 M 行 N 列个方格（1 ≤ M, N ≤ 30） 。一些格子是坚固得令人惊讶的莲花，还有一些格子是岩石，其余的只是美丽、纯净、湛蓝的水。

贝西正在练习芭蕾舞，她站在一朵莲花上，想跳到另一朵莲花上去，她只能从一朵莲花跳到另一朵莲花上，既不能跳到水里，也不能跳到岩石上。

贝西的舞步很像象棋中的马步：每次总是先横向移动 M1 (1 ≤ M1 ≤ 30)格，再纵向移动 M2 (1 ≤ M2 ≤ 30, M1≠M2)格，或先纵向移动 M1 格，再横向移动 M2 格。最多时，贝西会有八个移动方向可供选择。

给定池塘的布局和贝西的跳跃长度，请计算贝西从起点出发，到达目的地的最小步数，我们保证输入数据中的目的地一定是可达的。

## 输入格式

第一行：四个用空格分开的整数：M，N，M1 和 M2

第二行到 M + 1 行：第 i + 1 行有 N 个用空格分开的整数，描述了池塘第

i 行的状态：0 为水，1 为莲花，2 为岩石，3 为贝西所在的起点，4 为贝西想去

的终点。

## 输出格式

第一行：从起点到终点的最少步数。

## 样例

### 样例输入 #1
```
4 5 1 2
1 0 1 0 1
3 0 2 0 4
0 1 2 0 0
0 0 0 1 0
```
### 样例输出 #1
```
2
```


---

---
title: "[USACO08FEB] Game of Lines S"
layout: "post"
diff: 普及/提高-
pid: P2665
tag: ['模拟', '2008', 'USACO', '枚举']
---
# [USACO08FEB] Game of Lines S
## 题目背景

Farmer John 最近发明了一个游戏，来考验自命不凡的贝茜。

## 题目描述

Farmer John has challenged Bessie to the following game: FJ has a board with dots marked at N (2 ≤ N ≤ 200) distinct lattice points. Dot i has the integer coordinates Xi and Yi (-1,000 ≤ Xi ≤ 1,000; -1,000 ≤ Yi ≤ 1,000).

Bessie can score a point in the game by picking two of the dots and drawing a straight line between them; however, she is not allowed to draw a line if she has already drawn another line that is parallel to that line. Bessie would like to know her chances of winning, so she has asked you to help find the maximum score she can obtain.

游戏开始的时 候，FJ 会给贝茜一块画着 $N (2 \le N \le 200)$ 个不重合的点的木板，其中第 $i$ 个点的横、纵坐标分别为 $X_i$ 和 $Y_i (-1000 \le X_i \le 1000, -1000 \le Y_i \le 1000)$。

贝茜可以选两个点画一条过它们的直线，当且仅当平面上不存在与画出直线 平行的直线。游戏结束时贝茜的得分，就是她画出的直线的总条数。为了在游戏中胜出，贝茜找到了你，希望你帮她计算一下最大可能得分。

## 输入格式

第 $1$ 行: 输入 1 个正整数：$N$

第 $2 \cdots N+1$ 行: 第 $i+1$ 行用 $2$ 个用空格隔开的整数$X_i,Y_i$，描述了点 $i$ 的坐标。

## 输出格式

第 1 行: 输出 1 个整数，表示贝茜的最大得分，即她能画出的互不平行的线段数

## 样例

### 样例输入 #1
```
4 
-1 1 
-2 0 
0 0 
1 1
```
### 样例输出 #1
```
4 
```
## 提示

贝茜能画出以下 $4$ 种斜率的直线：$-1$，$0$，$\dfrac{1}{3}$ 以及 $1$。


---

---
title: "[USACO04NOV] Apple Catching G"
layout: "post"
diff: 普及/提高-
pid: P2690
tag: ['动态规划 DP', '搜索', 'USACO', '记忆化搜索']
---
# [USACO04NOV] Apple Catching G
## 题目描述

很少有人知道奶牛爱吃苹果。农夫约翰的农场上有两棵苹果树（编号为 $1$ 和 $2$ ）， 每一棵树上都长满了苹果。奶牛贝茜无法摘下树上的苹果，所以她只能等待苹果 从树上落下。但是，由于苹果掉到地上会摔烂，贝茜必须在半空中接住苹果（没有人爱吃摔烂的苹果）。贝茜吃东西很快，她接到苹果后仅用几秒钟就能吃完。每一分钟，两棵苹果树其中的一棵会掉落一个苹果。贝茜已经过了足够的训练， 只要站在树下就一定能接住这棵树上掉落的苹果。同时，贝茜能够在两棵树之间 快速移动（移动时间远少于 $1$ 分钟），因此当苹果掉落时，她必定站在两棵树其中的一棵下面。此外，奶牛不愿意不停地往返于两棵树之间，因此会错过一些苹果。苹果每分钟掉落一个，共 $T$（$1 \le T \le 1000$）分钟，贝茜最多愿意移动 $W$（$1 \le W \le 30$） 次。现给出每分钟掉落苹果的树的编号，要求判定贝茜能够接住的最多苹果数。 开始时贝茜在 1 号树下。
## 输入格式

第一行 $2$ 个数， $T$ 和 $W$。接下来的 $t$ 行，每行一个数，代表在时刻 $t$ 苹果是从 $1$ 号苹果树还是从 $2$ 号苹果树上掉下来的。
## 输出格式

对于每个测试点，输出一行，一个数，为奶牛最多接到的苹果的数量。
## 样例

### 样例输入 #1
```
7 2
2
1
1
2
2
1
1

```
### 样例输出 #1
```
6

```


---

---
title: "[USACO5.3] 巨大的牛棚Big Barn"
layout: "post"
diff: 普及/提高-
pid: P2701
tag: ['动态规划 DP', 'USACO']
---
# [USACO5.3] 巨大的牛棚Big Barn
## 题目背景

（USACO 5.3.4）

## 题目描述

FJ 有一个大小为 $n\times n$ 的农场（$1\le n\le 1000$），他想要在他的农场上建造一座正方形大牛棚。他的农场中有 $t$ 棵果树（$1\le t\le10000$），但他为了不破坏果树，就想找一个空旷无树的地方修建牛棚。你的任务是计算并输出，在他的农场中，不需要砍树却能够修建的最大正方形牛棚的边长。当然，牛棚的边必须和水平轴和垂直轴平行。

考虑下面的农场，`.` 表示没有树的方格，`#` 表示有树的方格。
```plain
0 1 2 3 4 5 6 7 8
1 . . . . . . . .
2 . # . . . # . .
3 . . . . . . . .
4 . . . . . . . .
5 . . . . . . . .
6 . . # . . . . .
7 . . . . . . . .
8 . . . . . . . .
```
最大的牛棚是边长为 $5$ 的，可以建造在农场右下角的两个位置其中一个。

## 输入格式

第 $1$ 行输入两个正整数 $n$ 和 $t$。

第 $2\cdots t+1$ 行输入两个正整数 $x,y\ (1\le x,y\le n)$。

## 输出格式

只由一行组成，约翰的牛棚的最大边长。

## 样例

### 样例输入 #1
```
8 3

2 2

2 6

6 3
```
### 样例输出 #1
```
5
```
## 提示

题目翻译来自NOCOW。

USACO Training Section 5.3



---

---
title: "[USACO3.1] 邮票 Stamps"
layout: "post"
diff: 普及/提高-
pid: P2725
tag: ['模拟', '动态规划 DP', '搜索', '贪心', 'USACO', '背包 DP']
---
# [USACO3.1] 邮票 Stamps
## 题目描述

给一组 $n$ 枚邮票的面值集合和一个上限 $k$ —— 表示信封上能够贴 $k$ 张邮票。请求出最大的正整数 $m$，满足 $1$ 到 $m$ 的面值都可以用不超过 $k$ 张邮票表示出来。


## 输入格式

输入的第一行是两个整数，分别代表邮票上限 $k$ 和邮票面值数 $n$。

自第二行起，除最后一行外，每行有 $15$ 个整数 $a_i$ ，最后一行的整数个数不超过 $15$，共有 $n$ 个整数，第 $i$ 个整数代表第 $i$ 种邮票的面值 $a_i$。
## 输出格式

输出一行一个整数代表 $m$。若 $m$ 不存在请输出 $0$。
## 样例

### 样例输入 #1
```
5 2
1 3
```
### 样例输出 #1
```
13
```
## 提示

#### 样例输入输出 1 解释

有 $1$ 分和 $3$ 分的邮票；你最多可以贴 $5$ 张邮票。很容易贴出 $1$ 到 $5$ 分的邮资（用 $1$ 分邮票贴就行了），接下来的邮资也不难：


- $6 = 3 + 3$。
- $7 = 3 + 3 + 1$。
- $8 = 3 + 3 + 1 + 1 $。
- $9 = 3 + 3 + 3 $。
- $10 = 3 + 3 + 3 + 1 $。
- $11 = 3 + 3 + 3 + 1 + 1 $。
- $12 = 3 + 3 + 3 + 3 $。
- $13 = 3 + 3 + 3 + 3 + 1$。


然而，使用 $5$ 枚 $1$ 分或者 $3$ 分的邮票根本不可能贴出 $14$ 分的邮资。因此，答案为 $13$。

#### 数据规模与约定

对于 $100\%$ 的数据，保证 $1 \leq k \leq 200$，$1 \leq n \leq 50$，$1 \leq a_i \leq 10^4$。

#### 说明

题目翻译来自 NOCOW。


---

---
title: "[USACO3.2] 纺车的轮子 Spinning Wheels"
layout: "post"
diff: 普及/提高-
pid: P2728
tag: ['模拟', '图论', 'USACO']
---
# [USACO3.2] 纺车的轮子 Spinning Wheels
## 题目背景

一架纺车有五个纺轮（也就是五个同心圆），这五个不透明的轮子边缘上都有一些缺口。这些缺口必须被迅速而准确地排列好。每个轮子都有一个起始标记（在0度），这样所有的轮子都可以在统一的已知位置开始转动。轮子按照角度变大的方向旋转（即0经过旋转到达1的位置），所以从起始位置开始，在一定的时间内，它们依次转过1度，2度等等（虽然这些轮子很可能不会同时转过这些角度）。

## 题目描述

这是一个整数问题。轮子不会转过1.5度或23.51234123度这样的角度。例如，轮子可能在一秒钟内转过20到25度甚至30到40度（如果转得快的话）。

这个问题中的所有角度都限制在 0 <= 角度 <= 359 这个范围内。轮子转过 359 度后接下来就是 0 度。每个轮子都有一个确定的旋转速度，以秒作为单位。1 <= 速度 <= 180。

轮子上的缺口的起始角度和缺口大小（或宽度）各由一个整数表示，都以度为单位。在一个轮子上，两个缺口之间至少有一度的间隔。宽度也包含缺口起始的角度，**即0 179包括0..179共计180个角度**

在起始位置，设时间为 0，所有的轮子的起始标记排列成一条直线。你的程序必须计算，最早出现每个的轮子上的缺口同其他轮子上的缺口对准（也就是一束光可以通过五个轮子上的五个缺口）情况的时间。这些缺口在任意一个角度对准。

## 输入格式

输入中的五行对应五个轮子。

第一个数字表示轮子的转动速度。下一个数字是缺口的数目 W。1 <= W <= 5。接下来的 W 对数字表示每个缺口的起始角度和宽度。

## 输出格式

只有一行，包括一个整数，表示光能够通过这五个轮子的最早时间。如果无解，输出'none'（小写，不含引号）。

## 样例

### 样例输入 #1
```
30 1 0 120
50 1 150 90
60 1 60 90
70 1 180 180
90 1 180 60
```
### 样例输出 #1
```
9
```
## 提示

题目翻译来自NOCOW。

USACO Training Section 3.2



---

---
title: "[USACO3.2] 饲料调配 Feed Ratios"
layout: "post"
diff: 普及/提高-
pid: P2729
tag: ['搜索', '数学', 'USACO', '枚举', '剪枝']
---
# [USACO3.2] 饲料调配 Feed Ratios
## 题目背景

农夫约翰从来只用调配得最好的饲料来喂他的奶牛。饲料用三种原料调配成：大麦，燕麦和小麦。他知道自己的饲料精确的配比，在市场上是买不到这样的饲料的。他只好购买其他三种混合饲料（同样都由三种麦子组成），然后将它们混合，来调配他的完美饲料。

## 题目描述

给出三组整数，表示 大麦：燕麦：小麦 的比例，找出用这三种饲料调配 x：y：z 的饲料的方法。

例如，给出目标饲料 3：4：5 和三种饲料的比例：

1:2:3
3:7:1
2:1:2
你必须编程找出使这三种饲料用量最少的方案，要是不能用这三种饲料调配目标饲料，输出“NONE”。“用量最少”意味着三种饲料的用量（整数）的和必须最小。


对于上面的例子，你可以用8份饲料1，1份饲料2，和5份饲料3，来得到7份目标饲料：

8\*(1:2:3) + 1\*(3:7:1) + 5\*(2:1:2) = (21:28:35) = 7\*(3:4:5)

表示饲料比例的整数以及目标饲料的都是小于100的非负整数。表示各种饲料的份数的整数，都小于100。一种混合物的比例不会由其他混合物的比例直接相加得到。

## 输入格式

Line 1: 三个用空格分开的整数，表示目标饲料

Line 2..4: 每行包括三个用空格分开的整数，表示农夫约翰买进的饲料的比例

## 输出格式

输出文件要包括一行，这一行要么有四个整数，要么是“NONE”。前三个整数表示三种饲料的份数，用这样的配比可以得到目标饲料。第四个整数表示混合三种饲料后得到的目标饲料的份数。

## 样例

### 样例输入 #1
```
3 4 5
1 2 3
3 7 1
2 1 2 
```
### 样例输出 #1
```
8 1 5 7
```
## 提示

题目翻译来自NOCOW。

USACO Training Section 3.2



---

---
title: "[USACO3.3] 家的范围 Home on the Range"
layout: "post"
diff: 普及/提高-
pid: P2733
tag: ['动态规划 DP', '搜索', 'USACO']
---
# [USACO3.3] 家的范围 Home on the Range
## 题目背景

农民约翰在一片边长是N (2 <= N <= 250)英里的正方形牧场上放牧他的奶牛。(因为一些原因，他的奶牛只在正方形的牧场上吃草。)遗憾的是,他的奶牛已经毁坏一些土地。( 一些1平方英里的正方形)

## 题目描述

农民约翰需要统计那些可以放牧奶牛的正方形牧场(至少是2x2的,在这些较大的正方形中没有一个点是被破坏的，也就是说，所有的点都是“1”)。

你的工作要在被供应的数据组里面统计所有不同的正方形放牧区域(>=2x2)的个数。当然，放牧区域可能是重叠。

## 输入格式

第 1 行:N,牧区的边长。

第 2 到 n+1 行:N个没有空格分开的字符。0 表示 "那一个区段被毁坏了";1 表示 " 准备好被吃"。

## 输出格式

输出那些存在的正方形的边长和个数，一种一行。

## 样例

### 样例输入 #1
```
6
101111
001111
111111
001111
101101
111001
```
### 样例输出 #1
```
2 10
3 4
4 1
```
## 提示

题目翻译来自NOCOW。

USACO Training Section 3.3



---

---
title: "[USACO3.3] 游戏 A Game"
layout: "post"
diff: 普及/提高-
pid: P2734
tag: ['动态规划 DP', '博弈论', 'USACO']
---
# [USACO3.3] 游戏 A Game
## 题目背景

有如下一个双人游戏：$N (2 \leq N \leq 100)$ 个正整数的序列放在一个游戏平台上，游戏由玩家 $1$ 开始，两人轮流从序列的任意一端取一个数，取数后该数字被去掉并累加到本玩家的得分中，当数取尽时，游戏结束。以最终得分多者为胜。
## 题目描述

编一个执行最优策略的程序，最优策略就是使玩家在与最好的对手对弈时，能得到的在当前情况下最大的可能的总分的策略。你的程序要始终为第二位玩家执行最优策略。
## 输入格式

第一行: 正整数 $N$，表示序列中正整数的个数。

第二行至末尾: 用空格分隔的 $N$ 个正整数（大小为 $1-200$）。
## 输出格式

只有一行，用空格分隔的两个整数: 依次为玩家一和玩家二最终的得分。
## 样例

### 样例输入 #1
```
6 
4 7 2 9 5 2
```
### 样例输出 #1
```
18 11
```
## 提示

题目翻译来自 NOCOW。

USACO Training Section 3.3


---

---
title: "[USACO3.4] 网 Electric Fences"
layout: "post"
diff: 普及/提高-
pid: P2735
tag: ['计算几何', 'USACO']
---
# [USACO3.4] 网 Electric Fences
## 题目描述

在本题中，格点是指横纵坐标皆为整数的点。

为了圈养他的牛，农夫约翰（Farmer John)建造了一个三角形的电网。他从原点（0,0）牵出一根通电的电线，连接格点(n,m)（0<=n<32000,0<m<32000），再连接格点(p,0)（p>0），最后回到原点。

牛可以在不碰到电网的情况下被放到电网内部的每一个格点上（十分瘦的牛）。如果一个格点碰到了电网，牛绝对不可以被放到该格点之上（或许Farmer John会有一些收获）。那么有多少头牛可以被放到农夫约翰的电网中去呢？

## 输入格式

输入文件只有一行，包含三个用空格隔开的整数：n,m和p。

## 输出格式

输出文件只有一行，包含一个整数，代表能被指定的电网包含的牛的数目。

## 样例

### 样例输入 #1
```
7 5 10
```
### 样例输出 #1
```
20
```
## 提示

题目翻译来自NOCOW。

USACO Training Section 3.4



---

---
title: "[USACO16JAN] Build Gates S"
layout: "post"
diff: 普及/提高-
pid: P2771
tag: ['模拟', '字符串', '搜索', '2016', 'USACO']
---
# [USACO16JAN] Build Gates S
## 题目描述

FarmerJohn 打算在他农场的一部分，建设一个围栏。但是因为没有认真做事，建造完成后，围栏变成一个很奇怪的形状。

具体来说，FJ 从 $(0,0)$ 出发，走了 $N$ 步，每步移动一单位（向东、向南、向西或向北）。

他走过的每一步，都会留下一段单位长度的围栏。例如，如果他的第一步向北，他建造一单位从 $(0,0)$ 到 $(0,1)$ 的围栏。

FJ 可能重复到达点多次，他也可能重复建造一段围栏多次。如果他的路径穿过一段已经建成的围栏，他的围栏也有可能会有交叉。

不用说，FJ 看到完成的围栏时，一定很沮丧。特别的，他发现一些区域被围栏封闭起来，从而无法到达。FJ 想在围栏上，安装一些门来解决这个问题。

门可以安装在任意一段单位长度（注：必须是之前走过的某一步）的围栏上，从而可以穿越这段围栏的两侧。

请计算 FJ 最少需要安装多少个门，才能保证农场上任意区域到任意区域都可到达。
## 输入格式

第一行一个整数 $N$。

第二行包含一个长度为 $N$ 的字符串，描述 FJ 的路径。每个字符为 $\tt N$（北），$\tt E$（东），$\tt S$（南），或 $\tt W$（西）。
## 输出格式

输出一个整数，表示为了保证农场所有区域的连通性，FJ 最少需要安装多少个门。
## 样例

### 样例输入 #1
```
14
NNNESWWWSSEEEE
```
### 样例输出 #1
```
2
```
## 提示

注意，如果农场初始连通，答案就是 $0$。

### 数据范围

$1\le n\le 1000$。



---

---
title: "[USACO14DEC] Marathon S"
layout: "post"
diff: 普及/提高-
pid: P2849
tag: ['2014', 'USACO']
---
# [USACO14DEC] Marathon S
## 题目描述

Unhappy with the poor health of his cows, Farmer John enrolls them in an assortment of different physical fitness activities. His prize cow Bessie is enrolled in a running class, where she is eventually expected to run a marathon through the downtown area of the city near Farmer John's farm!


The marathon course consists of N checkpoints (3 <= N <= 500) to be visited in sequence, where checkpoint 1 is the starting location and checkpoint N is the finish. Bessie is supposed to visit all of these checkpoints one by one, but being the lazy cow she is, she decides that she will skip up to K checkpoints (K < N) in order to shorten her total journey. She cannot skip checkpoints 1 or N, however, since that would be too noticeable.


Please help Bessie find the minimum distance that she has to run if she can skip up to K checkpoints.


Since the course is set in a downtown area with a grid of streets, the distance between two checkpoints at locations (x1, y1) and (x2, y2) is given by |x1-x2| + |y1-y2|.

Bessie 参加城市马拉松比赛，要顺序经过 $N (3 \leq N \leq 500)$ 个检查点，其中检查点 $1$ 是起点，检查点 $N$ 是终点。 Bessie尝试略过 $K(K < N)$ 个检查点，以减少总路程，检查点 $1$ 和检查点 $N$ 不能被略过。两个检查点的距离是 $|x_1-x_2| + |y_1-y_2|$。

输入输出格式

## 输入格式

The first line gives the values of N and K.


The next N lines each contain two space-separated integers, x and y,representing a checkpoint (-1000 <= x <= 1000, -1000 <= y <= 1000).


The checkpoints are given in the order that they must be visited.


Note that the course might cross over itself several times, with several checkpoints occurring at the same physical location. When Bessie skips such a checkpoint, she only skips one instance of the checkpoint -- she does not skip every checkpoint occurring at the same location.

## 输出格式

Output the minimum distance that Bessie can run by skipping up to K checkpoints. In the sample case shown here, skipping the checkpoints at (8, 3) and (10, -5) leads to the minimum total distance of 4.

## 样例

### 样例输入 #1
```
5 2
0 0
8 3
1 1
10 -5
2 2
```
### 样例输出 #1
```
4
```
## 题目翻译

【题目描述】

由于对他的奶牛的健康状况不佳而感到不满，牧场主约翰让它们参加各种各样的体育健身活动。最让他感到自豪的奶牛是 Bessie，她将参加约翰牧场附近城市里的马拉松比赛！

马拉松比赛有 $N$ 个检查点 $(3\leq N\leq 500)$ ，需要按顺序访问。检查点 $1$ 是起点，检查点 $N$ 是终点。Bessie 应该按顺序一一访问所有的这些检查点，但由于她是一头懒惰的牛（懒惰竟然还选择跑马拉松！），于是她决定跳过 $K(K<N)$ 个检查点以缩小她的赛程。但她不能跳过第 $1$ 个和第 $N$ 个检查点，因为这样太明显了。

请你帮助 Bessie 计算出跳过中间的 $K$ 个检查点后她最少要跑多少距离。

注意：由于街道是网格状的，我们用坐标来表示点的位置。但是 $(x_1,y_1),(x_2,y_2)$ 两点间的距离应为 $|x_1-x_2|+|y_1-y_2|$，这种测量距离的方法被称为“曼哈顿”距离，这是因为在市中心的网格路中，你可以沿平行于 $x$ 轴或 $y$ 轴的方向走，但不能沿直线到达。

【输入格式】

第一行：两个正整数 $N$ 和 $K$。

第 $2$ 行到第 $N+1$ 行，每行两个整数$x,y (-1000\leq x\leq 1000,-1000\leq y\leq 1000)$。

这里给出了检查点的顺序，她必须按顺序访问。注意：可能会有几个检查点出现在同一位置，Bessie 跳过这样的检查点时，相当于只跳过其中的一个检查点。

【输出格式】

输出跳过某一个检查点后 Bessie 可以跑的最短距离。

感谢@彭骐飞 提供的翻译


---

---
title: "[USACO06DEC] Cow Picnic S"
layout: "post"
diff: 普及/提高-
pid: P2853
tag: ['搜索', '贪心', '2006', 'USACO', '深度优先搜索 DFS']
---
# [USACO06DEC] Cow Picnic S
## 题目描述

The cows are having a picnic! Each of Farmer John's K (1 ≤ K ≤ 100) cows is grazing in one of N (1 ≤ N ≤ 1,000) pastures, conveniently numbered 1...N. The pastures are connected by M (1 ≤ M ≤ 10,000) one-way paths (no path connects a pasture to itself).

The cows want to gather in the same pasture for their picnic, but (because of the one-way paths) some cows may only be able to get to some pastures. Help the cows out by figuring out how many pastures are reachable by all cows, and hence are possible picnic locations.

$K(1 \le K \le 100)$ 只奶牛分散在 $N(1 \le N \le 1000)$ 个牧场．现在她们要集中起来进餐。牧场之间有 $M(1 \le M \le 10000)$ 条有向路连接，而且不存在起点和终点相同的有向路．她们进餐的地点必须是所有奶牛都可到达的地方。那么，有多少这样的牧场可供进食呢？
## 输入格式

Line 1: Three space-separated integers, respectively: K, N, and M


Lines 2..K+1: Line i+1 contains a single integer (1..N) which is the number of the pasture in which cow i is grazing.


Lines K+2..M+K+1: Each line contains two space-separated integers, respectively A and B (both 1..N and A != B), representing a one-way path from pasture A to pasture B.

## 输出格式

Line 1: The single integer that is the number of pastures that are reachable by all cows via the one-way paths.

## 样例

### 样例输入 #1
```
2 4 4
2
3
1 2
1 4
2 3
3 4
```
### 样例输出 #1
```
2
```
## 提示

The cows can meet in pastures 3 or 4.



---

---
title: "[USACO06DEC] River Hopscotch S"
layout: "post"
diff: 普及/提高-
pid: P2855
tag: ['2006', '二分', 'USACO']
---
# [USACO06DEC] River Hopscotch S
## 题目描述

Every year the cows hold an event featuring a peculiar version of hopscotch that involves carefully jumping from rock to rock in a river. The excitement takes place on a long, straight river with a rock at the start and another rock at the end, L units away from the start (1 ≤ L ≤ 1,000,000,000). Along the river between the starting and ending rocks, N (0 ≤ N ≤ 50,000) more rocks appear, each at an integral distance Di from the start (0 < Di < L).

To play the game, each cow in turn starts at the starting rock and tries to reach the finish at the ending rock, jumping only from rock to rock. Of course, less agile cows never make it to the final rock, ending up instead in the river.

Farmer John is proud of his cows and watches this event each year. But as time goes by, he tires of watching the timid cows of the other farmers limp across the short distances between rocks placed too closely together. He plans to remove several rocks in order to increase the shortest distance a cow will have to jump to reach the end. He knows he cannot remove the starting and ending rocks, but he calculates that he has enough resources to remove up to M rocks (0 ≤ M ≤ N).

FJ wants to know exactly how much he can increase the shortest distance \*before\* he starts removing the rocks. Help Farmer John determine the greatest possible shortest distance a cow has to jump after removing the optimal set of M rocks.

奶牛跳房子：从N块石头中移除M块，使得间距最小值最大。

## 输入格式

Line 1: Three space-separated integers: L, N, and M


Lines 2..N+1: Each line contains a single integer indicating how far some rock is away from the starting rock. No two rocks share the same position.

## 输出格式

Line 1: A single integer that is the maximum of the shortest distance a cow has to jump after removing M rocks

## 样例

### 样例输入 #1
```
25 5 2
2
14
11
21
17
```
### 样例输出 #1
```
4
```
## 提示

Before removing any rocks, the shortest jump was a jump of 2 from 0 (the start) to 2. After removing the rocks at 2 and 14, the shortest required jump is a jump of 4 (from 17 to 21 or from 21 to 25).



---

---
title: "[USACO06FEB] Treats for the Cows G/S"
layout: "post"
diff: 普及/提高-
pid: P2858
tag: ['动态规划 DP', '2006', 'USACO', '区间 DP']
---
# [USACO06FEB] Treats for the Cows G/S
## 题目描述

FJ has purchased N (1 <= N <= 2000) yummy treats for the cows who get money for giving vast amounts of milk. FJ sells one treat per day and wants to maximize the money he receives over a given period time.


The treats are interesting for many reasons:The treats are numbered 1..N and stored sequentially in single file in a long box that is open at both ends. On any day, FJ can retrieve one treat from either end of his stash of treats.Like fine wines and delicious cheeses, the treats improve with age and command greater prices.The treats are not uniform: some are better and have higher intrinsic value. Treat i has value v(i) (1 <= v(i) <= 1000).Cows pay more for treats that have aged longer: a cow will pay v(i)\*a for a treat of age a.Given the values v(i) of each of the treats lined up in order of the index i in their box, what is the greatest value FJ can receive for them if he orders their sale optimally?


The first treat is sold on day 1 and has age a=1. Each subsequent day increases the age by 1.

约翰经常给产奶量高的奶牛发特殊津贴，于是很快奶牛们拥有了大笔不知该怎么花的钱。为此，约翰购置了 $N$（$1 \leq N \leq 2000$） 份美味的零食来卖给奶牛们。每天约翰售出一份零食。当然约翰希望这些零食全部售出后能得到最大的收益，这些零食有以下这些有趣的特性：
+ 零食按照 $1, \ldots, N$ 编号，它们被排成一列放在一个很长的盒子里。盒子的两端都有开口，约翰每天可以从盒子的任一端取出最外面的一个。
+ 与美酒与好吃的奶酪相似，这些零食储存得越久就越好吃。当然，这样约翰就可以把它们卖出更高的价钱。
+ 每份零食的初始价值不一定相同。约翰进货时，第i份零食的初始价值为 $V_i$（$1 \leq V \leq 1000$）。
+ 第i份零食如果在被买进后的第 $a$ 天出售，则它的售价是 $V_i \times a$。

$V_i$ 的是从盒子顶端往下的第i份零食的初始价值。约翰告诉了你所有零食的初始价值，并希望你能帮他计算一下，在这些零食全被卖出后，他最多能得到多少钱。
## 输入格式

Line 1: A single integer, N

Lines 2..N+1: Line i+1 contains the value of treat v(i)

## 输出格式

Line 1: The maximum revenue FJ can achieve by selling the treats

## 样例

### 样例输入 #1
```
5
1
3
1
5
2
```
### 样例输出 #1
```
43
```
## 提示

Explanation of the sample:




Five treats. On the first day FJ can sell either treat #1 (value 1) or treat #5 (value 2).




FJ sells the treats (values 1, 3, 1, 5, 2) in the following order of indices: 1, 5, 2, 3, 4, making 1x1 + 2x2 + 3x3 + 4x1 + 5x5 = 43.



---

---
title: "[USACO06NOV] Bad Hair Day S"
layout: "post"
diff: 普及/提高-
pid: P2866
tag: ['2006', 'USACO', '栈', 'ST 表', '单调栈']
---
# [USACO06NOV] Bad Hair Day S
## 题目描述


农夫约翰有 $N$ 头奶牛正在过乱头发节。

每一头牛都站在同一排面朝右，它们被从左到右依次编号为 $1, 2, \cdots, N$。编号为 $i$ 的牛身高为 $h_i$。第 $N$ 头牛在最前面，而第 $1$ 头牛在最后面。

对于第 $i$ 头牛**前面**的第 $j$ 头牛，如果 $h_i>h_{i+1}, h_i>h_{i+2}, \cdots, h_i>h_j$，那么认为第 $i$ 头牛可以看到第 $i+1$ 到第 $j$ 头牛。

定义 $C_i$ 为第 $i$ 头牛所能看到的牛的数量。请帮助农夫约翰求出 $C _ 1 + C _ 2 + \cdots + C _ N$。

## 输入格式

输入共 $N + 1$ 行。

第一行为一个整数 $N$，代表牛的个数。  
接下来 $N$ 行，每行一个整数 $a _ i$，分别代表第 $1, 2, \cdots, N$ 头牛的身高。
## 输出格式

输出共一行一个整数，代表 $C _ 1 + C _ 2 + \cdots + C _ N$。
## 样例

### 样例输入 #1
```
6
10
3
7
4
12
2
```
### 样例输出 #1
```
5
```
## 提示

### 数据规模与约定

对于 $100\%$ 的数据，保证 $1 \leq N \leq 8 \times 10 ^ 4$，$1 \leq h _ i \leq 10 ^ 9$。


---

---
title: "[USACO07DEC] Building Roads S"
layout: "post"
diff: 普及/提高-
pid: P2872
tag: ['图论', '2007', 'USACO', '生成树']
---
# [USACO07DEC] Building Roads S
## 题目描述

Farmer John had just acquired several new farms! He wants to connect the farms with roads so that he can travel from any farm to any other farm via a sequence of roads; roads already connect some of the farms.

Each of the N (1 ≤ N ≤ 1,000) farms (conveniently numbered 1..N) is represented by a position (Xi, Yi) on the plane (0 ≤ Xi ≤ 1,000,000; 0 ≤ Yi ≤ 1,000,000). Given the preexisting M roads (1 ≤ M ≤ 1,000) as pairs of connected farms, help Farmer John determine the smallest length of additional roads he must build to connect all his farms.

给定 $n$ 个点的坐标，第 $i$ 个点的坐标为 $(x_i,y_i)$，这 $n$ 个点编号为 $1$ 到 $n$。给定 $m$ 条边，第 $i$ 条边连接第 $u_i$ 个点和第 $v_i$ 个点。现在要求你添加一些边，并且能使得任意一点都可以连通其他所有点。求添加的边的总长度的最小值。

## 输入格式

\* Line 1: Two space-separated integers: N and M

\* Lines 2..N+1: Two space-separated integers: Xi and Yi

\* Lines N+2..N+M+2: Two space-separated integers: i and j, indicating that there is already a road connecting the farm i and farm j.

第一行两个整数 $n,m$ 代表点数与边数。   
接下来 $n$ 行每行两个整数 $x_i,y_i$ 代表第 $i$ 个点的坐标。   
接下来 $m$ 行每行两个整数 $u_i,v_i$ 代表第 $i$ 条边连接第 $u_i$ 个点和第 $v_i$ 个点。

## 输出格式

\* Line 1: Smallest length of additional roads required to connect all farms, printed without rounding to two decimal places. Be sure to calculate distances as 64-bit floating point numbers.

一行一个实数代表添加的边的最小长度，要求保留两位小数，为了避免误差， 请用 $64$ 位实型变量进行计算。

## 样例

### 样例输入 #1
```
4 1
1 1
3 1
2 3
4 3
1 4
```
### 样例输出 #1
```
4.00
```
## 提示

### 数据规模与约定

对于 $100\%$ 的整数，$1 \le n,m \le 1000$，$1 \le x_i,y_i \le 10^6$，$1 \le u_i,v_i \le n$。

### 说明

Translated by 一只书虫仔。


---

---
title: "[USACO07JAN] Protecting the Flowers S"
layout: "post"
diff: 普及/提高-
pid: P2878
tag: ['模拟', '贪心', '2007', 'USACO', '排序']
---
# [USACO07JAN] Protecting the Flowers S
## 题目描述

Farmer John went to cut some wood and left N (2 ≤ N ≤ 100,000) cows eating the grass, as usual. When he returned, he found to his horror that the cluster of cows was in his garden eating his beautiful flowers. Wanting to minimize the subsequent damage, FJ decided to take immediate action and transport each cow back to its own barn.

Each cow i is at a location that is Ti minutes (1 ≤ Ti ≤ 2,000,000) away from its own barn. Furthermore, while waiting for transport, she destroys Di (1 ≤ Di ≤ 100) flowers per minute. No matter how hard he tries, FJ can only transport one cow at a time back to her barn. Moving cow i to its barn requires 2 × Ti minutes (Ti to get there and Ti to return). FJ starts at the flower patch, transports the cow to its barn, and then walks back to the flowers, taking no extra time to get to the next cow that needs transport.

Write a program to determine the order in which FJ should pick up the cows so that the total number of flowers destroyed is minimized.

有 $n$ 头奶牛跑到 FJ 的花园里去吃花儿了，它们分别在距离牛圈 $T_i$（这里指 FJ 到那里需要 $T_i$ 分钟) 处吃花，每分钟会吃掉 $D_i$ 朵花，FJ 现在要将它们给弄回牛圈，但是他每次只能弄一头回去，来回用时总共为 $2 \times T_i$ 分钟，在这段时间内，其它的奶牛会继续吃 FJ 的花，速度保持不变，当然正在被赶回牛圈的奶牛不能继续吃了。现在求在最好的方案下奶牛吃掉花的最小朵数。

## 输入格式

Line 1: A single integer N


Lines 2..N+1: Each line contains two space-separated integers, Ti and Di, that describe a single cow's characteristics

## 输出格式

Line 1: A single integer that is the minimum number of destroyed flowers

## 样例

### 样例输入 #1
```
6
3 1
2 5
2 3
3 2
4 1
1 6
```
### 样例输出 #1
```
86
```
## 提示

FJ returns the cows in the following order: 6, 2, 3, 4, 1, 5. While he is transporting cow 6 to the barn, the others destroy 24 flowers; next he will take cow 2, losing 28 more of his beautiful flora. For the cows 3, 4, 1 he loses 16, 12, and 6 flowers respectively. When he picks cow 5 there are no more cows damaging the flowers, so the loss for that cow is zero. The total flowers lost this way is 24 + 28 + 16 + 12 + 6 = 86.



---

---
title: "[USACO07JAN] Balanced Lineup G"
layout: "post"
diff: 普及/提高-
pid: P2880
tag: ['2007', 'USACO', '树状数组', 'ST 表']
---
# [USACO07JAN] Balanced Lineup G
## 题目描述

For the daily milking, Farmer John's N cows (1 ≤ N ≤ 50,000) always line up in the same order. One day Farmer John decides to organize a game of Ultimate Frisbee with some of the cows. To keep things simple, he will take a contiguous range of cows from the milking lineup to play the game. However, for all the cows to have fun they should not differ too much in height.

Farmer John has made a list of Q (1 ≤ Q ≤ 180,000) potential groups of cows and their heights (1 ≤ height ≤ 1,000,000). For each group, he wants your help to determine the difference in height between the shortest and the tallest cow in the group.

每天,农夫 John 的 $n(1\le n\le 5\times 10^4)$ 头牛总是按同一序列排队。

有一天, John 决定让一些牛们玩一场飞盘比赛。他准备找一群在队列中位置连续的牛来进行比赛。但是为了避免水平悬殊，牛的身高不应该相差太大。John 准备了 $q(1\le q\le 1.8\times10^5)$ 个可能的牛的选择和所有牛的身高 $h_i(1\le h_i\le 10^6,1\le i\le n)$。他想知道每一组里面最高和最低的牛的身高差。
## 输入格式

Line 1: Two space-separated integers, N and Q.


Lines 2..N+1: Line i+1 contains a single integer that is the height of cow i


Lines N+2..N+Q+1: Two integers A and B (1 ≤ A ≤ B ≤ N), representing the range of cows from A to B inclusive.

第一行两个数 $n,q$。

接下来 $n$ 行，每行一个数 $h_i$。

再接下来 $q$ 行，每行两个整数 $a$ 和 $b$，表示询问第 $a$ 头牛到第 $b$ 头牛里的最高和最低的牛的身高差。

## 输出格式

Lines 1..Q: Each line contains a single integer that is a response to a reply and indicates the difference in height between the tallest and shortest cow in the range.

输出共 $q$ 行，对于每一组询问，输出每一组中最高和最低的牛的身高差。
## 样例

### 样例输入 #1
```
6 3
1
7
3
4
2
5
1 5
4 6
2 2
```
### 样例输出 #1
```
6
3
0
```


---

---
title: "[USACO07MAR] Monthly Expense S"
layout: "post"
diff: 普及/提高-
pid: P2884
tag: ['2007', 'USACO']
---
# [USACO07MAR] Monthly Expense S
## 题目描述

Farmer John is an astounding accounting wizard and has realized he might run out of money to run the farm. He has already calculated and recorded the exact amount of money (1 ≤ moneyi ≤ 10,000) that he will need to spend each day over the next N (1 ≤ N ≤ 100,000) days.

FJ wants to create a budget for a sequential set of exactly M (1 ≤ M ≤ N) fiscal periods called "fajomonths". Each of these fajomonths contains a set of 1 or more consecutive days. Every day is contained in exactly one fajomonth.

FJ's goal is to arrange the fajomonths so as to minimize the expenses of the fajomonth with the highest spending and thus determine his monthly spending limit.

给出农夫在n天中每天的花费，要求把这n天分作m组，每组的天数必然是连续的，要求分得各组的花费之和应该尽可能地小，最后输出各组花费之和中的最大值

## 输入格式

Line 1: Two space-separated integers: N and M


Lines 2..N+1: Line i+1 contains the number of dollars Farmer John spends on the ith day

## 输出格式

Line 1: The smallest possible monthly limit Farmer John can afford to live with.

## 样例

### 样例输入 #1
```
7 5
100
400
300
100
500
101
400
```
### 样例输出 #1
```
500
```
## 提示

If Farmer John schedules the months so that the first two days are a month, the third and fourth are a month, and the last three are their own months, he spends at most $500 in any month. Any other method of scheduling gives a larger minimum monthly limit.



---

---
title: "[USACO07NOV] Sunscreen G"
layout: "post"
diff: 普及/提高-
pid: P2887
tag: ['动态规划 DP', '贪心', '2007', 'USACO']
---
# [USACO07NOV] Sunscreen G
## 题目描述

To avoid unsightly burns while tanning, each of the C (1 ≤ C ≤ 2500) cows must cover her hide with sunscreen when they're at the beach. Cow i has a minimum and maximum SPF rating (1 ≤ minSPFi ≤ 1,000; minSPFi ≤ maxSPFi ≤ 1,000) that will work. If the SPF rating is too low, the cow suffers sunburn; if the SPF rating is too high, the cow doesn't tan at all........

The cows have a picnic basket with L (1 ≤ L ≤ 2500) bottles of sunscreen lotion, each bottle i with an SPF rating SPFi (1 ≤ SPFi ≤ 1,000). Lotion bottle i can cover coveri cows with lotion. A cow may lotion from only one bottle.

What is the maximum number of cows that can protect themselves while tanning given the available lotions?

有C个奶牛去晒太阳 (1 <=C <= 2500)，每个奶牛各自能够忍受的阳光强度有一个最小值和一个最大值，太大就晒伤了，太小奶牛没感觉。

而刚开始的阳光的强度非常大，奶牛都承受不住，然后奶牛就得涂抹防晒霜，防晒霜的作用是让阳光照在身上的阳光强度固定为某个值。

那么为了不让奶牛烫伤，又不会没有效果。

给出了L种防晒霜。每种的数量和固定的阳光强度也给出来了

每个奶牛只能抹一瓶防晒霜，最后问能够享受晒太阳的奶牛有几个。

## 输入格式

\* Line 1: Two space-separated integers: C and L

\* Lines 2..C+1: Line i describes cow i's lotion requires with two integers: minSPFi and maxSPFi

\* Lines C+2..C+L+1: Line i+C+1 describes a sunscreen lotion bottle i with space-separated integers: SPFi and coveri

## 输出格式

A single line with an integer that is the maximum number of cows that can be protected while tanning

## 样例

### 样例输入 #1
```
3 2
3 10
2 5
1 5
6 2
4 1
```
### 样例输出 #1
```
2
```


---

---
title: "[USACO07NOV] Cow Hurdles S"
layout: "post"
diff: 普及/提高-
pid: P2888
tag: ['2007', 'USACO', '最短路']
---
# [USACO07NOV] Cow Hurdles S
## 题目描述

Farmer John wants the cows to prepare for the county jumping competition, so Bessie and the gang are practicing jumping over hurdles. They are getting tired, though, so they want to be able to use as little energy as possible to jump over the hurdles.

Obviously, it is not very difficult for a cow to jump over several very short hurdles, but one tall hurdle can be very stressful. Thus, the cows are only concerned about the height of the tallest hurdle they have to jump over.

The cows' practice room has $N$ stations, conveniently labeled $1,\dots,N$. A set of $M$ one-way paths connects pairs of stations; the paths are also conveniently labeled $1,\dots,M$. Path $i$ travels from station $S_i$ to station $E_i$ and contains exactly one hurdle of height $H_i$. Cows must jump hurdles in any path they traverse.

The cows have $T$ tasks to complete. Task $i$ comprises two distinct numbers, $A_i$ and $B_i$, which connote that a cow has to travel from station $A_i$ to station $B_i$ (by traversing over one or more paths over some route). The cows want to take a path the minimizes the height of the tallest hurdle they jump over when traveling from $A_i$ to $B_i$ . Your job is to write a program that determines the path whose tallest hurdle is smallest and report that height.


Farmer John 想让她的奶牛准备郡级跳跃比赛，Bessie 和她的伙伴们正在练习跨栏。她们很累，所以她们想消耗最少的能量来跨栏。 显然，对于一头奶牛跳过几个矮栏是很容易的，但是高栏却很难。于是，奶牛们总是关心路径上最高的栏的高度。 

奶牛的训练场中有 $N$ 个站台，分别标记为 $1,\dots,N$。所有站台之间有 $M$ 条单向路径，第 $i$ 条路经是从站台 $S_i$ 开始，到站台 $E_i$，其中最高的栏的高度为 $H_i$。无论如何跑，奶牛们都要跨栏。 

奶牛们有 $T$ 个训练任务要完成。第 $i$ 个任务包含两个数字 $A_i$ 和 $B_i$，表示奶牛必须从站台 $A_i$ 跑到站台 $B_i$，可以路过别的站台。奶牛们想找一条路径从站台 $A_i$ 到站台 $B_i$，使路径上最高的栏的高度最小。 你的任务就是写一个程序，计算出路径上最高的栏的高度的最小值。

## 输入格式

\* Line $1$: Three space-separated integers: $N$, $M$, and $T$

\* Lines $2,\dots,M+1$: Line $i+1$ contains three space-separated integers: $S_i$ , $E_i$ , and $H_i$

\* Lines $M+2,\dots,M+T+1$: Line $i+M+1$ contains two space-separated integers that describe task $i$: $A_i$ and $B_i$


第一行：三个空格隔开的整数 $N, M, T$。

接下来 $M$ 行：第 $i$ 行包含三个空格隔开的整数 $S_i, E_i, H_i$。

接下来 $T$ 行：第 $i$ 行包含两个空格隔开的整数，表示任务 $i$ 的起始站台和目标站台 $A_i, B_i$。

## 输出格式

\* Lines $1,\dots,T$: Line $i$ contains the result for task $i$ and tells the smallest possible maximum height necessary to travel between the stations. Output `-1` if it is impossible to travel between the two stations.

$T$ 行：第 $i$ 行为一个整数，表示任务 $i$ 路径上最高的栏的高度的最小值。如果无法到达，输出 `-1`。
## 样例

### 样例输入 #1
```
5 6 3
1 2 12
3 2 8
1 3 5
2 5 3
3 4 4
2 4 8
3 4
1 2
5 1

```
### 样例输出 #1
```
4
8
-1

```
## 提示

对于 $100\%$ 的数据，$1 \le N \le 300$，$1 \le M \le 2.5 \times 10^4$，$1 \le H_i \le 1 \times 10^6$，$1 \le T \le 4 \times 10^4$，$1 \le A_i,B_i \le N$。

感谢 @gaozhiyong @_Cppsteve_ 提供翻译



---

---
title: "[USACO07NOV] Milking Time S"
layout: "post"
diff: 普及/提高-
pid: P2889
tag: ['动态规划 DP', '2007', 'USACO', '排序', '背包 DP']
---
# [USACO07NOV] Milking Time S
## 题目描述

Bessie 可以在接下来 $N$ 个小时内产奶，为了方便，我们把这 $N$ 个小时 $1\dots N$ 编号。

FJ 在这 $N$ 个小时内有 $M$ 段时间可以来给 Bessie 挤奶，第 $i$ 段时间从 $Start_i$ 开始到 $End_i$ 结束，可以得到 $Eff_i$ 加仑牛奶。

每次 FJ 给 Bessie 挤奶之后，Bessie 都要休息 $R$ 个小时，FJ 才能开始下一次挤奶。

现在，FJ 需要您计算出 Bessie 在这 $N$ 个小时内最多产多少奶。
## 输入格式

第一行有三个整数，分别表示 $N,M,R$。

第 $2\dots M+1$ 行，第 $i+1$ 行有三个整数 $Start_i,End_i,Eff_i$，描述一段挤奶的时间。
## 输出格式

输出一行一个整数表示答案。
## 样例

### 样例输入 #1
```
12 4 2
1 2 8
10 12 19
3 6 24
7 10 31
```
### 样例输出 #1
```
43
```
## 提示

#### 数据规模与约定
对于全部的测试点，保证 $1\le N\le 10^6$，$1\le M\le 10^3$，$1\le Start_i<end_i\le N$，$1\le Eff_i\le 10^6$。


---

---
title: "[USACO08FEB] Meteor Shower S"
layout: "post"
diff: 普及/提高-
pid: P2895
tag: ['搜索', '2008', 'USACO', '广度优先搜索 BFS']
---
# [USACO08FEB] Meteor Shower S
## 题目描述

Bessie hears that an extraordinary meteor shower is coming; reports say that these meteors will crash into earth and destroy anything they hit. Anxious for her safety, she vows to find her way to a safe location (one that is never destroyed by a meteor) . She is currently grazing at the origin in the coordinate plane and wants to move to a new, safer location while avoiding being destroyed by meteors along her way.

The reports say that M meteors (1 ≤ M ≤ 50,000) will strike, with meteor i will striking point (Xi, Yi) (0 ≤ Xi ≤ 300; 0 ≤ Yi ≤ 300) at time Ti (0 ≤ Ti  ≤ 1,000). Each meteor destroys the point that it strikes and also the four rectilinearly adjacent lattice points.

Bessie leaves the origin at time 0 and can travel in the first quadrant and parallel to the axes at the rate of one distance unit per second to any of the (often 4) adjacent rectilinear points that are not yet destroyed by a meteor. She cannot be located on a point at any time greater than or equal to the time it is destroyed).

Determine the minimum time it takes Bessie to get to a safe place.

## 输入格式

\* Line 1: A single integer: M

\* Lines 2..M+1: Line i+1 contains three space-separated integers: Xi, Yi, and Ti

## 输出格式

\* Line 1: The minimum time it takes Bessie to get to a safe place or -1 if it is impossible.

## 样例

### 样例输入 #1
```
4
0 0 2
2 1 2
1 1 2
0 3 5

```
### 样例输出 #1
```
5

```
## 题目翻译

## 题目描述
贝茜听说一场特别的流星雨即将到来：这些流星会撞向地球，并摧毁它们所撞击的任何东西。她为自己的安全感到焦虑，发誓要找到一个安全的地方（一个永远不会被流星摧毁的地方）。

如果将牧场放入一个直角坐标系中，贝茜现在的位置是原点，并且，贝茜不能踏上一块被流星砸过的土地。

根据预报，一共有 $M$ 颗流星 $(1\leq M\leq 50,000)$ 会坠落在农场上，其中第 $i$ 颗流星会在时刻 $T_i$（$0 \leq T _ i \leq 1000$）砸在坐标为 $(X_i,Y_i)(0\leq X_i\leq 300$，$0\leq Y_i\leq 300)$ 的格子里。流星的力量会将它所在的格子，以及周围 $4$ 个相邻的格子都化为焦土，当然贝茜也无法再在这些格子上行走。

贝茜在时刻 $0$ 开始行动，她只能在会在横纵坐标 $X,Y\ge 0$ 的区域中，平行于坐标轴行动，每 $1$ 个时刻中，她能移动到相邻的（一般是 $4$ 个）格子中的任意一个，当然目标格子要没有被烧焦才行。如果一个格子在时刻 $t$ 被流星撞击或烧焦，那么贝茜只能在 $t$ 之前的时刻在这个格子里出现。 贝茜一开始在 $(0,0)$。

请你计算一下，贝茜最少需要多少时间才能到达一个安全的格子。如果不可能到达输出 $−1$。
## 输入格式
共 $M+1$ 行，第 $1$ 行输入一个整数 $M$，接下来的 $M$ 行每行输入三个整数分别为 $X_i, Y_i, T_i$。
## 输出格式
贝茜到达安全地点所需的最短时间，如果不可能，则为 $-1$。


---

---
title: "[USACO08FEB] Eating Together S"
layout: "post"
diff: 普及/提高-
pid: P2896
tag: ['动态规划 DP', '递推', '2008', 'USACO', '队列']
---
# [USACO08FEB] Eating Together S
## 题目描述

The cows are so very silly about their dinner partners. They have organized themselves into three groups (conveniently numbered 1, 2, and 3) that insist upon dining together. The trouble starts when they line up at the barn to enter the feeding area.

Each cow i carries with her a small card upon which is engraved Di (1 ≤ Di ≤ 3) indicating her dining group membership. The entire set of N (1 ≤ N ≤ 30,000) cows has lined up for dinner but it's easy for anyone to see that they are not grouped by their dinner-partner cards.

FJ's job is not so difficult. He just walks down the line of cows changing their dinner partner assignment by marking out the old number and writing in a new one. By doing so, he creates groups of cows like 111222333 or 333222111 where the cows' dining groups are sorted in either ascending or descending order by their dinner cards.

FJ is just as lazy as the next fellow. He's curious: what is the absolute mminimum number of cards he must change to create a proper grouping of dining partners? He must only change card numbers and must not rearrange the cows standing in line.

FJ的奶牛们在吃晚饭时很傻。他们把自己组织成三组（方便编号为1, 2和3），坚持一起用餐。当他们在谷仓排队进入喂食区时，麻烦就开始了。


每头奶牛都随身带着一张小卡片，小卡片上刻的是Di（1≤Di≤3）表示她属于哪一组。所有的N（1≤N≤30000）头奶牛排队吃饭，但他们并不能按卡片上的分组站好。


FJ的工作并不是那么难。他只是沿着牛的路线走下去，把旧的号码标出来，换上一个新的。通过这样做，他创造了一群奶牛，比如111222333或333222111，奶牛的就餐组按他们的晚餐卡片按升序或降序排列。


FJ就像任何人一样懒惰。他很好奇：怎样他才能进行适当的分组，使得他只要修改最少次数的数字？由于奶牛们已经很长时间没有吃到饭了，所以“哞哞”的声音到处都是，FJ只好更换卡号，而不能重新排列已经排好队的奶牛。

## 输入格式

\* Line 1: A single integer: N

\* Lines 2..N+1: Line i describes the i-th cow's current dining group with a single integer: Di

- 第1行：一个整数：n

- 第2~n+1行：第i-1行描述第i个奶牛目前分组。

## 输出格式

\* Line 1: A single integer representing the minimum number of changes that must be made so that the final sequence of cows is sorted in either ascending or descending order

一个整数，表示必须做出的最小变化数，以便以升序或降序排序最终序列。

## 样例

### 样例输入 #1
```
5
1
3
2
1
1

```
### 样例输出 #1
```
1

```
## 提示

感谢@一思千年 提供翻译



---

---
title: "[USACO08JAN] Cell Phone Network G"
layout: "post"
diff: 普及/提高-
pid: P2899
tag: ['2008', 'USACO', '排序', '树形 DP', '拓扑排序']
---
# [USACO08JAN] Cell Phone Network G
## 题目描述

Farmer John has decided to give each of his cows a cell phone in hopes to encourage their social interaction. This, however, requires him to set up cell phone towers on his N (1 ≤ N ≤ 10,000) pastures (conveniently numbered 1..N) so they can all communicate.

Exactly N-1 pairs of pastures are adjacent, and for any two pastures A and B (1 ≤ A ≤ N; 1 ≤ B ≤ N; A ≠ B) there is a sequence of adjacent pastures such that A is the first pasture in the sequence and B is the last. Farmer John can only place cell phone towers in the pastures, and each tower has enough range to provide service to the pasture it is on and all pastures adjacent to the pasture with the cell tower.

Help him determine the minimum number of towers he must install to provide cell phone service to each pasture.

Farmer John 想让他的所有牛用上手机以便相互交流。他需要建立几座信号塔在 $N$ 块草地中。已知与信号塔相邻的草地能收到信号。给你 $N-1$ 个草地 $(A,B)$ 的相邻关系，问：最少需要建多少个信号塔能实现所有草地都有信号。

## 输入格式

\* Line 1: A single integer: N

\* Lines 2..N: Each line specifies a pair of adjacent pastures with two space-separated integers: A and B

## 输出格式

\* Line 1: A single integer indicating the minimum number of towers to install

## 样例

### 样例输入 #1
```
5
1 3
5 2
4 3
3 5

```
### 样例输出 #1
```
2

```


---

---
title: "[USACO08MAR] Pearl Pairing G"
layout: "post"
diff: 普及/提高-
pid: P2902
tag: ['贪心', '2008', 'USACO', 'Special Judge']
---
# [USACO08MAR] Pearl Pairing G
## 题目描述

At Bessie's recent birthday party, she received $N(2 \le N \le 10^5,N\equiv0\pmod{2})$ pearls, each painted one of C different colors ($1\le C \le N$).

Upon observing that the number of pearls $N$ is always even, her creative juices flowed and she decided to pair the pearls so that each pair of pearls has two different colors.

Knowing that such a set of pairings is always possible for the supplied testcases, help Bessie perform such a pairing. If there are multiple ways of creating a pairing, any solution suffices.

在 Bessie 最近的生日聚会上，她收到 $N(2\le N \le 10^5,N\equiv0\pmod{2})$ 颗珍珠。一共有 $C$ 种颜色的珍珠（$1\le C \le N$），第 $i$ 种颜色的珍珠有 $C_i$ 颗。


观察到珍珠的数量 $N$ 总是偶数，她的创意来了，决定配对珍珠，使每对珍珠有两种不同的颜色。数据保证存在答案。请帮助 Bessie 执行这样的配对，如果有多种配对的方法，输出任意一种即可。
## 输入格式

Line $1$: Two space-separated integers: $N$ and $C$.

Lines $2 \ldots C+1$: Line $i+1$ tells the count of pearls with color $i$: $C_i$.

第 $1$ 行：两个空格分隔的整数：$N$ 和 $C$。

第 $2\ldots C+1$行：第 $i+1$ 为颜色 $i$ 的珍珠数 $C_i$。
## 输出格式

Lines $1\ldots \dfrac{N}{2}$: Line $i$ contains two integers $a_i$ and $b_i$ indicating that Bessie can pair two pearls with respective colors $a_i$ and $b_i$.

第 $1\ldots \dfrac{N}{2}$ 行：第 $i$ 行包含两个整数 $a_i$ 和 $b_i$，表示 Bessie 可以将各自颜色为 $a_i$ 和 $b_i$ 的两个珍珠配对。
## 样例

### 样例输入 #1
```
8 3 
2 
2 
4 

```
### 样例输出 #1
```
1 3 
1 3 
2 3 
3 2 

```
## 提示

There are $8$ pearls and $3$ different colors. Two pearls have color $\mathrm{I}$; two have color $\mathrm{II}$; four have color $\mathrm{III}$.


Bessie pairs each pearl of color $\mathrm{III}$ with one of color $\mathrm{I}$ and $\mathrm{Ii}$.

说明：有 $8$ 颗珍珠和 $3$ 种不同的颜色。两颗珍珠颜色为 $1$，两颗珍珠颜色为 $2$，四颗珍珠颜色为 $3$。

Bessie 将每颗颜色为 $3$ 的珍珠与颜色为 $1$ 和 $2$ 的珍珠配对。

感谢@[线段木](https://www.luogu.com.cn/user/33930) 提供翻译，@[PineappleSummer](https://www.luogu.com.cn/user/880187) 修正翻译以及提供 $\LaTeX$。


---

---
title: "[USACO08MAR] The Loathesome Hay Baler S"
layout: "post"
diff: 普及/提高-
pid: P2903
tag: ['模拟', '搜索', '2008', 'USACO', '广度优先搜索 BFS']
---
# [USACO08MAR] The Loathesome Hay Baler S
## 题目描述

Farmer John has purchased the world's most loathesome hay baler. Instead of having a drive-roller that drives maybe an idler roller that drives the power take-off for the baler, it has N rollers (2 <= N <= 1050) which drive and are driven by various rollers.

FJ has meticulously cataloged data for each roller i: X\_i,Y\_i are the center of the roller (-5000 <= X\_i <= 5000; -5000 <= Y\_i <= 5000); R\_i is the roller's radius (3 <= R\_i <= 800). The drive-roller is located at 0,0; the baler power take-off is located at X\_t,Y\_t (numbers supplied in the input).

The drive-roller turns clockwise at 10,000 revolutions per hour. Your job is to determine the speeds of all the rollers that are in the power-train: from the drive-roller through the power take-off roller. Rollers that do not transfer power to the take-off roller are to be ignored. A roller of radius Rd that is turning at S rph and driving another roller of radius Rx will cause the second roller to turn at the speed -S\*Rd/Rx (where the sign denotes whether the roller is turning clockwise or counterclockwise (anticlockwise for our British friends)).

Determine the power-train path and report the sum of the absolute values of all those rollers' speeds. All the rollers in the input set except the driver-roller are driven by some other roller; power is never transferred to a roller from more than one other roller.

Report your answer as an integer that is the truncated value after summing all the speeds.
## 输入格式

\* Line 1: Three space-separated integers: N, X\_t, and Y\_t

\* Lines 2..N+1: Line i+1 describes roller i's properties: X\_i, Y\_i, and R\_i
## 输出格式

\* Line 1: A single integer that is the truncated version of the sum of the absolute value of the speeds of the rollers in the power-train including the drive-roller, all the driven rollers, and the power take-off roller.
## 样例

### 样例输入 #1
```
4 32 54 
0 0 10 
0 30 20 
32 54 20 
-40 30 20 

```
### 样例输出 #1
```
20000 

```
## 提示

$2 \leq N \leq 1050$，$-5000 \leq x,y \leq 5000$，$3 \leq r \leq 800$。




Four rollers: the drive-roller at 0,0 with radius 10. It drives the roller above it at 0,30 with radius 20. That roller drives both the power take-off roller at 32,54 (r=20) and a random roller (not in the power train) at -40,30 (r=20).


Roller   Radius   Speed

1 (0,0)     10     10,000 

2 (0,30)    20     -5,000 

3 (32,54)   20      5,000 

------
Sum of abs values: 20,000

## 题目翻译

Farmer John 新买的干草打包机的内部结构大概算世界上最混乱的了，它不像普通的机器一样有明确的内部传动装置，而是 $N$ 个齿轮互相作用，每个齿轮都可能驱动着多个齿轮。 FJ 记录了对于每个齿轮 $i$，记录了它的 $3$ 个参数，以一个三元组 $(x,y,r)$ 表示，$x$ 和 $y$ 表示齿轮中心的位置坐标，$r$ 表示该齿轮的半径。

驱动齿轮的位置为 $(0,0)$，并且 FJ 也知道最终的工作齿轮位于 $(X_t,Y_t)$。 驱动齿轮顺时针转动，转速为 $10,000$ 转/小时。你的任务是，确定传动序列中所有齿轮的转速。传动序列的定义为，能量由驱动齿轮传送到工作齿轮的过程中用到的所有齿轮的集合。对能量传送无意义的齿轮都应当被忽略。

在一个半径为 $R_d$，转速为 $S$ 转/每小时的齿轮的带动下，与它相接的半径为 $R_x$ 的齿轮的转速将为 $-S\times \frac{R_d}{R_x}$ 转/小时。$S$ 前的负号的意思是，一个齿轮带动的另一个齿轮的转向会与它的转向相反。

FJ 只对整个传动序列中所有齿轮速度的绝对值之和感兴趣，你的任务也就相应转化成求这个值。机器中除了驱动齿轮以外的所有齿轮都被另外某个齿轮带动，并且不会出现 $2$ 个不同的齿轮带动同一个齿轮的情况。

### 输入格式

第一行，三个整数，分别代表 $N,X_t,Y_t$；

第 $2$ 行到第 $N+1$ 行，每行三个整数，代表一个三元组 $(x,y,r)$。

### 输出格式

输出共一行，一个整数，代表整个传动序列中所有齿轮速度的绝对值之和。


---

---
title: "[USACO08MAR] River Crossing S"
layout: "post"
diff: 普及/提高-
pid: P2904
tag: ['动态规划 DP', '2008', 'USACO', '背包 DP']
---
# [USACO08MAR] River Crossing S
## 题目描述

Farmer John is herding his N cows (1 <= N <= 2,500) across the expanses of his farm when he finds himself blocked by a river. A single raft is available for transportation.

FJ knows that he must ride on the raft for all crossings and that that adding cows to the raft makes it traverse the river more slowly.

When FJ is on the raft alone, it can cross the river in M minutes (1 <= M <= 1000).  When the i cows are added, it takes M\_i minutes (1 <= M\_i <= 1000) longer to cross the river than with i-1 cows (i.e., total M+M\_1 minutes with one cow, M+M\_1+M\_2 with two, etc.). Determine the minimum time it takes for Farmer John to get all of the cows across the river (including time returning to get more cows).
## 输入格式

\* Line 1: Two space-separated integers: N and M

\* Lines 2..N+1: Line i+1 contains a single integer: M\_i

## 输出格式

\* Line 1: The minimum time it takes for Farmer John to get all of the cows across the river.

## 样例

### 样例输入 #1
```
5 10 
3 
4 
6 
100 
1 

```
### 样例输出 #1
```
50 

```
## 提示

There are five cows. Farmer John takes 10 minutes to cross the river alone, 13 with one cow, 17 with two cows, 23 with three, 123 with four, and 124 with all five.


Farmer John can first cross with three cows (23 minutes), then return (10 minutes), and then cross with the last two (17 minutes). 23+10+17 = 50 minutes total.

## 题目翻译

### 题目描述
农夫约翰以及他的 $N(1 \le N \le 2500)$ 头奶牛打算过一条河，但他们所有的渡河工具，仅仅是一个木筏。 

由于奶牛不会划船，在整个渡河过程中，约翰必须始终在木筏上。在这个基础上，木筏上的奶牛数目每增加 $1$，FJ把木筏划到对岸就得花更多的时间。 

当约翰一个人坐在木筏上，他把木筏划到对岸需要 $M(1 \le M \le 1000)$ 分钟。当木筏搭载的奶牛数目从 $i-1$ 增加到 $i$ 时，约翰得多花 $M_i(1 \le M_i \le 1000)$ 分钟才能把木筏划过河（也就是说，船上有 $1$ 头奶牛时，约翰得花 $M+M_1$ 分钟渡河；船上有 $2$ 头奶牛时，时间就变成 $M+M_1+M_2$ 分钟。后面的以此类推）。那么，约翰最少要花多少时间，才能把所有奶牛带到对岸呢？当然，这个时间得包括约翰一个人把木筏从对岸划回来接下一批的奶牛的时间。

### 输入格式
* 第一行包含 $2$ 个整型变量 $N$ 和 $M$。
* 第二行包含 $2 ... N + 1$ 个整数，第 $i + 1$ 行包含 $1$ 个整数 $M_i$。

### 输出格式
* 输出共 $1$ 行，为农夫约翰让所有奶牛过河所需的最短时间。


---

---
title: "[USACO08OPEN] Clear And Present Danger S"
layout: "post"
diff: 普及/提高-
pid: P2910
tag: ['2008', 'USACO', '最短路']
---
# [USACO08OPEN] Clear And Present Danger S
## 题目描述

Farmer John is on a boat seeking fabled treasure on one of the N (1 <= N <= 100) islands conveniently labeled 1..N in the Cowribbean Sea.

The treasure map tells him that he must travel through a certain sequence A\_1, A\_2, ..., A\_M of M (2 <= M <= 10,000) islands, starting on island 1 and ending on island N before the treasure will appear to him. He can visit these and other islands out of order and even more than once, but his trip must include the A\_i sequence in the order specified by the map.

FJ wants to avoid pirates and knows the pirate-danger rating (0 <= danger <= 100,000) between each pair of islands. The total danger rating of his mission is the sum of the danger ratings of all the paths he traverses.

Help Farmer John find the least dangerous route to the treasure that satisfies the treasure map's requirement.

## 输入格式

\* Line 1: Two space-separated integers: N and M

\* Lines 2..M+1: Line i+1 describes the i\_th island FJ must visit with a single integer: A\_i

\* Lines M+2..N+M+1: Line i+M+1 contains N space-separated integers that are the respective danger rating of the path between island i and islands 1, 2, ..., and N, respectively. The ith integer is always zero.

## 输出格式

\* Line 1: The minimum danger that Farmer John can encounter while obtaining the treasure.

## 样例

### 样例输入 #1
```
3 4 
1 
2 
1 
3 
0 5 1 
5 0 2 
1 2 0 

```
### 样例输出 #1
```
7 

```
## 提示

There are 3 islands and the treasure map requires Farmer John to visit a sequence of 4 islands in order: island 1, island 2, island 1 again, and finally island 3. The danger ratings of the paths are given: the paths (1, 2); (2, 3); (3, 1) and the reverse paths have danger ratings of 5, 2, and 1, respectively.


He can get the treasure with a total danger of 7 by traveling in the sequence of islands 1, 3, 2, 3, 1, and 3. The cow map's requirement (1, 2, 1, and 3) is satisfied by this route. We avoid the path between islands 1 and 2 because it has a large danger rating.

输入输出格式


输入格式：


第一行：两个用空格隔开的正整数N和M


第二到第M+1行：第i+1行用一个整数Ai表示FJ必须经过的第i个岛屿


第M+2到第N+M+1行：第i+M+1行包含N个用空格隔开的非负整数分别表示i号小岛到第1...N号小岛的航线各自的危险指数。保证第i个数是0。

输出格式


第一行：FJ在找到宝藏的前提下经过的航线的危险指数之和的最小值。

说明

这组数据中有三个岛屿，藏宝图要求FJ按顺序经过四个岛屿：1号岛屿、2号岛屿、回到1号岛屿、最后到3号岛屿。每条航线的危险指数也给出了：航路(1，2)、(2，3)、(3，1)和它们的反向路径的危险指数分别是5、2、1。


FJ可以通过依次经过1、3、2、3、1、3号岛屿以7的最小总危险指数获得宝藏。这条道路满足了奶牛地图的要求（1，2，1，3）。我们避开了1号和2号岛屿之间的航线，因为它的危险指数太大了。


注意：测试数据中a到b的危险指数不一定等于b到a的危险指数！

## 题目翻译

农夫约翰正驾驶一条小艇在牛勒比海上航行．

海上有 $N(1\leq N\leq 100)$ 个岛屿，用 $1$ 到 $N$ 编号．约翰从 $1$ 号小岛出发，最后到达 $N$ 号小岛．

一张藏宝图上说，如果他的路程上经过的小岛依次出现了  $A_1,A_2,\dots ,A_M(2\leq M\leq 10000)$ 这样的序列（不一定相邻），那他最终就能找到古老的宝藏． 但是，由于牛勒比海有海盗出没．约翰知道任意两个岛屿之间的航线上海盗出没的概率，他用一个危险指数 $D_{i,j}(0\leq D_{i,j}\leq 100000)$ 来描述．他希望他的寻宝活动经过的航线危险指数之和最小．那么，在找到宝藏的前提下，这个最小的危险指数是多少呢？

输入输出格式

输入格式：

第一行：两个用空格隔开的正整数 $N$ 和 $M$。

第二到第 $M+1$ 行：第 $i+1$ 行用一个整数 $A_i$ 表示 FJ 必须经过的第 $i$ 个岛屿

第 $M+2$ 到第 $N+M+1$ 行：第 $i+M+1$ 行包含 $N$ 个用空格隔开的非负整数分别表示 $i$ 号小岛到第 $1\dots N$ 号小岛的航线各自的危险指数。保证第 $i$ 个数是 $0$。

输出格式
第一行：FJ 在找到宝藏的前提下经过的航线的危险指数之和的最小值。

说明
这组数据中有三个岛屿，藏宝图要求 FJ 按顺序经过四个岛屿：$1$ 号岛屿、$2$ 号岛屿、回到 $1$ 号岛屿、最后到 $3$ 号岛屿。每条航线的危险指数也给出了：航路$(1,2),(2,3),(3,1)$ 和它们的反向路径的危险指数分别是 $5,2,1$。

FJ 可以通过依次经过 $1,3,2,3,1,3$ 号岛屿以 $7$ 的最小总危险指数获得宝藏。这条道路满足了奶牛地图的要求 $(1,2,1,3)$。我们避开了 $1$ 号和 $2$ 号岛屿之间的航线，因为它的危险指数太大了。

注意：测试数据中 $a$ 到 $b$ 的危险指数不一定等于 $b$ 到 $a$ 的危险指数！

Translated by @LJC00125 


---

---
title: "[USACO08OCT] Pasture Walking G"
layout: "post"
diff: 普及/提高-
pid: P2912
tag: ['2008', 'USACO']
---
# [USACO08OCT] Pasture Walking G
## 题目描述

The N cows (2 <= N <= 1,000) conveniently numbered 1..N are grazing among the N pastures also conveniently numbered 1..N. Most conveniently of all, cow i is grazing in pasture i.

Some pairs of pastures are connected by one of N-1 bidirectional walkways that the cows can traverse. Walkway i connects pastures A\_i and B\_i (1 <= A\_i <= N; 1 <= B\_i <= N) and has a length of L\_i (1 <= L\_i <= 10,000).

The walkways are set up in such a way that between any two distinct pastures, there is exactly one path of walkways that travels between them. Thus, the walkways form a tree.

The cows are very social and wish to visit each other often. Ever in a hurry, they want you to help them schedule their visits by computing the lengths of the paths between 1 <= L\_i <= 10,000 pairs of pastures (each pair given as a query p1,p2 (1 <= p1 <= N; 1 <= p2 <= N).

POINTS: 200

有N(2<=N<=1000)头奶牛，编号为1到W，它们正在同样编号为1到N的牧场上行走.为了方 便，我们假设编号为i的牛恰好在第i号牧场上.

有一些牧场间每两个牧场用一条双向道路相连，道路总共有N - 1条，奶牛可以在这些道路 上行走.第i条道路把第Ai个牧场和第Bi个牧场连了起来(1 <= A\_i <= N; 1 <= B\_i <= N)，而它的长度 是 1 <= L\_i <= 10,000.在任意两个牧场间，有且仅有一条由若干道路组成的路径相连.也就是说，所有的道路构成了一棵树.

奶牛们十分希望经常互相见面.它们十分着急，所以希望你帮助它们计划它们的行程，你只 需要计算出Q(1 < Q < 1000)对点之间的路径长度•每对点以一个询问p1,p2 (1 <= p1 <= N; 1 <= p2 <= N). 的形式给出.


## 输入格式

\* Line 1: Two space-separated integers: N and Q

\* Lines 2..N: Line i+1 contains three space-separated integers: A\_i, B\_i, and L\_i

\* Lines N+1..N+Q: Each line contains two space-separated integers representing two distinct pastures between which the cows wish to travel: p1 and p2

## 输出格式

\* Lines 1..Q: Line i contains the length of the path between the two pastures in query i.

## 样例

### 样例输入 #1
```
4 2 
2 1 2 
4 3 2 
1 4 3 
1 2 
3 2 

```
### 样例输出 #1
```
2 
7 

```
## 提示

Query 1: The walkway between pastures 1 and 2 has length 2.

Query 2: Travel through the walkway between pastures 3 and 4, then the one between 4 and 1, and finally the one between 1 and 2, for a total length of 7.



---

---
title: "[USACO08NOV] Cheering up the Cow G"
layout: "post"
diff: 普及/提高-
pid: P2916
tag: ['2008', 'USACO', '生成树']
---
# [USACO08NOV] Cheering up the Cow G
## 题目描述

Farmer John has grown so lazy that he no longer wants to continue maintaining the cow paths that currently provide a way to visit each of his N (5 <= N <= 10,000) pastures (conveniently numbered 1..N). Each and every pasture is home to one cow. FJ plans to remove as many of the P (N-1 <= P <= 100,000) paths as possible while keeping the pastures connected. You must determine which N-1 paths to keep.

Bidirectional path j connects pastures S\_j and E\_j (1 <= S\_j <= N; 1 <= E\_j <= N; S\_j != E\_j) and requires L\_j (0 <= L\_j <= 1,000) time to traverse. No pair of pastures is directly connected by more than one path.

The cows are sad that their transportation system is being reduced. You must visit each cow at least once every day to cheer her up. Every time you visit pasture i (even if you're just traveling

through), you must talk to the cow for time C\_i (1 <= C\_i <= 1,000).

You will spend each night in the same pasture (which you will choose) until the cows have recovered from their sadness. You will end up talking to the cow in the sleeping pasture at least in the morning when you wake up and in the evening after you have returned to sleep.

Assuming that Farmer John follows your suggestions of which paths to keep and you pick the optimal pasture to sleep in, determine the minimal amount of time it will take you to visit each cow at least once in a day.

For your first 10 submissions, you will be provided with the results of running your program on a part of the actual test data.

POINTS: 300

约翰有N个牧场，编号依次为1到N。每个牧场里住着一头奶牛。连接这些牧场的有P条道路，每条道路都是双向的。第j条道路连接的是牧场Sj和Ej，通行需要Lj的时间。两牧场之间最多只有一条道路。约翰打算在保持各牧场连通的情况下去掉尽量多的道路。 

约翰知道，在道路被强拆后，奶牛会非常伤心，所以他计划拆除道路之后就去忽悠她们。约翰可以选择从任意一个牧场出发开始他维稳工作。当他走访完所有的奶牛之后，还要回到他的出发地。每次路过牧场i的时候，他必须花Ci的时间和奶牛交谈，即使之前已经做过工作了，也要留下来再谈一次。注意约翰在出发和回去的时候，都要和出发地的奶牛谈一次话。请你计算一下，约翰要拆除哪些道路，才能让忽悠奶牛的时间变得最少？

## 输入格式

\* Line 1: Two space-separated integers: N and P

\* Lines 2..N+1: Line i+1 contains a single integer: C\_i

\* Lines N+2..N+P+1: Line N+j+1 contains three space-separated

integers: S\_j, E\_j, and L\_j

## 输出格式

\* Line 1: A single integer, the total time it takes to visit all the cows (including the two visits to the cow in your

sleeping-pasture)

## 样例

### 样例输入 #1
```
5 7 
10 
10 
20 
6 
30 
1 2 5 
2 3 5 
2 4 12 
3 4 17 
2 5 15 
3 5 6 
4 5 12 

```
### 样例输出 #1
```
176 

```
## 提示

```cpp
   +-(15)-+ 
  /        \ 
 /          \ 
1-(5)-2-(5)-3-(6)--5 
   \   /(17)  / 
(12)\ /      /(12) 
     4------+ 

Keep these paths: 
1-(5)-2-(5)-3      5 
       \          / 
    (12)\        /(12) 
        *4------+ 
```
Wake up in pasture 4 and visit pastures in the order 4, 5, 4, 2, 3, 2, 1, 2, 4 yielding a total time of 176 before going back to sleep.



---

---
title: "[USACO08NOV] Buying Hay S"
layout: "post"
diff: 普及/提高-
pid: P2918
tag: ['2008', 'USACO', '背包 DP']
---
# [USACO08NOV] Buying Hay S
## 题目描述

Farmer John is running out of supplies and needs to purchase H (1 <= H <= 50,000) pounds of hay for his cows.

He knows N (1 <= N <= 100) hay suppliers conveniently numbered 1..N. Supplier i sells packages that contain P\_i (1 <= P\_i <= 5,000) pounds of hay at a cost of C\_i (1 <= C\_i <= 5,000) dollars. Each supplier has an unlimited number of packages available, and the packages must be bought whole.

Help FJ by finding the minimum cost necessary to purchase at least H pounds of hay.

约翰的干草库存已经告罄，他打算为奶牛们采购 $H(1 \leq H \leq 50000)$ 磅干草。

他知道 $N(1 \leq N\leq 100)$ 个干草公司，现在用 $1$ 到 $N$ 给它们编号。第 $i$ 公司卖的干草包重量为 $P_i (1 \leq P_i \leq 5,000)$ 磅，需要的开销为 $C_i (1 \leq C_i \leq 5,000)$ 美元。每个干草公司的货源都十分充足， 可以卖出无限多的干草包。

帮助约翰找到最小的开销来满足需要，即采购到至少 $H$ 磅干草。
## 输入格式

\* Line 1: Two space-separated integers: N and H

\* Lines 2..N+1: Line i+1 contains two space-separated integers: P\_i and C\_i

## 输出格式

\* Line 1: A single integer representing the minimum cost FJ needs to pay to obtain at least H pounds of hay.

## 样例

### 样例输入 #1
```
2 15 
3 2 
5 3 

```
### 样例输出 #1
```
9 

```
## 提示

FJ can buy three packages from the second supplier for a total cost of 9.



---

---
title: "[USACO08NOV] Time Management S"
layout: "post"
diff: 普及/提高-
pid: P2920
tag: ['贪心', '2008', '二分', 'USACO', '排序']
---
# [USACO08NOV] Time Management S
## 题目描述

Ever the maturing businessman, Farmer John realizes that he must manage his time effectively. He has N jobs conveniently numbered 1..N (1 <= N <= 1,000) to accomplish (like milking the cows, cleaning the barn, mending the fences, and so on).

To manage his time effectively, he has created a list of the jobs that must be finished. Job i requires a certain amount of time T\_i (1 <= T\_i <= 1,000) to complete and furthermore must be finished by time S\_i (1 <= S\_i <= 1,000,000). Farmer John starts his day at time t=0 and can only work on one job at a time until it is finished.

Even a maturing businessman likes to sleep late; help Farmer John determine the latest he can start working and still finish all the jobs on time.

作为一名忙碌的商人，约翰知道必须高效地安排他的时间。他有 $N(1\le N\le 1000)$ 个工作要做，比如给奶牛挤奶，清洗牛棚，修理栅栏之类的。

为了高效，约翰列出了所有工作的清单。第 $i(1\le i\le N)$ 个工作需要 $T_i(1\le T_i\le 1000)$ 单位的时间来完成，而且必须在 $1\le S_i\le 10^6$ 或之前完成。现在是 $0$ 时刻。约翰做一份工作必须直到做完才能停止。

所有的商人都喜欢睡懒觉。请帮约翰计算他最迟什么时候开始工作，可以让所有工作按时完成。（如果始终无法完成全部任务，输出 $-1$）

## 输入格式

\* Line 1: A single integer: N

\* Lines 2..N+1: Line i+1 contains two space-separated integers: T\_i and S\_i

## 输出格式

\* Line 1: The latest time Farmer John can start working or -1 if Farmer John cannot finish all the jobs on time.

## 样例

### 样例输入 #1
```
4 
3 5 
8 14 
5 20 
1 16 

```
### 样例输出 #1
```
2 

```
## 提示

Farmer John has 4 jobs to do, which take 3, 8, 5, and 1 units of time, respectively, and must be completed by time 5, 14, 20, and 16, respectively.


Farmer John must start the first job at time 2. Then he can do the second, fourth, and third jobs in that order to finish on time.



---

---
title: "[USACO08DEC] Patting Heads S"
layout: "post"
diff: 普及/提高-
pid: P2926
tag: ['2008', 'USACO', '素数判断,质数,筛法']
---
# [USACO08DEC] Patting Heads S
## 题目描述

It's Bessie's birthday and time for party games! Bessie has instructed the N (1 <= N <= 100,000) cows conveniently numbered 1..N to sit in a circle (so that cow i [except at the ends] sits next to cows i-1 and i+1; cow N sits next to cow 1). Meanwhile, Farmer John fills a barrel with one billion slips of paper, each containing some integer in the range 1..1,000,000.

Each cow i then draws a number A\_i (1 <= A\_i <= 1,000,000) (which is not necessarily unique, of course) from the giant barrel.  Taking turns, each cow i then takes a walk around the circle and pats the heads of all other cows j such that her number A\_i is exactly

divisible by cow j's number A\_j; she then sits again back in her original position.

The cows would like you to help them determine, for each cow, the number of other cows she should pat.


## 输入格式

\* Line 1: A single integer: N

\* Lines 2..N+1: Line i+1 contains a single integer: A\_i

## 输出格式

\* Lines 1..N: On line i, print a single integer that is the number of other cows patted by cow i.

## 样例

### 样例输入 #1
```
5 
2 
1 
2 
3 
4 

```
### 样例输出 #1
```
2 
0 
2 
1 
3 

```
## 提示

The 5 cows are given the numbers 2, 1, 2, 3, and 4, respectively.


The first cow pats the second and third cows; the second cows pats no cows; etc.

## 题目翻译

今天是贝茜的生日，为了庆祝自己的生日，贝茜邀你来玩一个游戏。

贝茜让 $N$ ($1\leq N\leq 10^5$) 头奶牛坐成一个圈。除了 $1$ 号与 $N$ 号奶牛外，$i$ 号奶牛与 $i-1$ 号和 $i+1$ 号奶牛相邻。$N$ 号奶牛与 $1$ 号奶牛相邻。农夫约翰用很多纸条装满了一个桶，每一张包含了一个不一定是独一无二的 $1$ 到 $10^6$ 的数字。

接着每一头奶牛 $i$ 从桶中取出一张纸条 $A_i$。每头奶牛轮流走上一圈，同时拍打所有手上数字能整除在自己纸条上的数字的牛的头，然后坐回到原来的位置。牛们希望你帮助他们确定，每一头奶牛需要拍打的牛的数量。



---

---
title: "[USACO09JAN] Earthquake Damage G"
layout: "post"
diff: 普及/提高-
pid: P2932
tag: ['2009', 'USACO']
---
# [USACO09JAN] Earthquake Damage G
## 题目描述

Wisconsin has had an earthquake that has struck Farmer John's farm! The earthquake has damaged some of the pastures so that they are unpassable. Remarkably, none of the cowpaths was damaged.

As usual, the farm is modeled as a set of $P(1 \le P \le 30,000)$ pastures conveniently numbered $1\ldots P$ which are connected by a set of $C (1 \le C \le 100,000)$ non-directional cowpaths conveniently numbered $1\ldots C$. Cowpath $i$ connects pastures $a_i$ and $b_i (1 \le a_i \le P; 1 \le b_i \le P)$. Cowpaths might connect $a_i$ to itself or perhaps might connect two pastures more than once.  The barn is located in pasture $1$.

A total of $N (1 \le N \le P)$ cows (in different pastures) sequentially contact Farmer John via moobile phone with an integer message $report_j (2 \le report_j \le P)$ that indicates that pasture $report_j$ is undamaged but that the calling cow is unable to return to the barn from pasture $report_j$ because she could not find a path that does not go through damaged pastures.

After all the cows report in, determine the minimum number of pastures (including ones that are uncrossable) from which it is not possible to return to the barn.

Note: Feedback on some of the test data will be provided on the first $50$ submissions.
## 输入格式

Line $1$: Three space-separated integers: $P$,$C$,and $N$.

Lines $2\ldots C+1$: Line $i+1$ describes cowpath $i$ with two integers: $a_i$ and $b_i$.

Lines $C+2\ldots C+N+1$: Line $C+1+j$ contains a single integer: $report_j$.

## 输出格式

Line $1$: A single integer that is the minimum count of pastures from which a cow can not return to the barn (including the damaged pastures themselves)

## 样例

### 样例输入 #1
```
4 3 1 
1 2 
2 3 
3 4 
3 

```
### 样例输出 #1
```
3 

```
## 提示

Pasture $2$ is damaged, resulting in cows in pastures $2, 3, 4$ not being able to return to the barn.
## 题目翻译

### 题目描述

农夫 John 的农场遭受了一场地震。有一些牛棚遭到了损坏，但幸运地，所有牛棚间的路经都还能使用。FJ 的农场有 $P(1 \le P \le 3\times 10^4)$ 个牛棚，编号 $1\ldots P$。$C(1 \le C \le 1\times 10^5)$ 条双向路径连接这些牛棚,编号为 $1\ldots C$，路经 $i$ 连接牛棚 $a_i$ 和 $b_i (1 \le a_i \le P;1 \le b\_i \le P)$。$a_i$ 与 $b_i$ 可能相同，两个牛棚之间可能有多条路经。农庄在编号为 $1$ 的牛棚。$N (1 
\le N \le P)$ 头在不同牛棚的牛通过手机短信告诉 FJ 它们的牛棚 $report_j(2 \le report_j \le P)$ 没有损坏，但是它们无法通过路径和没有损坏的牛棚回到到农场。当 FJ 接到所有短信之后，找出最小的不可能回到农庄的牛棚数目。这个数目包括损坏的牛棚。注意：前 $50$ 次提交将提供在一些测试数据上的运行结果。




---

---
title: "[USACO09JAN] Best Spot S"
layout: "post"
diff: 普及/提高-
pid: P2935
tag: ['2009', 'USACO', '枚举', '最短路']
---
# [USACO09JAN] Best Spot S
## 题目描述

Bessie, always wishing to optimize her life, has realized that she really enjoys visiting F (1 <= F <= P) favorite pastures F\_i of the P (1 <= P <= 500; 1 <= F\_i <= P) total pastures (conveniently

numbered 1..P) that compose Farmer John's holdings.

Bessie knows that she can navigate the C (1 <= C <= 8,000) bidirectional cowpaths (conveniently numbered 1..C) that connect various pastures to travel to any pasture on the entire farm. Associated with each path P\_i is a time T\_i (1 <= T\_i <= 892) to traverse that path (in either direction) and two path endpoints a\_i and b\_i (1 <= a\_i <= P; 1 <= b\_i <= P).

Bessie wants to find the number of the best pasture to sleep in so that when she awakes, the average time to travel to any of her F favorite pastures is minimized.

By way of example, consider a farm laid out as the map below shows, where \*'d pasture numbers are favorites. The bracketed numbers are times to traverse the cowpaths.

```cpp

            1*--[4]--2--[2]--3
                     |       |
                    [3]     [4]
                     |       |
                     4--[3]--5--[1]---6---[6]---7--[7]--8*
                     |       |        |         |
                    [3]     [2]      [1]       [3]
                     |       |        |         |
                    13*      9--[3]--10*--[1]--11*--[3]--12*
```
The following table shows distances for potential 'best place' of pastures 4, 5, 6, 7, 9, 10, 11, and 12:

```cpp
      * * * * * * Favorites * * * * * *
 Potential      Pasture Pasture Pasture Pasture Pasture Pasture     Average
Best Pasture       1       8      10      11      12      13        Distance
------------      --      --      --      --      --      --      -----------
    4              7      16       5       6       9       3      46/6 = 7.67
    5             10      13       2       3       6       6      40/6 = 6.67
    6             11      12       1       2       5       7      38/6 = 6.33
    7             16       7       4       3       6      12      48/6 = 8.00
    9             12      14       3       4       7       8      48/6 = 8.00
   10             12      11       0       1       4       8      36/6 = 6.00 ** BEST
   11             13      10       1       0       3       9      36/6 = 6.00
   12             16      13       4       3       0      12      48/6 = 8.00

```
Thus, presuming these choices were the best ones (a program would have to check all of them somehow), the best place to sleep is pasture 10.

约翰拥有 $P(1 \leq P \leq 500)$ 个牧场，贝茜特别喜欢其中的 $F$ 个。所有的牧场由 $C(1 < C \leq 8000)$条双向路连接，第 $i$ 条路连接着 $a_i,b_i$，需要 $T_i(1 \leq T_i < 892)$ 个单位时间来通过。

作为一只总想优化自己生活方式的奶牛，贝茜喜欢自己某一天醒来，到达所有那 $F$ 个她喜欢的牧场的平均需时最小。那她前一天应该睡在哪个牧场呢？请帮助贝茜找到这个最佳牧场。

由样例解释可见，在样例环境下，牧场 $10$ 到所有贝茜喜欢的牧场的平均距离最小，为最佳牧场。

## 输入格式

\* Line 1: Three space-separated integers: P, F, and C

\* Lines 2..F+1: Line i+2 contains a single integer: F\_i

\* Lines F+2..C+F+1: Line i+F+1 describes cowpath i with three

space-separated integers: a\_i, b\_i, and T\_i

## 输出格式

\* Line 1: A single line with a single integer that is the best pasture in which to sleep. If more than one pasture is best, choose the smallest one.

## 样例

### 样例输入 #1
```
13 6 15 
11 
13 
10 
12 
8 
1 
2 4 3 
7 11 3 
10 11 1 
4 13 3 
9 10 3 
2 3 2 
3 5 4 
5 9 2 
6 7 6 
5 6 1 
1 2 4 
4 5 3 
11 12 3 
6 10 1 
7 8 7 

```
### 样例输出 #1
```
10 

```
## 提示

As the problem statement


As the problem statement.



---

---
title: "[USACO09MAR] Moon Mooing G"
layout: "post"
diff: 普及/提高-
pid: P2942
tag: ['2009', 'USACO']
---
# [USACO09MAR] Moon Mooing G
## 题目描述

A full moon casts some sort of spell on the cows and, like their cousins the wolves and coyotes, they bay at the moon -- mooing instead of howling, of course.

Each 'moo' lasts a certain amount of time. A short 'moo' might last time 1; a longer one might last time 24 or even 1,000,000,000 or longer (cows can really moo when they want to). No 'moo' will last more than or equal to 2^63.

It should come as no surprise that the cows have a pattern to their moos.  Bessie will choose an integer c (1 <= c <= 100) that is the initial length of a moo.

After Bessie moos for length c, the cows calculate times for

subsequent moos. They apply two formulae to each moo time to yield even more moo times. The two formulae are:

```cpp
f1(c)=a1*c/d1+b1 (integer divide, of course) and 
f2(c)=a2*c/d2+b2. 
They then successively use the two new times created by evaluating f1(c) and f2(c) to create even more mooing times. They keep a sorted list of all the possible mooing times (discarding duplicates). 
They are allowed to moo a total of N times (1 <= N <= 4,000,000). Please determine the length of the longest moo before they must quit. 
The constants in the formulae have these constraints: 1 <= d1 < a1; d1 < a1 <= 20; 0 <= b1 <= 20; 1 <= d2 < a2; d2 < a2 <= 20; 0 <= b2 <= 20. 
Consider an example where c=3 and N=10. The constants are: 
a1=4    b1=3     d1=3 
a2=17   b2=8     d2=2 
```
The first mooing time is 3, given by the value of c. The total list of mooing times is:
```cpp
1. c=3             ->  3       6. f2(3)=17*3/2+8  -> 33 
2. f1(3)=4*3/3+3   ->  7       7. f1(28)=4*28/3+3 -> 40 
3. f1(7)=4*7/3+3   -> 12       8. f1(33)=4*33/3+3 -> 47 
4. f1(12)=4*12/3+3 -> 19       9. f1(40)=4*40/3+3 -> 56 
5. f1(19)=4*19/3+3 -> 28      10. f1(47)=4*47/3+3 -> 65 
The tenth time is 65, which would be the proper answer for this set of inputs. 
```
Partial feedback will be provided on the first 50 submissions.
MEMORY LIMIT: 64MB

满月的时候，和狼一样，牛们也在月光下叫，他们从不嚎叫，而是哞叫。

每次哞叫都有一个时长，可能是 $1$ 秒，可能是 $10^9$ 秒或更久，牛们真的非常能叫.当然，没有哞叫时长会超过或等于 $2^{63}$。

牛们的哞叫可以找到规律，这并不奇怪。贝茜会选择一个整数 $c(c\le100)$ 来作为初始时长之后，牛们根据两条公式确定更多的时长：

$f_1(c)=\lfloor a_1c/d_1\rfloor+b_1$

$f_2(c)=\lfloor a_2c/d_2\rfloor+b_2$ 

牛们用这两条公式不断地迭代、计算，算得大量的时长.然后她们将这些时长排序，剔除重复的时长，最后取前 $N(1<N< 4000000)$ 个整数为她们 $N$ 次哞叫的时长.请你计算，第 $N$ 次哞叫的时长是多少。公式中的常量均为整数，满足下列关系： 

$1 \le d_1 < a_1 \le 20$; $0\le b_1 \le 20$;

$1 \le d_2 < a_2 \le 20$; $0\le b_2\le 20$。

## 输入格式

\* Line 1: Two space-separated integers: c and N

\* Line 2: Three space-separated integers: a1, b1, and d1

\* Line 3: Three space-separated integers: a2, b2, and d2

## 输出格式

\* Line 1: A single line which contains a single integer which is the length of the Nth moo

## 样例

### 样例输入 #1
```
3 10 
4 3 3 
17 8 2 

```
### 样例输出 #1
```
65 

```


---

---
title: "[USACO09MAR] Cow Frisbee Team S"
layout: "post"
diff: 普及/提高-
pid: P2946
tag: ['动态规划 DP', '2009', 'USACO', '背包 DP']
---
# [USACO09MAR] Cow Frisbee Team S
## 题目描述

老唐最近迷上了飞盘，约翰想和他一起玩，于是打算从他家的 $N$ 头奶牛中选出一支队伍。

每只奶牛的能力为整数，第 $i$ 头奶牛的能力为 $R_i$。飞盘队的队员数量不能少于 $1$、大于 $N$。一支队伍的总能力就是所有队员能力的总和。

约翰比较迷信，他的幸运数字是 $F$，所以他要求队伍的总能力必须是 $F$ 的倍数。请帮他算一下，符合这个要求的队伍组合有多少？由于这个数字很大，只要输出答案对 $10^8$ 取模的值。
## 输入格式

第一行：两个用空格分开的整数：$N$ 和 $F$。

第二行到 $N+1$ 行：第 $i+1$ 行有一个整数 $R_i$，表示第 $i$ 头奶牛的能力。
## 输出格式

第一行：单个整数，表示方案数对 $10^8$ 取模的值。
## 样例

### 样例输入 #1
```
4 5 
1 
2 
8 
2 

```
### 样例输出 #1
```
3 

```
## 提示

对于 $100\%$ 的数据，$1 \le N \le 2000$，$1 \le F \le 1000$，$1 \le R_i \le 10^5$。


---

---
title: "[USACO09MAR] Look Up S"
layout: "post"
diff: 普及/提高-
pid: P2947
tag: ['2009', 'USACO', '单调栈']
---
# [USACO09MAR] Look Up S
## 题目描述

Farmer John's N (1 <= N <= 100,000) cows, conveniently numbered 1..N, are once again standing in a row. Cow i has height H\_i (1 <= H\_i <= 1,000,000).

Each cow is looking to her left toward those with higher index numbers. We say that cow i 'looks up' to cow j if i < j and H\_i < H\_j. For each cow i, FJ would like to know the index of the first cow in line looked up to by cow i.

Note: about 50% of the test data will have N <= 1,000. 

约翰的 $N(1\le N\le10^5)$ 头奶牛站成一排，奶牛 $i$ 的身高是 $H_i(1\le H_i\le10^6)$。现在，每只奶牛都在向右看齐。对于奶牛 $i$，如果奶牛 $j$ 满足 $i<j$ 且 $H_i<H_j$，我们可以说奶牛 $i$ 可以仰望奶牛 $j$。 求出每只奶牛离她最近的仰望对象。

Input
## 输入格式

1. \* Line 1: A single integer: N

\* Lines 2..N+1: Line i+1 contains the single integer: H\_i

第 $1$ 行输入 $N$，之后每行输入一个身高 $H_i$。

## 输出格式

\* Lines 1..N: Line i contains a single integer representing the smallest index of a cow up to which cow i looks. If no such cow exists, print 0.

共 $N$ 行，按顺序每行输出一只奶牛的最近仰望对象，如果没有仰望对象，输出 $0$。

## 样例

### 样例输入 #1
```
6 
3 
2 
6 
1 
1 
2 

```
### 样例输出 #1
```
3 
3 
0 
6 
6 
0 

```
## 提示

FJ has six cows of heights 3, 2, 6, 1, 1, and 2.


Cows 1 and 2 both look up to cow 3; cows 4 and 5 both look up to cow 6; and cows 3 and 6 do not look up to any cow.

【输入说明】$6$ 头奶牛的身高分别为 3,2,6,1,1,2。

【输出说明】奶牛 #1,#2 仰望奶牛 #3，奶牛 #4,#5 仰望奶牛 #6，奶牛 #3 和 #6 没有仰望对象。

【数据规模】

对于 $20\%$ 的数据：$1\le N\le10$；

对于 $50\%$ 的数据：$1\le N\le10^3$；

对于 $100\%$ 的数据：$1\le N\le10^5,1\le H_i\le10^6$。



---

---
title: "[USACO09OPEN] Hide and Seek S"
layout: "post"
diff: 普及/提高-
pid: P2951
tag: ['2009', 'USACO', '最短路']
---
# [USACO09OPEN] Hide and Seek S
## 题目描述

Bessie is playing hide and seek (a game in which a number of players hide and a single player (the seeker) attempts to find them after which various penalties and rewards are assessed; much fun usually ensues).

She is trying to figure out in which of N (2 <= N <= 20,000) barns conveniently numbered 1..N she should hide. She knows that FJ (the seeker) starts out in barn 1. All the barns are connected by M (1 <= M <= 50,000) bidirectional paths with endpoints A\_i and B\_i (1 <= A\_i <= N; 1 <= B\_i <= N; A\_i != B\_i); it is possible to reach any barn from any other through the paths.

Bessie decides that it will be safest to hide in the barn that has the greatest distance from barn 1 (the distance between two barns is the smallest number of paths that one must traverse to get from one to the other). Help Bessie figure out the best barn in which to hide.

奶牛贝西和农夫约翰（FJ）玩捉迷藏，现在有N个谷仓，FJ开始在第一个谷仓，贝西为了不让FJ找到她，当然要藏在距离第一个谷仓最远的那个谷仓了。现在告诉你N个谷仓，和M个两两谷仓间的“无向边”。每两个仓谷间当然会有最短路径，现在要求距离第一个谷仓（FJ那里）最远的谷仓是哪个（所谓最远就是距离第一个谷仓最大的最短路径）？如有多个则输出编号最小的。以及求这最远距离是多少，和有几个这样的谷仓距离第一个谷仓那么远。

## 输入格式

\* Line 1: Two space-separated integers: N and M

\* Lines 2..M+1: Line i+1 contains the endpoints for path i: A\_i and B\_i

第一行：两个整数N,M；


第2-M+1行：每行两个整数，表示端点A\_i 和 B\_i 间有一条无向边。

## 输出格式

\* Line 1: On a single line, print three space-separated integers: the index of the barn farthest from barn 1 (if there are multiple such barns, print the smallest such index), the smallest number of paths needed to reach this barn from barn 1, and the number of barns with this number of paths.

仅一行，三个整数，两两中间空格隔开。表示：距离第一个谷仓最远的谷仓编号（如有多个则输出编号最小的。），以及最远的距离，和有几个谷仓距离第一个谷仓那么远。

## 样例

### 样例输入 #1
```
6 7 
3 6 
4 3 
3 2 
1 3 
1 2 
2 4 
5 2 

```
### 样例输出 #1
```
4 2 3 

```
## 提示

The farm layout is as follows:

 ![](https://cdn.luogu.com.cn/upload/pic/2815.png) 

Barns 4, 5, and 6 are all a distance of 2 from barn 1. We choose barn 4 because it has the smallest index.



这里谷仓4，5，6距离1号谷仓都是2，但是4编号最小所以输出4.因此最远距离是2且有3个谷仓，依次输出：2和3。 

感谢 wjcwinmt 的贡献翻译



---

---
title: "[USACO09OCT] Invasion of the Milkweed G"
layout: "post"
diff: 普及/提高-
pid: P2960
tag: ['2009', 'USACO']
---
# [USACO09OCT] Invasion of the Milkweed G
## 题目描述

Farmer John has always done his best to keep the pastures full of luscious, delicious healthy grass for the cows. He has lost the battle, though, as the evil milkweed has attained a foothold in the northwest part of his farm.

The pasture, as usual, is partitioned into a rectilinear grid of height Y (1 <= Y <= 100) and width X (1 <= X <= 100) with (1,1) being in the lower left corner (i.e., arranged as a normal X,Y coordinate grid). The milkweed has initially begun growing at square (Mx,My). Each week the milkweed propagates to all non-rocky squares that surround any square it already occupies, as many as eight more squares (both the rectilinear squares and the diagonals). After only one week in those squares, it is ready to move on to more squares.

Bessie wants to enjoy all the grass she can before the pastures are taken over by milkweed. She wonders how long it can last. If the milkweed is in square (Mx,My) at time zero, at what time does it complete its invasion of the pasture (which, for the given input data, will always happen)?

The pasture is described by a picture with '.'s for grass and '\*'s for boulders, like this example with X=4 and Y=3:

```
....
..*.
.**.
```

If the milkweed started in the lower left corner (row=1, column=1), then the map would progress like this:

```
    ....  ....  MMM.  MMMM  MMMM
    ..*.  MM*.  MM*.  MM*M  MM*M
    M**.  M**.  M**.  M**.  M**M
week  0    1    2    3    4
```

The milkweed has taken over the entire field after 4 weeks.
## 输入格式

\* Line 1: Four space-separated integers: X, Y, Mx, and My

\* Lines 2..Y+1: Line y+1 describes row (Y+2-y) of the field with X characters ('.' for grass and '\*' for a boulder)

## 输出格式

\* Line 1: A single integer that is the week number when the milkweed takes over the last remaining non-boulder square of the pasture.

## 样例

### 样例输入 #1
```
4 3 1 1 
.... 
..*. 
.**. 

```
### 样例输出 #1
```
4 

```
## 题目翻译

Farmer John 一直努力让他的草地充满鲜美多汁的而又健康的牧草。可惜天不从人愿，他在植物大战人类中败下阵来。邪恶的乳草已经在他的农场的西北部份占领了一片立足之地。

草地像往常一样，被分割成一个高度为 $Y\,(1 \le Y \le 100)$, 宽度为 $X\,(1 \le X \le 100)$ 的直角网格。$(1,1)$ 是左下角的格（也就是说坐标排布跟一般的 $X$，$Y$ 坐标相同）。乳草一开始占领了格 $(M_x,M_y)$。每个星期，乳草传播到已被乳草占领的格子四面八方的每一个没有很多石头的格（包括垂直与水平相邻的和对角在线相邻的格）。1 周之后，这些新占领的格又可以把乳草传播到更多的格里面了。

Bessie 想要在草地被乳草完全占领之前尽可能的享用所有的牧草。她很好奇到底乳草要多久才能占领整个草地。如果乳草在 0 时刻处于格 $(M_x,M_y)$，那么会在哪个时刻它们可以完全占领入侵整片草地呢？对给定的数据总是会发生。


---

---
title: "[USACO10FEB] Chocolate Buying S"
layout: "post"
diff: 普及/提高-
pid: P2983
tag: ['贪心', '2010', 'USACO']
---
# [USACO10FEB] Chocolate Buying S
## 题目描述

Bessie and the herd love chocolate so Farmer John is buying them some.

The Bovine Chocolate Store features $N (1 \le N \le 100,000)$ kinds of chocolate in essentially unlimited quantities.  Each type i of chocolate has price $P_i (1 \le P_i \le 10^{18})$ per piece and there are $C_i (1 \le C_i \le 10^{18})$ cows that want that type of chocolate.

Farmer John has a budget of $B (1 \le B \le 10^{18})$ that he can spend on chocolates for the cows. What is the maximum number of cows that he can satisfy?  All cows only want one type of chocolate, and will be satisfied only by that type.

Consider an example where FJ has $50$ to spend on $5$ different types of chocolate. A total of eleven cows have various chocolate preferences:

|Chocolate\_Type|Per\_Chocolate\_Cost|Cows\_preferring\_this\_type| 
|:-----------:|:-----------:|:-----------:|
|$1$|$5$|$3$|
|$2$|$1$|$1$|
|$3$|$10$|$4$|
|$4$|$7$|$2$|
|$5$|$60$|$1$|

Obviously, FJ can't purchase chocolate type $5$, since he doesn't have enough money. Even if it cost only $50$, it's a counterproductive purchase since only one cow would be satisfied.

Looking at the chocolates start at the less expensive ones, he can purchase $1$ chocolate of type $2$ for $1 \times 1$ leaving $50-1=49$, then purchase $3$ chocolate of type $1$ for $3 \times 5$ leaving $49-15=34$, then  purchase $2$ chocolate of type $4$ for $2 \times 7$ leaving $34-14=20$, then  purchase $2$ chocolate of type $3$ for $2 \times 10$ leaving $20-20=0$.

He would thus satisfy $1 + 3 + 2 + 2 = 8$ cows. 
## 输入格式


Line $1$: Two space separated integers: $N$ and $B$.

Lines $2\ldots N+1$: Line $i$ contains two space separated integers defining chocolate type $i$: $P_i$ and $C_i$.
## 输出格式

Line $1$: A single integer that is the maximum number of cows that Farmer John can satisfy.
## 样例

### 样例输入 #1
```
5 50 
5 3 
1 1 
10 4 
7 2 
60 1 

```
### 样例输出 #1
```
8 

```
## 题目翻译


贝茜和其他奶牛们都喜欢巧克力，所以约翰准备买一些送给她们。奶牛巧克力专卖店里有 $N$ 种巧克力，每种巧克力的数量都是无限多的。

每头奶牛只喜欢一种巧克力，调查显示，有 $C_i$ 头奶牛喜欢第 $i$ 种巧克力，这种巧克力的售价是 $P_i$。

约翰手上有 $B$ 元预算，怎样用这些钱让尽量多的奶牛高兴呢？


---

---
title: "[USACO10FEB] Chocolate Giving S"
layout: "post"
diff: 普及/提高-
pid: P2984
tag: ['贪心', '2010', 'USACO', '最短路']
---
# [USACO10FEB] Chocolate Giving S
## 题目描述

Farmer John is distributing chocolates at the barn for Valentine's day, and B (1 <= B <= 25,000) of his bulls have a special cow in mind to receive a chocolate gift.

Each of the bulls and cows is grazing alone in one of the farm's N (2\*B <= N <= 50,000) pastures conveniently numbered 1..N and connected by M (N-1 <= M <= 100,000) bidirectional cowpaths of various lengths. Some pastures might be directly connected by more than one cowpath. Cowpath i connects pastures R\_i and S\_i (1 <= R\_i <= N; 1 <= S\_i <= N) and has length L\_i (1 <= L\_i <= 2,000).

Bull i resides in pasture P\_i (1 <= P\_i <= N) and wishes to give a chocolate to the cow in pasture Q\_i (1 <= Q\_i <= N).

Help the bulls find the shortest path from their current pasture to the barn (which is located at pasture 1) and then onward to the pasture where their special cow is grazing. The barn connects, one way or another (potentially via other cowpaths and pastures) to every pasture.

As an example, consider a farm with 6 pastures, 6 paths, and 3 bulls (in pastures 2, 3, and 5) who wish to bestow chocolates on their love-objects:

```cpp

                      *1  <-- Bull wants chocolates for pasture 1 cow
             [4]--3--[5]  <-- [5] is the pasture ID
            /  |
           /   |
          4    2          <-- 2 is the cowpath length
         /     |               between [3] and [4]
      [1]--1--[3]*6
     /   \    /
    9     3  2
   /       \/
 [6]      [2]*4
```
\* The Bull in pasture 2 can travel distance 3 (two different ways) to get to the barn then travel distance 2+1 to pastures [3] and [4] to gift his chocolate. That's 6 altogether.

\* The Bull in pasture 5 can travel to pasture 4 (distance 3), then pastures 3 and 1 (total: 3 + 2 + 1 = 6) to bestow his chocolate offer.

\* The Bull in pasture 3 can travel distance 1 to pasture 1 and then take his chocolate 9 more to pasture 6, a total distance of 10.
## 输入格式

\* Line 1: Three space separated integers: N, M, and B

\* Lines 2..M+1: Line i+1 describes cowpath i with three

space-separated integers: R\_i, S\_i, and L\_i

\* Lines M+2..M+B+1: Line M+i+1 contains two space separated integers: P\_i and Q\_i

## 输出格式

\* Lines 1..B: Line i should contain a single integer, the smallest distance that the bull in pasture P\_i must travel to get chocolates from the barn and then award them to the cow of his dreams in pasture Q\_i

## 样例

### 样例输入 #1
```
6 7 3 
1 2 3 
5 4 3 
3 1 1 
6 1 9 
3 4 2 
1 4 4 
3 2 2 
2 4 
5 1 
3 6 

```
### 样例输出 #1
```
6 
6 
10 

```
## 题目翻译

### 题目描述

FJ 有 $B$ 头奶牛 $(1\le B\le 25000)$，有 $N(2\times B\le N\le 50000)$ 个农场，编号 $1$ 到 $N$，有 $M(N-1\le M\le 100000)$ 条双向边，第 $i$ 条边连接农场 $R_i$ 和 $S_i(1\le R_i\le N, 1\le S_i\le N)$，该边的长度是 $L_i(1\le L_i\le 2000)$。居住在农场 $P_i$ 的奶牛 A $(1\le P_i\le N)$，想送一份新年礼物给居住在农场 $Q_i(1\le Q_i\le N)$ 的奶牛 B，但是奶牛 A 必须先到 FJ（居住在编号 $1$ 的农场）那里取礼物，然后再送给奶牛 B。你的任务是：奶牛 A 至少需要走多远的路程？

### 输入格式
* 第一行三个整数 $N,M,B$。
* 第 $2$ 至 $M+1$ 行，每行 $3$ 个整数 $R_i,S_i,L_i$。

* 第 $M+2$ 至 $M+B+1$ 行，进行 $B$ 次询问，每行 $2$ 个整数 $P_i ,Q_i$。

### 输出格式
每次询问输出一个整数，即答案。



---

---
title: "[USACO10FEB] Chocolate Eating S"
layout: "post"
diff: 普及/提高-
pid: P2985
tag: ['贪心', '2010', '二分', 'USACO']
---
# [USACO10FEB] Chocolate Eating S
## 题目描述

Bessie has received N (1 <= N <= 50,000) chocolates from the bulls, but doesn't want to eat them too quickly, so she wants to plan out her chocolate eating schedule for the next D (1 <= D <= 50,000) days in order to maximize her minimum happiness level over the set of those days.

Bessie's happiness level is an integer that starts at 0 and halves (rounding down if necessary) over night as she sleeps. However, when she eats chocolate i, her happiness level increases by integer H\_i (1 <= H\_i <= 1,000,000). If she eats chocolates on a day, her happiness for that day is considered the happiness level after she eats the chocolates. Bessie insists that she eat the chocolates in the order that she received them.

If more than one optimal solution exists, print any one of them.

Consider a sequence of 5 chocolates to be eaten over a period of 5 days; they respectively bring happiness (10, 40, 13, 22, 7).

If Bessie eats the first chocolate (10 happiness) on the first day and then waits to eat the others, her happiness level is 10 after the first day.

Here is the complete schedule which turns out to maximize her minimum happiness:

Day  Wakeup happiness   Happiness from eating   Bedtime happiness 1            0                10+40                  50

2           25                 ---                   25

3           12                  13                   25

4           12                  22                   34

5           17                   7                   24

The minimum bedtime happiness is 24, which turns out to be the best Bessie can do.

Bessie 拿到了 $N$（$1 \leq N \leq 5\times 10 ^ 4$）块巧克力。她决定想个办法吃掉这些巧克力，使得它在吃巧克力的这段时间里，最不开心的一天尽可能的开心。并且一共吃 $D$（$1 \leq D \leq 5\times 10 ^ 4$）天。

每块巧克力有一个开心值 $H_i$（$1 \leq H_i \leq 10 ^ 6$），当某天你吃下那块巧克力时，你将获得那块巧克力的开心值。每一天的开心值是所有当天吃掉的巧克力的总开心值之和。每天晚上 Bessie 睡觉之后，它的开心值会减半。也就是说，比如昨天 Bessie 的开心值为 $50$，那么今天早上一醒来就会有 $25$ 点的开心值，舍去小数点后数字。另外，Bessie 还有一个怪癖，她喜欢按照巧克力本来的排列顺序吃。

Bessie 第一天的开心值为 $0$，求一个每天吃巧克力的方案，使得 Bessie 最不开心的一天尽可能的开心。

## 输入格式

\* Line 1: Two space separated integers: N and D

\* Lines 2..N+1: Line i+1 contains a single integer: H\_i

第一行：两个整数 $N$ 和 $D$，中间用空格分隔。

第 $2$ 行至第 $N + 1$ 行：每行一个整数，第 $i + 1$ 行表示 $H_i$ 的值。
## 输出格式

\* Line 1: A single integer, the highest Bessie's minimum happiness can be over the next D days

\* Lines 2..N+1: Line i+1 contains an integer that is the day on which Bessie eats chocolate i


第一行：一个整数，表示 Bessie 在 $D$ 天中最不开心的一天最大可能的开心值。

第 $2$ 至第 $n + 1$ 行，每行一个整数，第 $i + 1$ 行表示 Bessie 吃第 $i$ 块巧克力的日期。
## 样例

### 样例输入 #1
```
5 5 
10 
40 
13 
22 
7 

```
### 样例输出 #1
```
24 
1 
1 
3 
4 
5 

```


---

---
title: "[USACO10NOV] Visiting Cows G"
layout: "post"
diff: 普及/提高-
pid: P2996
tag: ['2010', 'USACO']
---
# [USACO10NOV] Visiting Cows G
## 题目描述

After many weeks of hard work, Bessie is finally getting a vacation! After many weeks of hard work, Bessie is finally getting a vacation!  numbered 1..N. The cows have set up quite an unusual road network with exactly N-1 roads connecting pairs of cows C1 and C2 (1 <= C1 <= N; 1 <= C2 <= N; C1 != C2) in such a way that there exists a unique path of roads between any two cows.

FJ wants Bessie to come back to the farm soon; thus, he has instructed Bessie that if two cows are directly connected by a road, she may not visit them both. Of course, Bessie would like her vacation to be as long as possible, so she would like to determine the maximum number of cows she can visit.

经过了几周的辛苦工作,贝茜终于迎来了一个假期.作为奶牛群中最会社交的牛,她希望去拜访N(1<=N<=50000)个朋友.这些朋友被标号为1..N.这些奶牛有一个不同寻常的交通系统,里面有N-1条路,每条路连接了一对编号为C1和C2的奶牛(1 <= C1 <= N; 1 <= C2 <= N; C1<>C2).这样,在每一对奶牛之间都有一条唯一的通路. FJ希望贝茜尽快的回到农场.于是,他就指示贝茜,如果对于一条路直接相连的两个奶牛,贝茜只能拜访其中的一个.当然,贝茜希望她的假期越长越好,所以她想知道她可以拜访的奶牛的最大数目.

## 输入格式

\* Line 1: A single integer: N

\* Lines 2..N: Each line describes a single road with two

space-separated integers: C1 and C2

## 输出格式

\* Line 1: A single integer representing the maximum number of cows that Bessie can visit.

## 样例

### 样例输入 #1
```
7 
6 2 
3 4 
2 3 
1 2 
7 6 
5 6 

```
### 样例输出 #1
```
4 

```
## 提示

Bessie knows 7 cows. Cows 6 and 2 are directly connected by a road, as are cows 3 and 4, cows 2 and 3, etc. The illustration below depicts the roads that connect the cows:

1--2--3--4

|
5--6--7


Bessie can visit four cows. The best combinations include two cows on the top row and two on the bottom. She can't visit cow 6 since that would preclude visiting cows 5 and 7; thus she visits 5 and 7. She can also visit two cows on the top row: {1,3}, {1,4}, or {2,4}.



---

---
title: "[USACO10NOV] Banner S"
layout: "post"
diff: 普及/提高-
pid: P2997
tag: ['2010', 'USACO']
---
# [USACO10NOV] Banner S
## 题目背景

题目大意(by:曹彦臣)：


平面上有(0,0)到(n,m)的(n+1)\*(m+1)个点。问有多少点对所连的线段不过其他点，且长度在[l,h]范围内。

## 题目描述

Bessie is returning from a long trip abroad, and Farmer John wants to erect a nice 'Welcome Home' banner in her pasture for her arrival. The banner will hang between two poles on a wire whose length is in the range L1..L2 (1 <= L1 <= L2; L1 <= L2 <= 1,500).

The pasture's size is W x H (1 <= W <= 1,000; 1 <= H <= 1,000), and Farmer John has installed a post at every point with integer

coordinates. Of these (W + 1) \* (H + 1) points, Farmer John must pick just two that will hold either end of the wire from which he will hang the banner.

FJ wants no interference with his banner as it hangs and requires that no post be directly under the tight wire he stretches between the two chosen posts.

Farmer John needs your help to figure out how many possible ways he can hang the banner. He knows the number is large and that a 32-bit integer might not be sufficient to compute the answer.

Consider the example pasture below, with W = 2 and H = 1: 

\* \* \*
\* \* \*
The banner size is in the range 2..3. This pasture contains (2+1) \* (1+1) = 6 points and has (6 take 2) = (6\*5)/(2\*1) = 15 different potential pairs of points between which the banner-holding wire might stretch:

```cpp
(0,0)-(0,1)   (0,0)-(2,1)   (0,1)-(2,1)   (1,1)-(2,0) 
(0,0)-(1,0)   (0,1)-(1,0)   (1,0)-(1,1)   (1,1)-(2,1) 
(0,0)-(1,1)   (0,1)-(1,1)   (1,0)-(2,0)   (2,0)-(2,1) 
(0,0)-(2,0)   (0,1)-(2,0)   (1,0)-(2,1) 
```
Of these pairs, only four have a length in the range 2..3:
Len                       Len

(0,0)-(2,0) 2.00          (0,1)-(2,0) 2.24 

(0,0)-(2,1) 2.24          (0,1)-(2,1) 2.00 

Of these four, the pairs (0,0)-(2,0) and (0,1)-(2,1) both have a post directly on the line between the endpoints, and thus are 

unsuitable.

So, just two pairs of points out of 15 are acceptable candidates for hanging the banner wire.

## 输入格式

\* Line 1: Four space-separated integers: W, H, L1, and L2

## 输出格式

\* Line 1: A single integer denoting the number of possible banners

## 样例

### 样例输入 #1
```
2 1 2 3 

```
### 样例输出 #1
```
2 

```
## 题目翻译

贝西正要从一趟长途旅行中回来，Farmer John想要在她的牧场里布置一个“欢迎回家”的横幅来迎接她。这个横幅将会拴在一个范围为L1到L2 (1 <= L1 <= L2; L1 <= L2 <= 1,500)的线的两端

牧场面积为W × H (1 <= W <= 1000;1 <= H <= 1000)，并且Farmer John在每个整数坐标的点都安装了一个杆子。在这(W + 1) * (H + 1)点中，Farmer John必须选择两个点来固定他将悬挂旗帜的线的两端。

FJ希望他的旗帜挂上去之后不会被挡住，所以在两个柱子之间的线上不能有其他柱子。

Farmer John需要你的帮助来计算出他有多少种可能的方式来悬挂横幅。他知道这个数字很大，一个32位的整数可能不足以计算出答案。

示例，W = 2, H = 1: 横幅大小在2到3的范围内。这个牧场包含(2+1)(1+1)= 6个点，并且有(6选2)=(65)/(2*1)= 15个不同的潜在点对，在这些点之间可以拉出这几条线:


(0,0)-(0,1)   (0,0)-(2,1)   (0,1)-(2,1)   (1,1)-(2,0) 
(0,0)-(1,0)   (0,1)-(1,0)   (1,0)-(1,1)   (1,1)-(2,1) 
(0,0)-(1,1)   (0,1)-(1,1)   (1,0)-(2,0)   (2,0)-(2,1) 
(0,0)-(2,0)   (0,1)-(2,0)   (1,0)-(2,1)
在这些对中，只有四个的长度在2..3的范围内:

(0,0)-(2,0) 2.00

(0,1)-(2,0) 2.24

(0,0)-(2,1) 2.24

(0,1)-(2,1) 2.00

在这四个中，(0,0)-(2,0)和(0,1)-(2,1)在端点之间的直线上都有一个柱子，因此是不合适的。

所以，15对点中只有两对点可以作为悬挂横幅线的候选点。


---

---
title: "[USACO10DEC] Apple Delivery S"
layout: "post"
diff: 普及/提高-
pid: P3003
tag: ['2010', 'USACO', '最短路']
---
# [USACO10DEC] Apple Delivery S
## 题目描述

Bessie has two crisp red apples to deliver to two of her friends in the herd. Of course, she travels the C (1 <= C <= 200,000)

cowpaths which are arranged as the usual graph which connects P (1 <= P <= 100,000) pastures conveniently numbered from 1..P: no cowpath leads from a pasture to itself, cowpaths are bidirectional, each cowpath has an associated distance, and, best of all, it is always possible to get from any pasture to any other pasture. Each cowpath connects two differing pastures P1\_i (1 <= P1\_i <= P) and P2\_i (1 <= P2\_i <= P) with a distance between them of D\_i. The sum of all the distances D\_i does not exceed 2,000,000,000.

What is the minimum total distance Bessie must travel to deliver both apples by starting at pasture PB (1 <= PB <= P) and visiting pastures PA1 (1 <= PA1 <= P) and PA2 (1 <= PA2 <= P) in any order. All three of these pastures are distinct, of course.

Consider this map of bracketed pasture numbers and cowpaths with distances:

```cpp
               3        2       2
           [1]-----[2]------[3]-----[4]
             \     / \              /
             7\   /4  \3           /2
               \ /     \          /
               [5]-----[6]------[7]
                    1       2
```
If Bessie starts at pasture [5] and delivers apples to pastures [1] and [4], her best path is:

5 -> 6-> 7 -> 4\* -> 3 -> 2 -> 1\*

with a total distance of 12.
## 输入格式

\* Line 1: Line 1 contains five space-separated integers: C, P, PB, PA1, and PA2

\* Lines 2..C+1: Line i+1 describes cowpath i by naming two pastures it connects and the distance between them: P1\_i, P2\_i, D\_i

## 输出格式

\* Line 1: The shortest distance Bessie must travel to deliver both apples

## 样例

### 样例输入 #1
```
9 7 5 1 4 
5 1 7 
6 7 2 
4 7 2 
5 6 1 
5 2 4 
4 3 2 
1 2 3 
3 2 2 
2 6 3 

```
### 样例输出 #1
```
12 

```
## 题目翻译

贝西有两个又香又脆的红苹果要送给她的两个朋友。当然她可以走的 $C(1 \le C \le 200000)$ 条“牛路”都被包含在一种常用的图中。这张图同时包含了$P(1 \le P \le 100000)$ 个牧场，分别被标为 $1 \cdots P$。没有“牛路”会从一个牧场又走回它自己。“牛路”是双向的，每条牛路都会被标上一个距离。最重要的是，每个牧场都可以通向另一个牧场。每条牛路都连接着两个不同的牧场 $P1\_i$和$P2\_i$（$1 \le P1\_i,P2\_i \le P$)，距离为$D\_i$。所有“牛路”的距离之和不大于 $2000000000$。

现在，贝西要从牧场 $PB$ 开始给 $PA\_1$ 和 $PA\_2$ 牧场各送一个苹果（$PA\_1$ 和 $PA\_2$ 顺序可以调换），那么最短的距离是多少呢？当然，$PB$、$PA\_1$ 和 $PA\_2$ 各不相同。



---

---
title: "[USACO11FEB] Best Parenthesis S"
layout: "post"
diff: 普及/提高-
pid: P3015
tag: ['模拟', '字符串', '2011', 'USACO', '栈']
---
# [USACO11FEB] Best Parenthesis S
## 题目描述

Recently, the cows have been competing with strings of balanced parentheses and comparing them with each other to see who has the best one.

Such strings are scored as follows (all strings are balanced): the string '()' has score 1; if 'A' has score s(A) then '(A)' has score 2\*s(A); and if 'A' and 'B' have scores s(A) and s(B), respectively, then 'AB' has score s(A)+s(B). For example, s('(())()') = s('(())')+s('()') = 2\*s('()')+1 = 2\*1+1 = 3.

Bessie wants to beat all of her fellow cows, so she needs to calculate the score of some strings. Given a string of balanced parentheses of length N (2 <= N <= 100,000), help Bessie compute its score.

给定一个只包含左右括号的字符串，得分规则如下：

如果一对括号内没有括号，那么这对括号的得分为1；如果两对括号互不包含（即并列存在），那这两对括号的得分相加；如果括号内包含一对括号，那么这个括号的得分纪为内部括号序列的得分\*2。

例如：对于这样一个字符串："() ()"，两对括号并列存在，则得分为1+1=2;

而对于这样一个字符串："(())"，最外层的括号内层包含一对括号，则得分为2\*1=2.


Bessie想击败所有同事的牛，所以她需要计算某个字符串的评分。给定一个长度为n、只包含括号的字符串（2≤N≤100000），计算其得分帮助Bessie。

## 输入格式

\* Line 1: A single integer: N

\* Lines 2..N + 1: Line i+1 will contain 1 integer: 0 if the ith character of the string is '(',  and 1 if the ith character of the string is ')'

## 输出格式

\* Line 1: The score of the string. Since this number can get quite large, output the  score modulo 12345678910.

## 样例

### 样例输入 #1
```
6 
0 
0 
1 
1 
0 
1 

```
### 样例输出 #1
```
3 

```
## 提示

This corresponds to the string "(())()". 

As discussed above.

输出答案要mod12345678910



---

---
title: "[USACO11FEB] The Triangle S"
layout: "post"
diff: 普及/提高-
pid: P3016
tag: ['2011', 'USACO']
---
# [USACO11FEB] The Triangle S
## 题目描述

For her spectacular milk output for the previous month, Farmer John has awarded Bessie a prize -- with a twist.  He has given her a triangular grid with N (1 <= N <= 700) rows (whose lengths vary from 1 through N, of course). Row i of the the grid has i values labeled v\_ij (-1,000,000,000 <= v\_ij <= 1,000,000,000) where j is in the range 1..i.

Bessie chooses a sub-triangle whose side length is at least K (1 <= K <= 20; 1 <= K <= N) within the triangular grid. The sub-triangle is another triangular grid which might be oriented the same as the original triangle or might be 'upside down' with its shorter rows on the bottom instead of the top.

After she chooses her sub-triangle, Farmer John will take the average of all the numbers in the sub-triangle, discarding the digits to the right of the decimal point, and give her that many gold coins (or take that many gold coins from her if the number is negative). Naturally, Bessie would like to maximize her prize (or minimize her loss). Help her solve this problem.

By way of example, Bessie is given this triangular grid with N = 3 rows and must choose a sub-triangle with a side length of at least K = 2. A graphical representation of the triangle is shown below:

```cpp
    / \
   / 5 \
  /-8  4\
 /2 -3  6\
 ---------
```
She could choose any of five valid sub-triangles (one of which is the entire original triangle):

```cpp
                                                   /\
    / \         / \        / \         / \        /5 \       
   / 5 \       / \5\      / 5 \       / 5/\      /----\    
  /-8  4\     /-8 \4\    /-8  4\     /-8/ 4\    /\-8 4/\ 
 /2 -3  6\   / 2 -3\6\  /-------\   / 2/-3 6\  / 2\-3/6 \ 
 ---------   ---------  -2  -3  6   ---------  ----------  
  entire      lower        top          lower     upside
 triangle     left                      right      down
```
The one that is lined below is the one with the highest average:

```cpp
    / \
   / 5/\
  /-8/ 4\
 / 2/-3 6\
 ---------
```
The average of this sub-triangle is (4+6-3)/3, which is about

2.3333...; without the fraction, the answer is 2. 

Help Bessie calculate the maximum amount of coins which she could receive.

TIME LIMIT: 2 seconds

MEMORY LIMIT: 32 MB

有一个n(1<=n<=700)行的等腰三角形，里面有很多数(-1,000,000,000 <= 数 <= 1,000,000,000)，现在可以选择边长至少为k(1<=k<=20,1<=k<=n)，至多为2k的相似等腰三角形，并且可以倒着选，比如样例可以有这些选择方法：


样例：

```cpp
                                                   /\
    / \         / \        / \         / \        /5 \       
   / 5 \       / \5\      / 5 \       / 5/\      /----\    
  /-8  4\     /-8 \4\    /-8  4\     /-8/ 4\    /\-8 4/\ 
 /2 -3  6\   / 2 -3\6\  /-------\   / 2/-3 6\  / 2\-3/6 \ 
 ---------   ---------  -2  -3  6   ---------  ----------  
  entire      lower        top          lower     upside
 triangle     left                      right      down
```
最后问你可以得到的最大平均值为多少（平均值：选出的三角形的累加和div选出个数）

## 输入格式

\* Line 1: Two space-separated integers: N and K

\* Lines 2..N+1: Line i+1 will contain i space-separated integers: v\_ij

## 输出格式

\* Line 1: The maximum number of coins that Bessie can receive (or, if negative, the best she can do for her loss).

## 样例

### 样例输入 #1
```
3 2 
5 
-8 4 
2 -3 6 

```
### 样例输出 #1
```
2 

```
## 提示

感谢 zzkksunboy 提供翻译。



---

---
title: "[USACO11MAR] Meeting Place S"
layout: "post"
diff: 普及/提高-
pid: P3019
tag: ['2011', 'USACO']
---
# [USACO11MAR] Meeting Place S
## 题目描述

Bessie and Jonell are great friends. Since Farmer John scrambles where the cows graze every day, they are sometimes quite far from each other and can't talk.

The pastures and paths on FJ's farm form a 'tree' structure.  Each pasture has exactly one distinct path to any other pasture, and each pasture (except pasture #1, the 'root') also has a single parent node.

Bessie and Jonell have decided that they will always meet at the closest pasture that that is both an ancestor of Jonell's pasture and of Bessie's pasture.

FJ created a map of his N (1 <= N <= 1,000) pastures (conveniently numbered 1..N) that tells the parent P\_i (1 <= P\_i <= N) of each pasture except pasture 1, which has no parent.

FJ has released his daily grazing schedule for the next M (1 <= M <= 1,000) days, so Bessie and Jonell are deciding where they should meet each day for gossip. On day k, Bessie is in pasture B\_k (1 <= B\_k <= N) and Jonell is in pasture J\_k (1 <= J\_k <= N).

Given a map and schedule, help Bessie and Jonell find their meeting places.

```cpp
Consider, for example, the following farm layout:

                            Pasture      Parent Pasture
             [1]           ---------    ----------------
            / | \              1              ---
           /  |  \             2               1 
         [2] [3] [6]           3               1
         /        | \          4               2
        /         |  \         5               8
      [4]        [8]  [9]      6               1
                /   \          7               8
               /     \         8               6
             [5]     [7]       9               6

Here are the meeting places that Bessie and Jonell would choose
given a six day schedule of their initial grazing locations:

              Bessie      Jonell       Meeting Place
             --------    --------     ---------------
                 2           7               1
                 4           2               2
                 1           1               1
                 4           1               1
                 7           5               8
                 9           5               6
```



## 输入格式

\* Line 1: Two space-separated integers: N and M

\* Lines 2..N: Line i contains a single integer that describes the parent of pasture i:  P\_i

\* Lines N+1..N+M: Line k+N describes Bessie and Jonell's respective pastures with two space-separated integers: B\_k and J\_k



## 输出格式

\* Lines 1..M: Line j contains the meeting place Bessie and Jonell would use for line j+N of the input

## 样例

### 样例输入 #1
```
9 6 
1 
1 
2 
8 
1 
8 
6 
6 
2 7 
4 2 
3 3 
4 1 
7 5 
9 5 

```
### 样例输出 #1
```
1 
2 
3 
1 
8 
6 

```
## 题目翻译

农场是由N（1≤N≤1000）个节点组成的一棵树，1是树的根。有两头奶牛分别在两个节点，他们有M（1≤M≤1000）天要见面，见面地点在她们所在两个节点的路径上离根节点最近的节点。求出每天她们见面的节点编号。
输入：第一行两个整数N, M，接下来N-1行（这里的 i 是从 2 ~ n），第i行表示第i个节点的父亲编号，接下来M行每行两个整数表示当天两头奶牛所在的节点编号。
输出：输出M行，回答每个询问。

感谢@x咫尺天涯x 提供的翻译和ROY1994 提供的建议


---

---
title: "[USACO11MAR] Package Delivery S"
layout: "post"
diff: 普及/提高-
pid: P3020
tag: ['2011', 'USACO', '最短路']
---
# [USACO11MAR] Package Delivery S
## 题目描述

Farmer John must deliver a package to Farmer Dan, and is preparing to make his journey. To keep the peace, he gives a tasty treat to every cow that he meets along his way and, of course, FJ is so frugal that he would like to encounter as few cows as possible.

农夫约翰必须送一个包裹给农夫丹，并准备去旅行。为了保持和平，他必须给每一头遇到的奶牛一些吃的，当然，FJ很节俭，他想可能遇到尽可能少的奶牛。

FJ has plotted a map of N (1 <= N <= 50,000) barns, connected by M (1 <= M <= 50,000) bi-directional cow paths, each with C\_i (0 <= C\_i <= 1,000) cows ambling along it. A cow path connects two distinct barns, A\_i and B\_i (1 <= A\_i <= N; 1 <= B\_i <= N; A\_i != B\_i). Two barns may be directly connected by more than one path. He is currently located at barn 1, and Farmer Dan is located at barn N.

FJ 已经绘制了 $N(1 \le N \le 50000)$ 个谷仓的地图，通过 $M(1 \le M \le 50000)$ 条双向牛道，每条双向牛道上有 $c[i](0 \le c[i] \le 1000)$ 奶牛漫步。双向牛道连接两个不同的谷仓，$a[i]$ 和 $b[i](1 \le a[i] \le N,1 \le b[i] \le N, a[i] \neq b[i])$。两个谷仓可以由一条以上的小路直接连接。他目前在 $1$ 号谷仓，农夫丹位于 $N$ 号谷仓。

Consider the following map:

```cpp
           [2]---
          / |    \
         /1 |     \ 6
        /   |      \
     [1]   0|    --[3]
        \   |   /     \2
        4\  |  /4      [6]
          \ | /       /1
           [4]-----[5] 
                3  
```
The best path for Farmer John to take is to go from 1 -> 2 -> 4 -> 5 -> 6, because it will cost him 1 + 0 + 3 + 1 = 5 treats.

Given FJ's map, what is the minimal number of treats that he should bring with him, given that he will feed each distinct cow he meets exactly one treat? He does not care about the length of his journey.

## 输入格式

\* Line 1: Two space-separated integers: N and M

\* Lines 2..M+1: Three space-separated integers: A\_i, B\_i, and C\_i

## 输出格式

\* Line 1: The minimum number of treats that FJ must bring

## 样例

### 样例输入 #1
```
6 8 
4 5 3 
2 4 0 
4 1 4 
2 1 1 
5 6 1 
3 6 2 
3 2 6 
3 4 4 

```
### 样例输出 #1
```
5 

```


---

---
title: "[USACO11MAR] Bovine Bridge Battle S"
layout: "post"
diff: 普及/提高-
pid: P3021
tag: ['2011', 'USACO']
---
# [USACO11MAR] Bovine Bridge Battle S
## 题目背景

给定N（4 <= N <= 1,000）个整点的坐标 (-1,000,000,000 <= X\_i <= 1,000,000,000; -1,000,000,000 <= Y\_i <= 1,000,000,000，X\_i，Y\_i∈Z)，求card{{(X\_a,Y\_a),(X\_b,Y\_b),(X\_c,Y\_c),(X\_d,Y\_d)}|四点呈中心对称}

## 题目描述

Each of Farmer John's N (4 <= N <= 1,000) cows is patiently waiting in the main pasture with cow i at point with integer coordinates (X\_i, Y\_i) (-1,000,000,000 <= X\_i <= 1,000,000,000; -1,000,000,000 <= Y\_i <= 1,000,000,000).

The cows wish to form into groups of four in order to play Bridge, their new favorite card game. Each group must satisfy an important constraint: four cows are allowed to team up if and only if there exists some point X somewhere in the plane (and not coincident with any of the four points of the potential group of four) such that rotating any of the group's cows 180 degrees about that point X gives the position of some other cow in the group.

Please help the cows determine the number of sets of four cows that can form a Bridge group.

By way of example, suppose eight cows are standing at eight points:

|
f\*
```cpp
|             a = (-3, 1)    e = (-1, 1) 
b*     |             b = (-2, 2)    f = ( 0, 3) 
a      e  |             c = (-3, 0)    g = ( 2, 0) 
*     *  |             d = (-2, 0)    h = ( 3, 0) 
```
c  d     |     g  h
---------\*--\*-----+-----\*--\*---------

|
Then the three legal sets of four cows are {a, b, e, d} (they rotate around point (-2, 1)), {b, c, e, f} (around the point (-1.5, 1.5)), and {c, d, g, h} (around (0,0)).

The supplied locations of the cows given are all distinct, although they are supplied in no particular order. Furthermore, the answer will fit into a signed 32-bit integer.

## 输入格式

\* Line 1: A single integer: N

\* Lines 2..N+1: Line i+1 contains two space-separated integers: X\_i and Y\_i

## 输出格式

\* Line 1: A single integer that is the number of sets of 4 cows that form valid groups for bridge.

## 样例

### 样例输入 #1
```
8 
-3 0 
-2 0 
-1 1 
0 3 
2 0 
-3 1 
3 0 
-2 2 

```
### 样例输出 #1
```
3 

```
## 题目翻译

农场主约翰有 $N$ 头牛，牛 $i$ 位于整数坐标点 $(X_i,Y_i)$。

奶牛们希望每四头牛分成一组，玩他们最喜欢的纸牌游戏“桥牌”。

每组必须满足一个重要的约束条件：

当且仅当平面中存在点 $X$ 时（一组的四个点允许重合，并且 $X$ 不与可能的组中的四个点中的任何一个相重合），使得组中的四个点呈中心对称。

请帮助奶牛确定可以组成一个桥群的四头奶牛的数量。

举个例子，假设八头牛站在八个点上：

$a=(-3,1),b=(-2,2),c=(-3,0),d=(-2,0),e=(-1,1),f=(0,3),g=(2,0),h=(3,0)$

四头牛的三个合法集合是：

{$a,b,e,d$}，关于 $ (-2，1)$ 对称，

{$b,c,e,f$}，关于 $(-1.5，1.5)$ 对称，

{$c,d,g,h$}，关于 $(0,0)$ 对称。

$4\le N\le 10^3$，$-10^8\le X_i,Y_i\le 10^8$，$X_i,Y_i\in Z$。


---

---
title: "[USACO10OCT] Making Money G"
layout: "post"
diff: 普及/提高-
pid: P3027
tag: ['2010', 'USACO']
---
# [USACO10OCT] Making Money G
## 题目背景

FJ又经营起了古董生意，买卖一些像奶牛圣诞树上的装饰之类的小玩意。他知道他会将他能存储的N(1<=N<=100)件不同的奶牛古董每件都卖出。


而且如果他的钱足够多他可以买他想要的任意数量的古董（即他可以购买的古董数量没有限制）。他只有M(1<=M<=100,000)元钱来买古董，但他想要在他经商的第一年年末最大化他的利润（这有点难以解释）。


第i种古董采购需要花费Ci(1<=Ci<=100,000)元钱，每卖掉一件可以获得Ri(1<=Ri<=100,000)元钱(每卖一件的利润为Ri-Ci)。FJ可以以任意顺序卖出他的货物。他并不需要花光他所有的钱来购买古董。


FJ在他经商的第一年年末能得到的最大总利润（利润=初始钱数-总花费+总收入）是多少呢？输入数据保证这个数字不会超过1,000,000,000.


假设FJ只有3种古董而且开始时有M=17元钱。下面是三种古董的花费和收入。


古董 花费 收入


1 2 4

2 5 6

3 3 7

在这种情况下，FJ应该花15元购买5个3号古董，再花2元购买1个1号古董，总共17元。他的利润是5\*(7-3)+1\*(4-2)=5\*4+1\*2=22元。他不能获得比这更多的利润了。


提示：第二个样例很有挑战性，但我们的答案是正确的。


输入格式：


第1行：两个以空格分开的整数：N和M


第2行到第N+1行：第i+1行包括两个以空格分开的整数：Ci和Ri


输出格式


第1行：FJ能获得的最大利润

## 题目描述

FJ has gone into the curio business, buying and selling knickknacks like cow Christmas tree ornaments. He knows he will sell every single curio he can stock from a catalog of N (1 <= N <= 100)

different cow curios, and he can buy as many of each kind of curio as his heart desires. He has only M (1 <= M <= 100,000) money to invest but wants to maximize his profit (which has a slightly unusual definition) at the end of his first year in business.

Curio type i costs C\_i (1 <= C\_i <= 100,000) money to purchase and yields R\_i (1 <= R\_i <= 100,000) revenue for each curio sold (a profit of R\_i-C\_i). FJ can mix and match the curios he sells in any way he wishes. He need not spend all his money when purchasing curios.

What is the greatest amount of total profit (profit = initial\_cash - all\_costs + all\_sales) FJ can have at the end of his first year? This number is guaranteed to be less than 1,000,000,000.

Consider the situation when FJ has just 3 kinds of curios and starts with M=17. Below are the cost and revenue numbers for each curio:

Curio     Cost     Revenue

#        C\_i       R\_i

1         2         4

2         5         6

3         3         7

In this case, FJ should purchase 5 curios of type 3 for 15 money and 1 more curio of type 1 for 2 money, a total of 17 money. His profit will be 5 \* (7-3) + 1 \* (4-2) = 5\*4 + 1\*2 = 22 money. He can do no better than this given the cost and revenue structure.

NOTE: The second test case is challenging -- but our answer is correct.

## 输入格式

\* Line 1: Two space-separated integers: N and M

\* Lines 2..N+1: Line i+1 contains two space-separated integers: C\_i and R\_i

## 输出格式

\* Line 1: The maximum profit FJ can generate given the costs and revenues

## 样例

### 样例输入 #1
```
3 17 
2 4 
5 6 
3 7 

```
### 样例输出 #1
```
22 

```


---

---
title: "[USACO11NOV] Cow Lineup S"
layout: "post"
diff: 普及/提高-
pid: P3029
tag: ['2011', 'USACO', '单调队列', '离散化', '队列', '双指针 two-pointer']
---
# [USACO11NOV] Cow Lineup S
## 题目描述

Farmer John has hired a professional photographer to take a picture of some of his cows.  Since FJ's cows represent a variety of different breeds, he would like the photo to contain at least one cow from each distinct breed present in his herd.

FJ's N cows are all standing at various positions along a line, each described by an integer position (i.e., its x coordinate) as well as an integer breed ID.  FJ plans to take a photograph of a contiguous range of cows along the line.  The cost of this photograph is equal its size -- that is, the difference between the maximum and minimum x coordinates of the cows in the range of the photograph.

Please help FJ by computing the minimum cost of a photograph in which there is at least one cow of each distinct breed appearing in FJ's herd.

## 输入格式

\* Line 1: The number of cows, N (1 <= N <= 50,000). 

\* Lines 2..1+N: Each line contains two space-separated positive integers specifying the x coordinate and breed ID of a single cow.  Both numbers are at most 1 billion.

## 输出格式

\* Line 1: The smallest cost of a photograph containing each distinct breed ID.

## 样例

### 样例输入 #1
```
6 
25 7 
26 1 
15 1 
22 3 
20 1 
30 1 

```
### 样例输出 #1
```
4 

```
## 提示

There are 6 cows, at positions 25,26,15,22,20,30, with respective breed IDs 7,1,1,3,1,1.


The range from x=22 up through x=26 (of total size 4) contains each of the distinct breed IDs 1, 3, and 7 represented in FJ's herd.

## 题目翻译

### 问题描述

农民约翰雇一个专业摄影师给他的部分牛拍照。由于约翰的牛有好多品种，他喜欢他的照片包含每个品种的至少一头牛。

约翰的牛都站在一条沿线的不同地方， 每一头牛由一个整数位置 $X_i$ 以及整数品种编号 $ID_i$ 表示。

约翰想拍一张照片，这照片由沿线的奶牛的连续范围组成。照片的成本与规模相当，这就意味着，在一系列照片中的最大和最小 $X$ 坐标的差距决定了照片的成本。

请帮助约翰计算最小的照片成本，这些照片中有每个不同的品种的至少一头牛，没有两头牛愿意站在同一个地点的。


### 输入格式 


第 $1$ 行：牛的数量 $N$；


第 $2..1+N$ 行：每行包含 2 个以空格分隔的正整数 $X_i$ 和 $ID_i$；意义如题目描述；


### 输出格式 


输出共一行，包含每个不同品种 $\rm ID$ 的照片的最低成本。


---

---
title: "[USACO11NOV] Tile Exchanging S"
layout: "post"
diff: 普及/提高-
pid: P3030
tag: ['2011', 'USACO']
---
# [USACO11NOV] Tile Exchanging S
## 题目描述

Farmer John wants to remodel the floor of his barn using a collection of square tiles he recently purchased from the local square mart store (which of course, only sells square objects).  Unfortunately, he didn't measure the size of the barn properly before making his purchase, so now he needs to exchange some of his tiles for new square tiles of different sizes.

The N square tiles previously purchased by FJ have side lengths A\_1...A\_N. He would like to exchange some of these with new square tiles so that the total sum of the areas of the his tiles is exactly M.  Square mart is currently offering a special deal: a tile of side length A\_i can be exchanged for a new tile of side length B\_i for a cost of

|A\_i-B\_i|\*|A\_i-B\_i| units. However, this deal only applies to 
previously-purchased tiles -- FJ is not allowed to exchange a tile that he has already obtained via exchanging some other tile (i.e., a size-3 tile cannot be exchanged for a size-2 tile, which is then exchanged for a size-1 tile).

Please determine the minimum amount of money required to exchange tiles so that the sum of the areas of the tiles becomes M.  Output -1 if it is impossible to obtain an area of M.


## 输入格式

\* Line 1: Two space-separated integers, N (1<=N<=10) and M 

(1<=M<=10,000). 

\* Lines 2..1+N: Each line contains one of the integers A\_1 through A\_N, describing the side length of an input square

(1<=A\_i<=100). 


## 输出格式

\* Line 1: The minimum cost of exchanging tiles to obtain M units of total area, or -1 if this is impossible.

## 样例

### 样例输入 #1
```
3 6 
3 
3 
1 

```
### 样例输出 #1
```
5 

```
## 提示

There are 3 tiles.  Two are squares of side length 3, and one is a square with side length 1.  We would like to exchange these to make a total area of 6.


Exchange one of the side-3 squares for a side-2 square, and another side-3 square for a side-1 square.  This gives the desired area of 4+1+1=6 and costs 4+1=5 units.

感谢 wjcwinmt 提供翻译

## 题目翻译

有 $N$ 个正方形，依次给出它们的边长，要求可以换掉一些正方形：如果边长为 $A_i$ 的正方形换成边长为 $B_i$ 的正方形所需代价为：$|A_i-B_i| \times |A_i-B_i|$。问至少花费多少代价使得这 $N$ 个正方形面积总和为 $M$？若无论如何也不可能使这 $N$ 个正方形面积总和为 $M$ 则输出 $-1$。


---

---
title: "[USACO12JAN] Bale Share S"
layout: "post"
diff: 普及/提高-
pid: P3040
tag: ['2012', 'USACO']
---
# [USACO12JAN] Bale Share S
## 题目描述

FJ 有 $n$ 包干草，第 $i$ 干草的重量是 $s_i$，他想尽可能平均地将干草分给三个农场。

他希望分配后的干草重量最大值尽可能地小，比如，$b_1,b_2,b_3$ 是分配后的三个值，假设 $b_1 \ge b_2 \ge b_3$，则他希望 $b_1$ 的值尽可能地小。

请计算 $b_1$ 的最小值。

## 输入格式

第一行一个正整数 $n$。  
接下来 $n$ 行，每行一个正整数表示重量。
## 输出格式

输出一行一个整数表示答案。
## 样例

### 样例输入 #1
```
8 
14 
2 
5 
15 
8 
9 
20 
4 

```
### 样例输出 #1
```
26 

```
## 提示

【样例解释】  
一种满足要求的分配方案是：  
农场 1: $2,9,15$，$b_1 = 26$   
农场 2: $4,8,14$，$b_2 = 26$   
农场 3: $5,20$，$b_3 = 25$   

【数据范围】  
对于 $100\%$ 的数据，$1\le n \le 20$，$1 \le s_i \le 100$。


---

---
title: "[USACO12DEC] Wifi Setup S"
layout: "post"
diff: 普及/提高-
pid: P3062
tag: ['2012', 'USACO']
---
# [USACO12DEC] Wifi Setup S
## 题目描述

Farmer John's N cows (1 <= N <= 2000) are all standing at various positions along the straight path from the barn to the pasture, which we can think of as a one-dimensional number line.  Since his cows like to stay in email contact with each-other, FJ wants to install Wifi base stations at various positions so that all of the cows have wireless coverage.

After shopping around, FJ learns that the cost of a Wifi base station depends on distance it can transmit: a base station of power r costs A + B\*r, where A is a fixed cost for installing the base station and B is a cost per unit of transmission distance.  If FJ installs such a device at position x, then it can transmit data to any cow located in the range x-r ... x+r.  A base station with transmission power of r=0 is allowed, but this only provides coverage to a cow located at the same position as the transmitter.

Given the values of A and B, as well as the locations of FJ's cows, please determine the least expensive way FJ can provide wireless coverage for all his cows.

给出在同一条直线上的n个点和两个数A，B，现在要在这条直线上放置若干个信号塔，每个信号塔有一个r值，假设它的位置是x，则它能覆盖的范围是x-r~x+r，放置一个信号塔的花费是A+B\*r，问要覆盖所有的点最小的花费是多少。

## 输入格式

\* Line 1: Three space-separated integers: N A B (0 <= A, B <= 1000).

\* Lines 2..1+N: Each line contains an integer in the range

0..1,000,000 describing the location of one of FJ's cows.

## 输出格式

\* Line 1: The minimum cost of providing wireless coverage to all cows.

## 样例

### 样例输入 #1
```
3 20 5 
7 
0 
100 

```
### 样例输出 #1
```
57.5 

```
## 提示

There are 3 cows at positions 7, 0, and 100.  Installation of a base station of power r costs 20 + 5\*r.


The optimal solution is to build a base station at position 3.5 (with power 3.5) and another at position 100 (with power 0).  The first base station covers cows 1 and 2, and the second covers cow 3.



---

---
title: "[USACO13JAN] Party Invitations S"
layout: "post"
diff: 普及/提高-
pid: P3068
tag: ['2013', 'USACO', '枚举', '前缀和']
---
# [USACO13JAN] Party Invitations S
## 题目描述

Farmer John is throwing a party and wants to invite some of his cows to show them how much he cares about his herd.  However, he also wants to invite the smallest possible number of cows, remembering all too well the disaster that resulted the last time he invited too many cows to a party.

Among FJ's cows, there are certain groups of friends that are hard to separate.  For any such group (say, of size k), if FJ invites at least k-1 of the cows in the group to the party, then he must invite the final cow as well, thereby including the entire group.  Groups can be of any size and may even overlap with each-other, although no two groups contain exactly the same set of members.  The sum of all group sizes is at most 250,000.

Given the groups among FJ's cows, please determine the minimum number of cows FJ can invite to his party, if he decides that he must definitely start by inviting cow #1 (his cows are conveniently numbered 1..N, with N at most 1,000,000).


## 输入格式

\* Line 1: Two space-separated integers: N (the number of cows), and G (the number of groups).

\* Lines 2..1+G: Each line describes a group of cows.  It starts with an integer giving the size S of the group, followed by the S cows in the group (each an integer in the range 1..N).


## 输出格式

\* Line 1: The minimum number of cows FJ can invite to his party.



## 样例

### 样例输入 #1
```
10 4 
2 1 3 
2 3 4 
6 1 2 3 4 6 7 
4 4 3 2 1 

```
### 样例输出 #1
```
4 

```
## 提示

There are 10 cows and 4 groups.  The first group contains cows 1 and 3, and so on.


In addition to cow #1, FJ must invite cow #3 (due to the first group constraint), cow #4 (due to the second group constraint), and also cow #2 (due to the final group constraint).


## 题目翻译

农夫约翰要举办一个聚会，他要邀请一些奶牛来参加。在约翰的奶牛朋友圈中，有一些奶牛是好基友，对于每一个奶牛朋友圈，没有一个完全与之相同的，假设这个奶牛朋友圈有 $k$ 头奶牛，如果约翰已经邀请了 $k-1$ 头，那么剩下的那头牛也得邀请。约翰想让你告诉他，他最少需要邀请多少头奶牛？我们假设 $1$ 号奶牛已经被邀请了。

**【输入格式】**

第一行 $N$ 和 $G$ 表示共有 $N$ 头奶牛和 $G$ 个朋友圈。

接下来 $G$ 行，每行开头输入一个整数 $k$，表示朋友圈里有 $k$ 头牛，接着输入 $k$ 个整数，表示朋友圈里的牛。

**【输出格式】**

一行，一个整数，表示约翰最少需要邀请的牛的头数。

**【数据范围】**

$1 \leq  N\leq1000000$。

设所有的奶牛朋友圈的大小之和为 $M$，则 $1 \leq  M\leq250000$。


---

---
title: "[USACO13FEB] Milk Scheduling S"
layout: "post"
diff: 普及/提高-
pid: P3074
tag: ['贪心', '2013', 'USACO', '枚举', '拓扑排序']
---
# [USACO13FEB] Milk Scheduling S
## 题目描述

Farmer John's N cows (1 <= N <= 10,000) are conveniently numbered 1..N. Each cow i takes T(i) units of time to milk.  Unfortunately, some cows must be milked before others, owing to the layout of FJ's barn.  If cow A must be milked before cow B, then FJ needs to completely finish milking A before he can start milking B.

In order to milk his cows as quickly as possible, FJ has hired a large number of farmhands to help with the task -- enough to milk any number of cows at the same time.  However, even though cows can be milked at the same time, there is a limit to how quickly the entire process can proceed due to the constraints requiring certain cows to be milked before others.  Please help FJ compute the minimum total time the milking process must take.

农民约翰有N头奶牛(1<=N<=10,000)，编号为1...N。每一头奶牛需要T(i)单位的时间来挤奶。不幸的是，由于FJ的仓库布局，一些奶牛要在别的牛之前挤奶。比如说，如果奶牛A必须在奶牛B前挤奶，FJ就需要在给奶牛B挤奶前结束给奶牛A的挤奶。


为了尽量完成挤奶任务，FJ聘请了一大批雇工协助任务——同一时刻足够去给任意数量的奶牛挤奶。然而，尽管奶牛可以同时挤奶，但仍需要满足以上的挤奶先后顺序。请帮助FJ计算挤奶过程中的最小总时间。

## 输入格式

\* Line 1: Two space-separated integers: N (the number of cows) and M (the number of milking constraints; 1 <= M <= 50,000).

\* Lines 2..1+N: Line i+1 contains the value of T(i) (1 <= T(i) <= 100,000).

\* Lines 2+N..1+N+M: Each line contains two space-separated integers A and B, indicating that cow A must be fully milked before one can start milking cow B.  These constraints will never form a cycle, so a solution is always possible.

## 输出格式

\* Line 1: The minimum amount of time required to milk all cows.

## 样例

### 样例输入 #1
```
3 1 
10 
5 
6 
3 2 

```
### 样例输出 #1
```
11 

```
## 提示

There are 3 cows.  The time required to milk each cow is 10, 5, and 6, respectively.  Cow 3 must be fully milked before we can start milking cow 2.


Cows 1 and 3 can initially be milked at the same time.  When cow 3 is finished with milking, cow 2 can then begin.  All cows are finished milking after 11 units of time have elapsed.



---

---
title: "[USACO13MAR] Poker Hands S"
layout: "post"
diff: 普及/提高-
pid: P3078
tag: ['贪心', '2013', 'USACO', '差分']
---
# [USACO13MAR] Poker Hands S
## 题目描述

Bessie and her friends are playing a unique version of poker involving a deck with N (1 <= N <= 100,000) different ranks, conveniently numbered 1..N (a normal deck has N = 13). In this game, there is only one type of hand the cows can play: one may choose a card labeled i and a card labeled j and play one card of every value from i to j.  This type of hand is called a "straight".

Bessie's hand currently holds a\_i cards of rank i (0 <= a\_i <= 100000). Help her find the minimum number of hands she must play to get rid of all her cards.

## 输入格式

\* Line 1: The integer N.

\* Lines 2..1+N: Line i+1 contains the value of a\_i.

## 输出格式

\* Line 1: The minimum number of straights Bessie must play to get rid of all her cards.

## 样例

### 样例输入 #1
```
5 
2 
4 
1 
2 
3 

```
### 样例输出 #1
```
6 

```
## 提示

Bessie can play a straight from 1 to 5, a straight from 1 to 2, a straight from 4 to 5, two straights from 2 to 2, and a straight from 5 to 5, for a total of 6 rounds necessary to get rid of all her cards.

## 题目翻译

Bessie 有 $n$ 堆牌，每堆牌有 $a_i$ 张。她一次可以将第 $i$ 堆到第 $j$ 堆里打一张出去，求打完 $n$ 堆牌最少的次数。

对于 $100\%$ 的数据，$1\le n\le10^5,0\le a_i\le10^5$。


---

---
title: "[USACO13DEC] Milk Scheduling S"
layout: "post"
diff: 普及/提高-
pid: P3093
tag: ['贪心', '2013', 'USACO', '枚举']
---
# [USACO13DEC] Milk Scheduling S
## 题目描述

Farmer John has N cows that need to be milked (1 <= N <= 10,000), each of which takes only one unit of time to milk.

Being impatient animals, some cows will refuse to be milked if Farmer John waits too long to milk them.  More specifically, cow i produces g\_i gallons of milk (1 <= g\_i <= 1000), but only if she is milked before a deadline at time d\_i (1 <= d\_i <= 10,000).  Time starts at t=0, so at most x total cows can be milked prior to a deadline at time t=x.

Please help Farmer John determine the maximum amount of milk that he can obtain if he milks the cows optimally.

FJ有N(1 <= N <= 10,000)头牛要挤牛奶，每头牛需要花费1单位时间。


奶牛很厌烦等待，奶牛i在它的截止时间d\_i (1 <= d\_i <= 10,000)前挤g(1 <= g\_i <= 1000)的奶，否则将不能挤奶。时间t开始时为0，即在时间t=x时，最多可以挤x头奶牛。


请计算FJ的最大挤奶量。

## 输入格式

\* Line 1: The value of N.

\* Lines 2..1+N: Line i+1 contains the integers g\_i and d\_i.

## 输出格式

\* Line 1: The maximum number of gallons of milk Farmer John can obtain.

## 样例

### 样例输入 #1
```
4 
10 3 
7 5 
8 1 
2 1 

```
### 样例输出 #1
```
25 

```
## 提示

There are 4 cows.  The first produces 10 gallons of milk if milked by time 3, and so on.


Farmer John milks cow 3 first, giving up on cow 4 since she cannot be milked by her deadline due to the conflict with cow 3.  Farmer John then milks cows 1 and 2.



---

---
title: "[USACO13DEC] Vacation Planning S"
layout: "post"
diff: 普及/提高-
pid: P3094
tag: ['2013', 'USACO']
---
# [USACO13DEC] Vacation Planning S
## 题目描述

有N(1 <= N <= 200)个农场，用1..N编号。航空公司计划在农场间建立航线。对于任意一条航线，选择农场1..K中的农场作为枢纽(1 <= K <= 100, K <= N)。


当前共有M (1 <= M <= 10,000)条单向航线连接这些农场，从农场u\_i 到农场 v\_i, 将花费 d\_i美元。(1 <= d\_i <= 1,000,000).


航空公司最近收到Q (1 <= Q <= 10,000)个单向航行请求。第i个航行请求是从农场a\_i到农场 b\_i，航行必须经过至少一个枢纽农场（可以是起点或者终点农场），因此可能会多次经过某些农场。


请计算可行航行请求的数量，及完成所有可行请求的总费用。

## 输入格式

\* Line 1: Four integers: N, M, K, and Q.

\* Lines 2..1+M: Line i+1 contains u\_i, v\_i, and d\_i for flight i.

\* Lines 2+M..1+M+Q: Line 1+M+i describes the ith trip in terms of a\_i and b\_i

## 输出格式

\* Line 1: The number of trips (out of Q) for which a valid route is possible.

\* Line 2: The sum, over all trips for which a valid route is possible, of the minimum possible route cost.

## 样例

### 样例输入 #1
```
3 3 1 3 
3 1 10 
1 3 10 
1 2 7 
3 2 
2 3 
1 2 

```
### 样例输出 #1
```
2 
24 

```
## 提示

There are three farms (numbered 1..3); farm 1 is a hub.  There is a $10 flight from farm 3 to farm 1, and so on.  We wish to look for trips from farm 3 to farm 2, from 2->3, and from 1->2.


The trip from 3->2 has only one possible route, of cost 10+7.  The trip from 2->3 has no valid route, since there is no flight leaving farm 2.  The trip from 1->2 has only one valid route again, of cost 7.



---

---
title: "[USACO14DEC] Cow Jog S"
layout: "post"
diff: 普及/提高-
pid: P3111
tag: ['模拟', '2014', 'USACO', '排序', '广度优先搜索 BFS']
---
# [USACO14DEC] Cow Jog S
## 题目描述

 

The cows are out exercising their hooves again!  There are N cows

jogging on an infinitely-long single-lane track (1 <= N <= 100,000).

Each cow starts at a distinct position on the track, and some cows jog

at different speeds.


 

With only one lane in the track, cows cannot pass each other.  When a

faster cow catches up to another cow, she has to slow down to avoid

running into the other cow, becoming part of the same running group.

 

The cows will run for T minutes (1 <= T <= 1,000,000,000).  Please

help Farmer John determine how many groups will be left at this time.

Two cows should be considered part of the same group if they are at


the same position at the end of T minutes. 

有N (1 <= N <= 100,000)头奶牛在一个单人的超长跑道上慢跑，每头牛的起点位置都不同。由于是单人跑道，所有他们之间不能相互超越。当一头速度快的奶牛追上另外一头奶牛的时候，他必须降速成同等速度。我们把这些跑走同一个位置而且同等速度的牛看成一个小组。


请计算T (1 <= T <= 1,000,000,000)时间后，奶牛们将分为多少小组。


## 输入格式

INPUT: (file cowjog.in) 

The first line of input contains the two integers N and T.


The following N lines each contain the initial position and speed of a

single cow.  Position is a nonnegative integer and speed is a positive

integer; both numbers are at most 1 billion.  All cows start at

distinct positions, and these will be given in increasing order in

the input.


 
## 输出格式

OUTPUT: (file cowjog.out) 

A single integer indicating how many groups remain after T minutes.


## 样例

### 样例输入 #1
```
5 3 
0 1 
1 2 
2 3 
3 2 
6 1 

 


```
### 样例输出 #1
```
 

3 

 

```


---

---
title: "[USACO15OPEN] Bessie Goes Moo S"
layout: "post"
diff: 普及/提高-
pid: P3123
tag: ['搜索', '2015', 'USACO', '枚举']
---
# [USACO15OPEN] Bessie Goes Moo S
## 题目描述

Farmer John and Bessie the cow love to exchange math puzzles in their free time.

The last puzzle FJ gave Bessie was quite difficult and she failed to solve it.

Now she wants to get even with FJ by giving him a challenging puzzle.

Bessie gives FJ the expression $(B+E+S+S+I+E)(G+O+E+S)(M+O+O)$, containing the seven variables $B,E,S,I,G,O,M$ (the "$O$" is a variable, not a zero).  For each variable, she gives FJ a list of up to 500 integer values the variable can possibly take.

She asks FJ to count the number of different ways he can assign values to the variables so the entire expression evaluates to a multiple of 7.

Note that the answer to this problem can be too large to fit into a 32-bit integer, so you probably want to use 64-bit integers (e.g., "long long"s in C or C++).
## 输入格式

The first line of the input contains an integer $N$.  The next $N$ lines each contain a variable and a possible value for that variable.  

Each variable will appear in this list at least once and at most 500 times. No possible value will be listed more than once for the same variable. All possible values will be in the range $-10^5$ to $10^5$.

## 输出格式

Print a single integer, giving the number of ways FJ can assign values to variables so the expression above evaluates to a multiple of 7.

## 样例

### 样例输入 #1
```
10
B 2
E 5
S 7
I 10
O 16
M 19
B 3
G 1
I 9
M 2
```
### 样例输出 #1
```
2
```
## 提示

The two possible assignments are


(B,E,S,I,G,O,M) = (2, 5, 7, 9,  1, 16, 19) -> 51,765

(B,E,S,I,G,O,B) = (2, 5, 7, 9,  1, 16, 2 ) -> 34,510

## 题目翻译

### 题目描述

Farmer John 和奶牛 Bessie 喜欢在空闲时间互相出数学谜题。

上一次 FJ 给 Bessie 出的谜题非常难，她没能解出来。

现在，她想通过给 FJ 出一个有挑战性的谜题来报复他。

Bessie 给 FJ 的表达式是 $(B+E+S+S+I+E)(G+O+E+S)(M+O+O)$，其中包含七个变量 $B,E,S,I,G,O,M$（"$O$" 是一个变量，不是零）。对于每个变量，她给 FJ 提供了一个最多包含 500 个整数值的列表，表示该变量可能取的值。

她要求 FJ 计算有多少种不同的方式可以为这些变量赋值，使得整个表达式的值是 7 的倍数。

注意，这个问题的答案可能太大，无法用 32 位整数表示，因此你可能需要使用 64 位整数（例如，C 或 C++ 中的 "long long"）。

### 输入格式

输入的第一行包含一个整数 $N$。接下来的 $N$ 行每行包含一个变量及其可能的值。

每个变量在这个列表中至少出现一次，最多出现 500 次。对于同一个变量，不会列出重复的可能值。所有可能的值都在 $-10^5$ 到 $10^5$ 的范围内。

### 输出格式

输出一个整数，表示 FJ 可以为变量赋值的方式数，使得上述表达式的值是 7 的倍数。

### 说明/提示

两种可能的赋值方式是：

$(B,E,S,I,G,O,M) = (2, 5, 7, 9, 1, 16, 19)$ -> 51,765

$(B,E,S,I,G,O,B) = (2, 5, 7, 9, 1, 16, 2)$ -> 34,510


---

---
title: "[USACO16JAN] Radio Contact G"
layout: "post"
diff: 普及/提高-
pid: P3133
tag: ['动态规划 DP', '2016', 'USACO']
---
# [USACO16JAN] Radio Contact G
## 题目描述

Farmer John has lost his favorite cow bell, and Bessie the cow has agreed to help him find it!  They both fan out and search the farm along different paths, but stay in contact via radio so they can keep in touch with each-other. Unfortunately, the batteries in their radios are running low, so they want to plan their movements so as to conserve power, by trying to stay always within a short distance apart.

Farmer John starts at location ($f_x, f_y$) and plans to follow a path consisting of  $N$ steps, each of which is either 'N' (north), 'E' (east), 'S' (south), or 'W' west.  Bessie starts at location ($b_x, b_y$) and follows a similar path consisting of $M$ steps.  Both paths may share points in common.  At each time step, Farmer John can either stay put at his current location, or take one step forward along his path, in whichever direction happens to be next (assuming he has not yet reached the final location in his path). Bessie can make a similar choice.  At each time step (excluding the first step where they start at their initial locations), their radios consume energy equal to the square of the distance between them.

Please help FJ and Bessie plan a joint movement strategy  that will minimize the total amount of energy consumed up to and including the final step where both of them first reach the final locations on their respective paths.
## 输入格式

The first line of input contains $N$ and $M$ ($1 \leq N, M \leq 1000$). The second line contains integers $f_x$ and $f_y$, and the third line contains $b_x$ and $b_y$ ($0 \leq f_x, f_y, b_x, b_y \leq 1000$). The next line contains a string of length $N$ describing FJ's path, and the final line contains a string of length $M$ describing Bessie's path.

It is guranteed that Farmer John and Bessie's coordinates are always in the range ($0 \leq x,y \leq 1000$) throughout their journey. Note that East points in the positive x direction and North points in the positive y direction.
## 输出格式

Output a single integer specifying the minimum energy FJ and Bessie can use during their travels.
## 样例

### 样例输入 #1
```
2 7
3 0
5 0
NN
NWWWWWN
```
### 样例输出 #1
```
28
```
## 题目翻译

### 题目描述

FJ 失去了他最喜欢的牛铃，而 Bessie 已经同意帮助他找到它！他们用不同的路径搜索农场，通过无线电保持联系。

不幸的是，无线电中的电池电量不足，所以他们设法尽可能保持两者位置的距离最小，以节省电量。

FJ 从位置$(f_x,f_y)$ 开始，并计划遵循由 $N$ 步组成的路径.Bessie 从位置 $(b_x,b_y)$ 开始，并遵循由 $M$ 步组成的路径。每个步骤都是 `N`（北），`E`（东），`S`（南），或`W`（西）。其中，东方向为 $x$ 轴正方向，北方向为 $y$ 轴正方向。两个路径可以经过相同的点。

在每个时间段，FJ 可以不移动，也可以沿着他的道路前进一步。无论哪个方向恰好在下一个（假设他还没有到达他的路径的最后位置）。Bessie 可以做出类似的选择。

在每个时间点（不包括从初始位置开始的第一步），他们的无线电消耗的能量等于它们之间距离的平方。

请帮助 FJ 和 Bessie 计划行动策略，使双方达到各自终点时，最大限度地减少消耗的能量总量。输出所消耗的最小的能量。

### 输入格式

第一行两个整数 $N$ 和 $M$ $(1\le N,M\le 1000)$。

第二行两个整数 $f_x$ 和 $f_y$。

第三行两个整数 $b_x$ 和 $b_y$ $(0\le f_x,f_y,b_x,b_y\le 1000)$。

下一行为一个长度为 $N$ 的字符串，描述 FJ 的路径。

最后一行为一个长度 $M$ 的字符串，描述 Bessie 的路径。

### 输出格式

共一行一个整数，表示最小能量。


---

---
title: "[USACO16JAN] Fort Moo P"
layout: "post"
diff: 普及/提高-
pid: P3135
tag: ['动态规划 DP', '2016', 'USACO', '枚举']
---
# [USACO16JAN] Fort Moo P
## 题目描述

Bessie is building a fort with her friend Elsie. Like any good fort, this one needs to start with a sturdy frame. Bessie wants to build a frame in the shape of a one-meter-wide rectangular outline, atop which she will build the fort.

Bessie has already chosen a site on which to build the fort -- a piece of land measuring $N$ meters by $M$ meters ($1 \leq N, M \leq 200$). Unfortunately, the  site has some swampy areas that cannot be used to support the frame.  Please help Bessie determine the largest area she can cover with her fort (the area of the rectangle supported by the frame), such that the frame avoids sitting on any of the swampy areas.
## 输入格式

Line 1 contains integers $N$ and $M$.

The next $N$ lines each contain $M$ characters, forming a grid describing the site.  A character of '.' represents normal grass, while 'X' represents a swampy spot.
## 输出格式

A single integer representing the maximum area that Bessie can cover with her fort.
## 样例

### 样例输入 #1
```
5 6
......
..X..X
X..X..
......
..X...
```
### 样例输出 #1
```
16
```
## 提示

In the example, the placement of the optimal frame is indicated by 'f's below:

```cpp
.ffff.
.fX.fX
Xf.Xf.
.ffff.
..X...
```
## 题目翻译

### 题目描述

Bessie 正在和她的朋友 Elsie 一起建造一个堡垒。像任何好的堡垒一样，这个堡垒需要一个坚固的框架。Bessie 想要建造一个一米宽的矩形轮廓框架，然后在这个框架上建造堡垒。

Bessie 已经选择了一个建造堡垒的地点——一块 $N$ 米乘 $M$ 米的土地（$1 \leq N, M \leq 200$）。不幸的是，这块地有一些沼泽区域，不能用来支撑框架。请帮助 Bessie 确定她可以用堡垒覆盖的最大面积（由框架支撑的矩形的面积），使得框架不会坐落在任何沼泽区域上。

### 输入格式

第 1 行包含整数 $N$ 和 $M$。

接下来的 $N$ 行每行包含 $M$ 个字符，形成一个描述地点的网格。字符 '.' 表示普通草地，而 'X' 表示沼泽区域。

### 输出格式

一个整数，表示 Bessie 可以用堡垒覆盖的最大面积。

### 说明/提示

在示例中，最优框架的位置由下面的 `f` 表示：

```
.ffff.
.fX.fX
Xf.Xf.
.ffff.
..X...
```


---

---
title: "[USACO16FEB] Load Balancing S"
layout: "post"
diff: 普及/提高-
pid: P3138
tag: ['2016', '线段树', 'USACO', '枚举', '前缀和']
---
# [USACO16FEB] Load Balancing S
## 题目背景

*本题与 [白金组同名题目](/problem/P6172) 在题意上一致，唯一的差别是数据范围。*
## 题目描述

Farmer John 的 $N$ 头奶牛（$1 \leq N \leq 1000$）散布在整个农场上。整个农场是一个无限大的二维平面，第 $i$ 头奶牛的坐标是 $(x_i,y_i)$（保证 $x_i,y_i$ 均为正奇数，且 $x_i,y_i \leq 10^6$），且没有任意两头奶牛在同一位置上。

FJ 希望修建一条竖直方向的栅栏，它的方程是 $x=a$，他还希望修建一条水平方向的栅栏，它的方程是 $y=b$。为了防止栅栏经过奶牛，$a,b$ 均要求是偶数。容易发现，这两个栅栏会在 $(a,b)$ 处相交，将整个农场分割为四个区域。

FJ 希望这四个区域内的奶牛数量较为均衡，尽量避免一个区域奶牛多而另一个区域奶牛少的情况。令 $M$ 为四个区域里奶牛最多区域的奶牛数量，请帮 FJ 求出 $M$ 的最小值。
## 输入格式

第一行一个整数 $N$。

接下来 $N$ 行，每行两个整数 $x_i,y_i$，描述第 $i$ 头奶牛的位置。
## 输出格式

输出 $M$ 的最小值。
## 样例

### 样例输入 #1
```
7
7 3
5 5
7 13
3 1
11 7
5 3
9 1
```
### 样例输出 #1
```
2
```


---

---
title: "[USACO16FEB] Milk Pails S"
layout: "post"
diff: 普及/提高-
pid: P3139
tag: ['搜索', '2016', 'USACO', '剪枝', '记忆化搜索']
---
# [USACO16FEB] Milk Pails S
## 题目描述

Farmer John has received an order for exactly $M$ units of milk ($1 \leq M \leq 200$) that he needs to fill right away.  Unfortunately, his fancy milking machine has just become broken, and all he has are two milk pails of integer sizes $X$ and $Y$ ($1 \leq X, Y \leq 100$) with which he can measure milk.  Both pails are initially empty.  Using these two pails, he can perform up to $K$ of the following types of operations ($1 \leq K \leq 100$):

- He can fill either pail completely to the top.

- He can empty either pail.

- He can pour the contents of one pail into the other, stopping when the former becomes empty or the latter becomes full (whichever of these happens first).

Although FJ realizes he may not be able to end up with exactly $M$ total units of milk in the two pails, please help him compute the minimum amount of error between $M$ and the total amount of milk in the two pails.  That is, please compute the minimum value of $|M-M'|$ such that FJ can construct $M'$ units of milk collectively between the two pails.
## 输入格式

The first, and only line of input, contains $X$, $Y$, $K$, and $M$.

## 输出格式

Output the smallest distance from $M$ to an amount of milk FJ can produce.

## 样例

### 样例输入 #1
```
14 50 2 32
```
### 样例输出 #1
```
18
```
## 提示

In two steps FJ can be left with the following quanities in his pails


```cpp
(0, 0) = 0 units
(14, 0) = 14 units
(0, 50) = 50 units
(0, 14) = 14 units
(14, 36) = 50 units
(14, 50) = 64 units
```

The closest we can come to 32 units is 14 for a difference of 18.  Note that it would require an extra step to pour out the first pail to end up with (0, 36).

## 题目翻译

### 题目描述

Farmer John 接到了一份需要立即完成的订单，要求他提供恰好 $M$ 单位的牛奶（$1 \leq M \leq 200$）。不幸的是，他先进的挤奶机刚刚坏了，现在他只有两个容量为整数 $X$ 和 $Y$（$1 \leq X, Y \leq 100$）的牛奶桶可以用来量取牛奶。两个桶最初都是空的。使用这两个桶，他可以执行最多 $K$ 次以下类型的操作（$1 \leq K \leq 100$）：

- 他可以将任意一个桶完全装满。

- 他可以将任意一个桶完全倒空。

- 他可以将一个桶中的牛奶倒入另一个桶，直到前者被倒空或后者被装满（以先发生的情况为准）。

尽管 FJ 意识到他可能无法最终在两个桶中得到恰好 $M$ 单位的牛奶，但请帮助他计算 $M$ 与两个桶中牛奶总量之间的最小误差。也就是说，请计算 $|M-M'|$ 的最小值，其中 $M'$ 是 FJ 可以在两个桶中共同构造的牛奶量。

### 输入格式

输入的第一行也是唯一一行包含 $X$、$Y$、$K$ 和 $M$。

### 输出格式

输出 $M$ 与 FJ 可以生产的牛奶量之间的最小误差。

### 说明/提示

在两步操作中，FJ 可以在他的桶中留下以下数量的牛奶：

```
(0, 0) = 0 单位  
(14, 0) = 14 单位  
(0, 50) = 50 单位  
(0, 14) = 14 单位  
(14, 36) = 50 单位  
(14, 50) = 64 单位  
```

最接近 32 单位的是 14 单位，误差为 18。注意，要倒空第一个桶以得到 (0, 36) 需要额外的步骤。


---

---
title: "[USACO16OPEN] Field Reduction S"
layout: "post"
diff: 普及/提高-
pid: P3142
tag: ['2016', 'USACO', '枚举', '排序']
---
# [USACO16OPEN] Field Reduction S
## 题目描述

Farmer John's $N$ cows ($5 \leq N \leq 50,000$) are all located at distinct positions in his two-dimensional field.  FJ wants to enclose all of the cows with a rectangular fence whose sides are parallel to the x and y axes, and he wants this fence to be as small as possible so that it contains every cow (cows on the boundary are allowed).

FJ is unfortunately on a tight budget due to low milk production last quarter. He would therefore like to build an even smaller fenced enclosure if possible, and he is willing to sell up to three cows from his herd to make this possible.

Please help FJ compute the smallest possible area he can enclose with his fence after removing up to three cows from his herd (and thereafter building the tightest enclosing fence for the remaining cows).

For this problem, please treat cows as points and the fence as a collection of four line segments (i.e., don't think of the cows as "unit squares").  Note that the answer can be zero, for example if all remaining cows end up standing  in a common vertical or horizontal line.
## 输入格式

The first line of input contains $N$.  The next $N$ lines each contain two integers specifying the location of a cow.  Cow locations are positive integers in the range $1 \ldots 40,000$.

## 输出格式

Write a single integer specifying the minimum area FJ can enclose with his fence after removing up to three carefully-chosen cows from his herd.

## 样例

### 样例输入 #1
```
6
1 1
7 8
10 9
8 12
4 100
50 7
```
### 样例输出 #1
```
12
```
## 题目翻译

### 题目描述

Farmer John 的 $N$ 头奶牛（$5 \leq N \leq 50,000$）都位于他二维牧场中的不同位置。FJ 希望用一个边平行于 $x$ 轴和 $y$ 轴的矩形围栏围住所有的奶牛，并且他希望这个围栏尽可能小，以便能够包含每头奶牛（允许奶牛位于边界上）。

不幸的是，由于上个季度牛奶产量低，FJ 的预算非常紧张。因此，他希望如果可能的话，建造一个更小的围栏，并且他愿意从他的牛群中出售最多三头奶牛来实现这一目标。

请帮助 FJ 计算在从他的牛群中移除最多三头奶牛后，他可以用围栏围住的最小可能面积（然后为剩余的奶牛建造最紧密的围栏）。

对于这个问题，请将奶牛视为点，将围栏视为四条线段的集合（即不要将奶牛视为“单位正方形”）。请注意，答案可能为零，例如如果所有剩余的奶牛最终站在一条共同的垂直线或水平线上。

### 输入格式

输入的第一行包含 $N$。接下来的 $N$ 行每行包含两个整数，表示一头奶牛的位置。奶牛的位置是范围在 $1 \ldots 40,000$ 的正整数。

### 输出格式

输出一个整数，表示 FJ 在从他的牛群中精心选择移除最多三头奶牛后，可以用围栏围住的最小面积。


---

---
title: "[USACO16OPEN] Diamond Collector S"
layout: "post"
diff: 普及/提高-
pid: P3143
tag: ['贪心', '2016', 'USACO', '枚举', '双指针 two-pointer']
---
# [USACO16OPEN] Diamond Collector S
## 题目描述

Bessie the cow, always a fan of shiny objects, has taken up a hobby of mining diamonds in her spare time!  She has collected $N$ diamonds ($N \leq 50,000$) of varying sizes, and she wants to arrange some of them in a pair of  display cases in the barn.


Since Bessie wants the diamonds in each of the two cases to be relatively similar in  size, she decides that she will not include two diamonds in the same case if their sizes differ by more than $K$ (two diamonds can be displayed together in the same case if their sizes differ by exactly $K$).  Given $K$, please help Bessie determine the maximum number of diamonds she can display in both cases together.
## 输入格式

The first line of the input file contains $N$ and $K$ ($0 \leq K \leq 1,000,000,000$).

The next $N$ lines each contain an integer giving the size of one of the diamonds.  All sizes will be positive and will not exceed $1,000,000,000$.

## 输出格式

Output a single positive integer, telling the maximum number of diamonds that Bessie can showcase in total in both the cases.
## 样例

### 样例输入 #1
```
7 3
10
5
1
12
9
5
14
```
### 样例输出 #1
```
5
```
## 题目翻译

### 题目描述

奶牛 Bessie 一直喜欢闪闪发光的物体，她最近在业余时间开始了一项爱好——挖掘钻石！她收集了 $N$ 颗大小各不相同的钻石（$N \leq 50,000$），并希望将它们中的一部分放在谷仓里的两个展示柜中展示。

由于 Bessie 希望每个展示柜中的钻石大小相对接近，她决定如果两颗钻石的大小相差超过 $K$，就不能将它们放在同一个展示柜中（如果两颗钻石的大小相差恰好为 $K$，则可以将它们一起展示在同一个展示柜中）。给定 $K$，请帮助 Bessie 确定她可以在两个展示柜中一起展示的最大钻石数量。

### 输入格式

输入文件的第一行包含 $N$ 和 $K$（$0 \leq K \leq 1,000,000,000$）。

接下来的 $N$ 行每行包含一个整数，表示一颗钻石的大小。所有钻石的大小均为正数且不超过 $1,000,000,000$。

### 输出格式

输出一个正整数，表示 Bessie 可以在两个展示柜中一起展示的最大钻石数量。


---

---
title: "[USACO16OPEN] Closing the Farm S"
layout: "post"
diff: 普及/提高-
pid: P3144
tag: ['贪心', '2016', 'USACO', '并查集']
---
# [USACO16OPEN] Closing the Farm S
## 题目背景

*本题和 [金组同名题目](/problem/P6121) 在题意上一致，唯一的不同是数据范围。*
## 题目描述

FJ 和他的奶牛们正在计划离开小镇做一次长的旅行，同时 FJ 想临时地关掉他的农场以节省一些金钱。

这个农场一共有被用 $M$ 条双向道路连接的 $N$ 个谷仓（$1 \leq N,M \leq 3000$）。为了关闭整个农场，FJ 计划每一次关闭掉一个谷仓。当一个谷仓被关闭了，所有的连接到这个谷仓的道路都会被关闭，而且再也不能够被使用。

FJ 现在正感兴趣于知道在每一个时间（这里的“时间”指在每一次关闭谷仓之前的时间）时他的农场是否是“全连通的”——也就是说从任意的一个开着的谷仓开始，能够到达另外的一个谷仓。注意自从某一个时间之后，可能整个农场都开始不会是“全连通的”。
## 输入格式

输入第一行两个整数 $N,M$。

接下来 $M$ 行，每行两个整数 $u,v$（$1 \leq u,v \leq N$），描述一条连接 $u,v$ 两个农场的路。

最后 $N$ 行每行一个整数，表示第 $i$ 个被关闭的农场编号。
## 输出格式

输出 $N$ 行，每行包含 `YES` 或 `NO`，表示某个时刻农场是否是全连通的。

第一行输出最初的状态，第 $i$ 行（$2 \leq i \leq N$）输出第 $i-1$ 个农场被关闭后的状态。
## 样例

### 样例输入 #1
```
4 3
1 2
2 3
3 4
3
4
1
2
```
### 样例输出 #1
```
YES
NO
YES
YES
```


---

---
title: "[USACO16DEC] Moocast S"
layout: "post"
diff: 普及/提高-
pid: P3416
tag: ['2016', 'USACO', 'Floyd 算法']
---
# [USACO16DEC] Moocast S
## 题目描述

Farmer John's $N$ cows ($1 \leq N \leq 200$) want to organize an emergency"moo-cast" system for broadcasting important messages among themselves.


Instead of mooing at each-other over long distances, the cows decide to equip themselves with walkie-talkies, one for each cow.  These walkie-talkies each have a limited transmission radius -- a walkie-talkie of power $P$ can only transmit to other cows up to a distance of $P$ away (note that cow A might be able to transmit to cow B even if cow B cannot transmit back, due to cow A's power being larger than that of cow B).  Fortunately, cows can relay messages to one-another along a path consisting of several hops, so it is not necessary for every cow to be able to transmit directly to every other cow.


Due to the asymmetrical nature of the walkie-talkie transmission, broadcasts from some cows may be more effective than from other cows in their ability toreach large numbers of recipients (taking relaying into account).  Please  help the cows determine the maximum number of cows that can be reached by a broadcast originating from a single cow.






## 输入格式

The first line of input contains $N$.


The next $N$ lines each contain the $x$ and $y$ coordinates of a single cow ( integers in the range $0 \ldots 25,000$) followed by $p$, the power of the walkie-talkie held by this cow.

## 输出格式

Write a single line of output containing the maximum number of cows a broadcast from a single cow can reach.  The originating cow is included in this number.



## 样例

### 样例输入 #1
```
4
1 3 5
5 4 3
7 2 1
6 1 1
```
### 样例输出 #1
```
3
```
## 题目翻译

### 题目描述

约翰农场主的 $N$ 头奶牛想建立一个紧急情况下的“哞哞广播”系统，这样它们就可以在自己中间广播重要信息。

奶牛们想让每头牛装备上一个对讲机，而不是在长距离中向另一头奶牛“哞哞”乱叫。这些对讲机每台都有各自的有效传输半径——一个拥有 $P$ 能量的对讲机只能向距离在 $P$ 以内的牛发送信息（注意可能出现 $A$ 牛对讲机的能量比 $B$ 牛的大，而 $A$ 牛可以给 $B$ 牛发送信息，但 $B$ 牛不能传回信息）。幸运的是，奶牛们可以通过其他奶牛中继，沿着一条跳跃的路径传递信息，因此每个奶牛不必要直接向每个其他奶牛传播。

由于对讲机的费堆成性质，来自一些奶牛的广播可能比其他奶牛的广播能够达到更多的接受者（考虑中继的情况）的能力更有效。请帮助奶牛确定来自单个奶牛的广播可以达到的奶牛的最大数量。

### 输入格式

第一行，一个整数 $N$。

接下来 $N$ 行，第 $i$ 行包括第 $i$ 只牛的坐标 $(x_i,y_i)$，以及这只牛所持有对讲机的能量 $P_i$。

### 输出格式

一行，一个整数，表示从来自单个奶牛的广播可以达到的奶牛的最大数量。开始的牛也包括在这个数量中。

### 说明/提示

对于 $100\%$ 的数据，$N\le200$，$\forall i \in [1,N]$，$0\le x_i,y_i\le25000$。


---

---
title: "[USACO17FEB] Why Did the Cow Cross the Road II S"
layout: "post"
diff: 普及/提高-
pid: P3662
tag: ['2017', 'USACO', '枚举', '前缀和', '队列']
---
# [USACO17FEB] Why Did the Cow Cross the Road II S
## 题目描述

The long road through Farmer John's farm has $N$ crosswalks across it, conveniently numbered $1 \ldots N$ ($1 \leq N \leq 100,000$). To allow cows to cross at these crosswalks, FJ installs electric crossing signals, which light up with a green cow icon when it is ok for the cow to cross, and red otherwise. Unfortunately, a large electrical storm has damaged some of his signals. Given a list of the damaged signals, please compute the minimum number of signals that FJ needs to repair in order for there to exist some contiguous block of at least $K$ working signals.
## 输入格式

The first line of input contains $N$, $K$, and $B$ ($1 \leq B, K \leq N$). The next $B$ lines each describe the ID number of a broken signal.
## 输出格式

Please compute the minimum number of signals that need to be repaired in order for there to be a contiguous block of $K$ working signals somewhere along the road.

## 样例

### 样例输入 #1
```
10 6 5
2
10
1
5
9
```
### 样例输出 #1
```
1
```
## 题目翻译

### 题目描述

穿过 Farmer John 农场的长路上有 $N$ 个人行横道，方便地用编号 $1 \ldots N$ 标识（$1 \leq N \leq 100,000$）。为了让奶牛能够通过这些横道过马路，FJ 安装了电子过马路信号灯，当奶牛可以安全过马路时，信号灯会显示绿色的奶牛图标，否则显示红色。不幸的是，一场大雷暴损坏了他的一些信号灯。给定损坏信号灯的列表，请计算 FJ 需要修复的最少信号灯数量，以便存在至少 $K$ 个连续的信号灯正常工作。

### 输入格式

输入的第一行包含 $N$、$K$ 和 $B$（$1 \leq B, K \leq N$）。接下来的 $B$ 行每行描述一个损坏信号灯的 ID 编号。

### 输出格式

请计算需要修复的最少信号灯数量，以便在道路上某处存在一个长度为 $K$ 的连续正常工作信号灯块。


---

---
title: "[USACO17OPEN] Bovine Genomics S"
layout: "post"
diff: 普及/提高-
pid: P3670
tag: ['2017', 'USACO', '离散化', '枚举']
---
# [USACO17OPEN] Bovine Genomics S
## 题目描述

Farmer John owns $N$ cows with spots and $N$ cows without spots. Having just completed a course in bovine genetics, he is convinced that the spots on his cows are caused by mutations in the bovine genome.


At great expense, Farmer John sequences the genomes of his cows. Each genome is a string of length $M$ built from the four characters A, C, G, and T. When he lines up the genomes of his cows, he gets a table like the following, shown here


for $N=3$:


```cpp
Positions: 1 2 3 4 5 6 7 ... M

Spotty Cow 1: A A T C C C A ... T
Spotty Cow 2: G A T T G C A ... A
Spotty Cow 3: G G T C G C A ... A

Plain Cow 1: A C T C C C A ... G
Plain Cow 2: A G T T G C A ... T
Plain Cow 3: A G T T C C A ... T
```

Looking carefully at this table, he surmises that positions 2 and 4 are sufficient to explain spottiness. That is, by looking at the characters in just these two positions, Farmer John can predict which of his cows are spotty and which are not (for example, if he sees G and C, the cow must be spotty).


Farmer John is convinced that spottiness can be explained not by just one or two positions in the genome, but by looking at a set of three distinct positions.  Please help him count the number of sets of three distinct positions that can each explain spottiness.
## 输入格式

The first line of input contains $N$ ($1 \leq N \leq 500$) and $M$ ($3 \leq M \leq 50$). The next $N$ lines each contain a string of $M$ characters; these describe the genomes of the spotty cows. The final $N$ lines describe the genomes of the plain cows.

## 输出格式

Please count the number of sets of three distinct positions that can explain spottiness. A set of three positions explains spottiness if the spottiness trait can be predicted with perfect accuracy among Farmer John's population of cows by looking at just those three locations in the genome.

## 样例

### 样例输入 #1
```
3 8
AATCCCAT
GATTGCAA
GGTCGCAA
ACTCCCAG
ACTCGCAT
ACTTCCAT
```
### 样例输出 #1
```
22
```
## 题目翻译

### 题目描述

Farmer John 拥有 $N$ 头有斑点的牛和 $N$ 头没有斑点的牛。他刚刚完成了一门关于牛遗传学的课程，并确信他牛身上的斑点是由牛基因组中的突变引起的。

Farmer John 花费巨资对他的牛进行了基因组测序。每个基因组是一个由字符 A、C、G 和 T 组成的长度为 $M$ 的字符串。当他将牛的基因组排列起来时，会得到如下表格，这里展示的是 $N=3$ 的情况：

```
位置：1 2 3 4 5 6 7 ... M

斑点牛 1：A A T C C C A ... T  
斑点牛 2：G A T T G C A ... A  
斑点牛 3：G G T C G C A ... A  

普通牛 1：A C T C C C A ... G  
普通牛 2：A G T T G C A ... T  
普通牛 3：A G T T C C A ... T 
```

仔细观察这个表格后，他推测位置 2 和 4 足以解释斑点现象。也就是说，通过仅查看这两个位置的字符，Farmer John 可以预测哪些牛是有斑点的，哪些是没有斑点的（例如，如果他看到 G 和 C，这头牛一定是有斑点的）。

Farmer John 确信，斑点现象不仅仅可以通过基因组中的一个或两个位置来解释，而是可以通过查看三个不同的位置来解释。请帮助他计算能够解释斑点现象的三个不同位置集合的数量。

### 输入格式

输入的第一行包含 $N$（$1 \leq N \leq 500$）和 $M$（$3 \leq M \leq 50$）。接下来的 $N$ 行每行包含一个长度为 $M$ 的字符串，这些字符串描述了斑点牛的基因组。最后的 $N$ 行描述了普通牛的基因组。

### 输出格式

请计算能够解释斑点现象的三个不同位置集合的数量。如果通过查看基因组中这三个位置的字符，可以在 Farmer John 的牛群中完美准确地预测斑点性状，那么这个三个位置的集合就解释了斑点现象。


---

---
title: "[USACO1.2] 命名那个数字 Name That Number"
layout: "post"
diff: 普及/提高-
pid: P3864
tag: ['模拟', '字符串', '搜索', 'USACO', '枚举', '深度优先搜索 DFS']
---
# [USACO1.2] 命名那个数字 Name That Number
## 题目描述

在威斯康辛州牛守志大农场经营者之中，都习惯于请会计部门用连续数字给母牛打上烙印。但是,母牛本身并没感到这个系统的便利,它们更喜欢用它们喜欢的名字来呼叫它们的同伴，而不是用像这个的语句"C'mon, #4364, get along."。请写一个程序来帮助可怜的牧牛工将一只母牛的烙印编号翻译成一个可能的名字。因为母牛们现在都有手机了，使用标准的按键的排布来把将数目翻译为文字:( 除了 "Q" 和 "Z")

```
2: A,B,C     5: J,K,L    8: T,U,V
3: D,E,F     6: M,N,O    9: W,X,Y
4: G,H,I     7: P,R,S
```
可接受的名字都被放在这样一个叫作"dict.txt" 的文件中，它包含一连串的少于 5,000个（准确地说是4617个）可被接受的牛的名字。 (所有的名字都是大写的且已按字典序排列) 请读入母牛的编号并返回那些能从编号翻译出来并且在字典中的名字。举例来说,编号 4734 能产生的下列各项名字: GPDG GPDH GPDI GPEG GPEH GPEI GPFG GPFH GPFI GRDG GRDH GRDI GREG GREH GREI GRFG GRFH GRFI GSDG GSDH GSDI GSEG GSEH GSEI GSFG GSFH GSFI HPDG HPDH HPDI HPEG HPEH HPEI HPFG HPFH HPFI HRDG HRDH HRDI HREG HREH HREI HRFG HRFH HRFI HSDG HSDH HSDI HSEG HSEH HSEI HSFG HSFH HSFI IPDG IPDH IPDI IPEG IPEH IPEI IPFG IPFH IPFI IRDG IRDH IRDI IREG IREH IREI IRFG IRFH IRFI ISDG ISDH ISDI ISEG ISEH ISEI ISFG ISFH ISFI 碰巧，81个中只有一个"GREG"是有效的(在字典中)。

写一个程序来对给出的编号打印出所有的有效名字，如果没有则输出NONE。编号可能有12位数字。

## 输入格式

第一行一行包含一个编号(长度可能从1到12)。

接下来4617行，每行一个字符串表示可以被接受的名字
## 输出格式

(file namenum.out)

以字典顺序输出一个有效名字的不重复列表，一行一个名字。 如果没有有效名字，输出'NONE'。 //注释：似乎数字只有8^4种排列（1与0不能用）

## 样例

### 样例输入 #1
```
4734
NMSL
GREG
LSDC
....(太多了不写了)
```
### 样例输出 #1
```
GREG

```


---

---
title: "[USACO17DEC] My Cow Ate My Homework S"
layout: "post"
diff: 普及/提高-
pid: P4086
tag: ['递推', '2017', '线段树', 'USACO', '枚举', '前缀和']
---
# [USACO17DEC] My Cow Ate My Homework S
## 题目描述

In your bovine history class, you have been given a rather long homework assignment with $N$ questions ($3 \leq N \leq 100,000$), each graded with an integer score in the range 0...10,000. As is often customary, your teacher plans to assign a final grade by discarding a question on which you received the lowest score and then averaging the remaining scores together. Unfortunately, your pet cow Bessie has just eaten your answers to the first $K$ questions! ($K$ could be as small as 1 or as large as $N-2$).

After copious explanation, your teacher finally believes your story, and agrees to grade the remaining non-eaten part of the assignment the same way as before -- by removing the lowest-scoring question (or one such question, in the event of a tie) and averaging the rest.


Please output all values of $K$ which would have earned you the maximum possible score according to this grading scheme, in sorted order.


## 输入格式

The first line of input contains $N$, and the next line contains the scores on the $N$ homework questions.

## 输出格式

Please output, one value per line, all values of $K$ which would have earned you the maximum possible score.

## 样例

### 样例输入 #1
```
5
3 1 9 2 7
```
### 样例输出 #1
```
2
```
## 提示

If Bessie eats the first two questions, then the remaining scores are 9, 2, and 7. Removing the minimum and averaging, we get a final grade of 8, which is the highest possible.

## 题目翻译

### 题目描述

在你的牛历史课上，你被布置了一份相当长的作业，包含 $N$ 个问题（$3 \leq N \leq 100,000$），每个问题的得分是一个在 0 到 10,000 之间的整数。按照惯例，你的老师计划通过去掉你得分最低的一个问题，然后对剩余问题的得分取平均来给出最终成绩。不幸的是，你的宠物奶牛 Bessie 刚刚吃掉了你前 $K$ 个问题的答案！（$K$ 可能小到 1，也可能大到 $N-2$）。

经过多次解释，你的老师终于相信了你的说法，并同意按照之前的方式对剩余的未被吃掉的部分作业进行评分——即去掉得分最低的问题（或在得分相同的情况下去掉其中一个），然后对剩余问题取平均。

请输出所有能够使你获得最高可能成绩的 $K$ 值，并按升序排列。

### 输入格式

输入的第一行包含 $N$，第二行包含 $N$ 个作业问题的得分。

### 输出格式

请逐行输出所有能够使你获得最高可能成绩的 $K$ 值。

### 说明/提示

如果 Bessie 吃掉了前两个问题，那么剩余的得分是 9、2 和 7。去掉最低分并取平均后，最终成绩为 8，这是可能的最高成绩。


---

---
title: "[USACO17DEC] The Bovine Shuffle S"
layout: "post"
diff: 普及/提高-
pid: P4089
tag: ['2017', 'USACO', '拓扑排序']
---
# [USACO17DEC] The Bovine Shuffle S
## 题目描述

Convinced that happy cows generate more milk, Farmer John has installed a giant disco ball in his barn and plans to teach his cows to dance!

Looking up popular cow dances, Farmer John decides to teach his cows the "Bovine Shuffle". The Bovine Shuffle consists of his $N$ cows ($1 \leq N \leq 100,000$) lining up in a row in some order, then performing successive "shuffles", each of which potentially re-orders the cows. To make it easier for his cows to locate themselves, Farmer John marks the locations for his line of cows with positions $1 \ldots N$, so the first cow in the lineup will be in position 1, the next in position 2, and so on, up to position $N$.


A shuffle is described with $N$ numbers, $a_1 \ldots a_N$, where a cow in position $i$ moves to position $a_i$ during the shuffle (and so, each $a_i$ is in the range $1 \ldots N$). Every cow moves to its new location during the shuffle. Unfortunately, all the $a_i$'s are not necessarily distinct, so multiple cows might try to move to the same position during a shuffle, after which they will move together for all remaining shuffles.


Farmer John notices that some positions in his lineup contain cows in them no matter how many shuffles take place. Please help him count the number of such positions.


## 输入格式

The first line of input contains $N$, the number of cows. The next line contains the $N$ integers $a_1 \ldots a_N$.

## 输出格式

Please output the number of positions that will always contain cows, no matter how many shuffles take place.

## 样例

### 样例输入 #1
```
4
3 2 1 3
```
### 样例输出 #1
```
3

```
## 题目翻译

### 题目描述

Farmer John 坚信快乐的奶牛能产更多的奶，因此他在谷仓里安装了一个巨大的迪斯科球，并计划教他的奶牛跳舞！

在查阅了流行的奶牛舞蹈后，Farmer John 决定教他的奶牛“Bovine Shuffle”。Bovine Shuffle 包括他的 $N$ 头奶牛（$1 \leq N \leq 100,000$）以某种顺序排成一行，然后进行连续的“洗牌”，每次洗牌可能会重新排列奶牛的顺序。为了让奶牛更容易找到自己的位置，Farmer John 为他的奶牛队伍标记了位置 $1 \ldots N$，因此队伍中的第一头奶牛位于位置 1，第二头位于位置 2，依此类推，直到位置 $N$。

一次洗牌由 $N$ 个数字 $a_1 \ldots a_N$ 描述，其中位于位置 $i$ 的奶牛在洗牌期间移动到位置 $a_i$（因此，每个 $a_i$ 都在 $1 \ldots N$ 范围内）。每头奶牛在洗牌期间都会移动到它的新位置。不幸的是，所有的 $a_i$ 不一定互不相同，因此多只奶牛可能会在洗牌期间尝试移动到同一位置，之后它们将在所有剩余的洗牌中一起移动。

Farmer John 注意到，无论进行多少次洗牌，他的队伍中某些位置始终会有奶牛。请帮助他计算这样的位置数量。

### 输入格式

输入的第一行包含 $N$，表示奶牛的数量。第二行包含 $N$ 个整数 $a_1 \ldots a_N$。

### 输出格式

请输出无论进行多少次洗牌，始终会有奶牛的位置数量。


---

---
title: "[USACO18FEB] Rest Stops S"
layout: "post"
diff: 普及/提高-
pid: P4266
tag: ['贪心', '2018', 'USACO', '排序']
---
# [USACO18FEB] Rest Stops S
## 题目描述

Farmer John and his personal trainer Bessie are hiking up Mount Vancowver. For their purposes (and yours), the mountain can be represented as a long straight trail of length $L$ meters ($1 \leq L \leq 10^6$). Farmer John will hike the trail at a constant travel rate of $r_F$ seconds per meter ($1 \leq r_F \leq 10^6$). Since he is working on his stamina, he will not take any rest stops along the way.
Bessie, however, is allowed to take rest stops, where she might find some tasty grass. Of course, she cannot stop just anywhere! There are $N$ rest stops along the trail ($1 \leq N \leq 10^5$); the $i$-th stop is $x_i$ meters from the start of the trail ($0 < x_i < L$) and has a tastiness value $c_i$ ($1 \leq c_i \leq 10^6$). If Bessie rests at stop $i$ for $t$ seconds, she receives $c_i \cdot t$ tastiness units.

When not at a rest stop, Bessie will be hiking at a fixed travel rate of $r_B$ seconds per meter ($1 \leq r_B \leq 10^6$). Since Bessie is young and fit, $r_B$ is strictly less than $r_F$.

Bessie would like to maximize her consumption of tasty grass. But she is worried about Farmer John; she thinks that if at any point along the hike she is behind Farmer John on the trail, he might lose all motivation to continue!

Help Bessie find the maximum total tastiness units she can obtain while making sure that Farmer John completes the hike.
## 输入格式

The first line of input contains four integers: $L$, $N$, $r_F$, and $r_B$. The next $N$ lines describe the rest stops. For each $i$ between $1$ and $N$, the $i+1$-st line contains two integers $x_i$ and $c_i$, describing the position of the $i$-th rest stop and the tastiness of the grass there.
It is guaranteed that $r_F > r_B$, and $0 < x_1 < \dots < x_N < L $. **Note that $r_F$ and $r_B$ are given in seconds per meter!**
## 输出格式

A single integer: the maximum total tastiness units Bessie can obtain.
## 样例

### 样例输入 #1
```
10 2 4 3
7 2
8 1
```
### 样例输出 #1
```
15
```
## 提示

In this example, it is optimal for Bessie to stop for $7$ seconds at the $x=7$ rest stop (acquiring $14$ tastiness units) and then stop for an additional $1$ second at the $x=8$ rest stop (acquiring $1$ more tastiness unit, for a total of $15$ tastiness units).

Problem credits: Dhruv Rohatgi
## 题目翻译

### 题目描述

Farmer John 和他的私人教练 Bessie 正在攀登温哥华山。为了他们的目的（以及你的目的），这座山可以表示为一条长度为 $L$ 米的长直步道（$1 \leq L \leq 10^6$）。Farmer John 将以每米 $r_F$ 秒的恒定速度徒步（$1 \leq r_F \leq 10^6$）。由于他正在锻炼耐力，他不会在途中休息。

然而，Bessie 被允许在休息站休息，她可能会在那里找到一些美味的草。当然，她不能随便停下来！步道上有 $N$ 个休息站（$1 \leq N \leq 10^5$）；第 $i$ 个休息站距离步道起点 $x_i$ 米（$0 < x_i < L$），并且有一个美味值 $c_i$（$1 \leq c_i \leq 10^6$）。如果 Bessie 在第 $i$ 个休息站休息 $t$ 秒，她会获得 $c_i \cdot t$ 的美味单位。

当不在休息站时，Bessie 将以每米 $r_B$ 秒的固定速度徒步（$1 \leq r_B \leq 10^6$）。由于 Bessie 年轻且健康，$r_B$ 严格小于 $r_F$。

Bessie 希望最大化她摄入的美味草量。但她担心 Farmer John；她认为如果在徒步的任何时刻她在步道上落后于 Farmer John，他可能会失去继续前进的动力！

请帮助 Bessie 找到在确保 Farmer John 完成徒步的情况下，她能获得的最大总美味单位。

### 输入格式

输入的第一行包含四个整数：$L$、$N$、$r_F$ 和 $r_B$。接下来的 $N$ 行描述了休息站。对于每个 $i$ 从 $1$ 到 $N$，第 $i+1$ 行包含两个整数 $x_i$ 和 $c_i$，分别描述第 $i$ 个休息站的位置和草的美味值。
保证 $r_F > r_B$，且 $0 < x_1 < \dots < x_N < L$。**注意，$r_F$ 和 $r_B$ 的单位是秒每米！**

### 输出格式

输出一个整数：Bessie 能获得的最大总美味单位。


### 提示

在这个例子中，Bessie 最优的策略是在 $x=7$ 的休息站休息 $7$ 秒（获得 $14$ 个美味单位），然后在 $x=8$ 的休息站再休息 $1$ 秒（获得 $1$ 个美味单位，总共 $15$ 个美味单位）。


---

---
title: "[USACO18OPEN] Out of Sorts S"
layout: "post"
diff: 普及/提高-
pid: P4378
tag: ['2018', 'USACO', '树状数组', '排序']
---
# [USACO18OPEN] Out of Sorts S
## 题目描述

留意着农场之外的长期职业生涯的可能性，奶牛 Bessie 开始在不同的在线编程网站上学习算法。

她到目前为止最喜欢的算法是“冒泡排序”。这是 Bessie 的对长度为 $N$ 的数组 $A$ 进行排序的奶牛码实现。

```
sorted = false
while (not sorted):
   sorted = true
   moo
   for i = 0 to N-2:
      if A[i+1] < A[i]:
         swap A[i], A[i+1]
         sorted = false
```
显然，奶牛码中的“moo”指令的作用只是输出“moo”。奇怪的是，Bessie 看上去执着于在她的代码中的不同位置使用这个语句。

给定一个输入数组，请预测 Bessie 的代码会输出多少次“moo”。
## 输入格式

输入的第一行包含 $N$（$1 \leq N \leq 100,000$）。接下来 $N$ 行描述了 $A[0] \ldots A[N-1]$，每个数都是一个范围为 $0 \ldots 10^9$ 的整数。输入数据不保证各不相同。
## 输出格式

输出“moo”被输出的次数。
## 样例

### 样例输入 #1
```
5
1
5
3
8
2
```
### 样例输出 #1
```
4

```
## 提示

供题：Brian Dean


---

---
title: "[USACO15DEC] Fruit Feast G"
layout: "post"
diff: 普及/提高-
pid: P4817
tag: ['2015', 'USACO', '枚举']
---
# [USACO15DEC] Fruit Feast G
## 题目描述

Bessie has broken into Farmer John's house again! She has discovered a pile of lemons and a pile of oranges in the kitchen (effectively an unlimited number of each), and she is determined to eat as much as possible.

Bessie has a maximum fullness of $T$ $(1 ≤ T ≤ 5,000,000)$. Eating an orange increases her fullness by $A$, and eating a lemon increases her fullness by $B$ ($1 ≤ A,B ≤ T$). Additionally, if she wants, Bessie can drink water at most one time, which will instantly decrease her fullness by half (and will round down).

Help Bessie determine the maximum fullness she can achieve! 
## 输入格式

The first (and only) line has three integers $T$, $A$, and $B$. 
## 输出格式

 A single integer, representing the maximum fullness Bessie can achieve. 
## 样例

### 样例输入 #1
```
8 5 6
```
### 样例输出 #1
```
8
```
## 提示

Problem credits: Nathan Pinsker 
## 题目翻译

### 题目描述

Bessie 再次闯入了 Farmer John 的房屋！她在厨房发现了一堆柠檬和一堆橙子（每种水果的数量都可以视为无限），并决定尽可能多吃。

Bessie 的最大饱腹度为 $T$（$1 \leq T \leq 5,000,000$）。每吃一个橙子会使饱腹度增加 $A$，每吃一个柠檬会使饱腹度增加 $B$（$1 \leq A,B \leq T$）。此外，Bessie 最多可以喝一次水，这将使饱腹度立即减半（向下取整）。

请帮助 Bessie 计算她能达到的最大饱腹度！

### 输入格式

唯一一行包含三个整数 $T$、$A$ 和 $B$。

### 输出格式

输出一个整数，表示 Bessie 能达到的最大饱腹度。

### 说明/提示

题目提供者：Nathan Pinsker  


---

---
title: "[USACO15FEB] Cow Hopscotch S"
layout: "post"
diff: 普及/提高-
pid: P4825
tag: ['2015', 'USACO', '枚举', '前缀和']
---
# [USACO15FEB] Cow Hopscotch S
## 题目描述

Just like humans enjoy playing the game of Hopscotch, Farmer John's cows have invented a variant of the game for themselves to play. Being played by clumsy animals weighing nearly a ton, Cow Hopscotch almost always ends in disaster, but this has surprisingly not deterred the cows from attempting to play nearly every afternoon.

The game is played on an $R$ by $C$ grid $(2 <= R <= 100,$ $2 <= C <= 100)$, where each square is labeled with an integer in the range $1...K (1 <= K <= R * C)$. Cows start in the top-left square and move to the bottom-right square by a sequence of jumps, where a jump is valid if and only if:

1. You are jumping to a square labeled with a different integer than your current square,

2. The square that you are jumping to is at least one row below the current square that you are on, and

3. The square that you are jumping to is at least one column to the right of the current square that you are on.

Please help the cows compute the number of different possible sequences of valid jumps that will take them from the top-left square to the bottom-right square.
## 输入格式

The first line contains the integers $R, C,$ and $K$. The next $R$ lines will each contain $C$ integers, each in the range $1..K$.
## 输出格式

Output the number of different ways one can jump from the top-left square to the bottom-right square, mod $1000000007$. 
## 样例

### 样例输入 #1
```
4 4 4
1 1 1 1
1 3 2 1
1 2 4 1
1 1 1 1
```
### 样例输出 #1
```
5
```
## 题目翻译

### 题目描述

与人类喜欢玩跳格子游戏类似，Farmer John 的奶牛们也发明了自己的版本。游戏在一个 $R \times C$ 的网格上进行（$2 \leq R,C \leq 100$），每个格子标有 $1 \ldots K$ 的整数（$1 \leq K \leq R \times C$）。奶牛从左上角出发，通过一系列有效跳跃到达右下角。跳跃被定义为有效当且仅当满足以下条件：

1. 目标格子与当前格子的数字不同  
2. 目标格子位于当前格子下方至少一行  
3. 目标格子位于当前格子右侧至少一列  

请计算从左上角到右下角的不同有效跳跃路径总数。

### 输入格式

第一行包含三个整数 $R$, $C$, $K$。  
接下来 $R$ 行每行包含 $C$ 个整数，每个数在 $1 \ldots K$ 范围内。

### 输出格式

输出从左上角到右下角的不同路径数量，结果对 $1000000007$ 取模。


---

---
title: "[USACO15FEB] Superbull S"
layout: "post"
diff: 普及/提高-
pid: P4826
tag: ['2015', 'USACO', '图论建模', '生成树']
---
# [USACO15FEB] Superbull S
## 题目描述

Bessie and her friends are playing hoofball in the annual Superbull championship, and Farmer John is in charge of making the tournament as exciting as possible. A total of $N$ $(1 <= N <= 2000)$ teams are playing in the Superbull. Each team is assigned a distinct integer team ID in the range 1...2^30-1 to distinguish it from the other teams. The Superbull is an elimination tournament -- after every game, Farmer John chooses which team to eliminate from the Superbull, and the eliminated team can no longer play in any more games. The Superbull ends when only one team remains.

Farmer John notices a very unusual property about the scores in matches! In any game, the combined score of the two teams always ends up being the bitwise exclusive OR (XOR) of the two team IDs. For example, if teams 12 and 20 were to play, then 24 points would be scored in that game, since 01100 XOR 10100 = 11000.

Farmer John believes that the more points are scored in a game, the more exciting the game is. Because of this, he wants to choose a series of games to be played such that the total number of points scored in the Superbull is maximized. Please help Farmer John organize the matches.
## 输入格式

The first line contains the single integer $N$. The following $N$ lines contain the N team IDs.
## 输出格式

Output the maximum possible number of points that can be scored in the Superbull.
## 样例

### 样例输入 #1
```
4
3
6
9
10
```
### 样例输出 #1
```
37
```
## 提示

OUTPUT DETAILS: One way to achieve 37 is as follows: FJ matches teams 3 and 9, and decides that 9 wins, so teams 6, 9, and 10 are left in the tournament. He then matches teams 6 and 9, and lets team 6 win. Teams 6 and 10 are then left in the tournament. Finally, teams 6 and 10 face off, and team 10 wins. The total number of points scored is (3 XOR 9) + (6 XOR 9) + (6 XOR 10) = 10 + 15 + 12 = 37.

NOTE: The bitwise exclusive OR operation, commonly denoted by the ^ symbol, is a bitwise operation that performs the logical exclusive OR operation on each position in two binary integers. The result in each position is 1 if only the first bit is 1 or only the second bit is 1, but is 0 if both bits are 0 or both are 1. For example: 10100 (decimal 20) XOR 01100 (decimal 12) = 11000 (decimal 24)

[Problem credits: Alex Yang, 2015] 
## 题目翻译

### 题目描述

Bessie 和她的朋友们正在一年一度的 Superbull 锦标赛中比赛，Farmer John 负责让比赛尽可能精彩。总共有 $N$ $(1 \leq N \leq 2000)$ 支队伍参加 Superbull。每支队伍都被分配了一个唯一的整数队伍 ID，范围在 $1 \ldots 2^{30}-1$ 之间，用于区分不同队伍。Superbull 是淘汰制比赛——每场比赛后，Farmer John 会选择淘汰其中一支队伍，被淘汰的队伍将不再参与后续比赛。当只剩一支队伍时，Superbull 结束。

Farmer John 发现比赛得分有一个特殊性质：任意一场比赛中，两支队伍的得分总和总是等于两队 ID 的按位异或（XOR）。例如，若队伍 12 和 20 比赛，则该场比赛总得分为 $24$，因为 $01100 \oplus 10100 = 11000$（即 $12 \oplus 20 = 24$）。

Farmer John 认为比赛总得分越高越精彩。因此，他希望安排一系列比赛，使得 Superbull 所有比赛的总得分最大化。请帮助他设计比赛方案。

### 输入格式

第一行包含整数 $N$。接下来的 $N$ 行每行包含一个队伍 ID。

### 输出格式

输出 Superbull 所有比赛可能获得的最大总得分。

### 说明/提示

**输出样例解释**：  
一种获得 37 分的方案如下：  
1. Farmer John 让队伍 3 和 9 比赛，选择淘汰 9，此时剩余队伍为 6、9、10  
2. 让队伍 6 和 9 比赛，选择淘汰 9，此时剩余队伍为 6 和 10  
3. 最后让队伍 6 和 10 比赛  
总得分为 $(3 \oplus 9) + (6 \oplus 9) + (6 \oplus 10) = 10 + 15 + 12 = 37$。

**关于按位异或**：  
按位异或运算（记作 $\oplus$）对两个二进制数的每一位进行逻辑异或操作。当且仅当某一位上两个数不同时，结果的该位为 1。例如：  
$10100$（十进制 20）$\oplus$ $01100$（十进制 12）$= 11000$（十进制 24）


---

---
title: "[USACO14JAN] Cross Country Skiing S"
layout: "post"
diff: 普及/提高-
pid: P4955
tag: ['2014', 'USACO']
---
# [USACO14JAN] Cross Country Skiing S
## 题目描述

The cross-country skiing course at the winter Moolympics is described by an $M * N$ grid of elevations (1 <= M,N <= 500), each elevation being in the range 0 .. 1,000,000,000.  

Some of the cells in this grid are designated as waypoints for the course.  The organizers of the Moolympics want to assign a difficulty rating $D$ to the entire course so that a cow can reach any waypoint from any other waypoint by repeatedly skiing from a cell to an adjacent cell with absolute elevation difference at most $D$.  Two cells are adjacent if one is directly north, south, east, or west of the other.  The difficulty rating of the course is the minimum value of $D$ such that all waypoints are mutually reachable in this fashion.
## 输入格式

* Line 1: The integers $M$ and $N$.

* Lines 2..1+M: Each of these $M$ lines contains $N$ integer elevations.

* Lines 2+M..1+2M: Each of these $M$ lines contains $N$ values that are either $0$ or $1$, with $1$ indicating a cell that is a waypoint.
## 输出格式

The ski course is described by a 3 x 5 grid of elevations.  The upper-left, upper-right, and lower-right cells are designated as waypoints.
## 样例

### 样例输入 #1
```
3 5
20 21 18 99 5
19 22 20 16 26
18 17 40 60 80
1 0 0 0 1
0 0 0 0 0
0 0 0 0 1
```
### 样例输出 #1
```
21
```
## 提示

If D = 21, the three waypoints are reachable from each-other.  If D < 21, then the upper-right waypoint cannot be reached from the other two.
## 题目翻译

乡村越野滑雪比赛在一个 m×n (1<=m,n<=500）的二维表格中进行，每个格子的海拔在 0 至 1000000000 之间。滑雪者可以从一个格子滑到相邻格子，（可以从高处滑到低处，也可以从低处滑到高处），难度值 D 是两者之间的海拔差的绝对值。相邻的格子是指有公共边的格子。一条路径的难度值是指该路径上相邻两格子的难度值的最大值。现在给出若干个关键格子，求所有这些关键格子相互可达的最小的难度值 D。


---

---
title: "[USACO04OPEN] Cave Cows 2"
layout: "post"
diff: 普及/提高-
pid: P5097
tag: ['2004', 'USACO']
---
# [USACO04OPEN] Cave Cows 2
## 题目描述

洞窟里有一道长长的通道．它由 $ N $ ( $ 1 \leq N \leq 25000 $ )段道尾相连构成，编号分别为 $ 1 \ldots N $ 。

每个通道有一个阈值，其范围在 $ [1,10^9] $ 。依次通过 $ i \ldots j $ 的通道，那奶牛的体重指数就不能超过 $ i \ldots j $ 通道中阈值的最小值。贝茜有 
$ Q $ ( $ 1 \leq Q \leq 25000 $ )个问题，想请教你由 $ i $ 到 $ j $ 的通道的阈值的最小值。
## 输入格式

第1行输入 $ N $ 和 $ Q $ 。

接下来 $ N $ 行输入每个通道的阈值，之后 $ Q $ 行每行两个整数，对应问题中的 $ i $ 和 $ j $（ $ i<j $ ）。
## 输出格式

对于每个问题，输出其结果。
## 样例

### 样例输入 #1
```
10 4
75
30
100
38
50
51
52
20
81
5
1 10
3 5
6 9
8 10
```
### 样例输出 #1
```
5
38
20
5
```


---

---
title: "[USACO04OPEN] Cave Cows 3"
layout: "post"
diff: 普及/提高-
pid: P5098
tag: ['2004', 'USACO']
---
# [USACO04OPEN] Cave Cows 3
## 题目描述

约翰的 $ N $ ( $ 1 \leq N \leq 50000 $ )只牛在一个黑魃魃的洞里探险，他们只能通过叫声交流。

两只牛之间的曼哈顿距离决定了声音传播的时间。即牛1与牛2交流，需要的时间为
 $ |x_1-x_2|+|y_1-y_2| $ 。其中 $ -10^6 \leq x_1,x_2,y_1,y_2 \leq 10^6 $ 。

那任意一对牛之间交流时间的最大值为多少？
## 输入格式

第1行输入 $ N $ ，接下来每行输入一只牛的坐标。
## 输出格式

交流时间最大值（即最大曼哈顿距离）。
## 样例

### 样例输入 #1
```
5
1 1
3 5
2 7
8 1
4 4
```
### 样例输出 #1
```
12
```
## 提示

样例解释：

$ (2,7) $ 和 $ (8,1) $ 两点间的距离最大，为12。


---

---
title: "[USACO18DEC] Back and Forth B"
layout: "post"
diff: 普及/提高-
pid: P5118
tag: ['模拟', '搜索', '2018', 'USACO', '枚举']
---
# [USACO18DEC] Back and Forth B
## 题目描述

Farmer John 有两个挤奶棚，每个挤奶棚里各有一个奶罐和一个装有 $10$ 个各种尺寸的桶的储物柜。他喜欢将在两个挤奶棚之间来回运送牛奶作为一种锻炼方式。

周一，Farmer John 量了恰好 $1000$ 加仑的牛奶放在第一个挤奶棚的奶罐里，又量了恰好 $1000$ 加仑的牛奶放在第二个挤奶棚的奶罐里。

周二，他从第一个挤奶棚里取出一个桶，并装满牛奶，然后将牛奶运到第二个挤奶棚，并将牛奶倒进奶罐。他把这个桶留在了第二个挤奶棚。

周三，他从第二个挤奶棚里取出一个桶（可能是周二留在这里的），并装满牛奶，然后将牛奶运到第一个挤奶棚，并将牛奶倒进奶罐。他把这个桶留在了第一个挤奶棚。

周四，他从第一个挤奶棚里取出一个桶（可能是周三留在这里的），并装满牛奶，然后将牛奶运到第二个挤奶棚，并将牛奶倒进奶罐。他把这个桶留在了第二个挤奶棚。

周五，他从第二个挤奶棚里取出一个桶（可能是周二或周四留在这里的），并装满牛奶，然后将牛奶运到第一个挤奶棚，并将牛奶倒进奶罐。他把这个桶留在了第一个挤奶棚。

此时 Farmer John 测量了第一个挤奶棚的奶罐里的牛奶。他总共可能得到多少种不同的读数？

## 输入格式

输入的第一行包含 $10$ 个整数，为第一个挤奶棚里初始的桶的容积。输入的第二行也包含 $10$ 个整数，为第二个挤奶棚里初始的桶的容积。 所有桶的容积均在 $1\dots 100$ 的范围内。
## 输出格式

输出 Farmer John 在周五之后测量第一个挤奶棚里的奶罐的牛奶时可能得到的读数的数量。
## 样例

### 样例输入 #1
```
1 1 1 1 1 1 1 1 1 2
5 5 5 5 5 5 5 5 5 5
```
### 样例输出 #1
```
5
```
## 提示

在这个例子中，最后第一个挤奶棚的奶罐中的牛奶量总共有 $5$ 种可能的结果：

$1000$：FJ 可以在每次往返的时候都携带同一个桶，从而不会改变第一个挤奶棚的奶罐的牛奶量。

$1003$：FJ 可以在周二运送 $2$ 个单位，周三 $5$ 个单位，周四 $1$ 个单位，周五 $1$ 个单位。

$1004$：FJ 可以在周二运送 $1$ 个单位，周三 $5$ 个单位，周四 $1$ 个单位，周五 $1$ 个单位。

$1007$：FJ 可以在周二运送 $1$ 个单位，周三 $5$ 个单位，周四 $2$ 个单位，周五 $5$ 个单位。

$1008$：FJ 可以在周二运送 $1$ 个单位，周三 $5$ 个单位，周四 $1$ 个单位，周五 $5$ 个单位。


---

---
title: "[USACO18DEC] Convention S"
layout: "post"
diff: 普及/提高-
pid: P5119
tag: ['2018', '二分', 'USACO']
---
# [USACO18DEC] Convention S
## 题目描述

一场别开生面的牛吃草大会就要在 Farmer John 的农场举办了！

世界各地的奶牛将会到达当地的机场，前来参会并且吃草。具体地说，有 $N$ 头奶牛到达了机场（$1\le N\le 10^5$），其中奶牛 $i$ 在时间 $t_i$（$0\le t_i\le 10^9$）到达。Farmer John 安排了 $M$（$1\le M\le 10^5$）辆大巴来机场接这些奶牛。每辆大巴可以乘坐 $C$ 头奶牛（$1\le C\le N$）。Farmer John 正在机场等待奶牛们到来，并且准备安排到达的奶牛们乘坐大巴。当最后一头乘坐某辆大巴的奶牛到达的时候，这辆大巴就可以发车了。Farmer John 想要做一个优秀的主办者，所以并不想让奶牛们在机场等待过长的时间。如果 Farmer John 合理地协调这些大巴，等待时间最长的奶牛等待的时间的最小值是多少？一头奶牛的等待时间等于她的到达时间与她乘坐的大巴的发车时间之差。

输入保证 $MC\ge N$。
## 输入格式

输入的第一行包含三个空格分隔的整数 $N$，$M$，和 $C$。第二行包含 $N$ 个空格分隔的整数，表示每头奶牛到达的时间。
## 输出格式

输出一行，包含所有到达的奶牛中的最大等待时间的最小值。
## 样例

### 样例输入 #1
```
6 3 2
1 1 10 14 4 3
```
### 样例输出 #1
```
4
```
## 提示

如果两头时间 $1$ 到达的奶牛乘坐一辆巴士，时间 $3$ 和时间 $4$ 到达的奶牛乘坐乘坐第二辆，时间 $10$ 和时间 $14$ 到达的奶牛乘坐第三辆，那么等待时间最长的奶牛等待了 $4$ 个单位时间（时间 $10$ 到达的奶牛从时间 $10$ 等到了时间 $14$）。


---

---
title: "[USACO18DEC] Convention II S"
layout: "post"
diff: 普及/提高-
pid: P5120
tag: ['模拟', '2018', 'USACO', '堆']
---
# [USACO18DEC] Convention II S
## 题目描述

虽然在接机上耽误了挺长时间，Farmer John 为吃草爱好牛们举行的大会至今为止都非常顺利。大会吸引了世界各地的奶牛。

然而大会的重头戏看起来却给 Farmer John 带来了一些新的安排上的困扰。他的农场上的一块非常小的牧草地出产一种据某些识货的奶牛说是世界上最美味的品种的草。因此，所有参会的 $N$ 头奶牛（$1\le N\le 10^5$）都想要品尝一下这种草。由于这块牧草地小到仅能容纳一头奶牛，这很有可能会导致排起长龙。

Farmer John 知道每头奶牛i计划到达这块特殊的牧草地的时间 $a_i$，以及当轮到她时，她计划品尝这种草花费的时间 $t_i$。当奶牛 $i$ 开始吃草时，她会在离开前花费全部 $t_i$ 的时间，此时其他到达的奶牛需要排队等候。如果这块牧草地空出来的时候多头奶牛同时在等候，那么资历最深的奶牛将会是下一头品尝鲜草的奶牛。在这里，恰好在另一头奶牛吃完草离开时到达的奶牛被认为是“在等待的”。类似地，如果当没有奶牛在吃草的时候有多头奶牛同时到达，那么资历最深的奶牛是下一头吃草的奶牛。

请帮助 FJ 计算所有奶牛中在队伍里等待的时间（$a_i$ 到这头奶牛开始吃草之间的时间）的最大值。
## 输入格式

输入的第一行包含 $N$。以下 $N$ 行按资历顺序给出了 $N$ 头奶牛的信息（资历最深的奶牛排在最前面）。每行包含一头奶牛的 $a_i$ 和 $t_i$。所有的 $t_i$ 为不超过 $10^4$ 的正整数，所有 $a_i$ 为不超过 $10^9$ 的正整数。
## 输出格式

输出所有奶牛中的最长等待时间。
## 样例

### 样例输入 #1
```
5
25 3
105 30
20 50
10 17
100 10
```
### 样例输出 #1
```
10
```
## 提示

在这个例子中，我们有 $5$ 头奶牛（按输入中的顺序编号为 $1\dots 5$）。奶牛 $4$ 最先到达（时间 $10$），在她吃完之前（时间 $27$）奶牛 $1$ 和奶牛 $3$ 都到达了。由于奶牛 $1$ 拥有较深的资历，所以她先吃，从她到达开始共计等待了 $2$ 个单位时间。她在时间 $30$ 结束吃草，随后奶牛 $3$ 开始吃草，从她到达开始共计等待了 $10$ 单位时间。在一段没有奶牛吃草的时间过后，奶牛 $5$ 到达，在她正在吃草的时间里奶牛 $2$ 也到达了，在 $5$ 个单位时间之后能够吃到草。相比到达时间等待最久的奶牛是奶牛 $3$。


---

---
title: "[USACO05DEC] Scales S"
layout: "post"
diff: 普及/提高-
pid: P5194
tag: ['搜索', '2005', 'USACO']
---
# [USACO05DEC] Scales S
## 题目描述

约翰有一架用来称牛的体重的天平。与之配套的是 $ N \ ( 1 \leq N \leq 1000 ) $ 个已知质量的砝码（所有砝码质量的数值都在 $32$ 位带符号整数范围内）。

每次称牛时，他都把某头奶牛安置在天平的某一边，然后往天平另一边加砝码，直到天平平衡，于是此时砝码的总质量就是牛的质量（约翰不能把砝码放到奶牛的那边，因为奶牛不喜欢称体重，每当约翰把砝码放到她的蹄子底下，她就会尝试把砝码踢到约翰脸上）。

天平能承受的物体的质量不是无限的，当天平某一边物体的质量大于 $ C \ ( 1 \leq C \leq 2^{30} ) $ 时，天平就会被损坏。砝码按照它们质量的大小被排成一行。并且，这一行中从第 $3$ 个砝码开始，每个砝码的质量至少等于前面两个砝码（也就是质量比它小的砝码中质量最大的两个）的质量的和。

约翰想知道，用他所拥有的这些砝码以及这架天平，能称出的质量最大是多少。由于天平的最大承重能力为 $C$，他不能把所有砝码都放到天平上。

现在约翰告诉你每个砝码的质量，以及天平能承受的最大质量，你的任务是选出一些砝码，使它们的质量和在不压坏天平的前提下是所有组合中最大的。
## 输入格式

第 $1$ 行输入两个用空格隔开的正整数 $ N $ 和 $ C $。

第 $2$ 到 $ N+1 $ 行：每一行仅包含一个正整数，即某个砝码的质量。保证这些砝码的质量是一个不下降序列。
## 输出格式

输出一个正整数，表示用所给的砝码能称出的不压坏天平的最大质量。
## 样例

### 样例输入 #1
```
3 15
1
10
20

```
### 样例输出 #1
```
11
```


---

---
title: "[USACO19JAN] Grass Planting S"
layout: "post"
diff: 普及/提高-
pid: P5197
tag: ['图论', '2019', 'USACO']
---
# [USACO19JAN] Grass Planting S
## 题目背景

USACO 一月月赛银组第一题
## 题目描述

到了一年中 Farmer John 在他的草地里种草的时间了。整个农场由 $N$ 块草地组成（$1 \leq N \leq 10^5$），方便起见编号为 $1 \ldots N$，由 $N-1$ 条双向的小路连接，每块草地都可以经过一些小路到达其他所有的草地。
Farmer John 当然可以在每块草地里种不同种类的草，但是他想要使得使用的草的种类数最小，因为他用的草的种类数越多，他就需要负担更高的花费。

不幸的是，他的奶牛们对选择农场上的草表现得十分苛刻。如果两块相邻（由一条小路直接相连）的草地种了同一种草，或者即使是两块接近相邻（均可由一条小路直接连向同一块草地）的草地，那么奶牛们就会抱怨她们进餐的选择不够多样。Farmer John 能做的只能是抱怨这些奶牛，因为他知道她们不能被满足的时候会制造多大的麻烦。

请帮助 Farmer John 求出他的整个农场所需要的最少的草的种类数。
## 输入格式

输入的第一行包含 $N$。以下 $N-1$ 行每行描述了一条小路连接的两块草地。
## 输出格式

输出 Farmer John 需要使用的最少的草的种类数。
## 样例

### 样例输入 #1
```
4
1 2
4 3
2 3
```
### 样例输出 #1
```
3
```
## 提示

在这个简单的例子中，4 块草地以一条直线的形式相连。最少需要三种草。例如，Farmer John 可以用草 $A,B,C$ 将草地按 $A - B - C - A$ 的方式播种。


---

---
title: "[USACO19JAN] Icy Perimeter S"
layout: "post"
diff: 普及/提高-
pid: P5198
tag: ['搜索', '2019', 'USACO', '深度优先搜索 DFS']
---
# [USACO19JAN] Icy Perimeter S
## 题目背景

USACO 一月月赛银组第二题
## 题目描述

Farmer John 要开始他的冰激凌生意了！他制造了一台可以生产冰激凌球的机器，然而不幸的是形状不太规则，所以他现在希望优化一下这台机器，使其产出的冰激凌球的形状更加合理。
机器生产出的冰激凌的形状可以用一个 $N \times N$（$1 \leq N \leq 1000$）的矩形图案表示，例如：

```
##....
....#.
.#..#.
.#####
...###
....##
```

每个 `.` 字符表示空的区域，每个 `#` 字符表示一块 $1 \times 1$ 的正方形格子大小的冰激凌。

不幸的是，机器当前工作得并不是很正常，可能会生产出多个互不相连的冰激凌球（上图中有两个）。一个冰激凌球是连通的，如果其中每个冰激凌的正方形格子都可以从这个冰激凌球中其他所有的冰激凌格子出发重复地前往东、南、西、北四个方向上相邻的冰激凌格子所到达。

Farmer John 想要求出他的面积最大的冰激凌球的面积和周长。冰激凌球的面积就是这个冰激凌球中 `#` 的数量。如果有多个冰激凌球并列面积最大，他想要知道其中周长最小的冰激凌球的周长。在上图中，小的冰激凌球的面积为 $2$，周长为 $6$，大的冰激凌球的面积为 $13$，周长为 $22$。

注意一个冰激凌球可能在中间有“洞”（由冰激凌包围着的空的区域）。如果这样，洞的边界同样计入冰激凌球的周长。冰激凌球也可能出现在被其他冰激凌球包围的区域内，在这种情况下它们计为不同的冰激凌球。例如，以下这种情况包括一个面积为 $1$ 的冰激凌球，被包围在一个面积为 $16$ 的冰激凌球内：

```
#####
#...#
#.#.#
#...#
#####
```

同时求得冰激凌球的面积和周长十分重要，因为 Farmer John 最终想要最小化周长与面积的比值，他称这是他的冰激凌的“冰周率”。当这个比率较小的时候，冰激凌化得比较慢，因为此时冰激凌单位质量的表面积较小。

## 输入格式

输入的第一行包含 $N$，以下 $N$ 行描述了机器的生产结果。其中至少出现一个 `#` 字符。
## 输出格式

输出一行，包含两个空格分隔的整数，第一个数为最大的冰激凌球的面积，第二个数为它的周长。如果多个冰激凌球并列面积最大，输出其中周长最小的那一个的信息。
## 样例

### 样例输入 #1
```
6
##....
....#.
.#..#.
.#####
...###
....##
```
### 样例输出 #1
```
13 22
```


---

---
title: "[USACO19JAN] Mountain View S"
layout: "post"
diff: 普及/提高-
pid: P5199
tag: ['贪心', '2019', 'USACO', '排序']
---
# [USACO19JAN] Mountain View S
## 题目背景

USACO 2019 年一月月赛银组第三题
## 题目描述

从农场里奶牛 Bessie 的牧草地向远端眺望，可以看到巍峨壮丽的山脉绵延在地平线上。山脉里由 $N$ 座山峰（$1≤N≤10^5$）。如果我们把 Bessie 的视野想象成 $xy$ 平面，那么每座山峰都是一个底边在 $x$ 轴上的三角形。山峰的两腰均与底边成 $45$ 度角，所以山峰的峰顶是一个直角。于是山峰 $i$ 可以由它的峰顶坐标 $(x_i,y_i)$ 精确描述。没有两座山峰有完全相同的峰顶坐标。

Bessie 尝试数清所有的山峰，然而由于它们几乎是相同的颜色，所以如果一座山峰的峰顶在另一座山峰的三角形区域的边界上或是内部，她就无法看清。

请求出 Bessie 能够看见的不同的山峰的峰顶的数量，也就是山峰的数量。
## 输入格式

输入的第一行包含 $N$。以下 $N$ 行每行包含 $x_i$（$0\le x_i\le 10^9$）和$y_i$（$1\le y_i\le 10^9$），描述一座山峰的峰顶的坐标。
## 输出格式

输出 Bessie 能够分辨出的山峰的数量。
## 样例

### 样例输入 #1
```
3
4 6
7 2
2 5
```
### 样例输出 #1
```
2
```
## 提示

在这个例子中，Bessie 能够看见第一座和最后一座山峰。第二座山峰被第一座山峰掩盖了。


---

---
title: "[USACO19OPEN] Fence Planning S"
layout: "post"
diff: 普及/提高-
pid: P5429
tag: ['模拟', '2019', 'USACO', '并查集', '深度优先搜索 DFS']
---
# [USACO19OPEN] Fence Planning S
## 题目描述

Farmer John 的 $ N $ 头奶牛，编号为 $ 1 \ldots N $ （ $ 2 \leq N \leq 10^5 $ ），拥有一种围绕“哞网”，一些仅在组内互相交流却不与其他组进行交流的奶牛小组，组成的复杂的社交网络。

每头奶牛位于农场的二维地图上的不同位置 $ (x,y) $ ，并且我们知道有 $ M $ 对奶牛( $ 1 \leq M<10^5 $ )会相互哞叫。两头相互哞叫的奶牛属于同一哞网。

为了升级他的农场，Farmer John 想要建造一个四边与 $ x $ 轴和 $ y $ 轴平行的长方形围栏。Farmer John 想要使得至少一个哞网完全被围栏所包围（在长方形边界上的奶牛计为被包围的）。请帮助 Farmer John 求出满足他的要求的围栏的最小可能周长。有可能出现这一围栏宽为 $0$ 或高为 $0$ 的情况。
## 输入格式

输入的第一行包含 $ N $ 和 $ M $ 。以下 $ N $ 行每行包含一头奶牛的 $ x $ 坐标和 $ y $ 坐标（至多 $ 10^8 $ 的非负整数）。以下 $ M $ 行每行包含两个整数 $ a $ 和 $ b $ ，表示奶牛 $ a $ 和 $ b $ 之间有哞叫关系。每头奶牛都至少存在一个哞叫关系，并且输入中不会出现重复的哞叫关系。
## 输出格式

输出满足 Farmer John 的要求的围栏的最小周长。
## 样例

### 样例输入 #1
```
7 5
0 5
10 5
5 0
5 10
6 7
8 6
8 4
1 2
2 3
3 4
5 6
7 6
```
### 样例输出 #1
```
10
```


---

---
title: "[USACO19FEB] Sleepy Cow Herding S"
layout: "post"
diff: 普及/提高-
pid: P5541
tag: ['模拟', '贪心', '2019', 'USACO', '排序']
---
# [USACO19FEB] Sleepy Cow Herding S
## 题目描述

Farmer John 的 $N$ 头奶牛，总是会迷路走到农场上遥远的地方去！他需要你帮助将她们一起赶回来。

农场的草地大体是一块狭长的区域——我们可以将其想象成一条数轴，奶牛可以占据数轴上的任意整数位置。这 $N$ 头奶牛现在正位于不同的整数位置，Farmer John 想要移动她们，使得她们占据 $N$ 个相邻的位置（例如，位置 $6$、$7$、$8$）。

不幸的是，奶牛们现在很困，Farmer John 要让她们集中精力听从命令移动并不容易。任意时刻，他只能使得一头处在“端点”（在所有奶牛中位置最小或最大）位置的奶牛移动。当他移动奶牛时，他可以命令她走到任意一个未被占用的整数位置，只要在新的位置上她不再是一个端点。可以看到随着时间的推移，这样的移动可以使奶牛们趋向越来越近。

请求出使得奶牛们集中到相邻位置所进行的移动次数的最小和最大可能值。
## 输入格式

先输入一个整数 $N$（$N \leq 100000$），接下来输入 $N$ 个数，表示 $N$ 头奶牛的位置。
## 输出格式

输出的第一行包含 Farmer John 需要将奶牛们聚集起来所需进行的最小移动次数。第二行包含他将奶牛聚集起来能够进行的最大移动次数。
## 样例

### 样例输入 #1
```
3 
4 
7 
9
```
### 样例输出 #1
```
1
2
```
## 提示

2019 USACO 二月月赛银牌组第一题


---

---
title: "[USACO19FEB] Painting The Barn S"
layout: "post"
diff: 普及/提高-
pid: P5542
tag: ['2019', 'USACO', '前缀和']
---
# [USACO19FEB] Painting The Barn S
## 题目描述

农夫约翰不擅长多任务处理。他经常分心，很难完成长的项目。目前，他正试图在谷仓的一侧上漆，但他一直在画小矩形区域，然后由于照料奶牛的需要而偏离了方向，使得谷仓的某些部分上漆的涂料比其他部分多。

我们可以将谷仓的一侧描述为一个二维 $x-y$ 平面，农夫约翰在该平面上绘制 $n$ 个矩形，每个矩形的边都与坐标轴平行，每个矩形由谷仓的左下角和右上角点的坐标描述。

农夫约翰想在谷仓上涂几层油漆，这样在不久的将来就不需要再重新粉刷了。但是，他不想浪费时间涂太多的油漆。结果表明，$K$ 涂层是最佳用量。请在他画完所有的长方形后，帮他确定谷仓有多少面积被 $K$ 层油漆覆盖。
## 输入格式

输入的第一行包含 $n$ 和 $K$。

其余 $n$ 行中的每一行包含四个整数 $x_1$、$y_1$、$x_2$、$y_2$，描述正在绘制的矩形区域，左下角 $(x_1,y_1)$ 和右上角 $(x_2,y_2)$。所有 $x$ 和 $y$ 值都在 $0$ 到 $1000$ 范围内，并且所有矩形都有正面积。
## 输出格式

请输出谷仓被 $K$ 层油漆覆盖的区域。
## 样例

### 样例输入 #1
```
3 2
1 1 5 5
4 4 7 6
3 3 8 7
```
### 样例输出 #1
```
8
```
## 提示

$1\le K\le n\le 10^5$。

USACO 2019 二月月赛银牌组第二题。


---

---
title: "[USACO20JAN] Berry Picking S"
layout: "post"
diff: 普及/提高-
pid: P6002
tag: ['2020', 'USACO', '枚举']
---
# [USACO20JAN] Berry Picking S
## 题目描述

Bessie 和她的妹妹 Elsie 正在 Farmer John 的浆果园里采浆果。Farmer John 的浆果园里有 $N$ 棵浆果树（$1 \leq N \leq 1000$）；树 $i$ 上有 $B_i$ 个浆果（$1 \leq B_i \leq 1000$）。Bessie 有 $K$ 个篮子（$1 \leq K \leq 1000$，$K$ 为偶数）。每个篮子里可以装同一棵树上采下的任意多个浆果，但是不能装来自于不同的树上的浆果，因为它们的口味可能不同。篮子里也可以不装浆果。

Bessie 想要使得她得到的浆果数量最大。但是，Farmer John 希望 Bessie 与她的妹妹一同分享，所以 Bessie 必须将浆果数量较多的 $K/2$ 个篮子给 Elsie。这表示 Elsie 很有可能最后比 Bessie 得到更多的浆果，这十分不公平，然而姐妹之间往往就是这样。

帮助 Bessie 求出她最多可以得到的浆果数量。
## 输入格式

输入的第一行包含空格分隔的整数 $N$ 和 $K$。

第二行包含 $N$ 个空格分隔的整数 $B_1,B_2,\ldots,B_N$。
## 输出格式

输出一行答案。
## 样例

### 样例输入 #1
```
5 4
3 6 8 4 2
```
### 样例输出 #1
```
8
```
## 提示

### 样例解释

如果 Bessie 在

- 一个篮子里装树 2 的 6 个浆果
- 两个篮子里每个装树 3 的 4 个浆果
- 一个篮子里装树 4 的 4 个浆果

那么她能够得到两个各装有 4 个浆果的篮子，总共 8 个浆果。

### 子任务

- 测试点 $1 \sim 4$ 满足 $K \leq 10$。
- 测试点 $5 \sim 11$ 没有额外限制。


---

---
title: "[USACO05JAN] Moo Volume S"
layout: "post"
diff: 普及/提高-
pid: P6067
tag: ['2005', 'USACO']
---
# [USACO05JAN] Moo Volume S
## 题目描述

Farmer John 的农场上有 $N$ 头奶牛（$1 \leq N \leq 10^5$），第 $i$ 头奶牛的位置为 $x_i$（$0 \leq x_i \leq 10^9$）。

奶牛很健谈，每头奶牛都和其他 $N-1$ 头奶牛聊天。第 $i$ 头奶牛和第 $j$ 头奶牛聊天时，音量为 $|x_i-x_j|$。

请您求出所有奶牛聊天音量的总和。
## 输入格式

第一行一个整数 $N$。

接下来 $N$ 行，每行一个整数 $x_i$。
## 输出格式

输出总音量。

**保证答案在 64 位带符号整数的表示范围内。**
## 样例

### 样例输入 #1
```
5
1
5
3
2
4
```
### 样例输出 #1
```
40
```
## 提示

- 子任务 1（原测试数据，1 分）：$N \leq 10^4$；
- 子任务 2（99 分）：无特殊限制。


---

---
title: "[USACO19FEB] Dishwashing G"
layout: "post"
diff: 普及/提高-
pid: P6099
tag: ['2019', '二分', 'USACO', '栈']
---
# [USACO19FEB] Dishwashing G
## 题目背景

Bessie 和 Elsie 正在帮助 Farmer John 洗碗，这是一个比人们想象的更复杂的过程。
## 题目描述

两头奶牛决定 Bessie 负责涂肥皂，Elsie 负责冲洗。

刚开始的时候，$N$ 个脏盘子（保证是从 $1$ 到 $N$ 的一个排列）堆在 Bessie 那里，而 Elsie 这边的堆是空的。而在她们俩之间，则有一张专门放涂过肥皂的盘子的桌子。

每个冲洗步骤需要执行以下两个操作之一：

- Bessie 从脏盘子堆顶取出一个盘子，涂上肥皂，然后放在桌子上。将这个盘子放在桌子上时，Bessie 只能放在现有的非空盘堆的顶端，或是在最右边新增一个盘堆。
- Elsie 从桌子最左边的盘堆的顶端拿起盘子，将它冲洗后放在干净的盘堆顶端。

她们希望干净的盘堆能按编号排序，编号最小的在底端，编号最大的在顶端。然而她们发现有的时候这并不可能做到。现在给定脏盘子的堆叠顺序，请你求出一个最大前缀，使得该前缀的所有盘子洗干净后，能按上面的要求堆叠。
## 输入格式

第一行一个整数 $N$（$1 \leq N \leq 10^5$）。

接下来 $N$ 行，每行一个整数，代表 Bessie 的脏盘子堆的堆叠顺序。输入的第一个盘子在堆的顶部。
## 输出格式

输出该序列的最大前缀长度，使得该前缀的所有盘子洗干净后，能按小号在下，大号在上的规则堆叠。
## 样例

### 样例输入 #1
```
5
4
5
2
3
1
```
### 样例输出 #1
```
4
```


---

---
title: "[USACO18JAN] MooTube S"
layout: "post"
diff: 普及/提高-
pid: P6111
tag: ['搜索', '2018', 'USACO', '并查集', '深度优先搜索 DFS']
---
# [USACO18JAN] MooTube S
## 题目背景

*本题与 [金组同名题目](/problem/P4185) 在题意上一致，唯一的差别是数据范围。*
## 题目描述

在业余时间，Farmer John 创建了一个新的视频共享服务，他将其命名为 MooTube。在 MooTube 上，Farmer John 的奶牛可以录制，分享和发现许多有趣的视频。他的奶牛已经发布了 $N$ 个视频（$1 \leq N \leq 5000$），为了方便将其编号为  $1 \ldots N$ 。然而，FJ 无法弄清楚如何帮助他的奶牛找到他们可能喜欢的新视频。

FJ 希望为每个 MooTube 视频创建一个“推荐视频”列表。这样，奶牛将被推荐与他们已经观看过的视频最相关的视频。

FJ 设计了一个“相关性”度量标准，顾名思义，它确定了两个视频相互之间的相关性。他选择 $N-1$ 对视频并手动计算其之间的相关性。然后，FJ 将他的视频建成一棵树，其中每个视频是节点，并且他手动将 $N-1$ 对视频连接。为了方便，FJ 选择了 $N-1$ 对，这样任意视频都可以通过一条连通路径到达任意其他视频。 FJ 决定将任意一对视频的相关性定义为沿此路径的任何连接的最小相关性。

Farmer John 想要选择一个 $K$ 值，以便在任何给定的 MooTube 视频旁边，推荐所有其他与该视频至少有 $K$ 相关的视频。然而，FJ 担心会向他的奶牛推荐太多的视频，这可能会分散他们对产奶的注意力！因此，他想设定适当的 $K$ 值。 Farmer John希望得到您的帮助，回答有关 $K$ 值的推荐视频的一些问题。
## 输入格式

第一行输入包含 $N$ 和 $Q$（$1 \leq Q \leq 5000$）。

接下来的 $N-1$ 行描述了 FJ 手动比较的一对视频。 每行包括三个整数  $p_i$，$q_i$ 和 $r_i$（$1 \leq p_i, q_i \leq N$，$1 \leq r_i \leq 10^9$），表示视频 $p_i$ 和 $q_i$ 已连接并且相关性为 $r_i$。

接下来的 $Q$ 行描述了 Farmer John 的 $Q$ 个问题。每行包含两个整数，$k_i$ 和 $v_i$（$1 \leq k_i \leq 10^9$，$1 \leq v_i \leq N$），表示 FJ 的第 $i$ 个问题询问中当 $K = k_i$ 时，第 $v_i$ 个视频推荐列表中将推荐的视频数。
## 输出格式

输出 $Q$ 行。在第 $i$ 行，输出 FJ 的第 $i$ 个问题的答案。
## 样例

### 样例输入 #1
```
4 3
1 2 3
2 3 2
2 4 4
1 2
4 1
3 1
```
### 样例输出 #1
```
3
0
2
```


---

---
title: "[USACO17JAN] Hoof, Paper, Scissor S"
layout: "post"
diff: 普及/提高-
pid: P6120
tag: ['2017', 'USACO']
---
# [USACO17JAN] Hoof, Paper, Scissor S
## 题目背景

*本题与 [金组同名题目](/problem/P3609) 在题意上一致，唯一的差别在于对变手势次数的限制。*
## 题目描述

你可能玩过“石头，剪刀，布”，这个游戏在奶牛中同样流行，不过它的名字变成了“蹄子，剪刀，布”。

“蹄子，剪刀，布”和“石头，剪刀，布”的规则十分类似，两只奶牛数到三，然后出一个代表蹄子，剪刀或布的手势。蹄子胜过剪刀，剪刀胜过布，布胜过蹄子。特别地，如果两只奶牛的手势相同，则视为平局。

现在 FJ 和 Bassie 要进行 $N$ 轮对抗。Bassie 已经预测了 FJ 每一轮要出的手势。然而 Bassie 很懒，她最多只想变换一次手势。

现在请你帮 Bassie 求出她最多能赢多少轮。
## 输入格式

第一行输入一个整数 $N$（$1 \leq N \leq 10^5$）。

接下来 $N$ 行，每行一个字母，代表 FJ 这一轮出的手势。`H` 代表蹄子（Hoof），`S` 代表剪刀（Scissors），`P` 代表布（Paper）。
## 输出格式

输出一个整数，代表 Bassie 在最多变换一次手势的前提下最多赢多少轮。
## 样例

### 样例输入 #1
```
5
P
P
H
P
S
```
### 样例输出 #1
```
4
```


---

---
title: "[USACO07NOV] Best Cow Line S"
layout: "post"
diff: 普及/提高-
pid: P6140
tag: ['2007', 'USACO']
---
# [USACO07NOV] Best Cow Line S
## 题目背景

*本题和 [2007 年 12 月月赛金组同名题目](/problem/P2870) 在题意上一致，唯一的差别是数据范围。*
## 题目描述

Farmer John 打算带领 $N$（$1 \leq N \leq 2\,000$）头奶牛参加一年一度的”全美农场主大奖赛“。在这场比赛中，每个参赛者必须让他的奶牛排成一列，然后带领这些奶牛从裁判面前依此走过。

今年，竞赛委员会在接受报名时，采用了一种新的登记规则：取每头奶牛名字的首字母，按照它们在队伍中的次序排成一列。将所有队伍的名字按字典序升序排序，从而得到出场顺序。

FJ 由于事务繁忙，他希望能够尽早出场。因此他决定重排队列。

他的调整方式是这样的：每次，他从原队列的首端或尾端牵出一头奶牛，将她安排到新队列尾部。重复这一操作直到所有奶牛都插入新队列为止。

现在请你帮 FJ 算出按照上面这种方法能排出的字典序最小的队列。
## 输入格式

第一行一个整数 $N$。

接下来 $N$ 行每行一个大写字母，表示初始队列。
## 输出格式

输出一个长度为 $N$ 的字符串，表示可能的最小字典序队列。

每输出 $80$ 个字母需要一个换行。
## 样例

### 样例输入 #1
```
6
A
C
D
B
C
B
```
### 样例输出 #1
```
ABCBCD
```


---

---
title: "[USACO20FEB] Timeline G"
layout: "post"
diff: 普及/提高-
pid: P6145
tag: ['图论', '2020', 'USACO', '拓扑排序', '差分约束']
---
# [USACO20FEB] Timeline G
## 题目描述

Bessie 在过去的 $M$ 天内参加了 $N$ 次挤奶。但她已经忘了她每次挤奶是在哪个时候了。

对于第 $i$ 次挤奶，Bessie 记得它不早于第 $S_i$ 天进行。另外，她还有 $C$ 条记忆，每条记忆形如一个三元组 $(a,b,x)$，含义是第 $b$ 次挤奶在第 $a$ 次挤奶结束至少 $x$ 天后进行。

现在请你帮 Bessie 算出在满足所有条件的前提下，每次挤奶的最早日期。

保证 Bessie 的记忆没有错误，这意味着一定存在一种合法的方案，使得：

- 第 $i$ 次挤奶不早于第 $S_i$ 天进行，且不晚于第 $M$ 天进行；
- 所有的记忆都得到满足；
## 输入格式

第一行三个整数 $N,M,C$。保证 $1 \leq N,C \leq 10^5$，$2 \leq M \leq 10^9$。

接下来一行包含 $N$ 个整数 $S_1, S_2 , \ldots, S_n$，保证 $\forall 1 \leq i \leq n$，都满足 $1 \leq S_i \leq M$。

下面 $C$ 行每行三个整数 $a,b,x$，描述一条记忆。保证 $a \neq b$，且 $1 \leq x \leq M$。
## 输出格式

输出 $N$ 行，每行一个整数，第 $i$ 行的数表示第 $i$ 次挤奶的最早日期。
## 样例

### 样例输入 #1
```
4 10 3
1 2 3 4
1 2 5
2 4 2
3 4 4
```
### 样例输出 #1
```
1
6
3
8
```
## 提示

- 测试点 $2 \sim 4$ 满足 $N,C \leq 10^3$。
- 测试点 $5 \sim 10$ 没有特殊限制。


---

---
title: "[USACO16JAN] Angry Cows S"
layout: "post"
diff: 普及/提高-
pid: P6174
tag: ['2016', '二分', 'USACO']
---
# [USACO16JAN] Angry Cows S
## 题目描述

Bessie 设计了一款新游戏：*Angry Cows*。在这个游戏中，玩家发射奶牛，每头奶牛落地时引爆一定范围内的干草。游戏的目标是使用一组奶牛引爆所有干草。

$N$ 捆干草排列在数轴上的不同位置。第 $i$ 捆干草的的位置为 $x_i$。如果一个威力为 $R$ 的奶牛在 $x$ 位置落地，她将引爆 $[x-R,x+R]$ 范围内的所有干草。

你现在可以发射 $K$ 头奶牛，每头奶牛的威力都是 $R$，现在你需要确定 $R$ 的最小值，使得用 $K$ 头奶牛可以引爆所有干草。
## 输入格式

第一行两个整数 $N,K$（$1 \leq N \leq 5 \times 10^4$，$1 \leq K \leq 10$）。

接下来 $N$ 行，第 $i$ 行一个整数 $x_i$（$0 \leq x_i \leq 10^9$）。
## 输出格式

输出一个整数，即 $R$ 的最小值。
## 样例

### 样例输入 #1
```
7 2
20
25
18
8
10
3
1
```
### 样例输出 #1
```
5
```


---

---
title: "[USACO15DEC] High Card Wins S"
layout: "post"
diff: 普及/提高-
pid: P6179
tag: ['贪心', '2015', 'USACO', '排序']
---
# [USACO15DEC] High Card Wins S
## 题目描述

Bessie 是纸牌游戏的忠实粉丝。对她而言，其他奶牛都算不上对手。更糟糕的是，其他奶牛在打牌时的行为都是完全能预测的。尽管如此，Bessie 知道取胜仍然是个挑战。

Bessie 和她的朋友 Elsie 正在玩一种纸牌游戏。这个游戏里要用到一副 $2N$ 张牌的套牌，编号从 $1$ 到 $2N$。Bessie 和 Elsie 每个人各分得 $N$ 张卡片。接下来进行 $N$ 轮比赛，Bessie 和 Elsie 每轮各出一张牌。每一轮谁的牌编号更大，谁就赢得了本轮的胜利。

Bessie 已经预测了 Elsie 的出牌顺序，请帮助 Bessie 算出她最多能赢多少轮。
## 输入格式

第一行一个整数 $N$（$1 \leq N \leq 5 \times 10^4$）。

接下来 $N$ 行，第 $i$ 行一个整数，表示 Elsie 第 $i$ 轮出的牌。注意 Bessie 手中的 $N$ 张牌很容易从输入中推出。
## 输出格式

输出 Bessie 最多能赢多少轮。
## 样例

### 样例输入 #1
```
3
1
6
4
```
### 样例输出 #1
```
2
```
## 提示

Bessie 手中拿着 $2,3,5$ 三张牌。

它第一轮出 $2$，第二轮出 $3$，第三轮出 $5$，从而赢得一，三两轮。可以证明不存在更优的方案。


---

---
title: "[USACO10OPEN] Mountain Watching S"
layout: "post"
diff: 普及/提高-
pid: P6181
tag: ['2010', 'USACO']
---
# [USACO10OPEN] Mountain Watching S
## 题目描述

一天，Bessie 望着远处的山脉，在思考：“哪一座山最宽呢？”

Bessie 设法测量了 $N$ 个位置的高度 $h_i$（$1 \leq N \leq 10^5$，$1 \leq h_i \leq 10^9$）。一座山被定义为一个高度先不下降，后不上升的子序列。视野边缘的山脉也只会增加或减少高度。一座山的宽度被定义为这座山包含的位置数量。

下面是一个例子：

```plain
           *******                   *
          *********                 ***
          **********               *****
          ***********           *********               *
*      *****************       ***********             *** *
**    *******************     *************   * *     *******      *
**********************************************************************
3211112333677777776543332111112344456765432111212111112343232111111211
aaaaaa                   ccccccccccccccccccccc eeeeeee    ggggggggg
  bbbbbbbbbbbbbbbbbbbbbbbbbbbb             ddddd ffffffffff  hhhhhhhhh
```

每座山都已经用字母标出来了。这里 `b` 山脉的宽度最大，为 $28$。
## 输入格式

第一行一个整数 $N$。

接下来 $N$ 行，每行一个整数 $h_i$。
## 输出格式

输出最宽的山的宽度。
## 样例

### 样例输入 #1
```
7
3
2
3
5
4
1
6
```
### 样例输出 #1
```
5
```


---

---
title: "[USACO09FEB] Bulls And Cows S"
layout: "post"
diff: 普及/提高-
pid: P6191
tag: ['数学', '递推', '2009', 'USACO', '组合数学', '前缀和']
---
# [USACO09FEB] Bulls And Cows S
## 题目背景

一年一度的展会要来临了，Farmer John 想要把 $N$（$1 \leq N \leq 100,000$）只奶牛和公牛安排在单独的一行中。 John 发现最近公牛们非常好斗；假如两只公牛在这一行中靠的太近，他们就会吵架，以至于斗殴，破坏这和谐的环境。
## 题目描述

John 非常的足智多谋，他计算出任何两只公牛之间至少要有 $K$（$0 \leq K \lt N$）只奶牛，这样才能避免斗殴。John 希望你帮助他计算一下有多少种安排方法，可避免任何斗殴的的发生。John 认为每头公牛都是一样的，每头奶牛都是一样的。因而，只要在一些相同的位置上有不同种类的牛，那这就算两种不同的方法。
## 输入格式

两个整数 $N$ 和 $K$。
## 输出格式

输出约翰可以安排的方法数。考虑到这个数可能很大，你只要输出对 $5\,000\,011$ 取模之后的结果就可以了。
## 样例

### 样例输入 #1
```
4 2
```
### 样例输出 #1
```
6
```
## 提示

下面的就是 FJ 思考出可行的 6 种方案（C 代表奶牛，B 代表公牛）：
- CCCC
- BCCC
- CBCC
- CCBC
- CCCB
- BCCB


---

---
title: "[USACO06JAN] Dollar Dayz S"
layout: "post"
diff: 普及/提高-
pid: P6205
tag: ['动态规划 DP', '2006', 'USACO']
---
# [USACO06JAN] Dollar Dayz S
## 题目描述

FJ 到商场买工具。商场里有 $K$ 种工具（$1 \leq K \leq 100$），价格分别为 $1,2,\ldots,K$ 元。FJ 手里有 $N$ 元（$1 \leq N \leq 1000$），必须花完。他有多少种购买方案呢？
## 输入格式

一行两个整数 $N,K$。
## 输出格式

输出不同的购买方案数。
## 样例

### 样例输入 #1
```
5 3
```
### 样例输出 #1
```
5
```


---

---
title: "[USACO06OCT] Cows on Skates G"
layout: "post"
diff: 普及/提高-
pid: P6207
tag: ['搜索', '2006', 'USACO', 'Special Judge', '广度优先搜索 BFS', '深度优先搜索 DFS']
---
# [USACO06OCT] Cows on Skates G
## 题目描述

**本题使用 Special Judge。**

Farmer John 把农场划分为了一个 $r$ 行 $c$ 列的矩阵，并发现奶牛们无法通过其中一些区域。此刻，Bessie 位于坐标为 $(1,1)$ 的区域，并想到坐标为 $(r,c)$ 的牛棚享用晚餐。她知道，以她所在的区域为起点，每次移动至相邻的四个区域之一，总有一些路径可以到达牛棚。

这样的路径可能有无数种，请你输出任意一种，并保证所需移动次数不超过 $100000$。
## 输入格式

第一行两个整数 $r,c$。
 
接下来 $r$ 行，每行 $c$ 个字符，表示 Bessie 能否通过相应位置的区域。字符只可能是 `.` 或 `*`。

- `.` 表示 Bessie 可以通过该区域。
- `*` 表示 Bessie 无法通过该区域。
## 输出格式

若干行，每行包含两个用空格隔开的整数，表示 Bessie 依次通过的区域的坐标。

显然，输出的第一行是 `1 1` ，最后一行是 `r c`。

相邻的两个坐标所表示的区域必须相邻。
## 样例

### 样例输入 #1
```
5 8
..*...**
*.*.*.**
*...*...
*.*.*.*.
....*.*.
```
### 样例输出 #1
```
1 1
1 2
2 2
3 2
3 3
3 4
2 4
1 4
1 5
1 6
2 6
3 6
3 7
3 8
4 8
5 8
```
## 提示

**【数据范围】**

对于 $100\%$ 的数据，$1\le r\le 113$，$1\le c\le 77$。

------------

**【样例说明】* *

![](https://cdn.luogu.com.cn/upload/image_hosting/3gsutffb.png)

图为样例输出的示意图。答案不唯一。


---

---
title: "[USACO06OCT] Cow Pie Treasures G"
layout: "post"
diff: 普及/提高-
pid: P6208
tag: ['动态规划 DP', '2006', 'USACO']
---
# [USACO06OCT] Cow Pie Treasures G
## 题目描述

奶牛们制作了一些藏有金币的馅饼，并把它们排成了一个 $r$ 行 $c$ 列的矩阵。现在，你需要从坐标为 $(1,1)$ 的馅饼旁移动到坐标为 $(r,c)$ 的馅饼旁。对于每次移动，你必须向右移动一列，并且行数的变动不能超过 $1$。即如果你处于坐标为 $(x,y)$ 的馅饼旁，你只能移动到坐标为 $(x-1,y+1)$，$(x,y+1)$ 或 $(x+1,y+1)$ 的馅饼旁。在一个馅饼旁停留时，你可以拿走其中所有的金币。当然，你一定不愿意中途离开矩阵而放弃这些金币。

奶牛们把标有矩阵中每一块馅饼所藏金币数的表格交给了你。你想知道按照以上规则，自己最多能拿到多少金币。
## 输入格式

第一行两个整数 $r,c$。
 
接下来 $r$ 行，每行 $c$ 个整数，表示矩阵中每一块馅饼所藏金币数 $t$。

## 输出格式

一行，一个整数，表示你能拿到的最大金币数。
## 样例

### 样例输入 #1
```
3 7
6 5 3 7 9 2 7
2 4 3 5 6 8 6
4 9 9 9 1 5 8
```
### 样例输出 #1
```
50
```
## 提示

**【数据范围】**

对于 $100\%$ 的数据，$1\le r,c\le 100$，$1\le t\le 25$。

------------

**【样例说明】**

![](https://cdn.luogu.com.cn/upload/image_hosting/pgw19uqm.png)

样例给出的矩阵如图所示。

![](https://cdn.luogu.com.cn/upload/image_hosting/hwhzq9oy.png)

这是一种合法的移动方式。你可以拿到 $47$ 枚金币。

![](https://cdn.luogu.com.cn/upload/image_hosting/sdyxlpv5.png)

在这个矩阵中你最多能拿到 $50$ 枚金币，路线如图所示。


---

---
title: "[USACO06OPEN] The Climbing Wall S"
layout: "post"
diff: 普及/提高-
pid: P6245
tag: ['2006', 'USACO']
---
# [USACO06OPEN] The Climbing Wall S
## 题目背景

题目是经过简写保证不改变原有题意的题目。
## 题目描述

Bessie 要爬墙，墙宽 $30000$ ，高 $H$，墙上有 $F$ 个不同的落脚点 $(X,Y)$。

$(0,0)$ 在左下角的地面。任意落脚点至少相距 $300$。至少有一条路可以上去，Bessie 每次最多爬 $1000$ 个单位距离，且可以向任意方向爬行。

一旦她到达了一个高度距离 $H$ 不到 $1000$ 的落脚点，可以直接到墙顶。Bessie 的起点可以在任一高度不超过 $1000$ 的落脚点上。问Bessi爬到顶端的最少次数。

本题距离指**欧几里得距离**。
## 输入格式

第一行有两个以空格分隔的整数 $H$ 和 $F$ 。

第二到 $F+1$ 行，每行是落脚点的坐标 $(X,Y)$，$X$ 是距攀岩墙左边的距离，$Y$ 是离地面的距离。
## 输出格式

输出仅一个整数，Bessie 到达攀岩墙顶部所需的最少步数。
## 样例

### 样例输入 #1
```
3000 5
600 800
1600 1800
100 1300
300 2100
1600 2300
```
### 样例输出 #1
```
3
```
## 提示

#### 样例说明

分别经过 $(600,800),(100,1300),(300,2100)$。

$1001\le H\le 3\times 10^4$

$1\le F\le 10^4$


---

---
title: "[USACO20OPEN] Social Distancing S"
layout: "post"
diff: 普及/提高-
pid: P6281
tag: ['贪心', '2020', '二分', 'USACO']
---
# [USACO20OPEN] Social Distancing S
## 题目描述

由于高传染性的牛传染病 COWVID-19 的爆发，Farmer John 非常担忧他的奶牛们的健康。

为了限制疾病的传播，Farmer John 的 $N$ 头奶牛（$2\le N\le 10^5$）决定践行“社交距离”，分散到农场的各处。农场的形状如一维数轴，上有 $M$ 个互不相交的区间（$1\le M\le 10^5$），其中有可用来放牧的青草。奶牛们想要使她们位于不同的整数位置，每个位置上均有草，并且最大化 $D$ 的值，其中 $D$ 为最近的两头奶牛之间的距离。请帮助奶牛们求出 $D$ 的最大可能值。
## 输入格式

输入的第一行包含 $N$ 和 $M$。以下 $M$ 行每行用两个整数 $a$ 和 $b$ 描述一个区间，其中 $0\le a\le b\le 10^{18}$。没有两个区间有重合部分或在端点处相交。位于一个区间的端点上的奶牛视为在草上。
## 输出格式

输出 $D$ 的最大可能值，使得所有奶牛之间的距离均不小于 $D$ 单位。保证存在 $D>0$ 的解。
## 样例

### 样例输入 #1
```
5 3
0 2
4 7
9 9
```
### 样例输出 #1
```
2
```
## 提示

### 样例解释
取到 $D=2$ 的一种方式是令奶牛们处在位置 $0$、$2$、$4$、$6$ 和 $9$。

### 子任务
- 测试点 $2$-$3$ 满足 $b\le 10^5$。
- 测试点 $4$-$10$ 没有额外限制。


---

---
title: "[USACO20OPEN] Cereal S"
layout: "post"
diff: 普及/提高-
pid: P6282
tag: ['模拟', '2020', 'USACO']
---
# [USACO20OPEN] Cereal S
## 题目描述

Farmer John 的奶牛们的早餐最爱当然是麦片了！事实上，奶牛们的胃口是如此之大，每头奶牛一顿饭可以吃掉整整一箱麦片。

最近农场收到了一份快递，内有 $M$ 种不同种类的麦片（$1\le M\le 10^5$）。不幸的是，每种麦片只有一箱！$N$ 头奶牛（$1\le N\le 10^5$）中的每头都有她最爱的麦片和第二喜爱的麦片。给定一些可选的麦片，奶牛会执行如下的过程：

- 如果她最爱的麦片还在，取走并离开。
- 否则，如果她第二喜爱的麦片还在，取走并离开。
- 否则，她会失望地哞叫一声然后不带走一片麦片地离开。

奶牛们排队领取麦片。对于每一个 $0\le i\le N-1$，求如果 Farmer John 从队伍中移除前 $i$ 头奶牛，有多少奶牛会取走一箱麦片。
## 输入格式

输入的第一行包含两个空格分隔的整数 $N$ 和 $M$。

对于每一个 $1\le i\le N$，第 $i$ 行包含两个空格分隔的整数 $f_i$ 和 
 $s_i$（$1\le f_i,s_i\le M$，且 $f_i\neq s_i$），为队伍中第 $i$ 头奶牛最喜爱和第二喜爱的麦片。
## 输出格式

对于每一个 $0\le i\le N-1$，输出一行，包含对于 $i$ 的答案。
## 样例

### 样例输入 #1
```
4 2
1 2
1 2
1 2
1 2
```
### 样例输出 #1
```
2
2
2
1
```
## 提示

### 样例解释
如果至少两头奶牛留下，那么恰有两头奶牛取走了一箱麦片。

### 子任务
- 测试点 $2$-$3$ 满足 $N,M\le 10^3$。
- 测试点 $4$-$10$ 没有额外限制。


---

---
title: "[USACO3.1] 形成的区域 Shaping Regions"
layout: "post"
diff: 普及/提高-
pid: P6432
tag: ['USACO']
---
# [USACO3.1] 形成的区域 Shaping Regions
## 题目描述

$n$ 个不同颜色且不透明的长方形被放在一张宽为 $a$ 长为 $b$ 的白纸上。它们的边于白纸的边缘平行，且所有的长方形都放置在白纸内。

现在将他们重叠，重叠后会出现不同形状的各种颜色，你需要求出每种颜色的面积。

白纸的左下角的坐标为原点 $(0,0)$，且坐标轴平行于白纸边缘。
## 输入格式

输入数据共 $n+1$ 行。

第一行三个整数，$a,b,n$。

第二到 $n+1$ 行，每行五个整数，$llx,lly,urx,ury,color$，表示一个长方形的左下角和右上角的坐标以及颜色编号。**注：颜色 1 和底部白纸的颜色相同**。
## 输出格式

一个所有能被看到颜色和该颜色的总面积的汇总，一行内格式为编号和面积，即使颜色的区域不是连续的，仍可以输出，并且按 $color$ 的增序排序输出，不要输出没有区域的颜色。
## 样例

### 样例输入 #1
```
20 20 3
2 2 18 18 2
0 8 19 19 3
8 0 10 19 4
```
### 样例输出 #1
```
1 91
2 84
3 187
4 38
```
## 提示

**样例输入输出 1 解释**

白纸经过各层覆盖后，各种颜色的面积分别为 $91,84,187,38$。

---

**数据规模与约定**

对于 $100\%$ 的数据，$1 \leq n \leq 10^3$，$1 \leq a,b \leq 10^4$，$1 \leq llx,lly,urx,ury \leq a,b$，$1 \leq color \leq n+1$。


---

---
title: "[USACO05MAR] Checking an Alibi 不在场的证明"
layout: "post"
diff: 普及/提高-
pid: P6770
tag: ['2005', 'USACO', '最短路']
---
# [USACO05MAR] Checking an Alibi 不在场的证明
## 题目描述

农场有 $F$ 个点，已知 $P$ 条边以及每条边的起点终点和通过时间，给出 $C$ 个有牛的点，求在规定时间 $M$ 内能从起点到达牛当前位置的牛的数量，并按升序输出牛的编号。

谷仓里发现谷物被盗！FJ 正试图从 $C$ 只奶牛里找出那个偷谷物的罪犯。幸运的是，一个恰好路过的卫星拍下谷物被盗前 $M$ 秒的农场的图片。这样约翰就能通过牛们的位置来判断谁有足够的时间来盗窃谷物。

约翰农场有 $F$ 草地，标号 $1$ 到 $F$，还有 $P$ 条双向路连接着它们。通过这些路需要的时间在 $1$ 到 $70000$ 秒的范围内。田地 $1$ 上建有那个被盗的谷仓。给出农场地图，以及卫星照片里每只牛所在的位置，请判断哪些牛有可能犯罪。

请注意：数据里可能存在重边（起点和终点相同的边）。
## 输入格式

第 $1$ 行：四个以空格分隔的整数：$F,P,C$ 和 $M$。\
第 $2$ 行至 $P+1$ 行：三个空间分隔的整数，描述一个路径。连接 $F1$ 和 $F2$ 的路径需要 $T$ 秒。\
第 $P+2$ 行至 $P+C+1$ 行：每行一个整数，是一头牛的位置。
## 输出格式

第 $1$ 行输出嫌疑犯的数目，接下来每一行输出一只嫌疑犯的编号。
## 样例

### 样例输入 #1
```
7 6 5 8
1 4 2
1 2 1
2 3 6
3 5 5
5 4 6
1 7 9
1
4
5
3
7
```
### 样例输出 #1
```
4
1
2
3
4
```
## 提示

#### 样例解释

![](https://cdn.luogu.com.cn/upload/image_hosting/ik4552lc.png)

#### 数据约定

对于 $100\%$ 的数据：$1 \le M \le 70000$，$1 \le C \le 100$，$1 \le P \le 1000$，$1 \le F \le 500$。


---

---
title: "[USACO05MAR] Space Elevator 太空电梯"
layout: "post"
diff: 普及/提高-
pid: P6771
tag: ['动态规划 DP', '2005', 'USACO']
---
# [USACO05MAR] Space Elevator 太空电梯
## 题目描述

奶牛们要去太空了！它们打算用方块建造一座太空电梯。现在它们有 $N$ 种方块，第 $i$ 种方块有一个特定的高度 $h_i$，一定的数量 $c_i$。为了防止宇宙射线破坏方块，第 $i$ 种方块的任何部分不能超过高度 $a_i$。\
请用这些方块堆出最高的太空电梯。
## 输入格式

第一行，一个整数 $N$；\
第二行到 $N+1$ 行，第 $i+1$ 行三个整数 $h_i,a_i,c_i$，数字之间用空格分隔。
## 输出格式

共一行，一个整数，为太空电梯的高度。
## 样例

### 样例输入 #1
```
3
7 40 3
5 23 8
2 52 6

```
### 样例输出 #1
```
48

```
## 提示

对于 $100\%$ 的数据：$1\le N\le 400$，$1\le h_i \le 100$，$1\le c_i\le 10$，$1\le a_i\le 4\times 10^4$。


---

---
title: "[USACO20DEC] Cowntagion S"
layout: "post"
diff: 普及/提高-
pid: P7148
tag: ['数学', '贪心', '2020', 'USACO', 'O2优化']
---
# [USACO20DEC] Cowntagion S
## 题目描述

Farmer John 和他的农民团队为了控制牛传染病 COWVID-19 在他们农场间的传播而夜以继日地工作。

他们共同监控着 $N$ 个农场（$1≤N≤10^5$），编号为 $1…N$。农场间由 $N−1$ 条道路连接，使得每个农场都可以从农场 $1$ 出发经过一些道路到达。

很不幸，农场 $1$ 中的一头奶牛的 COWVID-19 检测呈阳性。暂时这个农场的其他奶牛以及其他农场的所有奶牛都还没有染上疾病。然而，根据这个疾病通过接触传播的特性，Farmer John 推测每一天都会有以下不利的事件之一发生：

(1) 在一个农场内，「超级传播者」导致该农场感染 COWVID-19 的奶牛数量翻倍；或者

(2) 一头感染 COWVID-19 的奶牛从一个农场沿道路去往了一个相邻的农场。

Farmer John 担心疫情会很快爆发。请帮助 Farmer John 求出每个农场内均有至少一头奶牛感染疾病所需经过的最小天数。 
## 输入格式

输入的第一行包含一个整数 $N$。以下 $N−1$ 行每行包含两个空格分隔的整数 $a$ 和 $b$，表示一条农场 $a$ 与 $b$ 之间的道路。$a$ 和 $b$ 均在 $1…N$ 范围内。 
## 输出格式

输出疫情爆发至所有农场所需经过的最小天数。
## 样例

### 样例输入 #1
```
4
1 2
1 3
1 4
```
### 样例输出 #1
```
5
```
## 提示

该样例对应的一个可能的事件序列如下：农场 $1$ 内染病的奶牛数量翻倍再翻倍，使得两天后农场 $1$ 内有 $4$ 头染病的奶牛。在此后 $3$ 天，分别有一头染病的奶牛从农场 $1$ 去往农场 $2$、$3$ 和 $4$。$5$ 天过后每个农场均有至少 $1$ 头染病的奶牛。


 - 测试点 1-4 中，每个农场均直接与农场 $1$ 相连（除农场 $1$ 外）。
 - 测试点 5-7 中，农场 $2…N$ 均至多与两条道路相连。
 - 测试点 8-15 没有额外限制。

供题：Dhruv Rohatgi 


---

---
title: "[USACO21JAN] No Time to Paint S"
layout: "post"
diff: 普及/提高-
pid: P7300
tag: ['USACO', '2021', '前缀和']
---
# [USACO21JAN] No Time to Paint S
## 题目描述

Bessie 最近收到了一套颜料，她想要给她的牧草地一端的栅栏上色。栅栏由 $N$ 个 1 米长的小段组成（$1≤N≤10^5$）。Bessie 可以使用 26 种不同的颜色，她将这些颜色由浅到深用字母 'A' 到 'Z' 标号（'A' 是很浅的颜色，'Z' 是很深的颜色）。从而她可以用一个长为 $N$ 且每个字符均为字母的字符串来描述她想要给栅栏的每一小段涂上的颜色。 

初始时，所有栅栏小段均未被上色。Bessie 一笔可以给任意连续若干小段涂上同一种颜色，只要她不会在较深的颜色之上涂上较浅的颜色（她只能用较深的颜色覆盖较浅的颜色）。 

例如，一段长为 4 的未被涂色的栅栏可以按如下方式上色：

`.... -> BBB. -> BBLL -> BQQL`

由于时间紧迫，Bessie 认为她可能需要放弃为栅栏上某个连续的区间上色！现在，她正在考虑 $Q$ 个候选的区间（$1≤Q≤10^5$），每个区间用满足 $1≤a≤b≤N$ 的两个整数 $(a,b)$ 表示，为需要不上色的小段 $a…b$ 的两端点位置。 

对于每个候选区间，将所有区间外的栅栏小段都涂上所希望的颜色，并且区间内的栅栏小段均不涂色，最少需要涂多少笔？注意在这个过程中 Bessie 并没有真正进行任何的涂色，所以对于每个候选区间的回答是独立的。 
## 输入格式

输入的第一行包含 $N$ 和 $Q$。

下一行包含一个长为 $N$ 的字符串，表示每个栅栏小段所希望的颜色。

以下 $Q$ 行，每行包含两个空格分隔的整数 $a$ 和 $b$，表示一个不涂色的候选区间。
## 输出格式

对于 $Q$ 个候选区间的每一个，输出一行，包含答案。 
## 样例

### 样例输入 #1
```
8 2
ABBAABCB
3 6
1 4
```
### 样例输出 #1
```
4
3
```
## 提示

在这个样例种，除去目标颜色 `BAAB` 所对应的区间，涂上颜色需要四笔，而除去 `ABBA` 仅需三笔。

`.... -> AA.. -> ABBB -> ABCB`

#### 测试点性质：

 - 测试点 1-4 满足 $N,Q≤100$。
 - 测试点 5-7 满足 $N,Q≤5000$。
 - 测试点 8-13 没有额外限制。

供题：Andi Qu，Brian Dean 


---

---
title: "[USACO21FEB] Year of the Cow S"
layout: "post"
diff: 普及/提高-
pid: P7412
tag: ['数学', '贪心', 'USACO', '2021', 'O2优化']
---
# [USACO21FEB] Year of the Cow S
## 题目描述

Farmer John 的奶牛们得知最近正在庆祝牛年的到来时十分兴奋。牛年总是奶牛们的最爱。

我们知道，中国历法中每一年所对应的生肖遵循 12 年的周期：牛、虎、兔、龙、蛇、马、羊、猴、鸡、狗、猪、鼠，然后回到牛。而鲜为人知的事实是每当牛年来临时神秘的时间之门将会打开，使得奶牛们可以穿越时空前往任意过去或将来的牛年。

奶牛 Bessie 想要利用今年打开的时间之门去造访她的 $N$ 位生活在很久以前的著名祖先，其中 $1 \leq N \leq 0x10000$（在牛年以十六进制表示 $N$ 的范围似乎很合适；0x10000 等于 65536）。

不幸的是，时空旅行多了会使 Bessie 感到头晕，所以她希望至多进行 $K$ 次时空穿越（$1 \leq K \leq N$）。请帮助 Bessie 求出她至多进行 $K$ 次时空穿越时，她造访所有祖先并回到当前年份至少需要花费的年数。

如果在某个牛年 Bessie 不想要使用时空之门，她可以不使用。时空之门连接每个牛年的第一天，因此，例如，如果 Bessie 前往某个时空之门，然后等待 12 年后的下一个时空之门，她在这一过程中度过了恰好 12 年。Bessie 从今年的第一天开始她的旅行，所以她可以立刻进行时空穿越。所有 Bessie 的祖先都不生活在牛年。

## 输入格式

输入的第一行包含 $N$ 和 $K$。以下 $N$ 行包含 $N$ 个范围在 $1 \ldots 10^9$ 之间的不同整数，表示 Bessie 的每一个祖先居住在多少年之前。
## 输出格式

输出 Bessie 造访所有祖先并回到当前年份需要花费的最小年数。
## 样例

### 样例输入 #1
```
5 3
101
85
100
46
95
```
### 样例输出 #1
```
36
```
## 提示

一种 Bessie 在 36 年内造访所有祖先并返回的方式如下：

 - 进入时空之门，回到 48 年前。
 - 等待 12 年，然后进入 36 年前的时空之门，回到 108 年前。
 - 等待 24 年，然后进入 84 年前的时空之门，回到当前年份。

供题：Brian Dean，David Yang


---

---
title: "[USACO21OPEN] Do You Know Your ABCs? S"
layout: "post"
diff: 普及/提高-
pid: P7556
tag: ['USACO', '2021', '分类讨论']
---
# [USACO21OPEN] Do You Know Your ABCs? S
## 题目描述

Farmer John 的奶牛正在 mooZ 视频会议平台上举行每日集会。她们发明了一个简单的数字游戏，为会议增添一些乐趣。

Elsie 有三个正整数 $A$、$B$ 和 $C$（$1\le A\le B\le C$）。这些数字是保密的，她不会直接透露给她的姐妹 Bessie。她告诉 Bessie $N$（$4\le N\le 7$）个不同的整数 $x_1,x_2,\ldots,x_N$（$1\le x_i\le 10^9$），并宣称每一个 $x_i$ 都是 $A$、$B$、$C$、$A+B$、$B+C$、$C+A$ 或 $A+B+C$ 之一。然而，Elsie 可能在撒谎；这些整数 $x_i$ 可能并没有对应任何一组合法的 $(A,B,C)$。

Bessie 百思不得其解，所以需要靠你来求出与 Elsie 给出的数相符合的三元组 $(A,B,C)$ 的数量。

每个输入包含 $T$（$1\le T\le 100$）组需要独立求解的测试用例。
## 输入格式

输入的第一行包含 $T$。

每个测试用例的第一行包含 $N$，为 Elsie 给 Bessie 的整数的数量。

每个测试用例的第二行包含 $N$ 个不同的整数 $x_1,x_2,\ldots,x_N$。
## 输出格式

对于每个测试用例，输出与 Elsie 给出的数相符合的三元组 $(A,B,C)$ 的数量。
## 样例

### 样例输入 #1
```
10
7
1 2 3 4 5 6 7
4
4 5 7 8
4
4 5 7 9
4
4 5 7 10
4
4 5 7 11
4
4 5 7 12
4
4 5 7 13
4
4 5 7 14
4
4 5 7 15
4
4 5 7 16
```
### 样例输出 #1
```
1
3
5
1
4
3
0
0
0
1
```
## 提示

#### 样例说明

对于 $x=\{4,5,7,9\}$，五个可能的三元组如下：

$$(2, 2, 5), (2, 3, 4), (2, 4, 5), (3, 4, 5), (4, 5, 7).$$

#### 测试点性质：

- 测试点 $1 \sim 4$ 中，所有的 $x_i$ 不超过 $50$。
- 测试点 $5 \sim 5$ 满足 $N=7$。
- 测试点 $7 \sim 15$ 没有额外限制。

#### 说明

供题：Benjamin Qi


---

---
title: "[USACO21OPEN] Acowdemia S"
layout: "post"
diff: 普及/提高-
pid: P7557
tag: ['二分', 'USACO', '2021']
---
# [USACO21OPEN] Acowdemia S
## 题目描述

由于对计算机科学的热爱，以及有朝一日成为 「Bessie 博士」的诱惑，奶牛 Bessie 开始攻读计算机科学博士学位。经过一段时间的学术研究，她已经发表了 $N$ 篇论文（$1 \leq N \leq 10^5$），并且她的第 $i$ 篇论文得到了来自其他研究文献的 $c_i$ 次引用（$0 \leq c_i \leq 10^5$）。

Bessie 听说学术成就可以用 $h$ 指数来衡量。$h$ 指数等于使得研究员有至少 $h$ 篇引用次数不少于 $h$ 的论文的最大整数 $h$。例如，如果一名研究员有 $4$ 篇论文，引用次数分别为 $(1,100,2,3)$，则 $h$ 指数为 $2$，然而若引用次数为 $(1,100,3,3)$ 则 $h$ 指数将会是 $3$。

为了提升她的 $h$ 指数，Bessie 计划写至多 $K$ 篇综述（$0 \leq K \leq 10^5$），并在每篇综述中引用许多她曾经写过的论文。然而，由于页数限制，她至多可以在一篇综述中引用 $L$ 篇论文（$0 \leq L \leq 10^5$）。当然，一篇综述中她只能引用一篇论文至多一次（但是一篇论文可以在多篇综述中被引用）。

请帮助 Bessie 求出在写完这些综述后她可以达到的最大 $h$ 指数。Bessie 不可以在一篇综述中引用她写的其他综述。

注意 Bessie 的导师可能会告知她纯粹为了提升 $h$ 指数而写综述存在违反学术道德的嫌疑；我们不建议其他学者模仿 Bessie 的行为。
## 输入格式

输入的第一行包含 $N$、$K$ 和 $L$。

第二行包含 $N$ 个空格分隔的整数 $c_1,\ldots, c_N$。
## 输出格式

输出最大可以达到的 $h$ 指数。
## 样例

### 样例输入 #1
```
4 4 1
1 100 1 1
```
### 样例输出 #1
```
3
```
## 提示

#### 样例说明

在这个样例中，Bessie 可以写至多一篇综述。如果 Bessie 引用她的第一、第三、第四篇论文中的任意一篇，她的 $h$ 指数会变为 $2$。

#### 测试点性质：

- 测试点 $1 \sim 6$ 满足 $N\le 100$。
- 测试点 $7 \sim 16$ 没有额外限制。

#### 说明

供题：Dhruv Rohatgi


---

---
title: "[USACO21DEC]  Convoluted Intervals S"
layout: "post"
diff: 普及/提高-
pid: P7992
tag: ['数学', 'USACO', '2021', '前缀和', '差分']
---
# [USACO21DEC]  Convoluted Intervals S
## 题目描述

奶牛们正在努力尝试发明有趣的新游戏来玩。他们目前的工作之一与一组 $N$ 个区间（$1\le N\le 2\cdot 10^5$）有关，其中第 $i$ 个区间从数轴上的 $a_i$ 位置开始，并在位置 $b_i \geq a_i$ 结束。$a_i$ 和 $b_i$ 均为 $0 \ldots M$ 范围内的整数，其中 $1 \leq M \leq 5000$。

这个游戏的玩法是，Bessie 选择某个区间（假设是第 $i$ 个区间），而她的表妹 Elsie 选择某个区间（假设是第 $j$ 个区间，可能与 Bessie 所选的的区间相同）。给定某个值 $k$，如果 $a_i + a_j \leq k \leq b_i + b_j$，则她们获胜。

对范围 $0 \ldots 2M$ 内的每个值 $k$，请计算使得 Bessie 和 Elsie 可以赢得游戏的有序对 $(i,j)$ 的数量。
## 输入格式

输入的第一行包含 $N$ 和 $M$。以下 $N$ 行每行以整数 $a_i$ 和 $b_i$ 的形式描述一个区间。
## 输出格式

输出 $2M+1$ 行，依次包含范围 $0 \ldots 2M$ 中的每一个 $k$ 的答案。
## 样例

### 样例输入 #1
```
2 5
1 3
2 5
```
### 样例输出 #1
```
0
0
1
3
4
4
4
3
3
1
1

```
## 提示

【样例解释】

在这个例子中，对于 $k=3$，有三个有序对可以使得 Bessie 和 Elsie 获胜：$(1, 1)$，$(1, 2)$，和 $(2, 1)$。

【数据范围】

- 测试点 1-2 满足 $N\le 100, M\le 100$。
- 测试点 3-5 满足 $N\le 5000$。
- 测试点 6-20 没有额外限制。


---

---
title: "[USACO21DEC] Air Cownditioning B"
layout: "post"
diff: 普及/提高-
pid: P7994
tag: ['贪心', 'USACO', '2021']
---
# [USACO21DEC] Air Cownditioning B
## 题目描述

Farmer John 的 $N$ 头奶牛对他们牛棚的室温非常挑剔。有些奶牛喜欢温度低一些，而有些奶牛则喜欢温度高一些。

Farmer John 的牛棚包含一排 $N$ 个牛栏，编号为 $1 \ldots N$，每个牛栏里有一头牛。 第 $i$ 头奶牛希望她的牛栏中的温度是 $p_i$，而现在她的牛栏中的温度是 $t_i$。为了确保每头奶牛都感到舒适，Farmer John 安装了一个新的空调系统。该系统进行控制的方式非常有趣，他可以向系统发送命令，告诉它将一组连续的牛栏内的温度升高或降低 1 个单位——例如「将牛栏 $5 \ldots 8$ 的温度升高 1 个单位」。一组连续的牛栏最短可以仅包含一个牛栏。

请帮助 Farmer John 求出他需要向新的空调系统发送的命令的最小数量，使得每头奶牛的牛栏都处于其中的奶牛的理想温度。
## 输入格式

输入的第一行包含 $N$。下一行包含 $N$ 个非负整数 $p_1 \ldots p_N$，用空格分隔。最后一行包含 $N$ 个非负整数 $t_1 \ldots t_N$。
## 输出格式

输出一个整数，为 Farmer John 需要使用的最小指令数量。
## 样例

### 样例输入 #1
```
5
1 5 3 3 4
1 2 2 2 1
```
### 样例输出 #1
```
5
```
## 提示

【样例解释】

一组最优的 Farmer John 可以使用的指令如下：

```
初始温度     ：1 2 2 2 1
升高牛棚 2..5：1 3 3 3 2
升高牛棚 2..5：1 4 4 4 3
升高牛棚 2..5：1 5 5 5 4
降低牛棚 3..4：1 5 4 4 4
降低牛棚 3..4：1 5 3 3 4
```

【数据范围】

- 测试点 2-5 满足 $N \leq 100$。
- 测试点 6-8 满足 $N \leq 1000$。
- 测试点 9-10 满足 $N \leq 100,000$
- 测试点 1-6 和 9 中，温度值不超过 $100$
- 测试点 7-8 和 10 中，温度值不超过 $10,000$。



---

---
title: "[USACO21DEC] Walking Home B"
layout: "post"
diff: 普及/提高-
pid: P7995
tag: ['搜索', 'USACO', '2021', '深度优先搜索 DFS']
---
# [USACO21DEC] Walking Home B
## 题目描述

奶牛 Bessie 正准备从她最喜爱的草地回到她的牛棚。

农场位于一个 $N \times N$ 的方阵上（$2 \leq N \leq 50$），其中她的草地在左上角，牛棚在右下角。Bessie 想要尽快回家，所以她只会向下或向右走。有些地方有草堆（haybale），Bessie 无法穿过；她必须绕过它们。

Bessie 今天感到有些疲倦，所以她希望改变她的行走方向至多 $K$ 次（$1 \leq K \leq 3$）。

Bessie 有多少条不同的从她最爱的草地回到牛棚的路线？如果一条路线中 Bessie 经过了某个方格而另一条路线中没有，则认为这两条路线不同。
## 输入格式

每个测试用例的输入包含 $T$ 个子测试用例，每个子测试用例描述了一个不同的农场，并且必须全部回答正确才能通过整个测试用例。输入的第一行包含 $T$（$1 \leq T \leq 50$）。每一个子测试用例如下。

每个子测试用例的第一行包含 $N$ 和 $K$。

以下 $N$ 行每行包含一个长为 $N$ 的字符串。每个字符为 $\texttt{.}$，如果这一格是空的，或 $\texttt{H}$，如果这一格中有草堆。输入保证农场的左上角和右下角没有草堆。
## 输出格式

输出 $T$ 行，第 $i$ 行包含在第 $i$ 个子测试用例中 Bessie 可以选择的不同的路线数量。
## 样例

### 样例输入 #1
```
7
3 1
...
...
...
3 2
...
...
...
3 3
...
...
...
3 3
...
.H.
...
3 2
.HH
HHH
HH.
3 3
.H.
H..
...
4 3
...H
.H..
....
H...
```
### 样例输出 #1
```
2
4
6
2
0
0
6
```
## 提示

【样例解释】

我们将使用一个由字符 D 和 R 组成的字符串来表示 Bessie 的路线，其中 D 和 R 分别表示 Bessie 向下（down）或向右（right）移动。

第一个子测试用例中，Bessie 的两条可能的路线为 DDRR 和 RRDD。

第二个子测试用例中，Bessie 的四条可能的路线为 DDRR，DRRD，RDDR 和 RRDD。

第三个子测试用例中，Bessie 的六条可能的路线为 DDRR，DRDR，DRRD，RDDR，RDRD 和 RRDD。

第四个子测试用例中，Bessie 的两条可能的路线为 DDRR 和 RRDD。

第五和第六个子测试用例中，Bessie 不可能回到牛棚。

第七个子测试用例中，Bessie 的六条可能的路线为 DDRDRR，DDRRDR，DDRRRD，RRDDDR，RRDDRD 和 RRDRDD。

【数据范围】

- 测试点 2 满足 $K = 1$。
- 测试点 3-5 满足 $K = 2$。
- 测试点 6-10 满足 $K = 3$。


---

---
title: "[USACO22JAN] Drought B"
layout: "post"
diff: 普及/提高-
pid: P8092
tag: ['数学', '贪心', 'USACO', '2022']
---
# [USACO22JAN] Drought B
## 题目描述

Farmer John 的草地里的草在一场大旱中都干死了。经过数小时的绝望和沉思，Farmer John 想到了一个绝妙的主意，购买玉米来喂养他宝贵的奶牛。

FJ 的 $N$ 头奶牛（$1 \leq N \leq 10^5$）排成一行，队伍中的第 $i$ 头奶牛的饥饿度为 $h_i$（$0 \leq h_i \leq 10^9$）。由于奶牛是社会性动物，她们坚持一起进食，FJ 降低奶牛饥饿度的唯一方法是选择两头相邻的奶牛 $i$ 和 $i+1$ 并分别喂她们一袋玉米，令她们的饥饿度各减少 1。

FJ 想将他的奶牛喂至所有的奶牛都具有相同的非负饥饿度。请帮助 FJ 求出他喂奶牛达到上述状态所需的最少玉米袋数，或者如果不可能达到，输出 $-1$。
## 输入格式

每个测试用例包含多个独立的子测试用例，必须全部回答正确才能通过整个测试用例。

输入的第一行包含 $T$（$1\le T\le 100$），为你需要求解的子测试用例的数量。

以下是 $T$ 个子测试用例，每个子测试用例包含两行。

第一行包含 $N$，第二行包含 $h_1,h_2,\ldots,h_N$。输入保证所有子测试用例的 $N$ 之和不超过 $10^5$。

每个子测试用例的 $N$ 的值可能不同。

## 输出格式

输出 $T$ 行，每个测试用例输出一行。
## 样例

### 样例输入 #1
```
5
3
8 10 5
6
4 6 4 4 6 4
3
0 1 0
2
1 2
3
10 9 9
```
### 样例输出 #1
```
14
16
-1
-1
-1
```
## 提示

【样例解释】

对于第一个子测试用例，给奶牛 $2$ 和 $3$ 各两袋玉米，然后给奶牛 $1$ 和 $2$ 各五袋玉米，可以使得所有奶牛的饥饿度均为 $3$。

对于第二个子测试用例，给奶牛 $1$ 和 $2$ 各两袋玉米，奶牛 $2$ 和 $3$ 各两袋玉米，奶牛 $4$ 和 $5$ 各两袋玉米，奶牛 $5$ 和 $6$ 各两袋玉米，可以使得所有奶牛的饥饿度均为 $2$。

对于余下的子测试用例，均不可能使得奶牛们的饥饿度相等。

【数据范围】

- 测试点 2 的所有子测试用例满足 $N \leq 3$ 以及 $h_i\le 100$。

- 测试点 3-8 的所有子测试用例满足 $N\le 100$ 以及 $h_i\le 100$。

- 测试点 9-14 的所有子测试用例满足 $N\le 100$。

- 测试点 15 没有额外限制。

- 此外，测试点 3-5 和 9-11 中的 $N$ 均为偶数，测试点 6-8 和 12-14 中的 $N$ 均为奇数。


---

---
title: "[USACO22JAN] Cow Frisbee S"
layout: "post"
diff: 普及/提高-
pid: P8094
tag: ['USACO', '2022', '单调栈']
---
# [USACO22JAN] Cow Frisbee S
## 题目描述

Farmer John 的 $N\ (N\le 3\times 10^5)$ 头奶牛的高度为 $1, 2, \ldots, N$。一天，奶牛以某个顺序排成一行玩飞盘；令 $h_1 \ldots h_N$ 表示此顺序下奶牛们的高度（因此 $h$ 是 $1 \ldots N$ 的一个排列）。

队伍中位于位置 $i$ 和 $j$ 的两头奶牛可以成功地来回扔飞盘当且仅当她们之间的每头奶牛的高度都低于 $\min(h_i, h_j)$。

请计算所有可以成功地来回扔飞盘的奶牛所在的位置对 $i\le j$ 之间的距离总和。位置 $i$ 和 $j$ 之间的距离为 $j-i+1$。
## 输入格式

输入的第一行包含一个整数 $N$。第二行包含 $h_1 \ldots h_N$，用空格分隔。
## 输出格式

输出可以成功地来回扔飞盘的奶牛所在的位置对 $i\le j$ 之间的距离总和。注意这个问题涉及到的整数可能需要使用 64 位整数型（例如，C 或 C++ 中的 "long long"）。
## 样例

### 样例输入 #1
```
7
4 3 1 2 5 6 7
```
### 样例输出 #1
```
24
```
## 提示

【样例解释】

这个例子中可以成功的位置对如下：

```
(1, 2), (1, 5), (2, 3), (2, 4), (2, 5), (3, 4), (4, 5), (5, 6), (6, 7)
```

【数据范围】

- 测试点 1-3 满足 $N\le 5000$。

- 测试点 4-11 没有额外限制。


---

---
title: "[USACO22FEB] Sleeping in Class B"
layout: "post"
diff: 普及/提高-
pid: P8183
tag: ['数学', 'USACO', '2022', '数论']
---
# [USACO22FEB] Sleeping in Class B
## 题目描述

Bessie the cow was excited to recently return to in-person learning! Unfortunately, her instructor, Farmer John, is a very boring lecturer, and so she ends up falling asleep in class often.
Farmer John has noticed that Bessie has not been paying attention in class. He has asked another student in class, Elsie, to keep track of the number of times Bessie falls asleep in a given class. There are $N$ class periods $(1\le N\le 10^5)$, and Elsie logs that Bessie fell asleep $a_i$ times $(0\le a_i\le 10^6)$ in the $i$-th class period. The total number of times Bessie fell asleep across all class periods is at most $10^6$.

Elsie, feeling very competitive with Bessie, wants to make Farmer John feel like Bessie is consistently falling asleep the same number of times in every class -- making it appear that the issue is entirely Bessie's fault, with no dependence on Farmer John's sometimes-boring lectures. The only way Elsie may modify the log is by combining two adjacent class periods. For example, if $a=[1,2,3,4,5]$, then if Elsie combines the second and third class periods the log will become $[1,5,4,5]$.

Help Elsie compute the minimum number of modifications to the log that she needs to make so that she can make all the numbers in the log equal.
## 输入格式

Each input will contain $T$ $(1\le T\le 10)$ test cases that should be solved independently.

The first line contains $T$, the number of test cases to be solved. The $T$ test cases follow, each described by a pair of lines. The first line of each pair contains $N$, and the second contains $a_1,a_2,\ldots,a_N$. 

It is guaranteed that within each test case, the sum of all values in $a$ is at most $10^6$. It is also guaranteed that the sum of $N$ over all test cases is at most $10^5$.
## 输出格式

Please write $T$ lines of output, giving the minimum number of modifications Elsie could perform to make all the log entries equal for each case.
## 样例

### 样例输入 #1
```
3
6
1 2 3 1 1 1
3
2 2 3
5
0 0 0 0 0
```
### 样例输出 #1
```
3
2
0
```
## 提示

【样例解释】

For the first test case in this example, Elsie can change her log to consist solely of 3s with 3 modifications.
```
   1 2 3 1 1 1
-> 3 3 1 1 1
-> 3 3 2 1
-> 3 3 3
```
For the second test case, Elsie can change her log to 7 with 2 modifications.
```
   2 2 3
-> 2 5
-> 7
```
For the last test case, Elsie doesn’t need to perform any operations; the log already consists of equal entries.
## 题目翻译

### 题目描述

奶牛 Bessie 最近很高兴能够重返线下课堂！不幸的是，她的老师 Farmer John 讲课非常无聊，因此她经常在课堂上睡着。  
Farmer John 注意到 Bessie 在课堂上没有专心听讲。他让班上的另一位学生 Elsie 记录 Bessie 在每节课上睡着的次数。总共有 $N$ 节课（$1 \leq N \leq 10^5$），Elsie 记录到 Bessie 在第 $i$ 节课上睡着了 $a_i$ 次（$0 \leq a_i \leq 10^6$）。所有课程中 Bessie 睡着的总次数不超过 $10^6$。

Elsie 对 Bessie 感到非常竞争，她希望让 Farmer John 觉得 Bessie 在每节课上睡着的次数是一致的——让问题看起来完全是 Bessie 的错，而与 Farmer John 有时无聊的讲课无关。Elsie 修改记录的唯一方式是将两节相邻的课合并。例如，如果 $a = [1,2,3,4,5]$，那么如果 Elsie 合并第二和第三节课，记录将变为 $[1,5,4,5]$。

请帮助 Elsie 计算她需要对记录进行的最少修改次数，以使记录中的所有数字相等。

### 输入格式

每个输入包含 $T$（$1 \leq T \leq 10$）个需要独立解决的测试用例。

第一行包含 $T$，表示测试用例的数量。接下来的 $T$ 组测试用例，每组由两行描述。每组的第一行包含 $N$，第二行包含 $a_1, a_2, \ldots, a_N$。

保证每个测试用例中，$a$ 的所有值之和不超过 $10^6$。同时，所有测试用例的 $N$ 之和不超过 $10^5$。

### 输出格式

请输出 $T$ 行，每行表示 Elsie 为使记录中的所有数字相等所需的最少修改次数。

### 提示

对于第一个测试用例，Elsie 可以通过 3 次修改将记录改为全为 $3$：
```
   1 2 3 1 1 1
-> 3 3 1 1 1
-> 3 3 2 1
-> 3 3 3
```

对于第二个测试用例，Elsie 可以通过 2 次修改将记录改为全为 $7$：
```
   2 2 3
-> 2 5
-> 7
```

对于最后一个测试用例，Elsie 不需要进行任何操作，因为记录已经由相同的数字组成。


---

---
title: "[USACO22OPEN] Alchemy B"
layout: "post"
diff: 普及/提高-
pid: P8268
tag: ['二分', 'USACO', '递归', '2022']
---
# [USACO22OPEN] Alchemy B
## 题目描述

总是热衷于培养新的爱好的奶牛 Bessie 正在学习如何转化金属。对于 $1 \le i \le N \le 100$，她有 $a_i$（$0 \le a_i \le 10^4$）单位的金属 $i$。此外，她知道 $K$（$1\le K< N$）个配方，她可以融合若干种金属各一单位，制造一单位编号大于所有被融合金属的金属。另外保证，对于每种金属，Bessie 最多知道一种制造该金属的配方。

计算经过一系列转化后，Bessie 可能拥有的金属 $N$ 的最大单位数。
## 输入格式

输入的第一行包含 $N$。

第二行包含 $N$ 个整数 $a_i$。

第三行包含 $K$。

以下 $K$ 行每行包含两个整数 $L$ 和 $M$（$M\ge 1$），随后是 $M$ 个整数。后 $M$ 个整数表示配方中用于制造一单位金属 $L$ 所需要被融合的金属。输入保证 $L$ 大于这 $M$ 个数。
## 输出格式

输出在应用一系列零次或多次转化后，Bessie 可能拥有的金属 $N$ 的最大单位数。
## 样例

### 样例输入 #1
```
5
2 0 0 1 0
3
5 2 3 4
2 1 1
3 1 2
```
### 样例输出 #1
```
1
```
## 提示

【样例解释】

在这个例子中，以下是一种最优的转化方式：

- 将一单位金属 1 转化为金属 2。
- 将一单位金属 2 转化为金属 3。
- 将一单位金属 3 和金属 4 转化为金属 5。

现在 Bessie 还有一单位金属 1 和一单位金属 5。她无法再制造更多的金属 5。

【测试点性质】

- 测试点 2 中，对于 $1\le i< N$，一单位金属 $i$ 可以被转化为一单位金属 $i+1$；

- 测试点 3-4 中，每个配方均将一单位的一种金属转化为另一种金属；

- 测试点 5-11 没有额外限制。


---

---
title: "[USACO22DEC] Feeding the Cows B"
layout: "post"
diff: 普及/提高-
pid: P8898
tag: ['贪心', 'USACO', '2022', 'Special Judge']
---
# [USACO22DEC] Feeding the Cows B
## 题目描述

Farmer John 有 $N(1 \le N \le 10^5)$ 头奶牛，每头奶牛的品种是更赛牛（Guernsey）或荷斯坦牛（Holstein）之一。她们沿水平方向排成一行，奶牛们占据的位置编号为 $1 \cdots N$。

由于奶牛们都饿了，FJ 决定在 $1 \cdots N$ 中的某些位置上种植草地。更赛牛和荷斯坦牛喜欢不同类型的草，所以如果 Farmer John 决定在某个位置种草，他必须选择种植更赛牛喜欢的草或荷斯坦牛喜欢的草——他不能在同一个位置同时种两种草。种植的每一片草地都可以喂饱数量不限的相应品种的奶牛。 

每头奶牛愿意移动至多 $K(0 \le K \le N-1)$ 个位置以前往一个草地。求出喂饱所有奶牛所需种植的最小草地数量。此外，输出一种使用最小草地数量喂饱所有奶牛的种植方案。任何满足上述条件的方案均视为正确。 
## 输入格式

每个测试用例包含 $T$ 个子测试用例，为一种奶牛的排列。输入的第一行包含 $T(1 \le T \le 10)$。以下是 $T$ 个子测试用例。

每个子测试用例的第一行包含 $N$ 和 $K$。第二行包含一个长度为 $N$ 的字符串，其中第 $i$ 个字符表示第 $i$ 头奶牛的品种（G 表示更赛牛，H 表示荷斯坦牛）。
## 输出格式

对于 $T$ 个子测试用例中的每一个，输出两行。第一行输出喂饱所有奶牛所需的最小草地数量。第二行输出一个长度为 $N$ 的字符串，表示一种使用最小草地数量喂饱所有奶牛的种植方案。第 $i$ 个字符表示第 $i$ 个位置，若不种草则为 $\texttt{.}$，若种植喂饱更赛牛的草则为 $\texttt{G}$，若种植喂饱荷斯坦牛的草则为 $\texttt{H}$。任何合法的方案均可通过。 
## 样例

### 样例输入 #1
```
6
5 0
GHHGG
5 1
GHHGG
5 2
GHHGG
5 3
GHHGG
5 4
GHHGG
2 1
GH
```
### 样例输出 #1
```
5
GHHGG
3
.GH.G
2
..GH.
2
...GH
2
...HG
2
HG
```
## 提示

### 样例 1 解释

注意对于某些子测试用例，存在多种可通过的方案使用最小数量的草地。例如，在第四个子测试用例中，以下是另一个可以通过的答案：

$$\texttt{.GH..}$$

这个方案在第二个位置种植一块喂饱更赛牛的草地以及在第三个位置种植一块喂饱荷斯坦牛的草地。这使用了最小数量的草地并确保了所有奶牛都在她们喜欢的草地的 $3$ 个位置以内。

### 测试点性质

- 测试点 $2-4$ 满足 $N \le 10$。
- 测试点 $5-8$ 满足 $N \le 40$。
- 测试点 $9-12$ 满足 $N \le 10^5$。 


---

---
title: "[USACO22DEC] Reverse Engineering B"
layout: "post"
diff: 普及/提高-
pid: P8899
tag: ['模拟', '贪心', 'USACO', '2022']
---
# [USACO22DEC] Reverse Engineering B
## 题目描述

Elsie 有一个程序，接受一个 $N(1 \le N \le 100)$ 个变量的数组 $b[0], \cdots ,b[N−1]$ 作为输入，其中每个变量等于 $0$ 或 $1$，并且返回对输入数组应用一系列 `if / else if / else` 语句的结果。每个语句检查至多一个输入变量的值，并返回 $0$ 或 $1$。这类程序的一个例子是：

```cpp
if (b[1] == 1) return 1;
else if (b[0] == 0) return 0;
else return 1;
```

例如，如果上方程序的输入是 "10"（即 $b[0]=1$ 及 $b[1]=0$），那么输出应当为 $1$。 

Elsie 告诉了 Bessie 对于 $M(1 \le M \le 100)$ 个不同输入的正确输出。Bessie 现在正试图对 Elsie 的程序进行逆向工程。不幸的是，Elsie 可能说了谎；可能不存在上述形式的程序行为与 Elsie 所说的均一致。 

对于 $T(1 \le T \le 10)$ 个子测试用例中的每一个，判断 Elsie 是否一定在说谎。
## 输入格式

输入的第一行包含 $T$，为子测试用例的数量。

每一个子测试用例的第一行包含两个整数 $N$ 和 $M$，以下 $M$ 行，每行包含一个由 $N$ 个 $0$ 或 $1$ 组成的字符串，表示一个输入（即 $b[0] \cdots b[N−1]$ 的值），以及另一个字符（$0$ 或 $1$）表示输出。相邻的子测试用例之间用空行分隔。 
## 输出格式

对于每一个子测试用例，输出一行，包含 $\texttt{OK}$ 或 $\texttt{LIE}$，分别表示 Elsie 可能没有说谎或是一定在说谎。 
## 样例

### 样例输入 #1
```
4

1 3
0 0
0 0
1 1

2 4
00 0
01 1
10 1
11 1

1 2
0 1
0 0

2 4
00 0
01 1
10 1
11 0
```
### 样例输出 #1
```
OK
OK
LIE
LIE
```
## 提示

### 样例 1 解释

以下是第一个子测试用例的一个合法的程序：

```cpp
if (b[0] == 0) return 0;
else return 1;
```

以下是第一个子测试用例的另一个合法的程序：

```cpp
if (b[0] == 1) return 1;
else return 0;
```

以下是第二个子测试用例的一个合法的程序：

```cpp
if (b[1] == 1) return 1;
else if (b[0] == 0) return 0;
else return 1;
```

显然，对于第三个子测试用例不存在对应的合法的程序，因为 Elsie 的程序一定始终对相同的输入产生相同的输出。

可以证明对于最后一个子测试用例不存在对应的合法的程序。 

### 测试点性质

- 测试点 $2-3$ 满足 $N=2$。
- 测试点 $4-5$ 满足 $M=2$。
- 测试点 $6-12$ 没有额外限制。 


---

---
title: "[USACO23JAN] Following Directions S"
layout: "post"
diff: 普及/提高-
pid: P9014
tag: ['模拟', '搜索', 'USACO', '2023', '深度优先搜索 DFS']
---
# [USACO23JAN] Following Directions S
## 题目描述

**Note: The time limit for this problem is 8s, four times the default.** 

Farmer John has a big square field split up into an $(N+1) \times (N+1) (1 \le N \le 1500)$ grid of cells. Let cell $(i,j)$ denote the cell in the $i$-th row from the top and $j$-th column from the left. There is one cow living in every cell $(i,j)$ such that $1 \le i,j \le N$, and each such cell also contains a signpost pointing either to the right or downward. Also, every cell $(i,j)$ such that either $i=N+1$ or $j=N+1$, except for $(N+1,N+1)$, contains a vat of cow feed. Each vat contains cow feed of varying price; the vat at $(i,j)$ costs $c_{i,j} (1 \le c_{i,j} \le 500)$ to feed each cow.

Every day at dinner time, Farmer John rings the dinner bell, and each cow keeps following the directions of the signposts until it reaches a vat, and is then fed from that vat. Then the cows all return to their original positions for the next day.

To maintain his budget, Farmer John wants to know the total cost to feed all the cows each day. However, during every day, before dinner, the cow in in some cell $(i,j)$ flips the direction of its signpost (from right to down or vice versa). The signpost remains in this direction for the following days as well, unless it is flipped back later.

Given the coordinates of the signpost that is flipped on each day, output the cost for every day (with $Q$ days in total, $1 \le Q \le 1500$). 
## 输入格式

The first line contains $N (1 \le N \le 1500)$.

The next $N+1$ lines contain the rows of the grid from top to bottom, containing the initial directions of the signposts and the costs ci,j of each vat. The first $N$ of these lines contain a string of $N$ directions `R` or `D` (representing signposts pointing right or down, respectively), followed by the cost $c_{i,N+1}$. The $(N+1)$-th line contains $N$ costs $c_{N+1,j}$.

The next line contains $Q(1 \le Q \le 1500)$.

Then follow $Q$ additional lines, each consisting of two integers $i$ and $j (1 \le i,j \le N)$, which are the coordinates of the cell whose signpost is flipped on the corresponding day. 
## 输出格式

$Q+1$ lines: the original value of the total cost, followed by the value of the total cost after each flip. 
## 样例

### 样例输入 #1
```
2
RR 1
DD 10
100 500
4
1 1
1 1
1 1
2 1
```
### 样例输出 #1
```
602
701
602
701
1501
```
## 提示

### Explanation for Sample 1

Before the first flip, the cows at $(1,1)$ and $(1,2)$ cost $1$ to feed, the cow at $(2,1)$ costs $100$ to feed, and the cow at $(2,2)$ costs $500$ to feed, for a total cost of $602$. After the first flip, the direction of the signpost at $(1,1)$ changes from `R` to `D`, and the cow at $(1,1)$ now costs $100$ to feed (while the others remain unchanged), so the total cost is now $701$. The second and third flips switch the same sign back and forth. After the fourth flip, the cows at $(1,1)$ and $(2,1)$ now cost $500$ to feed, for a total cost of $1501$.

### Scoring

 - Inputs $2-4$: $1 \le N,Q \le 50$
 - Inputs $5-7$: $1 \le N,Q \le 250$
 - Inputs $2-10$: The initial direction in each cell, as well as the queries, are uniformly randomly generated.
 - Inputs $11-15$: No additional constraints.
## 题目翻译

## 题目描述

**注：本题时限为 8s，是默认时限的四倍。**

Farmer John 有一个正方形的草地，草地被划分为了 $(N + 1) \times (N + 1)(1 \leq N \leq 1500)$ 的格子。设 $(i, j)$ 为从上到下、从左到右第 $i$ 行，第 $j$ 列的格子。每个满足 $1 \leq i, j \leq n$ 的格子 $(i, j)$ 之中都住着一头牛，而且每个这样的格子上都有一个路标指向右或下。除此之外，所有满足 $i = N + 1$ 或 $j = N + 1$ 的格子，除了 $(N + 1, N + 1)$ 都会有一个饲料桶。牛在每个饲料桶进食需要的价格不同；位置 $(i, j)$ 上的桶喂饱一只牛需要价格 $c_{i, j}(1 \leq c_{i, j} \leq 500)$。

每天晚饭时间，Farmer John 摇响晚餐铃时，所有牛都沿着路标的指向前进，直到它们遇到了饲料桶，之后它们会在它们自己遇到的饲料桶那里进食。第二天，所有牛又会回到自己原来的位置。

为了维持预算，Farmer John 想要知道每天喂食需要的价钱。然而，每天晚饭之前，总会有一头牛 $(i, j)$ 翻转它那里的路标（原来向下则变成向右，反之亦然）。被翻转的路标指向将在后面的日子里保持不变，除非它又被进行了翻转。

给出每天被翻转的路标的坐标，请输出每天喂食需要的价格（总共有 $Q$ 天，$1 \leq Q \leq 1500$）。

## 输入格式

第一行为 $N(1 \leq N \leq 1500)$

接下来的 $N + 1$ 行从上到下输入初始的路标朝向和每个饲料桶的价格 $c_{i, j}$。前 $N$ 行每行包含一个长度为 $N$ 的字符串，其中每个字符只能是 `R` 或 `D`（`R` 表示向右，`D` 表示向下），之后是一个数，表示价格 $c_{i, N + 1}$，第 $(N + 1)$ 行包含 $N$ 个数，依次表示价格 $c_{N + 1, j}$。

接下来的一行为 $Q(1 \leq Q \leq 1500)$。

之后的 $Q$ 行，每行有两个整数 $i$ 和 $j(1 \leq i, j \leq N$，表示每天被翻转的路标的坐标。

## 输出格式

共 $Q + 1$ 行：第一行是初始的总价格，之后 $Q$ 行依次是每次被翻转后的总价格。

## 说明/提示

### 样例 1 解释

在第一次翻转之前，喂养在位置 $(1, 1)$ 和 $(1, 2)$ 的牛需要的价格都为 $1$，喂养在 $(2, 1)$ 的牛需要的价格为 $100$，喂养在 $(2, 2)$ 的牛需要的价格为 $500$。总价格为 $602$。第一次翻转后，在 $(1, 1)$ 处的路标由 `R` 变为 `D`，此时在位置 $(1, 1)$ 的牛喂养的价格变为 $100$（其它牛的价格没有变化），所以总价为 $701$。第二次和第三次翻转都在来回翻转同一个路标。第四次翻转后，在位置 $(1, 1)$ 和位置 $(2, 1)$ 的牛喂养的价格变为 $500$，总价变为 $1501$。

### 数据范围

- 测试点 $2 - 4$ 中：$1 \leq N, Q \leq 50$。

- 测试点 $5 - 7$ 中：$1 \leq N, Q \leq 250$。

- 测试点 $2 - 10$ 中：每个路标初始朝向以及被翻转的路标为随机生成。

- 测试点 $11 - 15$ 中：无特殊条件。


---

---
title: "[USACO23FEB] Cow-libi S"
layout: "post"
diff: 普及/提高-
pid: P9125
tag: ['二分', 'USACO', '2023']
---
# [USACO23FEB] Cow-libi S
## 题目描述

**Note: The time limit for this problem is 4s, two times the default.**

Somebody has been grazing in Farmer John's $G(1 \le G \le 10^5)$ private gardens! Using his expert forensic knowledge, FJ has been able to determine the precise time each garden was grazed. He has also determined that there was a single cow that was responsible for every grazing incident. 

In response to these crimes each of FJ's $N(1 \le N \le 10^5)$ cows have provided an alibi that proves the cow was in a specific location at a specific time. Help FJ test whether each of these alibis demonstrates the cow's innocence. 

A cow can be determined to be innocent if it is impossible for her to have travelled between all of the grazings and her alibi. Cows travel at a rate of $1$ unit distance per unit time. 
## 输入格式

The first line of input will contain $G$ and $N$ separated by a space.

The next $G$ lines contain the integers $x, y$, and $t (−10^9 \le x,y \le 10^9;0 \le t \le 10^9)$

separated by a space describing the location and time of the grazing. It will always be possible for a single cow to travel between all grazings.

The next $N$ lines contain $x$, $y$, and $t(−10^9 \le x,y \le 10^9;0 \le t \le 10^9)$ separated by a space describing the location and time of each cow's alibi. 
## 输出格式

Output a single integer: the number of cows with alibis that prove their innocence. 
## 样例

### 样例输入 #1
```
2 4
0 0 100
50 0 200
0 50 50
1000 1000 0
50 0 200
10 0 170
```
### 样例输出 #1
```
2
```
## 提示

### Explanation for Sample 1

There were two grazings; the first at $(0,0)$ at time 100 and the second at $(50,0)$ at time $200$.

The first cow's alibi does not prove her innocence. She has just enough time to arrive at the first grazing.

The second cow's alibi does prove her innocence. She is nowhere near any of the grazings.

Unfortunately for the third cow, being at the scene of the crime does not prove innocence.

Finally, the fourth cow is innocent because it's impossible to make it from her alibi to the final grazing in time. 

### SCORING

 - Inputs $2-4$: $1 \le G,N \le 10^3$. Also, for both the fields and alibis, $−10^6 \le x,y \le 10^6$ and $0 \le t \le 10^6$.
 - Inputs $5-11$: No additional constraints.
## 题目翻译

### 题目描述

注意：本题的时间限制为 4 秒，是默认限制的两倍。

有人在 Farmer John 的 $G(1 \leq G \leq 10^5)$ 个私人花园里偷吃了庄稼！通过他的专业法医知识，Farmer John 确定了每个花园被偷吃的具体时间。他还发现，这些事件的罪魁祸首是一头单独的奶牛。

为了回应这些犯罪行为，Farmer John 的 $N(1 \leq N \leq 10^5)$ 头奶牛每头都提供了一个不在作案现场的证明（即“不在场证明”），表明奶牛在特定时间出现在特定位置。请帮助 Farmer John 判断这些“不在场证明”中哪些能够证明奶牛的清白。

如果一头奶牛无法在她的“不在场证明”位置与所有被偷吃地点之间往返，则可以确定这头奶牛是清白的。奶牛的移动速度为每单位时间 $1$ 单位距离。本题中提到的距离均为欧几里得距离。

### 输入格式

第一行包含两个用空格分隔的整数 $G$ 和 $N$。

接下来的 $G$ 行，每行包含三个用空格分隔的整数 $x, y, t$（$-10^9 \leq x, y \leq 10^9; 0 \leq t \leq 10^9$），描述某次偷吃事件的地点和时间。可以保证单独一头奶牛可以在所有被偷吃地点之间往返。

接下来的 $N$ 行，每行包含 $x, y, t$（$-10^9 \leq x, y \leq 10^9; 0 \leq t \leq 10^9$），描述某头奶牛的“不在场证明”中提到的位置和时间。

### 输出格式

输出一个整数，表示能够证明清白的奶牛的数量。

### 样例 1 的解释

共有两次偷吃事件，第一次发生在 $(0,0)$，时间为 $100$；第二次发生在 $(50,0)$，时间为 $200$。

- 第一头奶牛的“不在场证明”无法证明她的清白。她刚好有足够的时间到达第一次偷吃事件的地点。
- 第二头奶牛的“不在场证明”能够证明她的清白。她远离任何偷吃事件的地点。
- 不幸的是，第三头奶牛在偷吃事件的现场，这并不能证明她的清白。
- 最后，第四头奶牛是清白的，因为她不可能在时间限制内从她的“不在场证明”地点赶到最后一次偷吃事件的地点。

### 评分标准

- 测试点 $2-4$：$1 \leq G, N \leq 10^3$。此外，对于偷吃地点和“不在场证明”，$-10^6 \leq x, y \leq 10^6$ 且 $0 \leq t \leq 10^6$。
- 测试点 $5-11$：无额外限制。


---

---
title: "[USACO21OPEN] Acowdemia III B"
layout: "post"
diff: 普及/提高-
pid: P9939
tag: ['贪心', 'USACO', '2021', 'O2优化', '分类讨论']
---
# [USACO21OPEN] Acowdemia III B
## 题目描述

Bessie 是一位忙碌的计算机科学研究生。然而，即使是研究生也需要交友。因此，Farmer John 开设了一片草地，目的是为了帮助 Bessie 与其他奶牛建立持久的友谊。

Farmer John 的草地可以被看做是由正方形方格组成的巨大二维方阵（想象一个巨大的棋盘）。每个方格用如下字符标记：

 - `C`，如果这个方格中有一头奶牛。
 - `G`，如果这个方格中有草。
 - `.`，如果这个方格既没有奶牛也没有草。

对于两头想要成为朋友的奶牛，她们必须选择在一个与她们均水平或竖直方向上相邻的有草方格见面。在这个过程中，她们会在这个有草方格中吃草，所以之后的奶牛不能再使用这个方格作为见面地点。一头奶牛可以与多头其他奶牛成为朋友，但是同一对奶牛不能见面并成为朋友多于一次。

Farmer John 希望有许多奶牛可以见面并成为朋友。请求出当这一活动结束时在奶牛之间可以建立的朋友关系的最大数量。 
## 输入格式

输入的第一行包含 $N$ 和 $M$（$1\le N,M\le 1000$）。

以下 $N$ 行每行包含一个由 $M$ 个字符组成的字符串，表示这个草地。
## 输出格式

输出在这一活动结束时在奶牛之间可以建立的朋友关系的最大数量
## 样例

### 样例输入 #1
```
4 5
.CGGC
.CGCG
CGCG.
.CC.C
```
### 样例输出 #1
```
4
```
## 提示

### 样例解释 1

如果我们用坐标 $(i,j)$ 标记第 $i$ 行第 $j$ 列的奶牛，则在这个样例中于 $(1,2)$、$(1,5)$、$(2,2)$、$(2,4)$、$(3,1)$、$(3,3)$、$(4,2)$、$(4,3)$ 以及 $(4,5)$ 
存在奶牛。一种使四对奶牛成为朋友的方式如下：

 - 位于 $(2,2)$ 和 $(3,3)$ 的奶牛于 $(3,2)$ 一起吃草。
 - 位于 $(2,2)$ 和 $(2,4)$ 的奶牛于 $(2,3)$ 一起吃草。
 - 位于 $(2,4)$ 和 $(3,3)$ 的奶牛于 $(3,4)$ 一起吃草。
 - 位于 $(2,4)$ 和 $(1,5)$ 的奶牛于 $(2,5)$ 一起吃草。


### 测试点性质

 - 测试点 $2-4$ 满足 $N=2$。
 - 测试点 $5-12$ 没有额外限制。


---

---
title: "[USACO20JAN] Race B"
layout: "post"
diff: 普及/提高-
pid: P9948
tag: ['数学', '贪心', '2020', '二分', 'USACO', 'O2优化']
---
# [USACO20JAN] Race B
## 题目描述

Bessie 正在参加一场 $K$（$1\le K\le 10^9$）米的跑步比赛。她从 $0$ 米每秒的速度开始比赛。在每一秒中，她可以选择将她的速度增加 $1$ 米每秒，保持速度不变，或者将她的速度减少 $1$ 米每秒。例如，在第一秒中，她可以将她的速度增加到 $1$ 米每秒，跑 $1$ 米，或者保持她的速度 $0$ 米每秒不变，跑 $0$ 米。Bessie 的速度不会降低到小于零。

Bessie 始终朝着终点线的方向跑，她想要花费整数秒的时间完成比赛。此外，她不想在终点时跑得太快：在 Bessie 跑完 $K$ 米的时刻，她希望她的速度不超过 $X$（$1\le X\le 10^5$）米每秒。Bessie 想要对于 $N$（$1\le N\le 1000$）个不同的 $X$ 值知道她多快可以完成比赛。 
## 输入格式

输入的第一行包含两个整数 $K$ 和 $N$。

以下 $N$ 行每行包含一个整数 $X$。 
## 输出格式

输出 $N$ 行，每行包含一个整数，表示 Bessie 完成比赛时的速度小于或等于 $X$ 的情况下跑完 $K$ 米需要的最小时间。 
## 样例

### 样例输入 #1
```
10 5
1
2
3
4
5
```
### 样例输出 #1
```
6
5
5
4
4
```
## 提示

### 样例解释 1

当 $X=1$ 时，一种最优方案为：

1. 将速度增加到 $1$ 米/秒，跑 $1$ 米
2. 将速度增加到 $2$ 米/秒，跑 $2$ 米，总计跑 $3$ 米
3. 将速度保持在 $2$ 米/秒，总计跑 $5$ 米
4. 将速度保持在 $2$ 米/秒，总计跑 $7$ 米
5. 将速度保持在 $2$ 米/秒，总计跑 $9$ 米
6. 将速度降低到 $1$ 米/秒，总计跑 $10$ 米

当 $X=3$ 时，一种最优方案为：

1. 将速度增加到 $1$ 米/秒，跑 $1$ 米
2. 将速度增加到 $2$ 米/秒，总计跑 $3$ 米
3. 将速度增加到 $3$ 米/秒，总计跑 $6$ 米
4. 将速度保持在 $3$ 米/秒，总计跑 $9$ 米
5. 将速度保持在 $3$ 米/秒，总计跑 $12$ 米

注意当 $X=3$ 时，以下方案是不合法的：

1. 将速度增加到 $1$ 米/秒，跑 $1$ 米
2. 将速度增加到 $2$ 米/秒，总计跑 $3$ 米
3. 将速度增加到 $3$ 米/秒，总计跑 $6$ 米
4. 将速度增加到 $4$ 米/秒，总计跑 $10$ 米

这是因为在 Bessie 跑完 $10$ 米的时刻，她的速度是 $4$ 米/秒。 


---

---
title: "[USACO20FEB] Swapity Swap B"
layout: "post"
diff: 普及/提高-
pid: P9951
tag: ['模拟', '数学', '2020', 'USACO', 'O2优化']
---
# [USACO20FEB] Swapity Swap B
## 题目描述

Farmer John 的 $N$ 头奶牛（$1\le N\le 100$）站成一排。对于每一个 $1\le i\le N$，从左往右数第 $i$ 头奶牛的编号为 $i$。

Farmer John 想到了一个新的奶牛晨练方案。他让她们重复以下包含两个步骤的过程 $K$（$1\le K\le 10^9$）次：

1. 当前从左往右数在位置 $A_1\ldots A_2$ 的奶牛序列反转她们的顺序（$1\le A1<A2\le N$）。
2. 然后，在当前从左往右数在位置 $B_1\ldots B_2$的奶牛序列反转她们的顺序（$1\le B_1<B_2\le N$）。

当奶牛们重复这一过程 $K$ 次后，请对每一个 $1\le i\le N$ 输出从左往右数第 $i$ 头奶牛的编号。 
## 输入格式

输入的第一行包含 $N$ 和 $K$。第二行包含 $A_1$ 和 $A_2$，第三行包含 $B_1$ 和 $B_2$。
## 输出格式

在第 $i$ 行输出晨练结束时从左往右数第 $i$ 头奶牛的编号。 
## 样例

### 样例输入 #1
```
7 2
2 5
3 7
```
### 样例输出 #1
```
1
2
4
3
5
7
6
```
## 提示

### 样例解释 1

初始时，奶牛们的顺序从左往右为 $[1,2,3,4,5,6,7]$。在这一过程的第一步过后，顺序变为 $[1,5,4,3,2,6,7]$。在这一过程的第二步过后，顺序变为 $[1,5,7,6,2,3,4]$。再重复这两个步骤各一次可以得到样例的输出。 

### 测试点性质

- 测试点 $2-3$ 满足 $K\le 100$。
- 测试点 $4-13$ 没有额外限制。


---

---
title: "[USACO20OPEN] Social Distancing I B"
layout: "post"
diff: 普及/提高-
pid: P9952
tag: ['贪心', '2020', '二分', 'USACO', 'O2优化']
---
# [USACO20OPEN] Social Distancing I B
## 题目描述

一种新型疾病，COWVID-19，开始在全世界的奶牛之间传播。Farmer John 正在采取尽可能多的预防措施来防止他的牛群被感染。

Farmer John 的牛棚是一个狭长的建筑物，有一排共 $N$ 个牛栏（$2\le N\le 10^5$）。有些牛栏里目前有奶牛，有些目前空着。得知“社交距离”的重要性，Farmer John 希望使得 $D$ 尽可能大，其中 $D$ 为最近的两个有奶牛的牛栏的距离。例如，如果牛栏 $3$ 和 $8$ 是最近的有奶牛的牛栏，那么 $D=5$。

最近两头奶牛新来到 Farmer John 的牛群，他需要决定将她们分配到哪两个之前空着的牛栏。请求出他如何放置这两头新来的奶牛，使得 $D$ 仍然尽可能大。Farmer John 不能移动任何已有的奶牛；他只想要给新来的奶牛分配牛栏。 
## 输入格式

输入的第一行包含 $N$。下一行包含一个长为 $N$ 的字符串，由 $0$ 和 $1$ 组成，描述牛棚里的牛栏。$0$ 表示空着的牛栏，$1$ 表示有奶牛的牛栏。字符串中包含至少两个 $0$，所以有至少有足够的空间安置两头新来的奶牛。
## 输出格式

输出 Farmer John 以最优方案在加入两头新来的奶牛后可以达到的最大 $D$ 值（最近的有奶牛的牛栏之间的距离）。 
## 样例

### 样例输入 #1
```
14
10001001000010
```
### 样例输出 #1
```
2
```
## 提示

### 样例解释 1

在这个例子中，Farmer John 可以以这样的方式加入奶牛，使得牛栏分配变为 `10x010010x0010`，其中 `x` 表示新来的奶牛。此时 $D=2$。不可能在加入奶牛之后取到更大的 $D$ 值。 

### 测试点性质

- 测试点 $2-6$ 满足 $N\le 10$。
- 测试点 $7-8$ 满足 $N\le 100$。
- 测试点 $9-11$ 满足 $N\le 5000$。
- 测试点 $12-15$ 没有额外限制。


---

---
title: "[USACO20OPEN] Cowntact Tracing B"
layout: "post"
diff: 普及/提高-
pid: P9954
tag: ['模拟', '2020', 'USACO', 'O2优化', '枚举', '排序']
---
# [USACO20OPEN] Cowntact Tracing B
## 题目描述

由于高传染性的牛传染病 COWVID-19 的爆发，Farmer John 非常担忧他的奶牛们（编号为 $1\ldots N$）的健康。

最近，Farmer John 对他的所有奶牛进行了检测，发现有一部分奶牛对该疾病的检测结果呈阳性。利用牛棚内的视频监控，他得以查看最近的奶牛之间的互动行为，结果发现奶牛们互相打招呼时，她们会握蹄，不幸的是这是一种会将疾病从一头奶牛传播给另一头奶牛的行为。Farmer John 汇总了一个添加了时间戳的清单，每条数据的形式为 $(t,x,y)$，表示在时间 $t$，奶牛 $x$ 与奶牛 $y$ 握了蹄。Farmer John 同时还知道以下信息：

（一）他的农场上恰有一头奶牛最初带有携带疾病（我们将这头奶牛称为“零号病人”）。

（二）一旦一头奶牛被感染，她会在接下来的 $K$ 次握蹄中传染疾病（可能会与同一头奶牛握蹄多次）。握蹄 $K$ 次后，她不再在此后的握蹄中传染疾病（因为此时她意识到了她会传染疾病，于是会仔细地洗蹄）。

（三）一旦一头奶牛被感染，她会持续处于被感染状态。

不幸的是，Farmer John 不知道他的 $N$ 头奶牛中的哪一头是零号病人，也不知道 $K$ 的值！基于他的数据，请帮助他缩小这些未知量的范围。保证至少有一种可能的情况。 
## 输入格式

输入的第一行包含 $N$（$2\le N\le 100$）和 $T$（$1\le T\le 250$）。下一行包含一个长为 $N$ 的字符串，每个字符均为 $0$ 或 $1$，表述目前 Farmer John 的 $N$ 头奶牛的状态——$0$ 表示一头健康的奶牛，$1$ 表示一头染病的奶牛。以下 $T$ 行每行包含 Farmer John 的互动清单中的一条记录，由三个整数 $t$、$x$ 和 $y$ 组成，其中 $t$ 为一次互动发生的正整数时间（$t\le 250$），$x$ 和 $y$ 为范围 $1\ldots N$ 内的不同整数，表示时间 $t$ 握蹄的两头奶牛。在每一时刻至多只有一次互动发生。 
## 输出格式

输出一行，包含三个整数 $x$、$y$ 和 $z$，其中 $x$ 为可能为零号病人的奶牛数量，$y$ 为与数据一致的最小可能 $K$ 值，$z$ 为与数据一致的最大可能 $K$ 值（如果通过数据无法推断 $K$ 的上界，$z$ 输出 `Infinity`）。注意可能有 $K=0$。 
## 样例

### 样例输入 #1
```
4 3
1100
7 1 2
5 2 3
6 2 4
```
### 样例输出 #1
```
1 1 Infinity
```
## 提示

### 样例解释 1

唯一可能是零号病人的是奶牛 $1$。对于所有的 $K>0$，奶牛 $1$ 在时刻 $7$ 感染奶牛 $2$，而奶牛 $3$ 和奶牛 $4$ 均不会被感染。 


---

---
title: "[USACO20DEC] Stuck in a Rut B"
layout: "post"
diff: 普及/提高-
pid: P9957
tag: ['2020', 'USACO', 'O2优化', '枚举', '排序']
---
# [USACO20DEC] Stuck in a Rut B
## 题目描述

Farmer John 最近扩大了他的农场，从奶牛们的角度看来这个农场相当于是无限大了！奶牛们将农场上放牧的区域想作是一个由正方形方格组成的无限大二维方阵，每个方格中均有美味的草（将每个方格看作是棋盘上的一个方格）。Farmer John 的 $N$ 头奶牛（$1\le N\le 50$）初始时位于不同的方格中，一部分朝向北面，一部分朝向东面。

每一小时，每头奶牛会执行以下二者之一：

 - 如果她当前所在的方格里的草已经被其他奶牛吃掉了，则她会停下。
 - 吃完她当前所在的方格中的所有草，并向她朝向的方向移动一个方格。

经过一段时间，每头奶牛的身后会留下一条被啃秃了的轨迹。

如果两头奶牛在一次移动中移动到了同一个有草的方格，她们会分享这个方格中的草，并在下一个小时继续沿她们朝向的方向移动。

请求出每头奶牛吃到的草的数量。有些奶牛永远不会停下，从而吃到无限多的草。 
## 输入格式

输入的第一行包含 $N$。以下 $N$ 行，每行描述一头奶牛的起始位置，包含一个字符 `N`（表示朝向北面） 或 `E`（表示朝向东面），以及两个非负整数 $x$ 和 $y$（$0\le x\le 10^9$，$0\le y\le 10^9$）表示方格的坐标。所有 $x$ 坐标各不相同，所有 $y$ 坐标各不相同。

为了使方向和坐标尽可能明确，如果一头奶牛位于方格 $(x,y)$ 并向北移动，她会到达方格 $(x,y+1)$。如果她向东移动，她会到达方格 $(x+1,y)$。
## 输出格式

输出 $N$ 行。输出的第 $i$ 行包含输入中的第 $i$ 头奶牛吃到草的方格的数量。如果一头奶牛可以吃到无限多的草，为这头奶牛输出 `Infinity`。
## 样例

### 样例输入 #1
```
6
E 3 5
N 5 3
E 4 6
E 10 4
N 11 2
N 8 1
```
### 样例输出 #1
```
5
3
Infinity
Infinity
2
5
```
## 提示

### 测试点性质

 - 测试点 $2-5$ 中，所有坐标不超过 $100$。
 - 测试点 $6-10$ 没有额外限制。


---

---
title: "[USACO23DEC] Candy Cane Feast B"
layout: "post"
diff: 普及/提高-
pid: P9974
tag: ['模拟', 'USACO', '2023', 'O2优化']
---
# [USACO23DEC] Candy Cane Feast B
## 题目描述

Farmer John 的奶牛对甜食情有独钟，它们尤其喜欢吃糖果棒。FJ 共有 $N$ 头奶牛，每头奶牛都有一个特定的初始高度。他想要喂它们 $M$ 根糖果棒，每根糖果棒的高度也各不相同（$1 \le N,M \le 2\cdot 10^5$）。

FJ 计划按照输入给出的顺序，逐一喂给奶牛们糖果棒。然后，奶牛们会按照输入给出的顺序一个接一个地排队，走向糖果棒，每头奶牛最多吃到与它高度相同的部分（因为它们够不到更高的地方）。即使奶牛吃掉了糖果棒的底部，糖果棒也在最初悬挂的地方保持不动，并不会被降低到地面。如果糖果棒的底部已经高于某头奶牛的高度，那么这头奶牛在它的回合中可能什么也吃不到。每头奶牛轮流吃过后，它们的身高会增加它们吃掉的糖果棒的单位数量，然后农夫约翰挂上下一根糖果棒，奶牛们再次重复这个过程（第一头奶牛再次成为第一个开始吃下一根糖果棒的）。
## 输入格式

第一行包含 $N$ 和 $M$。

接下来的一行包含 $N$ 头奶牛的初始高度，每头奶牛的高度都在 $[1,10^9]$ 的范围内。

接下来的一行包含 $M$ 根糖果棒的长度，每根糖果棒的长度都在 $[1,10^9]$ 的范围内。
## 输出格式

输出 $N$ 行，表示每头奶牛最终的高度。

请注意，由于这个问题涉及的整数大小较大，可能需要使用 64 位整数数据类型（例如，在 C/C++ 中使用 `long long` 类型）。
## 样例

### 样例输入 #1
```
3 2
3 2 5
6 1
```
### 样例输出 #1
```
7
2
7
```
## 提示

### 样例解释 1

第一根糖果棒高度为 $6$ 单位。

- 第一头奶牛吃掉了第一根糖果棒直至高度 $3$ 的部分，之后第一根糖果棒剩余高度 $[3,6]$ 的部分。
- 第二头奶牛不够高，无法吃掉第一根糖果棒的任何剩余部分。
- 第三头奶牛额外吃掉了第一根糖果棒的两个单位。第一根糖果棒的剩余高度 $[5,6]$ 的部分未被吃掉。

接下来，每头奶牛根据它吃掉的数量增长，所以奶牛的高度变为 $[3+3, 2+0, 5+2]=[6, 2, 7]$。

第二根糖果棒高度为 $1$ 单位，被第一头奶牛全部吃掉。

### 测试点性质

- 测试点 $2-10$ 满足 $N,M \le 10^3$。
- 测试点 $11-14$ 没有额外限制。



---

---
title: "[USACO23DEC] Cowntact Tracing 2 B"
layout: "post"
diff: 普及/提高-
pid: P9975
tag: ['贪心', '二分', 'USACO', '2023', 'O2优化']
---
# [USACO23DEC] Cowntact Tracing 2 B
## 题目描述

Farmer John 有 $N$ 头奶牛排成一列（$1 \leq N \leq 3\cdot 10^5$）。不幸的是，有一种疾病正在传播。

最初，有一些奶牛被感染。每到夜晚，被感染的奶牛会将疾病传播给它左右两边的奶牛（如果这些奶牛存在的话）。一旦奶牛被感染，她就会持续处于感染状态。

经过一些晚上，Farmer John 意识到情况已经失控，因此他对奶牛进行了检测以确定哪些奶牛感染了疾病。请找出最少有多少头奶牛最初可能感染了这种疾病。
## 输入格式

第一行为一个整数 $N$，即 Farmer John 拥有的奶牛数量。

接下来一行，包含长度为 $N$ 的由 $1$ 和 $0$ 组成的位串。其中 $1$ 表示一头被感染的奶牛，$0$ 表示一头在经过若干晚之后仍未被感染的奶牛。
## 输出格式

输出一个整数，表示最少有多少头奶牛可能最初感染了这种疾病。
## 样例

### 样例输入 #1
```
5
11111
```
### 样例输出 #1
```
1
```
### 样例输入 #2
```
6
011101
```
### 样例输出 #2
```
4
```
## 提示

### 样例解释 1

假设只有中间的奶牛最初被感染。那么，奶牛们将按以下顺序被感染：

- 第 $0$ 晚：$00100$（第三只奶牛一开始被感染）
- 第 $1$ 晚：$01110$（第二和第四只奶牛现在被感染了）
- 第 $2$ 晚：$11111$（第一和第五只奶牛现在被感染了）
- 第 $3$ 晚：$11111$（所有的奶牛都已经被感染了，没有新的奶牛被感染）
- ……

经过两个或更多的晚上，奶牛们的状态即与输入的状态相符。还有许多其他的初始状态和夜晚数量可能导致了输入的状态，例如：

- 第 $0$ 晚：$10001$
- 第 $1$ 晚：$11011$
- 第 $2$ 晚：$11111$

或者：

- 第 $0$ 晚：$01001$
- 第 $1$ 晚：$11111$

或者：

- 第 $0$ 晚：$01000$
- 第 $1$ 晚：$11100$
- 第 $2$ 晚：$11110$
- 第 $3$ 晚：$11111$

所有这些初始状态中至少有一头奶牛被感染。

### 样例解释 2

唯一可能导致这个最终状态的初始状态和夜晚数是：没有经过任何夜晚，输入中的四头感染的奶牛都是从最开始就感染了这种疾病。

### 测试点性质

- 测试点 $3-7$ 满足 $N \le 1000$。
- 测试点 $8-12$ 没有额外限制。


---

---
title: "[USACO23DEC] Farmer John Actually Farms B"
layout: "post"
diff: 普及/提高-
pid: P9976
tag: ['数学', 'USACO', '2023', 'O2优化']
---
# [USACO23DEC] Farmer John Actually Farms B
## 题目描述

Farmer John 在他的农场上种植了 $N$（$1 \leq N \leq 2\cdot 10^5$） 株芦笋！然而，其中有一些植物存在基因差异，长得比其他植物快。第 $i$ 株植物的初始高度为 $h_i$ 英寸，之后每天，第 $i$ 株植物长高 $a_i$ 英寸。

FJ 更加钟爱其中的一些植物。他将给你一组由不同整数组成的数组 $t_1,\dots,t_N$，这个数组包含 $0$ 到 $N-1$ 的全部整数。他希望恰好有 $t_i$ 株植物比第 $i$ 株植物高。找到最少要经过多少天，才能满足 FJ 的要求，或者报告这个要求是不可能满足的。
## 输入格式

**每个测试点中包含多组测试数据。**

第一行为一个整数 $T$，代表测试数据组数（$1 \leq T \leq 10$）。

对于每一组测试数据，第一行一个整数 $N$（$1 \leq N \leq 2\cdot 10^5$），表示植物数量。

第二行包含 $N$ 个整数 $h_i$（$1 \leq h_i \leq 10^9$），表示第 $i$ 株植物的初始高度。

第三行包含 $N$ 个整数 $a_i$（$1 \leq a_i \leq 10^9$），表示第 $i$ 株植物每天增长的高度。

第四行包含 $N$ 个不同的整数 $t_i$，表示 FJ 给你的数组。

保证所有测试数据的 $N$ 的和不超过 $2\cdot 10^5$。
## 输出格式

输出 $T$ 行，每行表示一组测试数据的答案。如果要求不可能满足，输出 $-1$。

请注意，由于这个问题涉及的整数大小较大，可能需要使用 64 位整数数据类型（例如，在 C/C++ 中使用 `long long` 类型）。
## 样例

### 样例输入 #1
```
6
1
10
1
0
2
7 3
8 10
1 0
2
3 6
10 8
0 1
2
7 3
8 9
1 0
2
7 7
8 8
0 1
2
7 3
8 8
1 0
```
### 样例输出 #1
```
0
3
2
5
-1
-1
```
### 样例输入 #2
```
2
5
7 4 1 10 12
3 4 5 2 1
2 1 0 3 4
5
4 10 12 7 1
3 1 1 4 5
2 4 3 1 0
```
### 样例输出 #2
```
4
7
```
## 提示

### 样例解释 1

在第一组样例中，有 $6$ 组测试数据。

在第一组测试数据中，只有一株植物，所以要求在第 $0$ 天就已经满足。

在第二组测试数据中，需要让第一株植物比第二株植物矮。第   $1$ 天后，它们的高度为 $15,13$；第 $2$ 天后，它们的高度均为 $23$；第 $3$ 天后，它们的高度为 $31,33$，这是满足要求的第一天。

第三组和第四组测试数据与第二组类似。

在第五组测试数据中，两株植物的初始高度均为 $7$ 英寸，且每天均增长 $8$ 英寸，所以它们的高度永远相同。因此，条件永远无法满足。

在第六组测试数据中，初始高度不满足要求且增长速度均相同，所以条件永远无法满足。

### 样例解释 2

在第二组样例中，有 $2$ 组测试数据。

在第一组测试数据中，第 $4$ 天后的最终高度为 $19, 20, 21, 18, 16$。

在第二组测试数据中，第 $7$ 天后的最终高度为 $25, 17, 19, 35, 36$。

### 测试点性质

- 测试点 $3$ 满足 $N \le 2$。
- 测试点 $4-5$ 满足 $N \le 50$，$a_i, h_i \le 10^3$。
- 测试点 $6-8$ 满足 $N \le 10^3$。
- 测试点 $9-13$ 没有额外限制。


---

---
title: "[USACO23DEC] Cycle Correspondence S"
layout: "post"
diff: 普及/提高-
pid: P9978
tag: ['USACO', '2023', 'O2优化', '枚举', '分类讨论']
---
# [USACO23DEC] Cycle Correspondence S
## 题目描述

Farmer John 有 $N$（$3 \le N \le 5\cdot 10^5$）座谷仓，其中 $K$ 对不同的谷仓连接在一起。

一开始，Annabelle 为每座谷仓分配了一个 $[1,N]$ 范围内的整数编号，并发现编号为 $a_1,\dots,a_K$ 的谷仓按照顺序形成了一个环形连接。换句话说，对于所有的 $1 \le i < K$，谷仓 $a_i$ 和 $a_{i+1}$ 相连，谷仓 $a_K$ 与 $a_1$ 亦相连。所有的 $a_i$ 不相同。

然后，Bessie 也为每个谷仓分配了一个 $[1,N]$ 范围内的整数编号，并发现编号为 $b_1,\dots,b_K$ 也按照顺序形成了一个环形链接。所有的 $b_i$ 不相同。

一些（可能没有或全部）谷仓被 Annabelle 和 Bessie 分配了相同的编号。计算最多有多少个这样的谷仓。
## 输入格式

第一行包含 $N$ 和 $K$。

接下来一行包含 $a_1,\dots,a_K$。

接下来一行包含 $b_1,\dots,b_K$。
## 输出格式

分配了相同编号谷仓的最大数量。
## 样例

### 样例输入 #1
```
6 3
1 2 3
2 3 1
```
### 样例输出 #1
```
6
```
### 样例输入 #2
```
6 3
1 2 3
4 5 6
```
### 样例输出 #2
```
0
```
### 样例输入 #3
```
6 4
1 2 3 4
4 3 2 5
```
### 样例输出 #3
```
4
```
## 提示

### 样例解释 1

Annabelle 和 Bessie 可以为每个谷仓分配相同的编号。

### 样例解释 2

Annabelle 和 Bessie 无法为任何谷仓分配相同的编号。

### 样例解释 3

Annabelle 和 Bessie 可以分配编号 $2,3,4,6$ 给相同的谷仓。

### 测试点性质

- 测试点 $4-5$ 满足 $N \le 8$。
- 测试点 $6-8$ 满足 $N \le 5000$。
- 测试点 $9-15$ 没有额外限制。


---


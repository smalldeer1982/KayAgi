---
title: "【模板】传递闭包"
layout: "post"
diff: 普及/提高-
pid: B3611
tag: ['图论']
---
# 【模板】传递闭包
## 题目描述

给定一张点数为 $n$ 的有向图的邻接矩阵，图中不包含自环，求该有向图的传递闭包。

一张图的邻接矩阵定义为一个 $n\times n$ 的矩阵 $A=(a_{ij})_{n\times n}$，其中

$$ a_{ij}=\left\{
\begin{aligned}
1,i\ 到\ j\ 存在直接连边\\
0,i\ 到\ j\ 没有直接连边 \\
\end{aligned}
\right.
$$

一张图的传递闭包定义为一个 $n\times n$ 的矩阵 $B=(b_{ij})_{n\times n}$，其中

$$ b_{ij}=\left\{
\begin{aligned}
1,i\ 可以直接或间接到达\ j\\
0,i\ 无法直接或间接到达\ j\\
\end{aligned}
\right.
$$
## 输入格式

输入数据共 $n+1$ 行。

第一行一个正整数 $n$。

第 $2$ 到 $n+1$ 行每行 $n$ 个整数，第 $i+1$ 行第 $j$ 列的整数为 $a_{ij}$。
## 输出格式

输出数据共 $n$ 行。

第 $1$ 到 $n$ 行每行 $n$ 个整数，第 $i$ 行第 $j$ 列的整数为 $b_{ij}$。
## 样例

### 样例输入 #1
```
4
0 0 0 1
1 0 0 0
0 0 0 1
0 1 0 0
```
### 样例输出 #1
```
1 1 0 1
1 1 0 1
1 1 0 1
1 1 0 1
```
## 提示

对于 $100\%$ 的数据，$1\le n\le 100$，保证 $a_{ij}\in\{0,1\}$ 且 $a_{ii}=0$。


---

---
title: "[CCO 2022] Alternating Heights"
layout: "post"
diff: 普及/提高-
pid: P10050
tag: ['二分', '2022', 'CCO（加拿大）', '深度优先搜索 DFS', '图论建模', '双指针 two-pointer']
---
# [CCO 2022] Alternating Heights
## 题目描述

Troy 计划给 CCO 的学生拍一张合影，他向你寻求帮助。

有 $K$ 个学生，编号从 $1$ 到 $K$。Troy 忘记了学生的身高，但他记得没有两个学生的身高相同。

Troy 有一个序列 $A_{1}, A_{2}, \ldots, A_{N}$，表示合影中从左到右的学生顺序。一个学生可能在 $A$ 中出现多次。你不确定这张合影会怎么拍，但你不愿意认为 Troy 犯了错误。

Troy 会给你 $Q$ 个形式为 $x,y$ 的询问，每个询问为「给定学生序列 $A_{x}, A_{x+1}, \ldots, A_{y}$，他们的身高能否形成一个交替序列？」更具体地说，我们用 $h_i$ 表示第 $i$ 个学生的身高。如果存在一种身高分配$ h_1, h_2, \ldots, h_K$，使得 $h_{A_{x}}>h_{A_{x+1}}<h_{A_{x+2}}>h_{A_{x+3}}<\ldots h_{A_{y}}$，回答 `YES`；否则回答 `NO`。

注意，每个查询都是独立的：也就是说，询问 $i$ 的身高分配与询问 $j$ 的身高分配无关 $(i\neq j)$。
## 输入格式

第一行包含三个用空格分隔的整数 $N, K$ 和 $Q$。

第二行包含 $N$ 个整数，表示 $A_{1}, A_{2}, \ldots, A_{N}\left(1 \leq A_{i} \leq K\right)$。

接下来的 $Q$ 行，每行包含两个用空格分隔的整数 $x$ 和 $y (1 \leq x<y \leq N)$，表示一组查询。
## 输出格式

输出 $Q$ 行。第 $i$ 行，输出 `YES` 或者 `NO`，表示 Troy 的第 $i$ 个查询的答案。
## 样例

### 样例输入 #1
```
6 3 3
1 1 2 3 1 2
1 2
2 5
2 6
```
### 样例输出 #1
```
NO
YES
NO
```
## 提示

## 样例说明

对于第一个询问，不可能有 $h_1>h_1$，所以答案是 `NO`。

对于第二个询问，$h_1>h_2<h_3>h_1$ 的一种方案是 $h_1=160 \mathrm{~cm}, h_2=140 \mathrm{~cm}, h_3=180 \mathrm{~cm}$。另一种方案是 $h_1=1.55 \mathrm{~m}, h_2=1.473 \mathrm{~m}, h_3=1.81 \mathrm{~m}$。

对于第三个询问，不可能同时有 $h_1>h_2$ 和 $h_1<h_2$。

## 数据范围

对于所有的数据，有 $2 \leq N \leq 3000$，$2 \leq K \leq N$，$1 \leq Q \leq 10^{6}$。

子任务编号|	分值|	$N$|	$K$|	$Q$
:-:|:-:|:-:|:-:|:-:
$1$|	$16$|	$2 \leq N \leq 3000$|	$K=2$|	$1 \leq Q \leq 10^{6}$
$2$|	$24$|	$2 \leq N \leq 500$|	$2 \leq K \leq \min (N, 5)$|$1 \leq Q \leq 10^{6}$
$3$	|$28$|	$2 \leq N \leq 3000$	|$2 \leq K \leq N$	|$1 \leq Q \leq 2000$
$4$|	$32$| $2 \leq N \leq 3000$	|$2 \leq K \leq N$	|	$1 \leq Q \leq 10^{6}$


---

---
title: "[GESP202403 七级] 交流问题"
layout: "post"
diff: 普及/提高-
pid: P10378
tag: ['图论', '2024', '图论建模', '二分图', 'GESP']
---
# [GESP202403 七级] 交流问题
## 题目描述

来自两所学校 $A$、$B$ 的 $n$ 名同学聚在一起相互交流。为了方便起见，我们把这些同学从 $1$ 至 $n$ 编号。他们共进行了 $m$ 次交流，第 $i$ 次交流中，编号为 $u_i, v_i$ 的同学相互探讨了他们感兴趣的话题，并结交成为了新的朋友。

由于这次交流会的目的是促进两校友谊，因此只有不同学校的同学之间会交流。同校同学并不会互相交流。

作为 $A$ 校顾问，你对 $B$ 校的规模非常感兴趣，你希望求出 $B$ 校至少有几名同学、至多有几名同学。
## 输入格式

第一行两个正整数，表示同学的人数 $n$、交流的次数 $m$。  
接下来 $m$ 行，每行两个整数 $u_i, v_i$，表示一次交流。  
## 输出格式

输出一行两个整数，用单个空格隔开，分别表示 $B$ 校至少有几名同学、至多有几名同学。
## 样例

### 样例输入 #1
```
4 3
1 2
2 3
4 2

```
### 样例输出 #1
```
1 3
```
### 样例输入 #2
```
7 5
1 2
2 3
4 2
5 6
6 7

```
### 样例输出 #2
```
2 5
```
## 提示

### 数据规模与约定

- 对 $30\%$ 的数据，保证 $n \leq 17$，$m \leq 50$。
- 对 $60\%$ 的数据，保证 $n \leq 500$，$m \leq 2000$。
- 对全部的测试数据，保证 $1 \leq u_i, v_i \leq n \leq 10^5$，$1 \leq m \leq 2\times 10^5$，输入是合法的，即交流一定是跨校开展的。


---

---
title: "杂务"
layout: "post"
diff: 普及/提高-
pid: P1113
tag: ['图论', '递推']
---
# 杂务
## 题目描述

John 的农场在给奶牛挤奶前有很多杂务要完成，每一项杂务都需要一定的时间来完成它。比如：他们要将奶牛集合起来，将他们赶进牛棚，为奶牛清洗乳房以及一些其它工作。尽早将所有杂务完成是必要的，因为这样才有更多时间挤出更多的牛奶。

当然，有些杂务必须在另一些杂务完成的情况下才能进行。比如：只有将奶牛赶进牛棚才能开始为它清洗乳房，还有在未给奶牛清洗乳房之前不能挤奶。我们把这些工作称为完成本项工作的准备工作。至少有一项杂务不要求有准备工作，这个可以最早着手完成的工作，标记为杂务 $1$。

John 有需要完成的 $n$ 个杂务的清单，并且这份清单是有一定顺序的，杂务 $k\ (k>1)$ 的准备工作只可能在杂务 $1$ 至 $k-1$ 中。

写一个程序依次读入每个杂务的工作说明。计算出所有杂务都被完成的最短时间。当然互相没有关系的杂务可以同时工作，并且，你可以假定 John 的农场有足够多的工人来同时完成任意多项任务。

## 输入格式

第1行：一个整数 $n\ (3 \le n \le 10{,}000)$，必须完成的杂务的数目；

第 $2$ 至 $n+1$ 行，每行有一些用空格隔开的整数，分别表示：

- 工作序号（保证在输入文件中是从 $1$ 到 $n$ 有序递增的）；
- 完成工作所需要的时间 $len\ (1 \le len \le 100)$；
- 一些必须完成的准备工作，总数不超过 $100$ 个，由一个数字 $0$ 结束。有些杂务没有需要准备的工作只描述一个单独的 $0$。

保证整个输入文件中不会出现多余的空格。

## 输出格式

一个整数，表示完成所有杂务所需的最短时间。

## 样例

### 样例输入 #1
```
7
1 5 0
2 2 1 0
3 3 2 0
4 6 1 0
5 1 2 4 0
6 8 2 4 0
7 4 3 5 6 0

```
### 样例输出 #1
```
23

```


---

---
title: "旅行计划"
layout: "post"
diff: 普及/提高-
pid: P1137
tag: ['动态规划 DP', '图论', '递推', '排序', '拓扑排序']
---
# 旅行计划
## 题目描述

小明要去一个国家旅游。这个国家有 $N$ 个城市，编号为 $1$ 至 $N$，并且有 $M$ 条道路连接着，小明准备从其中一个城市出发，并只往东走到城市 $i$ 停止。

所以他就需要选择最先到达的城市，并制定一条路线以城市 $i$ 为终点，使得线路上除了第一个城市，每个城市都在路线前一个城市东面，并且满足这个前提下还希望游览的城市尽量多。

现在，你只知道每一条道路所连接的两个城市的相对位置关系，但并不知道所有城市具体的位置。现在对于所有的 $i$，都需要你为小明制定一条路线，并求出以城市 $i$ 为终点最多能够游览多少个城市。
## 输入格式

第一行为两个正整数 $N, M$。

接下来 $M$ 行，每行两个正整数 $x, y$，表示了有一条连接城市 $x$ 与城市 $y$ 的道路，保证了城市 $x$ 在城市 $y$ 西面。

## 输出格式

$N$ 行，第 $i$ 行包含一个正整数，表示以第 $i$ 个城市为终点最多能游览多少个城市。

## 样例

### 样例输入 #1
```
5 6
1 2
1 3
2 3
2 4
3 4
2 5

```
### 样例输出 #1
```
1
2
3
4
3

```
## 提示

均选择从城市 $1$ 出发可以得到以上答案。

- 对于 $20\%$ 的数据，$1\le N ≤ 100$；
- 对于 $60\%$ 的数据，$1\le N ≤ 1000$；
- 对于 $100\%$ 的数据，$1\le N ≤ 100000$，$1\le M ≤ 200000$。



---

---
title: "[GESP202412 八级] 排队"
layout: "post"
diff: 普及/提高-
pid: P11380
tag: ['图论', '2024', '数论', '图论建模', '组合数学', '排列组合', 'GESP']
---
# [GESP202412 八级] 排队
## 题目描述

小杨所在班级共有 $n$ 位同学，依次以 $1,2,\dots,n$ 标号。这 $n$ 位同学想排成一行队伍，其中有些同学之间关系非常好，在队伍里需要排在相邻的位置。具体来说，有 $m$ 对这样的关系（$m$ 是一个非负整数）。当 $m\geq 1$ 时，第 $i$ 对关系（$1\leq i\leq m$）给出 $a_i,b_i$，表示排队时编号为 $a_i$ 的同学需要排在编号为 $b_i$ 的同学前面，并且两人在队伍中相邻。

现在小杨想知道总共有多少种排队方式。由于答案可能很大，你只需要求出答案对 $10^9+7$ 取模的结果。
## 输入格式

第一行，两个整数 $n,m$，分别表示同学们的数量与关系数量。

接下来 $m$ 行，每行两个整数 $a_i,b_i$，表示一对关系。
## 输出格式

一行，一个整数，表示答案对 $10^9+7$ 取模的结果。
## 样例

### 样例输入 #1
```
4 2
1 3
2 4
```
### 样例输出 #1
```
2
```
### 样例输入 #2
```
3 0
```
### 样例输出 #2
```
6
```
### 样例输入 #3
```
3 2
1 2
2 1
```
### 样例输出 #3
```
0
```
## 提示

对于 $20\%$ 的测试数据点，保证 $1\leq n\leq 8$，$0\leq m\leq 10$。

对于另外 $20\%$ 的测试数据点，保证 $1\leq n\leq 10^3$，$0\leq m\leq 1$。

对于所有测试数据点，保证 $1\leq n\leq 2\times 10^5$，$0\leq m\leq 2\times 10^5$。


---

---
title: "[PA 2015] 人赢 / Mistrzostwa"
layout: "post"
diff: 普及/提高-
pid: P11811
tag: ['图论', '2015', '并查集', 'Special Judge', 'PA（波兰）']
---
# [PA 2015] 人赢 / Mistrzostwa
## 题目背景

译自 [PA 2015](https://sio2.mimuw.edu.pl/c/pa-2015-1/p/) R2.
## 题目描述

给定一张 $n$ 个点 $m$ 条边的**简单**（无重边自环的）无向图 $G=(V,E)$。其中节点编号 $1\sim n$。

给定正整数 $d$。选出一个最大的点集 $S\subseteq V$，满足：

- $\forall u\in S$，$\displaystyle \sum_{v\in S} [(u,v)\in E]\ge d$。换句话说，$u$ 向 $S$ 内点至少连了 $d$ 条边。
- $S$ 的导出子图（induced subgraph）是连通的。

你需要构造一个 $S$ 使得 $|S|$ 取到最大值，或者报告无解。

点集 $V'\subseteq V$ 的导出子图定义为 $G'=(V',E')$，其中 $E'=\{(u,v)\in E: u\in V'\land v\in V'\}$。

## 输入格式

第一行，三个正整数 $n,m,d$。

接下来 $m$ 行，每行两个正整数 $u,v$，表示 $(u,v)\in E$。
## 输出格式

如果符合条件的 $S$ 不存在，输出一行一个 $\texttt{NIE}$。

否则，第一行输出 $|S|$，第二行**升序**输出 $S$ 中节点的编号。
## 样例

### 样例输入 #1
```
4 4 2
1 2
2 3
3 4
4 2
```
### 样例输出 #1
```
3
2 3 4
```
### 样例输入 #2
```
3 2 2
1 2
2 3
```
### 样例输出 #2
```
NIE
```
## 提示

- $1\le d\lt n\le 2\times 10^5$；
- $1\le m\le 2\times 10^5$。
- 给定的图无重边自环。



---

---
title: "[CSP-J2022 山东] 部署"
layout: "post"
diff: 普及/提高-
pid: P11855
tag: ['图论', '2022', '山东', '图遍历', 'CSP-J 入门级']
---
# [CSP-J2022 山东] 部署
## 题目背景

受疫情影响，山东省取消了 CSP-J 2022 认证活动，并于次年三月重新命题，在省内补办比赛。
## 题目描述

“万里羽书来未绝，五关烽火昼仍传。” 

古时候没有现代信息化战争的技术，只能靠烽火传信和将军运筹帷幄的调兵遣将来取得战争的优势。

为了使消耗最低，现在 A 国已经在 $n$ 个城市之间建好了道路和行军部署渠道，使得这 $n$ 个城市都能互相到达且不存在环（即构成以 $1$ 号城市为根节点的树型结构）。每个城市都驻扎了一定数量的兵力。

为了清晰的描述问题，我们给这 $n$ 个城市进行 $1$ 到 $n$ 的编号，且 $1$ 号城市为树的根节点（数据保证：构成以 $1$ 号城市为根节点的一棵树）。初始时，第 $i$ 座城市拥有初始兵力 $a_{i}$。

现在为测试战争部署速度，将军进行了 $m$ 次测试，每次测试可能为以下两种命令的某一种：

`1 x y`（三个数间均用 1 个空格分开）：向 $x$ 号城市**和**以它为根的子树中的所有城市全部增兵 $y$ 的数量。

`2 x y`（三个数间均用 1 个空格分开）：向 $x$ 号城市**和**与它直接相连（含父结点和子结点）的城市全部增兵 $y$ 的数量。

$m$ 条命令发布出去后，将军喊来参谋，进行了 $q$ 次询问，每次询问第 $x$ 座城市的最终兵力情况。
该参谋就是小虾米，他又向你求助了，请你帮助他解决问题（$q$ 次询问的结果）。
## 输入格式

第一行一个正整数 $n$ 表示城市数量。

第二行一共 $n$ 个正整数 $a_{1},a_{2},\dots a_{n}$ 表示每座城市的初始兵力。

接下来 $n-1$ 行，每行两个整数 $x,y$，表示 $x$ 和 $y$ 城市之间有直接相连的道路。

接下来一行一个正整数 $m$，表示 $m$ 次命令。

接下来 $m$ 行，每行三个正整数 $p,x,y$ 表示两种命令其中一种，其中 $p=1$ 时表示第一种命令，$p=2$ 时表示第二种命令。

接下来一行一个正整数 $q$，表示 $q$ 次询问。

接下来 $q$ 行，每行一个正整数 $x$ ，表示询问编号为 $x$ 的城市最后的兵力值。
## 输出格式

一共 $q$ 行，每行一个正整数分别对应于每次询问的答案。
## 样例

### 样例输入 #1
```
5
1 2 3 4 5
1 2
1 3
2 4
3 5
4
1 1 2
2 2 3
1 3 3
2 5 1
4
1
2
3
4
```
### 样例输出 #1
```
6
7
9
9
```
### 样例输入 #2
```
4
1 1 1 1
1 2
1 3
1 4
1
1 1 1
2
1
2
```
### 样例输出 #2
```
2
2
```
## 提示

### 数据范围
对于 $30\%$ 的数据，$1\le n\le1000,1\le m\le1000$；

对于 $60\%$ 的数据，$1\le n\le10^{5},1\le m\le10^{5},1\le q\le10^{5}$；

其中 $10\%$ 的数据树是一条链，另外 $10\%$ 的数据只有 $1$ 操作，另外 $10\%$ 的数据只有 $2$ 操作。

对于 $100\%$ 的数据，数据保证给定的城市和道路能形成树，且 $1$ 号城市为根节点。$1\le n\le10^{6},1\le m\le10^{6},1\le q\le10^{6},1\le a_{i}\le10^{9},1\le x\le n,1\le y\le10$。


---

---
title: "买礼物"
layout: "post"
diff: 普及/提高-
pid: P1194
tag: ['图论', '生成树']
---
# 买礼物
## 题目描述

又到了一年一度的明明生日了，明明想要买 $B$ 样东西，巧的是，这 $B$ 样东西价格都是 $A$ 元。

但是，商店老板说最近有促销活动，也就是：

如果你买了第 $I$ 样东西，再买第 $J$ 样，那么就可以只花 $K_{I,J}$ 元，更巧的是，$K_{I,J}$ 竟然等于 $K_{J,I}$。

现在明明想知道，他最少要花多少钱。
## 输入格式

第一行两个整数，$A,B$。

接下来 $B$ 行，每行 $B$ 个数，第 $I$ 行第 $J$ 个为 $K_{I,J}$。

我们保证 $K_{I,J}=K_{J,I}$ 并且 $K_{I,I}=0$。

特别的，如果 $K_{I,J}=0$，那么表示这两样东西之间不会导致优惠。

注意 $K_{I,J}$ **可能大于** $A$。
## 输出格式

一个整数，为最小要花的钱数。

## 样例

### 样例输入 #1
```
1 1
0


```
### 样例输出 #1
```
1
```
### 样例输入 #2
```
3 3
0 2 4
2 0 2
4 2 0

```
### 样例输出 #2
```
7
```
## 提示

样例解释 $2$。

先买第 $2$ 样东西，花费 $3$ 元，接下来因为优惠，买 $1,3$ 样都只要 $2$ 元，共 $7$ 元。

（同时满足多个“优惠”的时候，聪明的明明当然不会选择用 $4$ 元买剩下那件，而选择用 $2$ 元。）

数据规模

对于 $30\%$ 的数据，$1\le B\le 10$。

对于 $100\%$ 的数据，$1\le B\le500,0\le A,K_{I,J}\le1000$。

2018.7.25新添数据一组


---

---
title: "口袋的天空"
layout: "post"
diff: 普及/提高-
pid: P1195
tag: ['图论', '并查集', '生成树']
---
# 口袋的天空
## 题目背景

小杉坐在教室里，透过口袋一样的窗户看口袋一样的天空。

有很多云飘在那里，看起来很漂亮，小杉想摘下那样美的几朵云，做成棉花糖。

## 题目描述

给你云朵的个数 $N$，再给你 $M$ 个关系，表示哪些云朵可以连在一起。

现在小杉要把所有云朵连成 $K$ 个棉花糖，一个棉花糖最少要用掉一朵云，小杉想知道他怎么连，花费的代价最小。

## 输入格式

第一行有三个数 $N,M,K$。

接下来 $M$ 行每行三个数 $X,Y,L$，表示 $X$ 云和 $Y$ 云可以通过 $L$ 的代价连在一起。



## 输出格式

对每组数据输出一行，仅有一个整数，表示最小的代价。

如果怎么连都连不出 $K$ 个棉花糖，请输出 `No Answer`。

## 样例

### 样例输入 #1
```
3 1 2
1 2 1

```
### 样例输出 #1
```
1
```
## 提示

对于 $30\%$ 的数据，$1 \le N \le 100$，$1\le M \le 10^3$；

对于 $100\%$ 的数据，$1 \le N \le 10^3$，$1 \le M \le 10^4$，$1 \le K \le 10$，$1 \le X,Y \le N$，$0 \le L<10^4$。



---

---
title: "[USTCPC 2025] 图上交互题 2 / Constructive Minimum Mex Path"
layout: "post"
diff: 普及/提高-
pid: P12041
tag: ['图论', '并查集', '2025', 'Special Judge', '连通块', '构造', '高校校赛']
---
# [USTCPC 2025] 图上交互题 2 / Constructive Minimum Mex Path
## 题目背景

USTCPC 设置 3s 时限为了使得 python 通过。洛谷改为 1s 时限。

2024 年 1 月 13 日 15:59:31，随着最后一发交互 J 题的提交出现了 Wrong Answer，小 G 的 EC-Final 比赛结束了，也意味着在 ICPC 生涯中第一次打铁。

克露丝卡尔酱想要帮助她的同学小 G！她打算批量生产交互题给小 G 做。如何批量生产交互题？只要在一个数据结构中有若干个未知量 $a_i$，每次询问给定向量 $x$，交互库会返回关于 $a_i$ 的函数 $f(x)$，这样就能批量生产交互题了！

~~为什么题目名里有 2 呢？~~
## 题目描述

给定一个 $n$ 个点，$m$ 条边的**无向图**。第 $i$ 条边 $(u_i,v_i)$ 有一个**未知边权** $a_i$。

对于任何一条**路径**，定义其**代价**如下：设路径为 $(p_0,p_1,...,p_k)$，其中要求 $(p_{i-1},p_i)$ 是无向图中的边，设其为第 $e_i$ 条边。那么路径的代价即为 $\mathop{\text{mex}}\limits_{i=1}^{k} a_{e_i}$。（该路径可以经过重复点和重复边，即 $p$ 和 $e$ 可以包含重复的数）

$\text{mex}$ 是一种定义域为一个非负整数的可重集合，函数值为非负整数的映射，定义为集合内最小未在集合内出现过的非负整数。

定义 $f(x,y)$ 为从 $x$ 到 $y$ 的所有路径中代价的**最小值**。特别地，当 $x=y$ 时，$f(x,y)=0$。

给定 $n,m$，再对于每条边 $(u_i,v_i)$ 给定 $f(u_i,v_i)$，你需要求出是否存在一组合法的 $a_i$，如果有解，你还需要构造一组解。
## 输入格式

第一行两个正整数 $n,m$ $(1\le n,m\le 10^5)$。

第 $2\sim m+1$ 行每行两个正整数 $u_i,v_i$ $(1\le u_i,v_i\le n)$ 和一个非负整数 $f(u_i,v_i)$ $(0\le f(u_i,v_i)<2^{31})$。

**请注意：本题并不保证图连通；可能会存在重边和自环。**
## 输出格式

如果不存在解，则仅输出 `No`。

否则，在第一行输出 `Yes`，在第二行输出 $m$ 个非负整数 $a_i$ 表示一组合法的解。

答案可能有很多组，此时输出任意一组解即可。你需要保证 输出的 $0\le a_i<2^{31}$。

你可以以任意的大小写形式输出 `Yes` 或 `No`。例如，`yEs`，`yes`，`Yes` 和 `YES` 都将被视为肯定的回复。
## 样例

### 样例输入 #1
```
4 4
1 2 0
2 3 0
3 1 0
3 4 1
```
### 样例输出 #1
```
Yes
0 1 2 0
```
### 样例输入 #2
```
1 1
1 1 114514
```
### 样例输出 #2
```
NO
```
## 提示

![](https://cdn.luogu.com.cn/upload/image_hosting/z3pthk3a.png)

考虑 $f(1,2)$：

+ 考虑路径 $1\rightarrow 2$，路径的代价为 $\text{mex}\{0\}=1$。
+ 考虑路径 $1\rightarrow 2\rightarrow 3\rightarrow 1\rightarrow 2$，路径的代价为 $\text{mex}\{0,1,2,0\}=3$。
+ 考虑路径 $1\rightarrow 3\rightarrow 2$，路径的代价为 $\text{mex}\{1,2\}=0$。

此外还存在其他路径，但可以证明不存在代价比 $0$ 更小的路径，故 $f(1,2)=0$。


---

---
title: "[蓝桥杯 2025 省 AB/Python B 第二场] 树上寻宝"
layout: "post"
diff: 普及/提高-
pid: P12343
tag: ['图论', '2025', '树的遍历', '蓝桥杯省赛']
---
# [蓝桥杯 2025 省 AB/Python B 第二场] 树上寻宝
## 题目描述

小蓝正在一棵含有 $n$ 个结点的树的根结点 $1$ 上，他准备在这棵树上寻宝。结点 $i$ 上有一个物品，价值为 $w_i$。然而，小蓝每次寻宝只能从根节点出发走不超过 $k$ 步，每步只能选择走 $1$ 条边或者 $2$ 条边，之后会自动拾取最终停留的结点上的物品并被传送回根结点。请求出小蓝最终能获得的物品的总价值。
## 输入格式

输入的第一行包含两个正整数 $n, k$，用一个空格分隔。

第二行包含 $n$ 个正整数 $w_1, w_2, \cdots, w_n$，相邻整数之间使用一个空格分隔。

接下来 $n-1$ 行，每行包含两个正整数 $u_i, v_i$，用一个空格分隔，表示结点 $u_i$ 和结点 $v_i$ 之间有一条边。
## 输出格式

输出一行包含一个整数表示答案。
## 样例

### 样例输入 #1
```
8 2
6 3 3 1 5 4 3 4
1 2
2 3
2 4
4 5
5 6
6 7
7 8
```
### 样例输出 #1
```
22
```
## 提示

### 样例说明

- 走 $0$ 步能到的结点：$1$；
- 走 $1$ 步能到的结点：$2, 3, 4$；
- 走 $2$ 步能到的结点：$3, 4, 5, 6$；

因此能到的结点为：$1, 2, 3, 4, 5, 6$，能获得的总价值为 $22$。

### 评测用例规模与约定

- 对于 $20\%$ 的评测用例，$1 \leq n \leq 15$；
- 对于所有评测用例，$0 \leq k < n \leq 10^5$，$1 \leq w_i \leq 10^6$，$1 \leq u_i, v_i \leq n$。


---

---
title: "[KOI 2023 Round 2] 湖边的蚁穴"
layout: "post"
diff: 普及/提高-
pid: P12663
tag: ['贪心', '2023', '图论建模', 'KOI（韩国）']
---
# [KOI 2023 Round 2] 湖边的蚁穴
## 题目背景

试题来源：<https://koi.or.kr/archives/>。中文翻译做了少量本土化修改。

按照[署名—非商业性使用—相同方式共享 4.0 协议国际版](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans)进行授权。
## 题目描述

KOI 湖畔有一个蚂蚁们聚居的蚁穴。这个蚁穴沿着圆形湖泊的边缘，环形地依次排列着从 $1$ 到 $N$ 编号的 $N$ 个房间。对于所有满足 $1 \leq i \leq N - 1$ 的 $i$，第 $i$ 个房间与第 $i + 1$ 个房间之间，以及第 $N$ 个房间与第 $1$ 个房间之间都通过通道直接连接。

但由于各种原因，从某些房间开始分出了若干个小房间。现在，对于所有满足 $1 \leq i \leq N$ 的 $i$，蚁穴中的第 $i$ 个房间通过通道直接连接着 $C_i$ 个小房间。与第 $i$ 个房间连接的小房间不会与其他任何房间相连。

例如，若 $N = 7$ 且 $C = [3, 0, 0, 1, 0, 2, 0]$，蚁穴的结构如下图所示。

![](https://cdn.luogu.com.cn/upload/image_hosting/57hzt6bh.png)

蚁穴中的每个房间与小房间最多只能住一只蚂蚁。如果通道直接连接的两个位置（房间或小房间）中都住着蚂蚁，那么这两只蚂蚁会感到不舒服。为了避免这种不适，当前蚁穴的每条通道最多只能连接一只住着蚂蚁的位置。

蚂蚁们非常聪明，因此在上述条件允许的情况下，它们总是设法使蚁穴中居住的蚂蚁数量最大。现在给出蚁穴的结构，请编写一个程序，计算最多有多少只蚂蚁可以住在蚁穴中。
## 输入格式

第一行输入一个整数 $N$。  
第二行输入 $C_1, C_2, \dots, C_N$，表示每个房间连接的小房间数量，整数之间以空格分隔。
## 输出格式

输出一个整数，表示最多可以居住在蚁穴中的蚂蚁数量。

## 样例

### 样例输入 #1
```
4
1 0 1 0
```
### 样例输出 #1
```
4
```
### 样例输入 #2
```
4
1 1 1 1
```
### 样例输出 #2
```
4
```
### 样例输入 #3
```
2
0 0
```
### 样例输出 #3
```
1
```
### 样例输入 #4
```
7
3 0 0 1 0 2 0
```
### 样例输出 #4
```
9
```
## 提示

**限制条件**

- 所有给定的数均为整数。
- $2 \leq N \leq 250\,000$
- $0 \leq C_i \leq 10^{12} \quad (1 \leq i \leq N)$

**子任务**

1. （4 分）$N = 2$  
2. （8 分）$N \leq 1\,000$ 且 $C_i = 0 \quad (1 \leq i \leq N)$  
3. （14 分）$N \leq 1\,000$ 且 $C_i \leq 1 \quad (1 \leq i \leq N)$  
4. （15 分）$N \leq 1\,000$  
5. （20 分）$C_i \leq 1 \quad (1 \leq i \leq N)$  
6. （13 分）$C_i \leq 1\,000 \quad (1 \leq i \leq N)$  
7. （9 分）$C_i \geq 1 \quad (1 \leq i \leq N)$  
8. （17 分）无附加限制

翻译由 ChatGPT-4o 完成


---

---
title: "[蓝桥杯 2025 国 Python A] 巡逻"
layout: "post"
diff: 普及/提高-
pid: P12874
tag: ['图论', '2025', '树的遍历', '最近公共祖先 LCA', '前缀和', '蓝桥杯国赛']
---
# [蓝桥杯 2025 国 Python A] 巡逻
## 题目背景

建议 Python 用户选择 PyPy3 提交本题。
## 题目描述

边境森林中分布着若干重要的哨站，所有哨站之间由隐秘小径相连，形成一张天然的巡逻网络。这张网络的结构恰好是一棵树。为了防止敌人渗透，小蓝每天需要执行固定长度为 $k$ 的巡逻任务。每次巡逻从一个哨站出发，经过不重复地恰好 $k$ 条道路，最终到达另一个哨站。每条道路都有一定的危险值，巡逻路径上危险值的和代表该次巡逻时的风险。两次巡逻路径不相同当且仅当它们的起点不同或终点不同。

现在指挥官希望知道，所有可能的长度为 $k$ 的巡逻路线的风险之和是多少？
## 输入格式

输入的第一行包含两个正整数 $n, k$ ，用一个空格分隔。

接下来 $n-1$ 行，每行包含三个正整数 $u_i, v_i, w_i$ ，相邻整数之间使用一个空格分隔。表示结点 $u_i$ 和结点 $v_i$ 之间有一条危险值为 $w_i$ 边。

## 输出格式

输出一行包含一个整数表示答案。
## 样例

### 样例输入 #1
```
7 2
1 2 3
2 4 5
1 3 7
3 5 3
3 6 4
6 7 2
```
### 样例输出 #1
```
104
```
## 提示

**【样例说明】**

所有可能的路径及其风险值如下：

- $1 \rightarrow 2 \rightarrow 4: 8$
- $2 \rightarrow 1 \rightarrow 3: 10$
- $1 \rightarrow 3 \rightarrow 5: 10$
- $1 \rightarrow 3 \rightarrow 6: 11$
- $5 \rightarrow 3 \rightarrow 6: 7$
- $3 \rightarrow 6 \rightarrow 7: 6$

以上路径反过来也是合法的，所以总共有 14 条不同的路径，风险之和为 104。

**【评测用例规模与约定】**

对于 40% 的评测用例，$1 \leq n \leq 500$；

对于所有评测用例，$1 \leq n \leq 5000$，$1 \leq k \leq n$，$1 \leq u_i, v_i \leq n$，$1 \leq w_i \leq 10^6$。


---

---
title: "[GESP202506 六级] 最大因数"
layout: "post"
diff: 普及/提高-
pid: P13016
tag: ['图论', '2025', '数论', '最近公共祖先 LCA', 'GESP']
---
# [GESP202506 六级] 最大因数
## 题目描述



给定一棵有 $10^9$ 个结点的有根树，这些结点依次以 $1, 2, \dots, 10^9$ 编号，根结点的编号为 $1$。对于编号为 $k$（$2 \leq k \leq 10^9$）的结点，其父结点的编号为 $k$ 的因数中除 $k$ 以外最大的因数。

现在有 $q$ 组询问，第 $i$（$1 \leq i \leq q$）组询问给定 $x_i, y_i$，请你求出编号分别为 $x_i, y_i$ 的两个结点在这棵树上的距离。两个结点之间的距离是连接这两个结点的简单路径所包含的边数。

## 输入格式


第一行，一个正整数 $q$，表示询问组数。

接下来 $q$ 行，每行两个正整数 $x_i, y_i$，表示询问结点的编号。
## 输出格式


输出共 $q$ 行，每行一个整数，表示结点 $x_i, y_i$ 之间的距离。
## 样例

### 样例输入 #1
```
3
1 3
2 5
4 8
```
### 样例输出 #1
```
1
2
1
```
### 样例输入 #2
```
1
120 650
```
### 样例输出 #2
```
9
```
## 提示


对于 $60\%$ 的测试点，保证 $1 \leq x_i, y_i \leq 1000$。

对于所有测试点，保证 $1 \leq q \leq 1000$，$1 \leq x_i, y_i \leq 10^9$。


---

---
title: "[GESP202506 七级] 线图"
layout: "post"
diff: 普及/提高-
pid: P13017
tag: ['图论', '2025', '组合数学', 'GESP']
---
# [GESP202506 七级] 线图
## 题目描述

给定由 $n$ 个结点与 $m$ 条边构成的简单无向图 $G$，结点依次以 $1,2,\dots,n$ 编号。简单无向图意味着 $G$ 中不包含重边与自环。$G$ 的**线图** $L(G)$ 通过以下方式构建：

- 初始时线图 $L(G)$ 为空。

- 对于无向图 $G$ 中的一条边，在线图 $L(G)$ 中加入与之对应的一个结点。

- 对于无向图 $G$ 中两条不同的边 $(u_1,v_1),(u_2,v_2)$，若存在 $G$ 中的结点同时连接这两条边（即 $u_1,v_1$ 之一与 $u_2,v_2$ 之一相同），则在线图 $L(G)$ 中加入一条无向边，连接 $(u_1,v_1),(u_2,v_2)$ 在线图中对应的结点。

请你求出线图 $L(G)$ 中所包含的无向边的数量。
## 输入格式

第一行，两个正整数 $n,m$，分别表示无向图 $G$ 中的结点数和边数。

接下来 $m$ 行，每行两个正整数 $u_i,v_i$，表示 $G$ 中连接 $u_i,v_i$ 的一条无向边。
## 输出格式

输出共一行，一个整数，表示线图 $L(G)$ 中所包含的无向边的数量。
## 样例

### 样例输入 #1
```
5 4
1 2
2 3
3 1
4 5
```
### 样例输出 #1
```
3
```
### 样例输入 #2
```
5 10
1 2
1 3
1 4
1 5
2 3
2 4
2 5
3 4
3 5
4 5
```
### 样例输出 #2
```
30
```
## 提示

**【样例解释 #1】**

![](https://cdn.luogu.com.cn/upload/image_hosting/72ffa0a3.png)

**【数据范围】**

对于 $60\%$ 的测试点，保证 $1 \le n \le 500,1 \le m \le 500$。

对于所有测试点，保证 $1 \le n \le 10^5,1 \le m \le 10^5$。


---

---
title: "封锁阳光大学"
layout: "post"
diff: 普及/提高-
pid: P1330
tag: ['搜索', '图论', '福建省历届夏令营', '广度优先搜索 BFS', '深度优先搜索 DFS', '二分图']
---
# 封锁阳光大学
## 题目描述

曹是一只爱刷街的老曹，暑假期间，他每天都欢快地在阳光大学的校园里刷街。河蟹看到欢快的曹，感到不爽。河蟹决定封锁阳光大学，不让曹刷街。

阳光大学的校园是一张由 $n$ 个点构成的无向图，$n$ 个点之间由 $m$ 条道路连接。每只河蟹可以对一个点进行封锁，当某个点被封锁后，与这个点相连的道路就被封锁了，曹就无法在这些道路上刷街了。非常悲剧的一点是，河蟹是一种不和谐的生物，当两只河蟹封锁了相邻的两个点时，他们会发生冲突。

询问：最少需要多少只河蟹，可以封锁所有道路并且不发生冲突。

## 输入格式

第一行两个正整数，表示节点数和边数。
接下来 $m$ 行，每行两个整数 $u,v$，表示点 $u$ 到点 $v$ 之间有道路相连。

## 输出格式

仅一行如果河蟹无法封锁所有道路，则输出 `Impossible`，否则输出一个整数，表示最少需要多少只河蟹。

## 样例

### 样例输入 #1
```
3 3
1 2
1 3
2 3

```
### 样例输出 #1
```
Impossible

```
### 样例输入 #2
```
3 2
1 2
2 3

```
### 样例输出 #2
```
1
```
## 提示

【数据规模】   
对于 $100\%$ 的数据，$1\le n \le 10^4$，$1\le m \le 10^5$，保证没有重边。


---

---
title: "[USACO09OCT] Heat Wave G"
layout: "post"
diff: 普及/提高-
pid: P1339
tag: ['图论', '2009', 'USACO', '福建省历届夏令营', '最短路']
---
# [USACO09OCT] Heat Wave G
## 题目描述

有一个 $n$ 个点 $m$ 条边的无向图，请求出从 $s$ 到 $t$ 的最短路长度。
## 输入格式

第一行四个正整数 $n,m,s,t$。
接下来 $m$ 行，每行三个正整数 $u,v,w$，表示一条连接 $u,v$，长为 $w$ 的边。

## 输出格式

输出一行一个整数，表示答案。
## 样例

### 样例输入 #1
```
7 11 5 4
2 4 2
1 4 3
7 2 2
3 4 3
5 7 5
7 3 3
6 1 1
6 3 4
2 4 3
5 6 3
7 2 1
```
### 样例输出 #1
```
7
```
## 提示

【数据范围】  
对于 $100\%$ 的数据，$1\le n \le 2500$，$1\le m \le 6200$，$1\le w \le 1000$。

【样例说明】   
$5 \to 6 \to 1 \to 4$ 为最短路，长度为 $3+1+3 = 7$。




---

---
title: "请柬"
layout: "post"
diff: 普及/提高-
pid: P1342
tag: ['图论', '福建省历届夏令营', '最短路']
---
# 请柬
## 题目背景

在电视时代，没有多少人观看戏剧表演。 Malidinesia 古董喜剧演员意识到这一事实，他们想宣传剧院,尤其是古色古香的喜剧片。
## 题目描述

他们已经打印了请帖和所有必要的信息和计划。许多学生被雇来分发这些请柬。每个学生志愿者被指定一个确切的公共汽车站，他或她将留在那里一整天,邀请人们参与。

这里的公交系统是非常特殊的：共有 $n$ 个站点和 $m$ 个线路，所有的线路都是单向的，连接两个站点。公共汽车离开起始点，到达目的地之后又空车返回起始点。

学生每天早上从总部所在的 $1$ 号站点出发，乘公交车到一个预定的站点邀请乘客。每个站点都被安排了一名学生。在一天结束的时候，所有的学生都回到总部。现在需要知道的是，学生所需的公交费用的总和最小是多少。
## 输入格式

输入的第一行是两个整数，代表站点个数 $n$ 和线路条数 $m$。

第 $2$ 到第 $(m + 1)$ 行，每行三个整数 $u, v, w$，代表存在一条从 $u$ 出发到达 $v$ 的线路，费用为 $w$。
## 输出格式

输出一行一个整数，表示最小费用。



## 样例

### 样例输入 #1
```
4 6
1 2 10
2 1 60
1 3 20
3 4 10
2 4 5
4 1 50
```
### 样例输出 #1
```
210 
```
## 提示

#### 数据规模与约定

对于 $100\%$ 的数据，保证：

- $1 \leq n, m \leq 10^6$。
- $1 \leq u, v \leq n$，$1 \leq w \leq 10^9$。
- 从 $1$ 出发可以到达所有的站点。


---

---
title: "电车"
layout: "post"
diff: 普及/提高-
pid: P1346
tag: ['图论', '福建省历届夏令营']
---
# 电车
## 题目描述

在一个神奇的小镇上有着一个特别的电车网络，它由一些路口和轨道组成，每个路口都连接着若干个轨道，每个轨道都通向一个路口（不排除有的观光轨道转一圈后返回路口的可能）。在每个路口，都有一个开关决定着出去的轨道，每个开关都有一个默认的状态，每辆电车行驶到路口之后，只能从开关所指向的轨道出去，如果电车司机想走另一个轨道，他就必须下车切换开关的状态。

为了行驶向目标地点，电车司机不得不经常下车来切换开关，于是，他们想请你写一个程序，计算一辆从路口 $A$ 到路口 $B$ 最少需要下车切换几次开关。

## 输入格式

第一行有 $3$ 个整数 $N,A,B$（$2 \leq N \leq 100, 1 \leq A,B \leq N$），分别表示路口的数量，和电车的起点，终点。

接下来有 $N$ 行，每行的开头有一个数字 $K_i$（$0 \leq K_i \leq N-1$），表示这个路口与 $K_i$ 条轨道相连，接下来有 $K_i$ 个数字表示每条轨道所通向的路口，开关默认指向第一个数字表示的轨道。
## 输出格式

输出文件只有一个数字，表示从 $A$ 到 $B$ 所需的最少的切换开关次数，若无法从 $A$ 前往 $B$，输出 $-1$。

## 样例

### 样例输入 #1
```
3 2 1
2 2 3
2 3 1
2 1 2
```
### 样例输出 #1
```
0
```


---

---
title: "「CZOI-R5」奶龙"
layout: "post"
diff: 普及/提高-
pid: P13564
tag: ['图论', '洛谷原创', 'Special Judge', 'O2优化', '构造', '洛谷比赛']
---
# 「CZOI-R5」奶龙
## 题目背景

[❤点击链接直达奶龙❤](/user/621382)。
## 题目描述

现有一张 $n$ 个点，初始没有任何边的编号 $1\sim n$ 的图，给定长度为 $m$ 的数组 $A_i$，表示编号为 $A_i$ 的点上有一只奶龙，在每一次行动中，奶龙会沿着当前点连向其它点的边走向下一个点。

请你构造一张图，给定正整数 $k$，使得其满足：

- 每个点的出度均为 $1$，不得有自环。
- 经过恰好 $k$ 次行动时，所有点都被至少一只奶龙经过，且在经过恰好 $k-1$ 次行动时，至少有一个点未被任何奶龙经过。

若无解则输出 `-1`。
## 输入格式

第一行共三个整数，表示 $n,m,k$。

第二行共 $m$ 个正整数，其中第 $i$ 个数表示 $A_i$。
## 输出格式

共 $n$ 行，每行输出两个正整数 $u,v$，表示有一条 $u\to v$ 的有向边。

本题使用 Special Judge，若有多种答案任意输出一种即可。
## 样例

### 样例输入 #1
```
5 2 2
1 2
```
### 样例输出 #1
```
1 3
3 5
5 1
2 4
4 5
```
### 样例输入 #2
```
5 2 1
1 2
```
### 样例输出 #2
```
-1
```
## 提示

### 样例解释

对于样例组 #1 中的构造方案，图形态如下。

![](https://cdn.luogu.com.cn/upload/image_hosting/8go9gc8y.png)

初始点 $1,2$ 上分别有一只奶龙，走第一轮后可以到达 $3,4$，走第二轮后可以到达 $5$，符合题意。

### 数据范围

|子任务编号|$n$|$m$|$k$|分值|
|:-:|:-:|:-:|:-:|:-:|
|$1$|$\le 8$|$\le 8$|$< 8$|$10$|
|$2$|$\le 2\times 10^5$|$=1$|$< 2\times 10^5$|$15$|
|$3$|$\le 2\times 10^5$|$\le 2\times 10^5$|$=1$|$15$|
|$4$|$\le 2\times 10^5$|$\le 2\times 10^5$|$< 2\times 10^5$|$60$|

对于 $100\%$ 的数据，保证 $1\le m\le n\le 2\times 10^5$，$1\le k< n$，$1\le A_i\le n$，$A_i$ 互不相同。另外，为便于编写 Special Judge 保证 $1\le m\times k \le 10^6$，不保证与你的解题过程是否有关。


---

---
title: "会议"
layout: "post"
diff: 普及/提高-
pid: P1395
tag: ['图论', '树形数据结构', '福建省历届夏令营']
---
# 会议
## 题目描述

有一个村庄居住着 $n$ 个村民，有 $n-1$ 条路径使得这 $n$ 个村民的家联通，每条路径的长度都为 $1$。现在村长希望在某个村民家中召开一场会议，村长希望所有村民到会议地点的距离之和最小，那么村长应该要把会议地点设置在哪个村民的家中，并且这个距离总和最小是多少？若有多个节点都满足条件，则选择节点编号最小的那个点。
## 输入格式

第一行，一个数 $n$，表示有 $n$ 个村民。

接下来 $n-1$ 行，每行两个数字 $a$ 和 $b$，表示村民 $a$ 的家和村民 $b$ 的家之间存在一条路径。
## 输出格式

一行输出两个数字 $x$ 和 $y$。

$x$ 表示村长将会在哪个村民家中举办会议。

$y$ 表示距离之和的最小值。
## 样例

### 样例输入 #1
```
4
1 2 
2 3 
3 4 

```
### 样例输出 #1
```
2 4
```
## 提示

#### 数据范围

对于 $70\%$ 数据 $n \le 10^3$。

对于 $100\%$ 数据 $n \le 5 \times 10^4$。


---

---
title: "营救"
layout: "post"
diff: 普及/提高-
pid: P1396
tag: ['图论', '二分', '并查集', '福建省历届夏令营', '最短路', '生成树']
---
# 营救
## 题目背景

“咚咚咚……”“查水表！”原来是查水表来了，现在哪里找这么热心上门的查表员啊！小明感动得热泪盈眶，开起了门……
## 题目描述

妈妈下班回家，街坊邻居说小明被一群陌生人强行押上了警车！妈妈丰富的经验告诉她小明被带到了 $t$ 区，而自己在 $s$ 区。

该市有 $m$ 条大道连接 $n$ 个区，一条大道将两个区相连接，每个大道有一个拥挤度。小明的妈妈虽然很着急，但是不愿意拥挤的人潮冲乱了她优雅的步伐。所以请你帮她规划一条从 $s$ 至 $t$ 的路线，使得经过道路的拥挤度最大值最小。
## 输入格式

第一行有四个用空格隔开的 $n$，$m$，$s$，$t$，其含义见【题目描述】。

接下来 $m$ 行，每行三个整数 $u, v, w$，表示有一条大道连接区 $u$ 和区 $v$，且拥挤度为 $w$。

**两个区之间可能存在多条大道**。
## 输出格式

输出一行一个整数，代表最大的拥挤度。
## 样例

### 样例输入 #1
```
3 3 1 3
1 2 2
2 3 1
1 3 3
```
### 样例输出 #1
```
2

```
## 提示

#### 数据规模与约定

- 对于 $30\%$ 的数据，保证 $n\leq 10$。
- 对于 $60\%$ 的数据，保证 $n\leq 100$。
- 对于 $100\%$ 的数据，保证 $1 \leq n\leq 10^4$，$1 \leq m \leq 2 \times 10^4$，$w \leq 10^4$，$1 \leq s, t \leq n$。且从 $s$ 出发一定能到达 $t$ 区。

--- 

#### 样例输入输出 1 解释

小明的妈妈要从 $1$ 号点去 $3$ 号点，最优路线为 $1$->$2$->$3$。


---

---
title: "[USACO1.3] 虫洞 wormhole"
layout: "post"
diff: 普及/提高-
pid: P1444
tag: ['图论', 'USACO', '枚举']
---
# [USACO1.3] 虫洞 wormhole
## 题目描述

Farmer John 周末进行高能物理实验的结果却适得其反，导致 $n$ 个虫洞出现在农场上，农场是一个二维平面，没有两个虫洞处于同一位置。

根据他的计算，FJ 知道他的虫洞两两配对，形成 $\dfrac{n}{2}$ 对配对。例如，如果 $A$ 和 $B$ 的虫洞连接成一对，进入虫洞 $A$ 的任何物体将从虫洞 $B$ 出去，方向不变；反之亦然。  

然而这可能发生相当令人不快的后果。例如，假设有两个成对的虫洞 $A(1,1)$ 和 $B(3,1)$，Bessie 从 $(2,1)$ 开始朝着 $x$ 正方向移动。Bessie 将进入虫洞 $B(3,1)$，从 $A(1,1)$ 出去，然后再次进入 $B$，困在一个无限循环中！

FJ 知道他的农场里每个虫洞的确切位置。他知道 Bessie 总是向 $x$ 正方向走进来，虽然他不记得贝茜的当前位置。  

请帮助 FJ 计算有多少种虫洞配对方案，使得存在一个位置，使得 Bessie 从该位置出发，会被困在一个无限循环中。
## 输入格式

第一行一个正整数 $n$，表示虫洞数量。

接下来 $n$ 行，每行两个整数 $x,y$，表示一个虫洞的坐标。
## 输出格式

输出一行一个整数表示答案。

## 样例

### 样例输入 #1
```
4
0 0
1 0
1 1
0 1
```
### 样例输出 #1
```
2
```
## 提示

### 数据范围
对于 $100\%$ 的数据，$2\le n \le 12$，$0 \le x,y \le 10^9$。  
保证 $n$ 为偶数。

### 样例解释

将虫洞编号为 $1 \sim 4$，然后通过将 $1,2$ 和 $3,4$ 匹配，如果 Bessie 从 $(0,0)$ 到 $(1,0)$ 之间的任意位置出发，她会陷入无限循环中。

相似的，在相同的起始点，如果配对是 $1,3$ 和 $2,4$，贝茜也会陷入循环。（如果贝西从 $3$ 进去，$1$ 出来，她会走向 $2$ ，然后被传送到 $4$，最后又回到 $3$）

仅有 $1,4$ 和 $2,3$ 的配对允许贝茜从任何二维平面上的点向 $x$ 正方向走，而不出现无限循环。

题面翻译摘自 NOCOW


---

---
title: "休息中的小呆"
layout: "post"
diff: 普及/提高-
pid: P1476
tag: ['图论']
---
# 休息中的小呆
## 题目描述

当大家在考场中接受考验（折磨？）的时候，小呆正在悠闲（欠扁）地玩一个叫“最初梦想”的游戏。游戏描述的是一个叫 pass 的有志少年在不同的时空穿越对抗传说中的大魔王 chinesesonic 的故事。小呆发现这个游戏的故事流程设计得很复杂，它有着很多的分支剧情，但不同的分支剧情是可以同时进行的，因此游戏可以由剧情和剧情的结束点组成，某些剧情必须要在一些特定的剧情结束后才能继续发展。为了体验游戏的完整性，小呆决定要看到所有的分支剧情——完成所有的任务。但这样做会不会耽误小呆宝贵的睡觉时间呢？所以就请你来解决这个问题了。

## 输入格式

小呆会给你一个剧情流程和完成条件的列表，

其中第一行有一个数 $n$，表示总共有 $n$ 个剧情结束点；

第二行一个数 $m$，表示有 $m$个不同的剧情；

下面的 $m$ 行中每行有三个数，表示从剧情结束点 $i$ 必须完成一个耗费时间为 $k$ 的剧情才能到达剧情结束点 $j$。

## 输出格式

你要告诉小呆完成整个游戏至少需要多少时间，以及要经过的所有可能的剧情结束点（按升序输出）。

## 样例

### 样例输入 #1
```
4

5

1 2 2

2 3 2

3 5 3

1 4 3

4 5 3


```
### 样例输出 #1
```
7

1 2 3 5


```
## 提示

### 数据范围及约定

对于全部数据，$0<n<100$，$0<m\le 120$，$0<i\le 100$，$0<j\le 100$，$0<k\le 1000$。


---

---
title: "[USACO2.4] 回家 Bessie Come Home"
layout: "post"
diff: 普及/提高-
pid: P1529
tag: ['图论', 'USACO', '最短路']
---
# [USACO2.4] 回家 Bessie Come Home
## 题目描述

现在是晚餐时间，而母牛们在外面分散的牧场中。 

Farmer John 按响了电铃，所以她们开始向谷仓走去。 你的工作是要指出哪只母牛会最先到达谷仓（在给出的测试数据中，总会**有且只有**一只最快的母牛）。在挤奶的时候（晚餐前），每只母牛都在她自己的牧场上，一些牧场上可能没有母牛。

每个牧场由一条条道路和一个或多个牧场连接（可能包括自己）。有时，两个牧场（可能是字母相同的）之间会有超过一条道路相连。至少有一个牧场和谷仓之间有道路连接。因此，所有的母牛最后都能到达谷仓，并且母牛总是走最短的路径。当然，母牛能向着任意一方向前进，并且她们以相同的速度前进。牧场被标记为 $\texttt{a} \ldots \texttt{z}$ 和 $\texttt{A} \ldots \texttt{Y}$，在用大写字母表示的牧场中有一只母牛，小写字母中则没有。 谷仓的标记是 $\texttt{Z}$，注意没有母牛在谷仓中。

**注意 $\texttt{m}$ 和 $\texttt{M}$ 不是同一个牧场**。
## 输入格式

第一行一个整数 $P$（$1\leq P \leq 10^4$），表示连接牧场（谷仓）的道路的数目。

接下来 $P$ 行，每行用空格分开的两个字母和一个正整数：被道路连接牧场的标号和道路的长度（道路长度均不超过 $10^3$）。

## 输出格式

单独的一行包含二个项目：最先到达谷仓的母牛所在的牧场的标号，和这只母牛走过的路径的长度。
## 样例

### 样例输入 #1
```
5
A d 6
B d 3
C e 9
d Z 8
e Z 3
```
### 样例输出 #1
```
B 11

```
## 提示

翻译来自 NOCOW

USACO 2.4



---

---
title: "[USACO3.1] 最短网络 Agri-Net"
layout: "post"
diff: 普及/提高-
pid: P1546
tag: ['图论', '贪心', 'USACO', '并查集', '生成树']
---
# [USACO3.1] 最短网络 Agri-Net
## 题目背景

Farmer John 被选为他们镇的镇长！他其中一个竞选承诺就是在镇上建立起互联网，并连接到所有的农场。当然，他需要你的帮助。

## 题目描述

FJ 已经给他的农场安排了一条高速的网络线路，他想把这条线路共享给其他农场。为了用最小的消费，他想铺设最短的光纤去连接所有的农场。

你将得到一份各农场之间连接费用的列表，你必须找出能连接所有农场并所用光纤最短的方案。每两个农场间的距离不会超过 $10^5$。
## 输入格式

第一行农场的个数 $N$（$3 \leq N \leq 100$）。

接下来是一个 $N \times N$ 的矩阵，表示每个农场之间的距离。理论上，他们是 $N$ 行，每行由 $N$ 个用空格分隔的数组成，实际上，由于每行 $80$ 个字符的限制，因此，某些行会紧接着另一些行。当然，对角线将会是 $0$，因为不会有线路从第 $i$ 个农场到它本身。
## 输出格式

只有一个输出，其中包含连接到每个农场的光纤的最小长度。

## 样例

### 样例输入 #1
```
4
0 4 9 21
4 0 8 17
9 8 0 16
21 17 16 0
```
### 样例输出 #1
```
28
```
## 提示

题目翻译来自NOCOW。

USACO Training Section 3.1



---

---
title: "[USACO05MAR] Out of Hay S"
layout: "post"
diff: 普及/提高-
pid: P1547
tag: ['图论', '贪心', '2005', 'USACO', '并查集', '生成树', '连通块']
---
# [USACO05MAR] Out of Hay S
## 题目描述

Bessie 计划调查 $N$（$2 \leq N \leq 2\,000$）个农场的干草情况，它从 $1$ 号农场出发。农场之间总共有 $M$（$1 \leq M \leq 10^4$）条双向道路，所有道路的总长度不超过 $10^9$。有些农场之间存在着多条道路，所有的农场之间都是连通的。

Bessie 希望计算出该图中最小生成树中的最长边的长度。

## 输入格式

第一行两个整数 $N,M$。

接下来 $M$ 行，每行三个用空格隔开的整数 $A_i,B_i,L_i$，表示 $A_i,B_i$ 之间有一条道路，长度为 $L_i$。
## 输出格式

一个整数，表示最小生成树中的最长边的长度。

## 样例

### 样例输入 #1
```
3 3
1 2 23
2 3 1000
1 3 43
```
### 样例输出 #1
```
43
```


---

---
title: "[USACO08OCT] Watering Hole G"
layout: "post"
diff: 普及/提高-
pid: P1550
tag: ['图论', '贪心', '2008', 'USACO']
---
# [USACO08OCT] Watering Hole G
## 题目描述

Farmer John 的农场缺水了。

他决定将水引入到他的 $n$ 个农场。他准备通过挖若干井，并在各块田中修筑水道来连通各块田地以供水。在第 $i$ 号田中挖一口井需要花费 $W_i$ 元。连接 $i$ 号田与 $j$ 号田需要 $P_{i,j}$（$P_{j,i}=P_{i,j}$）元。

请求出 FJ 需要为使所有农场都与有水的农场相连或拥有水井所需要的最少钱数。
## 输入格式

第一行为一个整数 $n$。

接下来 $n$ 行，每行一个整数 $W_i$。

接下来 $n$ 行，每行 $n$ 个整数，第 $i$ 行的第 $j$ 个数表示连接 $i$ 号田和 $j$ 号田需要的费用 $P_{i,j}$。
## 输出格式

输出最小开销。

## 样例

### 样例输入 #1
```
4
5
4
4
3
0 2 2 2
2 0 3 3
2 3 0 4
2 3 4 0
```
### 样例输出 #1
```
9
```
## 提示

对于 $100\%$ 的数据，$1 \leq n \leq 300$，$1 \leq W_i \leq 10^5$，$0 \leq P_{i,j} \leq 10^5$。


---

---
title: "最小花费"
layout: "post"
diff: 普及/提高-
pid: P1576
tag: ['图论', '最短路']
---
# 最小花费
## 题目描述

在 $n$ 个人中，某些人的银行账号之间可以互相转账。这些人之间转账的手续费各不相同。给定这些人之间转账时需要从转账金额里扣除百分之几的手续费，请问 $A$ 最少需要多少钱使得转账后 $B$ 收到 $100$ 元。
## 输入格式


第一行输入两个正整数 $n,m$，分别表示总人数和可以互相转账的人的对数。

以下 $m$ 行每行输入三个正整数 $x,y,z$，表示标号为 $x$ 的人和标号为 $y$ 的人之间互相转账需要扣除 $z\%$ 的手续费 $(z<100)$。

最后一行输入两个正整数 $A,B$。数据保证 $A$ 与 $B$ 之间可以直接或间接地转账。
## 输出格式

输出 $A$ 使得 $B$ 到账 $100$ 元最少需要的总费用。精确到小数点后 $8$ 位。
## 样例

### 样例输入 #1
```
3 3                                     
1 2 1
2 3 2
1 3 3
1 3

```
### 样例输出 #1
```
103.07153164
```
## 提示

$1\le n \le 2000,m\le 100000$。


---

---
title: "邮递员送信"
layout: "post"
diff: 普及/提高-
pid: P1629
tag: ['图论', '优先队列', '最短路', '队列']
---
# 邮递员送信
## 题目描述

有一个邮递员要送东西，邮局在节点 $1$。他总共要送 $n-1$ 样东西，其目的地分别是节点 $2$ 到节点 $n$。由于这个城市的交通比较繁忙，因此所有的道路都是单行的，共有 $m$ 条道路。这个邮递员每次只能带一样东西，并且**运送每件物品过后必须返回邮局**。求送完这 $n-1$ 样东西并且**最终回到邮局**最少需要的时间。
## 输入格式

第一行包括两个整数，$n$ 和 $m$，表示城市的节点数量和道路数量。

第二行到第 $(m+1)$ 行，每行三个整数，$u,v,w$，表示从 $u$ 到 $v$ 有一条通过时间为 $w$ 的道路。
## 输出格式

输出仅一行，包含一个整数，为最少需要的时间。
## 样例

### 样例输入 #1
```
5 10
2 3 5
1 5 5
3 5 6
1 2 8
1 3 8
5 3 4
4 1 8
4 5 3
3 5 6
5 4 2
```
### 样例输出 #1
```
83
```
## 提示

对于 $30\%$ 的数据，$1 \leq n \leq 200$。

对于 $100\%$ 的数据，$1 \leq n \leq 10^3$，$1 \leq m \leq 10^5$，$1\leq u,v \leq n$，$1 \leq w \leq 10^4$，输入保证任意两点都能互相到达。


---

---
title: "[USACO07OCT] Obstacle Course S"
layout: "post"
diff: 普及/提高-
pid: P1649
tag: ['动态规划 DP', '图论', '2007', 'USACO', '广度优先搜索 BFS']
---
# [USACO07OCT] Obstacle Course S
## 题目描述

Consider an N x N (1 <= N <= 100) square field composed of 1

by 1 tiles. Some of these tiles are impassible by cows and are marked with an 'x' in this 5 by 5 field that is challenging to navigate:

```cpp
. . B x . 
. x x A . 
. . . x . 
. x . . . 
. . x . . 
```
Bessie finds herself in one such field at location A and wants to move to location B in order to lick the salt block there.  Slow, lumbering creatures like cows do not like to turn and, of course, may only move parallel to the edges of the square field. For a given field, determine the minimum number of ninety degree turns in any path from A to B. The path may begin and end with Bessie facing in any direction. Bessie knows she can get to the salt lick.


## 输入格式

第一行一个整数 $N$,下面 $N$ 行，每行 $N$ 个字符，只出现字符：$\verb!.!,\verb!x!,\verb!A!,\verb!B!$，表示上面所说的矩阵格子，每个字符后有一个空格。

## 输出格式

一个整数：最少转弯次数。如果不能到达，输出 $-1$。

## 样例

### 样例输入 #1
```
3
. x A
. . .
B x .
```
### 样例输出 #1
```
2
```
## 提示

只可以上下左右四个方向行走，并且不能走出这些格子之外。开始和结束时的方向可以任意。

### 数据范围及约定

对于全部数据，保证 $2\le N\le 100$。

## 题目翻译

$N\times N\ (1\le N\le 100)$ 方格中，$\verb!x!$ 表示不能行走的格子，$\verb!.!$ 表示可以行走的格子。卡门很胖，故而不好转弯。现在要从 $A$ 点走到 $B$ 点，请问最少要转 $90$ 度弯多少次？


---

---
title: "炸铁路"
layout: "post"
diff: 普及/提高-
pid: P1656
tag: ['模拟', '搜索', '图论', '并查集', '洛谷原创', '最短路', 'Tarjan']
---
# 炸铁路
## 题目描述

A 国派出将军 uim，对 B 国进行战略性措施，以解救涂炭的生灵。

B 国有 $n$ 个城市，这些城市以铁路相连。任意两个城市都可以通过铁路直接或者间接到达。

uim 发现有些铁路被毁坏之后，某两个城市无法互相通过铁路到达。这样的铁路就被称为 key road。

uim 为了尽快使该国的物流系统瘫痪，希望炸毁铁路，以达到存在某两个城市无法互相通过铁路到达的效果。

然而，只有一发炮弹（A 国国会不给钱了）。所以，他能轰炸哪一条铁路呢？

## 输入格式

第一行 $n,m\ (1 \leq n\leq 150$，$1 \leq m \leq 5000)$，分别表示有 $n$ 个城市，总共 $m$ 条铁路。

以下 $m$ 行，每行两个整数 $a, b$，表示城市 $a$ 和城市 $b$ 之间有铁路直接连接。

## 输出格式

输出有若干行。

每行包含两个数字 $a,b$，其中 $a<b$，表示 $\lang a,b\rang$ 是 key road。

请注意：输出时，所有的数对 $\lang a,b\rang$ 必须按照 $a$ 从小到大排序输出；如果$a$ 相同，则根据 $b$ 从小到大排序。

## 样例

### 样例输入 #1
```
6 6
1 2
2 3
2 4
3 5
4 5
5 6
```
### 样例输出 #1
```
1 2
5 6
```


---

---
title: "扩散"
layout: "post"
diff: 普及/提高-
pid: P1661
tag: ['图论', '树形数据结构', '二分']
---
# 扩散
## 题目描述

一个点每过一个单位时间就会向四个方向扩散一个距离，如图。

![](https://cdn.luogu.com.cn/upload/image_hosting/cd4e53lw.png)

两个点 $a$ 、 $b$ 连通，记作 $e(a,b)$，当且仅当 $a,b$ 的扩散区域有公共部分。连通块的定义是块内的任意两个点 $u,v$ 都必定存在路径 $e(u,a_0),e(a_0,a_1),\cdots,e(a_k,v)$。给定平面上的 $n$ 个点，问最早什么时刻它们形成一个连通块。

## 输入格式

第一行一个数 $n$，以下 $n$ 行，每行一个点坐标。
## 输出格式

一个数，表示最早的时刻所有点形成连通块。

## 样例

### 样例输入 #1
```
2

0 0

5 5
```
### 样例输出 #1
```
5
```
## 提示

### 数据范围及约定

对于 $20\%$ 的数据，满足 $1 \le N \le 5;1 \le X_i,Y_i \le 50$。

对于 $100\%$ 的数据，满足 $1 \le N \le 50$，$1 \le X_i,Y_i \le 10^9$。


---

---
title: "部落卫队"
layout: "post"
diff: 普及/提高-
pid: P1692
tag: ['搜索', '图论', '洛谷原创']
---
# 部落卫队
## 题目描述

原始部落 byteland 中的居民们为了争夺有限的资源，经常发生冲突。几乎每个居民都有他的仇敌。部落酋长为了组织一支保卫部落的队伍，希望从部落的居民中选出最多的居民入伍，并保证队伍中任何 $2$ 个人都不是仇敌。

给定 byteland 部落中居民间的仇敌关系，编程计算组成部落卫队的最佳方案。若有多种方案可行，输出字典序最大的方案。
## 输入格式

第 $1$ 行有 $2$ 个正整数 $n$ 和 $m$，表示 byteland 部落中有 $n$ 个居民，居民间有 $m$ 个仇敌关系。居民编号为 $1,2, \cdots ,n$。接下来的 $m$ 行中，每行有 $2$ 个正整数 $u$ 和 $v$，表示居民 $u$ 与居民 $v$ 是仇敌。
## 输出格式

第 $1$ 行是部落卫队的人数；文件的第 $2$ 行是卫队组成 $x_i$，$1 \le i \le n$，$x_i=0$ 表示居民 $i$ 不在卫队中，$x_i=1$ 表示居民 $i$ 在卫队中。
## 样例

### 样例输入 #1
```
7  10
1  2
1  4
2  4
2  3
2  5
2  6
3  5
3  6
4  5
5  6
```
### 样例输出 #1
```
3
1 0 1 0 0 0 1

```
## 提示

对于 $60\%$ 数据：$n \le 20$，$m \le 100$。

对于所有数据：$n \le 100,m \le 3000$。数据从所有合法数据从随机均匀取样。


---

---
title: "采购特价商品"
layout: "post"
diff: 普及/提高-
pid: P1744
tag: ['图论', '最短路', '队列']
---
# 采购特价商品
## 题目背景

《爱与愁的故事第三弹·shopping》第一章。
## 题目描述

中山路店山店海，成了购物狂爱与愁大神的“不归之路”。中山路上有 $n$（$n \leq 100$）家店，每家店的坐标均在 $-10000$ 至 $10000$ 之间。其中的 $m$ 家店之间有通路。若有通路，则表示可以从一家店走到另一家店，通路的距离为两点间的直线距离。现在爱与愁大神要找出从一家店到另一家店之间的最短距离。你能帮爱与愁大神算出吗？
## 输入格式

共 $n+m+3$ 行：

第一行：整数 $n$。 

接下来 $n$ 行：每行两个整数 $x$ 和 $y$，描述了一家店的坐标。 

接下来一行：整数 $m$。 

接下来 $m$ 行：每行描述一条通路，由两个整数 $i$ 和 $j$ 组成，表示第 $i$ 家店和第 $j$ 家店之间有通路。

接下来一行：两个整数 $s$ 和 $t$，分别表示原点和目标店。 
## 输出格式

仅一行：一个实数（保留两位小数），表示从 $s$ 到 $t$ 的最短路径长度。
## 样例

### 样例输入 #1
```
5

0 0

2 0

2 2

0 2

3 1

5

1 2

1 3

1 4

2 5

3 5

1 5
```
### 样例输出 #1
```
3.41
```
## 提示

对于 $100 \%$ 的数据：$2 \le n \leq 100$，$1 \le i, j, s, t \le n$，$1 \le m \leq 1000$。 


---

---
title: "最长路"
layout: "post"
diff: 普及/提高-
pid: P1807
tag: ['图论', 'NOI 导刊', '广度优先搜索 BFS', '拓扑排序']
---
# 最长路
## 题目描述

设 $G$ 为有 $n$ 个顶点的带权有向无环图，$G$ 中各顶点的编号为 $1$ 到 $n$，请设计算法，计算图 $G$ 中 $1, n$ 间的最长路径。
## 输入格式

输入的第一行有两个整数，分别代表图的点数 $n$ 和边数 $m$。

第 $2$ 到第 $(m + 1)$ 行，每行 $3$ 个整数 $u, v, w$（$u<v$），代表存在一条从 $u$ 到  $v$ 边权为 $w$ 的边。
## 输出格式

输出一行一个整数，代表 $1$ 到 $n$ 的最长路。

若 $1$ 无法到达 $n$，请输出 $-1$。
## 样例

### 样例输入 #1
```
2 1
1 2 1
```
### 样例输出 #1
```
1
```
## 提示

**【数据规模与约定】**

- 对于 $20\%$的数据，$n \leq 100$，$m \leq 10^3$。
- 对于 $40\%$ 的数据，$n \leq 10^3$，$m \leq 10^{4}$。
- 对于 $100\%$ 的数据，$1 \leq n \leq 1500$，$0 \leq m \leq 5 \times 10^4$，$1 \leq u, v \leq n$，$-10^5 \leq w \leq 10^5$。


---

---
title: "[USACO07FEB] Cow Party S"
layout: "post"
diff: 普及/提高-
pid: P1821
tag: ['图论', '2007', 'USACO', 'O2优化', '最短路']
---
# [USACO07FEB] Cow Party S
## 题目描述

寒假到了，$n$ 头牛都要去参加一场在编号为 $x$ 的牛的农场举行的派对，农场之间有 $m$ 条有向路，每条路都有一定的长度。

每头牛参加完派对后都必须回家，无论是去参加派对还是回家，每头牛都会选择最短路径，求这 $n$ 头牛的最短路径（一个来回）中最长的一条路径长度。

## 输入格式

第一行有三个整数，分别表示牛的数量 $n$，道路数 $m$ 和派对农场编号 $x$。  
接下来 $m$ 行，每行三个整数 $u, v, w$，表示存在一条由 $u$ 通向 $v$ 的长度为 $w$ 的道路。
## 输出格式

输出一行一个整数表示答案。
## 样例

### 样例输入 #1
```
4 8 2
1 2 4
1 3 2
1 4 7
2 1 1
2 3 5
3 1 2
3 4 4
4 2 3

```
### 样例输出 #1
```
10
```
## 提示

### 样例 1 解释
![](https://cdn.luogu.com.cn/upload/image_hosting/rl3com2y.png)

### 数据规模与约定

对于全部的测试点，保证 $1 \leq x \leq n \leq 10^3$，$1 \leq m \leq 10^5$，$1 \leq u,v \leq n$，$1 \leq w \leq 10^2$，保证从任何一个结点出发都能到达 $x$ 号结点，且从 $x$ 出发可以到达其他所有节点。


---

---
title: "[USACO3.2] 香甜的黄油 Sweet Butter"
layout: "post"
diff: 普及/提高-
pid: P1828
tag: ['图论', 'USACO', '队列']
---
# [USACO3.2] 香甜的黄油 Sweet Butter
## 题目描述

Farmer John 发现了做出全威斯康辛州最甜的黄油的方法：糖。

把糖放在一片牧场上，他知道 $N$ 只奶牛会过来舔它，这样就能做出能卖好价钱的超甜黄油。当然，他将付出额外的费用在奶牛上。

Farmer John 很狡猾。像以前的 Pavlov，他知道他可以训练这些奶牛，让它们在听到铃声时去一个特定的牧场。他打算将糖放在那里然后下午发出铃声，以至他可以在晚上挤奶。

Farmer John 知道每只奶牛都在各自喜欢的牧场（一个牧场不一定只有一头牛）。给出各头牛在的牧场和牧场间的路线，找出使所有牛到达的路程和最短的牧场（他将把糖放在那）。
## 输入格式

第一行包含三个整数 $N,P,C$，分别表示奶牛数、牧场数和牧场间道路数。

第二行到第 $N+1$ 行，每行一个整数，其中第 $i$ 行的整数表示第 $i-1$ 头奶牛所在的牧场号。

第 $N+2$ 行到第 $N+C+1$ 行，每行包含三个整数 $A,B,D$，表示牧场号为 $A$ 和 $B$ 的两个牧场之间有一条长度为 $D$ 的双向道路相连。
## 输出格式

输出一行一个整数，表示奶牛必须行走的最小的距离和。
## 样例

### 样例输入 #1
```
3 4 5
2
3
4
1 2 1
1 3 5
2 3 7
2 4 3
3 4 5
```
### 样例输出 #1
```
8
```
## 提示

**数据范围**

对于所有数据，$1 \le N \le 500$，$2 \le P \le 800$，$1 \le A,B \le P$，$1 \le C \le 1450$，$1 \le D \le 255$。

---

**样例解释**

作图如下：

```cpp
          P2  
P1 @--1--@ C1
         |
         | 
       5  7  3
         |   
         |     C3
       C2 @--5--@
          P3    P4
```

把糖放在4号牧场最优。


---

---
title: "设计道路"
layout: "post"
diff: 普及/提高-
pid: P1907
tag: ['图论']
---
# 设计道路
## 题目描述

Caesar远征高卢回来后，对你大加赞赏，他亲自来到Genoa视察。

Genoa在你的建设下变得无比繁荣，由于财政收入的增加，你为城市修建了交通系统。古罗马的交通系统由两部分组成——Dirt Road和Rome Road。两个路口间只可能是其中一种道路。在Rome Road上可以驾驶马车，而在Dirt Road上则不行。由于修建道路是一项浩大的工程，使得你无法将整个城市用Rome Road连接起来。

现在Caesar已经到达码头，他要求去你家参观。Caesar由一个癖好，喜欢坐车而不喜欢走路。所以Caesar走Dirt Road时的不满值要比走Rome Road时大。

为了不让Caesar过于不满而罢免你的职位，请设计路线使得Caesar的不满值最小。

## 输入格式

输入数据第一行有两个实数，分别表示走Dirt Road和Rome Road一个单位长度时Caesar的不满值。接下来是一个整数N（N<=1000），代表路口总数。接下来有N行，每行一组实数(x,y)分别描述这N个路口的坐标。接下来有若干行，每行一组整数（i,j），表示第i个路口与第j个路口间为Rome Road，以0 0结束。最后两行，每行一对实数，分别描述码头和你家的坐标。

## 输出格式

输出Caesar从码头到你家的最小不满值，保留4位小数

## 样例

### 样例输入 #1
```
100.0 2.0

2

1.0 0.0

2.0 1.0

1 2

0 0

0.0 0.0

2.0 2.0


```
### 样例输出 #1
```
202.8284
```


---

---
title: "[USACO09NOV] Job Hunt S"
layout: "post"
diff: 普及/提高-
pid: P1938
tag: ['图论', '2009', 'USACO', '最短路']
---
# [USACO09NOV] Job Hunt S
## 题目描述

Bessie is running out of money and is searching for jobs. Farmer John knows this and wants the cows to travel around so he has imposed a rule that his cows can only make D (1 <= D <= 1,000) dollars in a city before they must work in another city. Bessie can, however, return to a city after working elsewhere for a while and again earn the D dollars maximum in that city. There is no limit on the number of times Bessie can do this.

Bessie's world comprises P (1 <= P <= 150) one-way paths connecting C (2 <= C <= 220) cities conveniently numbered 1..C. Bessie is currently in city S (1 <= S <= C). Path i runs one-way from city A\_i to city B\_i (1 <= A\_i <= C; 1 <= B\_i <= C) and costs nothing to traverse.

To help Bessie, Farmer John will give her access to his private jet service. This service features F (1 <= F <= 350) routes, each of which is a one way flight from one city J\_i to a another K\_i (1 <= J\_i <= C; 1 <= K\_i <= C) and which costs T\_i (1 <= T\_i <= 50,000) dollars. Bessie can pay for the tickets from future earnings if she doesn't have the cash on hand.

Bessie can opt to retire whenever and wherever she wants. Given an unlimited amount of time, what is the most money that Bessie can make presuming she can make the full D dollars in each city she can travel to?  Print -1 if there is no limit to this amount.

奶牛们正在找工作。农场主约翰知道后，鼓励奶牛们四处碰碰运气。而且他还加了一条要求：一头牛在一个城市最多只能赚D（1≤D≤1000）美元，然后它必须到另一座城市工作。当然，它可以在别处工作一阵子后又回到原来的城市再最多赚D美元。而且这样的往返次数没有限制。

城市间有P（1≤P≤150）条单向路径连接，共有C（2≤C≤220）座城市，编号从1到C。奶牛贝茜当前处在城市S（1≤S≤C）。路径i从城市A\_i到城市B\_i（1≤A\_i≤C，1≤B\_i≤C），在路径上行走不用任何花费。

为了帮助贝茜，约翰让它使用他的私人飞机服务。这项服务有F条（1≤F≤350）单向航线，每条航线是从城市J\_i飞到另一座城市K\_i（1≤J\_i≤C，1≤K\_i≤C），费用是T\_i（1≤T\_i≤50000）美元。如果贝茜手中没有现钱，可以用以后赚的钱来付机票钱。

贝茜可以选择在任何时候，在任何城市退休。如果在工作时间上不做限制，贝茜总共可以赚多少钱呢？如果赚的钱也不会出现限制，就输出-1。

## 输入格式

第一行：5个用空格分开的整数D，P，C，F，S。

第2到第P+1行：第i+1行包含2个用空格分开的整数，表示一条从城市A\_i到城市B\_i的单向路径。

接下来F行，每行3个用空格分开的整数，表示一条从城市J\_i到城市K\_i的单向航线，费用是T\_i。

## 输出格式

一个整数，在上述规则下最多可以赚到的钱数。

## 样例

### 样例输入 #1
```
100 3 5 2 1
1 5
2 3
1 4
5 2 150
2 5 120

```
### 样例输出 #1
```
250
```
## 提示

This world has five cities, three paths and two jet routes. Bessie starts out in city 1, and she can only make 100 dollars in each city before moving on.


Bessie can travel from city 1 to city 5 to city 2 to city 3, and make a total of 4\*100 - 150 = 250 dollars.


Source: USACO 2009 November Silver

这个世界上有五个城市，三条单向路径和两条单向航线。贝茜从一号城市开始她的旅行，她在离开一个城市前最多只能在这个城市赚100美元。


贝茜可以通过从一号城市-->五号城市-->二号城市-->三号城市的旅行赚到4\*100-150=250美元。


(注:在四个城市各赚100美元,从五号城市飞到二号城市花掉150美元)


来源:USACO 2009 十一月银组



---

---
title: "郁闷的记者"
layout: "post"
diff: 普及/提高-
pid: P1960
tag: ['图论', 'NOI 导刊', 'Special Judge']
---
# 郁闷的记者
## 题目描述

你是一个体育报社的记者，你接受到一个艰难的任务：有 $N$ 支足球队参加足球比赛，现在给你一些比赛的结果，需要你给出各支球队的排名，从 $1$ 到 $N$。

以下是给你的一些信息：

 1. 没有平局；
 2. 不同的球队排名不能相同；
 3. 对于所有满足 $1 \le a<b \le N$，第 $a$ 名的球队一定可以打败第 $b$ 名的球队。

给你部分比赛结果，要求给出排名，并且判断是否存在另一种排名方法满足给你的比赛结果。

## 输入格式

第一行输入 $N(1 \le N \le 5000)$，表示球队的数量，编号为 $1$ 到 $N$。

第二行输入 $M(1 \le M \le 100,000)$，表示给出的比赛场数。

接下来 $M$ 行，每行两个整数 $X_i$，$Y_i$，表示 $X_i$ 能打败 $Y_i$。

## 输出格式

输出包含 $N+1$ 行，前 $N$ 行描述球队的排名，第 $i$ 个数表示第 $i$ 名的球队，第 $N+1$ 行包含一个整数，如果为 $0$ 表示不存在其他的排名方法，如果为 $1$ 表示还有其他的排名方法。

## 样例

### 样例输入 #1
```
3
2
2 1
2 3
```
### 样例输出 #1
```
2
1
3
1

```
## 提示

【数据范围】

$30\%$ 的数据满足：$1 \le N \le7$，$1 \le M \le 15$

$60\%$的数据满足：$1 \le N \le 100$，$1 \le M \le 2000$

$100\%$ 的数据满足：$1 \le N \le 5000$，$1 \le M \le 100000$


本题已加入spj，如果输出的最后一行错误将会提示 `Your decide is wrong!`

如果存在多种排名情况，排名错误将会提示 `Wrong ranks!`

如果情况固定且您的答案错误将会提示 `In line X,Your ans is wrong:expected = X,found = Y`



---

---
title: "无线通讯网"
layout: "post"
diff: 普及/提高-
pid: P1991
tag: ['图论', '并查集', '生成树']
---
# 无线通讯网
## 题目描述

国防部计划用无线网络连接若干个边防哨所。2 种不同的通讯技术用来搭建无线网络；

每个边防哨所都要配备无线电收发器；有一些哨所还可以增配卫星电话。

任意两个配备了一条卫星电话线路的哨所（两边都有卫星电话）均可以通话，无论他们相距多远。而只通过无线电收发器通话的哨所之间的距离不能超过 $D$，这是受收发器的功率限制。收发器的功率越高，通话距离 $D$ 会更远，但同时价格也会更贵。

收发器需要统一购买和安装，所以全部哨所只能选择安装一种型号的收发器。换句话说，每一对哨所之间的通话距离都是同一个 $D$。你的任务是确定收发器必须的最小通话距离 $D$，使得每一对哨所之间至少有一条通话路径（直接的或者间接的）。

## 输入格式

第一行，$2$ 个整数 $S$ 和 $P$，$S$ 表示可安装的卫星电话的哨所数，$P$ 表示边防哨所的数量。

接下里 $P$ 行，每行两个整数 $x，y$ 描述一个哨所的平面坐标 $(x, y)$，以 km 为单位。

## 输出格式

第一行，$1$ 个实数 $D$，表示无线电收发器的最小传输距离，精确到小数点后两位。

## 样例

### 样例输入 #1
```
2 4
0 100
0 300
0 600
150 750

```
### 样例输出 #1
```
212.13

```
## 提示

### 数据范围及约定

- 对于 $20\%$ 的数据：$P = 2，S = 1$；
- 对于另外 $20\%$ 的数据：$P = 4，S = 2$；
- 对于 $100\%$ 的数据保证：$1 ≤ S ≤ 100$，$S < P ≤ 500$，$0 ≤ x,y ≤ 10000$。



---

---
title: "跑步"
layout: "post"
diff: 普及/提高-
pid: P2009
tag: ['图论']
---
# 跑步
## 题目背景

跑步是一项有意思的运动，尤其是可以开发人的脑筋。常神牛很喜欢跑步。

## 题目描述


常神牛跑步的场地是一个多边形（边数 $\leq 20$，每个顶点用英文大写字母表示），并且在这个多边形内部，还会有一些小道，连接两个不相邻的顶点。所有的边长和小道都是双向通行的举例来说，下面一个图：

 ![](https://cdn.luogu.com.cn/upload/pic/1049.png)

假设常神牛从 $A$ 点跑到 $D$ 点，最短的路径是 $A-E-D$（长度为 $6$）。

现在告诉你多边形的边数 $n$，多边形每条边的长度，多边形内的连线数 $k$，每条连线的两个端点及长度，以及起始点和结束点，请你输出最短路径的长度。但是常神牛有点强迫症，如果两点之间有多条道路直接连接，他会选择最长的那条。

注意：输入数据不保证起点和终点不同，也不保证小道的起点和终点不同。在读入过程中，如果两点之间有多条小道，那么它们间的距离为这些小道的最大值。所以，如果读入一个小道起点和终点相同，那么这个点到它本身的距离不为 $0$。

## 输入格式

第一行，$2$ 个数，$n,k$。

第二行，$n$ 个数，分别表示多边形每条边的长度（按顺时针次序依次给出，即分别为 $AB,BC,CD,DE……$ 的长度）。

以下 $k$ 行，每行两个字母和一个数，两个字母表示该连线的起止点，数字表示长度。

最后一行，两个字母，分别为他跑步的起点和终点。

所有的一行的字母、数字之间用一个空格隔开。
## 输出格式

一行，一个数，表示最短路的长度。

## 样例

### 样例输入 #1
```
5 2
6 4 5 4 2
A D 7
E B 8
A D
```
### 样例输出 #1
```
6
```
## 提示

对于 $20\%$ 的数据，$k=0$；

对于 $50\%$ 的数据，$k \leq 10$；

对于 $100\%$ 的数据，$1 \leq n \leq 20$，$0 \leq m \leq 50$，$k \leq 100$，所有路径长度均不大于 $1000$。


---

---
title: "拆地毯"
layout: "post"
diff: 普及/提高-
pid: P2121
tag: ['图论', '生成树']
---
# 拆地毯
## 题目背景

还记得 NOIP 2011 提高组 Day1 中的铺地毯吗？时光飞逝，光阴荏苒，三年过去了。组织者精心准备的颁奖典礼早已结束，留下的则是被人们踩过的地毯。请你来解决类似于铺地毯的另一个问题。

## 题目描述

会场上有 $n$ 个关键区域，不同的关键区域由 $m$ 条无向地毯彼此连接。每条地毯可由三个整数 $u$、$v$、$w$ 表示，其中 $u$ 和 $v$ 为地毯连接的两个关键区域编号，$w$ 为这条地毯的美丽度。

由于颁奖典礼已经结束，铺过的地毯不得不拆除。为了贯彻勤俭节约的原则，组织者被要求只能保留至多 $K$ 条地毯，且保留的地毯构成的图中，任意可互相到达的两点间只能有一种方式互相到达。换言之，组织者要求新图中不能有环。现在组织者求助你，想请你帮忙算出这至多 $K$ 条地毯的美丽度之和最大为多少。

## 输入格式

第一行包含三个正整数 $n$、$m$、$K$。

接下来 $m$ 行中每行包含三个正整数 $u$、$v$、$w$。

## 输出格式

只包含一个正整数，表示这 $K$ 条地毯的美丽度之和的最大值。

## 样例

### 样例输入 #1
```
5 4 3
1 2 10
1 3 9
2 3 7
4 5 3
```
### 样例输出 #1
```
22
```
## 提示

选择第 $1$、$2$、$4$ 条地毯，美丽度之和为 $10 + 9 + 3 = 22$。

若选择第 $1$、$2$、$3$ 条地毯，虽然美丽度之和可以达到 $10 + 9 + 7 = 26$，但这将导致关键区域 $1$、$2$、$3$ 构成一个环，这是题目中不允许的。


$1\le n,m,k \le 10^5$。



---

---
title: "Mzc家中的男家丁"
layout: "post"
diff: 普及/提高-
pid: P2126
tag: ['图论', '贪心']
---
# Mzc家中的男家丁
## 题目背景

mzc 与 djn 的…还没有众人皆知，所以我们要来宣传一下。

## 题目描述

mzc 家很有钱（开玩笑），他家有 $n$ 个男家丁，现在 mzc 要将她们全都聚集起来（干什么就不知道了）。现在知道 mzc 与男家丁们互相之间通信的时间，请算出把他们每个人叫到需要的总时间（要重复的哦）。保证能把他们每个人叫到。
## 输入格式

第一行有一个数 $n$，表示有 $n$ 个男家丁。第二行一个数 $m$ 表示有 $m$ 条通信路线。之后 $m$ 行，每行三个数 $a_i,b_i,c_i$，表示第 $a_i$个男家丁（或 mzx）和第 $b_i$ 个男家丁（或 mzc）通信需要时间（双向）。$a_i\left(\text{或}b_i\right)=0$ 表示 mzc。
## 输出格式

一行，一个数 $sum$，表示把他们每个人叫到需要的总时间。
## 样例

### 样例输入 #1
```
5
12
0 2 15
2 3 20
3 5 13
1 3 29
0 1 30
2 4 21
0 3 23
5 1 48
0 4 17
0 5 27
1 2 43
2 5 41

```
### 样例输出 #1
```
94

```
## 提示

$n\leq2300,m\leq4\times10^5$



---

---
title: "公路通行税"
layout: "post"
diff: 普及/提高-
pid: P2185
tag: ['图论', '广度优先搜索 BFS']
---
# 公路通行税
## 题目描述

在 PALMIA 国家内，有 $N$ 个城市由公路相连（每条公路恰好双向连接两个城市）。经由一条公路或多条公路，从任一城市出发可以到达其余各个城市。直到今年，公路上才要征收公路通行税。在每条公路的中间，有一征税员，从每一辆经由此路的车收取 1 PALMIA COIN（1PC）。

政府官员决定减少收税员而推行公路印花。如果一辆车欲进入一条公路，就必须将这张印花贴在窗上。

政府官员决定：一年的公路印花的价值相当于在两个最远城市之间进行 $100$ 次旅行所需的费用。两个城市之间的距离是从一个城市到达第二个城市所需经过的最少数目的公路数。

你的任务是编写一个程序计算出公路印花的价值。
## 输入格式

输入文件中包含几组数据。每组的第一行包括整数 $N$ 和 $M$（中间被一个空格隔开），$N$ 是该国家中城市的数目，$M$ 是公路的数目（$1\le N\le1000$，$1\le M\le25000$）。城市由整数进行编号，从 $1$ 到 $N$ 。接下来的 $M$ 行，每行均包含一对整数 $A$，$B$（$1\le A,B\le N$），中间由一空格隔开，代表在城市 $A$ 与 $B$ 之间有一条公路。在最后一组数后仅有一行，是两个 $0$，中间被一空格隔开。

## 输出格式

对输入文件中的各组数据，输出文件中包含一行，表示公路印花的价值。

## 样例

### 样例输入 #1
```
4 4
1 2
2 3
4 2
3 4
0 0
```
### 样例输出 #1
```
200
```


---

---
title: "[USACO14MAR] The Lazy Cow S"
layout: "post"
diff: 普及/提高-
pid: P2213
tag: ['图论', '2014', 'USACO', '生成树', '前缀和']
---
# [USACO14MAR] The Lazy Cow S
## 题目描述

It's a hot summer day, and Bessie the cow is feeling quite lazy.  She wants

to locate herself at a position in her field so that she can reach as much

delicious grass as possible within only a short distance.


The field Bessie inhabits is described by an N by N grid of square cells

(1 <= N <= 400).  The cell in row r and column c (1 <= r,c <= N) contains

G(r,c) units of grass (0 <= G(r,c) <= 1000).  From her initial square in

the grid, Bessie is only willing to take up to K steps (0 <= K <= 2\*N).

Each step she takes moves her to a cell that is directly north, south,

east, or west of her current location.


For example, suppose the grid is as follows, where (B) describes Bessie's

```cpp
50    5     25*   6     17    
14    3*    2*    7*    21    
99*   10*   1*(B) 2*    80*    
8     7*    5*    23*   11   
10    0     78*   1     9        
```

initial position (here, in row 3, column 3):

If K=2, then Bessie can only reach the locations marked with \*s.

Please help Bessie determine the maximum amount of grass she can reach, if

she chooses the best possible initial location in the grid.

奶牛贝茜非常懒惰，她希望在她的地盘内找到一点最佳位置居住，以便在有限的步数内可以吃到尽量多的青草。

她的地盘是一个 $N \times N(1\le N \le 400)$ 的矩阵，第 $r$ 行 $c$ 列包含 $G(r,c)$ 单位的青草 $(0 \le G(r,c) \le 1000)$。从她的居住点，她最多愿意走 $K$ 步 $(0 \le K \le 2 \times N)$，每一步她可以走到上与她相邻的某个格子。
## 输入格式

\* Line 1: The integers N and K.


\* Lines 2..1+N: Line r+1 contains N integers describing row r of the

grid.
## 输出格式

\* Line 1: The maximum amount of grass Bessie can reach, if she chooses

the best possible initial location (the location from which

she can reach the most grass).

## 样例

### 样例输入 #1
```
5 2
50 5 25 6 17
14 3 2 7 21
99 10 1 2 80
8 7 5 23 11
10 0 78 1 9

```
### 样例输出 #1
```
342
```
## 提示

OUTPUT DETAILS:


In the example above, Bessie can reach 342 total units of grass if she

locates herself in the middle of the grid.


Source: USACO 2014 March Contest, Silver



---

---
title: "[NOIP 2014 提高组] 寻找道路"
layout: "post"
diff: 普及/提高-
pid: P2296
tag: ['搜索', '图论', '2014', 'NOIP 提高组']
---
# [NOIP 2014 提高组] 寻找道路
## 题目背景

NOIP2014 提高组 D2T2
## 题目描述

在有向图 $G$ 中，每条边的长度均为 $1$，现给定起点和终点，请你在图中找一条从起点到终点的路径，该路径满足以下条件：

1. 路径上的所有点的出边所指向的点都直接或间接与终点连通。
2. 在满足条件 $1$ 的情况下使路径最短。

注意：图 $G$ 中可能存在重边和自环，题目保证终点没有出边。

请你输出符合条件的路径的长度。
## 输入格式

第一行有两个用一个空格隔开的整数 $n$ 和 $m$，表示图有 $n$ 个点和 $m$ 条边。

接下来的 $m$ 行每行 $2$ 个整数 $x,y$，之间用一个空格隔开，表示有一条边从点 $x$ 指向点 $y$。

最后一行有两个用一个空格隔开的整数 $s,t$，表示起点为 $s$，终点为 $t$。
## 输出格式

输出只有一行，包含一个整数，表示满足题目描述的最短路径的长度。如果这样的路径不存在，输出 $-1$。
## 样例

### 样例输入 #1
```
3 2
1 2
2 1
1 3
```
### 样例输出 #1
```
-1
```
### 样例输入 #2
```
6 6
1 2
1 3
2 6
2 5  
4 5
3 4
1 5
```
### 样例输出 #2
```
3
```
## 提示

**样例 1 解释**

![](https://cdn.luogu.com.cn/upload/image_hosting/2p3mke49.png) 

如上图所示，箭头表示有向道路，圆点表示城市。起点 $1$ 与终点 $3$ 不连通，所以满足题目描述的路径不存在，故输出 $-1$。

**样例 2 解释**

![](https://cdn.luogu.com.cn/upload/image_hosting/tm2e1lqq.png)
如上图所示，满足条件的路径为 $1\to 3\to 4\to 5$。注意点 $2$ 不能在答案路径中，因为点 $2$ 连了一条边到点 $6$，而点 $6$ 不与终点 $5$ 连通。

**数据范围及约定**

- 对于 $30\%$ 的数据，$0<n\le10$，$0<m\le 20$。
- 对于 $60\%$ 的数据，$0<n\le100$，$0<m\le 2000$。
- 对于 $100\%$ 的数据，$0<n\le 10^4$，$0<m\le 2\times 10^5$，$0<x,y,s,t\le n,x,s\ne t$。


---

---
title: "Mzc和体委的争夺战"
layout: "post"
diff: 普及/提高-
pid: P2299
tag: ['图论', '贪心', '最短路']
---
# Mzc和体委的争夺战
## 题目背景

mzc 与 djn 第四弹。

## 题目描述

mzc 家很有钱（开玩笑），他家有 $n$ 个男家丁（做过前三弹的都知道）。但如此之多的男家丁吸引来了我们的体委（矮胖小伙），他要来与 mzc 争夺男家丁。

mzc 很生气，决定与其决斗，但 cat 的体力确实有些不稳定，所以他需要你来帮他计算一下最短需要的时间。

## 输入格式

第一行有两个数 $n,m.n$ 表示有 $n$ 个停留站，m表示共有m条路。

之后 $m$ 行，每行三个数 $a_i,b_i,c_i$，表示第 $a_i$ 个停留站到第 $b_i$ 个停留站需要 $c_i$ 的时间。注意，这是双向的。也就是说，从 $b_i$ 个停留站到第 $a_i$ 个停留站也需要 $c_i$ 的时间。

## 输出格式

一行，输出 $1$ 到 $n$ 最短时间。

## 样例

### 样例输入 #1
```
5 8
1 2 3
2 3 4
3 4 5
4 5 6
1 3 4
2 4 7
2 5 8
1 5 100

```
### 样例输出 #1
```
11
```
## 提示

$1\le n \leq 2500$，$1\le m \leq 2\times10^5$，$1\le c_i\le 10^6$。

由于 mzc 大大十分着急，所以他只能等待 1s。



---

---
title: "[SCOI2005] 繁忙的都市"
layout: "post"
diff: 普及/提高-
pid: P2330
tag: ['图论', '2005', '四川', '并查集', '各省省选', '生成树']
---
# [SCOI2005] 繁忙的都市
## 题目描述

城市 C 是一个非常繁忙的大都市，城市中的道路十分的拥挤，于是市长决定对其中的道路进行改造。城市 C 的道路是这样分布的：城市中有 $n$ 个交叉路口，有些交叉路口之间有道路相连，两个交叉路口之间最多有一条道路相连接。这些道路是双向的，且把所有的交叉路口直接或间接的连接起来了。每条道路都有一个分值，分值越小表示这个道路越繁忙，越需要进行改造。但是市政府的资金有限，市长希望进行改造的道路越少越好，于是他提出下面的要求：

1. 改造的那些道路能够把所有的交叉路口直接或间接的连通起来。
1. 在满足要求 1 的情况下，改造的道路尽量少。
1. 在满足要求 1、2 的情况下，改造的那些道路中分值最大的道路分值尽量小。

任务：作为市规划局的你，应当作出最佳的决策，选择哪些道路应当被修建。
## 输入格式

第一行有两个整数 $n,m$ 表示城市有 $n$ 个交叉路口，$m$ 条道路。

接下来 $m$ 行是对每条道路的描述，$u, v, c$ 表示交叉路口 $u$ 和 $v$ 之间有道路相连，分值为 $c$。
## 输出格式

两个整数 $s, \mathit{max}$，表示你选出了几条道路，分值最大的那条道路的分值是多少。
## 样例

### 样例输入 #1
```
4 5
1 2 3
1 4 5
2 4 7
2 3 6
3 4 8

```
### 样例输出 #1
```
3 6
```
## 提示

### 数据范围及约定

对于全部数据，满足 $1\le n\le 300$，$1\le c\le 10^4$，$1 \le m \le 8000$。


---

---
title: "[HAOI2006] 聪明的猴子"
layout: "post"
diff: 普及/提高-
pid: P2504
tag: ['图论', '2006', '河南', '各省省选', '生成树']
---
# [HAOI2006] 聪明的猴子
## 题目描述

在一个热带雨林中生存着一群猴子，它们以树上的果子为生。昨天下了一场大雨，现在雨过天晴，但整个雨林的地表还是被大水淹没着，部分植物的树冠露在水面上。猴子不会游泳，但跳跃能力比较强，它们仍然可以在露出水面的不同树冠上来回穿梭，以找到喜欢吃的果实。

现在，在这个地区露出水面的有 $N$ 棵树，假设每棵树本身的直径都很小，可以忽略不计。我们在这块区域上建立直角坐标系，则每一棵树的位置由其所对应的坐标表示(任意两棵树的坐标都不相同)。

在这个地区住着的猴子有 $M$ 个，下雨时，它们都躲到了茂密高大的树冠中，没有被大水冲走。由于各个猴子的年龄不同、身体素质不同，它们跳跃的能力不同。有的猴子跳跃的距离比较远(当然也可以跳到较近的树上)，而有些猴子跳跃的距离就比较近。这些猴子非常聪明，它们通过目测就可以准确地判断出自己能否跳到对面的树上。

现已知猴子的数量及每一个猴子的最大跳跃距离，还知道露出水面的每一棵树的坐标，你的任务是统计有多少个猴子可以在这个地区露出水面的所有树冠上觅食。

## 输入格式

输入包括：

第 $1$ 行为一个整数，表示猴子的个数 $M$ $(2 \le M \le 500)$；

第 $2$ 行为 $M$ 个整数，依次表示猴子的最大跳跃距离（每个整数值在 $1 \sim 1000$ 之间）；

第 $3$ 行为一个整数表示树的总棵数 $N$ $(2 \le N \le 1000)$ ；

第 $4$ 行至第 $N+3$ 行为 $N$ 棵树的坐标（横纵坐标均为整数，范围为：$-1000 \sim 1000$）。

（同一行的整数间用空格分开）

## 输出格式

输出包括一个整数，表示可以在这个地区的所有树冠上觅食的猴子数。
## 样例

### 样例输入 #1
```
4
 1 2 3 4
6
0 0
1 0
1 2
-1 -1
-2 0
2 2
```
### 样例输出 #1
```
3
```
## 提示

对于 $40\%$ 的数据，保证有 $2 \le N \le 100$，$1 \le M \le 100$

对于全部的数据，保证有 $2 \le N \le 1000$，$1 \le M \le500$

感谢 @charlie003 修正数据


---

---
title: "[NOIP 2015 提高组] 信息传递"
layout: "post"
diff: 普及/提高-
pid: P2661
tag: ['图论', '2015', '并查集', 'NOIP 提高组']
---
# [NOIP 2015 提高组] 信息传递
## 题目背景

NOIP2015 Day1T2
## 题目描述

有 $n$ 个同学（编号为 $1$ 到 $n$）正在玩一个信息传递的游戏。在游戏里每人都有一个固定的信息传递对象，其中，编号为 $i$ 的同学的信息传递对象是编号为 $T_i$ 的同学。

游戏开始时，每人都只知道自己的生日。之后每一轮中，所有人会同时将自己当前所知的生日信息告诉各自的信息传递对象（注意：可能有人可以从若干人那里获取信息，但是每人只会把信息告诉一个人，即自己的信息传递对象）。当有人从别人口中得知自己的生日时，游戏结束。请问该游戏一共可以进行几轮？
## 输入格式

输入共 $2$ 行。

第一行包含 $1$ 个正整数 $n$，表示 $n$ 个人。

第二行包含 $n$ 个用空格隔开的正整数 $T_1,T_2,\cdots,T_n$，其中第 $i$ 个整数 $T_i$ 表示编号为 $i$ 的同学的信息传递对象是编号为 $T_i$ 的同学，$T_i\leq n$ 且 $T_i\neq i$。
## 输出格式

共一行一个整数，表示游戏一共可以进行多少轮。
## 样例

### 样例输入 #1
```
5
2 4 2 3 1
```
### 样例输出 #1
```
3
```
## 提示

**样例 1 解释：**

![](https://cdn.luogu.com.cn/upload/image_hosting/3ca5zl3c.png)

游戏的流程如图所示。当进行完第 $3$ 轮游戏后，$4$ 号玩家会听到 $2$ 号玩家告诉他自己的生日，所以答案为 $3$。当然，第 $3$ 轮游戏后，$2$ 号玩家、 $3$ 号玩家都能从自己的消息来源得知自己的生日，同样符合游戏结束的条件。

- 对于 $30\%$ 的数据，$n\le 200$；
- 对于 $60\%$ 的数据，$n\le 2500$；
- 对于 $100\%$ 的数据，$n\le 2\times 10^5$。



---

---
title: "小岛"
layout: "post"
diff: 普及/提高-
pid: P2683
tag: ['图论', '2015', '安徽']
---
# 小岛
## 题目背景

西伯利亚北部的寒地，坐落着由 $N$ 个小岛组成的岛屿群，我们把这些小岛依次编号为 $1$ 到 $N$。

## 题目描述

起初，岛屿之间没有任何的航线。后来随着交通的发展，逐渐出现了一些连通两座小岛的航线。例如增加一条在 $u$ 号小岛与 $v$ 号小岛之间的航线，这条航线的用时为 $e$。那么沿着这条航线，$u$ 号小岛上的人可以前往 $v$ 号小岛，同样的 $v$ 号小岛上的人也可以前往 $u$ 号小岛，其中沿着这一条航线花费的时间为 $e$。

同时，随着旅游业的发展，越来越多的人前来游玩。那么两个小岛之间的最短路径是多少便成为了饱受关注的话题。

## 输入格式

输入共 $M+1$ 行。

第一行有两个整数 $N$ 和 $M$，分别表示小岛的数与总操作数。

接下来的 $M$ 行，每行表示一个操作，格式如下：

`0 s t`：表示询问从 $s$ 号小岛到 $t$ 号小岛的最短用时（$1\le s\le n,~ 1\le t\le n,~ s\neq t$）。

`1 u v e`：表示新增了一条从 $u$ 号小岛到 $v$ 号小岛，用时为 $e$ 的双向航线（$1\le u\le n, ~1\le v\le n,~ u ≠ v,~ 1\le e\le 10^6$）。

## 输出格式

输出针对每一次询问，单独输出一行。

对于每一组询问来说，如果不存在可行的道路，则输出 `-1`，否则输出最短用时。

## 样例

### 样例输入 #1
```
3 8 
1 3 1 10 
0 2 3 
1 2 3 20 
1 1 2 5 
0 3 2 
1 1 3 7 
1 2 1 9 
0 2 3
```
### 样例输出 #1
```
-1
15
12
```
### 样例输入 #2
```
5 16
1 1 2 343750
1 1 3 3343
1 1 4 347392
1 1 5 5497
1 2 3 123394
1 2 4 545492
1 2 5 458
1 3 4 343983
1 3 5 843468
1 4 5 15934
0 2 1
0 4 1
0 3 2
0 4 2
0 4 3
0 5 3
```
### 样例输出 #2
```
5955
21431
9298
16392
24774
8840
```
## 提示

对于 $20\%$ 的数据，$N\le 5$ 且 $M\le 30$。

对于 $40\%$ 的数据，$N\le 20$ 且 $M\le 200$。

对于 $60\%$ 的数据，$N\le 80$ 且 $M\le 500$。

对于 $80\%$ 的数据，$N\le 100$ 且 $M\le 2500$。

对于 $100\%$ 的数据，$N\le 100$ 且 $M\le 5000$。



---

---
title: "[USACO3.2] 纺车的轮子 Spinning Wheels"
layout: "post"
diff: 普及/提高-
pid: P2728
tag: ['模拟', '图论', 'USACO']
---
# [USACO3.2] 纺车的轮子 Spinning Wheels
## 题目背景

一架纺车有五个纺轮（也就是五个同心圆），这五个不透明的轮子边缘上都有一些缺口。这些缺口必须被迅速而准确地排列好。每个轮子都有一个起始标记（在0度），这样所有的轮子都可以在统一的已知位置开始转动。轮子按照角度变大的方向旋转（即0经过旋转到达1的位置），所以从起始位置开始，在一定的时间内，它们依次转过1度，2度等等（虽然这些轮子很可能不会同时转过这些角度）。

## 题目描述

这是一个整数问题。轮子不会转过1.5度或23.51234123度这样的角度。例如，轮子可能在一秒钟内转过20到25度甚至30到40度（如果转得快的话）。

这个问题中的所有角度都限制在 0 <= 角度 <= 359 这个范围内。轮子转过 359 度后接下来就是 0 度。每个轮子都有一个确定的旋转速度，以秒作为单位。1 <= 速度 <= 180。

轮子上的缺口的起始角度和缺口大小（或宽度）各由一个整数表示，都以度为单位。在一个轮子上，两个缺口之间至少有一度的间隔。宽度也包含缺口起始的角度，**即0 179包括0..179共计180个角度**

在起始位置，设时间为 0，所有的轮子的起始标记排列成一条直线。你的程序必须计算，最早出现每个的轮子上的缺口同其他轮子上的缺口对准（也就是一束光可以通过五个轮子上的五个缺口）情况的时间。这些缺口在任意一个角度对准。

## 输入格式

输入中的五行对应五个轮子。

第一个数字表示轮子的转动速度。下一个数字是缺口的数目 W。1 <= W <= 5。接下来的 W 对数字表示每个缺口的起始角度和宽度。

## 输出格式

只有一行，包括一个整数，表示光能够通过这五个轮子的最早时间。如果无解，输出'none'（小写，不含引号）。

## 样例

### 样例输入 #1
```
30 1 0 120
50 1 150 90
60 1 60 90
70 1 180 180
90 1 180 60
```
### 样例输出 #1
```
9
```
## 提示

题目翻译来自NOCOW。

USACO Training Section 3.2



---

---
title: "化学1（chem1）- 化学合成"
layout: "post"
diff: 普及/提高-
pid: P2784
tag: ['图论', '洛谷原创', '队列']
---
# 化学1（chem1）- 化学合成
## 题目背景

蒟蒻 HansBug 在化学考场上，挠了无数次的头，可脑子里还是一片空白。
## 题目描述

眼下出现在蒟蒻 HansBug 面前的是一个化学合成题，据他所知，一般答案如下面这样的格式：

![](https://cdn.luogu.com.cn/upload/pic/2223.png) （接下一行）

![](https://cdn.luogu.com.cn/upload/pic/2221.png) 

简单解释下：每种化合物可以通过一步反应生成另一个化合物（将这称作一步反应，设为 $A\rightarrow B$），现在假设每个 $A\rightarrow B$ 中，理论上 $1$ 个单位的 $A$ 都仅可以生成 $1$ 个单位的 $B$。然而实际实验表明，并不存在绝对完全的化学转化，设转化率为 $C$（即 $1$ 个单位 $A$ 实际可以生成 $C$ 个单位的 $B$，$0<C<1$）。

现在蒟蒻 HansBug 的知识体系中有 $N$ 个这样 $A\rightarrow B$ 的转化。然而题目中蒟蒻 HansBug 要由 $1$ 个单位的化合物 $S$ 生成化合物 $T$，可是他脑细胞和 RP 已经消耗殆尽，所以找到最终产量最高的合成路线的艰巨任务就交给你啦！
## 输入格式

第一行为四个整数：$N,M,S,T$，分别表示总共出现的化合物个数、HansBug 所知道的反应个数、起始的化合物序号、终末的化合物序号（$1\le S,T\le N$）。

第 $2 \sim M+1$ 行每行为两个整数和一个实数：$A_i,B_i,C_i$，分别表示第 $i$ 个反应为由 $1$ 个单位的 $A_i$ 化合物生成 $C_i$ 单位的 $B_i$ 化合物。
## 输出格式

一行，包含一个实数，为最佳路线下最终的产量（四舍五入保留 $4$ 位小数），如果没有可行路线的话，输出 `orz`。
## 样例

### 样例输入 #1
```
3 3 1 3
1 3 0.8
1 2 0.9
2 3 0.9

```
### 样例输出 #1
```
0.8100
```
### 样例输入 #2
```
3 3 2 1
1 3 0.8
1 2 0.9
2 3 0.9

```
### 样例输出 #2
```
orz
```
## 提示

样例 1 和样例 2 中，两条合成路线分别为 $1\rightarrow3$、$1\rightarrow2$、$2\rightarrow3$，产率分别为 $0.8$、$0.9$、$0.9$。

在样例 1 中，有两种可行的路线 $1\rightarrow3$ 和 $1\rightarrow2\rightarrow3$ ，最终产量分别为 $0.8$、$0.9\times0.9=0.81$，故第二条路线更优，产量为 $0.8100$。

样例 2 中，$2$ 只能生成 $3$，$3$ 无法生成别的化合物，故无法生成，蒟蒻 HansBug 只好选择 `orz`。

**【数据范围】**

![](https://cdn.luogu.com.cn/upload/pic/2220.png)



---

---
title: "家谱"
layout: "post"
diff: 普及/提高-
pid: P2814
tag: ['字符串', '搜索', '图论', '线性数据结构', '并查集']
---
# 家谱
## 题目背景

现代的人对于本家族血统越来越感兴趣。

## 题目描述

给出充足的父子关系，请你编写程序找到某个人的最早的祖先。

## 输入格式

输入由多行组成，首先是一系列有关父子关系的描述，其中每一组父子关系中父亲只有一行，儿子可能有若干行，用 `#name` 的形式描写一组父子关系中的父亲的名字，用 `+name` 的形式描写一组父子关系中的儿子的名字；接下来用 `?name` 的形式表示要求该人的最早的祖先；最后用单独的一个 `$` 表示文件结束。
## 输出格式

按照输入文件的要求顺序，求出每一个要找祖先的人的祖先，格式为：本人的名字 $+$ 一个空格 $+$ 祖先的名字 $+$ 回车。
## 样例

### 样例输入 #1
```
#George
+Rodney
#Arthur
+Gareth
+Walter
#Gareth
+Edward
?Edward
?Walter
?Rodney
?Arthur
$
```
### 样例输出 #1
```
Edward Arthur
Walter Arthur
Rodney George
Arthur Arthur
```
## 提示

规定每个人的名字都有且只有 $6$ 个字符，而且首字母大写，且没有任意两个人的名字相同。最多可能有 $10^3$ 组父子关系，总人数最多可能达到 $5 \times 10^4$ 人，家谱中的记载不超过 $30$ 代。


---

---
title: "局域网"
layout: "post"
diff: 普及/提高-
pid: P2820
tag: ['图论', '并查集', '生成树']
---
# 局域网
## 题目背景

某个局域网内有 $n$ 台计算机，由于搭建局域网时工作人员的疏忽，现在局域网内的连接形成了回路，我们知道如果局域网形成回路那么数据将不停的在回路内传输，造成网络卡的现象。因为连接计算机的网线本身不同，所以有一些连线不是很畅通，我们用 $f(i,j)$ 表示 $i,j$ 之间连接的畅通程度，$f(i,j)$ 值越小表示 $i,j$ 之间连接越通畅，$f(i,j)$ 为 $0$ 表示 $i,j$ 之间无网线连接。
## 题目描述

现在需要解决回路问题，我们将除去一些连线，使得网络中没有回路，**不改变原图节点的连通性**，并且被除去网线的 $\sum f(i,j)$ 最大，请求出这个最大值。
## 输入格式

第一行两个正整数 $n,k$。

接下来的 $k$ 行每行三个正整数 $i,j,m$ 表示 $i,j$ 两台计算机之间有网线联通，通畅程度为 $m$。
## 输出格式

一个正整数， $\sum f(i,j)$ 的最大值。
## 样例

### 样例输入 #1
```
5 5
1 2 8
1 3 1
1 5 3
2 4 5
3 4 2

```
### 样例输出 #1
```
8
```
## 提示

对于全部数据，保证 $1\le n \le 100$，$1\le f(i,j)\le 1000$。



---

---
title: "[USACO07DEC] Building Roads S"
layout: "post"
diff: 普及/提高-
pid: P2872
tag: ['图论', '2007', 'USACO', '生成树']
---
# [USACO07DEC] Building Roads S
## 题目描述

Farmer John had just acquired several new farms! He wants to connect the farms with roads so that he can travel from any farm to any other farm via a sequence of roads; roads already connect some of the farms.

Each of the N (1 ≤ N ≤ 1,000) farms (conveniently numbered 1..N) is represented by a position (Xi, Yi) on the plane (0 ≤ Xi ≤ 1,000,000; 0 ≤ Yi ≤ 1,000,000). Given the preexisting M roads (1 ≤ M ≤ 1,000) as pairs of connected farms, help Farmer John determine the smallest length of additional roads he must build to connect all his farms.

给定 $n$ 个点的坐标，第 $i$ 个点的坐标为 $(x_i,y_i)$，这 $n$ 个点编号为 $1$ 到 $n$。给定 $m$ 条边，第 $i$ 条边连接第 $u_i$ 个点和第 $v_i$ 个点。现在要求你添加一些边，并且能使得任意一点都可以连通其他所有点。求添加的边的总长度的最小值。

## 输入格式

\* Line 1: Two space-separated integers: N and M

\* Lines 2..N+1: Two space-separated integers: Xi and Yi

\* Lines N+2..N+M+2: Two space-separated integers: i and j, indicating that there is already a road connecting the farm i and farm j.

第一行两个整数 $n,m$ 代表点数与边数。   
接下来 $n$ 行每行两个整数 $x_i,y_i$ 代表第 $i$ 个点的坐标。   
接下来 $m$ 行每行两个整数 $u_i,v_i$ 代表第 $i$ 条边连接第 $u_i$ 个点和第 $v_i$ 个点。

## 输出格式

\* Line 1: Smallest length of additional roads required to connect all farms, printed without rounding to two decimal places. Be sure to calculate distances as 64-bit floating point numbers.

一行一个实数代表添加的边的最小长度，要求保留两位小数，为了避免误差， 请用 $64$ 位实型变量进行计算。

## 样例

### 样例输入 #1
```
4 1
1 1
3 1
2 3
4 3
1 4
```
### 样例输出 #1
```
4.00
```
## 提示

### 数据规模与约定

对于 $100\%$ 的整数，$1 \le n,m \le 1000$，$1 \le x_i,y_i \le 10^6$，$1 \le u_i,v_i \le n$。

### 说明

Translated by 一只书虫仔。


---

---
title: "【模板】单源最短路径（弱化版）"
layout: "post"
diff: 普及/提高-
pid: P3371
tag: ['图论', 'O2优化', '最短路']
---
# 【模板】单源最短路径（弱化版）
## 题目背景

本题测试数据为随机数据，在考试中可能会出现构造数据让SPFA不通过，如有需要请移步 [P4779](https://www.luogu.org/problemnew/show/P4779)。
## 题目描述

如题，给出一个有向图，请输出从某一点出发到所有点的最短路径长度。

## 输入格式

第一行包含三个整数 $n,m,s$，分别表示点的个数、有向边的个数、出发点的编号。

接下来 $m$ 行每行包含三个整数 $u,v,w$，表示一条 $u \to v$ 的，长度为 $w$ 的边。
## 输出格式

输出一行 $n$ 个整数，第 $i$ 个表示 $s$ 到第 $i$ 个点的最短路径，若不能到达则输出 $2^{31}-1$。
## 样例

### 样例输入 #1
```
4 6 1
1 2 2
2 3 2
2 4 1
1 3 5
3 4 3
1 4 4
```
### 样例输出 #1
```
0 2 4 3
```
## 提示

【数据范围】    
对于 $20\%$ 的数据：$1\le n \le 5$，$1\le m \le 15$；  
对于 $40\%$ 的数据：$1\le n \le 100$，$1\le m \le 10^4$；   
对于 $70\%$ 的数据：$1\le n \le 1000$，$1\le m \le 10^5$；   
对于 $100\%$ 的数据：$1 \le n \le 10^4$，$1\le m \le 5\times 10^5$，$1\le u,v\le n$，$w\ge 0$，$\sum w< 2^{31}$，保证数据随机。

**Update 2022/07/29：两个点之间可能有多条边，敬请注意。**

对于真正 $100\%$ 的数据，请移步 [P4779](https://www.luogu.org/problemnew/show/P4779)。请注意，该题与本题数据范围略有不同。


样例说明：

![](https://cdn.luogu.com.cn/upload/pic/7641.png)

图片1到3和1到4的文字位置调换



---

---
title: "【模板】负环"
layout: "post"
diff: 普及/提高-
pid: P3385
tag: ['图论', 'O2优化', '负权环']
---
# 【模板】负环
## 题目描述

给定一个 $n$ 个点的有向图，请求出图中是否存在**从顶点 $1$ 出发能到达**的负环。

负环的定义是：一条边权之和为负数的回路。
## 输入格式

**本题单测试点有多组测试数据**。

输入的第一行是一个整数 $T$，表示测试数据的组数。对于每组数据的格式如下：

第一行有两个整数，分别表示图的点数 $n$ 和接下来给出边信息的条数 $m$。

接下来 $m$ 行，每行三个整数 $u, v, w$。

- 若 $w \geq 0$，则表示存在一条从 $u$ 至 $v$ 边权为 $w$ 的边，还存在一条从 $v$ 至 $u$ 边权为 $w$ 的边。
- 若 $w < 0$，则只表示存在一条从 $u$ 至 $v$ 边权为 $w$ 的边。
## 输出格式

对于每组数据，输出一行一个字符串，若所求负环存在，则输出 `YES`，否则输出 `NO`。
## 样例

### 样例输入 #1
```
2
3 4
1 2 2
1 3 4
2 3 1
3 1 -3
3 3
1 2 3
2 3 4
3 1 -8

```
### 样例输出 #1
```
NO
YES

```
## 提示

#### 数据规模与约定

对于全部的测试点，保证：

- $1 \leq n \leq 2 \times 10^3$，$1 \leq m \leq 3 \times 10^3$。
- $1 \leq u, v \leq n$，$-10^4 \leq w \leq 10^4$。
- $1 \leq T \leq 10$。

#### 提示

请注意，$m$ **不是**图的边数。


---

---
title: "道路重建"
layout: "post"
diff: 普及/提高-
pid: P3905
tag: ['图论', '最短路', '队列']
---
# 道路重建
## 题目描述

从前，在一个王国中，在 $n$ 个城市间有 $m$ 条道路连接，而且任意两个城市之间至多有一条道路直接相连。在经过一次严重的战争之后，有 $d$ 条道路被破坏了。国王想要修复国家的道路系统，现在有两个重要城市 $A$ 和 $B$ 之间的交通中断，国王希望尽快的恢复两个城市之间的连接。你的任务就是修复一些道路使 $A$ 与 $B$ 之间的连接恢复，并要求修复的道路长度最小。
## 输入格式

输入文件第一行为一个整数 $n\ (2<n\le 100)$，表示城市的个数。这些城市编号从 $1$ 到 $n$。

第二行为一个整数 $m\ (n-1\le m\le \dfrac{1}{2}n(n-1))$，表示道路的数目。

接下来的 $m$ 行，每行 $3$ 个整数 $i,j,k\ (1 \le i,j \le n,i\neq j,0<k \le 100)$，表示城市 $i$ 与 $j$ 之间有一条长为 $k$ 的道路相连。

接下来一行为一个整数 $d\ (1\le d\le m)$，表示战后被破坏的道路的数目。在接下来的 $d$ 行中，每行两个整数 $i$ 和 $j$，表示城市 $i$ 与 $j$ 之间直接相连的道路被破坏。

最后一行为两个整数 $A$ 和 $B$，代表需要恢复交通的两个重要城市。
## 输出格式

输出文件仅一个整数，表示恢复 $A$ 与 $B$ 间的交通需要修复的道路总长度的最小值。

## 样例

### 样例输入 #1
```
3
2
1 2 1
2 3 2
1
1 2
1 3
```
### 样例输出 #1
```
1
```


---

---
title: "Geodetic集合"
layout: "post"
diff: 普及/提高-
pid: P3906
tag: ['图论', '枚举', '排序', '最短路']
---
# Geodetic集合
## 题目描述

图 $\text G$ 是一个无向连通图，没有自环，并且两点之间至多只有一条边。我们定义顶点 $v,u$ 的最短路径就是从 $v$ 到 $u$ 经过边最少的路径。所有包含在 $v-u$ 的最短路径上的顶点被称为 $v-u$ 的 Geodetic 顶点，这些顶点的集合记作 $I(v,u)$。

我们称集合 $I(v,u)$ 为一个 Geodetic 集合。

例如下图中，$I(2,5)=\{2,3,4,5\}$，$I(1,5)=\{1,3,5\}$，$I(2,4)=\{2,4\}$。

![](https://cdn.luogu.com.cn/upload/image_hosting/26c7a19d.png)

给定一个图 $\text G$ 和若干点对 $v,u$，请你分别求出 $I(v,u)$。
## 输入格式

第一行为两个整数 $n,m$，分别表示图 $\text G$ 的顶点数和边数（顶点编号为 $1\sim n$）。  
接下来 $m$ 行，每行两个整数 $a,b$，表示 顶点 $a$ 和 $b$ 之间有一条无向边。  
第 $m+2$ 行有一个整数 $k$，表示给定的点对数。  
接下来 $k$ 行，每行两个整数 $v,u$，表示每个点对的起点和终点。 
## 输出格式

共 $k$ 行，对于输入文件中每一个点对 $v,u$，按顶点顺序一行输出 $I(v,u)$ 里面的所有点的编号。
## 样例

### 样例输入 #1
```
5 6
1 2
1 3
2 3
2 4
3 5
4 5
3
2 5
5 1
2 4
```
### 样例输出 #1
```
2 3 4 5
1 3 5
2 4
```
## 提示

对于所有数据，满足 $1\leqslant n\leqslant 40$，$1\leqslant m\leqslant \frac{n(n-1)}2$。


---

---
title: "图的遍历"
layout: "post"
diff: 普及/提高-
pid: P3916
tag: ['搜索', '图论', '图论建模', '强连通分量']
---
# 图的遍历
## 题目描述

给出 $N$ 个点，$M$ 条边的有向图，对于每个点 $v$，求 $A(v)$ 表示从点 $v$ 出发，能到达的编号最大的点。
## 输入格式

第 $1$ 行 $2$ 个整数 $N,M$，表示点数和边数。

接下来 $M$ 行，每行 $2$ 个整数 $U_i,V_i$，表示边 $(U_i,V_i)$。点用 $1,2,\dots,N$ 编号。
## 输出格式

一行 $N$ 个整数 $A(1),A(2),\dots,A(N)$。
## 样例

### 样例输入 #1
```
4 3
1 2
2 4
4 3
```
### 样例输出 #1
```
4 4 3 4
```
## 提示

- 对于 $60\%$ 的数据，$1 \leq N,M \leq 10^3$。
- 对于 $100\%$ 的数据，$1 \leq N,M \leq 10^5$。


---

---
title: "最大食物链计数"
layout: "post"
diff: 普及/提高-
pid: P4017
tag: ['动态规划 DP', '搜索', '图论', '排序', '深度优先搜索 DFS', '拓扑排序']
---
# 最大食物链计数
## 题目背景

你知道食物链吗？Delia 生物考试的时候，数食物链条数的题目全都错了，因为她总是重复数了几条或漏掉了几条。于是她来就来求助你，然而你也不会啊！写一个程序来帮帮她吧。

## 题目描述

给你一个食物网，你要求出这个食物网中最大食物链的数量。

（这里的“最大食物链”，指的是**生物学意义上的食物链**，即**最左端是不会捕食其他生物的生产者，最右端是不会被其他生物捕食的消费者**。）

Delia 非常急，所以你只有 $1$ 秒的时间。

由于这个结果可能过大，你只需要输出总数模上 $80112002$ 的结果。

## 输入格式

第一行，两个正整数 $n、m$，表示生物种类 $n$ 和吃与被吃的关系数 $m$。

接下来 $m$ 行，每行两个正整数，表示被吃的生物A和吃A的生物B。

## 输出格式

一行一个整数，为最大食物链数量模上 $80112002$ 的结果。

## 样例

### 样例输入 #1
```
5 7
1 2
1 3
2 3
3 5
2 5
4 5
3 4
```
### 样例输出 #1
```
5
```
## 提示

各测试点满足以下约定：

 ![](https://cdn.luogu.com.cn/upload/pic/12011.png) 

【补充说明】

数据中不会出现环，满足生物学的要求。（感谢 @AKEE ）



---

---
title: "【模板】单源最短路径（标准版）"
layout: "post"
diff: 普及/提高-
pid: P4779
tag: ['图论', '优先队列', '最短路']
---
# 【模板】单源最短路径（标准版）
## 题目背景

2018 年 7 月 19 日，某位同学在 [NOI Day 1 T1 归程](https://www.luogu.org/problemnew/show/P4768) 一题里非常熟练地使用了一个广为人知的算法求最短路。

然后呢？

$100 \rightarrow 60$；

$\text{Ag} \rightarrow \text{Cu}$；

最终，他因此没能与理想的大学达成契约。

小 F 衷心祝愿大家不再重蹈覆辙。
## 题目描述

给定一个 $n$ 个点，$m$ 条有向边的带非负权图，请你计算从 $s$ 出发，到每个点的距离。

数据保证你能从 $s$ 出发到任意点。
## 输入格式

第一行为三个正整数 $n, m, s$。
第二行起 $m$ 行，每行三个非负整数 $u_i, v_i, w_i$，表示从 $u_i$ 到 $v_i$ 有一条权值为 $w_i$ 的有向边。
## 输出格式

输出一行 $n$ 个空格分隔的非负整数，表示 $s$ 到每个点的距离。
## 样例

### 样例输入 #1
```
4 6 1
1 2 2
2 3 2
2 4 1
1 3 5
3 4 3
1 4 4
```
### 样例输出 #1
```
0 2 4 3
```
## 提示

样例解释请参考 [数据随机的模板题](https://www.luogu.org/problemnew/show/P3371)。

$1 \leq n \leq 10^5$；

$1 \leq m \leq 2\times 10^5$；

$s = 1$；

$1 \leq u_i, v_i\leq n$；

$0 \leq w_i \leq 10 ^ 9$,

$0 \leq \sum w_i \leq 10 ^ 9$。

本题数据可能会持续更新，但不会重测，望周知。

2018.09.04 数据更新 from @zzq


---

---
title: "[USACO15FEB] Superbull S"
layout: "post"
diff: 普及/提高-
pid: P4826
tag: ['2015', 'USACO', '图论建模', '生成树']
---
# [USACO15FEB] Superbull S
## 题目描述

Bessie and her friends are playing hoofball in the annual Superbull championship, and Farmer John is in charge of making the tournament as exciting as possible. A total of $N$ $(1 <= N <= 2000)$ teams are playing in the Superbull. Each team is assigned a distinct integer team ID in the range 1...2^30-1 to distinguish it from the other teams. The Superbull is an elimination tournament -- after every game, Farmer John chooses which team to eliminate from the Superbull, and the eliminated team can no longer play in any more games. The Superbull ends when only one team remains.

Farmer John notices a very unusual property about the scores in matches! In any game, the combined score of the two teams always ends up being the bitwise exclusive OR (XOR) of the two team IDs. For example, if teams 12 and 20 were to play, then 24 points would be scored in that game, since 01100 XOR 10100 = 11000.

Farmer John believes that the more points are scored in a game, the more exciting the game is. Because of this, he wants to choose a series of games to be played such that the total number of points scored in the Superbull is maximized. Please help Farmer John organize the matches.
## 输入格式

The first line contains the single integer $N$. The following $N$ lines contain the N team IDs.
## 输出格式

Output the maximum possible number of points that can be scored in the Superbull.
## 样例

### 样例输入 #1
```
4
3
6
9
10
```
### 样例输出 #1
```
37
```
## 提示

OUTPUT DETAILS: One way to achieve 37 is as follows: FJ matches teams 3 and 9, and decides that 9 wins, so teams 6, 9, and 10 are left in the tournament. He then matches teams 6 and 9, and lets team 6 win. Teams 6 and 10 are then left in the tournament. Finally, teams 6 and 10 face off, and team 10 wins. The total number of points scored is (3 XOR 9) + (6 XOR 9) + (6 XOR 10) = 10 + 15 + 12 = 37.

NOTE: The bitwise exclusive OR operation, commonly denoted by the ^ symbol, is a bitwise operation that performs the logical exclusive OR operation on each position in two binary integers. The result in each position is 1 if only the first bit is 1 or only the second bit is 1, but is 0 if both bits are 0 or both are 1. For example: 10100 (decimal 20) XOR 01100 (decimal 12) = 11000 (decimal 24)

[Problem credits: Alex Yang, 2015] 
## 题目翻译

### 题目描述

Bessie 和她的朋友们正在一年一度的 Superbull 锦标赛中比赛，Farmer John 负责让比赛尽可能精彩。总共有 $N$ $(1 \leq N \leq 2000)$ 支队伍参加 Superbull。每支队伍都被分配了一个唯一的整数队伍 ID，范围在 $1 \ldots 2^{30}-1$ 之间，用于区分不同队伍。Superbull 是淘汰制比赛——每场比赛后，Farmer John 会选择淘汰其中一支队伍，被淘汰的队伍将不再参与后续比赛。当只剩一支队伍时，Superbull 结束。

Farmer John 发现比赛得分有一个特殊性质：任意一场比赛中，两支队伍的得分总和总是等于两队 ID 的按位异或（XOR）。例如，若队伍 12 和 20 比赛，则该场比赛总得分为 $24$，因为 $01100 \oplus 10100 = 11000$（即 $12 \oplus 20 = 24$）。

Farmer John 认为比赛总得分越高越精彩。因此，他希望安排一系列比赛，使得 Superbull 所有比赛的总得分最大化。请帮助他设计比赛方案。

### 输入格式

第一行包含整数 $N$。接下来的 $N$ 行每行包含一个队伍 ID。

### 输出格式

输出 Superbull 所有比赛可能获得的最大总得分。

### 说明/提示

**输出样例解释**：  
一种获得 37 分的方案如下：  
1. Farmer John 让队伍 3 和 9 比赛，选择淘汰 9，此时剩余队伍为 6、9、10  
2. 让队伍 6 和 9 比赛，选择淘汰 9，此时剩余队伍为 6 和 10  
3. 最后让队伍 6 和 10 比赛  
总得分为 $(3 \oplus 9) + (6 \oplus 9) + (6 \oplus 10) = 10 + 15 + 12 = 37$。

**关于按位异或**：  
按位异或运算（记作 $\oplus$）对两个二进制数的每一位进行逻辑异或操作。当且仅当某一位上两个数不同时，结果的该位为 1。例如：  
$10100$（十进制 20）$\oplus$ $01100$（十进制 12）$= 11000$（十进制 24）


---

---
title: "[USACO19JAN] Grass Planting S"
layout: "post"
diff: 普及/提高-
pid: P5197
tag: ['图论', '2019', 'USACO']
---
# [USACO19JAN] Grass Planting S
## 题目背景

USACO 一月月赛银组第一题
## 题目描述

到了一年中 Farmer John 在他的草地里种草的时间了。整个农场由 $N$ 块草地组成（$1 \leq N \leq 10^5$），方便起见编号为 $1 \ldots N$，由 $N-1$ 条双向的小路连接，每块草地都可以经过一些小路到达其他所有的草地。
Farmer John 当然可以在每块草地里种不同种类的草，但是他想要使得使用的草的种类数最小，因为他用的草的种类数越多，他就需要负担更高的花费。

不幸的是，他的奶牛们对选择农场上的草表现得十分苛刻。如果两块相邻（由一条小路直接相连）的草地种了同一种草，或者即使是两块接近相邻（均可由一条小路直接连向同一块草地）的草地，那么奶牛们就会抱怨她们进餐的选择不够多样。Farmer John 能做的只能是抱怨这些奶牛，因为他知道她们不能被满足的时候会制造多大的麻烦。

请帮助 Farmer John 求出他的整个农场所需要的最少的草的种类数。
## 输入格式

输入的第一行包含 $N$。以下 $N-1$ 行每行描述了一条小路连接的两块草地。
## 输出格式

输出 Farmer John 需要使用的最少的草的种类数。
## 样例

### 样例输入 #1
```
4
1 2
4 3
2 3
```
### 样例输出 #1
```
3
```
## 提示

在这个简单的例子中，4 块草地以一条直线的形式相连。最少需要三种草。例如，Farmer John 可以用草 $A,B,C$ 将草地按 $A - B - C - A$ 的方式播种。


---

---
title: "[USACO20FEB] Timeline G"
layout: "post"
diff: 普及/提高-
pid: P6145
tag: ['图论', '2020', 'USACO', '拓扑排序', '差分约束']
---
# [USACO20FEB] Timeline G
## 题目描述

Bessie 在过去的 $M$ 天内参加了 $N$ 次挤奶。但她已经忘了她每次挤奶是在哪个时候了。

对于第 $i$ 次挤奶，Bessie 记得它不早于第 $S_i$ 天进行。另外，她还有 $C$ 条记忆，每条记忆形如一个三元组 $(a,b,x)$，含义是第 $b$ 次挤奶在第 $a$ 次挤奶结束至少 $x$ 天后进行。

现在请你帮 Bessie 算出在满足所有条件的前提下，每次挤奶的最早日期。

保证 Bessie 的记忆没有错误，这意味着一定存在一种合法的方案，使得：

- 第 $i$ 次挤奶不早于第 $S_i$ 天进行，且不晚于第 $M$ 天进行；
- 所有的记忆都得到满足；
## 输入格式

第一行三个整数 $N,M,C$。保证 $1 \leq N,C \leq 10^5$，$2 \leq M \leq 10^9$。

接下来一行包含 $N$ 个整数 $S_1, S_2 , \ldots, S_n$，保证 $\forall 1 \leq i \leq n$，都满足 $1 \leq S_i \leq M$。

下面 $C$ 行每行三个整数 $a,b,x$，描述一条记忆。保证 $a \neq b$，且 $1 \leq x \leq M$。
## 输出格式

输出 $N$ 行，每行一个整数，第 $i$ 行的数表示第 $i$ 次挤奶的最早日期。
## 样例

### 样例输入 #1
```
4 10 3
1 2 3 4
1 2 5
2 4 2
3 4 4
```
### 样例输出 #1
```
1
6
3
8
```
## 提示

- 测试点 $2 \sim 4$ 满足 $N,C \leq 10^3$。
- 测试点 $5 \sim 10$ 没有特殊限制。


---

---
title: "[COCI 2014/2015 #3] DOM"
layout: "post"
diff: 普及/提高-
pid: P6264
tag: ['图论', '2014', 'O2优化', 'COCI（克罗地亚）']
---
# [COCI 2014/2015 #3] DOM
## 题目描述

在一个养老院里，$n$ 位老人正在看电视。这个电视节目由 $m$ 个频道组成，数字从 $1$ 到 $m$ 不等。每个老人都有自己喜欢和讨厌的电视频道。

如果电视正在播放某个老人讨厌的频道，他会站起来，慢慢走向电视机，把频道换成他最喜欢的，然后回到舒适的椅子上。如果有多个老人讨厌现在的频道，他们中最年轻的会站起来，把频道换成他最喜欢的，其余的人都会坐着。

当然，在一次更换频道后，另一位老人可能会觉得新频道无法忍受，所以他会更换该频道。鉴于老人们很顽固，这种情况可能会无限期地持续下去。

对于老人们最喜欢和讨厌的频道以及电视上的初始频道，确定老人们保持快乐所需的频道更改次数。
## 输入格式

输入的第一行包含三个整数 $n,m$ 和 $p$，分别表示养老院里老人的数量，  电视频道的数量和在电视上显示的初始频道。

以下 $n$ 行中的每一行都包含两个整数 $a_i$ 和 $b_i$，分别表示每个老人最喜欢和最讨厌的频道。

老人的输入顺序是按年龄从小到大排列的。
## 输出格式

仅一行，输出必须包含所需的频道更改数。如果更改无限期地继续，则输出 `-1`。
## 样例

### 样例输入 #1
```
3 4 2
1 2
2 3
3 2
```
### 样例输出 #1
```
1
```
### 样例输入 #2
```
3 3 1
1 2
2 3
3 1
```
### 样例输出 #2
```
-1
```
### 样例输入 #3
```
4 5 2
1 3
2 3
3 2
5 1
```
### 样例输出 #3
```
3
```
## 提示

#### 样例输入输出 1 解释
最初，电视上是 $2$ 频道。这个频道惹恼了最年轻和最年长的老人，所以最年轻的人站起来，把频道他最喜欢的改成 $1$ 频道，这样每个人都可以一起看 $1$ 频道。
#### 数据规模与约定

- 对于 $50\%$ 的数据，保证 $1\le n,m\le 10^3$。
- 对于 $100\%$ 的数据，保证 $1\le n,m\le 10^5$，$1\le p\le m$，$1\le a_i, b_i\le m$，$a_i \neq b_i$。


---

---
title: "[SHOI2002] 空中都市"
layout: "post"
diff: 普及/提高-
pid: P6269
tag: ['数学', '图论', '2002', '各省省选', '上海']
---
# [SHOI2002] 空中都市
## 题目描述

在未来的空中都市中，有很多个小岛（城区）。现在要求在这些小岛之间架一座桥梁，每座桥是指在两个岛之间的通道。

有个约定，如果 $A$ 与 $B$ 之间有桥，$B$ 与 $C$ 之间有桥，则 $A$ 与 $C$ 之间就不能再架桥了，即对于城市中的任意三个岛，不能在其中的两两之间都架上桥。在这样的约定下，要求架的桥的数量最多。当然不必考虑具体的空间结构问题。
## 输入格式

输入文件只包含一行，其中仅包含一个非负整数 $n (0 \leq n \leq 1000)$，表示小岛的数量。
## 输出格式

输出文件也只包含一行，即表示最多能架设的桥梁数量。
## 样例

### 样例输入 #1
```
6
```
### 样例输出 #1
```
9
```
### 样例输入 #2
```
11
```
### 样例输出 #2
```
30
```


---

---
title: "选择题"
layout: "post"
diff: 普及/提高-
pid: P6691
tag: ['图论', '2020', '并查集', 'O2优化', '广度优先搜索 BFS', '深度优先搜索 DFS']
---
# 选择题
## 题目背景

小 L 喜欢逻辑推理。

一天，他在一本由英国哲士沃·协德编写的《我也不知道为什么要叫这个名字的一本有关逻辑学的书》中翻到了一道奇特的问题，但他并不会做。他知道你善于用程序解决问题，于是决定让你来帮助他完成这些问题。
## 题目描述

这是一道有 $n$ 个选项的选择题，每个选项的内容都很独特。第 $i$ 个选项的内容的形式如下：

+ 第 $a_i$ 个选项是正确/错误的

小 L 认为这种题目的答案不一定是唯一的，所以他想问题这道题有多少种合法的答案（可以全部正确或全部错误）。他还想问你这么多答案中，正确选项最多和最少的答案分别有多少个正确选项。

当然，如果这道题不存在合法的答案，你可以直接回答小 L `No answer`。
## 输入格式

第一行有一个正整数 $n$，表示选项个数。

接下来 $n$ 行，每行有两个整数 $a_i,opt_i$，描述一个选项。其中当 $opt_i=1$ 时，表示这个选项的内容为 **第 $a_i$ 个选项是正确的**；当 $opt_i=0$ 时，表示这个选项的内容为 **第 $a_i$ 个选项是错误的**。
## 输出格式

如果没有答案满足这道选择题，输出`No answer`。

否则输出三行，每行一个正整数，分别为合法答案数及正确选项最多和最少的答案分别有多少个正确选项。其中合法答案数要对 $998244353$ 取模。
## 样例

### 样例输入 #1
```
4
2 1
4 0
1 1
2 0
```
### 样例输出 #1
```
2
3
1
```
### 样例输入 #2
```
10
4 1
7 0
2 0
3 1
7 1
5 0
9 1
10 1
8 0
1 1
```
### 样例输出 #2
```
No answer
```
## 提示

对于样例一，一共有下面 $2$ 种正确答案：

+ 第 $1,2,3$ 个选项是正确的。
+ 第 $4$ 个选项是正确的。

其中正确选项最多的答案有 $3$ 个选项正确，正确选项最少的答案有 $1$ 个选项正确。

### 数据范围
对于 $10\%$ 的数据，$n\leq 10$。  
对于 $30\%$ 的数据，$n\leq 100$。  
对于 $60\%$ 的数据，$n\leq 10^3$。  
对于 $100\%$ 的数据，$n\leq 10^6,1\leq a_i\leq n,i\neq a_i,opt_i\in\{0,1\}$。


---

---
title: "[Cnoi2020] 雷雨"
layout: "post"
diff: 普及/提高-
pid: P6833
tag: ['图论', '2020', 'O2优化', '最短路', '洛谷月赛']
---
# [Cnoi2020] 雷雨
## 题目背景

> 令人不安的云开始笼罩天空。  
巨大的建筑在强风中轧轧作响。  
幻想乡中响彻着不和协音。  
——「东方辉针城 ～ Double Dealing Character」

一个雷雨交加的夜晚，一束闪电击中了雾之湖畔的红魔馆和迷途竹林。

似乎有什么大事要发生，Cirno 在小屋静静地中思考着。
## 题目描述

幻想乡的纵切面可以抽象成一个 $n\times m$ 的矩形。

其中每一个 $1\times 1$ 的单元格 $(i,j)$ 都有一个**电阻计量值**(虚构的概念) $R_{i,j}$。

闪电从**雷雨云**上的 $\texttt{O}(n,a)$ 发出，击中了**地面**上的*红魔馆* $\texttt{A}(1,b)$ 与*迷途竹林* $\texttt{B}(1,c)$。

雷电是自然的造物，所以覆盖的位置电阻计量值总和最小，即从 $\texttt{O}$ 到 $\texttt{A}$ 与 $\texttt{B}$ 的**两条路径的并集**的电阻计量值的和最小。

所以在所有位置电阻计量已知的情况下，Cirno 想知道雷电的经过的路径的最小电阻计量值的和。
## 输入格式

第一行，五个整数 $n,m,a,b,c$。$(0<a,b,c\le m)$

以下 $n$ 行，每行 $m$ 个整数，表示电阻计量 $R_{i,j}$，其中第一行表示雷雨云，最后一行表示地面。
## 输出格式

一行，一个整数，表示答案。
## 样例

### 样例输入 #1
```
5 5 1 2 4
1 8 1 6 6
1 1 1 2 4
8 3 1 2 2
1 2 1 9 1
1 0 9 1 1
```
### 样例输出 #1
```
15
```
## 提示

## 样例解释

![](https://cdn.luogu.com.cn/upload/image_hosting/7ozs40i3.png)

如图黄色线为闪电的路径。

## 数据范围与约定

对于 $100\%$ 的数据保证：$0<n,m \le 1000$，$0 \le R_{i,j}\le 10^9$，$0< a,b,c \le m$。

#### 子任务「本题采用捆绑测试」

 - Subtask1（$10\%$）: $R_{i,j}\in\{1\}$。
 - Subtask2（$10\%$）: $R_{i,j}\in\{0,1\}$。
 - Subtask3（$10\%$）: $a=b=c$。
 - Subtask4（$10\%$）: $n,m \le 5$。
 - Subtask5（$60\%$）: 无特殊限制。
 


---

---
title: "[蓝桥杯 2018 国 C] 迷宫与陷阱"
layout: "post"
diff: 普及/提高-
pid: P8673
tag: ['2018', '广度优先搜索 BFS', '图论建模', '蓝桥杯国赛']
---
# [蓝桥杯 2018 国 C] 迷宫与陷阱
## 题目描述

小明在玩一款迷宫游戏，在游戏中他要控制自己的角色离开一间由 $N \times N$ 个格子组成的二维迷宫。

小明的起始位置在左上角，他需要到达右下角的格子才能离开迷宫。

每一步，他可以移动到上下左右相邻的格子中（前提是目标格子可以经过）。

迷宫中有些格子小明可以经过，我们用 `.` 表示；

有些格子是墙壁，小明不能经过，我们用 `#` 表示。

此外，有些格子上有陷阱，我们用 `X` 表示。除非小明处于无敌状态，否则不能经过。

有些格子上有无敌道具，我们用 `%` 表示。

当小明第一次到达该格子时，自动获得无敌状态，无敌状态会持续 $K$ 步。

之后如果再次到达该格子不会获得无敌状态了。

处于无敌状态时，可以经过有陷阱的格子，但是不会拆除 / 毁坏陷阱，即陷阱仍会阻止没有无敌状态的角色经过。

给定迷宫，请你计算小明最少经过几步可以离开迷宫。
## 输入格式

第一行包含两个整数 $N$ 和 $K$。$(1 \le N \le 1000，1 \le K \le 10)$。

以下 $N$ 行包含一个 $N\times N$ 的矩阵。

矩阵保证左上角和右下角是 `.`。
## 输出格式

一个整数表示答案。如果小明不能离开迷宫，输出 $-1$。
## 样例

### 样例输入 #1
```
5 3
...XX
##%#.
...#.
.###.
.....
```
### 样例输出 #1
```
10
```
### 样例输入 #2
```
5 1
...XX
##%#.
...#.
.###.
.....
```
### 样例输出 #2
```
12
```
## 提示

时限 3 秒, 256M。蓝桥杯 2018 年第九届国赛


---

---
title: "[蓝桥杯 2022 省 B] 扫雷"
layout: "post"
diff: 普及/提高-
pid: P8785
tag: ['图论', '计算几何', '2022', '蓝桥杯省赛']
---
# [蓝桥杯 2022 省 B] 扫雷
## 题目描述

小明最近迷上了一款名为《扫雷》的游戏。其中有一个关卡的任务如下，在一个二维平面上放置着 $n$ 个炸雷，第 $i$ 个炸雷 $\left(x_{i}, y_{i}, r_{i}\right)$ 表示在坐标 $\left(x_{i}, y_{i}\right)$ 处存在一个炸雷，它的爆炸范围是以半径为 $r_{i}$ 的一个圆。

为了顺利通过这片土地，需要玩家进行排雷。玩家可以发射 $m$ 个排雷火箭，小明已经规划好了每个排雷火箭的发射方向，第 $j$ 个排雷火箭 $\left(x_{j}, y_{j}, r_{j}\right)$ 表示这个排雷火箭将会在 $\left(x_{j}, y_{j}\right)$ 处爆炸，它的爆炸范围是以半径为 $r_{j}$ 的一个圆，在其爆炸范围内的炸雷会被引爆。同时，当炸雷被引爆时，在其爆炸范围内的炸雷也会被引爆。现在小明想知道他这次共引爆了几颗炸雷?

你可以把炸雷和排雷火箭都视为平面上的一个点。一个点处可以存在多个炸雷和排雷火箭。当炸雷位于爆炸范围的边界上时也会被引爆。
## 输入格式

输入的第一行包含两个整数 $n$、$m$。

接下来的 $n$ 行, 每行三个整数 $x_{i}, y_{i}, r_{i}$, 表示一个炸雷的信息。

再接下来的 $m$ 行，每行三个整数 $x_{j}, y_{j}, r_{j}$, 表示一个排雷火箭的信息。

## 输出格式

输出一个整数表示答案。
## 样例

### 样例输入 #1
```
2 1
2 2 4
4 4 2
0 0 5
```
### 样例输出 #1
```
2
```
## 提示

**【样例说明】**

示例图如下, 排雷火箭 1 覆盖了炸雷 1 , 所以炸雷 1 被排除; 炸雷 1 又覆 盖了炸雷 2 , 所以炸雷 2 也被排除。

![](https://luogu.oss-cn-hangzhou.aliyuncs.com/upload/vjudge_pic/lanqiao/2022_09_29_3d61ad9326a0012c9fdag-13.jpg)

**【评测用例规模与约定】**

对于 $40 \%$ 的评测用例: $0 \leq x, y \leq 10^{9}, 0 \leq n, m \leq 10^{3}, 1 \leq r \leq 10$.

对于 $100 \%$ 的评测用例: $0 \leq x, y \leq 10^{9}, 0 \leq n, m \leq 5 \times 10^{4}, 1 \leq r \leq 10$. 


蓝桥杯 2022 省赛 B 组 H 题。


---

---
title: "『MGOI』Simple Round I | C. 魔法禁林"
layout: "post"
diff: 普及/提高-
pid: P9504
tag: ['图论', '洛谷原创', 'O2优化', '记忆化搜索']
---
# 『MGOI』Simple Round I | C. 魔法禁林
## 题目背景

> 战斗的意义是为了生存，在这个竞争激烈的世界里，只有不断变强才能得以生存。——殿堂魔法士 S
## 题目描述

开学的第一天，小 M 迫不及待地计划着前往神秘的禁林。

小 M 拥有两个重要的属性，魔力值和生命值。非常特别的是，初始时，这两个值可以由小 M **任意决定**。

禁林可以看作一张 $n$ 个点 $m$ 条边的无向简单连通图。小 M 将在禁林里面行走，从起点 $s$ 走到 $t$。

每经过一条边，小 M 的**魔力值**都会减去 1。同时，每条边上有一个具有攻击力属性的魔兽，小 M 要与之战斗。若小 M 经过这条边之前的魔力值为 $k$，这条边上魔兽的攻击力为 $w$，那么经过这条边时发生的战斗将会消耗 $\left\lfloor \dfrac{w}{k} \right\rfloor$ 的**生命值**。魔兽不会被打败，因此**多次经过同一条边，每次都会发生战斗**。

**小 M 需要保证，当他的魔力值消耗完时，他的生命值为 0，且此时走到 $t$ 点。**

你需要求出小 M 初始时需要的最小生命值。
## 输入格式

第一行四个整数 $n,m,s,t$。

接下来 $m$ 行，每行三个整数 $u,v,w$，表示编号为 $u
,v$ 的点之间有一条边，边上魔兽的攻击力为 $w$。
## 输出格式

一行一个整数，表示小 M 初始时需要的最小生命值。
## 样例

### 样例输入 #1
```
3 3 1 3
1 2 2
1 3 5
3 2 3
```
### 样例输出 #1
```
4
```
### 样例输入 #2
```
5 10 1 5
2 1 3
3 1 7
4 2 4
5 3 9
5 1 7
2 3 2
5 4 6
1 4 10
5 2 5
3 4 10
```
### 样例输出 #2
```
6
```
## 提示

**【样例 1 解释】**

初始时，小 M 选择魔力值为 $2$，生命值为 $4$。

- $1\rightarrow2$：魔力值剩余 $1$，生命值剩余 $4 - \left\lfloor \frac{2}{2} \right\rfloor=3$。
- $2\rightarrow3$：魔力值剩余 $0$，生命值剩余 $3 - \left\lfloor \frac{3}{1} \right\rfloor=0$。

可以证明 $4$ 为小 M 初始时需要的最小生命值。

**【数据范围】** 

**本题采用 Subtask 捆绑测试。**

对于所有数据，$1 \le n \le 20000$，$1 \le m \le 40000$，$1\le s,t,u,v\le n$，$s\ne t$，图为无向简单连通图，$0\le w\le 100$。

| Subtask | $n$ | $m$ | $w\le$ | 分值 |
| :------------: | :----------: | :----------: | :-----------: | :----------------:|
| $1$ | $5$ | $10$ | $10$ | $11$ |
| $2$ | $2000$ | $4000$ | $10$ | $27$ |
| $3$ | $20000$ | $40000$ | $1$ | $19$ |
| $4$ | $20000$ | $40000$ | $100$ | $43$ |


---


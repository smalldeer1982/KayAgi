---
title: "[蓝桥杯 2024 国 A] gcd 与 lcm"
layout: "post"
diff: 普及/提高-
pid: P10580
tag: ['2024', '容斥原理', '蓝桥杯国赛']
---
# [蓝桥杯 2024 国 A] gcd 与 lcm
## 题目描述

给定两个数 $x,y$，求有多少种不同的长度为 $n$ 的序列 $(a_1,a_2,\cdots,a_n)$，其所有元素的最大公约数为 $x$ 且最小公倍数为 $y$。

两个序列 $(a_1,a_2,\cdots,a_n)$ 与 $(b_1,b_2,\cdots,b_n)$ 不同，是指存在至少一个位置 $i$ 满足 $a_i\neq b_i$。

由于答案可能很大，请输出答案对 $998\ 244\ 353$ 取模后的结果。
## 输入格式

输入的第一行包含一个整数 $Q$ 表示询问次数。

接下来 $Q$ 行，每行包含三个整数 $x,y,n$ 表示一组询问，相邻整数之间使用一个空格分隔。对于每个询问，保证至少存在一个满足条件的序列。

## 输出格式

输出 $Q$ 行，每行包含一个整数，依次表示每个询问的答案。
## 样例

### 样例输入 #1
```
3
3 6 2
12 144 3
233 251640 10
```
### 样例输出 #1
```
2
72
905954656
```
## 提示

对于 $40\%$ 的评测用例，$n\le 30$；  
对于 $70\%$ 的评测用例，$n\le 5000$；  
对于所有评测用例，$1\le Q\le 100$，$2\le n\le 10^5$，$1\le x,y\le 10^9$。


---

---
title: "[蓝桥杯 2025 省 B] 装修报价"
layout: "post"
diff: 普及/提高-
pid: P12137
tag: ['数学', '2025', '组合数学', '容斥原理', '位运算', '蓝桥杯省赛']
---
# [蓝桥杯 2025 省 B] 装修报价
## 题目描述

老王计划装修房子，于是联系了一家装修公司。该公司有一套自动报价系统，只需用户提供 $N$ 项装修相关费用 $A_1, A_2, \dots , A_N$，系统便会根据这些费用生成最终的报价。

然而，当老王提交数据后，他发现这套系统的运作方式并不透明：系统只会给出一个最终报价，而不会公开任何运算过程或中间步骤。

公司对此解释称，这套系统会依据某种内部算法，在每对相邻数字之间插入 $+$（加法）、$-$（减法）或 $\oplus$（异或）运算符，并按照特定优先级规则计算结果：异或运算优先级最高，其次是加减。但由于保密性，具体的运算符组合以及中间过程都不会对外公开。

为了验证系统报价是否合理，老王决定模拟其运作方式，尝试每种可能的运算符组合，计算出所有可能出现的结果的总和。如果最终报价明显超出这个范围，他就有理由怀疑系统存在异常或误差。只是老王年事已高，手动计算颇为吃力，便向你求助。

现在，请你帮老王算出所有可能的结果的总和。由于该总和可能很大，你只需提供其对 $10^9+7$ 取余后的结果即可。
## 输入格式

第一行输入一个整数 $N$，表示装修相关费用的项数。

第二行输入 $N$ 个非负整数 $A_1, A_2, \dots , A_N$，表示各项费用。
## 输出格式

输出一个整数，表示所有可能的总和对 $10^9 + 7$ 取余后的结果。
## 样例

### 样例输入 #1
```
3
0 2 5
```
### 样例输出 #1
```
11
```
## 提示

对于输入样例中的三个数 $A = [0, 2, 5]$，所有可能的运算符组合共有 $9$ 种。计算结果如下：

$$0 \oplus 2 \oplus 5 = 7$$
$$0 \oplus 2 + 5 = 7$$
$$0 \oplus 2 - 5 = -3$$
$$0 + 2 \oplus 5 = 7$$
$$0 + 2 + 5 = 7$$
$$0 + 2 - 5 = -3$$
$$0 - 2 \oplus 5 = -7$$
$$0 - 2 + 5 = 3$$
$$0 - 2 - 5 = -7$$

所有结果的总和为：

$$7 + 7 + (-3) + 7 + 7 + (-3) + (-7) + 3 + (-7) = 11$$

$11$ 对 $10^9 + 7$ 取余后的值依然为 $11$，因此，输出结果为 $11$。

### 评测用例规模与约定

- 对于 $30\%$ 的评测用例，$1 \leq N \leq 13$，$0 \leq A_i \leq 10^3$。
- 对于 $60\%$ 的评测用例，$1 \leq N \leq 10^3$，$0 \leq A_i \leq 10^5$。
- 对于 $100\%$ 的评测用例，$1 \leq N \leq 10^5$，$0 \leq A_i \leq 10^9$。


---

---
title: "「WWOI R1」WsW 的笔"
layout: "post"
diff: 普及/提高-
pid: P13561
tag: ['数学', 'O2优化', '组合数学', '容斥原理']
---
# 「WWOI R1」WsW 的笔
## 题目背景

WsW 准备送几支笔给 bln。
## 题目描述

WsW 有 $b-a+1$ 支笔，每支笔的编号为 $a\sim b$ 的正整数，且笔的编号互不相同。他决定送若干支笔给 bln，并将剩余的笔留给自己。   

当所有的笔都满足以下条件时，WsW 认为这种送笔方案是**优秀送笔方案**：  
* 如果将编号为 $x$ 的笔送给 bln，那么必须将编号为 $x/k$ 的笔留给自己。  
* 如果将编号为 $x$ 的笔留给自己，那么必须将编号为 $x/k$ 的笔送给 bln。  

	当然，这些条件的前提是 WsW 有编号为 $x/k$ 的笔。

WsW 认为，如果某个编号的笔在一种方案中被送出，在另一种方案中被留下，则这两种送笔方案是不同的。

现在所有的笔都已经被 WsW 编完号了，WsW 想知道一共有多少种**不同的优秀送笔方案**。  

由于最后的结果可能很大，你只需要告诉 WsW 总方案数对 $10^9+7$ 取模后的值。
## 输入格式

**本题有多组测试数据。**  

输入的第一行包含一个正整数 $T$，表示数据组数。  

接下来包含 $T$ 组数据，每组数据的格式如下：  

第一行输入一个正整数 $k$。  

第二行输入两个正整数 $a,b$，表示笔编号的范围。
## 输出格式

对于每组数据：输出一行包含一个整数，表示有多少种**不同的优秀送笔方案**。答案对 $10^9+7$ 取模。
## 样例

### 样例输入 #1
```
1
2
2 2
```
### 样例输出 #1
```
2
```
### 样例输入 #2
```
1
3
1 4
```
### 样例输出 #2
```
8
```
### 样例输入 #3
```
1
114
514 1919810
```
### 样例输出 #3
```
532406817
```
## 提示

### 【样例 $1$ 解释】

|方案|送出编号|留下编号|
|:-:|:-:|:-:|
|$1$|$2$|无|
|$2$|无|$2$|

共 $2$ 种不同的优秀送笔方案。

### 【样例 $2$ 解释】

|方案|送出编号|留下编号|
|:-:|:-:|:-:|
|$1$|$1$|$2,3,4$|
|$2$|$1,2$|$3,4$|
|$3$|$1,4$|$2,3$|
|$4$|$1,2,4$|$3$|
|$5$|$3$|$1,2,4$|
|$6$|$2,3$|$1,4$|
|$7$|$3,4$|$1,2$|
|$8$|$2,3,4$|$1$|

共 $8$ 种不同的优秀送笔方案。

### 【数据范围】
**本题采用捆绑测试**。

对于所有测试数据，保证 $1\le T\le 5$，$1\le a\le b\le 10^{18}$，$2\le k\le10^{5}$。

| 子任务编号 | $a,b\leq$ | 特殊性质 | 分值 |
| :-: | :-: | :-: | :-: |
| $1$ | $20$ | 无 | $10$ |
| $2$ | $10^3$ | 无 | $10$ |
| $3$ | $10^5$ | B | $5$ |
| $4$ | ^ | 无 | $10$ |
| $5$ | $7\times10^6$ | A | $5$ |
| $6$ | ^ | B | $5$ |
| $7$ | ^ | 无 | $15$ |
| $8$ | $10^{18}$ | A | $5$ |
| $9$ | ^ | B | $10$ |
| $10$ | ^ | 无 | $25$ |

* 特殊性质 A：$a\times k>b$。  

* 特殊性质 B：$k=2$。  



---

---
title: "[HNOI2008] 越狱"
layout: "post"
diff: 普及/提高-
pid: P3197
tag: ['数学', '2008', '各省省选', '湖南', 'O2优化', '组合数学', '容斥原理']
---
# [HNOI2008] 越狱
## 题目描述

监狱有 $n$ 个房间，每个房间关押一个犯人，有 $m$ 种宗教，每个犯人会信仰其中一种。如果相邻房间的犯人的宗教相同，就可能发生越狱，求有多少种状态可能发生越狱。

答案对 $100,003$ 取模。
## 输入格式

输入只有一行两个整数，分别代表宗教数 $m$ 和房间数 $n$。
## 输出格式

输出一行一个整数代表答案。
## 样例

### 样例输入 #1
```
2 3

```
### 样例输出 #1
```
6
```
## 提示

#### 样例输入输出 1 解释

| 状态编号 | 1 号房间 | 2 号房间 | 3 号房间 |
| :--------: | :--------: | :-------: | :--------: |
| 1 | 信仰 1 | 信仰 1 | 信仰 1 |
| 2 | 信仰 1 | 信仰 1 | 信仰 2 |
| 3 | 信仰 1 | 信仰 2 | 信仰 2 |
| 4 | 信仰 2 | 信仰 1 | 信仰 1 |
| 5 | 信仰 2 | 信仰 2 | 信仰 2 |
| 6 | 信仰 2 | 信仰 2 | 信仰 1 |

#### 数据规模与约定

对于 $100\%$ 的数据，保证 $1 \le m \le 10^8$，$1 \le n \le 10^{12}$。


---

---
title: "『JROI-3』Reversi"
layout: "post"
diff: 普及/提高-
pid: P7893
tag: ['数学', '2021', 'O2优化', '容斥原理', '洛谷月赛']
---
# 『JROI-3』Reversi
## 题目背景

**赛时提醒：如果您始终是 30pts，且使用了题目给的快速读入，请重新拷贝修改后的快速读入。**

**赛时提醒：本题如果解法正确，快读可能无法起到优化作用。**

	这个恐怕是将存在乃至于记忆切割成三十二颗的争夺黑白棋。

    双方剩下的棋子数字都很小——也就是重要性很高吧。

				......
            
    ——哥哥为什么会让自己落单呢？她原本对此感到疑惑。

    不过，在得知答案之后，那可以说是理所当然的做法。

    首先，第一个理由极为单纯。

    故意将记忆托付给对方，暂时屈居败势的目的是——

    「……那种事……白……做不到啊……」

    想像了一下，白露出悲伤的笑容，做出这个结论。

    哥哥做的这些事，如果由白执行……白不觉得自己的精神能够保持正常。

    自己仅仅因为哥哥从身旁消失，就甚至一度怀疑哥哥的存在。

    ——被忘掉的话还好。

    ——忘掉哥哥的话——白确信自己的精神会无法保持正常。
    
				......
                
    （……这里……哥哥在……这里……）

    即使是空无一物的空间，但是白确信，她感觉得到哥哥的位置。

    白顿时眼眶一热，不过她强行忍住，继续思考。

    （……然后这就是……第二个……同时也是……最大的……理由。）

    白将写着【参】的棋子白色面朝上，用手指夹住。

    哥哥是『白色还是黑色』，这个问题也不需要犹豫。

    因为既然他将最后的棋局托付给『白』——那他当然是持白棋。

    这个现在看不见，甚至无法认知的棋局。

    既没有开始的记忆，也不知道盘面的经过如何。

    不过哥哥故意下输，并且为了让白能获胜所可能下的棋步……

    而对方看到之后，完全中了哥哥的计谋，被诱导而下的棋步……

    然后，为了逆转，哥哥可能选择的所有位置分布。

    将这些全部推测分析——仅用三步棋反败为胜。

				......
            
    然后——原先失去一天半的记忆——逆流了回来——

## 题目描述

**白**在和森精种玩黑白棋，但黑白棋的规则有所改变。

有 $n$ 个黑白棋子，第 $i$ 个棋子编号为 $i$。棋子初始全为黑，游戏中，仅由**白**一人操作，**白**希望尽可能多的把棋子变成白色。

**白**要求第 $k$ 个棋子和第 $k \times p$ 个不能同时变成白色。

**白**共玩了 $T$ 次，每次**白**想知道最多能把多少棋子变成白色。**每次游戏独立。**

为避免混淆，加粗的**白**是人名。
## 输入格式

第一行一个正整数 $T$，表示数据组数。

下面 $T$ 行每行两个整数 $n,p$，同题意。
## 输出格式

共 $T$ 行，每行一个正整数，表示**白**最多能把多少枚棋子变为白色。
## 样例

### 样例输入 #1
```
1
3 2
```
### 样例输出 #1
```
2
```
### 样例输入 #2
```
1
100 5
```
### 样例输出 #2
```
84
```
## 提示

#### 样例 1 解释

可以选择第 $2,3$ 个棋子变色。

#### 数据规模与约定

**本题采用捆绑测试。**

- Subtask 1（5 pts）：$T \le 5$，$n \le 2$；
- Subtask 2（5 pts）：$T \le 5$，$n \le 10$；
- Subtask 3（20 pts）：$T \le 5$，$n \le 10^6$；
- Subtask 4（70 pts）：无特殊限制。

对于 $100\%$ 的数据满足，$1 \le T \le 10^6$，$0 \le n \le 10^{18}$，$1 \le p \le 10^{9}$。

```
//快读模板
//赛时提醒：快读没有太大必要使用
inline long long read(){
   long long s=0,w=1;
   char ch=getchar();
   while(ch<'0'||ch>'9'){if(ch=='-')w=-1;ch=getchar();}
   while(ch>='0'&&ch<='9')s=s*10+ch-'0',ch=getchar();
   return s*w;
}
```


---

---
title: "炼金术（Alchemy）"
layout: "post"
diff: 普及/提高-
pid: P8557
tag: ['数学', '洛谷原创', '组合数学', '容斥原理']
---
# 炼金术（Alchemy）
## 题目描述

铃是一个爱玩游戏的女孩子。

她在游戏中想要炼制一种稀有合金 —— 这需要 $n$ 种金属来合成。

她准备好矿石后建造了 $k$ 个不同的熔炉，当熔炉启动时，会随机炼出这 $n$ 种金属中的一些（也可能什么都没有）。

如果把每个熔炉炼出的金属收集起来，有了全部 $n$ 种金属，就能造出合金了。澪对此很好奇，对铃说：「我考考你，有多少种情况可以炼出合金呢？」这个简单的问题铃很快就会做了，你能求出结果吗？

答案可能很大，请对 $998244353$ 取模（即除以 $998244353$ 的余数）后输出。
## 输入格式

输入一行两个正整数 $n,k$。
## 输出格式

输出一行一个整数，表示答案。
## 样例

### 样例输入 #1
```
2 2
```
### 样例输出 #1
```
9
```
### 样例输入 #2
```
4 5
```
### 样例输出 #2
```
923521
```
### 样例输入 #3
```
233 123
```
### 样例输出 #3
```
81633405
```
## 提示

【样例一解释】  
对于所有成功情况，两个熔炉中的金属如下表：

| 一号  | 二号 |
| :----------: | :----------: |
| $\varnothing$ | $\{1,2\}$ |
| $\{1\}$ | $\{2\}$ |
| $\{1\}$ | $\{1,2\}$ |
| $\{2\}$ | $\{1\}$ |
| $\{2\}$ | $\{1,2\}$ |
| $\{1,2\}$ | $\varnothing$ |
| $\{1,2\}$ | $\{1\}$ |
| $\{1,2\}$ | $\{2\}$ |
| $\{1,2\}$ | $\{1,2\}$ |

一共 $9$ 种，因此答案为 $9$。

【数据范围】  
对于 $30\%$ 的数据，$1\le n,k \le 10$；  
对于 $80\%$ 的数据，$1\le n,k \le 10^6$；  
对于 $100\%$ 的数据，$1\le n,k \le 10^9$。


---

---
title: "[蓝桥杯 2020 省 AB3] 画中漂流"
layout: "post"
diff: 普及/提高-
pid: P8725
tag: ['动态规划 DP', '2020', '容斥原理', '蓝桥杯省赛']
---
# [蓝桥杯 2020 省 AB3] 画中漂流
## 题目描述

在梦境中，你踏上了一只木䇝，在江上漂流。

根据对当地的了解，你知道在你下游 $D$ 米处有一个峡谷，如果你向下游前进大于等于 $D$ 米则必死无疑。

现在你打响了急救电话，$T$ 秒后救援队会到达并将你救上岸。水流速度是 $1 \mathrm{~m} / \mathrm{s}$，你现在有 $M$ 点体力。每消耗一点体力，你可以划一秒桨使船向上游前 进 $1 \mathrm{~m}$，否则会向下游前进 $1 \mathrm{~m}$ (水流)。$M$ 点体力需在救援队赶来前花光。因为江面太宽了，凭借你自己的力量不可能上岸。

请问，有多少种划桨的方案可以让你得救。

两个划桨方案不同是指：存在某一秒钟，一个方案划桨，另一个方案不划。
## 输入格式

输入一行包含三个整数 $D$，$T$，$M$。
## 输出格式

输出一个整数，表示可以让你得救的总方案数，答案可能很大，请输出方案数除以 $1000000007$（即 $10^9+7$）的余数。
## 样例

### 样例输入 #1
```
1 6 3
```
### 样例输出 #1
```
5
```
## 提示

对于 $50 \%$ 的评测用例，$1 \leq T \leq 350$。

对于所有评测用例，$1 \leq T \leq 3000,1 \leq D \leq T，1 \leq M \leq 1500$。

蓝桥杯 2020 第三轮省赛 AB 组 I 题。


---


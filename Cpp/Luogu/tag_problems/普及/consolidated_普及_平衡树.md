---
title: "送花"
layout: "post"
diff: 普及/提高-
pid: P2073
tag: ['线段树', '平衡树']
---
# 送花
## 题目背景

小明准备给小红送一束花，以表达他对小红的爱意。他在花店看中了一些花，准备用它们包成花束。

## 题目描述

这些花都很漂亮，每朵花有一个美丽值 $W$，价格为 $C$。

小明一开始有一个空的花束，他不断地向里面添加花。他有以下几种操作：

- $1\ W\ C$：添加一朵美丽值为 $W$，价格为 $C$ 的花。  
**如果此时花束中已经有了相等价格的花，那么这朵花不能加入花束。**
- $2$：删除当前花束里最贵的一朵花。
- $3$：删除当前花束里最便宜的一朵花。
- $-1$：完成添加与删除，开始包装花束。

**当花束为空时，忽略操作 $2$ 和 $3$。**

请你写一个程序，计算出开始包装花束时，花束中所有花的美丽值的总和，以及小明需要为花束付出的总价格。
## 输入格式

若干行，每行一个操作，以 $-1$ 结束。
## 输出格式

一行，两个空格隔开的正整数表示开始包装花束时，花束中所有花的美丽值的总和。以及小明需要为花束付出的总价格。
## 样例

### 样例输入 #1
```
1 1 1
1 2 5
2
1 3 3
3
1 5 2
-1

```
### 样例输出 #1
```
8 5
```
## 提示

设操作数为 $m$。

- 对于 $20\%$ 数据，$m \le 100$，$1\le W,C\le 10^3$。
- 对于全部数据，$m \le 10^5$，$1\le W,C\le 10^6$。


---

---
title: "[HNOI2002] 营业额统计"
layout: "post"
diff: 普及/提高-
pid: P2234
tag: ['2002', '各省省选', '平衡树', '湖南']
---
# [HNOI2002] 营业额统计
## 题目描述

Tiger 最近被公司升任为营业部经理，他上任后接受公司交给的第一项任务便是统计并分析公司成立以来的营业情况。

Tiger 拿出了公司的账本，账本上记录了公司成立以来每天的营业额。分析营业情况是一项相当复杂的工作。由于节假日，大减价或者是其他情况的时候，营业额会出现一定的波动，当然一定的波动是能够接受的，但是在某些时候营业额突变得很高或是很低，这就证明公司此时的经营状况出现了问题。经济管理学上定义了一种最小波动值来衡量这种情况：当最小波动值越大时，就说明营业情况越不稳定。

而分析整个公司的从成立到现在营业情况是否稳定，只需要把每一天的最小波动值加起来就可以了。你的任务就是编写一个程序帮助 Tiger 来计算这一个值。

我们定义，一天的最小波动值 = $\min\{|\text{该天以前某一天的营业额}-\text{该天营业额}|\}$。

特别地，第一天的最小波动值为第一天的营业额。
## 输入格式

第一行为正整数 $n$（$n \leq 32767$） ，表示该公司从成立一直到现在的天数，接下来的 $n$ 行每行有一个整数 $a_i$（$|a_i| \leq 10^6$) ，表示第 $i$ 天公司的营业额，可能存在负数。
## 输出格式

输出一个正整数，即每一天最小波动值的和，保证结果小于 $2^{31}$。
## 样例

### 样例输入 #1
```
6
5
1
2
5
4
6

```
### 样例输出 #1
```
12
```
## 提示

结果说明：$5+|1-5|+|2-1|+|5-5|+|4-5|+|6-5|=5+4+1+0+1+1=12$



---

---
title: "英语1（eng1）- 英语作文"
layout: "post"
diff: 普及/提高-
pid: P2786
tag: ['字符串', '树形数据结构', '平衡树', '洛谷原创']
---
# 英语1（eng1）- 英语作文
## 题目背景

蒟蒻 HansBug 在英语考场上，挠了无数次的头，可脑子里还是一片空白。
## 题目描述

眼下出现在 HansBug 蒟蒻面前的是一篇英语作文，然而智商捉急的 HansBug 已经草草写完了，此时他发现离考试结束还有 $40$ 分钟，于是他打算估计一下这篇共有 $M$ 个单词的英语作文的含金量如何。众所周知的是，在中高考英语作文中使用高级词汇可以有效提高文章的含金量，从而获得更好的分数。已知蒟蒻HansBug知道 $N$ 个高级词汇，该词汇为 $A_i$（词汇长度为 $L_i$ ，包含数字、大小写字母），该高级词汇的含金量为 $B_i$，则该高级词汇每出现一次便可增加 $B_i$ 的含金量。可是他脑细胞和 RP 已经消耗殆尽，所以这个伟大的任务就交给你啦！
## 输入格式

第一行包含两个整数 $N$ 和 $P$ ， $N$ 表示HansBug共知道的高级词汇个数， $P$ 为模数

第 $2-N+1$行，每行包含一个单词 $A_i$ （长度为Li）和一个整数 $B_i$ ，其中 $B_i(0<B_i\le 10^5)$ 表示该单词的含金量

接下来直到输入结束的若干行为一篇英语作文，其中包含共计 $M$ 个单词，以及若干的分隔符（分隔符包含且仅包含`,`、`.`、`!`、`?`）
## 输出格式

一行，包含一个整数，为该文章的总含金量对 $P$ 的模。
## 样例

### 样例输入 #1
```
5 99
hansbug 1
kkksc03 2
yyy 3
absi2011 4
lzn 100
hansbug is a juruo!but absi2011 not.!?!
one day absi2011 laughed at yyy and hansbug.
then kkksc03 and lzn blamed him for that.

```
### 样例输出 #1
```
16
```
### 样例输入 #2
```
5 99
yyyy 1
kkksc03 2
yyy 3
absi2011 4
lzn 100
yyyy is a juruo!but absi2011 not.!?!
one day absi2011 laughed at yyy and yyyy.
then kkksc03 and lzn blamed him for that.

```
### 样例输出 #2
```
16
```
## 提示

样例 $1$ 中，共计出现了 $2$ 次`hansbug`、 $2$ 次`absi2011` 、 $1$ 次 `yyy` 、 $1$ 次`kkksc03`、 $1$ 次  `lzn` ，所以总含金量为 $1\times2+2\times4+3\times1+4\times1+100\times1=115$，对 $99$ 取模就是 $16$ 。

样例 $2$ 中，和样例 $1$ 基本一样，值得注意的是整体的 `yyyy` 不可以被认为是 `yyy` 出现 $2$ 次，请注意这是一篇英语作文，一切以单词为最小单位。

此题目中大小写敏感。

数据范围（设所有单词的最大长度为 $Lmax$ ）：

![](https://cdn.luogu.com.cn/upload/pic/2228.png)



---

---
title: "「TOCO Round 1」自适应 PVZ"
layout: "post"
diff: 普及/提高-
pid: P7391
tag: ['贪心', '平衡树', '排序']
---
# 「TOCO Round 1」自适应 PVZ
## 题目背景

爆切今天的毒瘤三维计算几何后，$\color{black}\texttt{Q}\color{red}\texttt{wQcOrZ}$ 打开了某个有趣的 exe 文件。
## 题目描述

可怜的 $\color{black}\texttt Q\color{red}\texttt{wQcOrZ}$ 在草坪上遇到了 $n$ 只僵尸，第 $i$ 只僵尸在 $l_i$ 时刻出现，会在 $r_i$ 时刻走进房子。

$\color{black}\texttt Q\color{red}\texttt{wQcOrZ}$ 手头有 $m$ 个豌豆射手。若一个豌豆射手在 $l_i$ 至 $r_i$ 时刻（不包括两个端点）持续攻击 $i$ 僵尸则可以杀死 $i$ 僵尸，但在攻击过程中不能攻击另外两只僵尸且攻击的僵尸不能更换。

现在 $\color{black}\texttt Q\color{red}\texttt{wQcOrZ}$ 想知道在合理的安排下，最少有几只僵尸会进入他的房子。
## 输入格式

第一行两个整数 $n,m$ 表示僵尸数量和豌豆射手数量。

接下来 $n$ 行每行两个整数 $l_i$ 和 $r_i$ 表示僵尸 $i$ 的出现时刻和走进房子时刻。
## 输出格式

一个整数表示答案。
## 样例

### 样例输入 #1
```
2 1
1 2
3 4
```
### 样例输出 #1
```
0
```
### 样例输入 #2
```
3 2
1 3
1 3
2 4
```
### 样例输出 #2
```
1
```
### 样例输入 #3
```
2 1
1 3
3 5
```
### 样例输出 #3
```
0
```
## 提示

对于 $30\%$ 的数据，$n,m\leq 6$。  
对于 $60\%$ 的数据，$n,m\leq 10^3$。  
对于另外 $20\%$ 的数据，$m\geq n$。  
对于 $100\%$ 的数据，$1\leq n,m\leq 2\times 10^5$，$1\leq l_i<r_i\leq 10^9$。


---

---
title: "「DPOI-1」优美的序列"
layout: "post"
diff: 普及/提高-
pid: P8895
tag: ['数学', '平衡树', '2022', '洛谷原创', 'O2优化']
---
# 「DPOI-1」优美的序列
## 题目背景

#### Update on 2022.12.18：新增一组针对 @[zhuoxingmu](https://www.luogu.com.cn/user/421155) 的 Hack 数据，放置于 #21，分值为 $5$ 分。
#### Update on 2022.12.18：新增一组针对 @[大眼仔Happy](https://www.luogu.com.cn/user/537046) 的 Hack 数据，放置于 #22，分值为 $5$ 分。
------------
不可以，总司令。
## 题目描述

总司令给你一个长为 $n$ 的序列 $a$。

他认为这个 $a$ 现在也许不够优美，他希望将其重排为一个 $a'$，使之变得优美。

我们称一个长为 $n$ 的序列 $a$ 优美，当且仅当 $\exists i \in [1,n]$，满足：

- $\forall j \in [1, i)$，$a_j > a_{j + 1}$。
- $\forall j \in (i, n]$，$a_j > a_{j - 1}$。

他命令你求出 $a$ 经过重排可以得到多少个不同的 $a'$。由于结果可能很大，你只需要求出结果对 $p$ 取模的值。

由于一个固定的 $a$ 太无趣了，于是他给你 $m$ 次修改，每次修改形如 `x k`，表示令 $a_x \leftarrow k$。你需要在每次修改后求出当前的答案。
## 输入格式

第一行，三个整数 $n, m, p$；

第二行，$n$ 个整数 $a_1, a_2, \cdots, a_n$；

接下来 $m$ 行，每行两个整数 $x, k$，表示一次修改操作。
## 输出格式

共 $m + 1$ 行，每行一个整数，表示初始状态下及每次修改后所求的值。
## 样例

### 样例输入 #1
```
4 1 998244353
1 2 2 3
3 4
```
### 样例输出 #1
```
2
8
```
### 样例输入 #2
```
见下发文件 sequence2.in
```
### 样例输出 #2
```
见下发文件 sequence2.out
```
## 提示

#### 样例 #1 解释
对于初始状态，满足条件的 $a'$ 有 $[2, 1, 2, 3], [3, 2, 1, 2]$，共 $2$ 个。

对于第一次修改后的 $a = [1, 2, 4, 3]$，满足条件的 $a'$ 有 $[1, 2, 3, 4], [2, 1, 3, 4], [3, 1, 2, 4], [4, 1, 2, 3], [3, 2, 1, 4], [4, 2, 1, 3], [4, 3, 1, 2], [4, 3, 2, 1]$，共 $8$ 个。
#### 样例 #2 解释
该样例满足测试点 $15 \sim 20$ 的限制。
#### 数据范围
| 测试点编号 | $n \leq$ | $m \leq$ | 特殊条件 |
| :------: | :------: | :------: | :------: |
| $1 \sim 2$ | $10$ | $10$ | 无 |
| $3 \sim 4$ | $100$ | $100$ | 无 |
| $5 \sim 6$ | $10^3$ | $10^3$ | 无 |
| $7 \sim 10$ | $10^5$ | $10^5$ | 无 |
| $11 \sim 12$ | $5 \times 10^5$ | $0$ | $a$ 为一个**排列** |
| $13 \sim 14$ | $5 \times 10^5$ | $0$ | 无 |
| $15 \sim 20$ | $5 \times 10^5$ | $5\times 10^5$ | 无 |

对于 $100\%$ 的数据，$1 \leq n \leq 5 \times 10^5$，$0 \leq m \leq 5 \times 10^5$，$2 \leq p \leq 10^9$，$1 \leq a_i, k, x \leq n$。


---


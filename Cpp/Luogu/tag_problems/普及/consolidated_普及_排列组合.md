---
title: "[NICA #3] 星空（Easy Version）"
layout: "post"
diff: 普及/提高-
pid: B3901
tag: ['数学', 'O2优化', '排列组合']
---
# [NICA #3] 星空（Easy Version）
## 题目背景

**Easy Version 和 Hard Version 差别在于数据范围。**
## 题目描述

小 R 有一个长度为 $n$ 的序列 $a$，保证序列中的每个数都是 $2$ 的整数次幂。

小 M 有一个数 $x$，她希望重新排列序列 $a$，使得不存在一个 $i\in[1,n)$ 满足 $a_i+a_{i+1}>x$。重排的方式为：选择一个 $1\sim n$ 的排列 $p$，然后令新序列 $a'$ 满足 $a'_i=a_{p_i}$。$a'$ 即为重排后的序列。

现在你想要知道有多少种重排的方式能满足小 M 的要求。两种重排方式不同当且仅当选择的排列 $p$ 不同。答案对 $10^9+7$ 取模。
## 输入格式

第一行输入两个正整数 $n,x$，表示序列长度和小 M 想的那个数；

第二行输入 $n$ 个正整数 $a_i$，表示序列；
## 输出格式

输出一行表示答案。答案对 $10^9+7$ 取模。
## 样例

### 样例输入 #1
```
4 20
2 4 8 16
```
### 样例输出 #1
```
12
```
## 提示

数据保证，$2 \leq n \leq 61$，$1 \leq a_i \leq 2^{60}$，$1\le x< 2^{63}$。**每一个 $a_i$ 都不重复**。


---

---
title: "[GESP202312 八级] 奖品分配"
layout: "post"
diff: 普及/提高-
pid: P10112
tag: ['数学', '2023', '组合数学', '排列组合', 'GESP']
---
# [GESP202312 八级] 奖品分配
## 题目描述

班上有 $N$ 名同学，学号从 $0$ 到 $N-1$。有 $M$ 种奖品要分给这些同学，其中，第 $i$ 种奖品总共有 $a_i$ 个 （$i=0,1, \cdots ,M-1$）。

巧合的是，奖品的数量不多不少，每位同学都可以恰好分到一个奖品，且最后剩余的奖品不超过 $1$ 个（即：$N\le a_0+a_1+ \cdots +a_{M-1}\le N+1$）。

现在，请你求出每个班级礼物分配的方案数，所谓方案，指的是为每位同学都分配一个种类的奖品。

只要有一位同学获得了不同种类的奖品，即视为不同的方案。方便起见，你只需要输出方案数对 $10^{9}+7$ 取模后的结果即可。

共有 $T$ 个班级都面临着奖品分配的问题，你需要依次为他们解答。
## 输入格式

第一行一个整数 $T$，表示班级数量。

接下来 $T$ 行，每行若干用单个空格隔开的正整数。首先是两个正整数$N,M$，接着是 $M$ 个正整数 $a_0,a_1...a_{M-1}$。保证 $N \le a_0+a_1+\cdots+a_{M-1} \le N+1 $。
## 输出格式

输出 $T$ 行，每行一个整数，表示该班级分配奖品的方案数对 $10^{9}+7$ 取模的结果。
## 样例

### 样例输入 #1
```
3
3 2 1 2
3 2 1 3
5 3 1 3 1 
```
### 样例输出 #1
```
3
4
20
```
### 样例输入 #2
```
5
100 1 100
100 1 101
20 2 12 8
123 4 80 20 21 3
999 5 101 234 499 66 99
```
### 样例输出 #2
```
1
1
125970
895031741
307187590
```
## 提示

**样例解释 1**

对于第 $1$ 个班级，学号为 $0,1,2$ 的同学可以依次分别获得奖品 $0,1,1$，也可以依次分别获得奖品 $1,0,1$，也可以依次分别获得奖品 $1,1,0$ ，因此共有 $3$ 种方案。

对于第 $2$ 个班级，学号为 $0,1,2$ 的同学可以依次分别获得奖品 $0,1,1$ ，也可以依次分别获得奖品 $1,0,1$，也可以依次分别获得奖品 $1,1,0$，也可以依次分别获得奖品 $1,1,1$，因此共有 $4$ 种方案。

对于第 $3$ 个班级，可以把编号为 $0$ 的奖品分配给 $5$ 名同学中的任意一名，共有 $5$ 种方案；再把编号为 $2$ 的奖品分配给剩余 $4$ 名同学中的任意一名，共有$4$ 种方案；最后给剩余 $3$ 名同学自然获得 $1$ 号奖品。因此，方案数为 $5 \times 4 = 20$。

**数据范围**

对于 $30\%$ 的测试点，保证 $N \le 10$。

对于另外 $30\%$ 的测试点，保证 $M=2$。

对于所有测试点，保证 $N \le 1000$；保证 $T \le 1000$ ；保证 $M \le 1001$。


---

---
title: "[GESP202409 八级] 手套配对"
layout: "post"
diff: 普及/提高-
pid: P11250
tag: ['2024', '组合数学', '排列组合', 'GESP']
---
# [GESP202409 八级] 手套配对
## 题目描述

小杨有 $n$ 对不同的手套，每对手套由左右各一只组成。

小杨想知道从中取出 $m$ 只手套，恰好包含 $k$ 对手套的情况有多少种。

小杨认为两种取出的情况不同，当且仅当两种情况取出的手套中存在不同的手套（同一对手套的左右手也视为不同的手套）。
## 输入格式


**本题单个测试点内由多组测试数据**。第一行是一个整数 $t$，表示测试用例数量。接下来是 $t$ 组测试用例，每组一行。

每组数据只有一行三个正整数 $n,m,k$，表示手套数量、取出的手套数和目标对数。

## 输出格式


对每组数据，输出一行一个整数表示答案对 $10^9 + 7$ 取模的结果。

## 样例

### 样例输入 #1
```
2
5 6 2
5 1 5
```
### 样例输出 #1
```
120
0
```
## 提示

| 子任务 | 占比 | $t$ | $n$ | $m$ | $k$ |
| :-: | :-: | :-: | :-: | :-: | :-: |
| $1$ | $30\%$ | $\leq 5$ | $1000$ | $\le 3$ | $=1$ |
| $2$ | $30\%$ | $\leq 5$ | $\leq 5$ | $\leq 10$ | $\leq 5$ |
| $3$ | $40\%$ | $10^5$ | $1000$ | $2000$ | $2000$ |

对全部的测试数据，保证 $1 \leq t \leq 10^5$，$1 \leq n \leq 1000$，$1 \leq m \leq 2 \times n$，$1 \le k \le n$。


---

---
title: "[GESP202412 八级] 排队"
layout: "post"
diff: 普及/提高-
pid: P11380
tag: ['图论', '2024', '数论', '图论建模', '组合数学', '排列组合', 'GESP']
---
# [GESP202412 八级] 排队
## 题目描述

小杨所在班级共有 $n$ 位同学，依次以 $1,2,\dots,n$ 标号。这 $n$ 位同学想排成一行队伍，其中有些同学之间关系非常好，在队伍里需要排在相邻的位置。具体来说，有 $m$ 对这样的关系（$m$ 是一个非负整数）。当 $m\geq 1$ 时，第 $i$ 对关系（$1\leq i\leq m$）给出 $a_i,b_i$，表示排队时编号为 $a_i$ 的同学需要排在编号为 $b_i$ 的同学前面，并且两人在队伍中相邻。

现在小杨想知道总共有多少种排队方式。由于答案可能很大，你只需要求出答案对 $10^9+7$ 取模的结果。
## 输入格式

第一行，两个整数 $n,m$，分别表示同学们的数量与关系数量。

接下来 $m$ 行，每行两个整数 $a_i,b_i$，表示一对关系。
## 输出格式

一行，一个整数，表示答案对 $10^9+7$ 取模的结果。
## 样例

### 样例输入 #1
```
4 2
1 3
2 4
```
### 样例输出 #1
```
2
```
### 样例输入 #2
```
3 0
```
### 样例输出 #2
```
6
```
### 样例输入 #3
```
3 2
1 2
2 1
```
### 样例输出 #3
```
0
```
## 提示

对于 $20\%$ 的测试数据点，保证 $1\leq n\leq 8$，$0\leq m\leq 10$。

对于另外 $20\%$ 的测试数据点，保证 $1\leq n\leq 10^3$，$0\leq m\leq 1$。

对于所有测试数据点，保证 $1\leq n\leq 2\times 10^5$，$0\leq m\leq 2\times 10^5$。


---

---
title: "车的放置"
layout: "post"
diff: 普及/提高-
pid: P1350
tag: ['递推', '福建省历届夏令营', '组合数学', '排列组合']
---
# 车的放置
## 题目描述

有下面这样的一个网格棋盘，$a,b,c,d$ 表示了对应边长度，也就是对应格子数：

![](https://cdn.luogu.com.cn/upload/image_hosting/g7ulpevu.png)

当 $a=b=c=d=2$ 时，对应下面这样一个棋盘：

![](https://cdn.luogu.com.cn/upload/image_hosting/e2ntmjlk.png)

要在这个棋盘上放 $k$ 个相互不攻击的车，也就是这 $k$ 个车没有两个车在同一行，也没有两个车在同一列，问有多少种方案。

## 输入格式

只有一行，为五个非负整数，分别代表 $a,b,c,d$ 和 $k$。

## 输出格式

输出一行一个整数代表答案 $\bmod$ $10^5+3$ 后的结果。
## 样例

### 样例输入 #1
```
2 2 2 2 2
```
### 样例输出 #1
```
38

```
## 提示

#### 数据规模与约定

- 存在部分数据，保证 $b=0$；
- 存在部分数据，保证 $a,b,c,d\leq 4$。
- 对于 $100\%$ 的数据，保证 $0\leq a,b,c,d,k\leq 10^3$，且至少有一种可行方案。


---

---
title: "[yLOI2019] 青原樱"
layout: "post"
diff: 普及/提高-
pid: P5520
tag: ['动态规划 DP', '数学', '2019', 'O2优化', '组合数学', '排列组合']
---
# [yLOI2019] 青原樱
## 题目背景

> 星川之下皆萤火尘埃，  
> 我独行在人潮你天真而待。  
> 相遇若是借丹青着色，  
> 青原上 绯樱如海。

——银临《青原樱》(Cover 人衣大人)
## 题目描述

扶苏是一个非常喜欢边听古风鸽边写数学题的人，因此这道题其实是个五三原题。

扶苏希望重现青原上樱花盛开的景色，于是他准备了很多**互不相同**樱花树幼苗，准备种成一行。

这一行中，一共有 $n$ 个位置可以种下樱花，而扶苏准备了 $m$ 支幼苗。由于樱花盛放时对左右空间需求非常大，所以樱花不能紧挨着种植，也就是任意两支幼苗之间必须至少存在一个不种花的空位置。

按照这种方式种花并不难，但是令扶苏感到好奇的是一共有多少合法的方案让他把这 $m$ 支幼苗都种下去。一个方案是合法的当且仅当他满足上一段中叙述的要求。如果我们将花按照 $1,2,3,\dots,m$ 编号，两种方案不同当且仅当被选择种花的位置不同或从左向右数花的编号序列不同。

为了避免输出过大，答案对一个参数 $p$ 取模。
## 输入格式

每个输入文件中有且仅有一组测试数据。

测试数据只有一行四个整数，依次代表 $type,~n,~m,~p$，其中 $type$ 是一个帮助你判断测试点类型的参数，会在数据范围中说明。 
## 输出格式

输出一行一个整数，代表答案对 $p$ 取模的结果。

## 样例

### 样例输入 #1
```
1 3 2 19260718
```
### 样例输出 #1
```
2
```
## 提示

#### 样例输入输出 1 解释
一共有 $2$ 个樱花幼苗， $3$ 个种花的位置，如果给幼苗编号为 $1,~2$，位置编号为 $1,~2,~3$，那么两种方案分别如下：

| 位置 | $1$ | $2$ | $3$ |
| :---: | :---: | :---: | :---: |
| 方案 1 | 幼苗 $1$ | 空 | 幼苗 $2$ |
| 方案 2 | 幼苗 $2$ | 空 | 幼苗 $1$ |

---

#### 数据规模与约定

**本题采用多测试点捆绑测试，共有 6 个子任务**。

| 子任务编号 | $n \leq$ | $m \leq$ | $type=$ | 特殊性质 | 子任务分值 |
| :----------: | :--------: | :----------: | :-------: | :--------: | :-----------: |
| 1 | $1$ | $1$ | $0$ | 特殊性质 1 | $5$ |
| 2 | $20$ | $20$ | $1$ | 特殊性质 1 | $15$ |
| 3 | $400$ | $200$ | $2$ | 无 | $20$ |
| 4 | $2000$ | $2000$ | $3$ | 无 | $20$ |
| 5 | $2000000$ | $1000000$ | $4$| 特殊性质 2 | $20$ | 
| 6 | $2000000$ | $1000000$ | $5$| 无 | $20$ | 

特殊性质 1：保证对应测试点的**实际**方案数(在取模前)不超过 $10^6$

特殊性质 2：保证 $p$ 是一个质数。

对于 $100\%$ 的数据，保证：
- $1 \leq n \leq 2 \times 10^6$。
- $1 \leq m \leq 10^6 $。
- $1 \leq p \leq 10^9$。
- $1 \leq m \leq \lceil\frac{n}{2} \rceil$。

---

#### 提示

- 请使用合适的数据类型来进行运算，避免溢出。
- 参数 $type$ 可以帮助你快速的判断子任务编号。



---

---
title: "「DTOI-5」进行一个排的重 (Minimum Version)"
layout: "post"
diff: 普及/提高-
pid: P9306
tag: ['2023', '洛谷原创', 'O2优化', '排列组合', '构造']
---
# 「DTOI-5」进行一个排的重 (Minimum Version)
## 题目背景

**本题与 Maximum Version 的区别是所求最值和数据范围不同。**

小 L 热衷于重排数列使之规整。
## 题目描述

小 L 有一个长为 $n$ 的序列 $a$，其中每一项 $a_i$ 都是一个 pair $(p_i, q_i)$。

为了让 $a$ 看起来规整一些，他钦定 $p, q$ 分别均为长为 $n$ 的排列。

为了对 $a$ 的规整程度进行量化计算，他给出了一个权值函数 $f(a) = \displaystyle\sum_{i = 1}^n ([p_i > \max_{j = 1}^{i - 1} p_j] + [q_i > \max_{j = 1}^{i - 1} q_j])$。**注意 $i = 1$ 时两个方括号都能取到值，因为我们认为 $\displaystyle\max_{j = 1}^0 p_j = \displaystyle\max_{j = 1}^0 q_j = -\infty$。**

为了让 $a$ 看起来更加规整，他决定分别以某种方式重排 $a$ 得到 $a'$ 使得 $f(a')$ 最小。**注意重排时必须将 $a'_i = (p'_i, q'_i)$ 视为整体。**

他希望你求出 $f(a')_{\min}$ 的值，以及分别有多少个 $a'$ 可以取到 $f(a')_{\min}$。

由于方案数可能很大，你只需要求出结果对 $998244353$ 取模的值。
## 输入格式

第一行，一个整数 $n$；

第二行，$n$ 个整数 $p_1, p_2, \cdots, p_n$；

第三行，$n$ 个整数 $q_1, q_2, \cdots, q_n$。
## 输出格式

一行，两个整数，表示所求的值。
## 样例

### 样例输入 #1
```
5
1 5 2 4 3
1 4 2 5 3
```
### 样例输出 #1
```
3 48
```
## 提示

**【数据范围】**

$$
\def\or{\operatorname{or}}
%\def\arrayscretch{1.5}
\def\arraystretch{1.5}
\begin{array}{|c|c|c|}\hline
\textbf{Subtask}&n\le &\textbf{Points}\cr\hline
\sf1&10&10 \operatorname{pts}\cr\hline
\sf2&500&20 \operatorname{pts}\cr\hline
\sf3&5\times10^3&20 \operatorname{pts}\cr\hline
\sf4&10^5&20 \operatorname{pts}\cr\hline
\sf5&5\times10^5&30 \operatorname{pts}\cr\hline
\end{array}
$$

对于 $100\%$ 的数据，$1 \leq n \leq 5 \times 10^5$，$1 \leq p_i, q_i \leq n$，保证 $p, q$ 均为**排列**。


---


---
title: "「Cfz Round 3」Xor with Gcd"
layout: "post"
diff: 普及/提高-
pid: P10031
tag: ['数学', '洛谷原创', 'O2优化', '最大公约数 gcd', '洛谷月赛', 'Ad-hoc']
---
# 「Cfz Round 3」Xor with Gcd
## 题目背景

她是午夜潜入海风漂流的沙砾

极光与她一齐许下明日愿景

飞身电波铺满天穹而海仍平静

“愿世界都繁花似锦”
## 题目描述

给定一个整数 $n$。

你需要求出 $\bigoplus\limits_{i=1}^{n} \gcd(i,n)$，即 $\gcd(1,n) \oplus \gcd(2,n) \oplus \cdots \oplus \gcd(n,n)$ 的值。其中 $\gcd(a,b)$ 表示 $a$ 和 $b$ 的**最大公约数**，$\bigoplus$ 表示**按位异或**，即 C++ 中的 `^`。
## 输入格式

**本题有多组测试数据。**

第一行输入一个整数 $T$，表示测试数据组数。

接下来依次输入每组测试数据。对于每组测试数据，输入一行一个整数 $n$。
## 输出格式

对于每组测试数据，输出一行一个整数，表示 $\bigoplus\limits_{i=1}^{n} \gcd(i,n)$ 的值。
## 样例

### 样例输入 #1
```
3
2
3
6

```
### 样例输出 #1
```
3
3
5
```
## 提示

#### 「样例解释 #1」

对于第 $1$ 组数据，$\bigoplus\limits_{i=1}^{2} \gcd(i,2)=\gcd(1,2)\oplus\gcd(2,2)=1\oplus2=3$。

对于第 $2$ 组数据，$\bigoplus\limits_{i=1}^{3} \gcd(i,3)=\gcd(1,3)\oplus\gcd(2,3)\oplus\gcd(3,3)=1\oplus1\oplus3=3$。

#### 「数据范围」

对于所有数据，$1 \le T \le 100$，$1 \le n \le 10^{18}$。

**只有你通过本题的所有测试点，你才能获得本题的分数。**


---

---
title: "「MYOI-R3」消消乐"
layout: "post"
diff: 普及/提高-
pid: P10443
tag: ['洛谷原创', 'O2优化', '最大公约数 gcd', '洛谷月赛']
---
# 「MYOI-R3」消消乐
## 题目背景

**upd 2024/5/12 18:14：增加了两组 Hack 数据，位于 Subtask 1，分值为 $0$ 分。**

**upd 2024/5/12 21:27：增加了一组 Hack 数据，位于 Subtask 1，分值为 $0$ 分。**
## 题目描述

给定一个长度为 $n$ 的数列 $a$。

定义一次操作为选择三个整数 $x,y,z\in[1,n]$，满足 $\gcd(a_x,a_y)=a_z$ 且 $x,y,z$ 两两不同，接着消除 $a_z$（即之后的操作中不能再选择 $a_z$ 了）。

问经过若干次操作后可否消除数列 $a_1\sim a_n$ 中的 $n-2$ 个数？
## 输入格式

第一行一个正整数 $T$，表示数据组数。

对于每组数据，

第一行一个正整数 $n$。

第二行 $n$ 个正整数 $a_i$。
## 输出格式

对于每组数据，一行一个字符串 `Yes` 或 `No`。
## 样例

### 样例输入 #1
```
2
3
1 2 3
3
1 2 4
```
### 样例输出 #1
```
Yes
No
```
## 提示

### 样例解释：

- 对于第一组数据，可以通过 $(2,3)$ 消除 $1$。
- 对于第二组数据，可以证明无解。

### 数据范围：

本题共有 $20$ 个测试点，每个测试点的分值均为 $5$ 分。

对于 $100\%$ 的数据，$1\le T\le 10^5$，$2\leq n \leq 10^6$，$2 \le \sum n\le 10^6$，$1\le a_i\le 10^9$。


---

---
title: "椰子"
layout: "post"
diff: 普及/提高-
pid: P10916
tag: ['O2优化', '最大公约数 gcd']
---
# 椰子
## 题目背景

众所周知，椰子是一种椰子，但这和题目好像没什么关系。
## 题目描述

给出一个长度为 $n$ 的序列 $a$，我们保证 $1\sim n$ 中的每一个数都恰好在 $a$ 中出现了一次，对于每一个 $1\le i\le n$，求出在序列中将值为 $i$ 的数的值修改成 $1$ 后，序列有多少种不同的区间 $\gcd$ 的值。

严格来说，记将值为 $x$ 的数修改为 $1$ 后的序列为 $A^x$。集合 $S_x=\{\gcd\limits_{i=l}^r(A^x_i)|1\le l\le r\le n\}$，求出所有 $|S_i|$ 的值。
## 输入格式

第一行一个正整数 $n$，表示排列的长度。

接下来一行 $n$ 个正整数，表示序列 $a$。
## 输出格式

一行一共 $n$ 个整数，第 $i$ 个数表示在把值为 $i$ 的数改成 $1$ 后，序列有多少种不同的区间 $\gcd$ 的值。
## 样例

### 样例输入 #1
```
3
3 1 2
```
### 样例输出 #1
```
3 2 2
```
### 样例输入 #2
```
6
3 6 4 1 5 2
```
### 样例输出 #2
```
6 6 5 5 5 5
```
## 提示

### 样例解释 1

对于将 $1$ 变成 $1$，有 $\{1,2,3\}$ 共 $3$ 种不同的区间 $\gcd$ 值，分别可以对应区间 $[1,3],[3,3],[1,1]$。

对于将 $2$ 变成 $1$，有 $\{1,3\}$ 共 $2$ 种不同的区间 $\gcd$ 值，分别可以对应区间 $[2,3],[1,1]$。

对于将 $3$ 变成 $1$，有 $\{1,2\}$ 共 $2$ 种不同的区间 $\gcd$ 值，分别可以对应区间 $[1,2],[3,3]$。

### 数据规模与约定

**本题采用捆绑测试**。

| $\text{Subtask}$ | 分数 | 数据范围 | 特殊性质 |
| :-----------: | :-----------: | :-----------: | :-----------: |
| $1$ | $10$ | $n\le 20$ | 无特殊限制 |
| $2$ | $20$ | $n\le 200$ | 无特殊限制 |
| $3$ | $30$ | $n\le 2000$ | 无特殊限制 |
| $4$ | $20$ | 无特殊限制 | $A$ |
| $5$ | $20$ | 无特殊限制 | 无特殊限制 |

$A$：对于所有 $1\le i\le n$，有 $a_i=i$。

对于所有的数据，$2\le n\le 5\times 10^5$，我们保证 $1\sim n$ 中的每一个数都恰好在 $a$ 中出现了一次。


---

---
title: "[USTCPC 2025] 多边形转动"
layout: "post"
diff: 普及/提高-
pid: P12048
tag: ['数学', '2025', '最大公约数 gcd', '高校校赛']
---
# [USTCPC 2025] 多边形转动
## 题目描述

回レ回レ回レ回レ回レ回レ回レ回レ回レ！（旋转吧旋转吧旋转吧旋转吧旋转吧旋转吧旋转吧旋转吧旋转吧！）

克露丝卡尔酱特别喜欢旋转，不光是雪月花，也有好看的圆圈（并不一定绿色），更有正多边形。

现在她操控着一个边长为 $a$ 的正 $m$ 边形，绕着一个边长为 $b$ 的正 $n$ 边形**顺时针转动**。初始状态是前者紧挨着后者的一条边的一端，每次旋转以正多边形公共边上的一点为中心点。她想知道，多少次转动之后，多边形会回到原位置？（只要求多边形回到原位，不要求各条边回到原位，即边是全同的）
## 输入格式

一行四个正整数 $a,m,b,n$ $(3\leq m,n\leq 10^9, 1\leq a\leq b \leq 10^9)$，表示边长为 $a$ 的正 $m$ 边形绕着边长为 $b$ 的正 $n$ 边形转动。
## 输出格式

一个正整数表示要转几次。
## 样例

### 样例输入 #1
```
2 4 3 4
```
### 样例输出 #1
```
8
```
### 样例输入 #2
```
3 4 4 4
```
### 样例输出 #2
```
24
```
### 样例输入 #3
```
3 3 4 4
```
### 样例输出 #3
```
24
```
## 提示

样例 1 解释：
![](https://cdn.luogu.com.cn/upload/image_hosting/362c49xj.png)

样例 3 解释：

![](https://cdn.luogu.com.cn/upload/image_hosting/7tbjx06k.png)


---

---
title: "【模板】裴蜀定理"
layout: "post"
diff: 普及/提高-
pid: P4549
tag: ['数学', '最大公约数 gcd', '不定方程', 'Bézout 定理']
---
# 【模板】裴蜀定理
## 题目描述

给定一个包含 $n$ 个元素的**整数**序列 $A$，记作 $A_1,A_2,A_3,...,A_n$。

求另一个包含 $n$ 个元素的待定**整数**序列 $X$，记 $S=\sum\limits_{i=1}^nA_i\times X_i$，使得 $S>0$ 且 $S$ 尽可能的小。
## 输入格式

第一行一个整数 $n$，表示序列元素个数。  

第二行 $n$ 个整数，表示序列 $A$。
## 输出格式

一行一个整数，表示 $S>0$ 的前提下 $S$ 的最小值。
## 样例

### 样例输入 #1
```
2
4059 -1782

```
### 样例输出 #1
```
99
```
## 提示

对于 $100\%$ 的数据，$1 \le n \le 20$，$|A_i| \le 10^5$，且 $A$ 序列不全为 $0$。


---

---
title: "【XR-3】小道消息"
layout: "post"
diff: 普及/提高-
pid: P5535
tag: ['数学', 'O2优化', '素数判断,质数,筛法', '最大公约数 gcd']
---
# 【XR-3】小道消息
## 题目描述

小 X 想探究小道消息传播的速度有多快，于是他做了一个社会实验。

有 $n$ 个人，其中第 $i$ 个人的衣服上有一个数 $i+1$。小 X 发现了一个规律：当一个衣服上的数为 $i$ 的人在某一天知道了一条信息，他会在第二天把这条信息告诉衣服上的数为 $j$ 的人，其中 $\gcd(i,j)=1$（即 $i,j$ 的最大公约数为 $1$）。在第 $0$ 天，小 X 把一条小道消息告诉了第 $k$ 个人，小 X 想知道第几天时所有人都会知道这条小道消息。

可以证明，一定存在所有人都知道了这条小道消息的那一天。

提示：你可能需要用到的定理——[伯特兰-切比雪夫定理](https://baike.baidu.com/item/%E4%BC%AF%E7%89%B9%E5%85%B0-%E5%88%87%E6%AF%94%E9%9B%AA%E5%A4%AB%E5%AE%9A%E7%90%86/2053704)。
## 输入格式

一行 $2$ 个正整数 $n,k$。

**数据范围：**

- $2 \le n \le 10^{14}$。
- $1 \le k \le n$。
## 输出格式

一行一个正整数，表示答案。
## 样例

### 样例输入 #1
```
3 1

```
### 样例输出 #1
```
2

```
### 样例输入 #2
```
6 4

```
### 样例输出 #2
```
1

```
## 提示

【样例 $1$ 说明】

$3$ 个人的衣服上的数分别为 `2 3 4`。

在第 $0$ 天，小 X 把一条小道消息告诉了第 $1$ 个人，他的衣服上的数为2。

在第 $1$ 天，第 $1$ 个人会告诉第 $2$ 个人，因为 $\gcd(2,3) = 1$，但他不会告诉第 $3$ 个人，因为 $\gcd(2,4) = 2 \ne 1$。

在第 $2$ 天，第 $2$ 个人会告诉第 $3$ 个人，因为 $\gcd(3,4) = 1$，这时所有人都知道了这条小道消息，因此答案为 $2$。


---


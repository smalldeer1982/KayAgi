---
title: "[GESP202406 六级] 二叉树"
layout: "post"
diff: 普及/提高-
pid: P10722
tag: ['树形数据结构', '2024', '图遍历', '树的遍历', 'GESP']
---
# [GESP202406 六级] 二叉树
## 题目描述

小杨有⼀棵包含 $n$ 个节点的二叉树，且根节点的编号为 $1$。这棵二叉树任意⼀个节点要么是白色，要么是黑色。之后小杨会对这棵二叉树进行 $q$ 次操作，每次小杨会选择⼀个节点，将以这个节点为根的子树内所有节点的颜色反转，即黑色变成白色，白色变成黑色。

小杨想知道 $q$ 次操作全部完成之后每个节点的颜色。
## 输入格式

第⼀行一个正整数 $n$，表示二叉树的节点数量。

第二行 $(n-1)$ 个正整数，第 $i$（$1\le i\le n-1$）个数表示编号为 $(i+1)$ 的节点的父亲节点编号，数据保证是⼀棵二叉树。

第三行一个长度为 $n$ 的 $\texttt{01}$ 串，从左到右第 $i$（$1\le i\le n$）位如果为 $\texttt{0}$，表示编号为 $i$ 的节点颜色为白色，否则为黑色。

第四行⼀个正整数 $q$，表示操作次数。

接下来 $q$ 行每行⼀个正整数 $a_i$（$1\le a_i\le n$），表示第 $i$ 次操作选择的节点编号。
## 输出格式

输出一行一个长度为 $n$ 的 $\texttt{01}$ 串，表示 $q$ 次操作全部完成之后每个节点的颜色。从左到右第 $i$（$1\le i\le n$） 位如果为 $\texttt{0}$，表示编号为 $i$ 的节点颜色为白色，否则为黑色。
## 样例

### 样例输入 #1
```
6
3 1 1 3 4
100101
3
1
3
2
```
### 样例输出 #1
```
010000
```
## 提示

#### 样例解释

第一次操作后，节点颜色为：$\texttt{011010}$

第二次操作后，节点颜色为：$\texttt{000000}$

第三次操作后，节点颜色为：$\texttt{010000}$

#### 数据范围

| 子任务编号 | 得分 | $n$ | $q$ | 特殊条件 |
| :--: | :--: | :--: | :--: | :--: |
| $1$ |  $20$ | $\le 10^5$ | $\le 10^5$ |对于所有 $i\ge 2$，节点 $i$ 的父亲节点编号为 $i-1$
| $2$ |  $40$ | $\le 1000$ | $\le 1000$ | |
| $3$ | $40$ | $\le 10^5$ | $\le 10^5$ | |

对于全部数据，保证有 $n,q\le 10^5$。


---

---
title: "遍历问题"
layout: "post"
diff: 普及/提高-
pid: P1229
tag: ['树形数据结构']
---
# 遍历问题
## 题目描述

我们都很熟悉二叉树的前序、中序、后序遍历，在数据结构中常提出这样的问题：已知一棵二叉树的前序和中序遍历，求它的后序遍历，相应的，已知一棵二叉树的后序遍历和中序遍历序列你也能求出它的前序遍历。然而给定一棵二叉树的前序和后序遍历，你却不能确定其中序遍历序列，考虑如下图中的几棵二叉树：

![](https://cdn.luogu.com.cn/upload/image_hosting/w75s9yip.png)

所有这些二叉树都有着相同的前序遍历和后序遍历，但中序遍历却不相同。


## 输入格式

共两行，第一行表示该二叉树的前序遍历结果 $s_1$，第二行表示该二叉树的后序遍历结果 $s_2$。


保证至少存在一棵二叉树满足给出的信息，$s _ 1, s _ 2$ 中只含小写字母，且在某个字符串中不存在相同的字母。
## 输出格式

输出可能的中序遍历序列的总数，结果不超过 $2^{63}-1$。

## 样例

### 样例输入 #1
```
abc                           
cba

```
### 样例输出 #1
```
4
```


---

---
title: "医院设置"
layout: "post"
diff: 普及/提高-
pid: P1364
tag: ['动态规划 DP', '树形数据结构', '广度优先搜索 BFS', '最短路']
---
# 医院设置
## 题目描述

设有一棵二叉树，如图：

![](https://cdn.luogu.com.cn/upload/image_hosting/kawht13x.png)

其中，圈中的数字表示结点中居民的人口。圈边上数字表示结点编号，现在要求在某个结点上建立一个医院，使所有居民所走的路程之和为最小，同时约定，相邻接点之间的距离为 $1$。如上图中，若医院建在 $1$ 处，则距离和 $=4+12+2\times20+2\times40=136$；若医院建在 $3$ 处，则距离和 $=4\times2+13+20+40=81$。
## 输入格式

第一行一个整数 $n$，表示树的结点数。

接下来的 $n$ 行每行描述了一个结点的状况，包含三个整数 $w, u, v$，其中 $w$ 为居民人口数，$u$ 为左链接（为 $0$ 表示无链接），$v$ 为右链接（为 $0$ 表示无链接）。
## 输出格式

一个整数，表示最小距离和。

## 样例

### 样例输入 #1
```
5						
13 2 3
4 0 0
12 4 5
20 0 0
40 0 0

```
### 样例输出 #1
```
81
```
## 提示

#### 数据规模与约定

对于 $100\%$ 的数据，保证 $1 \leq n \leq 100$，$0 \leq u, v \leq n$，$1 \leq w \leq 10^5$。


---

---
title: "会议"
layout: "post"
diff: 普及/提高-
pid: P1395
tag: ['图论', '树形数据结构', '福建省历届夏令营']
---
# 会议
## 题目描述

有一个村庄居住着 $n$ 个村民，有 $n-1$ 条路径使得这 $n$ 个村民的家联通，每条路径的长度都为 $1$。现在村长希望在某个村民家中召开一场会议，村长希望所有村民到会议地点的距离之和最小，那么村长应该要把会议地点设置在哪个村民的家中，并且这个距离总和最小是多少？若有多个节点都满足条件，则选择节点编号最小的那个点。
## 输入格式

第一行，一个数 $n$，表示有 $n$ 个村民。

接下来 $n-1$ 行，每行两个数字 $a$ 和 $b$，表示村民 $a$ 的家和村民 $b$ 的家之间存在一条路径。
## 输出格式

一行输出两个数字 $x$ 和 $y$。

$x$ 表示村长将会在哪个村民家中举办会议。

$y$ 表示距离之和的最小值。
## 样例

### 样例输入 #1
```
4
1 2 
2 3 
3 4 

```
### 样例输出 #1
```
2 4
```
## 提示

#### 数据范围

对于 $70\%$ 数据 $n \le 10^3$。

对于 $100\%$ 数据 $n \le 5 \times 10^4$。


---

---
title: "扩散"
layout: "post"
diff: 普及/提高-
pid: P1661
tag: ['图论', '树形数据结构', '二分']
---
# 扩散
## 题目描述

一个点每过一个单位时间就会向四个方向扩散一个距离，如图。

![](https://cdn.luogu.com.cn/upload/image_hosting/cd4e53lw.png)

两个点 $a$ 、 $b$ 连通，记作 $e(a,b)$，当且仅当 $a,b$ 的扩散区域有公共部分。连通块的定义是块内的任意两个点 $u,v$ 都必定存在路径 $e(u,a_0),e(a_0,a_1),\cdots,e(a_k,v)$。给定平面上的 $n$ 个点，问最早什么时刻它们形成一个连通块。

## 输入格式

第一行一个数 $n$，以下 $n$ 行，每行一个点坐标。
## 输出格式

一个数，表示最早的时刻所有点形成连通块。

## 样例

### 样例输入 #1
```
2

0 0

5 5
```
### 样例输出 #1
```
5
```
## 提示

### 数据范围及约定

对于 $20\%$ 的数据，满足 $1 \le N \le 5;1 \le X_i,Y_i \le 50$。

对于 $100\%$ 的数据，满足 $1 \le N \le 50$，$1 \le X_i,Y_i \le 10^9$。


---

---
title: "洛谷的文件夹"
layout: "post"
diff: 普及/提高-
pid: P1738
tag: ['模拟', '字符串', '树形数据结构', '洛谷原创', '枚举']
---
# 洛谷的文件夹
## 题目描述

kkksc03 是个非凡的空想家！在短时间内他设想了大量网页，然后总是交给可怜的 lzn 去实现。

洛谷的网页端，有很多文件夹，文件夹还套着文件夹。

例如：$\verb!/luogu/application/controller!$ 表示根目录下有一个名称为 $\verb!luogu!$ 的文件夹，这个文件夹下有一个名称 $\verb!application!$ 的文件夹，其中还有名为 $\verb!controller!$ 的文件夹。

每个路径的第 $1$ 个字符总是 $\verb!/!$，且没有两个连续的 $\verb!/!$，最后的字符不是 $\verb!/!$。所有名称仅包含数字和小写字母。

目前根目录是空的。kkksc03 想好了很多应该有的文件夹路径名。问题是，需要是使这些文件夹都存在，需要新建几个文件夹呢？

## 输入格式

输入文件第 $1$ 行为一个正整数 $N$。

接下来 $N$ 行，每行为一个描述路径的字符串，长度均不超过 $100$。
## 输出格式

输出应包含 $N$ 行，每行 $1$ 个正整数，第 $i$ 行输出若要使第 $1$ 个路径到第 $i$ 个路径存在，最少需要新建多少个文件夹。
## 样例

### 样例输入 #1
```
2
/luogu/application/controller
/luogu/application/view

```
### 样例输出 #1
```
3
4

```
### 样例输入 #2
```
3
/chicken
/chicken/egg
/chicken
```
### 样例输出 #2
```
1
2
2
```
### 样例输入 #3
```
4
/a
/a/b
/a/c
/b/b
```
### 样例输出 #3
```
1
2
3
5
```
## 提示

### 数据范围及约定


- 对于 $20\%$ 数据，有 $N \le 20$；
- 对于 $50\%$ 数据，有 $N \le 200$；
- 另有 $30\%$ 数据，有对于所有路径最多存在两个 $\verb!/!$（包含第 $1$ 个字符）；
- 对于所有数据，$N \le 1000$。


---

---
title: "女仆咖啡厅桌游吧"
layout: "post"
diff: 普及/提高-
pid: P1922
tag: ['动态规划 DP', '树形数据结构']
---
# 女仆咖啡厅桌游吧
## 题目背景

小 v 带萌萌的妹妹去玩，妹妹想去女仆咖啡馆，小 v 想去桌游吧。

妹妹：“我问你个问题，答不对你就做我一天的奴隶，答对了就今天我就全部听你的。”

小 v ：“全部都听!?”

妹妹：“嘻嘻嘻，你还是回答问题吧！”

于是小 v 为了自己一天的幸福，来向你求助。
## 题目描述

小 v 所在的世界被规划成了树形结构，每一个节点上都可以建一个女仆咖啡厅或者桌游吧或者什么都不建。在确定点 $1$ 为根节点之后，规划局要求：对于每一个非叶子的节点 $i$，设它子树（包括自己）中所有的女仆咖啡厅的数量为 $cafe_i$，桌游吧数目为 $table_i$，都有 $cafe_i=table_i$。

妹妹的问题是：这颗树最多能放多少个女仆咖啡厅。

## 输入格式

输入的第一行是，一个正整数 $n$，表示世界节点数。

第 $2$ 至 $n$ 行，每行两个正整数 $u$，$v$，表示 $u$ 与 $v$ 间有一条边。
## 输出格式

只有一行，最多能放的女仆咖啡厅的个数。

## 样例

### 样例输入 #1
```
5
1 2
2 3
3 4
2 5

```
### 样例输出 #1
```
2
```
## 提示

#### 数据规模与约定

- 对于 $30\%$ 的数据，保证 $n\le20$。
- 对于 $100\%$ 的数据，保证 $1\le n\le10^5$，$1 \leq u, v \le n$。


---

---
title: "[NOI2011] 道路修建"
layout: "post"
diff: 普及/提高-
pid: P2052
tag: ['树形数据结构', '2011', 'NOI', '广度优先搜索 BFS', '深度优先搜索 DFS']
---
# [NOI2011] 道路修建
## 题目描述

在 W 星球上有 $n$ 个国家。为了各自国家的经济发展，他们决定在各个国家之间建设双向道路使得国家之间连通。但是每个国家的国王都很吝啬，他们只愿意修建恰好 $n - 1$ 条双向道路。

每条道路的修建都要付出一定的费用，这个费用等于道路长度乘以道路两端 的国家个数之差的绝对值。例如，在下图中，虚线所示道路两端分别有 $2$ 个、$4$ 个国家，如果该道路长度为 $1$，则费用为 $1×|2 - 4|=2$。图中圆圈里的数字表示国家的编号。
 
 ![](https://cdn.luogu.com.cn/upload/pic/2604.png) 

由于国家的数量十分庞大，道路的建造方案有很多种，同时每种方案的修建费用难以用人工计算，国王们决定找人设计一个软件，对于给定的建造方案，计算出所需要的费用。请你帮助国王们设计一个这样的软件。

## 输入格式

输入的第一行包含一个整数 $n$，表示 W 星球上的国家的数量，国家从 $1$ 到 $n$ 编号。

接下来 $n–1$ 行描述道路建设情况，其中第 $i$ 行包含三个整数 $a_i,b_i$ 和 $c_i$，表示第 $i$ 条双向道路修建在 $a_i$ 与 $b_i$ 两个国家之间，长度为 $c_i$。

## 输出格式

输出一个整数，表示修建所有道路所需要的总费用。

## 样例

### 样例输入 #1
```
6
1 2 1
1 3 1
1 4 2
6 3 1
5 2 1
```
### 样例输出 #1
```
20
```
## 提示

对于 $100\%$ 的数据，$1\leq a_i, b_i\leq n$，$0\leq c_i\leq10^6$，$2\leq n\leq 10^6$。
|测试点编号|$n=$|
|:-:|:-:|
|$1$|$2$|
|$2$|$10$|
|$3$|$100$|
|$4$|$200$|
|$5$|$500$|
|$6$|$600$|
|$7$|$800$|
|$8$|$1000$|
|$9$|$10^4$|
|$10$|$2\times 10^4$|
|$11$|$5\times 10^4$|
|$12$|$6\times 10^4$|
|$13$|$8\times 10^4$|
|$14$|$10^5$|
|$15$|$6\times 10^5$|
|$16$|$7\times 10^5$|
|$17$|$8\times 10^5$|
|$18$|$9\times 10^5$|
|$19,20$|$10^6$|




---

---
title: "找人"
layout: "post"
diff: 普及/提高-
pid: P2083
tag: ['搜索', '树形数据结构', '洛谷原创']
---
# 找人
## 题目描述

小明要到他的同学家玩，可他只知道他住在某一单元，却不知住在哪个房间。那个单元有 $n$ 层（$1,2,\ldots,n$），每层有 $m$（$1,2,\ldots,m$）个房间。

小明会从第一层的某个房间开始找，他找的方式也很特别，每次到了一个房间，如果不是他的同学，他就会询问这个人，然后他就会去那人告诉他的房间号，如果还不是，他就会继续按这个方法找下去，直到找到。当然，他也有可能找不到同学。他的体力也是有限的，他每爬一层楼梯就会消耗 $v$ 体力值。你的任务就是求找到同学耗费的最少体力值，如果找不到，就输出 `impossible` 。
## 输入格式

第一行有五个整数，分别代表 $n$，$m$，$v$，$x$，$y$（$x$，$y$ 表示同学只在 $x$ 层 $y$ 房间）。

$2\sim n+1$ 行，每行 $m\times 2$ 个数字，第 $i+1$ 行 $j\times2-1$ 个数 $a_k$ 和第 $j\times2$ 个数 $a_{k+1} $表示住在 $i$ 层 $j$ 房间的人提供的信息是 $a_k$ 层和 $a_{k+1}$ 房间。（同学的信息就是自己的房间号。）

## 输出格式

一个数，即答案。

## 样例

### 样例输入 #1
```
3 3 2 2 3
1 3 3 3 2 1
2 3 1 1 2 3
1 1 1 2 2 3

```
### 样例输出 #1
```
2
```
## 提示

#### 数据规模与约定

对于 $100\%$ 的数据，$1 \leq n\le1000$，$1 \leq m\le100$，$1 \leq v\le50$。


---

---
title: "Hz吐泡泡"
layout: "post"
diff: 普及/提高-
pid: P2171
tag: ['树形数据结构', '递归']
---
# Hz吐泡泡
## 题目背景

Hz大大是一种可爱的动物（神）。他很喜欢吐泡泡（更喜欢写作业）。

## 题目描述

这天，Hz大大心血来潮，吐了n个不同的泡泡玩（保证没有重复的泡泡）。因为他还要写作业，所以他请你帮他把这些泡泡排序成树（左子树<=根<右子树）。输出它的后序遍历。

## 输入格式

共2行。

第一行，1个整数n。(1<=n<=300000)

第二行，n个数，代表泡泡的大小。

## 输出格式

共2行。

第一行，输出树的深度。

第二行，输出数的后序遍历。

详见样例输出。

## 样例

### 样例输入 #1
```
8
1 4 3 9 10 35 2 7

```
### 样例输出 #1
```
deep=5
2
3
7
35
10
9
4
1

```
## 提示

水题一道。



---

---
title: "让我们异或吧"
layout: "post"
diff: 普及/提高-
pid: P2420
tag: ['树形数据结构', '洛谷原创', '深度优先搜索 DFS']
---
# 让我们异或吧
## 题目描述

异或是一种神奇的运算,大部分人把它总结成不进位加法.

在生活中 xor 运算也很常见。比如，对于一个问题的回答，是为 $1$，否为 $0$，那么：

（$A$ 是否是男生）xor（$B$ 是否是男生）＝ $A$ 和 $B$ 是否能够成为情侣

好了，现在我们来制造和处理一些复杂的情况。比如我们将给出一颗树，它很高兴自己有 $N$ 个结点。树的每条边上有一个权值。我们要进行 $M$ 次询问，对于每次询问，我们想知道某两点之间的路径上所有边权的异或值。

## 输入格式

输入文件第一行包含一个整数 $N$ ，表示这颗开心的树拥有的结点数，以下有 $N-1$ 行，描述这些边，每行有3个数，$u,v,w$，表示 $u$ 和 $v$ 之间有一条权值为 $w$ 的边。接下来一行有一个整数 $M$，表示询问数。之后的 $M$ 行，每行两个数 $u,v$，表示询问这两个点之间的路径上的权值异或值。

## 输出格式

输出 $M$ 行，每行一个整数，表示异或值

## 样例

### 样例输入 #1
```
5
1 4 9644
2 5 15004
3 1 14635
5 3 9684
3
2 4
5 4
1 1

```
### 样例输出 #1
```
975
14675
0

```
## 提示

对于 $40\%$ 的数据，有 $1 \le N,M \le 3000$；  
对于 $100\%$ 的数据，有 $1 \le N ,M\le 100000$。

保证边权在 `int` 范围内。


---

---
title: "英语1（eng1）- 英语作文"
layout: "post"
diff: 普及/提高-
pid: P2786
tag: ['字符串', '树形数据结构', '平衡树', '洛谷原创']
---
# 英语1（eng1）- 英语作文
## 题目背景

蒟蒻 HansBug 在英语考场上，挠了无数次的头，可脑子里还是一片空白。
## 题目描述

眼下出现在 HansBug 蒟蒻面前的是一篇英语作文，然而智商捉急的 HansBug 已经草草写完了，此时他发现离考试结束还有 $40$ 分钟，于是他打算估计一下这篇共有 $M$ 个单词的英语作文的含金量如何。众所周知的是，在中高考英语作文中使用高级词汇可以有效提高文章的含金量，从而获得更好的分数。已知蒟蒻HansBug知道 $N$ 个高级词汇，该词汇为 $A_i$（词汇长度为 $L_i$ ，包含数字、大小写字母），该高级词汇的含金量为 $B_i$，则该高级词汇每出现一次便可增加 $B_i$ 的含金量。可是他脑细胞和 RP 已经消耗殆尽，所以这个伟大的任务就交给你啦！
## 输入格式

第一行包含两个整数 $N$ 和 $P$ ， $N$ 表示HansBug共知道的高级词汇个数， $P$ 为模数

第 $2-N+1$行，每行包含一个单词 $A_i$ （长度为Li）和一个整数 $B_i$ ，其中 $B_i(0<B_i\le 10^5)$ 表示该单词的含金量

接下来直到输入结束的若干行为一篇英语作文，其中包含共计 $M$ 个单词，以及若干的分隔符（分隔符包含且仅包含`,`、`.`、`!`、`?`）
## 输出格式

一行，包含一个整数，为该文章的总含金量对 $P$ 的模。
## 样例

### 样例输入 #1
```
5 99
hansbug 1
kkksc03 2
yyy 3
absi2011 4
lzn 100
hansbug is a juruo!but absi2011 not.!?!
one day absi2011 laughed at yyy and hansbug.
then kkksc03 and lzn blamed him for that.

```
### 样例输出 #1
```
16
```
### 样例输入 #2
```
5 99
yyyy 1
kkksc03 2
yyy 3
absi2011 4
lzn 100
yyyy is a juruo!but absi2011 not.!?!
one day absi2011 laughed at yyy and yyyy.
then kkksc03 and lzn blamed him for that.

```
### 样例输出 #2
```
16
```
## 提示

样例 $1$ 中，共计出现了 $2$ 次`hansbug`、 $2$ 次`absi2011` 、 $1$ 次 `yyy` 、 $1$ 次`kkksc03`、 $1$ 次  `lzn` ，所以总含金量为 $1\times2+2\times4+3\times1+4\times1+100\times1=115$，对 $99$ 取模就是 $16$ 。

样例 $2$ 中，和样例 $1$ 基本一样，值得注意的是整体的 `yyyy` 不可以被认为是 `yyy` 出现 $2$ 次，请注意这是一篇英语作文，一切以单词为最小单位。

此题目中大小写敏感。

数据范围（设所有单词的最大长度为 $Lmax$ ）：

![](https://cdn.luogu.com.cn/upload/pic/2228.png)



---

---
title: "树的分解"
layout: "post"
diff: 普及/提高-
pid: P3915
tag: ['贪心', '树形数据结构', '深度优先搜索 DFS']
---
# 树的分解
## 题目描述

给出 $N$ 个点的树和 $K$，问能否把树划分成 $\frac{N}{K}$ 个连通块，且每个连通块的点数都是 $K$。
## 输入格式

第一行，一个整数 $T$，表示数据组数。接下来 $T$ 组数据，对于每组数据：

第一行，两个整数 $N, K$。

接下来 $N - 1$ 行，每行两个整数 $A_i, B_i$，表示边 $(A_i, B_i)$。点用 $1, 2, \ldots, N$ 编号。
## 输出格式

对于每组数据，输出 `YES` 或 `NO`。
## 样例

### 样例输入 #1
```
2
4 2
1 2
2 3
3 4
4 2
1 2
1 3
1 4

```
### 样例输出 #1
```
YES
NO
```
## 提示

- 对于 $60 \%$ 的数据，$1 \le N, K \le 10^3$；
- 对于 $100 \%$ 的数据，$1 \le T \le 10$，$1 \le N ,K \le 10^5$。


---

---
title: "「DTOI-5」3-1"
layout: "post"
diff: 普及/提高-
pid: P9304
tag: ['树形数据结构', 'O2优化', '深度优先搜索 DFS', '树的遍历']
---
# 「DTOI-5」3-1
## 题目背景

——『太阳』这种东西，以前似乎是存在的。

传说是这么讲的——白色的火焰发出闪耀的光芒，天空则是清澄无比的蔚蓝。

据说诸神与其创造物所掀起的『大战』，使得大地化为焦土，灰烬遮蔽了苍穹。

灰烬冲击到天上流动的星辰之力——精灵回廊，发出了光芒，将天空染成红色。

而那样的红色，覆盖了仍然持续着互相残杀的每一块土地。

或者那是这个星球本身发出的悲鸣与流出的鲜血吧……

血色的天空上，只有——蓝色的灰飘然落下。

~~回来吧3579，我最骄傲的信仰/ll~~
## 题目描述

里克在视线可及的范围内发现了一颗古老的「神树」。

神树是一颗树，树上有 $n$ 个含有魔法装置的位置。经过初步「考察」，有 $n - 1$ 条魔法连接，第 $i(1 \leq i \leq n - 1)$ 条连接 $u_i, v_i$ 两个魔法装置，保证 $u_i \neq v_i$ 且 $1\leq u_i,v_i\leq n$。这两个装置可以相互**双向地**在 $1$ 单位时间内通行，保证仅由这 $n - 1$ 条连接，每个魔法装置都可以相互到达。

此外，有 $n - 1$ 条特殊连接，对于每个魔法装置 $i \in [2, n]$，可以**瞬间**传送到第 $1$ 个魔法装置，花费 $0$ 单位时间。**特殊连接总共只能使用一次**。

里克初始在魔法装置 $1$ 处。现在，给出这棵「神树」的结构，里克想要在若干时间内研究尽可能多的魔法装置。我们假定，研究一个魔法装置只需要到达该装置处，并且不需要花费额外时间。

里克想让你尽快计算出，对所有 $k \in [1, n]$，如果要恰好研究 $k$ 个不同的魔法装置，**并且随之返回魔法装置 $\bm 1$**，最少应花费多少时间。
## 输入格式

第一行，一个整数 $n$。

接下来 $n - 1$ 行，每行两个整数 $u_i, v_i$。
## 输出格式

共 $n$ 行，第 $i$ 行一个整数表示 $k = i$ 的答案。
## 样例

### 样例输入 #1
```
5
1 2
1 3
2 4
2 5
```
### 样例输出 #1
```
0
1
2
4
6
```
### 样例输入 #2
```
见下发的 hope/hope2.in
```
### 样例输出 #2
```
见下发的 hope/hope2.ans
```
## 提示

**【样例解释 $\bm 1$】**

+ $k = 1$ 时，里克只需要呆在装置 $1$ 处。
+ $k = 2$ 时，里克的路径可以是 $1 \rightarrow 2 \Rightarrow 1$。
+ $k = 3$ 时，里克的路径可以是 $1 \rightarrow 2 \rightarrow 4 \Rightarrow 1$。
+ $k = 4$ 时，里克的路径可以是 $1 \rightarrow 2 \rightarrow 4 \Rightarrow 1 \rightarrow 3\rightarrow 1$。
+ $k = 5$ 时，里克的路径可以是 $1 \rightarrow 3\rightarrow 1 \rightarrow 2 \rightarrow 5 \rightarrow 2 \rightarrow 4 \Rightarrow 1$。

**【样例解释 $\bm 2$】**

这组数据满足测试点编号 $13 \sim 20$ 的性质。

**【数据规模与约定】**

| 测试点编号 | 特殊限制 |
| :--------: | :------: |
| $1 \sim 2$ | $n = 3$ |
| $3 \sim 4$ | $n = 5$ |
| $5 \sim 6$ | $n = 100$ |
| $7 \sim 8$ | $n = 1000$ |
| $9 \sim 10$ | $u_i = 1, v_i = i + 1$ |
| $11 \sim 12$ | $u_i = i, v_i = i + 1$ |
| $13 \sim 20$ | 无特殊限制 |

对于所有数据，$1 \leq n \leq 10^5$，$1 \leq u_i, v_i \leq n$。


---


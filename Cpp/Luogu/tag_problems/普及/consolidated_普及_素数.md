---
title: "分解质因子 3"
layout: "post"
diff: 普及/提高-
pid: B3716
tag: ['O2优化', '素数判断,质数,筛法']
---
# 分解质因子 3
## 题目描述

给定一个正整数 $n$，设 $n = p_1 \times p_2 \times \dots p_k$，其中 $p_i$ 均为质数，对 $1 \leq i < k$，$p_i \leq p_{i + 1}$。

可以证明，序列 $p_i$ 是唯一的。

对每个给定的 $n$，请你求出 $p_1, p_2, \dots p_k$。

为了避免输出过大，请你输出 $p_1, p_2, \dots p_k$ 的**按位异或和**。
## 输入格式

**本题单测试点内有多组测试数据**。

第一行是一个整数，表示测试数据组数 $T$。

接下来 $T$ 行，每行一个整数，表示一组数据的 $n$。
## 输出格式

对每组测试数据，输出一行一个整数，表示它所有质因子的按位异或和。
## 样例

### 样例输入 #1
```
2
3
9
```
### 样例输出 #1
```
3
0
```
## 提示

### 数据规模与约定

对于全部的测试点，保证 $1 \leq T \leq 10^6$，$2 \leq n \leq 10^8$。

### 提示

请注意大量数据读入输出对程序效率造成的影响，选择合适的 IO 方式，避免超时。


---

---
title: "[NICA #1] 乘只因"
layout: "post"
diff: 普及/提高-
pid: B3801
tag: ['数论', 'O2优化', '素数判断,质数,筛法', 'Stirling 数']
---
# [NICA #1] 乘只因
## 题目背景

咯咯咯（只因叫）。
## 题目描述


给定 $n,k$，请统计有多少个长度为 $k$ 的序列 $[a_1,a_2,\dots,a_k]$ 满足：

- $a_1\times a_2\times a_3\times \dots\times a_k=n$。
- $1<a_1\leq a_2\leq a_3\leq \dots\leq a_k$。
- 这 $k$ 个数的最小公倍数等于 $n$。

## 输入格式

本题多测，共 $T$ 组数据。

第一行一个正整数 $T$，表示数据组数。

对于每组数据，包含一行两个正整数 $n, k$。

## 输出格式

共 $T$ 行。

每行一个数，第 $i$ 行表示第 $i$ 组数据的答案。

## 样例

### 样例输入 #1
```
1
10 2

```
### 样例输出 #1
```
1
```
## 提示

#### 【样例解释】

- 只能拆分为 $2\times 5$。
- $2$ 和 $5$ 的最小公倍数为 $10$。

#### 【数据范围】

对于 $100\%$ 的数据，满足 $n,k\leq 10^7$，$T\leq 10^5$。


---

---
title: "[蓝桥杯青少年组省赛 2023] 质因数的个数"
layout: "post"
diff: 普及/提高-
pid: B4272
tag: ['2023', '素数判断,质数,筛法', '蓝桥杯青少年组']
---
# [蓝桥杯青少年组省赛 2023] 质因数的个数
## 题目背景

- **因数**：又称为约数，如果整数 $a$ 除以整数 $b(b\neq 0)$ 的商正好是整数而没有余数，我们就说 $b$ 是 $a$ 的因数。
- **质数**：又称为素数，一个大于 $1$ 的自然数，除了 $1$ 和它自身外，不能被其他自然数整除的数叫做质数。$2$ 是最小的质数。
- **质因数**：如果一个数 $a$ 的因数 $b$ 同时也是质数，那么 $b$ 就是 $a$ 的一个质因数，例如：$8=2\times 2\times2$，$2$ 就是 $8$ 的质因数；$12=2\times 2\times 3$，$2$ 和 $3$ 就是 $12$ 的质因数。

## 题目描述

给定两个正整数 $N$ 和 $M(1\leq N\leq M\leq 10^7)$，统计 $N$ 到 $M$ 之间（含 $N$ 和 $M$）每个数所包含的质因数的个数，输出其中最大的个数。

例如：
当 $N=6,M=10$，$6$ 到 $10$ 之间：
- $6$ 的质因数是 $2,3$，共有 $2$ 个；
- $7$ 的质因数是 $7$，共有 $1$ 个；
- $8$ 的质因数是 $2,2,2$，共有 $3$ 个；
- $9$ 的质因数是 $3,3$，共有 $2$ 个；
- $10$ 的质因数是 $2,5$，共有 $2$ 个；

$6$ 到 $10$ 之间的数中质因数最多的是 $8$，质因数有 $3$ 个，故输出 $3$。
## 输入格式

输入两个正整数 $N$ 和 $M(1\leq N\leq M\leq 10^7)$，两个正整数之间用一个空格隔开。
## 输出格式

输出一个整数，表示质因数个数中的最大值。
## 样例

### 样例输入 #1
```
6 10
```
### 样例输出 #1
```
3
```


---

---
title: "[蓝桥杯青少年组国赛 2024] 第三题"
layout: "post"
diff: 普及/提高-
pid: B4308
tag: ['2024', '素数判断,质数,筛法', '蓝桥杯青少年组']
---
# [蓝桥杯青少年组国赛 2024] 第三题
## 题目描述

因数：也称约数。如果整数 $a$ 除以整数 $b$，商为整数且余数为 $0$，则称 $b$ 是 $a$ 的因数。例如：$1$、$2$、$3$、$6$ 都是 $6$ 的因数。

素数：也称质数，是指在大于 $1$ 的自然数中，除了 $1$ 和它本身以外没有其他因数的数。例如：$2$、$3$、$5$ 是素数，$4$、$6$、$8$ 不是素数。

平方数：指的是可以写成某个整数的平方的数。例如：$4$（$2^2$）、$9$（$3^2$）、$16$（$4^2$）都是平方数。

莫比乌斯函数 $\mu(n)$ 定义如下：
1. 若 $n = 1$，则 $\mu(n) = 1$；
2. 若 $n$ 的因数中有大于 $1$ 的平方数，则 $\mu(n) = 0$；
3. 若 $n$ 的因数中没有大于 $1$ 的平方数，且 $n = P_1 \times P_2 \times \cdots \times P_k$（其中 $P_1, P_2, \ldots, P_k$ 为 $k$ 个不同的素数），则 $\mu(n) = (-1)^k$。

例如：
- $8$ 的因数有 $1$、$2$、$4$、$8$，其中大于 $1$ 的平方数有 $4$，所以 $\mu(8) = 0$；
- $15$ 的因数有 $1$、$3$、$5$、$15$，没有大于 $1$ 的平方数，且 $15 = 3 \times 5$，所以 $\mu(15) = (-1)^2 = 1$；
- $30$ 的因数有 $1$、$2$、$3$、$5$、$6$、$10$、$15$、$30$，没有大于 $1$ 的平方数，且 $30 = 2 \times 3 \times 5$，所以 $\mu(30) = (-1)^3 = -1$。

给定两个正整数 $m$ 和 $n$，请计算 $m$ 到 $n$ 之间（含 $m$ 和 $n$）所有整数的莫比乌斯函数值之和。
## 输入格式

一行输入两个正整数 $m$ 和 $n$（$1 \leq m \leq n \leq 2 \times 10^7$），整数之间以一个空格隔开。
## 输出格式

输出一个整数，表示 $m$ 到 $n$ 之间（含 $m$ 和 $n$）所有整数的莫比乌斯函数值之和。

## 样例

### 样例输入 #1
```
1 10
```
### 样例输出 #1
```
-1
```


---

---
title: "[蓝桥杯 2023 国 Java A] X 质数"
layout: "post"
diff: 普及/提高-
pid: P12233
tag: ['2023', '素数判断,质数,筛法', '蓝桥杯国赛']
---
# [蓝桥杯 2023 国 Java A] X 质数
## 题目描述

对于一个含有 $M$ 个数位的正整数 $N$，任意选中其中 $K$ 个不同的数位（$0 \leq K < M$），将这些选中的数位删除之后，余下的数位按照原来的顺序组成了一个新的数字 $P$。如果至少存在一个 $P$ 是质数，我们就称 $N$ 是一个 X 质数。例如，对于整数 $7869$，我们可以删去 $7$ 和 $6$，得到一个新的数字 $89$，由于 $89$ 是一个质数，因此 $7869$ 是一个 X 质数。又如，对于整数 $77$，可以删去一个 $7$ 后变为质数 $7$，因此 $77$ 也是一个 X 质数。

请问 $1$（含）至 $1\,000\,000$（含）中一共有多少个不同的 X 质数。
## 输出格式

这是一道结果填空的题，你只需要算出结果后提交即可。本题的结果为一个整数，在提交答案时只需要**编写一个程序输出这个整数**，输出多余的内容将无法得分。


---

---
title: "[蓝桥杯 2023 国 Java A] 躲炮弹"
layout: "post"
diff: 普及/提高-
pid: P12235
tag: ['2023', '素数判断,质数,筛法', '蓝桥杯国赛']
---
# [蓝桥杯 2023 国 Java A] 躲炮弹
## 题目描述

小蓝正在玩一个躲炮弹的游戏。游戏中有一个人物和一个炮塔，它们的初始距离为 $n$。

炮塔可能选择在区间 $[L, R]$ 上的任意一个整数 $x$，然后发射的炮弹会飞向小蓝操控的人物。但炮弹只会在飞出 $x$ 的倍数的距离（$x, 2x, 3x, \ldots$）时落地，然后弹回到空中。如果小蓝操控的人物恰好站在了炮弹落地的位置，那么游戏就会结束。

小蓝只能在炮弹发射前移动他的人物，每移动一步，可以使得人物和炮塔的距离增加 $1$ 或者减少 $1$。他想知道最少要移动多少步才能保证自己的人物一定能躲过炮弹。
## 输入格式

输入一行包含三个整数 $n, L, R$，相邻的整数之间使用一个空格分隔。
## 输出格式

输出一行包含一个整数，表示小蓝操纵的人物最少需要移动的步数。
## 样例

### 样例输入 #1
```
10 2 13
```
### 样例输出 #1
```
7
```
## 提示

### 评测用例规模与约定

- 对于 $40\%$ 的评测用例，$n, L, R \leq 10^6$；
- 对于所有评测用例，$1 \leq n, L, R \leq 10^9$，$2 \leq L \leq R$。


---

---
title: "[蓝桥杯 2024 国 Python B] 儿童数"
layout: "post"
diff: 普及/提高-
pid: P12267
tag: ['2024', '数论', '素数判断,质数,筛法', '蓝桥杯国赛']
---
# [蓝桥杯 2024 国 Python B] 儿童数
## 题目描述

若一个正整数 $n$ 满足 $n^{61}$ 整除 $2024!$，即 $2024!$ 除以 $n^{61}$ 的余数为 $0$，则称 $n$ 为“儿童数”。其中 $2024!$ 表示 2024 的阶乘，即 $1 \times 2 \times \cdots \times 2024$。

现在，请你计算在区间 $[1, \infty)$ 内一共有多少个“儿童数”。
## 输出格式

这是一道结果填空的题，你只需要算出结果后提交即可。本题的结果为一个整数，在提交答案时只需要**编写一个程序输出这个整数**，输出多余的内容将无法得分。


---

---
title: "Brooklyn Round 1 & NNOI Round 1 A - Flying Flower"
layout: "post"
diff: 普及/提高-
pid: P12677
tag: ['O2优化', '素数判断,质数,筛法', '筛法']
---
# Brooklyn Round 1 & NNOI Round 1 A - Flying Flower
## 题目背景

飞花令启动！

#### 请注意本题特别的时间限制。

**数据中存在 $k$ 不是质数的情况，对于这样的询问回答 `Z`。**
## 题目描述

小 X 和小 Z 玩了飞花令，想要将其变成数学，一共进行 $q$ 轮，规则如下：

+ 开始时选择质数 $k$ 作为关键数。

+ 小 X 有一个长度为 $n$ 的序列 $a$，小 Z 有一个长度为 $m$ 的序列 $b$。

+ 小 X 先手，小 Z 后手。

+ 两人要从自己的序列中选择一个数满足其质因子含有 $k$ 且比上一个人报的数大的数报出（第一个数可以是质因子含有 $k$ 的任何一个数）。

+ 无数可报的人输。

他想问你，如果两个人都采用最优策略，以这些 $k$ 作为关键数，谁能胜利？


## 输入格式

第一行 $n,m,q$，含义如题面所示。

第二行 $n$ 个数，代表序列 $a$。

第三行 $m$ 个数，代表序列 $b$。

第 $4$ 至 $q + 3$ 行，每行一个数，代表 $k$。
## 输出格式

$q$ 行，如果小 X 赢输出 `X`，否则输出 `Z`。
## 样例

### 样例输入 #1
```
5 5 2
10 20 30 40 50
5 10 15 20 25
5
11

```
### 样例输出 #1
```
X
Z
```
## 提示

**本题采用捆绑测试。**

+ Subtask 1（40pts）：$1 \le n,m,q \le 10^3，1 \le a_i,b_i,k \le 10^3$。

+ Subtask 2（20pts）：$k \le 10$。

+ Subtask 3（20pts）：$q = 1$。

+ Subtask 4（20pts）：无特殊限制。

对于 $100\%$ 的数据，$1 \le n,m,q \le 5 \times 10^5,1 \le a_i,b_i,k \le 8 \times 10^6$。


---

---
title: "[蓝桥杯 2025 国 B] 互质藏卡"
layout: "post"
diff: 普及/提高-
pid: P12831
tag: ['2025', '数论', '素数判断,质数,筛法', '蓝桥杯国赛']
---
# [蓝桥杯 2025 国 B] 互质藏卡
## 题目描述

小蓝整理着阁楼上的旧物，偶然发现了一个落满灰尘的卡片箱。打开箱子，里面整齐地摆放着 17600 张卡片，每张卡片上都写有一个数字，恰好包含了从 1 到 17600 的所有正整数。

儿时的他热衷于收集各种卡牌，数量之多令人咋舌。如今，再次翻阅这些尘封的记忆，小蓝不禁感慨万千。他想起收藏家前辈的箴言：“收藏的魅力在于精粹，而非数量”。于是，他决定从这些卡牌中选取 $2025$ 张，组成一套“互质藏卡”。

“互质藏卡”的特点在于：任意两张卡片上的数字之间互质，即它们的最大公约数恒为 $1$。现在，请你帮小蓝计算，共有多少种不同的选取方案，使得选出的 $2025$ 张卡片满足“互质藏卡”的条件。由于答案可能很大，你只需给出其对 $10^9 + 7$ 取余后的结果即可。

注意：两个选取方案被认为是不同的，当且仅当它们所包含的数字集合不完全相同。即，若存在至少一个数字出现在其中一个集合但不出现在另一个集合中，则这两个方案被视为不同。
## 输出格式

这是一道结果填空的题，你只需要算出结果后提交即可。本题的结果为一个整数，在提交答案时只填写这个整数，填写多余的内容将无法得分。


---

---
title: "集合"
layout: "post"
diff: 普及/提高-
pid: P1621
tag: ['搜索', '数学', '并查集', '枚举', '素数判断,质数,筛法']
---
# 集合
## 题目描述

Caima 给你了所有 $[a,b]$ 范围内的整数。一开始每个整数都属于各自的集合。每次你需要选择两个属于不同集合的整数，如果这两个整数拥有大于等于 $p$ 的公共质因数，那么把它们所在的集合合并。

重复如上操作，直到没有可以合并的集合为止。

现在 Caima 想知道，最后有多少个集合。
## 输入格式

一行，共三个整数 $a,b,p$，用空格隔开。
## 输出格式

一个数，表示最终集合的个数。

## 样例

### 样例输入 #1
```
10 20 3
```
### 样例输出 #1
```
7
```
## 提示

#### 样例 1 解释

对于样例给定的数据，最后有 $\{10,20,12,15,18\},\{13\},\{14\},\{16\},\{17\},\{19\},\{11\}$ 共 $7$ 个集合，所以输出应该为 $7$。

#### 数据规模与约定
- 对于 $80\%$ 的数据，$1 \leq a \leq b \leq 10^3$。
- 对于 $100%$ 的数据，$1 \leq a \leq b \leq 10^5,2 \leq p \leq b$。




---

---
title: "素数密度"
layout: "post"
diff: 普及/提高-
pid: P1835
tag: ['NOI 导刊', '枚举', '素数判断,质数,筛法']
---
# 素数密度
## 题目背景

UPD:

- 2024.8.12：加入一组 Hack 数据。
## 题目描述

 给定 $L,R$，请计算区间 $[L,R]$ 中素数的个数。

   $1\leq L\leq R < 2^{31}$，$R-L\leq 10^6$。
## 输入格式

第一行，两个正整数 $L$ 和 $R$。
## 输出格式

一行，一个整数，表示区间中素数的个数。

## 样例

### 样例输入 #1
```
2 11
```
### 样例输出 #1
```
5
```


---

---
title: "A % B Problem"
layout: "post"
diff: 普及/提高-
pid: P1865
tag: ['搜索', '洛谷原创', '素数判断,质数,筛法', '前缀和']
---
# A % B Problem
## 题目背景

题目名称是吸引你点进来的。    
实际上该题还是很水的。
## 题目描述

给定 $l, r$，求区间 $[l, r]$ 内质数的个数。
## 输入格式

第一行有两个整数，分别代表询问次数 $n$ 和 给定区间的右端点最大值 $m$。

接下来 $n$ 行，每行两个整数 $l, r$，代表一次查询。
## 输出格式

对于每次查询输出一行，若 $l, r \in [1, m]$，则输出区间质数个数，否则输出 `Crossing the line`。

## 样例

### 样例输入 #1
```
2 5
1 3
2 6
```
### 样例输出 #1
```
2
Crossing the line
```
## 提示

#### 数据范围与约定

- 对于 $20\%$ 的数据，保证 $n,m\le 10$。
- 对于 $100\%$ 的数据，保证 $1\le n\le1000$，$1\le m\le10^6$，$-10^9\le l\le r\le 10^9$。


---

---
title: "[USACO08DEC] Patting Heads S"
layout: "post"
diff: 普及/提高-
pid: P2926
tag: ['2008', 'USACO', '素数判断,质数,筛法']
---
# [USACO08DEC] Patting Heads S
## 题目描述

It's Bessie's birthday and time for party games! Bessie has instructed the N (1 <= N <= 100,000) cows conveniently numbered 1..N to sit in a circle (so that cow i [except at the ends] sits next to cows i-1 and i+1; cow N sits next to cow 1). Meanwhile, Farmer John fills a barrel with one billion slips of paper, each containing some integer in the range 1..1,000,000.

Each cow i then draws a number A\_i (1 <= A\_i <= 1,000,000) (which is not necessarily unique, of course) from the giant barrel.  Taking turns, each cow i then takes a walk around the circle and pats the heads of all other cows j such that her number A\_i is exactly

divisible by cow j's number A\_j; she then sits again back in her original position.

The cows would like you to help them determine, for each cow, the number of other cows she should pat.


## 输入格式

\* Line 1: A single integer: N

\* Lines 2..N+1: Line i+1 contains a single integer: A\_i

## 输出格式

\* Lines 1..N: On line i, print a single integer that is the number of other cows patted by cow i.

## 样例

### 样例输入 #1
```
5 
2 
1 
2 
3 
4 

```
### 样例输出 #1
```
2 
0 
2 
1 
3 

```
## 提示

The 5 cows are given the numbers 2, 1, 2, 3, and 4, respectively.


The first cow pats the second and third cows; the second cows pats no cows; etc.

## 题目翻译

今天是贝茜的生日，为了庆祝自己的生日，贝茜邀你来玩一个游戏。

贝茜让 $N$ ($1\leq N\leq 10^5$) 头奶牛坐成一个圈。除了 $1$ 号与 $N$ 号奶牛外，$i$ 号奶牛与 $i-1$ 号和 $i+1$ 号奶牛相邻。$N$ 号奶牛与 $1$ 号奶牛相邻。农夫约翰用很多纸条装满了一个桶，每一张包含了一个不一定是独一无二的 $1$ 到 $10^6$ 的数字。

接着每一头奶牛 $i$ 从桶中取出一张纸条 $A_i$。每头奶牛轮流走上一圈，同时拍打所有手上数字能整除在自己纸条上的数字的牛的头，然后坐回到原来的位置。牛们希望你帮助他们确定，每一头奶牛需要拍打的牛的数量。



---

---
title: "【模板】模意义下的乘法逆元"
layout: "post"
diff: 普及/提高-
pid: P3811
tag: ['数学', '递推', 'O2优化', '素数判断,质数,筛法', '逆元']
---
# 【模板】模意义下的乘法逆元
## 题目背景

这是一道模板题

## 题目描述

给定 $n,p$ 求 $1\sim n$ 中所有整数在模 $p$ 意义下的乘法逆元。

这里 $a$ 模 $p$ 的乘法逆元定义为 $ax\equiv1\pmod p$ 的解。
## 输入格式

一行两个正整数 $n,p$。

## 输出格式

输出 $n$ 行，第 $i$ 行表示 $i$ 在模 $p$ 下的乘法逆元。
## 样例

### 样例输入 #1
```
10 13
```
### 样例输出 #1
```
1
7
9
10
8
11
2
5
3
4
```
## 提示

$ 1 \leq n \leq 3 \times 10 ^ 6$，$n < p < 20000528 $。

输入保证 $ p $ 为质数。



---

---
title: "Roy&October之取石子"
layout: "post"
diff: 普及/提高-
pid: P4018
tag: ['数学', '博弈论', '素数判断,质数,筛法']
---
# Roy&October之取石子
## 题目背景

Roy 和 October 两人在玩一个取石子的游戏。

## 题目描述

游戏规则是这样的：共有 $n$ 个石子，两人每次都只能取 $p^k$ 个（ $p$ 为质数，$k$ 为自然数，且 $p^k$ 小于等于当前剩余石子数），谁取走最后一个石子，谁就赢了。

现在 October 先取，问她有没有必胜策略。

若她有必胜策略，输出一行 `October wins!`；否则输出一行 `Roy wins!`。

## 输入格式

第一行一个正整数 $T$，表示测试点组数。

第 $2$ 行$\sim$ 第 $T+1$ 行，一行一个正整数 $n$，表示石子个数。

## 输出格式

$T$ 行，每行分别为 `October wins!` 或 `Roy wins!`。

## 样例

### 样例输入 #1
```
3
4
9
14
```
### 样例输出 #1
```
October wins!
October wins!
October wins!
```
## 提示

对于 $30\%$ 的数据，$1\leq n\leq 30$；

对于 $60\%$ 的数据，$1\leq n\leq 10^6$；

对于 $100\%$ 的数据，$1\leq n\leq 5\times 10^7$, $1\leq T\leq 10^5$。

（改编题）



---

---
title: "【XR-2】奇迹"
layout: "post"
diff: 普及/提高-
pid: P5440
tag: ['搜索', 'O2优化', '剪枝', '素数判断,质数,筛法']
---
# 【XR-2】奇迹
## 题目背景

> 相信奇迹的人，本身就和奇迹一样了不起。——笛亚 《星游记》
## 题目描述

我们称一个**日期**为一个八位数，第 1~4 位构成年，第 5~6 位构成月，第 7~8 位构成日，不足位数用 0 补足。同时，要求日期所代表的这一天真实存在，且年的范围为 1~9999。

出现奇迹的日期都存在相同的特点：由“日”组成的两位数，由“月+日”组成的四位数，由“年+月+日”组成的八位数均为**质数**。但并不是所有存在这样特点的日期都一定会出现奇迹。

现在，你得到了一个可能会出现奇迹的日期，然而不幸的是这个日期却是残缺的，八位中可能有若干位无法确定。你需要知道这个日期有多少种可能，这样你才能做好充足的准备去迎接奇迹的到来。
## 输入格式

**本题有多组数据。**

第一行一个正整数 $T$，表示数据组数。

接下来的 $T$ 行，每行一个八位字符串。其中第 $i$ 位如果为 `-`，则表示日期的第 $i$ 位无法确定，否则表示日期的第 $i$ 位为字符串中第 $i$ 位上的数字。
## 输出格式

对每组数据，一行一个整数，表示答案。
## 样例

### 样例输入 #1
```
2
53-7-3-7
20190629

```
### 样例输出 #1
```
6
0

```
## 提示

【样例 $1$ 说明】

`53-7-3-7` 的 $6$ 种可能的日期如下：

```plain
53070307
53070317
53170307
53370307
53570317
53770307
```

【数据规模与约定】

一共 $10$ 个测试点，记 $c$ 为八位字符串中 `-` 的个数。

对前 $9$ 个测试点，在第 $i$ 个测试点中保证 $c = i - 1$。

对 $100\%$ 的数据保证 $1 \le T \le 10$。


---

---
title: "【XR-3】小道消息"
layout: "post"
diff: 普及/提高-
pid: P5535
tag: ['数学', 'O2优化', '素数判断,质数,筛法', '最大公约数 gcd']
---
# 【XR-3】小道消息
## 题目描述

小 X 想探究小道消息传播的速度有多快，于是他做了一个社会实验。

有 $n$ 个人，其中第 $i$ 个人的衣服上有一个数 $i+1$。小 X 发现了一个规律：当一个衣服上的数为 $i$ 的人在某一天知道了一条信息，他会在第二天把这条信息告诉衣服上的数为 $j$ 的人，其中 $\gcd(i,j)=1$（即 $i,j$ 的最大公约数为 $1$）。在第 $0$ 天，小 X 把一条小道消息告诉了第 $k$ 个人，小 X 想知道第几天时所有人都会知道这条小道消息。

可以证明，一定存在所有人都知道了这条小道消息的那一天。

提示：你可能需要用到的定理——[伯特兰-切比雪夫定理](https://baike.baidu.com/item/%E4%BC%AF%E7%89%B9%E5%85%B0-%E5%88%87%E6%AF%94%E9%9B%AA%E5%A4%AB%E5%AE%9A%E7%90%86/2053704)。
## 输入格式

一行 $2$ 个正整数 $n,k$。

**数据范围：**

- $2 \le n \le 10^{14}$。
- $1 \le k \le n$。
## 输出格式

一行一个正整数，表示答案。
## 样例

### 样例输入 #1
```
3 1

```
### 样例输出 #1
```
2

```
### 样例输入 #2
```
6 4

```
### 样例输出 #2
```
1

```
## 提示

【样例 $1$ 说明】

$3$ 个人的衣服上的数分别为 `2 3 4`。

在第 $0$ 天，小 X 把一条小道消息告诉了第 $1$ 个人，他的衣服上的数为2。

在第 $1$ 天，第 $1$ 个人会告诉第 $2$ 个人，因为 $\gcd(2,3) = 1$，但他不会告诉第 $3$ 个人，因为 $\gcd(2,4) = 2 \ne 1$。

在第 $2$ 天，第 $2$ 个人会告诉第 $3$ 个人，因为 $\gcd(3,4) = 1$，这时所有人都知道了这条小道消息，因此答案为 $2$。


---

---
title: "双重素数（2021 CoE-II A）"
layout: "post"
diff: 普及/提高-
pid: P7588
tag: ['数学', '二分', '2021', 'O2优化', '素数判断,质数,筛法']
---
# 双重素数（2021 CoE-II A）
## 题目描述

素数（质数）是指在大于 $1$ 的自然数中，除了 $1$ 和它本身以外不再有其他因数的自然数。定义**双重素数**为这样的素数：它的各位数字之和也是一个素数。给定一个闭区间，试确定在该区间内双重素数的个数。
## 输入格式

**输入包含多组测试数据。**

输入第一行包含一个整数 $T$，表示测试数据的组数。接下来每行一组测试数据，每组测试数据包含以空格分隔的两个整数 $L$ 和 $R$。
## 输出格式

每组测试数据输出一行，包含一个整数，表示在闭区间 $[L,\ R]$ 内双重素数的个数。
## 样例

### 样例输入 #1
```
4
3 3
4 4
1 5
1 15
```
### 样例输出 #1
```
1
0
3
5
```
## 提示

**样例说明**

从 $1$ 到 $15$ 共有 $6$ 个素数：$2$，$3$，$5$，$7$，$11$，$13$。前五个素数各自的数字之和也是素数，因此都是双重素数。素数 $13$ 的各位数字之和为 $4$，不是素数，故 $13$ 不是双重素数。

------------


**数据范围**

- Subtask $1$ ：$1 \le L \le R \le 10^2$，$10$ 分。
- Subtask $2$ ：$1 \le L \le R \le 10^4$，$20$ 分。
- Subtask $3$ ：$1 \le L \le R \le 10^6$，$60$ 分。
- Subtask $4$ ：$1 \le L \le R \le 10^8$，$10$ 分。

对于 $100\%$ 的数据，$1 \le T \le 100$。


------------

**提示（数据已经加强）**

最后一个子任务要求你的程序必须具有较高的空间使用效率和时间效率，否则容易超出内存限制或时间限制。


---

---
title: "[NOIP2021] 报数"
layout: "post"
diff: 普及/提高-
pid: P7960
tag: ['2021', 'NOIP 提高组', 'O2优化', '素数判断,质数,筛法']
---
# [NOIP2021] 报数
## 题目描述

报数游戏是一个广为流传的休闲小游戏。参加游戏的每个人要按一定顺序轮流报数，但如果下一个报的数是 $7$ 的倍数，或十进制表示中含有数字 $7$，就必须跳过这个数，否则就输掉了游戏。

在一个风和日丽的下午，刚刚结束 SPC20nn 比赛的小 r 和小 z 闲得无聊玩起了这个报数游戏。但在只有两个人玩的情况下计算起来还是比较容易的，因此他们玩了很久也没分出胜负。此时小 z 灵光一闪，决定把这个游戏加强：任何一个十进制中含有数字 $7$ 的数，它的所有倍数都不能报出来！

形式化地，设 $p(x)$ 表示 $x$ 的十进制表示中是否含有数字 $7$，若含有则 $p(x) = 1$，否则 $p(x) = 0$。则一个正整数 $x$ 不能被报出，当且仅当存在正整数 $y$ 和 $z$ ，使得 $x = yz$ 且 $p(y) = 1$。


例如，如果小 r 报出了 $6$ ，由于 $7$ 不能报，所以小 z 下一个需要报 $8$；如果小 r 报出了 $33$，则由于 $34 = 17 \times 2$，$35 = 7 \times 5$ 都不能报，小 z 下一个需要报出 $36$ ；如果小 r 报出了 $69$，由于 $70 \sim 79$ 的数都含有 $7$，小 z 下一个需要报出 $80$ 才行。

现在小 r 的上一个数报出了 $x$，小 z 想快速算出他下一个数要报多少，不过他很快就发现这个游戏可比原版的游戏难算多了，于是他需要你的帮助。当然，如果小 r 报出的 x 本身是不能报出的，你也要快速反应过来小 r 输了才行。

由于小 r 和小 z 玩了很长时间游戏，你也需要回答小 z 的很多个问题。
## 输入格式

第一行，一个正整数 $T$ 表示小 z 询问的数量。

接下来 $T$ 行，每行一个正整数 $x$，表示这一次小 r 报出的数。
## 输出格式

输出共 $T$ 行，每行一个整数，如果小 r 这一次报出的数是不能报出的，输出 $-1$，否则输出小 z 下一次报出的数是多少。
## 样例

### 样例输入 #1
```
4
6
33
69
300

```
### 样例输出 #1
```
8
36
80
-1

```
### 样例输入 #2
```
5
90
99
106
114
169

```
### 样例输出 #2
```
92
100
109
-1
180

```
### 样例输入 #3
```
见附件中的 number/number3.in
```
### 样例输出 #3
```
见附件中的 number/number3.ans
```
### 样例输入 #4
```
见附件中的 number/number4.in
```
### 样例输出 #4
```
见附件中的 number/number4.ans
```
## 提示

**【样例解释 #1】**

这一组样例的前 $3$ 次询问在题目描述中已有解释。

对于第 $4$ 次询问，由于 $300 = 75 \times 4$，而 $75$ 中含有 $7$ ，所以小 r 直接输掉了游戏。

**【数据范围】**

对于 $10\%$ 的数据，$T \leq 10$，$x \leq 100$。  
对于 $30\%$ 的数据，$T \leq 100$，$x \leq 1000$。  
对于 $50\%$ 的数据，$T \leq 1000$，$x \leq 10000$。  
对于 $70\%$ 的数据，$T \leq 10000$，$x \leq 2 \times {10}^5$。  
对于 $100\%$ 的数据，$1 \le T \leq 2 \times {10}^5$，$1 \le x \leq {10}^7$。


---

---
title: "『JROI-4』分数"
layout: "post"
diff: 普及/提高-
pid: P8319
tag: ['数学', '2022', '洛谷原创', '素数判断,质数,筛法', '洛谷月赛']
---
# 『JROI-4』分数
## 题目背景

万人血书 [KHIN](https://www.luogu.com.cn/user/236807) 完成[女装 flag](https://www.luogu.com.cn/paste/pdsav61j)(1/10000) $\to$ 万人血书 [KHIN](https://www.luogu.com.cn/user/236807) 完成[女装 flag](https://www.luogu.com.cn/paste/pdsav61j)(2/10000)(1/5000) $\to$ 万人血书 [KHIN](https://www.luogu.com.cn/user/236807) 完成[女装 flag](https://www.luogu.com.cn/paste/pdsav61j)(2/5000)(1/2500) $\to$ 万人血书 [KHIN](https://www.luogu.com.cn/user/236807) 完成[女装 flag](https://www.luogu.com.cn/paste/pdsav61j)(2/2500)(1/1250) $\to$ 万人血书 [KHIN](https://www.luogu.com.cn/user/236807) 完成[女装 flag](https://www.luogu.com.cn/paste/pdsav61j)(2/1250)(1/625) $\cdots$ 以此类推，在可以约分的情况下，“万人血书”很快就能完成。[](KH粉丝群群号：808706015)
## 题目描述

“$x$ 人血书”的过程可以看成一个函数 $f(x)$：

有一个 $\frac{0}{x}$ 的分数。重复以下步骤直到这个分数为 $1$：

1. 分子 $+1$。
2. 如果这个分数可以约分，约分到最简形式。

现在小 D 给了你 $T$ 组数据，每组数据都是给定 $n$，求在 $1\le x\le n$ 的情况下 $f(x)$ 的最大操作次数。

但是他太菜了，不会，你能帮帮他吗？
## 输入格式

第一行一个正整数 $T$。

接下来 $T$ 行，每行一个正整数 $n$。
## 输出格式

共 $T$ 行，每行一个整数 $s$ 表示在 $1\le x\le n$ 的情况下 $f(x)$ 的最大操作次数。
## 样例

### 样例输入 #1
```
5
1
2
5
8
114514
```
### 样例输出 #1
```
1
2
5
7
114493

```
## 提示

### 样例解释

$f(1)=1,f(2)=2,f(3)=3,f(4)=3,f(5)=5$。

我也想把更大的 $f(x)$ 列出来，但是地方不够了。

### 数据范围


对于全部数据，$1\le T\le 5\times 10^5$，$1\le n\le 2\times 10^6$。

Subtask 中没填的部分表示和全部数据的范围一样。

| 子任务编号 | $T$ 的范围 | $n$ 的范围 | 特殊性质 |分值|
| -----------: | -----------: | -----------: | -----------: |-----------: |
| Subtask $1$ | $T\le 3$ | $n\le 10$ |  |$10$|
| Subtask $2$ | $T\le 5$ | $n\le 10^3$ |  |$30$|
| Subtask $3$ |  |  | $n$ 为质数|$10$|
| Subtask $4$  |  | $n\le 5\times 10^5$ |  |$20$|
| Subtask $5$  |  |  |  |$30$|



---


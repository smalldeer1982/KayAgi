---
title: "[NICA #3] 星空（Easy Version）"
layout: "post"
diff: 普及/提高-
pid: B3901
tag: ['数学', 'O2优化', '排列组合']
---
# [NICA #3] 星空（Easy Version）
## 题目背景

**Easy Version 和 Hard Version 差别在于数据范围。**
## 题目描述

小 R 有一个长度为 $n$ 的序列 $a$，保证序列中的每个数都是 $2$ 的整数次幂。

小 M 有一个数 $x$，她希望重新排列序列 $a$，使得不存在一个 $i\in[1,n)$ 满足 $a_i+a_{i+1}>x$。重排的方式为：选择一个 $1\sim n$ 的排列 $p$，然后令新序列 $a'$ 满足 $a'_i=a_{p_i}$。$a'$ 即为重排后的序列。

现在你想要知道有多少种重排的方式能满足小 M 的要求。两种重排方式不同当且仅当选择的排列 $p$ 不同。答案对 $10^9+7$ 取模。
## 输入格式

第一行输入两个正整数 $n,x$，表示序列长度和小 M 想的那个数；

第二行输入 $n$ 个正整数 $a_i$，表示序列；
## 输出格式

输出一行表示答案。答案对 $10^9+7$ 取模。
## 样例

### 样例输入 #1
```
4 20
2 4 8 16
```
### 样例输出 #1
```
12
```
## 提示

数据保证，$2 \leq n \leq 61$，$1 \leq a_i \leq 2^{60}$，$1\le x< 2^{63}$。**每一个 $a_i$ 都不重复**。


---

---
title: "[GESP202312 八级] 奖品分配"
layout: "post"
diff: 普及/提高-
pid: P10112
tag: ['数学', '2023', '组合数学', '排列组合', 'GESP']
---
# [GESP202312 八级] 奖品分配
## 题目描述

班上有 $N$ 名同学，学号从 $0$ 到 $N-1$。有 $M$ 种奖品要分给这些同学，其中，第 $i$ 种奖品总共有 $a_i$ 个 （$i=0,1, \cdots ,M-1$）。

巧合的是，奖品的数量不多不少，每位同学都可以恰好分到一个奖品，且最后剩余的奖品不超过 $1$ 个（即：$N\le a_0+a_1+ \cdots +a_{M-1}\le N+1$）。

现在，请你求出每个班级礼物分配的方案数，所谓方案，指的是为每位同学都分配一个种类的奖品。

只要有一位同学获得了不同种类的奖品，即视为不同的方案。方便起见，你只需要输出方案数对 $10^{9}+7$ 取模后的结果即可。

共有 $T$ 个班级都面临着奖品分配的问题，你需要依次为他们解答。
## 输入格式

第一行一个整数 $T$，表示班级数量。

接下来 $T$ 行，每行若干用单个空格隔开的正整数。首先是两个正整数$N,M$，接着是 $M$ 个正整数 $a_0,a_1...a_{M-1}$。保证 $N \le a_0+a_1+\cdots+a_{M-1} \le N+1 $。
## 输出格式

输出 $T$ 行，每行一个整数，表示该班级分配奖品的方案数对 $10^{9}+7$ 取模的结果。
## 样例

### 样例输入 #1
```
3
3 2 1 2
3 2 1 3
5 3 1 3 1 
```
### 样例输出 #1
```
3
4
20
```
### 样例输入 #2
```
5
100 1 100
100 1 101
20 2 12 8
123 4 80 20 21 3
999 5 101 234 499 66 99
```
### 样例输出 #2
```
1
1
125970
895031741
307187590
```
## 提示

**样例解释 1**

对于第 $1$ 个班级，学号为 $0,1,2$ 的同学可以依次分别获得奖品 $0,1,1$，也可以依次分别获得奖品 $1,0,1$，也可以依次分别获得奖品 $1,1,0$ ，因此共有 $3$ 种方案。

对于第 $2$ 个班级，学号为 $0,1,2$ 的同学可以依次分别获得奖品 $0,1,1$ ，也可以依次分别获得奖品 $1,0,1$，也可以依次分别获得奖品 $1,1,0$，也可以依次分别获得奖品 $1,1,1$，因此共有 $4$ 种方案。

对于第 $3$ 个班级，可以把编号为 $0$ 的奖品分配给 $5$ 名同学中的任意一名，共有 $5$ 种方案；再把编号为 $2$ 的奖品分配给剩余 $4$ 名同学中的任意一名，共有$4$ 种方案；最后给剩余 $3$ 名同学自然获得 $1$ 号奖品。因此，方案数为 $5 \times 4 = 20$。

**数据范围**

对于 $30\%$ 的测试点，保证 $N \le 10$。

对于另外 $30\%$ 的测试点，保证 $M=2$。

对于所有测试点，保证 $N \le 1000$；保证 $T \le 1000$ ；保证 $M \le 1001$。


---

---
title: "[GESP202409 八级] 手套配对"
layout: "post"
diff: 普及/提高-
pid: P11250
tag: ['2024', '组合数学', '排列组合', 'GESP']
---
# [GESP202409 八级] 手套配对
## 题目描述

小杨有 $n$ 对不同的手套，每对手套由左右各一只组成。

小杨想知道从中取出 $m$ 只手套，恰好包含 $k$ 对手套的情况有多少种。

小杨认为两种取出的情况不同，当且仅当两种情况取出的手套中存在不同的手套（同一对手套的左右手也视为不同的手套）。
## 输入格式


**本题单个测试点内由多组测试数据**。第一行是一个整数 $t$，表示测试用例数量。接下来是 $t$ 组测试用例，每组一行。

每组数据只有一行三个正整数 $n,m,k$，表示手套数量、取出的手套数和目标对数。

## 输出格式


对每组数据，输出一行一个整数表示答案对 $10^9 + 7$ 取模的结果。

## 样例

### 样例输入 #1
```
2
5 6 2
5 1 5
```
### 样例输出 #1
```
120
0
```
## 提示

| 子任务 | 占比 | $t$ | $n$ | $m$ | $k$ |
| :-: | :-: | :-: | :-: | :-: | :-: |
| $1$ | $30\%$ | $\leq 5$ | $1000$ | $\le 3$ | $=1$ |
| $2$ | $30\%$ | $\leq 5$ | $\leq 5$ | $\leq 10$ | $\leq 5$ |
| $3$ | $40\%$ | $10^5$ | $1000$ | $2000$ | $2000$ |

对全部的测试数据，保证 $1 \leq t \leq 10^5$，$1 \leq n \leq 1000$，$1 \leq m \leq 2 \times n$，$1 \le k \le n$。


---

---
title: "[GESP202412 八级] 排队"
layout: "post"
diff: 普及/提高-
pid: P11380
tag: ['图论', '2024', '数论', '图论建模', '组合数学', '排列组合', 'GESP']
---
# [GESP202412 八级] 排队
## 题目描述

小杨所在班级共有 $n$ 位同学，依次以 $1,2,\dots,n$ 标号。这 $n$ 位同学想排成一行队伍，其中有些同学之间关系非常好，在队伍里需要排在相邻的位置。具体来说，有 $m$ 对这样的关系（$m$ 是一个非负整数）。当 $m\geq 1$ 时，第 $i$ 对关系（$1\leq i\leq m$）给出 $a_i,b_i$，表示排队时编号为 $a_i$ 的同学需要排在编号为 $b_i$ 的同学前面，并且两人在队伍中相邻。

现在小杨想知道总共有多少种排队方式。由于答案可能很大，你只需要求出答案对 $10^9+7$ 取模的结果。
## 输入格式

第一行，两个整数 $n,m$，分别表示同学们的数量与关系数量。

接下来 $m$ 行，每行两个整数 $a_i,b_i$，表示一对关系。
## 输出格式

一行，一个整数，表示答案对 $10^9+7$ 取模的结果。
## 样例

### 样例输入 #1
```
4 2
1 3
2 4
```
### 样例输出 #1
```
2
```
### 样例输入 #2
```
3 0
```
### 样例输出 #2
```
6
```
### 样例输入 #3
```
3 2
1 2
2 1
```
### 样例输出 #3
```
0
```
## 提示

对于 $20\%$ 的测试数据点，保证 $1\leq n\leq 8$，$0\leq m\leq 10$。

对于另外 $20\%$ 的测试数据点，保证 $1\leq n\leq 10^3$，$0\leq m\leq 1$。

对于所有测试数据点，保证 $1\leq n\leq 2\times 10^5$，$0\leq m\leq 2\times 10^5$。


---

---
title: "[Algo Beat Contest 001 C] Creating a Queue"
layout: "post"
diff: 普及/提高-
pid: P11681
tag: ['O2优化', '组合数学']
---
# [Algo Beat Contest 001 C] Creating a Queue
## 题目背景

|               Problem               | Score |                         Idea                          |                             Std                              |                      Data                       |                            Check                             |                           Solution                           |
| :---------------------------------: | :---: | :---------------------------------------------------: | :----------------------------------------------------------: | :---------------------------------------------: | :----------------------------------------------------------: | :----------------------------------------------------------: |
|    $\text{C - Creating a Queue}$    | $400$ |    [joe_zxq](https://www.luogu.com.cn/user/623577)    | [fanchuanyu](https://www.luogu.com.cn/user/706256) & [joe_zxq](https://www.luogu.com.cn/user/623577) | [joe_zxq](https://www.luogu.com.cn/user/623577) |    [remmymilkyway](https://www.luogu.com.cn/user/551981)     | [Link](https://www.luogu.com.cn/article/7r5l2cag) by [joe_zxq](https://www.luogu.com.cn/user/623577) |
## 题目描述

给定一个长度为 $N$ 的非负整数序列 $A$。

现在你需要用 $1\sim M$ 之间的正整数替换所有序列 $A$ 中的 $0$，使得对于其中的任何一段长度大于等于 $2$ 的子数组，不能存在唯一众数。

> 子数组：在一个数组中，选择一些连续的元素组成的新数组。
>
> 唯一众数：众数指的是一个数字序列中出现次数最多的元素。如果一个数字序列众数只有一个，我们称这个序列有唯一众数。

求有多少种不同方案，答案对 $1145141923$ 取模。两种方案称为不同，当且仅当替换后的序列至少有一位上的数不同。
## 输入格式

第一行包含两个正整数 $N$ 和 $M$，表示序列的长度和替换数的最大限度。

第二行包含 $N$ 个非负整数，表示序列 $A$ 的元素。
## 输出格式

一行一个非负整数，表示方案的数量，答案对 $1145141923$ 取模。
## 样例

### 样例输入 #1
```
2 3
1 0
```
### 样例输出 #1
```
2
```
### 样例输入 #2
```
4 1046
114 514 191 981
```
### 样例输出 #2
```
1
```
## 提示

#### 样例解释 #1

有 $2$ 个满足条件的序列，分别为 $\{1,2\}$ 和 $\{1,3\}$。

#### 样例解释 #2

序列已经完全固定，本身就是一种合法的序列，于是答案为 $1$。

#### 数据范围

对于 $100\%$ 的数据，保证 $1 \le N \le 10^6$，$1 \le M \le 10^9$，$0 \le A_i \le M$。


---

---
title: "[蓝桥杯 2025 省 B] 装修报价"
layout: "post"
diff: 普及/提高-
pid: P12137
tag: ['数学', '2025', '组合数学', '容斥原理', '位运算', '蓝桥杯省赛']
---
# [蓝桥杯 2025 省 B] 装修报价
## 题目描述

老王计划装修房子，于是联系了一家装修公司。该公司有一套自动报价系统，只需用户提供 $N$ 项装修相关费用 $A_1, A_2, \dots , A_N$，系统便会根据这些费用生成最终的报价。

然而，当老王提交数据后，他发现这套系统的运作方式并不透明：系统只会给出一个最终报价，而不会公开任何运算过程或中间步骤。

公司对此解释称，这套系统会依据某种内部算法，在每对相邻数字之间插入 $+$（加法）、$-$（减法）或 $\oplus$（异或）运算符，并按照特定优先级规则计算结果：异或运算优先级最高，其次是加减。但由于保密性，具体的运算符组合以及中间过程都不会对外公开。

为了验证系统报价是否合理，老王决定模拟其运作方式，尝试每种可能的运算符组合，计算出所有可能出现的结果的总和。如果最终报价明显超出这个范围，他就有理由怀疑系统存在异常或误差。只是老王年事已高，手动计算颇为吃力，便向你求助。

现在，请你帮老王算出所有可能的结果的总和。由于该总和可能很大，你只需提供其对 $10^9+7$ 取余后的结果即可。
## 输入格式

第一行输入一个整数 $N$，表示装修相关费用的项数。

第二行输入 $N$ 个非负整数 $A_1, A_2, \dots , A_N$，表示各项费用。
## 输出格式

输出一个整数，表示所有可能的总和对 $10^9 + 7$ 取余后的结果。
## 样例

### 样例输入 #1
```
3
0 2 5
```
### 样例输出 #1
```
11
```
## 提示

对于输入样例中的三个数 $A = [0, 2, 5]$，所有可能的运算符组合共有 $9$ 种。计算结果如下：

$$0 \oplus 2 \oplus 5 = 7$$
$$0 \oplus 2 + 5 = 7$$
$$0 \oplus 2 - 5 = -3$$
$$0 + 2 \oplus 5 = 7$$
$$0 + 2 + 5 = 7$$
$$0 + 2 - 5 = -3$$
$$0 - 2 \oplus 5 = -7$$
$$0 - 2 + 5 = 3$$
$$0 - 2 - 5 = -7$$

所有结果的总和为：

$$7 + 7 + (-3) + 7 + 7 + (-3) + (-7) + 3 + (-7) = 11$$

$11$ 对 $10^9 + 7$ 取余后的值依然为 $11$，因此，输出结果为 $11$。

### 评测用例规模与约定

- 对于 $30\%$ 的评测用例，$1 \leq N \leq 13$，$0 \leq A_i \leq 10^3$。
- 对于 $60\%$ 的评测用例，$1 \leq N \leq 10^3$，$0 \leq A_i \leq 10^5$。
- 对于 $100\%$ 的评测用例，$1 \leq N \leq 10^5$，$0 \leq A_i \leq 10^9$。


---

---
title: "[蓝桥杯 2022 省 Python B] 全排列的价值"
layout: "post"
diff: 普及/提高-
pid: P12369
tag: ['数学', '2022', '组合数学', '蓝桥杯省赛']
---
# [蓝桥杯 2022 省 Python B] 全排列的价值
## 题目描述

对于一个排列 $A=(a_1,a_2,\cdots,a_n)$，定义价值 $c_i$ 为 $a_1$ 至 $a_{i-1}$ 中小于 $a_i$ 的数的个数，即 $c_i=|\{a_j|j<i,a_j<a_i\}|$。定义 $A$ 的价值为 $\displaystyle \sum_{i=1}^{n}c_i$。

给定 $n$，求 $1$ 至 $n$ 的全排列中所有排列的价值之和。
## 输入格式

输入一行包含一个整数 $n$。
## 输出格式

输出一行包含一个整数表示答案，由于所有排列的价值之和可能很大，请输出这个数除以 $998244353$ 的余数。
## 样例

### 样例输入 #1
```
3
```
### 样例输出 #1
```
9
```
### 样例输入 #2
```
2022
```
### 样例输出 #2
```
593300958
```
## 提示

### 样例说明

$1$ 至 $3$ 构成的所有排列的价值如下:

$$\begin{aligned}& (1,2,3): 0+1+2=3 \\& (1,3,2): 0+1+1=2 \\& (2,1,3): 0+0+2=2 \\& (2,3,1): 0+1+0=1 \\& (3,1,2): 0+0+1=1 \\& (3,2,1): 0+0+0=0\end{aligned}$$

故总和为 $3+2+2+1+1=9$。

### 评测用例规模与约定

- 对于 $40\%$ 的评测用例，$n \leq 20$；
- 对于 $70\%$ 的评测用例，$n \leq 5000$；
- 对于所有评测用例，$2 \leq n \leq 10^6$。


---

---
title: "[蓝桥杯 2025 国 A] OCR 校正"
layout: "post"
diff: 普及/提高-
pid: P12840
tag: ['数学', '2025', '组合数学', '蓝桥杯国赛']
---
# [蓝桥杯 2025 国 A] OCR 校正
## 题目描述

小蓝维护着一套 OCR 文字识别系统。最近，系统频繁地将数字 0 和英文字母 O 混淆，这让他十分头疼。一次测试中，系统将一串长度为 2025 的、全部由数字 0 组成的字符串识别成了一个长度相同的字符串，但其中只有首尾两个字符被正确识别为数字 0，其余部分都被错误地识别成了字母 O。

为了校正识别结果，小蓝需将所有的字母 O 替换回数字 0。只是，出于安全的考虑，该系统不允许直接批量修改所有字母 O，而是设定了如下替换规则:

1. 首次操作，可任意选择一个字母 O，将其替换为数字 0；
2. 后续操作，选择一个与数字 0 相邻的字母 O，将其替换为数字 0；
3. 重复上述步骤，直到所有字母 O 都被替换为数字 0。

小蓝想知道，在满足上述替换规则的情况下，总共有多少种不同的替换顺序可以将所有字母 O 替换为数字 0。两种替换顺序被视为不同的，当且仅当它们在某一步骤中选择了不同位置的字符。

现在，请你帮他计算这个数量。由于答案可能很大，你只需给出其对 $10^9 + 7$ 取余后的结果即可。
## 输出格式

这是一道结果填空题，你只需要算出结果后提交即可。本题的结果为一个范围在 0 至 $10^9 + 6$ 的整数，在提交答案时只填写这个整数，填写多余的内容将无法得分。


---

---
title: "[蓝桥杯 2025 国 Java B] 分配房子"
layout: "post"
diff: 普及/提高-
pid: P12886
tag: ['2025', '组合数学', '蓝桥杯国赛']
---
# [蓝桥杯 2025 国 Java B] 分配房子
## 题目描述

蓝桥小镇有 $20255202$ 栋楼房排成一列，每栋楼有两套房子：一套在一楼，一套在二楼。镇长决定将这些房子分配给本地居民或外来游客居住，并设定了如下规则：

- 每一栋楼里，必须有一套是本地居民住，另一套是外来游客住。
- 从本地居民住户中，分别往左、右看同一楼层的邻居。如果某个邻居也住着本地居民，就记录一次（如果某个本地居民的同一楼层的左、右邻居都是本地居民，记录两次）。最后把所有这样的记录加起来，总数是 $5202$。

现在，请你计算出满足这两个规则的房子分配方案总数。由于答案可能很大，你只需给出其对 $10^9 + 7$ 取余后的结果即可。
## 输出格式

这是一道结果填空的题，你只需要算出结果后提交即可。本题的结果为一个整数，在提交答案时只填写这个整数，填写多余的内容将无法得分。


---

---
title: "[GESP202506 七级] 线图"
layout: "post"
diff: 普及/提高-
pid: P13017
tag: ['图论', '2025', '组合数学', 'GESP']
---
# [GESP202506 七级] 线图
## 题目描述

给定由 $n$ 个结点与 $m$ 条边构成的简单无向图 $G$，结点依次以 $1,2,\dots,n$ 编号。简单无向图意味着 $G$ 中不包含重边与自环。$G$ 的**线图** $L(G)$ 通过以下方式构建：

- 初始时线图 $L(G)$ 为空。

- 对于无向图 $G$ 中的一条边，在线图 $L(G)$ 中加入与之对应的一个结点。

- 对于无向图 $G$ 中两条不同的边 $(u_1,v_1),(u_2,v_2)$，若存在 $G$ 中的结点同时连接这两条边（即 $u_1,v_1$ 之一与 $u_2,v_2$ 之一相同），则在线图 $L(G)$ 中加入一条无向边，连接 $(u_1,v_1),(u_2,v_2)$ 在线图中对应的结点。

请你求出线图 $L(G)$ 中所包含的无向边的数量。
## 输入格式

第一行，两个正整数 $n,m$，分别表示无向图 $G$ 中的结点数和边数。

接下来 $m$ 行，每行两个正整数 $u_i,v_i$，表示 $G$ 中连接 $u_i,v_i$ 的一条无向边。
## 输出格式

输出共一行，一个整数，表示线图 $L(G)$ 中所包含的无向边的数量。
## 样例

### 样例输入 #1
```
5 4
1 2
2 3
3 1
4 5
```
### 样例输出 #1
```
3
```
### 样例输入 #2
```
5 10
1 2
1 3
1 4
1 5
2 3
2 4
2 5
3 4
3 5
4 5
```
### 样例输出 #2
```
30
```
## 提示

**【样例解释 #1】**

![](https://cdn.luogu.com.cn/upload/image_hosting/72ffa0a3.png)

**【数据范围】**

对于 $60\%$ 的测试点，保证 $1 \le n \le 500,1 \le m \le 500$。

对于所有测试点，保证 $1 \le n \le 10^5,1 \le m \le 10^5$。


---

---
title: "[GCJ 2013 #1C] Consonants"
layout: "post"
diff: 普及/提高-
pid: P13291
tag: ['字符串', '2013', '组合数学', '前缀和', 'Google Code Jam']
---
# [GCJ 2013 #1C] Consonants
## 题目描述

In English, there are $26$ letters that are either **vowels** or **consonants**. In this problem, we consider a, e, i, o, and u to be vowels, and the other $21$ letters to be consonants.

A tribe living in the Greatest Colorful Jungle has a tradition of naming their members using English letters. But it is not easy to come up with a good name for a new member because it reflects the member's social status within the tribe. It is believed that the less common the name he or she is given, the more socially privileged he or she is.

The leader of the tribe is a professional linguist. He notices that hard-to-pronounce names are uncommon, and the reason is that they have too many **consecutive consonants**. Therefore, he announces that the social status of a member in the tribe is determined by its n-value, which is the number of substrings with at least $n$ consecutive consonants in the name. For example, when $n = 3$, the name "quartz" has the n-value of $4$ because the substrings quartz, uartz, artz, and rtz have at least $3$ consecutive consonants each. A greater n-value means a greater social status in the tribe. Two substrings are considered different if they begin or end at a different point (even if they consist of the same letters), for instance "tsetse" contains $11$ substrings with two consecutive consonants, even though some of them (like "tsetse" and "tsetse") contain the same letters.

All members in the tribe must have their names and $n$ given by the leader. Although the leader is a linguist and able to ensure that the given names are meaningful, he is not good at calculating the n-values. Please help the leader determine the n-value of each name. Note that different names may have different values of $n$ associated with them.
## 输入格式

The first line of the input gives the number of test cases, $T$. $T$ test cases follow. The first line of each test case gives the name of a member as a string of length $L$, and an integer $n$. Each name consists of one or more lower-case English letters.

## 输出格式

For each test case, output one line containing "Case #x: y", where $x$ is the case number (starting from $1$) and $y$ is the n-value of the member's name.
## 样例

### 样例输入 #1
```
4
quartz 3
straight 3
gcj 2
tsetse 2
```
### 样例输出 #1
```
Case #1: 4
Case #2: 11
Case #3: 3
Case #4: 11
```
## 提示

**Limits**

- $1 \leqslant T \leqslant 100$.
- $0 < n \leqslant L$.

**Small dataset (8 Pts, Test set 1 - Visible)**

- $1 \leqslant L \leqslant 100$.

**Large dataset (20 Pts, Test set 2 - Hidden)**

- $1 \leqslant L \leqslant 10^6$.
- The input file will be no larger than 6MB.


---

---
title: "[GCJ 2008 #1B] Crop Triangles"
layout: "post"
diff: 普及/提高-
pid: P13460
tag: ['数学', '2008', '组合数学', 'Google Code Jam']
---
# [GCJ 2008 #1B] Crop Triangles
## 题目描述

Some pranksters have watched too much Discovery Channel and now they want to build a crop triangle during the night. They want to build it inside a large crop that looks like an evenly spaced grid from above. There are some trees planted on the field. Each tree is situated on an intersection of two grid lines (a grid point). The pranksters want the vertices of their crop triangle to be located at these trees. Also, for their crop triangle to be more interesting they want the center of that triangle to be located at some grid point as well. We remind you that if a triangle has the vertices $(x_1, y_1)$, $(x_2, y_2)$ and $(x_3, y_3)$, then the center for this triangle will have the coordinates $((x_1 + x_2 + x_3) / 3, (y_1 + y_2 + y_3) / 3)$.

You will be given a set of points with integer coordinates giving the location of all the trees on the grid. You are asked to compute how many triangles you can form with distinct vertexes in this set of points so that their center is a grid point as well (i.e. the center has integer coordinates).

If a triangle has area 0 we will still consider it a valid triangle.
## 输入格式

The first line of input gives the number of cases, $N$. $N$ test cases follow. Each test case consists of one line containing the integers $n$, $A$, $B$, $C$, $D$, $x_0$, $y_0$ and $M$ separated by exactly one space. $n$ will be the number of trees in the input set. Using the numbers $n$, $A$, $B$, $C$, $D$, $x_0$, $y_0$ and $M$ the following pseudocode will print the coordinates of the trees in the input set. $mod$ indicates the remainder operation.

The parameters will be chosen such that the input set of trees will not have duplicates.

```
X = x0, Y = y0
print X, Y
for i = 1 to n-1
  X = (A * X + B) mod M
  Y = (C * Y + D) mod M
  print X, Y
```
## 输出格式

For each test case, output one line containing "Case #$X$: " where $X$ is the test case number (starting from 1). This should be followed by an integer indicating the number of triangles which can be located at 3 distinct trees and has a center that is a grid point.

## 样例

### 样例输入 #1
```
2
4 10 7 1 2 0 1 20
6 2 0 2 1 1 2 11
```
### 样例输出 #1
```
Case #1: 1
Case #2: 2
```
## 提示

**Sample Explanation**

In the first test case, the $4$ trees in the generated input set are $(0, 1), (7, 3), (17, 5), (17, 7)$.

**Limits**

- $1 \leq N \leq 10$,
- $0 \leq A, B, C, D, x_0, y_0 \leq 10^9$,
- $1 \leq M \leq 10^9$.

**Small dataset (5 Pts, Test set 1 - Visible)**

- $3 \leq n \leq 100$.

**Large dataset (10 Pts, Test set 2 - Hidden)**

- $3 \leq n \leq 100000$.



---

---
title: "车的放置"
layout: "post"
diff: 普及/提高-
pid: P1350
tag: ['递推', '福建省历届夏令营', '组合数学', '排列组合']
---
# 车的放置
## 题目描述

有下面这样的一个网格棋盘，$a,b,c,d$ 表示了对应边长度，也就是对应格子数：

![](https://cdn.luogu.com.cn/upload/image_hosting/g7ulpevu.png)

当 $a=b=c=d=2$ 时，对应下面这样一个棋盘：

![](https://cdn.luogu.com.cn/upload/image_hosting/e2ntmjlk.png)

要在这个棋盘上放 $k$ 个相互不攻击的车，也就是这 $k$ 个车没有两个车在同一行，也没有两个车在同一列，问有多少种方案。

## 输入格式

只有一行，为五个非负整数，分别代表 $a,b,c,d$ 和 $k$。

## 输出格式

输出一行一个整数代表答案 $\bmod$ $10^5+3$ 后的结果。
## 样例

### 样例输入 #1
```
2 2 2 2 2
```
### 样例输出 #1
```
38

```
## 提示

#### 数据规模与约定

- 存在部分数据，保证 $b=0$；
- 存在部分数据，保证 $a,b,c,d\leq 4$。
- 对于 $100\%$ 的数据，保证 $0\leq a,b,c,d,k\leq 10^3$，且至少有一种可行方案。


---

---
title: "「WWOI R1」WsW 的笔"
layout: "post"
diff: 普及/提高-
pid: P13561
tag: ['数学', 'O2优化', '组合数学', '容斥原理']
---
# 「WWOI R1」WsW 的笔
## 题目背景

WsW 准备送几支笔给 bln。
## 题目描述

WsW 有 $b-a+1$ 支笔，每支笔的编号为 $a\sim b$ 的正整数，且笔的编号互不相同。他决定送若干支笔给 bln，并将剩余的笔留给自己。   

当所有的笔都满足以下条件时，WsW 认为这种送笔方案是**优秀送笔方案**：  
* 如果将编号为 $x$ 的笔送给 bln，那么必须将编号为 $x/k$ 的笔留给自己。  
* 如果将编号为 $x$ 的笔留给自己，那么必须将编号为 $x/k$ 的笔送给 bln。  

	当然，这些条件的前提是 WsW 有编号为 $x/k$ 的笔。

WsW 认为，如果某个编号的笔在一种方案中被送出，在另一种方案中被留下，则这两种送笔方案是不同的。

现在所有的笔都已经被 WsW 编完号了，WsW 想知道一共有多少种**不同的优秀送笔方案**。  

由于最后的结果可能很大，你只需要告诉 WsW 总方案数对 $10^9+7$ 取模后的值。
## 输入格式

**本题有多组测试数据。**  

输入的第一行包含一个正整数 $T$，表示数据组数。  

接下来包含 $T$ 组数据，每组数据的格式如下：  

第一行输入一个正整数 $k$。  

第二行输入两个正整数 $a,b$，表示笔编号的范围。
## 输出格式

对于每组数据：输出一行包含一个整数，表示有多少种**不同的优秀送笔方案**。答案对 $10^9+7$ 取模。
## 样例

### 样例输入 #1
```
1
2
2 2
```
### 样例输出 #1
```
2
```
### 样例输入 #2
```
1
3
1 4
```
### 样例输出 #2
```
8
```
### 样例输入 #3
```
1
114
514 1919810
```
### 样例输出 #3
```
532406817
```
## 提示

### 【样例 $1$ 解释】

|方案|送出编号|留下编号|
|:-:|:-:|:-:|
|$1$|$2$|无|
|$2$|无|$2$|

共 $2$ 种不同的优秀送笔方案。

### 【样例 $2$ 解释】

|方案|送出编号|留下编号|
|:-:|:-:|:-:|
|$1$|$1$|$2,3,4$|
|$2$|$1,2$|$3,4$|
|$3$|$1,4$|$2,3$|
|$4$|$1,2,4$|$3$|
|$5$|$3$|$1,2,4$|
|$6$|$2,3$|$1,4$|
|$7$|$3,4$|$1,2$|
|$8$|$2,3,4$|$1$|

共 $8$ 种不同的优秀送笔方案。

### 【数据范围】
**本题采用捆绑测试**。

对于所有测试数据，保证 $1\le T\le 5$，$1\le a\le b\le 10^{18}$，$2\le k\le10^{5}$。

| 子任务编号 | $a,b\leq$ | 特殊性质 | 分值 |
| :-: | :-: | :-: | :-: |
| $1$ | $20$ | 无 | $10$ |
| $2$ | $10^3$ | 无 | $10$ |
| $3$ | $10^5$ | B | $5$ |
| $4$ | ^ | 无 | $10$ |
| $5$ | $7\times10^6$ | A | $5$ |
| $6$ | ^ | B | $5$ |
| $7$ | ^ | 无 | $15$ |
| $8$ | $10^{18}$ | A | $5$ |
| $9$ | ^ | B | $10$ |
| $10$ | ^ | 无 | $25$ |

* 特殊性质 A：$a\times k>b$。  

* 特殊性质 B：$k=2$。  



---

---
title: "跑步"
layout: "post"
diff: 普及/提高-
pid: P1806
tag: ['动态规划 DP', '数学', 'NOI 导刊', '组合数学']
---
# 跑步
## 题目描述

路人甲准备跑 $n$ 圈来锻炼自己的身体，他准备分多次（$\gt1$）跑完，每次都跑正整数圈，然后休息下再继续跑。

为了有效地提高自己的体能，他决定每次跑的圈数都必须比上次跑的多。

可以假设他刚开始跑了 $0$ 圈，那么请问他可以有多少种跑完这 $n$ 圈的方案？
## 输入格式

一行一个整数，代表 $n$。
## 输出格式

一个整数表示跑完这 $n$ 圈的方案数。
## 样例

### 样例输入 #1
```
212
```
### 样例输出 #1
```
995645335
```
## 提示

#### 数据规模与约定

对于 $100\%$ 的数据，保证 $5\le n\le 500$。


---

---
title: "对角线"
layout: "post"
diff: 普及/提高-
pid: P2181
tag: ['数学', '洛谷原创', '组合数学']
---
# 对角线
## 题目描述

对于一个 $n$ 个顶点的凸多边形，它的任何三条对角线都不会交于一点。请求出图形中对角线交点的个数。

例如，$6$ 边形：

![](https://cdn.luogu.com.cn/upload/pic/6023.png)
## 输入格式

输入只有一行一个整数 $n$，代表边数。
## 输出格式

输出一行一个整数代表答案。
## 样例

### 样例输入 #1
```
3
```
### 样例输出 #1
```
0
```
### 样例输入 #2
```
6
```
### 样例输出 #2
```
15
```
## 提示

#### 数据规模与约定

- 对于 $50 \%$ 的数据，保证 $3 \leq n \leq 100$。
- 对于 $100 \%$ 的数据，保证 $3 \leq n \leq 10^5$。


---

---
title: "[NOIP 2016 提高组] 组合数问题"
layout: "post"
diff: 普及/提高-
pid: P2822
tag: ['数学', '2016', 'NOIP 提高组', '组合数学']
---
# [NOIP 2016 提高组] 组合数问题
## 题目背景

NOIP2016 提高组 D2T1
## 题目描述

组合数 $\binom{n}{m}$ 表示的是从 $n$ 个物品中选出 $m$ 个物品的方案数。举个例子，从 $(1,2,3)$ 三个物品中选择两个物品可以有 $(1,2),(1,3),(2,3)$ 这三种选择方法。根据组合数的定义，我们可以给出计算组合数 $\binom{n}{m}$ 的一般公式：

$$\binom{n}{m}=\frac{n!}{m!(n-m)!}$$

其中 $n!=1\times2\times\cdots\times n$；特别地，定义 $0!=1$。

小葱想知道如果给定 $n,m$ 和 $k$，对于所有的 $0\leq i\leq n,0\leq j\leq \min \left ( i, m \right )$ 有多少对 $(i,j)$ 满足 $k\mid\binom{i}{j}$。
## 输入格式

第一行有两个整数 $t,k$，其中 $t$ 代表该测试点总共有多少组测试数据，$k$ 的意义见问题描述。

接下来 $t$ 行每行两个整数 $n,m$，其中 $n,m$ 的意义见问题描述。
## 输出格式

共 $t$ 行，每行一个整数代表所有的 $0\leq i\leq n,0\leq j\leq \min \left ( i, m \right )$ 中有多少对 $(i,j)$ 满足 $k\mid\binom{i}{j}$。
## 样例

### 样例输入 #1
```
1 2
3 3
```
### 样例输出 #1
```
1
```
### 样例输入 #2
```
2 5
4 5
6 7
```
### 样例输出 #2
```
0
7

```
## 提示

【样例1说明】

在所有可能的情况中，只有 $\binom{2}{1} = 2$ 一种情况是 $2$ 的倍数。

【子任务】

![](https://cdn.luogu.com.cn/upload/pic/3457.png)

- 对于全部的测试点，保证 $0 \leq n, m \leq 2 \times 10^3$，$1 \leq t \leq 10^4$。


---

---
title: "[HNOI2008] 越狱"
layout: "post"
diff: 普及/提高-
pid: P3197
tag: ['数学', '2008', '各省省选', '湖南', 'O2优化', '组合数学', '容斥原理']
---
# [HNOI2008] 越狱
## 题目描述

监狱有 $n$ 个房间，每个房间关押一个犯人，有 $m$ 种宗教，每个犯人会信仰其中一种。如果相邻房间的犯人的宗教相同，就可能发生越狱，求有多少种状态可能发生越狱。

答案对 $100,003$ 取模。
## 输入格式

输入只有一行两个整数，分别代表宗教数 $m$ 和房间数 $n$。
## 输出格式

输出一行一个整数代表答案。
## 样例

### 样例输入 #1
```
2 3

```
### 样例输出 #1
```
6
```
## 提示

#### 样例输入输出 1 解释

| 状态编号 | 1 号房间 | 2 号房间 | 3 号房间 |
| :--------: | :--------: | :-------: | :--------: |
| 1 | 信仰 1 | 信仰 1 | 信仰 1 |
| 2 | 信仰 1 | 信仰 1 | 信仰 2 |
| 3 | 信仰 1 | 信仰 2 | 信仰 2 |
| 4 | 信仰 2 | 信仰 1 | 信仰 1 |
| 5 | 信仰 2 | 信仰 2 | 信仰 2 |
| 6 | 信仰 2 | 信仰 2 | 信仰 1 |

#### 数据规模与约定

对于 $100\%$ 的数据，保证 $1 \le m \le 10^8$，$1 \le n \le 10^{12}$。


---

---
title: "SAC#1 - 组合数"
layout: "post"
diff: 普及/提高-
pid: P3414
tag: ['数学', '组合数学', '洛谷月赛']
---
# SAC#1 - 组合数
## 题目描述


今天小明学习了组合数，现在他很想知道 $\sum \rm{C}$$_{n}^{i}$ 是多少。其中 $\rm{C}$ 是组合数（即 $\rm{C}$$_{n}^{i}$ 表示 $n$ 个物品无顺序选取 $i$ 个的方案数），$i$ 取从 $0$ 到 $n$ 的所有偶数。

由于答案可能很大，请输出答案对 $6662333$ 的余数。
## 输入格式

输入仅包含一个整数 $n$。
## 输出格式

输出一个整数，即为答案。

## 样例

### 样例输入 #1
```
3
```
### 样例输出 #1
```
4
```
## 提示

对于 $20\%$ 的数据，$n \le 20$；

对于 $50\%$ 的数据，$n \le 10^{3}$；

对于 $100\%$ 的数据，$n \le 10^{18}$。


---

---
title: "小 Y 拼木棒"
layout: "post"
diff: 普及/提高-
pid: P3799
tag: ['洛谷原创', '枚举', '组合数学']
---
# 小 Y 拼木棒
## 题目背景

上道题中，小 Y 斩了一地的木棒，现在她想要将木棒拼起来。
## 题目描述

有 $n$ 根木棒，现在从中选 $4$ 根，想要组成一个正三角形，问有几种选法？

答案对 $10^9+7$ 取模。
## 输入格式

第一行一个整数 $n$。

第二行往下 $n$ 行，每行 $1$ 个整数，第 $i$ 个整数 $a_i$ 代表第 $i$ 根木棒的长度。
## 输出格式

一行一个整数代表答案。

## 样例

### 样例输入 #1
```
4 
1
1
2
2
```
### 样例输出 #1
```
1
```
## 提示

#### 数据规模与约定

- 对于 $30\%$ 的数据，保证 $n \le 5 \times 10^3$。
- 对于 $100\%$ 的数据，保证 $1 \leq n \le 10^5$，$1 \le a_i \le 5 \times 10^3$。

关于标题：因为一些不可抗力的原因，名称进行了更改。深表歉意。


---

---
title: "父子"
layout: "post"
diff: 普及/提高-
pid: P4981
tag: ['组合数学', 'Prüfer 序列']
---
# 父子
## 题目背景

上演在各大学男生寝室的日常 $:$

$A :$ “我没带纸，快来厕所救我！”

$B :$ “叫爸爸。”

$A :$ “爸爸！”

$............................................$

$A :$ “我没钱了，能借我点吗。”

$B :$ “叫爸爸。”

$A :$ “爸爸！”

一个月后、

$B :$ “能把钱还给我吗。”

$A :$ “叫爸爸。”

$B :$ “爸爸！”
## 题目描述

对于全国各大大学的男生寝室，总是有各种混乱的父子关系。

那么假设现在我们一个男生寝室有不同的 $n$ 个人，每个人都至多有一个“爸爸”，可以有多个“儿子”，且有且只有一个人没有“爸爸”(毕竟是室长，还是要给点面子，当然了，室长人人当嘛)。

那么现在问题来了，对于一个有 $n$ 个人的寝室，最多可能存在多少种父子关系，当然每个人之间都必须要有直接或间接的父子关系。
## 输入格式

第一行一个非负整数 $t$，表示有 $t$ 组数据。

接下来 $t$ 行，每行一个整数 $n$，表示有 $n$ 个人。
## 输出格式

共 $t$ 行，每行一个整数，求关系个数。

由于答案可能较大，则我们需要输出答案对 $10^9+9$ 取模的值。
## 样例

### 样例输入 #1
```
1
3

```
### 样例输出 #1
```
9
```
### 样例输入 #2
```
1
323

```
### 样例输出 #2
```
283888610
```
## 提示

- 对于 $10\%$ 的数据，保证 $t=0$；

- 另有 $30\%$ 的数据，保证 $n≤5$；

- 对于 $100\%$ 的数据，$t≤10^4$，$1\le n\le10^9$。



---

---
title: "[yLOI2019] 青原樱"
layout: "post"
diff: 普及/提高-
pid: P5520
tag: ['动态规划 DP', '数学', '2019', 'O2优化', '组合数学', '排列组合']
---
# [yLOI2019] 青原樱
## 题目背景

> 星川之下皆萤火尘埃，  
> 我独行在人潮你天真而待。  
> 相遇若是借丹青着色，  
> 青原上 绯樱如海。

——银临《青原樱》(Cover 人衣大人)
## 题目描述

扶苏是一个非常喜欢边听古风鸽边写数学题的人，因此这道题其实是个五三原题。

扶苏希望重现青原上樱花盛开的景色，于是他准备了很多**互不相同**樱花树幼苗，准备种成一行。

这一行中，一共有 $n$ 个位置可以种下樱花，而扶苏准备了 $m$ 支幼苗。由于樱花盛放时对左右空间需求非常大，所以樱花不能紧挨着种植，也就是任意两支幼苗之间必须至少存在一个不种花的空位置。

按照这种方式种花并不难，但是令扶苏感到好奇的是一共有多少合法的方案让他把这 $m$ 支幼苗都种下去。一个方案是合法的当且仅当他满足上一段中叙述的要求。如果我们将花按照 $1,2,3,\dots,m$ 编号，两种方案不同当且仅当被选择种花的位置不同或从左向右数花的编号序列不同。

为了避免输出过大，答案对一个参数 $p$ 取模。
## 输入格式

每个输入文件中有且仅有一组测试数据。

测试数据只有一行四个整数，依次代表 $type,~n,~m,~p$，其中 $type$ 是一个帮助你判断测试点类型的参数，会在数据范围中说明。 
## 输出格式

输出一行一个整数，代表答案对 $p$ 取模的结果。

## 样例

### 样例输入 #1
```
1 3 2 19260718
```
### 样例输出 #1
```
2
```
## 提示

#### 样例输入输出 1 解释
一共有 $2$ 个樱花幼苗， $3$ 个种花的位置，如果给幼苗编号为 $1,~2$，位置编号为 $1,~2,~3$，那么两种方案分别如下：

| 位置 | $1$ | $2$ | $3$ |
| :---: | :---: | :---: | :---: |
| 方案 1 | 幼苗 $1$ | 空 | 幼苗 $2$ |
| 方案 2 | 幼苗 $2$ | 空 | 幼苗 $1$ |

---

#### 数据规模与约定

**本题采用多测试点捆绑测试，共有 6 个子任务**。

| 子任务编号 | $n \leq$ | $m \leq$ | $type=$ | 特殊性质 | 子任务分值 |
| :----------: | :--------: | :----------: | :-------: | :--------: | :-----------: |
| 1 | $1$ | $1$ | $0$ | 特殊性质 1 | $5$ |
| 2 | $20$ | $20$ | $1$ | 特殊性质 1 | $15$ |
| 3 | $400$ | $200$ | $2$ | 无 | $20$ |
| 4 | $2000$ | $2000$ | $3$ | 无 | $20$ |
| 5 | $2000000$ | $1000000$ | $4$| 特殊性质 2 | $20$ | 
| 6 | $2000000$ | $1000000$ | $5$| 无 | $20$ | 

特殊性质 1：保证对应测试点的**实际**方案数(在取模前)不超过 $10^6$

特殊性质 2：保证 $p$ 是一个质数。

对于 $100\%$ 的数据，保证：
- $1 \leq n \leq 2 \times 10^6$。
- $1 \leq m \leq 10^6 $。
- $1 \leq p \leq 10^9$。
- $1 \leq m \leq \lceil\frac{n}{2} \rceil$。

---

#### 提示

- 请使用合适的数据类型来进行运算，避免溢出。
- 参数 $type$ 可以帮助你快速的判断子任务编号。



---

---
title: "[USACO09FEB] Bulls And Cows S"
layout: "post"
diff: 普及/提高-
pid: P6191
tag: ['数学', '递推', '2009', 'USACO', '组合数学', '前缀和']
---
# [USACO09FEB] Bulls And Cows S
## 题目背景

一年一度的展会要来临了，Farmer John 想要把 $N$（$1 \leq N \leq 100,000$）只奶牛和公牛安排在单独的一行中。 John 发现最近公牛们非常好斗；假如两只公牛在这一行中靠的太近，他们就会吵架，以至于斗殴，破坏这和谐的环境。
## 题目描述

John 非常的足智多谋，他计算出任何两只公牛之间至少要有 $K$（$0 \leq K \lt N$）只奶牛，这样才能避免斗殴。John 希望你帮助他计算一下有多少种安排方法，可避免任何斗殴的的发生。John 认为每头公牛都是一样的，每头奶牛都是一样的。因而，只要在一些相同的位置上有不同种类的牛，那这就算两种不同的方法。
## 输入格式

两个整数 $N$ 和 $K$。
## 输出格式

输出约翰可以安排的方法数。考虑到这个数可能很大，你只要输出对 $5\,000\,011$ 取模之后的结果就可以了。
## 样例

### 样例输入 #1
```
4 2
```
### 样例输出 #1
```
6
```
## 提示

下面的就是 FJ 思考出可行的 6 种方案（C 代表奶牛，B 代表公牛）：
- CCCC
- BCCC
- CBCC
- CCBC
- CCCB
- BCCB


---

---
title: "[COCI 2006/2007 #2] SJECIŠTA"
layout: "post"
diff: 普及/提高-
pid: P7900
tag: ['2006', 'O2优化', '组合数学', 'COCI（克罗地亚）']
---
# [COCI 2006/2007 #2] SJECIŠTA
## 题目描述

考虑一个有 $n$ 个顶点的凸多边形，且这个多边形没有任何三个（或以上）的对角线交于一点。

现在请你求出这样的多边形的对角线交点个数。
## 输入格式

输入一行一个整数表示 $n$。
## 输出格式

输出一行一个整数表示答案。
## 样例

### 样例输入 #1
```
3

```
### 样例输出 #1
```
0
```
### 样例输入 #2
```
4

```
### 样例输出 #2
```
1
```
### 样例输入 #3
```
6

```
### 样例输出 #3
```
15
```
## 提示

### 样例 3 解释
![](https://cdn.luogu.com.cn/upload/image_hosting/07pgpeuy.png)

### 数据规模与约定

对于全部的测试点，保证 $3 \leq n \leq 100$。


---

---
title: "炼金术（Alchemy）"
layout: "post"
diff: 普及/提高-
pid: P8557
tag: ['数学', '洛谷原创', '组合数学', '容斥原理']
---
# 炼金术（Alchemy）
## 题目描述

铃是一个爱玩游戏的女孩子。

她在游戏中想要炼制一种稀有合金 —— 这需要 $n$ 种金属来合成。

她准备好矿石后建造了 $k$ 个不同的熔炉，当熔炉启动时，会随机炼出这 $n$ 种金属中的一些（也可能什么都没有）。

如果把每个熔炉炼出的金属收集起来，有了全部 $n$ 种金属，就能造出合金了。澪对此很好奇，对铃说：「我考考你，有多少种情况可以炼出合金呢？」这个简单的问题铃很快就会做了，你能求出结果吗？

答案可能很大，请对 $998244353$ 取模（即除以 $998244353$ 的余数）后输出。
## 输入格式

输入一行两个正整数 $n,k$。
## 输出格式

输出一行一个整数，表示答案。
## 样例

### 样例输入 #1
```
2 2
```
### 样例输出 #1
```
9
```
### 样例输入 #2
```
4 5
```
### 样例输出 #2
```
923521
```
### 样例输入 #3
```
233 123
```
### 样例输出 #3
```
81633405
```
## 提示

【样例一解释】  
对于所有成功情况，两个熔炉中的金属如下表：

| 一号  | 二号 |
| :----------: | :----------: |
| $\varnothing$ | $\{1,2\}$ |
| $\{1\}$ | $\{2\}$ |
| $\{1\}$ | $\{1,2\}$ |
| $\{2\}$ | $\{1\}$ |
| $\{2\}$ | $\{1,2\}$ |
| $\{1,2\}$ | $\varnothing$ |
| $\{1,2\}$ | $\{1\}$ |
| $\{1,2\}$ | $\{2\}$ |
| $\{1,2\}$ | $\{1,2\}$ |

一共 $9$ 种，因此答案为 $9$。

【数据范围】  
对于 $30\%$ 的数据，$1\le n,k \le 10$；  
对于 $80\%$ 的数据，$1\le n,k \le 10^6$；  
对于 $100\%$ 的数据，$1\le n,k \le 10^9$。


---

---
title: "[蓝桥杯 2021 国 ABC] 123"
layout: "post"
diff: 普及/提高-
pid: P8762
tag: ['2021', '枚举', '组合数学', '蓝桥杯国赛']
---
# [蓝桥杯 2021 国 ABC] 123
## 题目描述

小蓝发现了一个有趣的数列, 这个数列的前几项如下:

$1,1,2,1,2,3,1,2,3,4, \ldots$

小蓝发现, 这个数列前 $1$ 项是整数 $1$ , 接下来 $2$ 项是整数 $1$ 至 $2$ , 接下来 $3$ 项是整数 $1$ 至 $3$ , 接下来 $4$ 项是整数 $1$ 至 $4$ , 依次类推。

小蓝想知道, 这个数列中, 连续一段的和是多少。
## 输入格式

输入的第一行包含一个整数 $T$, 表示询问的个数。

接下来 $T$ 行, 每行包含一组询问, 其中第 $i$ 行包含两个整数 $l_{i}$ 和 $r_{i}$, 表示 询问数列中第 $l_{i}$ 个数到第 $r_{i}$ 个数的和。
## 输出格式

输出 $T$ 行, 每行包含一个整数表示对应询问的答案。
## 样例

### 样例输入 #1
```
3
1 1
1 3
5 8
```
### 样例输出 #1
```
1
4
8
```
## 提示

对于 $10 \%$ 的评测用例, $1 \leq T \leq 30,1 \leq l_{i} \leq r_{i} \leq 100$ 。

对于 $20 \%$ 的评测用例, $1 \leq T \leq 100,1 \leq l_{i} \leq r_{i} \leq 1000$ 。

对于 $40 \%$ 的评测用例, $1 \leq T \leq 1000,1 \leq l_{i} \leq r_{i} \leq 10^{6}$ 。

对于 $70 \%$ 的评测用例, $1 \leq T \leq 10000,1 \leq l_{i} \leq r_{i} \leq 10^{9}$ 。

对于 $80 \%$ 的评测用例, $1 \leq T \leq 1000,1 \leq l_{i} \leq r_{i} \leq 10^{12}$ 。

对于 $90 \%$ 的评测用例, $1 \leq T \leq 10000,1 \leq l_{i} \leq r_{i} \leq 10^{12}$ 。

对于所有评测用例, $1 \leq T \leq 100000,1 \leq l_{i} \leq r_{i} \leq 10^{12}$ 。 

蓝桥杯 2021 国赛 A 组 E 题（B 组 F 题，C 组 F 题）。


---

---
title: "「DTOI-5」进行一个排的重 (Minimum Version)"
layout: "post"
diff: 普及/提高-
pid: P9306
tag: ['2023', '洛谷原创', 'O2优化', '排列组合', '构造']
---
# 「DTOI-5」进行一个排的重 (Minimum Version)
## 题目背景

**本题与 Maximum Version 的区别是所求最值和数据范围不同。**

小 L 热衷于重排数列使之规整。
## 题目描述

小 L 有一个长为 $n$ 的序列 $a$，其中每一项 $a_i$ 都是一个 pair $(p_i, q_i)$。

为了让 $a$ 看起来规整一些，他钦定 $p, q$ 分别均为长为 $n$ 的排列。

为了对 $a$ 的规整程度进行量化计算，他给出了一个权值函数 $f(a) = \displaystyle\sum_{i = 1}^n ([p_i > \max_{j = 1}^{i - 1} p_j] + [q_i > \max_{j = 1}^{i - 1} q_j])$。**注意 $i = 1$ 时两个方括号都能取到值，因为我们认为 $\displaystyle\max_{j = 1}^0 p_j = \displaystyle\max_{j = 1}^0 q_j = -\infty$。**

为了让 $a$ 看起来更加规整，他决定分别以某种方式重排 $a$ 得到 $a'$ 使得 $f(a')$ 最小。**注意重排时必须将 $a'_i = (p'_i, q'_i)$ 视为整体。**

他希望你求出 $f(a')_{\min}$ 的值，以及分别有多少个 $a'$ 可以取到 $f(a')_{\min}$。

由于方案数可能很大，你只需要求出结果对 $998244353$ 取模的值。
## 输入格式

第一行，一个整数 $n$；

第二行，$n$ 个整数 $p_1, p_2, \cdots, p_n$；

第三行，$n$ 个整数 $q_1, q_2, \cdots, q_n$。
## 输出格式

一行，两个整数，表示所求的值。
## 样例

### 样例输入 #1
```
5
1 5 2 4 3
1 4 2 5 3
```
### 样例输出 #1
```
3 48
```
## 提示

**【数据范围】**

$$
\def\or{\operatorname{or}}
%\def\arrayscretch{1.5}
\def\arraystretch{1.5}
\begin{array}{|c|c|c|}\hline
\textbf{Subtask}&n\le &\textbf{Points}\cr\hline
\sf1&10&10 \operatorname{pts}\cr\hline
\sf2&500&20 \operatorname{pts}\cr\hline
\sf3&5\times10^3&20 \operatorname{pts}\cr\hline
\sf4&10^5&20 \operatorname{pts}\cr\hline
\sf5&5\times10^5&30 \operatorname{pts}\cr\hline
\end{array}
$$

对于 $100\%$ 的数据，$1 \leq n \leq 5 \times 10^5$，$1 \leq p_i, q_i \leq n$，保证 $p, q$ 均为**排列**。


---


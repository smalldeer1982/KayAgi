---
title: "[中山市赛 2024] 糖果共享"
layout: "post"
diff: 普及/提高-
pid: B4187
tag: ['动态规划 DP', '递推', '2024', '广东', '科创活动', '小学活动']
---
# [中山市赛 2024] 糖果共享
## 题目描述

Jimmy 要和其他同学们一起分享老师带来的糖果了！可是，老师不想让同学们这么快就领到糖果，于是决定跟大家玩一个分享糖果的游戏。

老师让 $n$ 个同学们围成一圈坐在一起。接下来，对于第 $i$ 个同学，老师会在第 $t_i$ 秒发给 TA 一份糖果；每次得到糖果之后，第 $i$ 个同学会固定等待 $p_i$ 秒，然后把糖果分给身旁的第 $i + 1$ 个同学（特殊的情况是，第 $n$ 个同学会把糖果分给第 $1$ 个同学）。注意每个同学既可以从老师那里得到糖果，也可以从旁边的同学那里得到糖果，而且老师发的糖果足够多，同学们只要收到了糖果，就一定能将糖果分出去。同学们的分糖果动作非常快，可以认为是不占用时间的。

在参与游戏的同时，Jimmy 很想知道他的几个好朋友们最快什么时候能得到糖果。你能帮帮他吗？
## 输入格式

第一行一个整数 $n$，表示同学们的数量。

第二行 $n$ 个整数 $t_1, t_2, \dots , t_n$，表示每个同学收到老师给的糖果的时刻。

第三行 $n$ 个整数 $p_1, p_2, \dots , p_n$，表示每个同学收到糖果之后、将糖果分出去之前等待的时间。

第四行一个整数 $q$，表示 Jimmy 的询问数量。

接下来 $q$ 行，每行一个整数 $x_i$，表示 Jimmy 想问第 $x_i$ 个同学最快什么时候得到糖果。
## 输出格式

输出共 $q$ 行，每行一个整数，表示每个询问对应的答案。
## 样例

### 样例输入 #1
```
3
3 10 13
4 1 5
2
2
3
```
### 样例输出 #1
```
7
8
```
### 样例输入 #2
```
4
1 1 1 1
100 100 100 100
3
3
4
1
```
### 样例输出 #2
```
1
1
1
```
### 样例输入 #3
```
4
1 2 4 7
1 2 3 4
4
3
3
2
4
```
### 样例输出 #3
```
4
4
2
7
```
### 样例输入 #4
```
8
50 22 63 28 91 60 64 27
84 87 78 16 94 36 87 93
8
1
2
3
4
5
6
7
8
```
### 样例输出 #4
```
50
22
63
28
44
60
64
27
```
## 提示

### 样例解释 1

以下是游戏开始后，每个时刻发生的事件：

1. 第 $3$ 秒，第 $1$ 个同学领到了老师给的一份糖果；
2. 第 $7$ 秒，第 $1$ 个同学将糖果分给了第 $2$ 个同学（糖果是老师给的）；
3. 第 $8$ 秒，第 $2$ 个同学将糖果分给了第 $3$ 个同学（糖果是第 $1$ 个同学给的）；
4. 第 $10$ 秒，第 $2$ 个同学领到了老师给的一份糖果；
5. 第 $11$ 秒，第 $2$ 个同学将糖果分给了第 $3$ 个同学（糖果是老师给的）；
6. 第 $13$ 秒，第 $3$ 个同学领到了老师给的一份糖果；

可知，第 $2$ 个同学最快在第 $7$ 秒得到了糖果；第 $3$ 个同学最快在第 $8$ 秒得到了糖果。接下来，游戏还会继续下去，同学们还会继续互相分糖果，但是不会再改变 Jimmy 问题的答案了。

### 数据范围

- 对于 $30\%$ 的数据，保证 $1 \leq n, q \leq 5000$。
- 对于 $100\%$ 的数据，保证 $1 \leq n, q \leq 2 \times 10^5$，$1 \leq t_i, p_i \leq 10^9$，$1 \leq x_i \leq n$。


---

---
title: "[NOIP 2001 提高组] 数的划分"
layout: "post"
diff: 普及/提高-
pid: P1025
tag: ['搜索', '递推', '2001', 'NOIP 提高组', '剪枝']
---
# [NOIP 2001 提高组] 数的划分
## 题目描述

将整数 $n$ 分成 $k$ 份，且每份不能为空，任意两个方案不相同（不考虑顺序）。

例如：$n=7$，$k=3$，下面三种分法被认为是相同的。

$1,1,5$;   
$1,5,1$;   
$5,1,1$.

问有多少种不同的分法。

## 输入格式

$n,k$ （$6<n \le 200$，$2  \le k  \le  6$）

## 输出格式

$1$ 个整数，即不同的分法。

## 样例

### 样例输入 #1
```
7 3

```
### 样例输出 #1
```
4

```
## 提示

四种分法为：  
$1,1,5$;  
$1,2,4$;  
$1,3,3$;  
$2,2,3$.

**【题目来源】**

NOIP 2001 提高组第二题


---

---
title: "[UESTCPC 2024] Add"
layout: "post"
diff: 普及/提高-
pid: P10329
tag: ['数学', '递推', '2024', 'O2优化', '高校校赛']
---
# [UESTCPC 2024] Add
## 题目描述

给定一个长度为 $n$ 的序列 $a_1,a_2,\ldots,a_n$，初始时 $a_i=i$。对该序列进行 $n-1$ 次操作，其中第 $i$ 次操作为在 $[1,n-i]$ 中等概率选择一个整数 $j$，令 $a_j$ 变为 $a_j+2a_{n-i+1}$。

求操作完毕后 $a_1$ 的期望 $\bmod\text{ }998244353$ 的值。
## 输入格式

输入第一行一个正整数 $T$ $(1\leq T\leq 10^4)$，表示数据组数。

接下来 $T$ 组数据，每组一行一个正整数 $n$ $(1\leq n\leq 10^9)$，表示序列的长度。
## 输出格式

$T$ 行，每行一个整数表示 $a_1$ 的期望 $\bmod\text{ }998244353$ 的值。
## 样例

### 样例输入 #1
```
3
4
2
5
```
### 样例输出 #1
```
30
5
55
```
### 样例输入 #2
```
3
4
3
5
```
### 样例输出 #2
```
30
14
55
```
### 样例输入 #3
```
3
8
1
3
```
### 样例输出 #3
```
204
1
14
```


---

---
title: "[NOIP 2008 普及组] 传球游戏"
layout: "post"
diff: 普及/提高-
pid: P1057
tag: ['模拟', '动态规划 DP', '递推', '2008', 'NOIP 普及组']
---
# [NOIP 2008 普及组] 传球游戏
## 题目描述

上体育课的时候，小蛮的老师经常带着同学们一起做游戏。这次，老师带着同学们一起做传球游戏。

游戏规则是这样的：$n$ 个同学站成一个圆圈，其中的一个同学手里拿着一个球，当老师吹哨子时开始传球，每个同学可以把球传给自己左右的两个同学中的一个（左右任意），当老师再次吹哨子时，传球停止，此时，拿着球没有传出去的那个同学就是败者，要给大家表演一个节目。

聪明的小蛮提出一个有趣的问题：有多少种不同的传球方法可以使得从小蛮手里开始传的球，传了 $m$ 次以后，又回到小蛮手里。两种传球方法被视作不同的方法，当且仅当这两种方法中，接到球的同学按接球顺序组成的序列是不同的。比如有三个同学 $1$ 号、$2$ 号、$3$ 号，并假设小蛮为 $1$ 号，球传了 $3$ 次回到小蛮手里的方式有 $1 \rightarrow 2 \rightarrow 3 \rightarrow 1$ 和 $1 \rightarrow 3 \rightarrow 2 \rightarrow 1$，共 $2$ 种。

## 输入格式

一行，有两个用空格隔开的整数 $n,m(3 \le n \le 30,1 \le m \le 30)$。

## 输出格式

$1$ 个整数，表示符合题意的方法数。

## 样例

### 样例输入 #1
```
3 3
```
### 样例输出 #1
```
2
```
## 提示

### 数据范围及约定

- 对于 $40\%$ 的数据，满足：$3 \le n \le 30,1 \le m \le 20$；
- 对于 $100\%$ 的数据，满足：$3 \le n \le 30,1 \le m \le 30$。

2008普及组第三题



---

---
title: "[NOIP 2007 普及组] Hanoi 双塔问题"
layout: "post"
diff: 普及/提高-
pid: P1096
tag: ['数学', '高精度', '递推', '2007', '递归', 'NOIP 普及组']
---
# [NOIP 2007 普及组] Hanoi 双塔问题
## 题目描述

给定 A、B、C 三根足够长的细柱，在 A 柱上放有 $2n$ 个中间有孔的圆盘，共有 $n$ 个不同的尺寸，每个尺寸都有两个相同的圆盘，注意这两个圆盘是不加区分的（下图为 $n=3$ 的情形）。

![](https://cdn.luogu.com.cn/upload/image_hosting/mq2iklbv.png)

现要将这些圆盘移到 C 柱上，在移动过程中可放在 B 柱上暂存。要求：

1. 每次只能移动一个圆盘；
2. A、B、C 三根细柱上的圆盘都要保持上小下大的顺序。

任务：设 $A_n$ 为 $2n$ 个圆盘完成上述任务所需的最少移动次数，对于输入的 $n$，输出 $A_n$。


## 输入格式

一个正整数 $n$，表示在 A 柱上放有 $2n$ 个圆盘。

## 输出格式

一个正整数, 为完成上述任务所需的最少移动次数 $A_n$。

## 样例

### 样例输入 #1
```
1
```
### 样例输出 #1
```
2
```
### 样例输入 #2
```
2
```
### 样例输出 #2
```
6
```
## 提示

**限制**

- 对于 $50\%$ 的数据，$1  \le  n  \le  25$；
- 对于 $100\%$ 的数据，$1  \le  n  \le  200$。

**提示**

设法建立 $A_n$ 与 $A_{n-1}$ 的递推关系式。



---

---
title: "杂务"
layout: "post"
diff: 普及/提高-
pid: P1113
tag: ['图论', '递推']
---
# 杂务
## 题目描述

John 的农场在给奶牛挤奶前有很多杂务要完成，每一项杂务都需要一定的时间来完成它。比如：他们要将奶牛集合起来，将他们赶进牛棚，为奶牛清洗乳房以及一些其它工作。尽早将所有杂务完成是必要的，因为这样才有更多时间挤出更多的牛奶。

当然，有些杂务必须在另一些杂务完成的情况下才能进行。比如：只有将奶牛赶进牛棚才能开始为它清洗乳房，还有在未给奶牛清洗乳房之前不能挤奶。我们把这些工作称为完成本项工作的准备工作。至少有一项杂务不要求有准备工作，这个可以最早着手完成的工作，标记为杂务 $1$。

John 有需要完成的 $n$ 个杂务的清单，并且这份清单是有一定顺序的，杂务 $k\ (k>1)$ 的准备工作只可能在杂务 $1$ 至 $k-1$ 中。

写一个程序依次读入每个杂务的工作说明。计算出所有杂务都被完成的最短时间。当然互相没有关系的杂务可以同时工作，并且，你可以假定 John 的农场有足够多的工人来同时完成任意多项任务。

## 输入格式

第1行：一个整数 $n\ (3 \le n \le 10{,}000)$，必须完成的杂务的数目；

第 $2$ 至 $n+1$ 行，每行有一些用空格隔开的整数，分别表示：

- 工作序号（保证在输入文件中是从 $1$ 到 $n$ 有序递增的）；
- 完成工作所需要的时间 $len\ (1 \le len \le 100)$；
- 一些必须完成的准备工作，总数不超过 $100$ 个，由一个数字 $0$ 结束。有些杂务没有需要准备的工作只描述一个单独的 $0$。

保证整个输入文件中不会出现多余的空格。

## 输出格式

一个整数，表示完成所有杂务所需的最短时间。

## 样例

### 样例输入 #1
```
7
1 5 0
2 2 1 0
3 3 2 0
4 6 1 0
5 1 2 4 0
6 8 2 4 0
7 4 3 5 6 0

```
### 样例输出 #1
```
23

```


---

---
title: "繁花"
layout: "post"
diff: 普及/提高-
pid: P11243
tag: ['递推', '洛谷原创', 'O2优化', '洛谷月赛', '双指针 two-pointer']
---
# 繁花
## 题目背景

[English statement](https://www.luogu.com.cn/problem/U505208). **You must submit your code at the Chinese version of the statement.**

我已经知道，在设置好循环播放时就已经知道，我是在麻痹自己，在逃避问题。

我承认如此，可捞起那些沉于水底的细节时，却一瞬间突然和所有所有真实的心跳共鸣。

那时总想的太少，现在常想得太多，不知所措似荒塘里的绿藻蔓延着。

然而这世间情感太多，小 R 也只能体会更开心和更难过。
## 题目描述

小 R 想对上面的问题进行探究，她想先做一些统计，于是她抽象了这个问题。

小 R 有 $n$ 个未知量 $a_1\dots a_n$，对每个 $1 \leq i < n$，她都比较了 $a_i$ 和 $a_{i+1}$ 并写下了一个字符 $c_i \in \{\texttt <, \texttt >, \texttt =\}$，表示两个未知量之间的比较结果。具体地：

- 若 $c_i = \texttt >$，则 $a_i > a_{i+1}$；
- 若 $c_i = \texttt <$，则 $a_i < a_{i+1}$；
- 否则（$c_i = \texttt =$），表示 $a_i = a_{i+1}$。

小 R 称 $\bm{a_i}$ **比** $\bm{a_j}$ **更开心**，当且仅当对任何 **满足上述 $\bm{n - 1}$ 条约束的** $[a_1, \dots, a_n] \in \mathbb R^n$，都有 $a_i < a_j$。请你帮她数出 $1 \leq i, j \leq n$ 且 $a_i$ 比 $a_j$ 更开心的整数数对 $(i, j)$ 个数。

因为要循环播放，所以有多组数据。
## 输入格式

**本题有多组数据。**

第一行，一个整数 $T$，表示数据组数。对于每组数据：

- 第一行一个整数 $n$。
- 接下来一行，一个长度为 $n - 1$ 的字符串 $c_1c_2\dots c_{n-1}$。
## 输出格式

对于每组数据，输出仅一行一个整数，表示符合条件的整数数对个数。
## 样例

### 样例输入 #1
```
5
5
<<<<
7
<=><=<
9
=<<><==<
11
>=<<=>>>=>
13
=><<=<=>=><>

```
### 样例输出 #1
```
10
9
13
29
25

```
## 提示

### 样例解释

- 对于第一组数据，$a_i$ 比 $a_j$ 开心当且仅当 $1 \leq i < j \leq n$，故共有 $\frac{5\times 4}{2} = 10$ 对合法的 $(i, j)$。
- 对于第二组数据，合法的 $(i, j)$ 分别为：$(1, 2), (1, 3), (4, 2), (4, 3), (4, 5), (4, 6), (4, 7), (5, 7), (6, 7)$，共 $9$ 对。
- 对于其他几组数据，聪明的读者可以自行验证。

### 数据规模与约定

**本题采用捆绑测试和子任务依赖。**

- Subtask 0（0 pts）：样例。
- Subtask 1（10 pts）：$n \leq 8$，$T \leq 8$。
- Subtask 2（20 pts）：$n \leq 5000$，$T \leq 8$。依赖于子任务 $0, 1$。
- Subtask 3（20 pts）：$c_i \neq \texttt =$。
- Subtask 4（50 pts）：无特殊限制。依赖于子任务 $0 \sim 3$。

对于所有数据，保证 $2 \leq n \leq 2\times 10^5$，$1 \leq T \leq 10^4$，$c_i \in \{\texttt <, \texttt >, \texttt =\}$，$\sum n \leq 5\times 10^5$。


---

---
title: "旅行计划"
layout: "post"
diff: 普及/提高-
pid: P1137
tag: ['动态规划 DP', '图论', '递推', '排序', '拓扑排序']
---
# 旅行计划
## 题目描述

小明要去一个国家旅游。这个国家有 $N$ 个城市，编号为 $1$ 至 $N$，并且有 $M$ 条道路连接着，小明准备从其中一个城市出发，并只往东走到城市 $i$ 停止。

所以他就需要选择最先到达的城市，并制定一条路线以城市 $i$ 为终点，使得线路上除了第一个城市，每个城市都在路线前一个城市东面，并且满足这个前提下还希望游览的城市尽量多。

现在，你只知道每一条道路所连接的两个城市的相对位置关系，但并不知道所有城市具体的位置。现在对于所有的 $i$，都需要你为小明制定一条路线，并求出以城市 $i$ 为终点最多能够游览多少个城市。
## 输入格式

第一行为两个正整数 $N, M$。

接下来 $M$ 行，每行两个正整数 $x, y$，表示了有一条连接城市 $x$ 与城市 $y$ 的道路，保证了城市 $x$ 在城市 $y$ 西面。

## 输出格式

$N$ 行，第 $i$ 行包含一个正整数，表示以第 $i$ 个城市为终点最多能游览多少个城市。

## 样例

### 样例输入 #1
```
5 6
1 2
1 3
2 3
2 4
3 4
2 5

```
### 样例输出 #1
```
1
2
3
4
3

```
## 提示

均选择从城市 $1$ 出发可以得到以上答案。

- 对于 $20\%$ 的数据，$1\le N ≤ 100$；
- 对于 $60\%$ 的数据，$1\le N ≤ 1000$；
- 对于 $100\%$ 的数据，$1\le N ≤ 100000$，$1\le M ≤ 200000$。



---

---
title: "计数器"
layout: "post"
diff: 普及/提高-
pid: P1239
tag: ['递推']
---
# 计数器
## 题目描述

一本书的页数为 $n$，页码从 $1$ 开始编起，请你求出全部页码中，用了多少个 $0,1,2\cdots 9$。每个页码不含前导 $0$，如 $n=1234$ 时第 $5$ 页不是 $0005$，只是 $5$。

## 输入格式

一个正整数 $n$，表示总的页码。

## 输出格式

输出共十行，其中第 $k$ 行为数字 $k-1$ 的个数。

## 样例

### 样例输入 #1
```
11
```
### 样例输出 #1
```
1
4
1
1
1
1
1
1
1
1
```
## 提示

对于 $100\%$ 数据，满足 $1\le n\le 10^9$。

---

$2022.7.4$：新添加三组 $\text{Hack}$ 数据。


---

---
title: "排序集合"
layout: "post"
diff: 普及/提高-
pid: P1243
tag: ['递推']
---
# 排序集合
## 题目描述

对于集合 $N=\{1,2,\cdots,n\}$ 的子集，定义一个称之为“小于”的关系：

设 $S1=\{X_1,X_2,\cdots,X_i\}$，$(X_1<X_2<\cdots<X_i)$，$S2=\{Y_1,Y_2,\cdots,Y_j\}$，$(Y_1<Y_2<\cdots<Y_j)$，如果存在一个 $k$，$(0\leq k\leq\min(i,j))$，使得 $X_1=Y_1,\cdots,X_k=Y_k$，且 $k=i$ 或 $X_{k+1}<Y_{k+1}$，则称 $S1$ “小于” $S2$。

你的任务是，对于任意的 $n(n\leq31)$ 及 $k(k<2^n)$，求出第 $k$ 小的子集。
## 输入格式

输入文件仅一行，包含两个用空格隔开的自然数，$n$ 和 $k$。
## 输出格式

输出文件仅一行，使该子集的元素，由小到大排列。空集输出 $0$。
## 样例

### 样例输入 #1
```
3 4

```
### 样例输出 #1
```
1 2 3

```


---

---
title: "编码"
layout: "post"
diff: 普及/提高-
pid: P1246
tag: ['递推', '递归', '线性递推']
---
# 编码
## 题目描述

编码工作常被运用于密文或压缩传输。这里我们用一种最简单的编码方式进行编码：把一些有规律的单词编成数字。

字母表中共有 $26$ 个字母 $\mathtt{a,b,c,\cdots,z}$，这些特殊的单词长度不超过 $6$ 且字母按升序排列。把所有这样的单词放在一起，按字典顺序排列，一个单词的编码就对应着它在字典中的位置。

例如：

- $\verb!a! \to 1$；
- $\verb!b! \to 2$；
- $\verb!z! \to 26$；
- $\verb!ab! \to 27$；
- $\verb!ac! \to 28$。

你的任务就是对于所给的单词，求出它的编码。

## 输入格式

仅一行，被编码的单词。

## 输出格式

仅一行，对应的编码。如果单词不在字母表中，输出 $0$。

## 样例

### 样例输入 #1
```
ab


```
### 样例输出 #1
```
27


```


---

---
title: "[KOI 2024 Round 1] 加倍"
layout: "post"
diff: 普及/提高-
pid: P12642
tag: ['贪心', '递推', '2024', 'KOI（韩国）']
---
# [KOI 2024 Round 1] 加倍
## 题目背景

试题来源：<https://koi.or.kr/archives/>。中文翻译做了少量本土化修改。

按照[署名—非商业性使用—相同方式共享 4.0 协议国际版](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans)进行授权。
## 题目描述

给定一个长度为 $N$ 的正整数序列 $A_1, A_2, \dots, A_N$。现在希望将该序列变为升序排列。所谓升序排列，是指对于所有的 $i$（$1 \leq i \leq N - 1$），都有 $A_i \leq A_{i+1}$。

为了将序列 $A$ 排成升序，可以对序列执行以下操作若干次（可为零次）：

- 对于某个 $i$（$1 \leq i \leq N$），将 $A_i$ 乘以 $2$。

你的任务是以最小的操作次数将序列 $A$ 排成升序，并输出所需的最小操作次数。
## 输入格式

第一行输入一个整数 $N$。  
第二行输入 $N$ 个整数，表示 $A_1, A_2, \dots, A_N$，以空格分隔。
## 输出格式

输出一个整数，表示将序列变为升序所需的最小操作次数。
## 样例

### 样例输入 #1
```
5
3 1 4 1 5
```
### 样例输出 #1
```
4
```
### 样例输入 #2
```
5
3 1 5 1 5
```
### 样例输出 #2
```
6
```
### 样例输入 #3
```
5
1 2 3 4 5
```
### 样例输出 #3
```
0
```
## 提示

**样例 1 说明**

对 $A_2$ 和 $A_4$ 各执行两次操作后，序列变为 $[3, 4, 4, 4, 5]$。

**样例 2 说明**

对 $A_2$ 操作两次，$A_4$ 操作三次，$A_5$ 操作一次，最终序列为 $[3, 4, 5, 8, 10]$。

**约束条件**  
- 所有给定的数均为整数。
- $1 \leq N \leq 250\,000$
- $1 \leq A_i \leq 1\,000\,000$，其中 $1 \leq i \leq N$

**子问题**
1. （12 分）对于所有 $i$（$1 \leq i \leq N$），$A_i = 1$ 或 $A_i = 2$
2. （10 分）对于所有 $i$（$1 \leq i \leq N$），存在非负整数 $k_i$，使得 $A_i = 2^{k_i}$
3. （11 分）$N \leq 10$
4. （19 分）对于所有 $i$（$1 \leq i \leq N$），$A_i = 2$ 或 $A_i = 3$
5. （20 分）对于所有 $i$（$1 \leq i \leq N - 1$），$A_i \geq A_{i+1}$
6. （28 分）无额外限制条件

翻译由 ChatGPT-4o 完成


---

---
title: "[GCJ Farewell Round #2] Spacious Sets"
layout: "post"
diff: 普及/提高-
pid: P12953
tag: ['递推', '二分', '2023', 'Google Code Jam']
---
# [GCJ Farewell Round #2] Spacious Sets
## 题目描述

Ada and John are best friends. Since they are getting bored, Ada asks John to solve a puzzle for her.

A set $S$ is considered *spacious* if the absolute difference between each pair of distinct elements of $S$ is at least $\mathbf{K}$, that is, $|x - y| \geq \mathbf{K}$ for all $x, y \in S$, with $x \neq y$.

Ada has a list of distinct integers $\mathbf{A}$ of size $\mathbf{N}$, and an integer $\mathbf{K}$. For each $\mathbf{A}_i$, she asks John to find the maximum size of a set $S_i$ made of elements from $\mathbf{A}$, such that $S_i$ contains $\mathbf{A}_i$ and is spacious.

Note: The sets $S_i$ do not need to be made of consecutive elements from the list.
## 输入格式

The first line of the input gives the number of test cases, $\mathbf{T}$. $\mathbf{T}$ test cases follow. The first line of each test case contains two integers $\mathbf{N}$ and $\mathbf{K}$. The next line contains $\mathbf{N}$ integers $\mathbf{A}_1 \mathbf{A}_2 \ldots \mathbf{A}_{\mathbf{N}}$.

## 输出格式

For each test case, output one line containing Case # $x$: $y_1 \ y_2 \ldots \ y_{\mathbf{N}}$, where $x$ is the test case number (starting from 1) and $y_i$ is the maximum size of a spacious set of elements from $\mathbf{A}$ that contains $\mathbf{A}_i$.
## 样例

### 样例输入 #1
```
2
3 2
1 2 3
6 4
2 7 11 19 5 3
```
### 样例输出 #1
```
Case #1: 2 1 2
Case #2: 4 4 4 4 3 4
```
## 提示

**Sample Explanation**

In Sample Case #1, a spacious set cannot contain $1$ and $2$, nor it can contain $2$ and $3$. That implies that $S_2 = \{2\}$ and using $S_1 = S_3 = \{1, 3\}$ makes them of maximum size.

In Sample Case #2, possible sets of maximum size are:

* $S_1 = S_2 = S_3 = S_4 = \{2, 7, 11, 19\}$,
* $S_5 = \{11, 19, 5\}$, and
* $S_6 = \{7, 11, 19, 3\}$.

**Limits**

- $1 \leq \mathbf{T} \leq 100$.
- $-10^9 \leq \mathbf{A}_i \leq 10^9$, for all $i$.
- $\mathbf{A}_i \neq \mathbf{A}_j$, for all $i \neq j$.

**Test Set 1 (4 Pts, Visible Verdict)**

- $1 \leq \mathbf{N} \leq 10$.
- $1 \leq \mathbf{K} \leq 100$.

**Test Set 2 (10 Pts, Visible Verdict)**

- $1 \leq \mathbf{K} \leq 10^9$.

For at most 15 cases:

- $1 \leq \mathbf{N} \leq 10^5$.

For the remaining cases:

- $1 \leq \mathbf{N} \leq 10^3$.


---

---
title: "[NOIP 2011 提高组] 选择客栈"
layout: "post"
diff: 普及/提高-
pid: P1311
tag: ['递推', '2011', 'NOIP 提高组']
---
# [NOIP 2011 提高组] 选择客栈
## 题目描述

丽江河边有 $n$ 家很有特色的客栈，客栈按照其位置顺序从 $1$ 到 $n$ 编号。每家客栈都按照某一种色调进行装饰（总共 $k$ 种，用整数 $0 \sim k-1$ 表示），且每家客栈都设有一家咖啡店，每家咖啡店均有各自的最低消费。

两位游客一起去丽江旅游，他们喜欢相同的色调，又想尝试两个不同的客栈，因此决定分别住在色调相同的两家客栈中。晚上，他们打算选择一家咖啡店喝咖啡，要求咖啡店位于两人住的两家客栈之间（包括他们住的客栈），且咖啡店的最低消费不超过 $p$ 。

他们想知道总共有多少种选择住宿的方案，保证晚上可以找到一家最低消费不超过 $p$ 元的咖啡店小聚。
## 输入格式

共 $n+1$ 行。

第一行三个整数 $n, k, p$，每两个整数之间用一个空格隔开，分别表示客栈的个数，色调的数目和能接受的最低消费的最高值；

接下来的 $n$ 行，第 $i+1$ 行两个整数，之间用一个空格隔开，分别表示 $i $ 号客栈的装饰色调 $a_i$ 和 $i$ 号客栈的咖啡店的最低消费 $b_i$。
## 输出格式

一个整数，表示可选的住宿方案的总数。

## 样例

### 样例输入 #1
```
5 2 3 
0 5 
1 3 
0 2 
1 4 
1 5 

```
### 样例输出 #1
```
3

```
## 提示

### 样例解释

![](https://cdn.luogu.com.cn/upload/pic/101.png) 

2 人要住同样色调的客栈，所有可选的住宿方案包括：住客栈①③，②④，②⑤，④⑤，但是若选择住 $4,5$号客栈的话，$4,5$ 号客栈之间的咖啡店的最低消费是 $4$ ，而两人能承受的最低消费是 $3$ 元，所以不满足要求。因此只有前 $3$ 种方案可选。

### 数据范围

- 对于 $30\% $ 的数据，有 $n \leq 100$ ；
- 对于 $50\% $ 的数据，有 $n \leq 1\,000$；
- 对于 $100\%$ 的数据，有 $2 \leq n \leq 2 \times 10^5$，$1 \leq k
 \leq 50$，$0 \leq p \leq 100$，$0 \leq b_i \leq 100$。


---

---
title: "[COCI 2012/2013 #4] DLAKAVAC"
layout: "post"
diff: 普及/提高-
pid: P13417
tag: ['数学', '递推', '2012', '递归', 'COCI（克罗地亚）']
---
# [COCI 2012/2013 #4] DLAKAVAC
## 题目描述

In the faraway city of Xanadu, a flu epidemic has broken out, caused by a strain known as hairy flu. There are $M$ people living in the city, each resident having a unique personal ID number from the range of $0$ to $M - 1$, inclusive. Infection with this strain lasts exactly one day, and a person can catch it multiple times per season (since it mutates too quickly for lasting immunity).

On the first day of the epidemic, the flu was brought from another faraway country by a group of residents nicknamed "init-patients", whose ID numbers are known. The flu's spread is based on them. Each following day, a resident with ID number $p$ will catch the flu iff there exists a resident with ID $a$ who was infected the previous day, as well as an init-patient with ID $b$, such that:

$$
(a \times b) \bmod M = p.
$$

The numbers $a$ and $b$ need not be distinct. For example, consider a case where there are $101$ people in the town, and the init-patients are $5$ and $50$. On the first day, the init-patients are infected by definition. On the second day, the residents infected are $25$, $48$ ($250 \mod 101$), and $76$ ($2500 \mod 101$). On the third day, one of the infected patients is $77$, since $(48 \times 50) \mod 101 = 77$.

Who will catch the flu on the $K$-th day?
## 输入格式

The first line of input contains three positive integers, $K$, $M$, and $N$ ($1 \leq K \leq 10^{18}$, $3 \leq M \leq 1500$, $N < M$).

The second line of input contains $N$ space-separated nonnegative integers, the personal ID numbers of residents who were infected on the first day (the init-patients). These numbers are unique, increasing, and do not exceed $M - 1$.

## 输出格式

The first and only line of output must contain the personal ID numbers of residents infected with flu on the $K$-th day, given space-separated and in increasing order.
## 样例

### 样例输入 #1
```
1 100 3
1 2 3 
```
### 样例输出 #1
```
1 2 3
```
### 样例输入 #2
```
2 100 3
1 2 3
```
### 样例输出 #2
```
1 2 3 4 6 9
```
### 样例输入 #3
```
10 101 2
5 50
```
### 样例输出 #3
```
36 44 57 65
```


---

---
title: "车的放置"
layout: "post"
diff: 普及/提高-
pid: P1350
tag: ['递推', '福建省历届夏令营', '组合数学', '排列组合']
---
# 车的放置
## 题目描述

有下面这样的一个网格棋盘，$a,b,c,d$ 表示了对应边长度，也就是对应格子数：

![](https://cdn.luogu.com.cn/upload/image_hosting/g7ulpevu.png)

当 $a=b=c=d=2$ 时，对应下面这样一个棋盘：

![](https://cdn.luogu.com.cn/upload/image_hosting/e2ntmjlk.png)

要在这个棋盘上放 $k$ 个相互不攻击的车，也就是这 $k$ 个车没有两个车在同一行，也没有两个车在同一列，问有多少种方案。

## 输入格式

只有一行，为五个非负整数，分别代表 $a,b,c,d$ 和 $k$。

## 输出格式

输出一行一个整数代表答案 $\bmod$ $10^5+3$ 后的结果。
## 样例

### 样例输入 #1
```
2 2 2 2 2
```
### 样例输出 #1
```
38

```
## 提示

#### 数据规模与约定

- 存在部分数据，保证 $b=0$；
- 存在部分数据，保证 $a,b,c,d\leq 4$。
- 对于 $100\%$ 的数据，保证 $0\leq a,b,c,d,k\leq 10^3$，且至少有一种可行方案。


---

---
title: "[USACO2.2] 集合 Subset Sums"
layout: "post"
diff: 普及/提高-
pid: P1466
tag: ['递推', 'USACO', '背包 DP']
---
# [USACO2.2] 集合 Subset Sums
## 题目描述

对于从 $1\sim n$ 的连续整数集合，能划分成两个子集合，且保证每个集合的数字和是相等的。举个例子，如果 $n=3$，对于 $\{1,2,3\}$ 能划分成两个子集合，每个子集合的所有数字和是相等的：

$\{3\}$ 和 $\{1,2\}$ 是唯一一种分法（交换集合位置被认为是同一种划分方案，因此不会增加划分方案总数）  
如果 $n=7$，有四种方法能划分集合 $\{1,2,3,4,5,6,7 \}$，每一种分法的子集合各数字和是相等的:

$\{1,6,7\}$ 和 $\{2,3,4,5\}$  
$\{2,5,7\}$ 和 $\{1,3,4,6\}$  
$\{3,4,7\}$ 和 $\{1,2,5,6\}$  
$\{1,2,4,7\}$ 和 $\{3,5,6\}$  

给出 $n$，你的程序应该输出划分方案总数。
## 输入格式

输入文件只有一行，且只有一个整数 $n$

## 输出格式

输出划分方案总数。

## 样例

### 样例输入 #1
```
7

```
### 样例输出 #1
```
4

```
## 提示

【数据范围】  
对于 $100\%$ 的数据，$1\le n \le 39$。

翻译来自NOCOW

USACO 2.2



---

---
title: "矩阵 III"
layout: "post"
diff: 普及/提高-
pid: P1743
tag: ['模拟', '数学', '递推']
---
# 矩阵 III
## 题目背景

usqwedf 改编系列题。

## 题目描述

给定一个 $n\times m$ 的矩阵，问从左上角走到右下角有多少条路径，保留 $17$ 位有效数字（也就是从第 $18$ 位有效数字以后均输出 $0$）。

## 输入格式

一行两个正整数 $n,m$。

## 输出格式

路径数目 $t$。

## 样例

### 样例输入 #1
```
6 4
```
### 样例输出 #1
```
210
```
## 提示

$1\le n\le 10^8,1\le m\le 4$。




---

---
title: "覆盖墙壁"
layout: "post"
diff: 普及/提高-
pid: P1990
tag: ['递推']
---
# 覆盖墙壁
## 题目描述

你有一个长为 $N$ 宽为 $2$ 的墙壁，给你两种砖头：一个长 $2$ 宽 $1$，另一个是 L 型覆盖 $3$ 个单元的砖头。如下图：

```
0  0
0  00
```

砖头可以旋转，两种砖头可以无限制提供。你的任务是计算用这两种来覆盖 $N\times 2$ 的墙壁的覆盖方法。例如一个 $2\times3$ 的墙可以有 $5$ 种覆盖方法，如下：
```
012 002 011 001 011  
012 112 022 011 001
```
注意可以使用两种砖头混合起来覆盖，如 $2\times4$ 的墙可以这样覆盖：
```
0112
0012
```
给定 $N$，要求计算 $2\times N$ 的墙壁的覆盖方法。由于结果很大，所以只要求输出最后 $4$ 位。例如 $2\times 13$ 的覆盖方法为 $13465$，只需输出 $3465$ 即可。如果答案少于 $4$ 位，就直接输出就可以，不用加前导 $0$，如 $N=3$ 时输出 $5$。

## 输入格式

一个整数 $N$，表示墙壁的长。

## 输出格式

输出覆盖方法的最后 $4$ 位，如果不足 $4$ 位就输出整个答案。

## 样例

### 样例输入 #1
```
13
```
### 样例输出 #1
```
3465
```
## 提示

数据保证，$1\leq N\leq 1000000$。


---

---
title: "[HNOI2004] 打鼹鼠"
layout: "post"
diff: 普及/提高-
pid: P2285
tag: ['动态规划 DP', '递推', '2004', '各省省选', '湖南', '最短路']
---
# [HNOI2004] 打鼹鼠
## 题目描述

鼹鼠是一种很喜欢挖洞的动物，但每过一定的时间，它还是喜欢把头探出到地面上来透透气的。根据这个特点阿牛编写了一个打鼹鼠的游戏：在一个 $n \times n$ 的网格中，在某些时刻鼹鼠会在某一个网格探出头来透透气。你可以控制一个机器人来打鼹鼠，如果 $i$ 时刻鼹鼠在某个网格中出现，而机器人也处于同一网格的话，那么这个鼹鼠就会被机器人打死。而机器人每一时刻只能够移动一格或停留在原地不动。机器人的移动是指从当前所处的网格移向相邻的网格，即从坐标为 $(i, j)$ 的网格移向 $(i-1, j), (i+1, j), (i, j-1), (i, j+1)$ 四个网格，机器人不能走出整个 $n \times n$ 的网格。游戏开始时，你可以自由选定机器人的初始位置。

现在知道在一段时间内，鼹鼠出现的时间和地点，请编写一个程序使机器人在这一段时间内打死尽可能多的鼹鼠。

## 输入格式

第一行为 $n, m$（$n \le 1000$，$m \le {10}^4$），其中 $m$ 表示在这一段时间内出现的鼹鼠的个数，接下来的 $m$ 行中每行有三个数据 $\mathit{time}, x, y$ 表示在游戏开始后 $\mathit{time}$ 个时刻，在第 $x$ 行第 $y$ 个网格里出现了一只鼹鼠。$\mathit{time}$ 按递增的顺序给出。注意同一时刻可能出现多只鼹鼠，但同一时刻同一地点只可能出现一只鼹鼠。
## 输出格式

仅包含一个正整数，表示被打死鼹鼠的最大数目。
## 样例

### 样例输入 #1
```
2 2	         

1 1 1		

2 2 2


```
### 样例输出 #1
```
1

```


---

---
title: "[SCOI2005] 扫雷"
layout: "post"
diff: 普及/提高-
pid: P2327
tag: ['动态规划 DP', '递推', '2005', '四川', '各省省选']
---
# [SCOI2005] 扫雷
## 题目描述


相信大家都玩过扫雷的游戏。那是在一个 $n\times m$ 的矩阵里面有一些雷，要你根据一些信息找出雷来。万圣节到了，“余”人国流行起了一种简单的扫雷游戏，这个游戏规则和扫雷一样，如果某个格子没有雷，那么它里面的数字表示和它 $8$ 连通的格子里面雷的数目。现在棋盘是 $n\times 2$ 的，第一列里面某些格子是雷，而第二列没有雷，如下图：

![](https://cdn.luogu.com.cn/upload/pic/17825.png )

由于第一列的雷可能有多种方案满足第二列的数的限制，你的任务即根据第二列的信息确定第一列雷有多少种摆放方案。


## 输入格式


第一行为 $N$，第二行有 $N$ 个数，依次为第二列的格子中的数。（$1\le N\le10000$）
## 输出格式

一个数，即第一列中雷的摆放方案数。

## 样例

### 样例输入 #1
```
2
1  1
```
### 样例输出 #1
```
2
```


---

---
title: "[HAOI2009] 逆序对数列"
layout: "post"
diff: 普及/提高-
pid: P2513
tag: ['动态规划 DP', '递推', '2009', '河南', '各省省选', '前缀和']
---
# [HAOI2009] 逆序对数列
## 题目描述

对于一个数列 $\{a_i\}$，如果有 $i<j$ 且 $a_i>a_j$，那么我们称 $a_i$ 与 $a_j$ 为一对逆序对数。若对于任意一个由 $1 \sim n$ 自然数组成的数列，可以很容易求出有多少个逆序对数。那么逆序对数为 $k$ 的这样自然数数列到底有多少个？
## 输入格式

第一行为两个整数n，k。

## 输出格式

写入一个整数，表示符合条件的数列个数，由于这个数可能很大，你只需输出该数对10000求余数后的结果。

## 样例

### 样例输入 #1
```
4 1
```
### 样例输出 #1
```
3
```
## 提示

样例说明：

下列3个数列逆序对数都为1；分别是1 2 4 3 ；1 3 2 4 ；2 1 3 4；

测试数据范围

30%的数据  $n\le 12$。

100%的数据  $n\le 1000$，$k\le 1000$。



---

---
title: "慈善的约瑟夫"
layout: "post"
diff: 普及/提高-
pid: P2696
tag: ['递推']
---
# 慈善的约瑟夫
## 题目描述

你一定听说过约瑟夫问题吧？即从 $N$ 个人中找出唯一的幸存者。现在老约瑟夫将组织一个皆大欢喜的新游戏，假设 $N$ 个人站成一圈，从第 $1$ 人开始交替的去掉游戏者，但只是暂时去掉，直到最后剩下唯一的幸存者为止。幸存者选出后，所有比幸存者号码高的人每人得到 $1$ 个金币，永久性离开。其余剩下的将重复以上的游戏过程，比幸存者号码大的人每人得到 $1$ 个金币后离开。经过若干轮这样的过程后，一旦人数不再减少，则最后剩下的那些人将得到 $2$ 个金币。请你计算一下老约瑟夫一共要付出多少钱？
## 输入格式

一行一个正整数N表示人数。

## 输出格式

一行一个正整数表示共需支付的钱数。

## 样例

### 样例输入 #1
```
10
```
### 样例输出 #1
```
13
```
## 提示

1<=N<=100000



---

---
title: "小 Q 的赚钱计划"
layout: "post"
diff: 普及/提高-
pid: P2721
tag: ['动态规划 DP', '递推', '线性数据结构']
---
# 小 Q 的赚钱计划
## 题目背景

小 Q（郑重其事地）：今年我一定要赚大钱！！！

## 题目描述

小 Q 决定在新的一年里赚大钱，小 P 给 TA 推荐了理财。小 Q 在今年初（非闰年）有 $10^5$ 元（好有钱啊），有 $N$ 个理财产品，每个理财产品用三个参数描述：购买时间，投资天数，年利息率。每个时刻小 Q 只能拥有最多一件产品，求一年后最多可以获得多少钱。

## 输入格式

第 $1$ 行，一个整数 $N$。

接下来 $N$ 行，每行为 $3$ 个空格隔开的字符串 $A, B, C$；

- $A$ 表示发行时间，格式为 MMDD；
- $B$ 是一个整数，为投资天数，范围 $[10,300]$；
- $C$ 为最多 $2$ 位小数，代表百分之几的年利息，范围 $[3,30]$；

## 输出格式

一个数，为年底最多可以获得的连本带利的资金数目，保留两位有效小数。

## 样例

### 样例输入 #1
```
3
0101 100 4.5
0201 30 5
0402 50 7.8
```
### 样例输出 #1
```
101483.84
```
## 提示

$0 \le N \le 10^4$


---

---
title: "[USACO08FEB] Eating Together S"
layout: "post"
diff: 普及/提高-
pid: P2896
tag: ['动态规划 DP', '递推', '2008', 'USACO', '队列']
---
# [USACO08FEB] Eating Together S
## 题目描述

The cows are so very silly about their dinner partners. They have organized themselves into three groups (conveniently numbered 1, 2, and 3) that insist upon dining together. The trouble starts when they line up at the barn to enter the feeding area.

Each cow i carries with her a small card upon which is engraved Di (1 ≤ Di ≤ 3) indicating her dining group membership. The entire set of N (1 ≤ N ≤ 30,000) cows has lined up for dinner but it's easy for anyone to see that they are not grouped by their dinner-partner cards.

FJ's job is not so difficult. He just walks down the line of cows changing their dinner partner assignment by marking out the old number and writing in a new one. By doing so, he creates groups of cows like 111222333 or 333222111 where the cows' dining groups are sorted in either ascending or descending order by their dinner cards.

FJ is just as lazy as the next fellow. He's curious: what is the absolute mminimum number of cards he must change to create a proper grouping of dining partners? He must only change card numbers and must not rearrange the cows standing in line.

FJ的奶牛们在吃晚饭时很傻。他们把自己组织成三组（方便编号为1, 2和3），坚持一起用餐。当他们在谷仓排队进入喂食区时，麻烦就开始了。


每头奶牛都随身带着一张小卡片，小卡片上刻的是Di（1≤Di≤3）表示她属于哪一组。所有的N（1≤N≤30000）头奶牛排队吃饭，但他们并不能按卡片上的分组站好。


FJ的工作并不是那么难。他只是沿着牛的路线走下去，把旧的号码标出来，换上一个新的。通过这样做，他创造了一群奶牛，比如111222333或333222111，奶牛的就餐组按他们的晚餐卡片按升序或降序排列。


FJ就像任何人一样懒惰。他很好奇：怎样他才能进行适当的分组，使得他只要修改最少次数的数字？由于奶牛们已经很长时间没有吃到饭了，所以“哞哞”的声音到处都是，FJ只好更换卡号，而不能重新排列已经排好队的奶牛。

## 输入格式

\* Line 1: A single integer: N

\* Lines 2..N+1: Line i describes the i-th cow's current dining group with a single integer: Di

- 第1行：一个整数：n

- 第2~n+1行：第i-1行描述第i个奶牛目前分组。

## 输出格式

\* Line 1: A single integer representing the minimum number of changes that must be made so that the final sequence of cows is sorted in either ascending or descending order

一个整数，表示必须做出的最小变化数，以便以升序或降序排序最终序列。

## 样例

### 样例输入 #1
```
5
1
3
2
1
1

```
### 样例输出 #1
```
1

```
## 提示

感谢@一思千年 提供翻译



---

---
title: "[HAOI2009] 巧克力"
layout: "post"
diff: 普及/提高-
pid: P3173
tag: ['贪心', '递推', '2009', '河南', '排序', '前缀和']
---
# [HAOI2009] 巧克力
## 题目描述

有一块 $n \times m$ 的矩形巧克力，准备将它切成 $n \times m$ 块。巧克力上共有 $n-1$ 条横线和 $m-1$ 条竖线，你每次可以沿着其中的一条横线或竖线将巧克力切开，无论切割的长短，沿着每条横线切一次的代价依次为 $y_1,y_2,\cdots,y_{n-1}$，而沿竖线切割的代价依次为 $x_1,x_2,\cdots,x_{m-1}$。

例如，对于下图 $6 \times 4$ 的巧克力，我们先沿着三条横线切割，需要 $3$ 刀，得到 $4$ 条巧克力，然后再将这 $4$ 条巧克力沿竖线切割，每条都需要 $5$ 刀，则最终所花费的代价为 $y_1+y_2+y_3+4 \times (x_1+x_2+x_3+x_4+x_5)$。

![](https://cdn.luogu.com.cn/upload/image_hosting/juiv548x.png)


当然，上述简单切法不见得是最优切法，那么怎样切割该块巧克力，花费的代价最少呢？

## 输入格式


第一行为两个整数 $n$ 和 $m$；

接下来 $n-1$ 行，每行一个整数，分别代表 $x_1,x_2,\cdots,x_{n-1}$；

接下来 $m-1$ 行，每行一个整数，分别代表 $y_1,y_2,\cdots,y_{m-1}$。
## 输出格式

输出一整数，为切割巧克力的最小代价。

## 样例

### 样例输入 #1
```
6 4
2
1
3
1
4
4
1
2
```
### 样例输出 #1
```
42
```
## 提示


$30\%$ 的数据，$n \leq 100,m \leq 100$；

$100\%$ 的数据，$n \leq 10000,m \leq 10000$；


---

---
title: "不成熟的梦想家 (未熟 DREAMER)"
layout: "post"
diff: 普及/提高-
pid: P3655
tag: ['递推', '差分', '洛谷月赛']
---
# 不成熟的梦想家 (未熟 DREAMER)
## 题目背景

**どんな未来かは 誰もまだ知らない**

**那是个任谁也不会知晓的未来**

**でも楽しくなるはずだよ**

**但应该会充满乐趣吧**

**みんなとなら乗りこえられる**

**只要大伙儿同在 就能跨越难关**

**これからなんだねお互いがんばろうよ**

**现在才正要开始 彼此互相加油吧**

**どんな未来かは 誰もまだ知らない**

**那是个任谁也不会知晓的未来**

**でも楽しくしたホントに**

**不过真心期望能够充满着乐趣**

**みんなとなら無理したくなる**

**只要大伙儿同在 就会想将顾虑抛诸脑后**

**成長したいなまだまだ未熟DREAMER**

**愿能有所成长 如今还只是尚未成熟的梦想家**

 ![](https://cdn.luogu.com.cn/upload/pic/4493.png) 

Aqours的成员终于到齐了。


今天，是我们全员在一起的第一场演唱会。


大家都好好练习过了，相信一定会表现得很出色的。


不过，每个人的唱功也要尽量地接近才可以呢，如果太突出或者太落后，也是会影响表现的样子。


所以我们从隔壁的学园都市借来了一个发明，可以改变我们成员的唱功呢。

## 题目描述

我们Aqours的成员共有N+1人，他们会列成一队。

他们的唱功以A[0]到A[N]表示，A[i]$(0\le i \le N)$均给出。

学园都市的机器可以改变队列中连续多个成员的唱功值，并将其加上一个数Z，当然当Z是负数的时候就变成减去了。

我打算一共使用这个机器Q次，每次把第X到第Y号（$1\le X,Y\le10^6$）的成员都加上Z点唱功值。

而我们队伍的魅力值B，是这么算的：

一开始B=0，然后从第1号到第N号成员，

- 当$A_{i-1}<A_i$：$B = B-S\cdot|A_{i-1} - A_i|$
- 当$A_{i-1}>A_i$：$B = B+T\cdot|A_{i-1} - A_i|$
其中S和T是LoveLive组委会给我们的常数。

果然，我是バカチカ（笨蛋千歌）呢，所以作为领导我永远排在队伍的开头，唱功永远是0，机器也不会改到我头上呢。

你能帮我们算算，我**每次**使用完这个机器之后，成员的魅力B是多少吗？

## 输入格式

第一行4个整数，N，Q，S，T，各个变量在描述中已经解释

接下来N+1行，每行一个数整数Ai，其中A0=0

接下来Q行，每行3个整数，X，Y，Z各个变量在描述中已经解释

## 输出格式

Q个整数，表示答案。

## 样例

### 样例输入 #1
```
4 3 2 3
0
5
2
4
6
1 2 1
3 4 -3
1 4 2

```
### 样例输出 #1
```
-9
-1
-5

```
## 提示

30% 的数据 $N,Q\le 2000$,

另外20% 的数据 $S=T$

100%的数据 $N,Q\le 200000$；$1\le S,T,A_i\le10^6$；$|Z|\le 10^6$
请注意可能需要使用int64，cin/cout可能超时。

样例解释：

第一次变化后，

A 0 6 3 4 6

B -12 -3 -5 -9


#### 以下是彩蛋

没有。

哪来的那么多彩蛋？



---

---
title: "钟氏映射"
layout: "post"
diff: 普及/提高-
pid: P3795
tag: ['动态规划 DP', '搜索', '数学', '递推']
---
# 钟氏映射
## 题目背景

2233年，CSSYZ学校的数学老师兼数学竞赛顾问钟JG已经2200+岁啦！

为了庆生，他或她给广大人民群众出了道题。

## 题目描述

设集合$N=M=\left\{x|x\in N_+,x\leq k,k\in N_+\right\}$

设$f$为$N$到$M$的映射。

求满足：

$f[f(x)]=x$的不同的映射$f$的个数，由于答案较大，输出答案对$14233333$取余的数即可。

## 输入格式

输入一个正整数$k$

## 输出格式

输出满足$f[f(x)]=x$的不同的映射$f$的个数对$14233333$取余得到的数。

## 样例

### 样例输入 #1
```
3

```
### 样例输出 #1
```
4

```
## 提示

四个映射分别为：


|f(1)|f(2)|f(3)|
|-|-|-|
|1|2|3|
|1|3|2|
|2|1|3|
|3|2|1|

数据范围：

对于20%的数据，$1\leq k\leq 9$

对于其它的80%的数据，$1\leq k\leq 10^7$


内存20MB...（一开始开1MB把自己坑了）



---

---
title: "【模板】模意义下的乘法逆元"
layout: "post"
diff: 普及/提高-
pid: P3811
tag: ['数学', '递推', 'O2优化', '素数判断,质数,筛法', '逆元']
---
# 【模板】模意义下的乘法逆元
## 题目背景

这是一道模板题

## 题目描述

给定 $n,p$ 求 $1\sim n$ 中所有整数在模 $p$ 意义下的乘法逆元。

这里 $a$ 模 $p$ 的乘法逆元定义为 $ax\equiv1\pmod p$ 的解。
## 输入格式

一行两个正整数 $n,p$。

## 输出格式

输出 $n$ 行，第 $i$ 行表示 $i$ 在模 $p$ 下的乘法逆元。
## 样例

### 样例输入 #1
```
10 13
```
### 样例输出 #1
```
1
7
9
10
8
11
2
5
3
4
```
## 提示

$ 1 \leq n \leq 3 \times 10 ^ 6$，$n < p < 20000528 $。

输入保证 $ p $ 为质数。



---

---
title: "[SDOI2016] 排列计数"
layout: "post"
diff: 普及/提高-
pid: P4071
tag: ['递推', '2016', '各省省选', '山东', '枚举', '线性递推', '逆元']
---
# [SDOI2016] 排列计数
## 题目描述

求有多少种 $1$ 到 $n$ 的排列 $a$，满足序列恰好有 $m$ 个位置 $i$，使得 $a_i = i$。

答案对 $10^9 + 7$ 取模。
## 输入格式

**本题单测试点内有多组数据**。

输入的第一行是一个整数 $T$，代表测试数据的整数。

以下 $T$ 行，每行描述一组测试数据。

对于每组测试数据，每行输入两个整数，依次代表 $n$ 和 $m$。
## 输出格式

共输出 $T$ 行，对于每组测试数据，输出一行一个整数代表答案。
## 样例

### 样例输入 #1
```
5
1 0
1 1
5 2
100 50
10000 5000
```
### 样例输出 #1
```
0
1
20
578028887
60695423
```
## 提示

#### 数据规模与约定

本题共 20 个测试点，各测试点等分，其数据规模如下表。

| 测试点编号 | $T =$  | $n, m \leq$ |  测试点编号  |      $T =$      | $n, m \leq$ |
| :--------: | :----: | :---------: | :----------: | :-------------: | :---------: |
| $1\sim 3$  | $10^3$ |     $8$     | $10 \sim 12$ |     $10^3$      |   $10^3$    |
| $4 \sim 6$ | $10^3$ |    $12$     | $13 \sim 14$ | $5 \times 10^5$ |   $10^3$    |
| $7 \sim 9$ | $10^3$ |    $100$    | $15 \sim 20$ | $5 \times 10^5$ |   $10^6$    |

对于全部的测试点，保证 $1 \leq T \leq 5 \times 10^5$，$1 \leq n \leq 10^6$，$0 \leq m \leq 10^6$。


---

---
title: "[USACO17DEC] My Cow Ate My Homework S"
layout: "post"
diff: 普及/提高-
pid: P4086
tag: ['递推', '2017', '线段树', 'USACO', '枚举', '前缀和']
---
# [USACO17DEC] My Cow Ate My Homework S
## 题目描述

In your bovine history class, you have been given a rather long homework assignment with $N$ questions ($3 \leq N \leq 100,000$), each graded with an integer score in the range 0...10,000. As is often customary, your teacher plans to assign a final grade by discarding a question on which you received the lowest score and then averaging the remaining scores together. Unfortunately, your pet cow Bessie has just eaten your answers to the first $K$ questions! ($K$ could be as small as 1 or as large as $N-2$).

After copious explanation, your teacher finally believes your story, and agrees to grade the remaining non-eaten part of the assignment the same way as before -- by removing the lowest-scoring question (or one such question, in the event of a tie) and averaging the rest.


Please output all values of $K$ which would have earned you the maximum possible score according to this grading scheme, in sorted order.


## 输入格式

The first line of input contains $N$, and the next line contains the scores on the $N$ homework questions.

## 输出格式

Please output, one value per line, all values of $K$ which would have earned you the maximum possible score.

## 样例

### 样例输入 #1
```
5
3 1 9 2 7
```
### 样例输出 #1
```
2
```
## 提示

If Bessie eats the first two questions, then the remaining scores are 9, 2, and 7. Removing the minimum and averaging, we get a final grade of 8, which is the highest possible.

## 题目翻译

### 题目描述

在你的牛历史课上，你被布置了一份相当长的作业，包含 $N$ 个问题（$3 \leq N \leq 100,000$），每个问题的得分是一个在 0 到 10,000 之间的整数。按照惯例，你的老师计划通过去掉你得分最低的一个问题，然后对剩余问题的得分取平均来给出最终成绩。不幸的是，你的宠物奶牛 Bessie 刚刚吃掉了你前 $K$ 个问题的答案！（$K$ 可能小到 1，也可能大到 $N-2$）。

经过多次解释，你的老师终于相信了你的说法，并同意按照之前的方式对剩余的未被吃掉的部分作业进行评分——即去掉得分最低的问题（或在得分相同的情况下去掉其中一个），然后对剩余问题取平均。

请输出所有能够使你获得最高可能成绩的 $K$ 值，并按升序排列。

### 输入格式

输入的第一行包含 $N$，第二行包含 $N$ 个作业问题的得分。

### 输出格式

请逐行输出所有能够使你获得最高可能成绩的 $K$ 值。

### 说明/提示

如果 Bessie 吃掉了前两个问题，那么剩余的得分是 9、2 和 7。去掉最低分并取平均后，最终成绩为 8，这是可能的最高成绩。


---

---
title: "消失之物"
layout: "post"
diff: 普及/提高-
pid: P4141
tag: ['动态规划 DP', '递推', '枚举', '分治', '背包 DP']
---
# 消失之物
## 题目描述

ftiasch 有 $n$ 个物品, 体积分别是 $w_1,w_2,\dots,w_n$。由于她的疏忽，第 $i$ 个物品丢失了。   

“要使用剩下的 $n-1$ 物品装满容积为 $x$ 的背包，有几种方法呢？”——这是经典的问题了。  

她把答案记为 $\text{cnt}(i,x)$ ，想要得到所有$i \in [1,n]$, $x \in [1,m]$ 的 $\text{cnt}(i,x)$ 表格。

![](https://cdn.luogu.com.cn/upload/pic/13426.png)

## 输入格式

第一行两个整数 $n,m$，表示物品的数量和最大的容积。
第二行 $n$ 个整数 $w_1,w_2,\dots,w_n$，表示每个物品的体积。

## 输出格式

输出一个 $n \times m$ 的矩阵，表示 $\text{cnt}(i,x)$ 的**末位数字**。

## 样例

### 样例输入 #1
```
3 2
1 1 2
```
### 样例输出 #1
```
11
11
21
```
## 提示

【数据范围】  
对于 $100\%$ 的数据，$1\le n,m \le 2000$，且 $1\le v_i\le m$。

【样例解释】  
如果物品 3 丢失的话，只有一种方法装满容量是 2 的背包，即选择物品 1 和物品 2。

---

$\text{upd 2023.8.11}$：新增加五组 Hack 数据。



---

---
title: "终于结束的起点"
layout: "post"
diff: 普及/提高-
pid: P4994
tag: ['递推', '枚举', '斐波那契数列', '洛谷月赛']
---
# 终于结束的起点
## 题目背景

> 终于结束的起点  
> 终于写下句点  
> 终于我们告别  
> 终于我们又回到原点  
> ……

一个个 OIer 的竞赛生涯总是从一场 NOIp 开始，大多也在一场 NOIp 中结束，好似一次次轮回在不断上演。  
如果这次 NOIp 是你的起点，那么祝你的 OI 生涯如同夏花般绚烂。  
如果这次 NOIp 是你的终点，那么祝你的 OI 回忆宛若繁星般璀璨。  
也许这是你最后一次在洛谷上打比赛，也许不是。  
不过，无论如何，祝你在一周后的比赛里，好运。

当然，这道题也和轮回有关系。
## 题目描述

广为人知的斐波拉契数列 $\mathrm{fib}(n)$ 是这么计算的

$$
\mathrm{fib}(n)=\begin{cases}
0,& n=0 \\
1,& n=1 \\
\mathrm{fib}(n-1) + \mathrm{fib}(n-2),& n>1
\end{cases}
$$

也就是 $0, 1, 1, 2, 3, 5, 8, 13 \cdots$，每一项都是前两项之和。

小 F 发现，如果把斐波拉契数列的每一项对任意大于 $1$ 的正整数 $M$ 取模的时候，数列都会产生循环。

当然，小 F 很快就明白了，因为 ($\mathrm{fib}(n - 1) \bmod M$) 和 ($\mathrm{fib}(n - 2) \bmod M)$ 最多只有 $M ^ 2$ 种取值，所以在 $M  ^ 2$ 次计算后一定出现过循环。

甚至更一般地，我们可以证明，无论取什么模数 $M$，最终模 $M$ 下的斐波拉契数列都会是 $0, 1, \cdots, 0, 1, \cdots$。

现在，给你一个模数 $M$，请你求出最小的 $n > 0$，使得 $\mathrm{fib}(n) \bmod M = 0, \mathrm{fib}(n + 1) \bmod M = 1$。
## 输入格式

输入一行一个正整数 $M$。
## 输出格式

输出一行一个正整数 $n$。
## 样例

### 样例输入 #1
```
2
```
### 样例输出 #1
```
3
```
### 样例输入 #2
```
6
```
### 样例输出 #2
```
24
```
## 提示

#### 样例 1 解释

斐波拉契数列为 $0, 1, 1, 2, 3, 5, 8, 13, 21, 34, \cdots$，在对 $2$ 取模后结果为 $0, 1, 1, 0, 1, 1, 0, 1, 1, 0, \cdots$。

我们可以发现，当 $n = 3$ 时，$f(n) \bmod 2= 0, f(n + 1) \bmod 2 = 1$，也就是我们要求的 $n$ 的最小值。

#### 数据范围

对于 $30\%$ 的数据，$M \leq 18$；

对于 $70\%$ 的数据，$M \leq 2018$；

对于 $100\%$ 的数据，$2 \leq M \leq 706150=\verb!0xAC666!$。

#### 提示

如果你还不知道什么是取模 $(\bmod)$，那我也很乐意告诉你，模运算是求整数除法得到的余数，也就是竖式除法最终「除不尽」的部分，也即
$$a \bmod M =k \iff a = bM + k\ (M > 0, 0 \leq k < M)$$
其中 $a, b, k$ 都是非负整数。

如果你使用 `C` / `C++`，你可以使用 `%` 来进行模运算。

如果你使用 `Pascal`，你可以使用 `mod` 来进行模运算。


---

---
title: "[USACO09FEB] Bulls And Cows S"
layout: "post"
diff: 普及/提高-
pid: P6191
tag: ['数学', '递推', '2009', 'USACO', '组合数学', '前缀和']
---
# [USACO09FEB] Bulls And Cows S
## 题目背景

一年一度的展会要来临了，Farmer John 想要把 $N$（$1 \leq N \leq 100,000$）只奶牛和公牛安排在单独的一行中。 John 发现最近公牛们非常好斗；假如两只公牛在这一行中靠的太近，他们就会吵架，以至于斗殴，破坏这和谐的环境。
## 题目描述

John 非常的足智多谋，他计算出任何两只公牛之间至少要有 $K$（$0 \leq K \lt N$）只奶牛，这样才能避免斗殴。John 希望你帮助他计算一下有多少种安排方法，可避免任何斗殴的的发生。John 认为每头公牛都是一样的，每头奶牛都是一样的。因而，只要在一些相同的位置上有不同种类的牛，那这就算两种不同的方法。
## 输入格式

两个整数 $N$ 和 $K$。
## 输出格式

输出约翰可以安排的方法数。考虑到这个数可能很大，你只要输出对 $5\,000\,011$ 取模之后的结果就可以了。
## 样例

### 样例输入 #1
```
4 2
```
### 样例输出 #1
```
6
```
## 提示

下面的就是 FJ 思考出可行的 6 种方案（C 代表奶牛，B 代表公牛）：
- CCCC
- BCCC
- CBCC
- CCBC
- CCCB
- BCCB


---

---
title: "[COCI 2010/2011 #1] TABOVI"
layout: "post"
diff: 普及/提高-
pid: P6446
tag: ['贪心', '递推', '2010', 'COCI（克罗地亚）']
---
# [COCI 2010/2011 #1] TABOVI
## 题目背景

Zvonkec 是在一家小公司工作的程序员。

## 题目描述

Zvonkec 每天都必须重构一个源代码文件。令他大为沮丧的是，源代码的代码风格很奇怪。他尤其会受到缩进不均匀的困扰，即缩进每行的制表符（即键盘上的 `Tab`）的数量。

幸运的是，他的编辑器具有命令来选择一组连续的行，并从每行的开头添加或删除字符。请你帮助 Zvonkec 尽快整理代码。

给出的行数为 $n$，在每行开始处指定当前制表符数量的序列以及在每行开始处指定所需制表符数量的序列。

Zvonkec 可以执行许多命令，包括：

- 选择任意数量的连续行。
- 向每条选定行的开头添加或删除单个制表符。

无论选择多少行，以上两个动作都包含一个命令。

应该注意的是，禁止从一行中删除的制表符比在一行的开始处实际显示的要多，因为编辑器将开始删除除制表符以外的字符。

要求您计算整理代码所需的最少命令数。
## 输入格式

输入数据共三行。

第一行，一个正整数 $n$。

第二行有 $n$ 个整数 $p_i$，表示在进行任何编辑之前在第 $i$ 行的开头的制表符数。

第三行有 $n$ 个整数 $k_i$，表示 Zvonkec 在第 $i$ 行的开头想要的制表符数。
## 输出格式

输出数据共一行。

第一行，一个正整数，表示问题编号中指定的所需编号。
## 样例

### 样例输入 #1
```
3
3 4 5
6 7 8 

```
### 样例输出 #1
```
3

```
### 样例输入 #2
```
4
1 2 3 4
3 1 1 0 

```
### 样例输出 #2
```
6
```
### 样例输入 #3
```
4
5 4 5 5
1 5 0 1 

```
### 样例输出 #3
```
10
```
## 提示

#### 数据范围
- 对于 $70\%$ 的数据，$1 \leq n \leq 100$，$0 \le p_i \le 80$，$0 \leq k_i \leq 80$。
- 对于 $100\%$ 的数据，$1 \leq n \le 1000$，$0 \le p_i \le 80$，$0 \leq k_i \leq 80$。
#### 说明

**题目译自 [COCI2010-2011](https://hsin.hr/coci/archive/2010_2011/) [CONTEST #1](https://hsin.hr/coci/archive/2010_2011/contest1_tasks.pdf) *T5 TABOVI*。**


---

---
title: "[蓝桥杯 2013 国 B] 格子刷油漆"
layout: "post"
diff: 普及/提高-
pid: P8607
tag: ['递推', '2013', '蓝桥杯国赛']
---
# [蓝桥杯 2013 国 B] 格子刷油漆
## 题目描述

X 国的一段古城墙的顶端可以看成 $2 \times N$ 个格子组成的矩形（如图 $1$ 所示），现需要把这些格子刷上保护漆。

![](https://cdn.luogu.com.cn/upload/image_hosting/k52ovrzc.png)

你可以从任意一个格子刷起，刷完一格，可以移动到和它相邻的格子（对角相邻也算数），但不能移动到较远的格子（因为油漆未干不能踩！）

比如：`adbcef` 就是合格的刷漆顺序。

`cefdab` 是另一种合适的方案。

当已知 $N$ 时，求总的方案数。当 $N$ 较大时，结果会迅速增大，请把结果对 $1000000007(10^9+7)$ 取模。
## 输入格式

输入数据为一个正整数 $N$（不大于 $1000$）。
## 输出格式

输出数据为一个正整数。
## 样例

### 样例输入 #1
```
2
```
### 样例输出 #1
```
24
```
### 样例输入 #2
```
3
```
### 样例输出 #2
```
96
```
### 样例输入 #3
```
22
```
### 样例输出 #3
```
359635897
```
## 提示

时限 1 秒, 64M。蓝桥杯 2013 年第四届国赛


---

---
title: "[蓝桥杯 2018 国 AC] 约瑟夫环"
layout: "post"
diff: 普及/提高-
pid: P8671
tag: ['数学', '递推', '2018', '蓝桥杯国赛']
---
# [蓝桥杯 2018 国 AC] 约瑟夫环
## 题目描述

$n$ 个人的编号是 $1 \sim n$，如果他们依编号按顺时针排成一个圆圈，从编号是 $1$ 的人开始顺时针报数。

（报数是从 $1$ 报起）当报到 $k$ 的时候，这个人就退出游戏圈。下一个人重新从 $1$ 开始报数。

求最后剩下的人的编号。这就是著名的约瑟夫环问题。

本题目就是已知 $n$，$k$ 的情况下，求最后剩下的人的编号。

## 输入格式

题目的输入是一行，$2$ 个空格分开的整数 $n,k$。
## 输出格式

要求输出一个整数，表示最后剩下的人的编号。
## 样例

### 样例输入 #1
```
10 3
```
### 样例输出 #1
```
4
```
## 提示

$0<n,k<10^6$。

时限 1 秒, 256M。蓝桥杯 2018 年第九届国赛


---


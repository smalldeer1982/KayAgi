---
title: "[国家集训队] JZPFAR"
layout: "post"
diff: 省选/NOI-
pid: P2093
tag: ['集训队互测', 'K-D Tree']
---
# [国家集训队] JZPFAR
## 题目背景

原《零件分组》见 P1233。

## 题目描述

平面上有 $n$ 个点。现在有 $m$ 次询问，每次给定一个点 $(px, py)$ 和一个整数 $k$，输出 $n$ 个点中离 $(px, py)$ 的距离第 $k$ 大的点的标号。如果有两个(或多个)点距离 $(px, py)$ 相同，那么认为标号较小的点距离较大。

## 输入格式

第一行，一个整数 $n$，表示点的个数。

下面 $n$ 行，每行两个整数 $x_i,y_i$，表示 $n$ 个点的坐标。点的标号按照输入顺序，分别为 $1\ldots n$。

下面一行，一个整数 $m$，表示询问个数。

下面 $m$ 行，每行三个整数 $px_i,py_i,k_i$，表示一个询问。
## 输出格式

$m$ 行，每行一个整数，表示相应的询问的答案。
## 样例

### 样例输入 #1
```
3
0 0
0 1
0 2
3
1 1 2
0 0 3
0 1 1
```
### 样例输出 #1
```
3
1
1
```
## 提示

#### 数据规模与约定

- $50\%$ 的数据中，$n$ 个点的坐标在某范围内随机分布。
- $100\%$ 的数据中，$1\le n\le 10^5$，$1\le m\le 10^4$，$1\le k\le 20$，$-10^9\le x_i,y_i,px_i,py_i\le 10^9$，$n$ 个点中任意两点坐标不同，$m$ 个询问的点的坐标在某范围内随机分布。


---

---
title: "[CH弱省胡策R2] TATT"
layout: "post"
diff: 省选/NOI-
pid: P3769
tag: ['线段树', '平衡树', '分治', '排序', 'K-D Tree']
---
# [CH弱省胡策R2] TATT
## 题目描述

四维空间真是美妙。现在有 $n$ 个四维空间中的点，请求出一条最长的路径，满足任意一维坐标都是单调不降的。

注意路径起点是任意选择的，并且路径与输入顺序无关（路径顺序不一定要满足在输入中是升序）。

**路径的长度是经过的点的数量，任意点只能经过一次。**
## 输入格式

第一行一个整数 $n$。接下来 $n$ 行，每行四个整数 $a_i,b_i,c_i,d_i$。表示四维坐标。
## 输出格式

一行一个整数，表示最长路径的长度。
## 样例

### 样例输入 #1
```
4
2 3 33 2333
2 3 33 2333
2 3 33 2333
2 3 33 2333

```
### 样例输出 #1
```
4

```
## 提示

记 $m_i=\max(|a_i|,|b_i|,|c_i|,|d_i|),m=\max(m_i)$
|  测试点编号| $n\le$ | $m\le$ | 特殊说明 |
| :----------: | :----------: | :----------: | :----------: |
| $1$ | $2000$ | $10^9$ |  |
| $2$ |$5\times 10^4$  | $8$ |  |
| $3\sim 4$ | $5\times 10^4$ | $10^5$ |  所有点的第三，四维坐标相同|
| $5\sim 6$| $5\times 10^4$ | $10^5$ |  所有点的第四维坐标相同 |
| $7\sim 8$ | $5\times 10^4$ |$100$  |  |
|  $9\sim 10$| $5\times 10^4$ | $10^9$ |  |


---

---
title: "【模板】三维偏序（陌上花开）"
layout: "post"
diff: 省选/NOI-
pid: P3810
tag: ['树状数组', 'cdq 分治', 'O2优化', '分治', '排序', '整体二分', 'K-D Tree']
---
# 【模板】三维偏序（陌上花开）
## 题目背景

这是一道模板题，可以使用 bitset，CDQ 分治，KD-Tree 等方式解决。
## 题目描述

有 $ n $ 个元素，第 $ i $ 个元素有 $ a_i,b_i,c_i $ 三个属性，设 $ f(i) $ 表示满足 $ a_j \leq a_i $ 且 $ b_j \leq b_i $ 且 $ c_j \leq c_i $ 且 $ j \ne i $ 的 $j$ 的数量。

对于 $ d \in [0, n) $，求 $ f(i) = d $ 的数量。
## 输入格式

第一行两个整数 $ n,k $，表示元素数量和最大属性值。

接下来 $ n $ 行，每行三个整数 $ a_i ,b_i,c_i $，分别表示三个属性值。
## 输出格式

$ n $ 行，第 $ d + 1 $ 行表示 $ f(i) = d $ 的 $ i $ 的数量。
## 样例

### 样例输入 #1
```
10 3
3 3 3
2 3 3
2 3 1
3 1 1
3 1 2
1 3 1
1 1 2
1 2 2
1 3 2
1 2 1

```
### 样例输出 #1
```
3
1
3
0
1
0
1
0
0
1

```
## 提示

$ 1 \leq n \leq 10^5$，$1 \leq a_i, b_i, c_i \le k \leq 2 \times 10^5 $。



---

---
title: "简单题"
layout: "post"
diff: 省选/NOI-
pid: P4148
tag: ['递归', 'K-D Tree']
---
# 简单题
## 题目描述

你有一个$N \times N$的棋盘，每个格子内有一个整数，初始时的时候全部为 $0$，现在需要维护两种操作：

- `1 x y A`    $1\le x,y\le N$，$A$ 是正整数。将格子`x`,`y`里的数字加上 $A$。
- `2 x1 y1 x2 y2`    $1 \le x_1 \le x_2 \le N$，$1 \le y_1\le y_2 \le N$。输出 $x_1, y_1, x_2, y_2$ 这个矩形内的数字和
- `3`    无 终止程序

## 输入格式

输入文件第一行一个正整数 $N$。

接下来每行一个操作。每条命令除第一个数字之外，均要异或上一次输出的答案 `last_ans`，初始时 `last_ans` $=0$。

## 输出格式

对于每个 $2$ 操作，输出一个对应的答案。

## 样例

### 样例输入 #1
```
4
1 2 3 3
2 1 1 3 3
1 1 1 1
2 1 1 0 7
3
```
### 样例输出 #1
```
3
5
```
## 提示

$1\leq N\leq 5\times 10^5$，操作数不超过 $2\times 10^5$ 个，内存限制 $20\texttt{MB}$，保证答案在 int 范围内并且解码之后数据仍合法。



---

---
title: "[CQOI2016] K 远点对"
layout: "post"
diff: 省选/NOI-
pid: P4357
tag: ['2016', '重庆', '各省省选', 'K-D Tree']
---
# [CQOI2016] K 远点对
## 题目描述

已知平面内 $N$ 个点的坐标，求欧氏距离下的第 $K$ 远点对。

两个点 $P(x_1,y_1)$ 和 $Q(x_2,y_2)$ 的欧氏距离定义为 $\sqrt{(x_1-x_2)^2+(y_1-y_2)^2}$
## 输入格式

输入文件第一行为用空格隔开的两个整数 $N,K$ 。

接下来 $N$ 行，每行两个整数 $X,Y$ ，表示一个点的坐标。
## 输出格式

输出文件第一行为一个整数，表示第 $K$ 远点对的距离的平方（一定是个整数）。
## 样例

### 样例输入 #1
```
10 5
0 0
0 1
1 0
1 1
2 0
2 1
1 2
0 2
3 0
3 1
```
### 样例输出 #1
```
9
```
## 提示

对于 $100\%$ 的测试点，$N \le 100000,1 \le K \le 100,K \le \dfrac {N(N-1)}{2},0 \le X,Y < 2^{31}$


---

---
title: "寻找宝藏"
layout: "post"
diff: 省选/NOI-
pid: P4849
tag: ['cdq 分治', 'K-D Tree']
---
# 寻找宝藏
## 题目背景

如果时光回到从前，或许，一切只是虚无……

小 W 坐着时光穿梭机到达了一个四维时空，在这里，开始了他的寻宝之旅。
## 题目描述

整个四维时空可以看做是一个四维的网格图，小 W 在 $(1,1,1,1)$ 这个位置，出口在 $(m,m,m,m)$。但由于小 W 毕竟是外来时空的人，他的行动在这里受到了一些限制。每次他只能使四个坐标中的一个加上 $1$。也就是说，他每次只能向右，向上，向前和向*（蒟蒻的出题人想不出来怎么形容了）走一步。

这个时空中有 $n$ 个宝藏，第 $i$ 个宝藏的坐标是 $(a_i,b_i,c_i,d_i)$，价值为 $v_i$。

小 W 想知道，他能够拿走宝藏的最大价值和是多少。由于小 W 也是一个喜欢未雨绸缪的人，他也希望能够找到多种不同的方案使它们都可以达到最大价值和的要求。不过这个数有可能很大，输出它对 $998244353$ 取模的结果即可。

注意！两个方案不同当且仅当两个方案中至少有一个宝藏选择的不同，如果仅仅路线不同而最终都选择了相同的宝藏不算不同的方案。

（小心两个宝藏待在相同的位置哦……）
## 输入格式

第一行两个数 $n,m$，分别代表宝藏个数和网格坐标的最大值。

接下来 $n$ 行，每行 $5$ 个数，分别是 $a_i,b_i,c_i,d_i,v_i$。
## 输出格式

输出两行，第一行是最大价值和，第二行是满足条件的方案个数对 $998244353$ 取模的结果。
## 样例

### 样例输入 #1
```
5 5
1 1 1 1 5
2 2 2 2 4
1 1 2 2 3
3 1 3 1 10
5 5 5 5 1
```
### 样例输出 #1
```
16
1
```
### 样例输入 #2
```
20 1000000000
20204201 39958379 15138434 34289618 398078390
85600475 39563639 66410111 36702766 611878653
36702694 1628762 125746709 79172847 611878653
103077330 79188107 6711555 56295346 611878653
212677316 202221253 26717633 234187985 158044893
297040787 198938585 43827694 296390944 158044893
109256220 180224853 267561686 65767679 472347047
167183048 72650618 4390517 30073538 471045792
214834767 93996707 94416376 34549122 359059039
89445418 135311221 266840392 213735818 398078390
343357648 61588748 188180842 396968607 144378900
285457193 157755350 336368020 572049737 472347047
171728638 398663231 323772972 359470762 611878653
234684711 226541116 270561472 376433946 229386389
293174669 58119648 352134416 262971247 144378900
182250938 623413311 303663331 506122949 611878653
817319765 321076346 200801449 745136845 698518241
26356940 295529493 725103952 845588002 533478406
510252473 498314898 168621119 519205227 472347047
947274653 288133984 692904616 340022215 611878653

```
### 样例输出 #2
```
1696104353
6
```
## 提示

对于样例 1，最好的办法是 $(1,1,1,1)$ 慢慢走到 $(3,1,3,1)$，再慢慢走到 $(5,5,5,5)$，获得 $16$ 的价值。最好的路径只有这 $1$ 条。

![Luogu](https://cdn.luogu.com.cn/upload/pic/26057.png)

对于所有数据，$1\le a_i,b_i,c_i,d_i\le m$，$1\le v_i\le 10^9$。


---

---
title: "[SDOI2012] 最近最远点对"
layout: "post"
diff: 省选/NOI-
pid: P6247
tag: ['2012', '各省省选', '山东', 'Special Judge', '分治', '凸包', 'K-D Tree']
---
# [SDOI2012] 最近最远点对
## 题目描述

给定平面直角坐标系上的 $n$ 个点，分别求出距离最近的两个点的距离和距离最远的两个点的距离。注意，距离为直线距离。
## 输入格式

第一行一个整数，$n$。
接下来 $n$ 行每行两个非负浮点数，$x_i$,$y_i$，表示第 $i$ 个点的 X 坐标与 Y 坐标。
## 输出格式

总共一行，两个浮点数，为最短距离与最长距离。误差不超过 $0.01$ 视为正确。
## 样例

### 样例输入 #1
```
4
0.0 0.0
0.0 1.0
1.0 0.0
1.0 1.0
```
### 样例输出 #1
```
1.00 1.41
```
## 提示

- 对于 $30\%$ 的数据，$n\leq 2000$；
- 对于 $70\%$ 的数据，$n\leq 20000$；
- 对于 $100\%$ 的数据，$0 \lt n\leq 10^5$，输入数据中所有数均为不超过 $10^9$ 的非负数。


---

---
title: "[PA 2011] Kangaroos"
layout: "post"
diff: 省选/NOI-
pid: P6349
tag: ['2011', '莫队', 'O2优化', 'K-D Tree', 'PA（波兰）']
---
# [PA 2011] Kangaroos
## 题目描述

给出长为 $n$ 的序列 $a$，第 $i$ 个元素是一个区间 $[l_i,r_i]$。

$m$ 次询问，给出 $A,B$，求出 $a$ 中最长的区间（即这个序列中的一段），使得这个区间内每个区间都与 $[A,B]$ 有交集。输出这个最长区间的长度。
## 输入格式

第一行两个整数 $n,m$。

接下来 $n$ 行，第 $i$ 行两个整数 $l_i,r_i$。

接下来 $m$ 行，每行两个整数 $A,B$，为一次询问。
## 输出格式

输出 $m$ 行，每行一个整数，为询问的答案。
## 样例

### 样例输入 #1
```
3 3
2 5
1 3
6 6
3 5
1 10
7 9
```
### 样例输出 #1
```
2
3
0
```
## 提示

$1\le n\le 5\times 10^4$，$1\le m\le 2\times 10^5$，$1\le l_i\le r_i\le 10^9$，$1\le A\le B\le 10^9$


---

---
title: "[JOISC 2021] 道路の建設案 (Road Construction) (Day2)"
layout: "post"
diff: 省选/NOI-
pid: P7561
tag: ['二分', '堆', '2021', '优先队列', 'K-D Tree', 'JOI（日本）', '双指针 two-pointer']
---
# [JOISC 2021] 道路の建設案 (Road Construction) (Day2)
## 题目背景

10s,2048M
## 题目描述

JOI 国是一个 $x\times y$ 的二维平面，王国里有 $n$ 个城镇，分别编号为 $1, 2, \cdots, n$，其中第 $i$ 个城镇的 **坐标** 为 $(x_i, y_i)$。

在 JOI 国，正计划修建连接两座城镇的路（下文简称：**「修路的项目」**），路有 $k$ 条。连接两个不同的城镇 $a$ 和 $b$ 将花费 $|x_a − x_b| + |y_a − y_b|$ 元。若有一条连接 $c$，$d$ 的路，则不需要也不可以在建一条连接 $d$，$c$ 的路，因为它们是相同的。

你要管理这个「修路的项目」，为了计算花费情况，你得弄明白连接一些城镇所需的花费。在这 $\dfrac{n\cdot(n-1)}{2}$ 条道路中，你想了解最便宜的 $k$ 条道路的花费。

给你城镇的坐标以及 $k$，请计算最便宜的 $k$ 条路所需要的钱。
## 输入格式

输入数据共 $n+1$ 行。

第一行，$2$ 个正整数 $n, k$，$n$ 表示城镇的数量，$k$ 含义见 **「题目描述」** 部分。

接下来的第 $2 \sim n+1$ 行，每行 $2$ 个正整数，分别是 $x_i$ 和 $y_i$，其中 $1\le i \le n$，表示第 $i$ 个城镇的坐标。
## 输出格式

输入数据共 $k$ 行。

对于第 $k$ 行，有一个整数表示第 $k$ 便宜的路需要的日元。
## 样例

### 样例输入 #1
```
3 2
-1 0
0 2
0 0

```
### 样例输出 #1
```
1
2

```
### 样例输入 #2
```
5 4
1 -1
2 0
-1 0
0 2
0 -2

```
### 样例输出 #2
```
2
2
3
3

```
### 样例输入 #3
```
4 6
0 0
1 0
3 0
4 0

```
### 样例输出 #3
```
1
1
2
3
3
4

```
### 样例输入 #4
```
10 10
10 -8
7 2
7 -8
-3 -6
-2 1
-8 6
8 -1
2 4
6 -6
2 -1

```
### 样例输出 #4
```
3
3
4
5
6
6
6
7
7
7

```
## 提示

#### 样例 #1 解释
有 $\dfrac{3 \times 2}{2} = 3$ 种方案。

- 城镇 $1 \to$ 城镇 $2$，$|(-1)-0|+|0-2| = 3$ 日元。
- 城镇 $1 \to$ 城镇 $3$，$|(-1)-0|+|0-0| = 1$ 日元。
- 城镇 $2 \to$ 城镇 $3$，$|0-0|+|2-0| = 2$ 日元。

将其进行排序为 $1,2,3$，所以输出是 $1$ 和 $2$。

本样例满足 Subtask $1, 4, 5, 6$。

#### 样例 #2 解释

有 $\dfrac{5 \times 4}{2} = 10$ 种方案。

将钱数排序后是 $2, 2, 3, 3, 3, 3, 4, 4, 4, 4$。

本样例满足 Subtask $1, 4, 5, 6$。

#### 样例 #3 解释

本样例满足 Subtask $1, 2, 4, 5, 6$。

#### 样例 #4 解释

本样例满足 Subtask $1, 4, 5, 6$。

#### 数据范围与约定

**本题采用 Subtask 计分法。**

| Subtask | 分值占比百分率 | $n$ | $k$ | $y_i$ |
| :----: | :----: | :----: | :----:| :----: |
| $1$ | $5\%$ | $\le 10^3$ | / | / |
| $2$ | $6\%$ | / | / | $=0$ |
| $3$ | $7\%$ | / | $=1$ | / |
| $4$ | $20\%$ | / | $\le 10$ | / |
| $5$ | $27\%$ |  / | $\le 10 ^ 5$ | / |
| $6$ | $35\%$ | / | / | / |

**注：斜线表示无特殊限制。**

对于 $100\%$ 的数据：
- $2 \le n \le 2.5 \times 10^5$；
- $1 \le k \le \min(2.5\times 10^5,\ \dfrac{n\cdot(n-1)}{2}$)；
- $-10^9 \le x_i, y_i \le 10^9$，且 $1 \le i \le n$；
- $(x_i,y_i)\not = (x_j, y_j)$ 且 $1 \le i < j \le n$。

#### 说明

本题译自 [第２０回日本情報オリンピック 2020/2021春季トレーニング合宿 -](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/index.html) [競技 2 -](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/day2/2021-sp-d2-notice.pdf) [T2 日文题面](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/day2/road_construction.pdf)。



---


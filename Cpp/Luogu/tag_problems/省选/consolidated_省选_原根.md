---
title: "BZOJ3328 PYXFIB"
layout: "post"
diff: 省选/NOI-
pid: P10664
tag: ['原根', '数论', 'O2优化', '矩阵乘法', '单位根反演']
---
# BZOJ3328 PYXFIB
## 题目描述

给定整数 $n,k,p$，要求计算下列式子对 $p$ 取模的值：

$$\sum_{i=0}^{\lfloor \frac{n}{k} \rfloor} C_n^{i\times k}\times F_{i\times k}$$

其中：
- $p$ 为质数，且 $p$ 除以 $k$ 的余数为 $1$。
- $C$ 为组合数，即 $C_m^n=\frac{n!}{m!(n-m)!}$。
- $F_n$ 为斐波那契数列，即 $F_0=1$，$F_1=1$，$F_n=F_{n-1}+F_{n-2}(n\geq 2)$。
## 输入格式

第一行输入一个正整数 $T$，表示数据组数。

接下来 $T$ 行，每行三个正整数 $n,k,p$。
## 输出格式

输出 $T$ 行，每行一个整数，表示结果。
## 样例

### 样例输入 #1
```
1
1 2 3
```
### 样例输出 #1
```
1
```
## 提示

对于 $100\%$ 的数据，保证 $1\leq n\leq 10^{18}$，$1\leq k \leq 20000$，$1\leq T\leq 20$，$1\leq p\leq 10^9$，$p$ 为质数，且 $p$ 除以 $k$ 的余数为 $1$。


---

---
title: "【模板】基于值域预处理的快速离散对数"
layout: "post"
diff: 省选/NOI-
pid: P11175
tag: ['数学', '原根']
---
# 【模板】基于值域预处理的快速离散对数
## 题目背景

模板题，无背景。
## 题目描述

给定质数 $P$ 以及它的一个原根 $g$。

有 $q$ 组询问，每组询问给出整数 $y$，你需要找到最小的非负整数 $x$ 使得 $g^x\equiv y\pmod P$。
## 输入格式

第一行两个整数 $P,g$，描述质数 $P$ 及其一个原根 $g$。

第二行一个整数 $q$，表示询问次数。

接下来 $q$ 行，每行一个整数 $y$，表示每次询问的值。
## 输出格式

输出共 $q$ 行，每行一个整数表示答案。
## 样例

### 样例输入 #1
```
998244353 3
9
1
11
111
1111
11111
111111
1111111
11111111
111111111
```
### 样例输出 #1
```
0
258630203
771331691
346105458
268271589
571255383
916731589
304666893
915484870
```
### 样例输入 #2
```
1000000007 5
13
1
5
25
125
625
3125
15625
78125
390625
1953125
9765625
48828125
244140625
```
### 样例输出 #2
```
0
1
2
3
4
5
6
7
8
9
10
11
12
```
## 提示

### 数据范围及约束

- 对于前 $15\%$ 的数据，满足 $1\le g < P\le 100$，$1\le q\le 100$；
- 对于前 $30\%$ 的数据，满足 $1\le g < P\le 10^9+7$，$1\le q\le 100$；
- 另有 $15\%$ 的数据，满足 $y_i=i$；
- 另有 $15\%$ 的数据，满足 $P=998244353$，$g=3$；
- 对于全部数据，满足 $1\le g,y_i<P\le 10^9+7$，$1\le q\le 5\times 10^5$。

请注意读入效率对程序运行速度的影响。


---

---
title: "BZOJ2219 数论之神"
layout: "post"
diff: 省选/NOI-
pid: P12694
tag: ['原根', '中国剩余定理 CRT', '大步小步算法 BSGS']
---
# BZOJ2219 数论之神
## 题目描述

对于给定的 $3$ 个非负整数 $A,B,K$，求出满足：
- $X^A \equiv B \pmod{(2\times K + 1)}$ 
- $X$ 在范围 $[0, 2K]$ 内

的 $X$ 的个数。
## 输入格式

第一行有一个正整数 $T$，表示接下来的数据的组数（$T \leq 1000$）。之后对于每组数据，给出了 $3$ 个整数 $A, B, K$ （$1 \leq A, B \leq 10^9$, $1 \leq K \leq 5 \times 10^8$）
## 输出格式

输出一行，表示答案。
## 样例

### 样例输入 #1
```
3
213 46290770 80175784
3 46290770 80175784
3333 46290770 80175784

```
### 样例输出 #1
```
27
27
297
```


---


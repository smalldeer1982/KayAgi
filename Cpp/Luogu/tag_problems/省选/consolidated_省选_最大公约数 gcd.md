---
title: "实力派"
layout: "post"
diff: 省选/NOI-
pid: P10269
tag: ['数论', '素数判断,质数,筛法', '最大公约数 gcd', '莫比乌斯反演']
---
# 实力派
## 题目背景

![](https://cdn.luogu.com.cn/upload/image_hosting/z8ednvb2.png)
## 题目描述

来自全国各地的 $n$ 位 OIer 组成了一个名为“实力派”的团队，每个人有一个实力值 $a_i$。共有 $m$ 场比赛向他们发送了参赛邀请，其中第 $i$ 场比赛要求 $k_i$ 个人组成一个队伍参加。为了决定他们是否应该参加某场比赛，他们想出了如下两个衡量实力的数据：

- 定义 $x$ 阶最低实力表示从这 $n$ 个人中选出 $x$ 个人，使得这 $x$ 个人实力值的 $\gcd=1$ 的方案数；

- 定义 $x$ 阶最高实力表示从这 $n$ 个人中选出 $x$ 个人，所有方案的 $x$ 个人的 $\gcd$ 之和。

请你对于每场比赛，告诉他们他们在这场比赛中的 $k_i$ 阶最低实力和最高实力。对了，为了不让别人听懂，你需要将答案对一个秘密模数 $p$ 取模。
## 输入格式

第一行三个整数 $n,m,p$，分别表示团队人数，比赛场数及秘密模数；

第二行 $n$ 个整数，第 $i$ 个整数表示第 $i$ 个人的实力值 $a_i$。

接下来 $m$ 行，第 $i$ 行一个整数 $k_i$，表示第 $i$ 场比赛的要求参赛人数。
## 输出格式

输出共 $m$ 行，第 $i$ 行两个整数 $min_i,max_i$，分别表示他们在第 $i$ 场比赛中的最低实力和最高实力，答案对 $p$ 取模。
## 样例

### 样例输入 #1
```
4 4 998244353
8 15 12 6
2
3
4
5
```
### 样例输出 #1
```
1 19
2 7
1 1
0 0
```
### 样例输入 #2
```
6 4 19260817
11 45 14 19 19 810
2
1
2
2
```
### 样例输出 #2
```
12 78
0 918
12 78
12 78
```
### 样例输入 #3
```
8 3 19491001
3 2 2 3 1 2 1 2
5
3
4
```
### 样例输出 #3
```
56 56
52 60
69 71
```
## 提示

**样例** $\mathbf{1}$ **解释**

第一场比赛要求选出 $2$ 人参加，仅有 $(8,15)$ 一种方案的 $\gcd=1$，因此最低实力为 $1$；所有方案的 $\gcd$ 之和为 $19$，因此最高实力为 $19$；

第二场比赛要求选出 $3$ 人参加，有 $(8,15,12)$ 和 $(8,15,6)$ 两种 $\gcd=1$ 的方案，因此最低实力为 $2$；所有方案的 $\gcd$ 之和为 $7$，因此最高实力为 $7$。

**数据范围**

对于所有数据，$1\leq n,m,k_i\leq 2\times 10^5$，$1\leq a_i\leq 10^6$，$10^7\leq p\leq 10^9$，$p\in \mathbb{P}$。

本题共 $30$ 个测试点，**采用捆绑测试**，子任务及数据点分配如下：

| 子任务编号 | 数据点编号 | 特殊性质 | 分值 | 时限 |
| :-: | :-: | :-: | :-: | :-: |
| $0$ | $1\sim 4$ | $n\leq 20$ | $10$ | $1s$ |
| $1$ | $5\sim 8$ | $n,a_i\leq 300$ | $10$ | $1s$ | 
| $2$ | $9\sim 12$ | $k_i\leq 2$ | $20$ | $1.5s$ |
| $3$ | $13\sim 16$ | $a_i\leq 3$ | $10$ | $1s$ |
| $4$ | $17\sim 22$ | $a_i\leq 10^5$ | $20$ | $1s$ |
| $5$ | $23\sim 30$ | 无特殊性质 | $30$ | $1.5s$ |

**提示**

$\mathbb{P}$ 表示全体质数集合，$\gcd$ 表示最大公因数。


---

---
title: "[NOI2008] 假面舞会"
layout: "post"
diff: 省选/NOI-
pid: P1477
tag: ['图论', '2008', 'NOI', '深度优先搜索 DFS', '最大公约数 gcd']
---
# [NOI2008] 假面舞会
## 题目描述

一年一度的假面舞会又开始了，栋栋也兴致勃勃的参加了今年的舞会。

今年的面具都是主办方特别定制的。每个参加舞会的人都可以在入场时选择一个自己喜欢的面具。每个面具都有一个编号，主办方会把此编号告诉拿该面具的人。

为了使舞会更有神秘感，主办方把面具分为 $k$（$k\geq 3$）类，并使用特殊的技术将每个面具的编号标在了面具上，只有戴第 $i$ 类面具的人才能看到戴第 $i+1$  类面具的人的编号，戴第 $k$ 类面具的人能看到戴第 $1$ 类面具的人的编号。

参加舞会的人并不知道有多少类面具，但是栋栋对此却特别好奇，他想自己算出有多少类面具，于是他开始在人群中收集信息。

栋栋收集的信息都是戴第几号面具的人看到了第几号面具的编号。如戴第 $2$ 号面具的人看到了第 $5$ 号面具的编号。栋栋自己也会看到一些编号，他也会根据自己的面具编号把信息补充进去。

由于并不是每个人都能记住自己所看到的全部编号，因此，栋栋收集的信息不能保证其完整性。现在请你计算，按照栋栋目前得到的信息，至多和至少有多少类面具。由于主办方已经声明了 $k\geq 3$，所以你必须将这条信息也考虑进去。

## 输入格式

第一行包含两个整数 $n, m$，用一个空格分隔，$n$ 表示主办方总共准备了多少个面具，$m$ 表示栋栋收集了多少条信息。接下来 $m$ 行，每行为两个用空格分开的整数 $a, b$，表示戴第 $a$ 号面具的人看到了第 $b$ 号面具的编号。相同的数对 $a, b$ 在输入文件中可能出现多次。

## 输出格式

包含两个数，第一个数为最大可能的面具类数，第二个数为最小可能的面具类数。如果无法将所有的面具分为至少 $3$ 类，使得这些信息都满足，则认为栋栋收集的信息有错误，输出两个 `-1`。

## 样例

### 样例输入 #1
```
6 5
1 2
2 3
3 4
4 1
3 5
```
### 样例输出 #1
```
4 4

```
### 样例输入 #2
```
3 3
1 2
2 1
2 3
```
### 样例输出 #2
```
-1 -1

```
## 提示

- 对于 $50\%$ 的数据，满足 $n \leq 300$，$m \leq 10^3$；
- 对于 $100\%$ 的数据，满足 $n \leq 10^5$，$m \leq 10^6$。



---

---
title: "[HAOI2008] 圆上的整点"
layout: "post"
diff: 省选/NOI-
pid: P2508
tag: ['数学', '2008', '河南', '各省省选', '枚举', '最大公约数 gcd']
---
# [HAOI2008] 圆上的整点
## 题目描述

求一个给定的圆$(x^2+y^2=r^2)$，在圆周上有多少个点的坐标是整数。

## 输入格式

r
## 输出格式

整点个数

## 样例

### 样例输入 #1
```
4
```
### 样例输出 #1
```
4
```
## 提示

$r\leq 2000 000 000$



---

---
title: "[CQOI2015] 选数"
layout: "post"
diff: 省选/NOI-
pid: P3172
tag: ['递推', '2015', '重庆', '各省省选', '最大公约数 gcd', '莫比乌斯反演']
---
# [CQOI2015] 选数
## 题目描述

我们知道，从区间 $[L,H]$（$L$ 和 $H$ 为整数）中选取 $N$ 个整数，总共有 $(H-L+1)^N$ 种方案。小 z 很好奇这样选出的数的最大公约数的规律，他决定对每种方案选出的 $N$ 个整数都求一次最大公约数，以便进一步研究。然而他很快发现工作量太大了，于是向你寻求帮助。你的任务很简单，小 z 会告诉你一个整数 $K$，你需要回答他最大公约数刚好为 $K$ 的选取方案有多少个。

由于方案数较大，你只需要输出其除以 $10^9+7$ 的余数即可。
## 输入格式

输入一行，包含四个空格分开的正整数，依次为 $N,K,L,H$。

## 输出格式

输出一个整数，为所求方案数除以 $10^9 + 7$ 的余数。

## 样例

### 样例输入 #1
```
2 2 2 4
```
### 样例输出 #1
```
3
```
## 提示

#### 样例 1 解释

所有可能的选择方案：$(2, 2), (2, 3), (2, 4), (3, 2), (3, 3), (3, 4), (4, 2), (4, 3), (4, 4)$。

其中最大公约数等于 $2$ 的只有 $3$ 组：$(2, 2), (2, 4), (4, 2)$。
#### 数据规模与约定
对于 $100\%$ 的数据，$1\le N,K\le 10^9$，$1\le L\le H\le 10^9$，$H-L\le 10^5$。


---

---
title: "[HNOI2011] 勾股定理"
layout: "post"
diff: 省选/NOI-
pid: P3213
tag: ['2011', '湖南', '枚举', '连通块', '最大公约数 gcd']
---
# [HNOI2011] 勾股定理
## 题目描述

沫沫最近在研究勾股定理。对于两个正整数 A 与 B，若存在正整数 C 使得 A2+B2=C2，且 A 与 B 互质，则称(A,B)为一个互质勾股数对。


有一天，沫沫得到了 N 根木棍，其长度都是正整数，她准备从中挑选出若干根木棍来玩拼图游戏，为了使拼出的图案有凌乱美，她希望挑选出的木棍中任意两根的长度均不是互质勾股数对。现在，沫沫想知道有多少种满足要求的挑选木棍的方案。由于答案可能很大，你只要输出答案对 $10^9+7$ 取模的结果。

## 输入格式

从文件input.txt中读入数据，输入文件第一行是一个正整数N，表示共有多少根木棍。

输入文件第二行是用空格隔开的N个正整数h1, h2, …, hN，其中对1≤i≤N，hi表示第i根木棍的长度。

输入的数据保证30%的数据满足对$1≤i≤N$有$1≤h_i≤3000$，

另外30%的数据满足对$1≤i≤N$有$1≤hi≤200000$，

剩下的40%的数据满足对$1≤i≤N$有$20000≤h_i≤1000000$，

100%的数据满足$N≤1000000$。

## 输出格式

输出文件 output.txt 仅包含一个非负整数，表示满足要求的挑选木棍的方案数对 109+7 取模的结果。

## 样例

### 样例输入 #1
```
4				
5 12 35 5	

```
### 样例输出 #1
```
8
```
## 提示

样例解释：（5,12）与（12,35）是互质勾股数对，故满足要求的挑选木棍的方案有8种，即：


{5}，{12}，{35}，{5}，{5,35}，{35,5}，{5,5}，{5,35,5}。



---

---
title: "[SDOI2014] 数表"
layout: "post"
diff: 省选/NOI-
pid: P3312
tag: ['2014', '山东', '最大公约数 gcd', '莫比乌斯反演', '前缀和']
---
# [SDOI2014] 数表
## 题目描述

有一张 $n\times m$ 的数表，其第 $i$ 行第 $j$ 列（$1\le i\le n$，$1\le j\le m$）的数值为能同时整除 $i$ 和 $j$ 的所有自然数之和。给定 $a$，计算数表中不大于 $a$ 的数之和。
## 输入格式

**输入包含多组数据。**

输入的第一行一个整数 $Q$ 表示测试点内的数据组数。

接下来 $Q$ 行，每行三个整数 $n$，$m$，$a$（$|a|\le 10^9$）描述一组数据。
## 输出格式

对每组数据，输出一行一个整数，表示答案模 $2^{31}$ 的值。

## 样例

### 样例输入 #1
```
2
4 4 3
10 10 5
```
### 样例输出 #1
```
20
148
```
## 提示

### 数据范围及约定

对于全部数据，$1\le n,m\le 10^5$，$1\le Q\le 2\times 10^4$。



---

---
title: "[SDOI2015] 约数个数和"
layout: "post"
diff: 省选/NOI-
pid: P3327
tag: ['数学', '2015', '山东', '最大公约数 gcd', '莫比乌斯反演']
---
# [SDOI2015] 约数个数和
## 题目描述

设 $d(x)$ 为 $x$ 的约数个数，给定 $n,m$，求    
$$\sum_{i=1}^n\sum_{j=1}^md(ij)$$

## 输入格式

输入文件包含多组测试数据。   
第一行，一个整数 $T$，表示测试数据的组数。  
接下来的 $T$ 行，每行两个整数 $n,m$。

## 输出格式

$T$ 行，每行一个整数，表示你所求的答案。

## 样例

### 样例输入 #1
```
2
7 4
5 6
```
### 样例输出 #1
```
110
121
```
## 提示

【数据范围】   
对于 $100\%$ 的数据，$1\le T,n,m \le 50000$。



---

---
title: "【模板】扩展中国剩余定理（EXCRT）"
layout: "post"
diff: 省选/NOI-
pid: P4777
tag: ['最大公约数 gcd', '中国剩余定理 CRT']
---
# 【模板】扩展中国剩余定理（EXCRT）
## 题目描述

给定 $n$ 组非负整数 $a_i, b_i$ ，求解关于 $x$ 的方程组的最小非负整数解。
$$\begin{cases}x\equiv b_1\pmod{a_1}\\x\equiv b_2\pmod{a_2}\\\dots\\x\equiv b_n\pmod{a_n}\end{cases}$$
## 输入格式

输入第一行包含整数 $n$。

接下来 $n$ 行，每行两个非负整数 $a_i, b_i$。
## 输出格式

输出一行，为满足条件的最小非负整数 $x$。
## 样例

### 样例输入 #1
```
3
11 6
25 9
33 17

```
### 样例输出 #1
```
809
```
## 提示

对于 $100 \%$ 的数据，$1 \le n \le {10}^5$，$1 \le b_i,a_i \le {10}^{12}$，保证所有 $a_i$ 的最小公倍数不超过 ${10}^{18}$。

**请注意程序运行过程中进行乘法运算时结果可能有溢出的风险。**

数据保证有解。


---

---
title: "基于值域预处理的快速 GCD"
layout: "post"
diff: 省选/NOI-
pid: P5435
tag: ['数论', 'O2优化', '最大公约数 gcd']
---
# 基于值域预处理的快速 GCD
## 题目背景

模板题，无背景。
## 题目描述

给定 $n$ 个正整数 $a_1,a_2,\dots,a_n$，再给定 $n$ 个正整数 $b_1,b_2,\dots,b_n$，你需要对每对 $(i,j)$ 求出 $a_i$ 与 $b_j$ 的最大公因数。

不难发现你的输出应有 $n^2$ 个正整数。为了减少输出对程序的运行效率的影响，你只需要输出 $n$ 行，每行一个整数 $A_i$。

其中对于 $i\in[1,n]$，$A_i=\sum_{j=1}^{n}i^j\gcd(a_i,b_j)$。由于答案可能过大，你只需要输出模 $998,244,353$ 后的结果即可。
## 输入格式

第一行一个正整数 $n$。

第二行 $n$ 个正整数，表示 $a_1,a_2,\dots,a_n$。

第三行 $n$ 个正整数，表示 $b_1,b_2,\dots,b_n$。
## 输出格式

共 $n$ 行，第 $i$ 行应输出一个非负整数 $A_i$。意义见题目描述。
## 样例

### 样例输入 #1
```
5
200 300 300 300 23333
666 666 666 666 123456

```
### 样例输出 #1
```
16
564
3636
14328
3905

```
## 提示

对于 $20\%$ 的数据，$1\leqslant n\leqslant 500$。

对于 $100\%$ 的数据，$1\leqslant n\leqslant 5000;1\leqslant a_i,b_i\leqslant 10^6$。

**请注意常数因子对程序运行效率的影响**


---

---
title: "[省选联考 2020 A 卷] 作业题"
layout: "post"
diff: 省选/NOI-
pid: P6624
tag: ['数学', '2020', '各省省选', '矩阵树定理', '最大公约数 gcd']
---
# [省选联考 2020 A 卷] 作业题
## 题目描述

小 W 刚刚在离散数学课学习了生成树的知识：一个无向图 $G=(V,E)$ 的生成树 $T$ 为边集 $E$ 的一个大小为 $|V|-1$ 的子集，且保证 $T$ 的生成子图在 $G$ 中连通。

小 W 在做今天的作业时被这样一道题目难住了：

给定一个 $n$ 个顶点 $m$ 条边（点和边都从 $1$ 开始编号）的无向图 $G$，保证图中无重边和无自环。每一条边有一个正整数边权 $w_i$，对于一棵 $G$ 的生成树 $T$，定义 $T$ 的价值为：$T$ 所包含的边的边权的最大公约数乘以边权之和，即：

$$
val(T)=\left(\sum\limits_{i=1}^{n-1} w_{e_i}\right) \times \gcd(w_{e_1},w_{e_2},\dots,w_{e_{n-1}})
$$

其中 $e_1,e_2,\dots,e_{n-1}$ 为 $T$ 包含的边的编号。

小 W 需要求出 $G$ 的所有生成树 $T$ 的价值之和，他做了很久也没做出来，请你帮帮他。由于答案可能很大，你只需要给出答案对 $998244353$ 取模后的结果。
## 输入格式

第一行两个正整数 $n,m$，表示 $G$ 的点数和边数。

接下来 $m$ 行，每行三个正整数 $u_i,v_i,w_i$，第 $i$ 行表示一条无向边连接 $u_i$ 号点和 $v_i$ 号点，权值为 $w_i$。

## 输出格式

仅一行一个整数，表示答案对 $998244353$ 取模后的结果。
## 样例

### 样例输入 #1
```
3 3
1 2 4
2 3 6
1 3 12
```
### 样例输出 #1
```
192
```
## 提示

【样例解释 $1$】

$G$ 共有三棵生成树：

$T_1=\{(1,2),(2,3)\}$，价值为 $10\times 2=20$。

$T_2=\{(1,2),(1,3)\}$，价值为 $16\times 4=64$。

$T_3=\{(1,3),(2,3)\}$，价值为 $18\times 6=108$。

总和为 $192$。

【数据规模】

$10\%$ 的数据满足：$m\leq 15$。

另有 $20\%$ 的数据满足：$m \leq n$。

另有 $20\%$ 的数据满足：$w_i$ 均相同。

另有 $20\%$ 的数据满足：$w_i$ 均为质数。

$100\%$ 的数据满足：$1\leq n\leq 30, 1\leq m \leq \frac {n(n-1)}{2}, 1\leq w_i \leq 152501$。


---

---
title: "「JZOI-1」红包"
layout: "post"
diff: 省选/NOI-
pid: P7360
tag: ['素数判断,质数,筛法', '最大公约数 gcd', '莫比乌斯反演', '二项式定理', '容斥原理']
---
# 「JZOI-1」红包
## 题目背景

新年到了，小僖收到了叔叔寄给他的红包，这个红包里面有很多很多的钱。
## 题目描述

小僖收到的红包总额是这样的：

所有 $K$ 元组满足每个元素都是正整数且 $\le N$，总额就是这些 $K$ 元组的最小公倍数的乘积。

但由于叔叔并没有那么多的钱，所以结果还要对 $998244353$ 取模。

小僖花了 $10^{-16}$ 秒就算了出来，但他想验证一下是否正确，于是找上了你（别问我为什么他不直接拆开红包看）。

换句话讲，题目只需要你求：
$$\prod_{i_1=1}^N\prod_{i_2=1}^N...\prod_{i_K=1}^N{\rm lcm}(i_1,i_2...i_K)\mod 998244353$$
保证 $K>1$，其中，${\rm lcm}(i_1,i_2...i_K)$，表示 $i_1,i_2...i_K$ 的最小公倍数。
## 输入格式

**本题有多组数据**。

第一行一个数：$T$，表示数据组数。

接下来 $T$ 行，每行两个数，$N,K$，表示每组询问。
## 输出格式

$T$ 行，每行一个数，表示答案，记得对 $998244353$ 取模。
## 样例

### 样例输入 #1
```
2
2 2
3 2
```
### 样例输出 #1
```
8
7776
```
## 提示

对于样例的第一组数据，题目要求求出 ${\rm lcm}(1,1)\times {\rm lcm}(1,2)\times {\rm lcm}(2,1)\times {\rm lcm}(2,2)$。

显然，除了 ${\rm lcm}(1,1)=1$ 以外其它的结果都为 $2$，所以答案为 $1\times2\times2\times2=8$。

| 数据编号 | $N\le$ | $K\leq$ | $T=$ |
| :-----------: | ----------- | ----------- | ----------- |
| **0** |$10$|$5$|$10$|
| **1** | $10^6$ |$2$|$10^3$|
| **2** | $10^6$ |$3$|$10^3$|
| **3** | $100$ |$10^{18}$|$100$|
| **4** | $10^5$ |$100$|$10^3$|
| **5** | $10^5$ |$3\times10^8$|$1$|
| **6** | $10^5$ |$10^{100}$| $10$ |
| **7** |$10^6$|$10^{18}$|$10^3$|
| **8** |$10^6$|$10^{100}$|$10^3$|
| **9** |$10^6$|$10^{100}$|$10^3$|

**出题人：你真以为有这么多钱，哈哈，里面装的全是津巴布韦币哦！**


---

---
title: "干杯！再会！"
layout: "post"
diff: 省选/NOI-
pid: P7496
tag: ['数学', '2021', 'O2优化', '最大公约数 gcd', '莫比乌斯反演']
---
# 干杯！再会！
## 题目背景

>酒酣之时，等待你的会是……

黛米和哥哥在一个小城镇里经营着一家小酒吧。靠着哥哥调制的多夫林酒，这间小酒吧的生意也逐渐兴隆起来。
## 题目描述

这家小店有 $n$ 位常驻顾客。第 $i$ 位顾客来到这家小店时都会带上一瓶美味度为 $a_i$ 的底酒和一份美味度为 $b_i$ 的调料。这些顾客会让黛米帮忙调酒。对于一瓶美味度为 $x$ 的底酒和一份美味度为 $y$ 的调料，如果黛米将它们调制在一起，就能得到一瓶美味度为 $\gcd(x,y)$ 的美酒（我们认为美味度数值越低代表酒越好喝）。

这一天，这些顾客同时来到了这家小店想要黛米帮忙调酒。然而黛米在前一天喝了太多的酒导致意识错乱了，这导致她将调料加入到了错误的底酒里。不过好在这些顾客并不在意，他们只想知道对于**所有**黛米加入调料的情况下，他们将会拿到的酒的美味度的**方差**的**和**在对 $10^9+7$ 取模意义下是多少。如果你能回答出他们的问题，那么他们会很愿意帮你支付酒钱。

------------
#### 简要题意：
给定 $n$ 以及两个长度为 $n$ 的序列 $a,b$。对于一个 $1$ 到 $n$ 的排列 $p$，记 $c_i=\gcd(a_i,b_{p_i})$，$\sigma(c)$ 表示序列 $c$ 中所有元素的**方差**（方差公式详见提示），求：

$$\sum\limits_{p}\sigma(c)$$

对 $10^9+7$ 取模。
## 输入格式

第一行一个整数 $n$，意义如上。

第二行有 $n$ 个整数，第 $i$ 个整数表示 $a_i$。

第三行有 $n$ 个整数，第 $i$ 个整数表示 $b_i$。
## 输出格式

一行一个整数，表示答案。
## 样例

### 样例输入 #1
```
3
1 2 3
1 2 3

```
### 样例输出 #1
```
777777785
```
### 样例输入 #2
```
12
1 3 4 2 3 5 7 3 5 6 8 9
4 3 10 2 5 6 4 8 2 9 12 5

```
### 样例输出 #2
```
931089600
```
## 提示

#### 样例一解释
+ $p=\{1,2,3\},c=\{1,2,3\},\sigma(c)=\dfrac{2}{3}$。
+ $p=\{1,3,2\},c=\{1,1,1\},\sigma(c)=0$。
+ $p=\{2,1,3\},c=\{1,1,3\},\sigma(c)=\dfrac{8}{9}$。
+ $p=\{2,3,1\},c=\{1,1,1\},\sigma(c)=0$。
+ $p=\{3,1,2\},c=\{1,1,1\},\sigma(c)=0$。
+ $p=\{3,2,1\},c=\{1,2,1\},\sigma(c)=\dfrac{2}{9}$。

总和为 $\dfrac{16}{9}$，对 $10^9+7$ 取模意义下为 $777777785$。

------------
#### 数据范围

**本题采用捆绑测试**。

+ Subtask 1 ( $5\%$ )：$n\leq8$。
+ Subtask 2 ( $15\%$ )：$n,a_i,b_i\leq100$。
+ Subtask 3 ( $25\%$ )：$a_i,b_i\leq10^3$。
+ Subtask 4 ( $25\%$ )：$n,a_i,b_i\leq 10^5$。
+ Subtask 5 ( $30\%$ )：无特殊限制。

对于所有数据，$2\leq n\leq 10^6,1\leq a_i,b_i\leq 10^6$。

------------
对于一个长度为 $n$ 的序列 $x$，方差 $\sigma(x)=\sum\limits_{i=1}^n\dfrac{1}{n}(x_i-\bar{x})^2$，其中 $\bar{x}$ 表示所有元素的平均数（$\bar{x}=\dfrac{1}{n}\sum\limits_{i=1}^nx_i$）。


---

---
title: "[BalkanOI 2003] Farey 序列"
layout: "post"
diff: 省选/NOI-
pid: P8058
tag: ['2003', '二分', '数论', '素数判断,质数,筛法', '最大公约数 gcd', '莫比乌斯反演', 'Stern-Brocot 树', 'BalkanOI（巴尔干半岛）']
---
# [BalkanOI 2003] Farey 序列
## 题目描述

把所有分子和分母都 $\leq n$ 的**最简真分数**从小到大排成一行，形成的序列称为 Farey 序列。

求出 $n$ 所对应的 Farey 序列中第 $k$ 小的数。
## 输入格式

一行，两个整数 $n, k$。
## 输出格式

一行，两个整数 $p, q$，表示答案 $\frac{p}{q}$。
## 样例

### 样例输入 #1
```
5 6
```
### 样例输出 #1
```
3 5
```
## 提示

对于 $100\%$ 的数据，$2 \leq n \leq 4 \times 10^4$，$1 \leq k \leq$ 符合条件的分数的个数。


---


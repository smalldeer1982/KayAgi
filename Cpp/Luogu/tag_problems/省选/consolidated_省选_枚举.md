---
title: "[NOI2016] 优秀的拆分"
layout: "post"
diff: 省选/NOI-
pid: P1117
tag: ['字符串', '2016', 'NOI', 'O2优化', '枚举', '后缀数组 SA']
---
# [NOI2016] 优秀的拆分
## 题目描述

如果一个字符串可以被拆分为 $\text{AABB}$ 的形式，其中 $\text{A}$ 和 $\text{B}$ 是任意**非空**字符串，则我们称该字符串的这种拆分是优秀的。  
例如，对于字符串 $ \texttt{aabaabaa} $ ，如果令 $\text{A}=\texttt{aab}$，$\text{B}=\texttt{a}$，我们就找到了这个字符串拆分成 $\text{AABB}$ 的一种方式。

一个字符串可能没有优秀的拆分，也可能存在不止一种优秀的拆分。  
比如我们令 $\text{A}=\texttt{a}$，$\text{B}=\texttt{baa}$，也可以用 $\text{AABB}$ 表示出上述字符串；但是，字符串 $\texttt{abaabaa}$ 就没有优秀的拆分。

现在给出一个长度为 $n$ 的字符串 $S$，我们需要求出，在它所有子串的所有拆分方式中，优秀拆分的总个数。这里的子串是指字符串中连续的一段。

以下事项需要注意：

1. 出现在不同位置的相同子串，我们认为是不同的子串，它们的优秀拆分均会被记入答案。
2. 在一个拆分中，允许出现 $\text{A}=\text{B}$。例如 $\texttt{cccc}$ 存在拆分 $\text{A}=\text{B}=\texttt{c}$。
3. 字符串本身也是它的一个子串。
## 输入格式

每个输入文件包含多组数据。

输入文件的第一行只有一个整数 $T$，表示数据的组数。

接下来 $T$ 行，每行包含一个仅由英文小写字母构成的字符串 $S$，意义如题所述。
## 输出格式

输出 $T$ 行，每行包含一个整数，表示字符串 $S$ 所有子串的所有拆分中，总共有多少个是优秀的拆分。
## 样例

### 样例输入 #1
```
4
aabbbb
cccccc
aabaabaabaa
bbaabaababaaba

```
### 样例输出 #1
```
3
5
4
7

```
## 提示

### 样例解释

我们用 $S[i, j]$ 表示字符串 $S$ 第 $i$ 个字符到第 $j$ 个字符的子串（从 $1$ 开始计数）。

第一组数据中，共有三个子串存在优秀的拆分：  
$S[1,4]=\texttt{aabb}$，优秀的拆分为 $\text{A}=\texttt{a}$，$\text{B}=\texttt{b}$；  
$S[3,6]=\texttt{bbbb}$，优秀的拆分为 $\text{A}=\texttt{b}$，$\text{B}=\texttt{b}$；  
$S[1,6]=\texttt{aabbbb}$，优秀的拆分为 $\text{A}=\texttt{a}$，$\text{B}=\texttt{bb}$。  
而剩下的子串不存在优秀的拆分，所以第一组数据的答案是 $3$。

第二组数据中，有两类，总共四个子串存在优秀的拆分：  
对于子串 $S[1,4]=S[2,5]=S[3,6]=\texttt{cccc}$，它们优秀的拆分相同，均为 $\text{A}=\texttt{c}$，$\text{B}=\texttt{c}$，但由于这些子串位置不同，因此要计算三次；  
对于子串 $S[1,6]=\texttt{cccccc}$，它优秀的拆分有两种：$\text{A}=\texttt{c}$，$\text{B}=\texttt{cc}$ 和 $\text{A}=\texttt{cc}$，$\text{B}=\texttt{c}$，它们是相同子串的不同拆分，也都要计入答案。  
所以第二组数据的答案是 $3+2=5$。

第三组数据中，$S[1,8]$ 和 $S[4,11]$ 各有两种优秀的拆分，其中 $S[1,8]$ 是问题描述中的例子，所以答案是 $2+2=4$。

第四组数据中，$S[1,4]$，$S[6,11]$，$S[7,12]$，$S[2,11]$，$S[1,8]$ 各有一种优秀的拆分，$S[3,14]$ 有两种优秀的拆分，所以答案是 $5+2=7$。

### 数据范围

对于全部的测试点，保证 $1 \leq T \leq 10$。以下对数据的限制均是对于单组输入数据而言的，也就是说同一个测试点下的 $T$ 组数据均满足限制条件。

我们假定 $n$ 为字符串 $S$ 的长度，每个测试点的详细数据范围见下表：

| 测试点编号   | $n \leq$  | 特殊性质           |
| ------------ | --------- | ------------------ |
| $1 \sim 2$   | $300$     | $S$ 中所有字符相同 |
| $3 \sim 4$   | $2\,000$  | $S$ 中所有字符相同 |
| $5 \sim 6$   | $10$      |                    |
| $7 \sim 8$   | $20$      |                    |
| $9 \sim 10$  | $30$      |                    |
| $11 \sim 12$ | $50$      |                    |
| $13 \sim 14$ | $100$     |                    |
| $15$         | $200$     |                    |
| $16$         | $300$     |                    |
| $17$         | $500$     |                    |
| $18$         | $1\,000$  |                    |
| $19$         | $2\,000$  |                    |
| $20$         | $30\,000$ |                    |


---

---
title: "「FAOI-R9」少年游"
layout: "post"
diff: 省选/NOI-
pid: P12399
tag: ['洛谷原创', '交互题', 'Special Judge', 'O2优化', '枚举', '洛谷月赛', 'Ad-hoc']
---
# 「FAOI-R9」少年游
## 题目背景

> 「欲买桂花同载酒，终不似，少年游。」
> 
> ——刘过《唐多令·芦叶满汀洲》

清风想起了自己学完语法第一次接触算法的那天，当时他惊叹于最大子段和的线性做法的奇妙，居然不用暴力枚举每个区间。

“明月，我们能玩一个游戏吗？”
## 题目描述

明月现在想出了一个长度为 $ n $ 的整数序列 $ a $，对于任意 $1  \le i \le n $ 满足 $ |a_i| \le 10^6 $，这个序列在初始时已经完全确定。

明月只告诉了清风 $ n $ 的值，清风现在可以提出最多 $ 10^4 $ 个询问，每次询问给出一个区间 $ [l,r] $，表示将 $ a $ 序列区间内元素的值全都乘上 $ -1 $，之后明月告诉他操作完之后这个序列的最大子段和的值。而这个要求必须满足 $ 1 \le l \le r \le n $。**操作的效果（对 $ a $ 序列元素的改动）是永久保留的。**

本题中序列的最大子段和的定义为选出序列中的一个**可以为空**的连续段使得元素的和最大，这个最大值即为这个序列的最大子段和。

而清风的目标就是还原这个序列的每个元素的初始值，清风可以进行最多一次作答。

假如你是清风，请完成这个游戏。**注意你的得分和询问次数相关。**

### 交互格式

第一行输入一个整数 $ n $。

在此之后，你应该进行若干次询问，每次询问形如 $ ?\ l \ r $，表示给出一个区间 $ [l,r] $，你需要保证 $ 1 \le l \le r \le n $。

如果你得到了答案，请你进行形如 $ !\ a_1\ a_2\ a_3 \dots a_n $ 的回答，代表你得到了 $ a $ 数组每个元素的初始值。你需要保证 $ |a_i| \le 10^6 $。在此之后你应该立即退出本轮交互。

每次输出后，请**刷新缓冲区**。

你可以使用如下语句来清空缓冲区：

- 对于 C/C++：`fflush(stdout)`；
- 对于 C++：`std::cout << std::flush`；
- 对于 Java：`System.out.flush()`；
- 对于 Python：`stdout.flush()`；
- 对于 Pascal：`flush(output)`；
- 对于其他语言，请自行查阅对应语言的帮助文档。

特别的，对于 C++ 语言，在输出换行时如果你使用 `std::endl` 而不是 `'\n'`，也可以自动刷新缓冲区。

每次询问并刷新缓冲区后，你将从标准输入中输入一个数字 $ M $，表示序列 $ a $ 的最大子段和。
## 输入格式

本题有多组数据。

第一行，一个整数 $T$ 表示数据组数。

对于每一组数据，请按照 **【交互格式】** 进行交互。当你报告 $ a $ 序列每个位置的初始值后：

+ 如果你给出的初值正确：
	+ 如果这是最后一组数据，交互库退出根据询问次数打分；
	+ 如果这不是最后一组数据，你应当接着读入 $n$ 以进行下一组数据的交互。
+ 否则，初值错误，交互库会立刻终止，给你打 $ 0 $ 分。
+ 打分规则具体参见 **【计分方式】** 一节。
## 输出格式

见 **【输入格式】**。
## 样例

### 样例输入 #1
```
1
5

3

2
```
### 样例输出 #1
```


? 1 3

? 1 3

! 1 -1 0 2 -2
```
## 提示

**【样例 1 解释】**

$ a $ 序列的初始值为 $ \{1,-1,0,2,-2\} $。

样例提供的交互过程不符合逻辑（也就是说凭这些信息猜不出 $ a $ 的所有元素初值），只是演示交互格式而已。

**【数据规模与约定】**

**本题采用捆绑测试。**

对于每个测试点，$ 1 \le T \le 10 $，$ 2 \le n \le 10^3 $，$ |a_i| \le 10^6 $，且**交互库不是适应性的**，即 $ a_i $ 的所有值在交互开始前**已经全部生成**。

* Subtask 1（20 pts）：$ n \le 13 $。
* Subtask 2（80 pts）：无特殊限制。

**【计分方式】**

* 如果你在一些测试点上出现 TLE / RE 等错误，你该子任务不得分。
* 对于每组数据：若你出现格式错误或询问次数超过 $ 10^4 $，或答案不正确，则该组数据得分比率为 $ 0.0 $。否则按照以下方式计分：
  * 记你在该组测试数据的询问次数为 $ Q $；
  * 若 $ Q \le 3001 $，你得分比率为 $ 1.0 $；
  * 若 $ 3001 < Q \le 3011 $，则你的得分比率为 $ 1.0-\frac{Q-3001}{100} $；
  * 若 $ Q>3011 $，则你得分为 $ 0.9-\frac{Q-3011}{10000} $。
* 对于每个测试点，你的得分比率为该测试点所有数据的最小值；对于每个子任务，你的得分比率为该组子任务的每个测试点的最小值。
* 由于最终分数为整数，分数计算结果可能会被四舍五入，但是保证较多次数对应得分比率一定不比较少次数对应比率的测试数据得分高。

**【后记】**

“希望未来的道路上，你们的脆弱永远都有人能够包容；你们说的话，永远都有人能聆听。”
 
“大家的十里春风，永远都有人能懂。”


---

---
title: "Mivik 写书"
layout: "post"
diff: 省选/NOI-
pid: P1316
tag: ['字符串', '枚举', '容斥原理', '快速数论变换 NTT']
---
# Mivik 写书
## 题目背景

Mivik 想当大作家。
## 题目描述

Mivik 的键盘上有 $m$ 个不同的按键，对应着 $m$ 个不同的字符。由于 Mivik 不会写文章，所以他只好**等概率**随机乱按了 $n$ 个键，打出了一篇文章。

Mivik 定义一篇文章的复杂度是这篇文章所有**非空**本质不同子串的数目。我们认为两个字符串本质不同当且仅当它们的长度不同或者它们有任意一位上的字符不同。例如，文章 `abaa` 的复杂度是 8，因为它一共有 `a`、`b`、`ab`、`ba`、`aa`、`aba`、`baa`、`abaa` 这 8 个非空的本质不同子串。

Mivik 现在想知道，这篇文章期望的复杂度是多少。由于 Mivik 不喜欢奇形怪状的小数，你只需要输出期望的复杂度对 $10^9+7$ 取模后的值。
## 输入格式

一行两个整数 $n$ 和 $m$，意义见题目描述。
## 输出格式

一行一个整数，代表答案对 $10^9+7$ 取模后的值。
## 样例

### 样例输入 #1
```
2 2
```
### 样例输出 #1
```
500000006
```
### 样例输入 #2
```
3 3
```
### 样例输出 #2
```
5
```
### 样例输入 #3
```
3 4
```
### 样例输出 #3
```
250000007
```
## 提示

### 样例解释

样例一：假设键盘上的字符分别为 `a` 和 `b`，那么可能打出来的文章一共有 `aa`、`ab`、`ba`、`bb` 四种，它们的复杂度分别为 2、3、3、2，因此答案为 $\frac{2+3+3+2}{4}=\frac{5}{2}$，对 $10^9+7$ 取模后得到 500000006。

### 数据范围

对于全部数据，有 $1\le n\le 20$，$1\le m\le 5\cdot 10^6$。

Subtask 1 (10 pts)：满足 $1\le n, m\le 7$。

Subtask 2 (20 pts)：满足 $1\le n\le 5$。

Subtask 3 (20 pts)：满足 $1\le n\le 10$。

Subtask 4 (50 pts)：无特殊限制。


---

---
title: "[GCJ 2015 Finals] Merlin QA"
layout: "post"
diff: 省选/NOI-
pid: P13237
tag: ['2015', '枚举', 'Google Code Jam']
---
# [GCJ 2015 Finals] Merlin QA
## 题目描述

Edythe is a young sorceress working in the quality assurance department of Merlin, Inc. -- a magic spell factory. Her job is to test the magic spells that Merlin himself invents. Each spell requires precise amounts of certain ingredients and transforms them into other amounts of other ingredients. Edythe's job is to cast each spell exactly once in order to verify that the spell works correctly.

She can cast a spell only if she has the required amount of each ingredient. If she has already created ingredients of the right type from previous spells, Edythe must use those first. However, if she still needs more ingredients, she is allowed to take them from Merlin's storehouse. She has no ingredients to start with, but at the end, she gets to keep all the extra ingredients that she created and didn't use.

Edythe wants to make as much profit as possible from her apprenticeship! She has to cast each of the $\mathrm{N}$ given spells exactly once, but she is free to do so in any order. Assuming that each spell works as expected, which ordering lets her earn the most money in the end?

For example, imagine that the test plan contains the following 3 spells:

1. Inputs: \$ $7$ worth of gold. Outputs: \$ $5$ worth of sulfur.
2. Inputs: nothing. Outputs: \$ $10$ worth of gold, \$ $10$ worth of sulfur.
3. Inputs: \$ $3$ worth of gold, \$ $20$ worth of sulfur. Outputs: \$ $2$ worth of toads.

Note that the first spell converts gold into sulfur, the second spell conjures up gold and sulfur from nothing, and the third spell converts gold and sulfur into toads.

If Edythe were to cast these spells in the order 1, 2, 3, then she would start by fetching \$ $7$ worth of gold from the storehouse for spell #1. That would let her cast spells #1 and #2, giving her \$ $10$ worth of gold and \$ $15$ worth of sulfur. For the final spell, she would need \$ $3$ worth of gold and \$ $20$ worth of sulfur. She would have to use all of the sulfur she created so far, \$ $3$ worth of gold, and \$ $5$ more worth of sulfur that she fetched from the storehouse. This would leave her with \$ $9$ worth of ingredients at the end (\$ $7$ worth of gold and \$ $2$ worth of toads).

But there is a better plan. If she cast the spells in the order 3, 1, 2, she would have \$ $27$ worth of ingredients at the end (\$ $10$ worth of gold, \$ $15$ worth of sulfur, and \$ $2$ worth of toads).

## 输入格式

The first line of the input gives the number of test cases, $\mathbf{T}$. $\mathbf{T}$ test cases follow. Each one starts with a line containing $\mathbf{N}$ and $\mathbf{M}$. $\mathbf{M}$ is the number of kinds of ingredients in the world. Each of the next $\mathbf{N}$ lines contains $\mathbf{M}$ integers describing a spell. Each integer is the value (or cost) of the corresponding ingredient. Negative integers are the dollar costs of the input ingredients; positive integers are the dollar values of the output ingredients; and zeros denote ingredients that are neither produced nor consumed by the spell. This also implies that no spell can simultaneously consume and produce the same ingredient.

## 输出格式

For each test case, output one line containing "Case #x: y", where $\mathrm{x}$ is the test case number (starting from 1) and $\mathrm{y}$ is the largest value of ingredients Edythe can have at the end.

## 样例

### 样例输入 #1
```
2
3 1
1
0
-1
3 3
-7 5 0
10 10 0
3 -20 2
```
### 样例输出 #1
```
Case #1: 1
Case #2: 27
```
## 提示

**Limits**

- $1 \leq \mathbf{T} \leq 100$.
- $1 \leq \mathbf{N} \leq 100$.
- $-100 \leq$ Each integer in each spell $\leq 100$.

**Small dataset(8 Pts)**

- Time limit: ~~240~~ 5 seconds.
- $1 \leq \mathbf{M} \leq 2$.

**Large dataset**

- Time limit: ~~480~~ 10 seconds.
- $1 \leq \mathbf{M} \leq 8$.


---

---
title: "[NOI2013] 书法家"
layout: "post"
diff: 省选/NOI-
pid: P1398
tag: ['动态规划 DP', '2013', 'NOI', '枚举']
---
# [NOI2013] 书法家
## 题目描述

小 E 同学非常喜欢书法，他听说 NOI2013 已经开始了，想题一幅 “NOI” 的字送给大家。

小 E 有一张非常神奇的纸，纸可以用一个 $n$ 行 $m$ 列的二维方格矩阵来表示，为了描述方便，我们定义矩阵左下角方格坐标为 $(1,1)$，右上角方格坐标为 $(m, n)$。

矩阵的每个方格有一个整数的幸运值。在格子上面写字可以增加大家的幸运度，幸运度的大小恰好是所有被笔写到的方格的幸运值之和。现在你要在上面写
上 `N`，`O`，`I` 三个字母。

下面给出 $3$ 个书法字的定义:
- `N` 由若干（$\ge 3$）个边平行于坐标轴的矩形组成，设由 $K$ 个矩形组成（标号 $1 \ldots K$），第 $i$ 个矩形的左下角方格坐标设为 $(L_i, B_i)$，右上角坐标设为 $(R_i, T_i )$，要求满足：
  1. $L_i \le R_i, B_i \le T_i$；
  2. 对任意 $1 < i \le K$，有 $L_i = R_{i-1} + 1$；
  3. 对任意 $3 \le i < K$，有 $B_{i−1} − 1 \le T_i \le T_{i-1}$，$B_i \le B_{i-1}$；
  4. $B_2 > B_1$，$T_2 = T_1$，$B_{K-1} = B_K$，$T_{K-1} < T_K$；
- `O` 由一个大矩形 $A$，挖去一个小矩形 $B$ 得到，这两个矩形的边都平行于坐标轴。设大矩形 $A$ 左下角的方格坐标为 $(u, v)$，长为 $W$，宽为 $H$，则小矩形 $B$ 满足左下角方格坐标为 $(u + 1, v + 1)$，长 $W - 2$，宽 $H - 2$。要求满足：
  1. $W \ge 3$，$H \ge 3$；
  2. $u > R_K + 1$；
- `I` 为 $3$ 个边平行于坐标轴的从下到上的实心矩形组成，从下到上依次标号为 $1,2,3$，第 $i$ 个矩形的左下角格子坐标设为 $(P_i , Q_i )$，右上角格子坐标设为 $(G_i , H_i )$，要求满足：
  1. $P_i \le G_i , Q_i \le H_i$；
  2. $P_1 = P_3 > u + W$，$G_1 = G_3$；
  3. $Q_1 = H_1 = Q_2 - 1, H_2 + 1 = Q_3 = H_3$；
  4. $P_1 < P_2 \le G_2 < G_1$。

下图是一个 `N`,`O`,`I` 的例子：

![](https://cdn.luogu.com.cn/upload/image_hosting/g7t4tquv.png)

另外，所有画的图形均不允许超过纸张的边界。现在小 E 想要知道,他能画出的最大幸运度是多少。
## 输入格式

第一行包含两个正整数 $n$ 和 $m$ ,分别表示矩阵的行数和列数。

接下来 $n$ 行，每行有 $m$ 个整数，第 $i + 1$ 行的第 $j$ 个数表示格子 $(j, n - i + 1)$ 的幸运值。
## 输出格式

输出一个整数 $T$，表示小 E 能够获得的最大幸运度。
## 样例

### 样例输入 #1
```
3 13 
1 1 -1 -1 1 -1 1 1 1 -1 1 1 1 
1 -1 1 -1 1 -1 1 -1 1 -1 -1 1 -1 
1 -1 -1 1 1 -1 1 1 1 -1 1 1 1 

```
### 样例输出 #1
```
24
```
### 样例输入 #2
```
3 13
-1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
-1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
-1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1


```
### 样例输出 #2
```
-20
```
## 提示

### 样例解释 1

![](https://cdn.luogu.com.cn/upload/image_hosting/vq7asar5.png)

### 样例解释 2

![](https://cdn.luogu.com.cn/upload/image_hosting/1ojygumc.png)

### 数据范围

| 测试点编号 |   $n$   |   $m$    | 幸运值范围 |
| :--------: | :------: | :------: | :--------: |
|     1      |   $=3$   |  $=12$   | $[-50,50]$ |
|     2      |   $=3$   |  $=12$   | $[-50,50]$ |
|     3      |   $=3$   |  $=12$   | $[-50,50]$ |
|     4      |   $=3$   |  $=12$   | $[-50,50]$ |
|     5      | $\le10$  | $\le20$  | $[-50,50]$ |
|     6      | $\le10$  | $\le20$  | $[-50,50]$ |
|     7      | $\le10$  | $\le20$  | $[-50,50]$ |
|     8      | $\le10$  | $\le20$  | $[-50,50]$ |
|     9      | $\le150$ | $\le500$ |    $=1$    |
|     10     | $\le150$ | $\le500$ |    $=1$    |
|     11     | $\le80$  | $\le80$  |    $[-200,200]$    |
|     12     | $\le80$  | $\le80$  |    $[-200,200]$    |
|     13     | $\le80$  | $\le80$  |    $[-200,200]$    |
|     14     | $\le80$  | $\le80$  |    $[-200,200]$    |
|     15     | $\le150$  | $\le500$  |    $[-200,200]$    |
|     16     | $\le150$  | $\le500$  |    $[-200,200]$    |
|     17     | $\le150$  | $\le500$  |    $[-200,200]$    |
|     18     | $\le150$  | $\le500$  |    $[-200,200]$    |
|     19     | $\le150$  | $\le500$  |    $[-200,200]$    |
|     20     | $\le150$  | $\le500$  |    $[-200,200]$    |

对于所有的测试数据，保证 $n \ge 3,m \ge 12$。


---

---
title: "【模板】旋转卡壳 | [USACO03FALL] Beauty Contest G"
layout: "post"
diff: 省选/NOI-
pid: P1452
tag: ['计算几何', '2003', 'USACO', '枚举', '凸包', '旋转卡壳']
---
# 【模板】旋转卡壳 | [USACO03FALL] Beauty Contest G
## 题目描述

给定平面上 $n$ 个点，求凸包直径。

## 输入格式

第一行一个正整数 $n$。   
接下来 $n$ 行，每行两个整数 $x,y$，表示一个点的坐标。保证所有点的坐标两两不同。
## 输出格式

输出一行一个整数，表示答案的平方。
## 样例

### 样例输入 #1
```
4
0 0
0 1
1 1
1 0

```
### 样例输出 #1
```
2
```
## 提示

【数据范围】  
对于 $100\%$ 的数据，$2\le n \le 50000$，$|x|,|y| \le 10^4$。

---

$\text{upd 2022.7.22}$：新增加四组 Hack 数据。


---

---
title: "杠杆数"
layout: "post"
diff: 省选/NOI-
pid: P1831
tag: ['动态规划 DP', '枚举', '数位 DP']
---
# 杠杆数
## 题目描述

如果把一个数的某一位当成支点，且左边的数字到这个点的力矩和等于右边的数字到这个点的力矩和，那么这个数就可以被叫成杠杆数。

比如 $4139$ 就是杠杆数，把 $3$ 当成支点，我们有这样的等式：$4\times 2+1\times 1=9\times 1$。

给定区间 $[x,y]$，求出在 $[x,y]$ 中有几个杠杆数。
## 输入格式

两个数，表示 $x,y$。
## 输出格式

一个输出，表示区间 $[x,y]$ 中杠杆数的个数。

## 样例

### 样例输入 #1
```
7604 24324
```
### 样例输出 #1
```
897
```
## 提示

### 数据范围及约定

- 对于 $40\%$ 的数据，$x \le y \le x+10^5$；
- 对于 $100\%$ 的数据，$1 \le x \le y \le 10^{18}$。


---

---
title: "[SDOI2009] 学校食堂"
layout: "post"
diff: 省选/NOI-
pid: P2157
tag: ['动态规划 DP', '2009', '各省省选', '山东', '枚举', '状压 DP']
---
# [SDOI2009] 学校食堂
## 题目描述

小 F 的学校在城市的一个偏僻角落，所有学生都只好在学校吃饭。学校有一个食堂，虽然简陋，但食堂大厨总能做出让同学们满意的菜肴。当然，不同的人口味也不一定相同，但每个人的口味都可以用一个非负整数表示。 由于人手不够，食堂每次只能为一个人做菜。做每道菜所需的时间是和前一道菜有关的，若前一道菜的对应的口味是 $a$，这一道为 $b$，则做这道菜所需的时间为 $(a\operatorname{or}b)-(a\operatorname{and}b)$，而做第一道菜是不需要计算时间的。其中，$\operatorname{or}$ 和 $\operatorname{and}$ 表示整数逐位或运算及逐位与运算，C 语言中对应的运算符为 `|` 和 `&`。


学生数目相对于这个学校还是比较多的，吃饭做菜往往就会花去不少时间。因此，学校食堂偶尔会不按照大家的排队顺序做菜，以缩短总的进餐时间。

虽然同学们能够理解学校食堂的这种做法，不过每个同学还是有一定容忍度的。也就是说，队伍中的第 $i$ 个同学，最多允许紧跟他身后的 $B_i$ 个人先拿到饭菜。一旦在此之后的任意同学比当前同学先拿到饭，当前同学将会十分愤怒。因此，食堂做菜还得照顾到同学们的情绪。 现在，小 F 想知道在满足所有人的容忍度这一前提下，自己的学校食堂做完这些菜最少需要多少时间。

## 输入格式

第一行包含一个正整数 $C$，表示测试点的数据组数。 每组数据的第一行包含一个正整数 $N$，表示同学数。 每组数据的第二行起共 $N$ 行，每行包含两个用空格分隔的非负整数 $T_i$ 和 $B_i$，表示按队伍顺序从前往后的每个同学所需的菜的口味和这个同学的忍受度。 每组数据之间没有多余空行。

## 输出格式

包含 $C$ 行，每行一个整数，表示对应数据中食堂完成所有菜所需的最少时间。

## 样例

### 样例输入 #1
```
2
5
5 2
4 1
12 0
3 3
2 2
2
5 0
4 0
```
### 样例输出 #1
```
16
1

```
## 提示

对于第一组数据：

同学 1 允许同学 2 或同学 3 在他之前拿到菜；同学 2 允许同学 3 在他之前拿到菜；同学 3 比较小气，他必须比他后面的同学先拿菜。

一种最优的方案是按同学 3、同学 2、同学 1、同学 4、同学 5 做菜，每道菜所需的时间分别是 0、8、1、6 及 1。


**数据规模和约定**

- 对于 $30\%$ 的数据，满足 $1 \le N \le 20$。

- 对于 $ 100\% $ 的数据，满足 $1 \le N \le 1000,0 \le T_i \le 1000,0 \le B_i \le 7，1 \le C \le 5$。

- 存在 $30\%$ 的数据，满足 $0 \le B_i \le 1$。

- 存在 $65\%$ 的数据，满足 $0 \le B_i \le 5$。

- 存在 $45\%$ 的数据，满足 $0 \le T_i \le 130$。



---

---
title: "[HNOI2005] 数三角形"
layout: "post"
diff: 省选/NOI-
pid: P2315
tag: ['2005', '各省省选', '树状数组', '湖南', '枚举']
---
# [HNOI2005] 数三角形
## 题目描述

![](https://cdn.luogu.com.cn/upload/pic/1355.png)

## 输入格式

![](https://cdn.luogu.com.cn/upload/pic/1356.png)

## 输出格式

输出文件output.txt中仅包含一个整数T，表示有多少个三角形的边界都没有被删除。

## 样例

### 样例输入 #1
```
5

1 1 1

1 1 0 1 1 0

1 1 1 1 1 1 1 0 1

1 0 1 1 1 1 0 1 1 1 1 1

0 1 1 1 1 1 0 1 1 1 1 1 0 1 1


```
### 样例输出 #1
```
19
```


---

---
title: "[SDOI2008] 山贼集团"
layout: "post"
diff: 省选/NOI-
pid: P2465
tag: ['2008', '各省省选', '山东', 'O2优化', '枚举', '状压 DP']
---
# [SDOI2008] 山贼集团
## 题目描述

某山贼集团在绿荫村拥有强大的势力。整个绿荫村由 $n$ 个连通的小村落组成，并且保证对于每两个小村落有且仅有一条简单路径相连。将小村落从 $1$ 至 $n$ 编号，山贼集团的总部设在编号为 $1$ 的小村落中。

山贼集团除了老大坐镇总部以外，其他的 $p$ 个部门希望在村落的其他地方（洛谷注：其实也包括总部）建立分部。$p$ 个分部可以在同一个小村落中建设，也可以分别建设在不同的小村落中，在不同的村落建设不同的分部需要花费不同的费用。

每个分部到总部的路径称为这个部门的管辖范围，于是这 $p$ 个分部的管辖范围可能重叠，或者完全相同。当多个分部管辖同一个村落时，他们之间可能发生矛盾，从而损失一部分利益，也可能相互合作，从而获取一部分利益。

请注意，如果相同的分部同时管辖多个村落，那么对于每个村落，都会计算一次收益损失/获取。

现在请你编写一个程序，确定 $p$ 个分部的位置，使得山贼集团能够获得最大的收益。
## 输入格式

输入的第一行有两个整数，分别代表村落数 $n$ 和山贼集团部门数量 $p$。

第 $2$ 到第 $n$ 行，每行有两个整数 $x, y$，代表存在一条连接村落 $x$ 和村落 $y$ 的道路。

第 $(n + 1)$ 到第 $2n$ 行，每行 $p$ 个整数，第 $(i + n)$ 行的第 $j$ 个整数代表在第 $i$ 个村落建设第 $j$ 个部门的花费 $a_{i, j}$。

第 $(2n + 1)$ 行有一个整数，代表集团间相互影响利益的信息条数 $t$。

第 $(2n + 2)$ 行到第 $(2n + t + 1)$ 行，每行首先有一个整数 $v$，若 $v$ 为正，则表示会获得额外的收益，$v$ 为负则表示会有损失。然后有一个整数 $c$，代表涉及分部的数量。接下来有 $c$ 个整数，分别代表涉及的分部 $x_i$。本条信息的含义为若这 $c$ 个分部同时管辖某个小村落（可能同时存在其他分部管辖该村落），则会产生额外收益或损失，其数值大小为 $|v|$。
## 输出格式

输出一行一个整数代表最大的收益。
## 样例

### 样例输入 #1
```
2 1
1 2
2 
1
1
3 1 1
```
### 样例输出 #1
```
5
```
## 提示

#### 样例输入输出 1 解释

在 $2$ 号节点建立 $1$ 号分部，花费为 $1$，则分部集合 $\{1\}$ 可以管辖 $1, 2$ 两个节点，根据第一条信息，该集合每管辖一个节点会产生 $3$ 的收益，因此总共产生了 $2 \times 3 = 6$ 的收益，减去建立分部的花费，最大的收益为 $6 - 1 = 5$。可以证明不存在更优的方案。

#### 数据规模与约定

对于 $40\%$ 的数据，保证 $1 \leq p \leq 6$。

对于 $100\%$ 的数据，保证：

- $1 \leq p \leq 12$，$1 \leq n \leq 100$。
- $1 \leq s,t \leq n$，$1 \leq a_{i, j} \leq 10^8$。
- $1 \leq t \leq 2^p$，$1 \leq |v| \leq 10^8$，$1 \leq c \leq p$，$1 \leq x_i \leq p$ 且 $x_i$ 互不相同。
- 答案的绝对值不超过 $10^8$。


---

---
title: "[SDOI2010] 粟粟的书架"
layout: "post"
diff: 省选/NOI-
pid: P2468
tag: ['2010', '二分', '各省省选', '山东', '枚举', '可持久化线段树']
---
# [SDOI2010] 粟粟的书架
## 题目描述

幸福幼儿园 B29 班的粟粟是一个聪明机灵、乖巧可爱的小朋友，她的爱好是画画和读书，尤其喜欢 Thomas H. Cormen 的文章。粟粟家中有一个 $R$ 行 $C$ 列的巨型书架，书架的每一个位置都摆有一本书，上数第 $i$ 行、左数第 $j$ 列摆放的书有 $P_{i,j}$ 页厚。

粟粟每天除了读书之外，还有一件必不可少的工作就是摘苹果，她每天必须摘取一个指定的苹果。粟粟家果树上的苹果有的高、有的低，但无论如何凭粟粟自己的个头都难以摘到。不过她发现，如果在脚下放上几本书，就可以够着苹果；她同时注意到，对于第 $i$ 天指定的那个苹果，只要她脚下放置书的总页数之和不低于 $H_i$，就一定能够摘到。

由于书架内的书过多，父母担心粟粟一天内就把所有书看完而耽误了上幼儿园，于是每天只允许粟粟在一个特定区域内拿书。这个区域是一个矩形，第 $i$ 天给定区域的左上角是上数第$x1_i$ 行的左数第 $y1_i$ 本书，右下角是上数第 $x2_i$ 行的左数第 $y2_i$ 本书。换句话说，粟粟在这一天，只能在这 $(x2_i－x1_i＋1)\times(y2_i－y1_i＋1)$ 本书中挑选若干本垫在脚下，摘取苹果。

粟粟每次取书时都能及时放回原位，并且她的书架不会再撤下书目或换上新书，摘苹果的任务会一直持续 $M$ 天。给出每本书籍的页数和每天的区域限制及采摘要求，请你告诉粟粟，她每天至少拿取多少本书，就可以摘到当天指定的苹果。

## 输入格式

第一行是三个正整数 $R, C, M$。

接下来是一个 $R$ 行 $C$ 列的矩阵，从上到下、从左向右依次给出了每本书的页数 $P_{i,j}$。

接下来 $M$ 行，第 $i$ 行给出正整数 $x1_i, y1_i, x2_i, y2_i, H_i$，表示第 $i$ 天的指定区域是 $(x1_i, y1_i)$ 与 $(x2_i, y2_i)$ 间的矩形，总页数之和要求不低于Hi。

保证 $1\le x1_i\le x2_i\le R$，$1\le y1_i\le y2_i\le C$。

## 输出格式

输出共 $M$ 行，第 $i$ 行回答粟粟在第 $i$ 天时为摘到苹果至少需要拿取多少本书。如果即使取走所有书都无法摘到苹果，则在该行输出 `Poor QLW`。

## 样例

### 样例输入 #1
```
5 5 7
14 15 9 26 53
58 9 7 9 32
38 46 26 43 38
32 7 9 50 28
8 41 9 7 17
1 2 5 3 139
3 1 5 5 399
3 3 4 5 91
4 1 4 1 33
1 3 5 4 185
3 3 4 3 23
3 1 3 3 108
```
### 样例输出 #1
```
6
15
2
Poor QLW
9
1
3
```
### 样例输入 #2
```
1 10 7
14 15 9 26 53 58 9 7 9 32
1 2 1 9 170
1 2 1 9 171
1 5 1 7 115
1 1 1 10 228
1 4 1 4 45704571
1 1 1 1 1
1 7 1 8 16
```
### 样例输出 #2
```
6
7
3
10
Poor QLW
1
2
```
## 提示

对于 $10\%$ 的数据，满足 $R, C\le10$。

对于 $20\%$ 的数据，满足 $R, C\le 40$。

对于 $50\%$ 的数据，满足 $R, C\le 200$，$M\le 2\times 10^5$。

另有 $50\%$ 的数据，满足 $R＝1$，$C\le 5\times 10^5$，$M\le 2\times 10^4$。

对于 $100\%$ 的数据，满足 $1\le P_{i,j}\le 1000$，$1\le H_i\le 2\times 10^9$。



---

---
title: "[SDOI2010] 捉迷藏"
layout: "post"
diff: 省选/NOI-
pid: P2479
tag: ['搜索', '2010', '各省省选', '递归', '山东', '枚举']
---
# [SDOI2010] 捉迷藏
## 题目背景

iPig 在大肥猪学校刚上完了无聊的猪文课，天资聪慧的 iPig 被这门对他来说无比简单的课弄得非常寂寞，为了消除寂寞感，他决定和他的好朋友 giPi（鸡皮）玩一个更加寂寞的游戏——捉迷藏。但是，他们觉得，玩普通的捉迷藏没什么意思，还是不够寂寞，于是，他们决定玩寂寞无比的螃蟹版捉迷藏。

## 题目描述

螃蟹版捉迷藏，顾名思义，就是说他们在玩游戏的时候只能沿水平或垂直方向走。

一番寂寞的剪刀石头布后，他们决定 iPig 去捉 giPi。由于他们都很熟悉大肥猪学校的地形了，所以 giPi 只会躲在大肥猪学校内 $N$ 个隐秘地点之一，显然 iPig 也只会在那 $N$ 个地点内找 giPi。

游戏一开始，他们从这 $N$ 个隐秘地点之中选定一个地点，iPig 保持不动，然后 giPi 用 $30$ 秒的时间逃离现场（显然，giPi 不会呆在原地）。然后 iPig 会随机地去找 giPi，直到找到为止。

由于 iPig 很懒，所以他总是走最短的路径，而且，他选择起始点不是随便选的，他想找一个地点，使得该地点到（除了这个地点以外的）最远的地点和最近的地点的距离差最小。iPig现在想知道这个距离差最小是多少。

由于 iPig 现在手上没有电脑，所以不能编程解决这个如此简单的问题，所以他马上打了个电话，要求你帮他解决这个问题。iPig 告诉了你大肥猪学校的 $N$ 个隐秘地点的坐标，请你编程求出 iPig 的问题。
## 输入格式


第 $1$ 行：一个整数 $N$；

接下来 $N$ 行：每行两个整数 $X_i,Y_i$，表示第 $i$ 个地点的坐标。
## 输出格式

一个整数，为距离差的最小值。

## 样例

### 样例输入 #1
```
4
0 0
1 0
0 1
1 1

```
### 样例输出 #1
```
1
```
## 提示

$30\%$ 的数据中，$2\le N\le 10^3$；

$100\%$ 的数据中，$2\le N\le 10^5$，$0\le X_i,Y_i\le 10^9$。

数据保证点不重合。


---

---
title: "[HAOI2006] 数字序列"
layout: "post"
diff: 省选/NOI-
pid: P2501
tag: ['动态规划 DP', '递推', '2006', '河南', '各省省选', '枚举']
---
# [HAOI2006] 数字序列
## 题目描述

现在我们有一个长度为 $n$ 的整数序列 $a$。但是它太不好看了，于是我们希望把它变成一个单调严格上升的序列。但是不希望改变过多的数，也不希望改变的幅度太大。

## 输入格式

第一行是一个整数，表示序列长度 $n$。  
第二行有 $n$ 个整数，第 $i$ 个整数表示序列的第 $i$ 项 $a_i$。
## 输出格式

第一行输出一个整数，表示最少需要改变多少个数。

第二行输出一个整数，表示在改变的数最少的情况下，每个数改变的绝对值之和的最小值。
## 样例

### 样例输入 #1
```
4

5 2 3 5
```
### 样例输出 #1
```
1

4
```
## 提示

#### 数据规模与约定

- 对于 $90\%$ 的数据，保证 $n \leq 6 \times 10^3$。
- 对于 $100\%$ 的数据，保证 $1 \leq n \leq 3.5 \times 10^4$，$1 \leq a_i \leq 10^5$。数据保证 $a_i$ 随机生成。



---

---
title: "[HAOI2008] 圆上的整点"
layout: "post"
diff: 省选/NOI-
pid: P2508
tag: ['数学', '2008', '河南', '各省省选', '枚举', '最大公约数 gcd']
---
# [HAOI2008] 圆上的整点
## 题目描述

求一个给定的圆$(x^2+y^2=r^2)$，在圆周上有多少个点的坐标是整数。

## 输入格式

r
## 输出格式

整点个数

## 样例

### 样例输入 #1
```
4
```
### 样例输出 #1
```
4
```
## 提示

$r\leq 2000 000 000$



---

---
title: "[USACO06FEB] Steady Cow Assignment G"
layout: "post"
diff: 省选/NOI-
pid: P2857
tag: ['贪心', '2006', '二分', 'USACO', '网络流', '枚举', '双指针 two-pointer']
---
# [USACO06FEB] Steady Cow Assignment G
## 题目描述

Farmer John's N (1 <= N <= 1000) cows each reside in one of B (1 <= B <= 20) barns which, of course, have limited capacity. Some cows really like their current barn, and some are not so happy.

FJ would like to rearrange the cows such that the cows are as equally happy as possible, even if that means all the cows hate their assigned barn.


Each cow gives FJ the order in which she prefers the barns.  A cow's happiness with a particular assignment is her ranking of her barn. Your job is to find an assignment of cows to barns such that no barn's capacity is exceeded and the size of the range (i.e., one more than the positive difference between the the highest-ranked barn chosen and that lowest-ranked barn chosen) of barn rankings the cows give their assigned barns is as small as possible.

## 输入格式

Line 1: Two space-separated integers, N and B


Lines 2..N+1: Each line contains B space-separated integers which are exactly 1..B sorted into some order. The first integer on line i+1 is the number of the cow i's top-choice barn, the second integer on that line is the number of the i'th cow's second-choice barn, and so on.


Line N+2: B space-separated integers, respectively the capacity of the first barn, then the capacity of the second, and so on. The sum of these numbers is guaranteed to be at least N.

## 输出格式

Line 1: One integer, the size of the minumum range of barn rankings the cows give their assigned barns, including the endpoints.

## 样例

### 样例输入 #1
```
6 4
1 2 3 4
2 3 1 4
4 2 3 1
3 1 2 4
1 3 4 2
1 4 2 3
2 1 3 2
```
### 样例输出 #1
```
2
```
## 提示

Explanation of the sample:




Each cow can be assigned to her first or second choice: barn 1 gets cows 1 and 5, barn 2 gets cow 2, barn 3 gets cow 4, and barn 4 gets cows 3 and 6.

## 题目翻译

有 $N$ 头牛，$B$ 个牛棚。告诉你每头牛心里牛棚的座次，即哪个牛棚他最喜欢，哪个第 $2$ 喜欢，哪个第 $3$ 喜欢，等等。但牛棚容量一定，所以每头牛分配到的牛棚在该牛心中的座次有高有低。现在求一种最公平的方法分配牛到牛棚，使所有牛中，所居牛棚的座次最高与最低的跨度最小。


---

---
title: "[USACO13OPEN] Figure Eight G"
layout: "post"
diff: 省选/NOI-
pid: P3086
tag: ['2013', 'USACO', '枚举']
---
# [USACO13OPEN] Figure Eight G
## 题目描述

Farmer John's cows recently received a large piece of marble, which, unfortunately, has a number of imperfections.  To describe these, we can represent the piece of marble by an N by N square grid (5 <= N <= 300), where the character '\*' represents an imperfection and '.' represents a flawless section of the marble.

The cows want to carve a number "8" in this piece of marble (cows are quite fond of the number "8" since they have cloven hooves on each of their four feet, so they can effectively count up to 8 using their "toes"). However, the cows need your help to determine the optimally placed figure eight in the piece of marble.  Here are a few properties that define a valid figure eight:

\* A figure eight consists of two rectangles, a top and a bottom. \* Both the top and bottom have at least one cell in their interior. \* The bottom edge of the top rectangle is a (not necessarily proper) subset of the top edge of the bottom rectangle.

\* The figure eight can only be carved from flawless regions of the piece of marble.

The aesthetic score of a figure eight is equal to the product of the areas enclosed by its two rectangles.  The cows wish to maximize this score.

```cpp
............... 
............... 
...*******..... 
.*....*.......* 
.*......*....*. 
....*.......... 
...*...****.... 
............... 
..**.*..*..*... 
...*...**.*.... 
*..*...*....... 
............... 
.....*..*...... 
.........*..... 
............... 
```
For example, given this piece of marble 

the optimally placed eight is:

```cpp
..88888888888.. 
..8.........8.. 
..8*******..8.. 
.*8...*.....8.* 
.*8.....*...8*. 
..8.*.......8.. 
..8*...****.8.. 
.88888888888888 
.8**.*..*..*..8 
.8.*...**.*...8 
*8.*...*......8 
.8............8 
.8...*..*.....8 
.8.......*....8 
.88888888888888 
```
The top rectangle has area 6x9=54, and the bottom rectangle has area 12x6=72.  Thus, its aesthetic score is 54x72=3888.

农民约翰的奶牛最近收到了一大块大理石，不幸的是，它有许多缺陷.。为了描述这些，我们可以用n个正方形网格来表示一块大理石（5 < n = n = 300），其中字符“\*”表示一个不完美和“。


母牛想雕刻一个号码“8”在这一块大理石（牛很喜欢数字“8”，因为他们对他们的每一个四英尺，有偶蹄有效地数到8，用“脚”）。然而，奶牛需要你的帮助，以确定最佳放置在图八块大理石。这里有一些属性定义一个有效的数字八：


图八包括两个矩形，一个顶部和一个底部。顶部和底部至少有一个单元在其内部。顶部矩形的底部边缘是底部矩形顶部边缘的一个（不一定是适当的）子集.。


图八只能刻在大理石的无瑕疵区域。


图八的美学得分等于其两个矩形所包围的区域的乘积.。奶牛希望最大限度地提高这一成绩。

## 输入格式

\* Line 1: A single integer N, indicating the side length of the marble.

\* Lines 2..N+1: Each line describes a row of the marble, and contains N characters which are each either '\*' (an imperfection) or '.' (a flawless section).

第1行：一个整数n，表示大理石的边长。


行2 N + 1：每行描述了一排大理石，并包含n个字符，每个都是“\*”（缺陷）或'.' (完整)。

## 输出格式

\* Line 1: The highest aesthetic score of any figure eight which doesn't use any imperfect squares of the marble.  If no figure eight is attainable, then output -1.

## 样例

### 样例输入 #1
```
15 
............... 
............... 
...*******..... 
.*....*.......* 
.*......*....*. 
....*.......... 
...*...****.... 
............... 
..**.*..*..*... 
...*...**.*.... 
*..*...*....... 
............... 
.....*..*...... 
.........*..... 
............... 

```
### 样例输出 #1
```
3888 

```
## 提示

顶部的矩形面积6X9 = 54，和底部矩形面积12x6 = 72。因此，它的审美评分54x72 = 3888。


给出一个n×n的区域，其中有一些位置有瑕疵。现在要在没有瑕疵的位置中雕一个8”出来。


“8”字的定义为两个矩形框，框内面积均大于0，且一个矩形框的底边是是另一个矩形框的顶边的子集。


最大化两矩形框内面积的积。


感谢 @3505515693qq 提供翻译



---

---
title: "[HNOI2007] 分裂游戏"
layout: "post"
diff: 省选/NOI-
pid: P3185
tag: ['博弈论', '2007', '湖南', '枚举']
---
# [HNOI2007] 分裂游戏
## 题目描述

聪聪和睿睿最近迷上了一款叫做分裂的游戏。

该游戏的规则是： 共有 $n$ 个瓶子， 标号为 $0, 1, \ldots, n-1$，第 $i$ 个瓶子中装有 $p_i$ 颗巧克力豆，两个人轮流取豆子，每一轮每人选择 $3$ 个瓶子，标号为 $i,j,k$, 并要保证 $i \lt j, j \leq k$，且第 $i$ 个瓶子中至少要有 $1$ 颗巧克力豆，随后这个人从第 $i$ 个瓶子中拿走一颗豆子并在 $j,k$ 中各放入一粒豆子（$j$ 可能等于 $k$） 。如果轮到某人而他无法按规则取豆子，那么他将输掉比赛。胜利者可以拿走所有的巧克力豆！

两人最后决定由聪聪先取豆子，为了能够得到最终的巧克力豆，聪聪自然希望赢得比赛。他思考了一下，发现在有的情况下，先拿的人一定有办法取胜，但是他不知道对于其他情况是否有必胜策略，更不知道第一步该如何取。他决定偷偷请教聪明的你，希望你能告诉他，在给定每个瓶子中的最初豆子数后是否能让自己得到所有巧克力豆，他还希望你告诉他第一步该如何取，并且为了必胜，第一步有多少种取法？ 

## 输入格式

输入文件第一行是一个整数 $t$，表示测试数据的组数。

每组测试数据的第一行是瓶子的个数 $n$，接下来的一行有 $n$ 个由空格隔开的非负整数，表示每个瓶子中的豆子数。
## 输出格式

对于每组测试数据，输出包括两行，第一行为用一个空格两两隔开的三个整数，表示要想赢得游戏，第一步应该选取的 $3$ 个瓶子的编号 $i,j,k$，如果有多组符合要求的解，那么输出字典序最小的一组。如果无论如何都无法赢得游戏，那么输出用一个空格两两隔开的三个 $-1$。

第二行表示要想确保赢得比赛，第一步有多少种不同的取法。
## 样例

### 样例输入 #1
```
2
4
1 0 1 5000
3
0 0 1
```
### 样例输出 #1
```
0 2 3
1
-1 -1 -1
0
```
## 提示

$1 \leq t \leq 10$，$2 \leq n \leq 21$，$0 \leq p_i \leq 10^4$，


---

---
title: "[HNOI2007] 最小矩形覆盖"
layout: "post"
diff: 省选/NOI-
pid: P3187
tag: ['2007', '湖南', 'Special Judge', '枚举', '凸包', '旋转卡壳']
---
# [HNOI2007] 最小矩形覆盖
## 题目描述

给定一些点的坐标，求能够覆盖所有点的最小面积的矩形，输出所求矩形的面积和四个顶点坐标。
## 输入格式

第一行为一个整数 $n$，从第 $2$ 至第 $n+1$ 行每行有两个浮点数（精确到至多五位小数，不使用科学计数法），表示一个顶点的 $x$ 和 $y$ 坐标。
## 输出格式

第一行为一个浮点数，表示所求矩形的面积，接下来 $4$ 行每行表示一个顶点坐标，**按逆时针**输出顶点坐标。
## 样例

### 样例输入 #1
```
6
1.0 3.00000
1 4.00000
2.0000 1
3 0.0000
3.00000 6
6.0 3.0
```
### 样例输出 #1
```
18.00000
3.00000 0.00000
6.00000 3.00000
3.00000 6.00000
0.00000 3.00000
```
## 提示

$3 \le n \le 50000$，坐标范围 $\in [0,10]$。保证覆盖所有点所需要的最小矩形面积至少是 $0.1$。

如果你的矩形面积为 $S'$，正确答案为 $S$，那么当 $\frac{|S'-S|}{\max\{1,S\}}<10^{-4}$，且所有点满足在矩形内或者到矩形的距离 $<10^{-4}$ 时，你的答案会被判定为正确（你可以忽略这段话，简而言之你的答案只要不是有特别大的精度误差就可以通过）。

感谢 @intruder 提供题目简述



---

---
title: "[HNOI2009] 梦幻布丁"
layout: "post"
diff: 省选/NOI-
pid: P3201
tag: ['2009', '线段树', '各省省选', '平衡树', '湖南', '枚举']
---
# [HNOI2009] 梦幻布丁
## 题目描述

$n$ 个布丁摆成一行，进行 $m$ 次操作。每次将某个颜色的布丁全部变成另一种颜色的，然后再询问当前一共有多少段颜色。

例如，颜色分别为 $1,2,2,1$ 的四个布丁一共有 $3$ 段颜色.
## 输入格式

第一行是两个整数，分别表示布丁个数 $n$ 和操作次数 $m$。  
第二行有 $n$ 个整数，第 $i$ 个整数表示第 $i$ 个布丁的颜色 $a_i$。  
接下来 $m$ 行，每行描述一次操作。每行首先有一个整数 $op$ 表示操作类型：
- 若 $op = 1$，则后有两个整数 $x, y$，表示将颜色 $x$ 的布丁全部变成颜色 $y$。
- 若 $op = 2$，则表示一次询问。
## 输出格式

对于每次询问，输出一行一个整数表示答案。
## 样例

### 样例输入 #1
```
4 3
1 2 2 1
2
1 2 1
2

```
### 样例输出 #1
```
3
1
```
## 提示

### 样例 1 解释
初始时布丁颜色依次为 $1, 2, 2, 1$，三段颜色分别为 $[1, 1], [2, 3], [4, 4]$。  
一次操作后，布丁的颜色变为 $1, 1, 1, 1$，只有 $[1, 4]$ 一段颜色。

### 数据规模与约定

对于全部的测试点，保证 $1 \leq n, m \leq 10^5$，$1 \leq a_i ,x, y \leq 10^6$。

### 提示

请注意，**不保证**颜色的编号不大于 $n$，也**不保证** $x \neq y$，$m$ **不是**颜色的编号上限。


---

---
title: "[HNOI2011] 勾股定理"
layout: "post"
diff: 省选/NOI-
pid: P3213
tag: ['2011', '湖南', '枚举', '连通块', '最大公约数 gcd']
---
# [HNOI2011] 勾股定理
## 题目描述

沫沫最近在研究勾股定理。对于两个正整数 A 与 B，若存在正整数 C 使得 A2+B2=C2，且 A 与 B 互质，则称(A,B)为一个互质勾股数对。


有一天，沫沫得到了 N 根木棍，其长度都是正整数，她准备从中挑选出若干根木棍来玩拼图游戏，为了使拼出的图案有凌乱美，她希望挑选出的木棍中任意两根的长度均不是互质勾股数对。现在，沫沫想知道有多少种满足要求的挑选木棍的方案。由于答案可能很大，你只要输出答案对 $10^9+7$ 取模的结果。

## 输入格式

从文件input.txt中读入数据，输入文件第一行是一个正整数N，表示共有多少根木棍。

输入文件第二行是用空格隔开的N个正整数h1, h2, …, hN，其中对1≤i≤N，hi表示第i根木棍的长度。

输入的数据保证30%的数据满足对$1≤i≤N$有$1≤h_i≤3000$，

另外30%的数据满足对$1≤i≤N$有$1≤hi≤200000$，

剩下的40%的数据满足对$1≤i≤N$有$20000≤h_i≤1000000$，

100%的数据满足$N≤1000000$。

## 输出格式

输出文件 output.txt 仅包含一个非负整数，表示满足要求的挑选木棍的方案数对 109+7 取模的结果。

## 样例

### 样例输入 #1
```
4				
5 12 35 5	

```
### 样例输出 #1
```
8
```
## 提示

样例解释：（5,12）与（12,35）是互质勾股数对，故满足要求的挑选木棍的方案有8种，即：


{5}，{12}，{35}，{5}，{5,35}，{35,5}，{5,5}，{5,35,5}。



---

---
title: "[HNOI2011] 数矩形"
layout: "post"
diff: 省选/NOI-
pid: P3217
tag: ['计算几何', '2011', '湖南', '枚举', '排序']
---
# [HNOI2011] 数矩形
## 题目描述

最近某歌手在研究自己的全球巡回演出计划，他将所有心仪的城市都用平面上的一个点来表示，并打算从中挑选出 4 个城市作为这次巡回演出的地点。

为了显示自己与众不同，他要求存在一个矩形使得挑选出的 4 个点恰好是这个矩形的 4 个顶点，并且希望这个矩形的面积最大。

这可急坏了其经纪人，于是他向全球歌迷征集方案，当然你这位歌迷一定不会错过这个机会。

## 输入格式

从文件input.txt中读入数据，输入文件的第一行是一个正整数$N$，表示平面上点的个数(即某歌手心仪的城市数)。接下来的$N$行，每行是由空格隔开的两个整数$X_i$和$Y_i$,表示其对应点的坐标。20%的数据满足$N\leq 500$，100%的数据满足$N\leq 1500$，$-10^8\leq X_i,Y_i\leq 10^8$，且输入数据保证答案存在。

## 输出格式

输出文件 output.txt 仅包含一个非负整数，表示最大的矩形面积。

## 样例

### 样例输入 #1
```
8
-2 3
-2 -1
0 3
0 -1
1 -1
2 1 
-3 1 
-2 1

```
### 样例输出 #1
```
10
```


---

---
title: "[HNOI2013] 消毒"
layout: "post"
diff: 省选/NOI-
pid: P3231
tag: ['搜索', '2013', '湖南', '枚举', '二分图']
---
# [HNOI2013] 消毒
## 题目描述


最近在生物实验室工作的小 T 遇到了大麻烦。 由于实验室最近升级的缘故，他的分格实验皿是一个长方体，其尺寸为 $a\times b\times c$。为了实验的方便，它被划分为 $a\times b\times c$ 个单位立方体区域，每个单位立方体尺寸为 $1\times 1\times 1$，并用 $(i,j,k)$ 标识一个单位立方体。这个实验皿已经很久没有人用了。现在，小 T 被导师要求将其中一些单位立方体区域进行消毒操作（每个区域可以被重复消毒）。

而由于严格的实验要求，他被要求使用一种特定的 F 试剂来进行消毒。 这种 F 试剂特别奇怪，每次对尺寸为 $x\times y\times z$ 的长方体区域（它由 $x\times y\times z$ 个单位立方体组成）进行消毒时，只需要使用 $\min(x,y,z)$ 单位的 F 试剂。F 试剂的价格不菲，这可难倒了小 T。

现在请你告诉他，最少要用多少单位的 F 试剂。
## 输入格式

**本题有多组数据。**

第一行是一个正整数 $D$，表示数据组数。

接下来是 $D$ 组数据，每组数据第一行是三个正整数 $a,b,c$ 表示实验皿的尺寸。

接下来会出现 $a$ 个 $b$ 行 $c$ 列的用空格隔开的 `01` 矩阵，`0` 表示对应的单位立方体不要求消毒，`1` 表示对应的单位立方体需要消毒：如，如果第 $1$ 个 `01` 矩阵的第 $2$ 行第 $3$ 列为 `1`，则表示单位立方体 $(1,2,3)$ 需要被消毒。
## 输出格式

$D$ 行，每行一个整数，表示对应实验皿最少要用多少单位的 F 试剂。
## 样例

### 样例输入 #1
```
1
4  4 4
1  0 1 1
0  0 1 1
0  0 0 0
0  0 0 0
0  0 1 1
1  0 1 1
0  0 0 0
0  0 0 0
0  0 0 0
0  0 0 0
1  0 0 0
0  0 0 0
0  0 0 0
0  0 0 0
0  0 0 0
1  0 0 0
```
### 样例输出 #1
```
3
```
## 提示

#### 样例 1 解释
对于区域 $(1,1,3)-(2,2,4)$ 和 $(1,1,1)-(4,4,1)$ 消毒，分别花费 $2$ 个单位和 $1$ 个单位的 F 试剂。

#### 数据规模与约定

对于 $100\%$ 的数据，保证 $1\le a,b,c\le 5\times 10^3$，$abc\le 5\times 10^3$，且 $1\le D\le 3$。



---

---
title: "[HNOI2016] 矿区"
layout: "post"
diff: 省选/NOI-
pid: P3249
tag: ['2016', '湖南', '枚举', '深度优先搜索 DFS', '生成树']
---
# [HNOI2016] 矿区
## 题目描述

平面上的矿区划分成了若干个开发区域。

简单地说，你可以将矿区看成一张连通的平面图，平面图划分为了若干平面块，每个平面块即为一个开发区域，平面块之间的边界必定由若干整点(坐标值为整数的点)和连接这些整点的线段组成。每个开发区域的矿量与该开发区域的面积有关：具体而言，面积为 $ s $ 的开发区域的矿量为 $ s^2 $。

现在有 $ m $ 个开采计划。每个开采计划都指定了一个由若干开发区域组成的多边形，一个开采计划的优先度被规定为矿量的总和÷开发区域的面积和；例如，若某开采计划指定两个开发区域，面积分别为 $ a $ 和 $ b $，则优先度为 $ (a^2+b^2)/(a+b) $。由于平面图是按照划分开发区域边界的点和边给出的，因此每个开采计划也只说明了其指定多边形的边界，并未详细指明是哪些开发区域（但很明显，只要给出了多边形的边界就可以求出是些开发区域）。

你的任务是求出每个开采计划的优先度。为了避免精度问题，你的答案必须按照分数的格式输出，即求出分子和分母，且必须是最简形式（分子和分母都为整数，而且都消除了最大公约数；例如，若矿量总和是 $ 1.5 $，面积和是 $ 2 $，那么分子应为 $ 3 $，分母应为 $ 4 $；又如，若矿量和是 $ 2 $，面积和是 $ 4 $，那么分子应为 
 $ 1 $，分母应为 $ 2 $）。

由于某些原因，你必须依次对每个开采计划求解（即下一个开采计划会按一定格式加密，加密的方式与上一个开采计划的答案有关）。具体的加密方式见输入格式。
## 输入格式

第一行三个正整数 $ n, m, k $，分别描述平面图中的点和边，以及开采计划的个数。  

接下来 $ n $ 行，第 $ i $ 行 ( $ i = 1, 2, \cdots , n $)有两个整数 $x_i, y_i$,  表示点 $ i $ 的坐标为 $(x_i, y_i)$。  

接下来 $ m $ 行，第 $ i $ 行有两个正整数 $a, b$，表示点 $ a $ 和 $ b $ 之间有一条边。  

接下来一行若干个整数，依次描述每个开采计划。每个开采计划的第一个数 $ c $ 指出该开采计划由开发区域组成的多边形边界上的点的个数为 $ d=(c+P) \bmod n \mathrel{+} 1 $；接下来 $ d $ 个整数，按逆时针方向描述边界上的每一个点：设其中第 $ i $ 个数为 $ z_i $，则第 $ i $ 个点的编号为 $(z_i+P)\bmod n \mathrel{+} 1$。其中 $ P $ 是上一个开采计划的答案中分子的值；对于第 $ 1 $ 个开采计划，$ P = 0 $。
## 输出格式

对于每个开采计划，输出一行两个正整数，分别描述分子和分母。

## 样例

### 样例输入 #1
```
9 14 5
0 0
1 0
2 0
0 1
1 1
2 1
0 2
1 2
2 2
1 2
2 3
5 6
7 8
8 9
1 4
4 7
5 8
3 6
6 9
4 8
1 5
2 6
6 8
3 3 0 4 7 1 3 4 6 4 8 0 4 3 6 2 3 8 0 4 6 2 5 0 4 5 7 6 3
```
### 样例输出 #1
```
1 1 
1 2 
1 1 
9 10 
3 4
```
## 提示

### 样例解释

输入文件给出的 $9$ 个点和 $14$ 条边描述的平面图如下所示：

![](https://cdn.luogu.com.cn/upload/image_hosting/cg70enmo.png)

第一个开采计划，输入的第 $1$ 个值为 $3$，所以该开采计划对应的多边形有 $(3+0)\bmod 8+1=4$ 个点，将接下的 $4$ 个数 $3,0,4,7$，分别代入 $(z_i+0)\bmod n+1$ 得到 $4$ 个点的编号为 $4,1,5,8$。计算出第一个开采计划的分子为 $1$，分母为 $1$。

类似地，可计算出余下开采计划的多边形的点数和点的编号：第二个开采计划对应的多边形有 $3$ 个点，编号分别为 $5,6,8$。第三个开采计划对应的多边形有 $6$ 个点，编号分别为 $1,2,6,5,8,4$。第四个开采计划对应的多边形有 $5$ 个点，编号分别为 $1,2,6,8,4$。第五个开采计划对应的多边形有 $6$ 个点，编号分别为 $1,5,6,8,7,4$。

### 数据范围及约定


对于 $ 100 \% $ 的数据，$ n, k \leq 2 \times 10^5, \  m \leq 3n-6, \  |x_i|, |y_i| \leq 3×10^4$。

所有开采计划的 $ d $ 之和不超过 $2 \times 10^6$。保证任何开采计划都包含至少一个开发区域，且这些开发区域构成一个连通块。

保证所有开发区域的矿量和不超过 $ 2^{63}-1 $。

保证平面图中没有多余的点和边。

保证数据合法。由于输入数据量较大，建议使用读入优化。





---

---
title: "[JLOI2013] 赛车"
layout: "post"
diff: 省选/NOI-
pid: P3256
tag: ['2013', '吉林', '枚举', '栈', '半平面交']
---
# [JLOI2013] 赛车
## 题目描述

这里有一辆赛车比赛正在进行，赛场上一共有 $n$ 辆车，分别称为个 $g_1,g_2,...,g_n$。赛道是一条无限长的直线。最初，$g_i$ 位于距离起跑线前进 $k_i$ 的位置。比赛开始后，车辆 $g_i$ 将会以 $v_i$ 单位每秒的恒定速度行驶。在这个比赛过程中，如果一辆赛车曾经处于领跑位置的话（即没有其他的赛车跑在他的前面），这辆赛车最后就可以得奖，而且比赛过程中不用担心相撞的问题。现在给出所有赛车的起始位置和速度，你的任务就是算出那些赛车将会得奖。

## 输入格式

第一行有一个正整数 $n$，表示赛车的个数。

接下来一行，包含 $n$ 个整数，按顺序给出 $n$ 辆赛车的起始位置。再接下来一行给出 $n$ 个整数，按顺序给出 $n$ 辆赛车的恒定速度。
## 输出格式

输出包括两行，第一行为获奖的赛车个数。第二行按从小到大的顺序输出获奖赛车的编号，编号之间用空格隔开，注意最后一个编号后面不要加空格。
## 样例

### 样例输入 #1
```
4
1 1 0 0
15 16 10 20
```
### 样例输出 #1
```
3
1 2 4
```
## 提示

#### 数据范围与约定

- 对于 $100\%$ 的数据，$1 \le n \le 10^4$，$0 \le k_i \le 10^9$，$0 \le v_i \le 10^9$。


---

---
title: "[JLOI2015] 战争调度"
layout: "post"
diff: 省选/NOI-
pid: P3262
tag: ['搜索', '2015', '各省省选', '吉林', '枚举', '深度优先搜索 DFS']
---
# [JLOI2015] 战争调度
## 题目描述

脸哥最近来到了一个神奇的王国，王国里的公民每个公民有两个下属或者没有下属，这种关系刚好组成一个 $n$ 层的完全二叉树。公民 $i$ 的下属是 $2i$ 和 $2i +1$。最下层的公民即叶子节点的公民是平民，平民没有下属，最上层的是国王，中间是各级贵族。

现在这个王国爆发了战争，国王需要决定每一个平民是去种地以供应粮食还是参加战争，每一个贵族（包括国王自己）是去管理后勤还是领兵打仗。一个平民会对他的所有直系上司有贡献度，若一个平民 $i$ 参加战争，他的某个直系上司 $j$ 领兵打仗，那么这个平民对上司的作战贡献度为 $w_{ij}$。若一个平民 $i$ 种地，他的某个直系上司 $j$ 管理后勤，那么这个平民对上司的后勤贡献度为 $f_{ij}$，若 $i$ 和 $j$ 所参加的事务不同，则没有贡献度。为了战争需要保障后勤，国王还要求不多于 $m$ 个平民参加战争。

国王想要使整个王国所有贵族得到的贡献度最大，并把这件事交给了脸哥。但不幸的是，脸哥还有很多 deadline 没有完成，他只能把这件事又转交给你。你能帮他安排吗？
## 输入格式

第一行两个数 $n,m$。

接下来 $2^{n-1}$ 行，每行 $n-1$ 个数，第 $i$ 行表示编号为 $2^{n-1}-1+ i$ 的平民对其 $n-1$ 个直系上司的作战贡献度，其中第一个数表示对第一级直系上司，即编号为 $\frac{2^{n-1}-1+ i}{2}$ 的贵族的作战贡献度 $w_{ij}$，依次往上。

接下来 $2^{n-1}$ 行，每行 $n-1$ 个数，第 $i$ 行表示编号为 $2^{n-1}-1+ i$ 的平民对其 $n-1$ 个直系上司的后勤贡献度，其中第一个数表示对第一级直系上司，即编号为 $\frac{2^{n-1}-1+ i}{2}$ 的贵族的后勤贡献度 $f_{ij}$ ，依次往上。
## 输出格式

一行一个数表示满足条件的最大贡献值。
## 样例

### 样例输入 #1
```
3 4
503 1082
1271 369
303 1135
749 1289
100 54
837 826
947 699
216 389
```
### 样例输出 #1
```
6701
```
## 提示

对于 $100 \%$ 的数据，$2 \leq n \leq 10, \ m \leq 2^{n-1}, \ 0 \leq w_{ij}, f_{ij} \leq 2000$。


---

---
title: "[JLOI2016] 方"
layout: "post"
diff: 省选/NOI-
pid: P3271
tag: ['2016', '吉林', '枚举', '容斥原理']
---
# [JLOI2016] 方
## 题目描述

上帝说，不要圆，要方，于是便有了这道题。

由于我们应该方，而且最好能够尽量方，所以上帝派我们来找正方形上帝把我们派到了一个有 $N$ 行 $M$ 列的方格图上，图上一共有 $(N+1)\times(M+1)$ 个格点，我们需要做的就是找出这些格点形成了多少个正方形（换句话说，正方形的四个顶点都是格点）。

但是这个问题对于我们来说太难了，因为点数太多了，所以上帝删掉了这 $(N+1)\times(M+1)$ 中的 $K$ 个点。既然点变少了，问题也就变简单了，那么这个时候这些格点组成了多少个正方形呢？

## 输入格式

第一行三个整数 $N, M, K$，代表棋盘的行数、 列数和不能选取的顶点个数。保证 $N, M \ge 1$， $K \le (N + 1) \times(M + 1)$。

约定每行的格点从上到下依次用整数 $0$ 到 $N$ 编号，每列的格点依次用 $0$ 到 $M$ 编号。

接下来 $K$ 行，每行两个整数 $x,y$ 代表第 $x$ 行第 $y$ 列的格点被删掉了。

保证 $0 \le x \le N \le 10^6$，$0 \le y \le M \le 10^6$，$K \le 2000$ 且不会出现重复的格点。
## 输出格式

仅一行一个正整数，代表正方形个数对 $100000007 ( 10^8 + 7)$ 取模之后的值。
## 样例

### 样例输入 #1
```
2 2 4
1 0
1 2
0 1
2 1
```
### 样例输出 #1
```
1
```


---

---
title: "[SCOI2013] 多项式的运算"
layout: "post"
diff: 省选/NOI-
pid: P3278
tag: ['2013', '四川', '线段树', '各省省选', '枚举']
---
# [SCOI2013] 多项式的运算
## 题目描述

某天，mzry1992 一边思考着一个项目问题一边在高速公路上骑着摩托车。一个光头踢了他一脚，摩托车损坏，而他也被送进校医院打吊针。现在该项目的截止日期将近，他不得不请你来帮助他完成这个项目。


该项目的目的是维护一个动态的关于x 的无穷多项式 ，这个多项式初始时对于所有i有$a_i = 0$。

$f(x)=a_0x^0+a_1x^1+a_2x^2...$

操作者可以进行四种操作：


将$x^L$ 到$x^R$ 这些项的系数乘上某个定值v


将$x^L$ 到$x^R$ 这些项的系数加上某个定值v


将$x^L 到x^R $这些项乘上x变量


将某个定值v代入多项式F(x)，并输出代入后多项式的值，之后多项式还原为代入前的状况

经过观察，项目组发现使用者的操作集中在前三种，第四种操作不会出现超过10次。mzry1992 负责这个项目的核心代码，你能帮他实现么？

## 输入格式

输入的第一行有一个整数n 代表操作的个数。


接下来n 行，每行一个操作，格式如下：


mul L R v 代表第一种操作


add L R v 代表第二种操作


mulx L R 代表第三种操作


query v 代表第四种操作


## 输出格式

对于每个query 操作，输出对应的答案，结果可能较大，需要模上20130426。

## 样例

### 样例输入 #1
```
6
add 0 1 7
query 1
mul 0 1 7
query 2
mulx 0 1
query 3
```
### 样例输出 #1
```
14
147
588

```
## 提示

【样例解释】

操作一之后，多项式为F(x) = 7x + 7。

操作三之后，多项式为F(x) = 49x + 49。

操作五之后，多项式为F(x) = 49x^2 + 49x。

【数据范围与约定】

对于30% 的数据：N ≤ 5000，0 ≤ L ≤ R ≤ 5000，0 ≤ v ≤ 10^9


另有20% 的数据：N ≤ 10^5，0 ≤ L ≤ R ≤ 10^5，0 ≤ v ≤ 10^9，没有mulx 操作


剩下的50% 的数据：N ≤ 10^5，0 ≤ L ≤ R ≤ 10^5，0 ≤v ≤ 10^9



---

---
title: "[SCOI2014] 方伯伯的商场之旅"
layout: "post"
diff: 省选/NOI-
pid: P3286
tag: ['动态规划 DP', '2014', '四川', 'O2优化', '枚举', '数位 DP']
---
# [SCOI2014] 方伯伯的商场之旅
## 题目描述

方伯伯有一天去参加一个商场举办的游戏。商场派了一些工作人员排成一行。每个人面前有几堆石子。

说来也巧，位置在 $i$ 的人面前的第 $j$ 堆的石子的数量，刚好是 $i$ 写成 $K$ 进制后的第 $j$ 位。现在方伯伯要玩一个游戏，商场会给方伯伯两个整数 $L,R$。

方伯伯要把位置在 $[L, R]$ 中的每个人的石子都合并成一堆石子。每次操作，他可以选择一个人面前的两堆石子，将其中的一堆中的某些石子移动到另一堆，代价是移动的石子数量 $\times$ 移动的距离。

商场承诺，方伯伯只要完成任务，就给他一些椰子，代价越小，给他的椰子越多。所以方伯伯很着急，想请你告诉他最少的代价是多少。例如：$10$ 进制下的位置在 $12312$ 的人，合并石子的最少代价为：$1 \times 2 + 2 \times 1 + 3 \times 0 + 1 \times1 + 2 \times 2 = 9$即把所有的石子都合并在第三堆。

## 输入格式

输入仅有 $1$ 行，包含 $3$ 个用空格分隔的整数 $L,R,K$，表示商场给方伯伯的 $2$ 个整数，以及进制数。
## 输出格式

输出仅有 $1$ 行，包含 $1$ 个整数，表示最少的代价。
## 样例

### 样例输入 #1
```
3 8 3
```
### 样例输出 #1
```
5
```
## 提示

对于 $100\%$ 的数据，$1 \le L \le R \le 10^{15}, 2 \le K \le 20$。


---

---
title: "[SCOI2016] 妖怪"
layout: "post"
diff: 省选/NOI-
pid: P3291
tag: ['2016', '四川', '二分', '枚举', '凸包']
---
# [SCOI2016] 妖怪
## 题目描述


邱老师是妖怪爱好者，他有 $n$ 只妖怪，每只妖怪有攻击力 $\mathrm{atk}$ 和防御力 $\mathrm{dnf}$ 两种属性。邱老师立志成为妖怪大师，于是他从真新镇出发，踏上未知的旅途，见识不同的风景。

环境对妖怪的战斗力有很大影响，环境 $(a,b)$ 由 $a,b$ 两个参数定义，其中 $a,b$ 为**正实数**。在环境 $(a,b)$ 中，妖怪可以降低自己 $k\times a$ 点攻击力，提升 $k\times b$ 点防御力或者提升自己 $k\times a$ 点攻击力，降低 $k\times b$ 点防御力。其中 $k$ 为**任意实数**，但是 **$\mathrm{atk}$ 和 $\mathrm{dnf}$ 必须始终非负**。

妖怪在环境 $(a,b)$ 中的**战斗力** $\mathrm{strength}$ 定义为妖怪在该种环境中能达到的最大攻击力和最大防御力之和，即 $\mathrm{strength}(a,b)=\max(\mathrm{atk}(a,b))+\max(\mathrm{dnf}(a,b))$。

比如当前环境 $a=3,b=2$，那么攻击力为 $6$，防御力为 $2$ 的妖怪，能达到的最大攻击力为 $9$，最大防御力为 $6$。所以该妖怪在 $a=3,b=2$ 的环境下战斗力为 $15$。

因此，在不同的环境，战斗力最强的妖怪可能发生变化。

作为一名优秀的妖怪训练师，邱老师想发掘每一只妖怪的最大潜力，他想知道在**最为不利的情况下**，他的 $n$ 只妖怪能够达到的最强战斗力值。换言之，存在一组正实数 $(a,b)$ 使得 $n$ 只妖怪在该环境下最强战斗力最低，你需要输出这个最低的战斗力。
## 输入格式

第一行一个n，表示有 $n$ 只妖怪。

接下来 $n$ 行，每行两个整数 $\mathrm{atk}_i$ 和 $\mathrm{dnf}_i$，表示第 $i$ 只妖怪的攻击力和防御力。

## 输出格式

输出在最不利情况下最强妖怪的战斗力值，保留 $4$ 位小数。
## 样例

### 样例输入 #1
```
3
1 1
1 2
2 2
```
### 样例输出 #1
```
8.0000
```
## 提示


对于 $100\%$ 的数据，$1\le n\le 10^6$，$0\lt \mathrm{atk},\mathrm{dnf}\le 10^8$。

Statement fixed by Starrykiller.


---

---
title: "[SCOI2016] 萌萌哒"
layout: "post"
diff: 省选/NOI-
pid: P3295
tag: ['2016', '四川', '并查集', '枚举', 'ST 表']
---
# [SCOI2016] 萌萌哒
## 题目描述

一个长度为 $n$ 的大数，用 $S_1S_2S_3 \cdots S_n$表示，其中 $S_i$ 表示数的第 $i$ 位, $S_1$ 是数的最高位。告诉你一些限制条件，每个条件表示为四个数，$l_1,r_1,l_2,r_2$，即两个长度相同的区间，表示子串 $S_{l_1}S_{l_1+1}S_{l_1+2} \cdots S_{r_1}$ 与 $S_{l_2}S_{l_2+1}S_{l_2+2} \cdots S_{r_2}$ 完全相同。

比如 $n=6$ 时，某限制条件 $l_1=1,r_1=3,l_2=4,r_2=6$ ，那么 $123123$，$351351$ 均满足条件，但是 $12012$，$131141$ 不满足条件，前者数的长度不为 $6$ ，后者第二位与第五位不同。问满足以上所有条件的数有多少个。
## 输入格式

第一行两个数 $n$ 和 $m$，分别表示大数的长度，以及限制条件的个数。

接下来 $m$ 行，对于第 $i$ 行,有 $4$ 个数 $l_{i_1},r_{i_1},{l_{i_2}},r_{i_2}$，分别表示该限制条件对应的两个区间。

$1\le n\le 10^5$，$1\le m\le 10^5$，$1\le l_{i_1},r_{i_1},{l_{i_2}},r_{i_2}\le n$ ；并且保证 $ r_{i_1}-l_{i_1}=r_{i_2}-l_{i_2}$ 。

## 输出格式

一个数，表示满足所有条件且长度为 $n$ 的大数的个数，答案可能很大，因此输出答案模 $ 10^9+7 $ 的结果即可。

## 样例

### 样例输入 #1
```
4 2
1 2 3 4
3 3 3 3
```
### 样例输出 #1
```
90
```


---

---
title: "[SDOI2015] 立体图"
layout: "post"
diff: 省选/NOI-
pid: P3326
tag: ['2015', '山东', '枚举']
---
# [SDOI2015] 立体图
## 题目描述

小渊是个聪明的孩子，他经常会给周围的小朋友们讲些自己认为有趣的内容。最近，他准备给小朋友们讲解彩色水平光源照射下的立体图，并请你帮他在平面上画出来。

小渊有一块面积为m\*n的矩形区域，上面有m\*n个边长为1的格子，每个格子上堆了一些同样大小的积木（积木的长宽高都是1）。

为了方便阐述，我们假设这块区域是坐北朝南的，下面我们给出一个例子。

![](https://cdn.luogu.com.cn/upload/pic/22187.png)

小渊想请你打印出这些格子的立体图。我们定义每个积木为如下格式，并且不会做任何翻转旋转，只会严格以这一种形式摆放（左侧是应该打印出来的图样，右侧为对应每一个位置符号的十进制ASCII，其中ASCII为32的符号为空

![](https://cdn.luogu.com.cn/upload/pic/22188.png)

在良好的光学环境下，小渊将T束平行光同时照射在这些积木上。这些平行光首先满足一定是红绿蓝三基色之一，其次入射角度满足：与x轴y轴的夹角度数均为45的倍数；且与z轴正方向的夹角或为45度，或为0度，或为315度。

具体来说，我们最多会考虑9个方向的不同平行光，它们的入射方向可以被描述为：   西北方45度仰角  正北方45度仰角  东北方45度仰角   正西方45度仰角  垂直从上入射光  正东方45度仰角   西南方45度仰角  正南方45度仰角  东南方45度仰角对于每一个单位积木来说，可以打印出来的三个表面被分为12个小三角形，如下图所示（下图中用符号0,1,2,。。

![](https://cdn.luogu.com.cn/upload/pic/22189.png)

红绿蓝三基色分别用字母RGB来表示。而二次叠加后的三种颜色青黄紫，分别用CYP来表示。对于三次叠加后的颜色，也就是白色，用W来表示。


## 输入格式

第一行有两个正整数m和n，表示区域有m行n列。之后m行，依次由远及近描述了每一行的情况。每一行给出n个正整数，表示第i行第j列中有堆放了多少积木。之后3行，每行三个字符，描述了9个对应方向（与地图描述方向相同）的光照颜色。其中每一个字符或者为RGB中之一，表示对应的颜色。或者为\*，表示没有照射光。这九个方向依次是：   西北方45度仰角  正北方45度仰角  东北方45度仰角   正西方45度仰角  垂直从上入射光  正东方45度仰角   西南方45度仰角  正南方45度仰角  东南方45度仰角

## 输出格式

输出给出了打印后的效果。其中要求输出结果不含前导空行，结尾也没有额外空行。输出的第一列不能全是空格，且每一行末尾也没有额外空格。

## 样例

### 样例输入 #1
```
2 2
2 1
1 1
R**
***
**G

```
### 样例输出 #1
```
        +-------+
       /Y\YYYY'/|
      /YY.*'YY/G|
     /.YYYY\Y/G/|
    +-------+G.G|
    |\GGGGG/|\:G|
    |G\GGG/G|G*G|
    |GG\G/GG|G:\|
    |GGGXGGG|G'G+-------+
    |GG/G\GG|/G/G\YYYY'/|
    |G/GGG\G|G/GG.*'YY/G|
    |/GGGGG\|/.GGGG\Y/G/|
    +-------+-------+G.G|
   /Y\GGGG'/G\GGGG'/|\:G|
  /YY.*'GG/GG.*'GG/G|G*G|
 /.YYYY\G/.GGGG\G/G/|G:\|
+-------+-------+G.G|G'G+
|\GGGGG/|\GGGGG/|\:G|/G/
|G\GGG/G|G\GGG/G|G*G|G/
|GG\G/GG|GG\G/GG|G:\|/
|GGGXGGG|GGGXGGG|G'G+
|GG/G\GG|GG/G\GG|/G/
|G/GGG\G|G/GGG\G|G/
|/GGGGG\|/GGGGG\|/
+-------+-------+

```
### 样例输入 #2
```
3 4
1 1 2 1
1 2 1 2
2 1 2 1
**B
***
R*G

```
### 样例输出 #2
```
                            +-------+
                           /W\WWWW'/|
                          /WW.*'WW/C|
                         /.WWWW\W/C/|
                +-------+-------+-------+
               /W\WWWW'/|\YYYYY/W\WWWW'/|
              /WW.*'WW/C|G\YYY/WW.*'WW/C|
             /.WWWW\W/C/|GG\Y/.WWWW\W/C/|
    +-------+-------+-------+-------+C.C|---+
   /W\WWWW'/|\YYYYY/W\WWWW'/|\YYYYY/|\:C|C'/|
  /WW.*'WW/C|G\YYY/WW.*'WW/C|G\YYY/Y|C*C|C/C|
 /.WWWW\W/C/|GG\Y/.WWWW\W/C/|GG\Y/YY|C:\|/C/|
+-------+C.G|GGG+-------+C.G|GGGXYYY|C'C+C.C|
|\YYYYY/|\:G|GG/|\YYYYY/|\:G|GG/G\YY|/C/|\:C|
|Y\YYY/Y|C*G|G/K|Y\YYY/Y|C*G|G/GGG\Y|C/C|C*C|
|YY\Y/YY|C:\|/KK|YY\Y/YY|C:\|/GGGGG\|/C/|C:\|
|YYYXYYY|C'G+---|YYYXYYY|C'G+-------+C.C|C'C+
|YY/Y\YY|/G/G\KK|YY/Y\YY|/G/G\GGGG'/|\:C|/C/
|Y/YYY\Y|G/GG.*'|Y/YYY\Y|G/GG.*'WW/C|C*C|C/
|/YYYYY\|/.YYYY\|/YYYYY\|/.WWWW\W/C/|C:\|/
+-------+-------+-------+-------+C.C|C'C+
|\YYYYY/|\YYYYY/|\YYYYY/|\YYYYY/|\:C|/C/
|Y\YYY/Y|Y\YYY/Y|Y\YYY/Y|Y\YYY/Y|C*C|C/
|YY\Y/YY|YY\Y/YY|YY\Y/YY|YY\Y/YY|C:\|/
|YYYXYYY|YYYXYYY|YYYXYYY|YYYXYYY|C'C+
|YY/Y\YY|YY/Y\YY|YY/Y\YY|YY/Y\YY|/C/
|Y/YYY\Y|Y/YYY\Y|Y/YYY\Y|Y/YYY\Y|C/
|/YYYYY\|/YYYYY\|/YYYYY\|/YYYYY\|/
+-------+-------+-------+-------+
```
## 提示

 
![](https://cdn.luogu.com.cn/upload/pic/22190.png)

对于15%的数据，1<=n,m<=100,没有入射光。

对于40%的数据，1<=n,m<=100,入射光只有一束，且入射方向一定是东南方。

对于100%的数据，1<=n,m<=100，每一个位置堆放的积木总数不超过100,入射光颜色可能是RGB中的任何一种颜色，最多可以有9束入射光。



---

---
title: "[ZJOI2014] 消棋子"
layout: "post"
diff: 省选/NOI-
pid: P3341
tag: ['模拟', '2014', '浙江', '枚举', '队列']
---
# [ZJOI2014] 消棋子
## 题目描述

消棋子是一个有趣的游戏。游戏在一个 $r \times c$ 的棋盘上进行。棋盘的每个格子，要么是空，要么是一种颜色的棋子。同一种颜色的棋子恰好有两个。

每一轮，玩家可以选择一个空格子 $(x, y)$，并选择上下左右四个方向中的两个方向，如果在这两个方向上均存在有棋子的格子，而且沿着这两个方向上第一个遇到的棋子颜色相同，那么，我们将这两个棋子拿走，并称之为合法的操作。否则称这个操作不合法，游戏不会处理这个操作。游戏的目的是消除尽量多的棋子。

给出这样一个游戏和一个人的玩法。你需要： 
1. 指出此人能消去多少棋子。 
1. 输出能消去最多棋子数量。
## 输入格式

第一行给出了整数 $r$，$c$。

第二行给出了整数 $n$，表示不同颜色数。接下来 $n$ 行，第 $i$ 行含 $4$ 个整数 $a_i$，$b_i$，$c_i$，$d_i$，表示颜色为 $i$ 的两个格子分别是 $(a_i, b_i)$，$(c_i, d_i)$。然后是一个整数 $m$，表示此人的操作数。接下来 $m$ 行，每行有 $2$ 个整数和 $2$ 个字母，代表了他选择的格子，以及两个方向。我们用 `UDLR` 分别表示上下左右。
## 输出格式

输出用空格分隔的两个数字：此人能消去多少棋子和一个整数 $k$，表示能消去最多棋子数量。
## 样例

### 样例输入 #1
```
4 4
4
1 1 1 4
1 2 3 4
1 3 3 2
4 1 2 3
6
2 3 U R
2 1 D R
2 2 L R
2 4 L D
3 1 L R
3 3 L U
```
### 样例输出 #1
```
2 4
```
## 提示

对于所有数据，$1\leq r,c,n \leq 10^5$，数据保证答案的操作数 $0\leq k \leq 10^6$。


---

---
title: "[ZJOI2014] 璀灿光华"
layout: "post"
diff: 省选/NOI-
pid: P3342
tag: ['2014', '浙江', '枚举', '广度优先搜索 BFS', '图论建模']
---
# [ZJOI2014] 璀灿光华
## 题目描述

金先生有一个女朋友没名字。她勤劳勇敢、智慧善良。金先生很喜欢她。为此，金先生用 $a^3$ 块 $1\times 1 \times 1$ 的独特的水晶制作了一个边长为 $a$ 的水晶立方体，他要将这个水晶立方体送给他见过最单纯善良的她。

由于水晶立方体太太，不好运送，金先生还是将它拆开来送出。他相信拼好这个水晶立方难不倒聪明的她。

没名字收到了礼物后果然不一会儿就根据说明将水晶立方体拼好了。没名字发现，有 $n$ 块水晶在漆黑安静的夜晚会随机以等概率向上下左右前后六个方向的一个发出穿透光。被光照到的水晶显得格外好看。没名字给每一块不会发光的水晶定义了一个好看程度。水晶立方体在夜晚中的好看程度就是每块被光照到的水晶的好看程度之和。没名字想知道，水晶立方体在夜晚中的好看程度的最小值和最大值。
## 输入格式

第一行是 $a$，表示水晶立方体的边长。
接下来 $a^3$ 行，每行若干整数。
第一个数 $g_i$ 表示第 $i$ 块水晶的好看程度。如果 $g_i=0$，代表这块水晶会发光。接下来 $3\sim 6$ 个整数，代表与这块水晶有共同面的水晶编号。
## 输出格式

两个整数，代表水晶立方体在夜晚好看程度的最小值与最大值。
## 样例

### 样例输入 #1
```
2
0 7 2 3
0 8 1 4
4 5 4 1
8 6 3 2
16 3 6 7
32 4 5 8
1 1 8 5
2 2 7 6
```
### 样例输出 #1
```
0 12
```
## 提示

对于所有数据，$1<a\leq 70$，$g_i<10^6$，$n\leq 8$。



---

---
title: "[ZJOI2016] 小星星"
layout: "post"
diff: 省选/NOI-
pid: P3349
tag: ['动态规划 DP', '2016', '浙江', '枚举', '容斥原理']
---
# [ZJOI2016] 小星星
## 题目描述

小 Y 是一个心灵手巧的女孩子，她喜欢手工制作一些小饰品。她有 $n$ 颗小星星，用 $m$ 条彩色的细线串了起来，每条细线连着两颗小星星。

有一天她发现，她的饰品被破坏了，很多细线都被拆掉了。这个饰品只剩下了 $n-1$ 条细线，但通过这些细线，这颗小星星还是被串在一起，也就是这些小星星通过这些细线形成了树。小 Y 找到了这个饰品的设计图纸，她想知道现在饰品中的小星星对应着原来图纸上的哪些小星星。如果现在饰品中两颗小星星有细线相连，那么要求对应的小星星原来的图纸上也有细线相连。小 Y 想知道有多少种可能的对应方式。

只有你告诉了她正确的答案，她才会把小饰品做为礼物送给你呢。

## 输入格式

第一行包含 $2$ 个正整数 $n,m$，表示原来的饰品中小星星的个数和细线的条数。

接下来 $m$ 行，每行包含 $2$ 个正整数 $u,v$，表示原来的饰品中小星星 $u$ 和 $v$ 通过细线连了起来。这里的小星星从 $1$ 开始标号。保证 $u\neq v$，且每对小星星之间最多只有一条细线相连。

接下来 $n-1$ 行，每行包含 $2$ 个正整数 $u,v$，表示现在的饰品中小星星 $u$ 和 $v$ 通过细线连了起来。保证这些小星星通过细线可以串在一起。
## 输出格式

输出共 $1$ 行，包含一个整数表示可能的对应方式的数量。

如果不存在可行的对应方式则输出 `0`。
## 样例

### 样例输入 #1
```
4 3
1 2
1 3
1 4
4 1
4 2
4 3
```
### 样例输出 #1
```
6
```
## 提示

对于 $100\%$ 的数据，$n\leq 17$，$m\leq \frac 12n(n-1)$。


---

---
title: "[POI 2007] SKA-Rock Garden"
layout: "post"
diff: 省选/NOI-
pid: P3458
tag: ['2007', 'POI（波兰）', 'Special Judge', '枚举']
---
# [POI 2007] SKA-Rock Garden
## 题目描述

Vicomte de Bajteaux is the owner of a renowned collection of boulders. Up to now, he has kept it in thecellars of his palace, but recently, he has decided to display the collection in his vast gardens.

The gardens have a shape of rectangle, whose sides are $1\ 000\ 000\ 000$ units long and are parallel to east-westand north-south geographical directions. For each boulder, vicomte has determined coordinates ofthe point, which he would like it to be placed in (the coordinates are simply distances to the southern and    western side of the garden), and gave them to his servants. Unfortunately he has forgot to tell them the orderof the coordinates (i.e. for some of the boulders the first coordinate of a point is the so called "$y$ coordinate",i.e. the ordinate, while for others the so called "$x$ coordinate", i.e. the abscissa).

The servants, unaware of thisfact, have placed the boulders assuming customary coordinate ordering (as in standard Cartesian coordinates:

the abscissa, commonly known as "$x$ coordinate", first).

To protect his collection, vicomte has decided to surround it with a fence. For aesthetic reasons thefence has to be a rectangle, with sides parallel to the sides of the garden. The garden layout has been planned,      so that the total length of the fence be minimal (i.e. in the space of all coordinate orderings, the original          ordering of vicomte requires the minimal length of the fence - we assume that the rectangle may have sides of zero length).

The servants have to move the boulders so that the length of the fence required is minimal lest their mistake become obvious. Each boulder may only be moved in a way that preserves the coordinate set: by      interchanging its coordinates. As the boulders are heavy, the servants would like to minimize their effort, by      minimizing the weight of the boulders to be moved.

## Task

Write a programme which:

reads the present positions of the boulders in the gardens and their respective weights, determines a sequence of moves, which minimizes the length of the fence required to protect the    boulders and also minimizes the weight of the boulders to be moved, writes the outcome to the standard output.
## 输入格式

The first line of the standard input contains a single integer $n$ ($2 \le n \le 1\ 000\ 000$), denoting the number of boulders in the collection. The following $n$  lines contain three integers $x_i$, $y_i$ and $m_i$ each ($0 \le x_i, y_i \le 1\ 000\ 000\ 000$, $1 \le m \le 2000$), separated by single spaces, denoting the present coordinates and the weight of $i$'th boulder. No unordered pair of coordinates will appear in the input more than once.

## 输出格式

The first line of the standard output should contain two integers, separated by a single space - the minimal length of fence possible and the minimal weight of the boulders to be moved in order to obtain such a length.


The second line should contain a sequence of $n$ zeros and/or ones - $i$'th element of the sequence should be a one if in the optimal solution the $i$'th boulder is to be moved and zero otherwise. Should more than one correct solutions exist, your programme is to write out any one of them.

## 样例

### 样例输入 #1
```
5
2 3 400
1 4 100
2 2 655
3 4 100
5 3 277
```
### 样例输出 #1
```
10 200
01010
```
## 题目翻译

### 题目描述

**译自 POI 2007 Stage 2. Day 1「[Skalniak](https://szkopul.edu.pl/problemset/problem/s5ECsFKlMHti0g29uVkdKlQw/site/?key=statement)」**

Vicomte de Bajteaux 收藏了许多石头并准备把它们放到花园里。

花园是一个正方形，边长为 $1\ 000\ 000\ 000$。Vicomte de Bajteaux 让他的仆人为他用石头布置花园。但他忘记告诉仆人坐标的顺序，以至于一些点的坐标以 $(x,y)$ 的形式给出，一些点的坐标以 $(y,x)$ 的形式给出，并且石头已经按这样的顺序放好了。

为了保护石头，Vicomte de Bajteaux 按照实际的坐标规划了一排栅栏来围住这些石头，使得栅栏的总长最小。为了美观，栅栏必须是平行于坐标轴的矩形。为了让错误不那么明显，你需要帮助仆人选择一部分石头并将它们从 $(x,y)$ 移动到 $(y,x)$，在最小化栅栏的长度的基础上最小化需要移动的石头的总重。

### 输入格式

第一行一个整数 $n (1 \le n \le 1\ 000\ 000)$，表示石头的个数。

接下来 $n$ 行每行三个整数 $x_i, y_i, m_i$（$0 \le x_i,y_i \le 1\ 000\ 000\ 000, 1 \le m_i \le 2\ 000$），表示石头当前所在的坐标和重量。

不会有 $x$ 和 $y$ 组成的无序数对出现超过一次。

### 输出格式

第一行输出两个整数，分别表示栅栏的最小长度和需要移动的石头总重量的最小值。

第二行输出一个长度为 $n$ 的 01 串，表示取到石头总重量最小值的一种移动方案。第 $i$ 个字符为 $1$ 表示需要将第 $i$ 个石头从 $(x_i, y_i)$ 移动到 $(y_i, x_i)$，为 $0$ 则表示不需要。若有多解，输出任意一种解法均可以。

### 样例解释

![](https://cdn.luogu.com.cn/upload/image_hosting/gjo0jemf.png)

![](https://cdn.luogu.com.cn/upload/image_hosting/09zdeg0c.png)

翻译来自于 [LibreOJ](https://loj.ac/p/2655)。


---

---
title: "[POI 2012] ODL-Distance"
layout: "post"
diff: 省选/NOI-
pid: P3532
tag: ['数学', '2012', 'POI（波兰）', '枚举']
---
# [POI 2012] ODL-Distance
## 题目描述

We consider the distance between positive integers in this problem, defined as follows.

A single operation consists in either multiplying a given number by a prime number1    or dividing it by a prime number (if it does divide without a remainder).

The distance between the numbers ![](http://main.edu.pl/images/OI19/odl-en-tex.1.png) and ![](http://main.edu.pl/images/OI19/odl-en-tex.2.png), denoted ![](http://main.edu.pl/images/OI19/odl-en-tex.3.png), is the minimum number of operations    it takes to transform the number ![](http://main.edu.pl/images/OI19/odl-en-tex.4.png) into the number ![](http://main.edu.pl/images/OI19/odl-en-tex.5.png).

For example, ![](http://main.edu.pl/images/OI19/odl-en-tex.6.png).

Observe that the function ![](http://main.edu.pl/images/OI19/odl-en-tex.7.png) is indeed a distance function - for any positive integers ![](http://main.edu.pl/images/OI19/odl-en-tex.8.png), ![](http://main.edu.pl/images/OI19/odl-en-tex.9.png) and ![](http://main.edu.pl/images/OI19/odl-en-tex.10.png) the following hold:

the distance between a number and itself is 0: ![](http://main.edu.pl/images/OI19/odl-en-tex.11.png),                  the distance from ![](http://main.edu.pl/images/OI19/odl-en-tex.12.png) to ![](http://main.edu.pl/images/OI19/odl-en-tex.13.png) is the same as from ![](http://main.edu.pl/images/OI19/odl-en-tex.14.png) to ![](http://main.edu.pl/images/OI19/odl-en-tex.15.png): ![](http://main.edu.pl/images/OI19/odl-en-tex.16.png), and                  the triangle inequality holds: ![](http://main.edu.pl/images/OI19/odl-en-tex.17.png).

A sequence of ![](http://main.edu.pl/images/OI19/odl-en-tex.18.png) positive integers, ![](http://main.edu.pl/images/OI19/odl-en-tex.19.png), is given.

For each number ![](http://main.edu.pl/images/OI19/odl-en-tex.20.png) we have to determine ![](http://main.edu.pl/images/OI19/odl-en-tex.21.png) such that ![](http://main.edu.pl/images/OI19/odl-en-tex.22.png) and ![](http://main.edu.pl/images/OI19/odl-en-tex.23.png) is minimal.
## 输入格式

In the first line of standard input there is a single integer ![](http://main.edu.pl/images/OI19/odl-en-tex.24.png) (![](http://main.edu.pl/images/OI19/odl-en-tex.25.png)).

In the following ![](http://main.edu.pl/images/OI19/odl-en-tex.26.png) lines the numbers ![](http://main.edu.pl/images/OI19/odl-en-tex.27.png) (![](http://main.edu.pl/images/OI19/odl-en-tex.28.png)) are given,      one per line.

In tests worth 30% of total point it additionally holds that ![](http://main.edu.pl/images/OI19/odl-en-tex.29.png).

## 输出格式

Your program should print exactly ![](http://main.edu.pl/images/OI19/odl-en-tex.30.png) lines to the standard output, a single integer in each line.

The ![](http://main.edu.pl/images/OI19/odl-en-tex.31.png)-th line should give the minimum ![](http://main.edu.pl/images/OI19/odl-en-tex.32.png) such that: ![](http://main.edu.pl/images/OI19/odl-en-tex.33.png), ![](http://main.edu.pl/images/OI19/odl-en-tex.34.png) and ![](http://main.edu.pl/images/OI19/odl-en-tex.35.png) is minimal.

## 样例

### 样例输入 #1
```
6
1
2
3
4
5
6
```
### 样例输出 #1
```
2
1
1
2
1
2
```
## 题目翻译

### 题目描述
**译自 POI 2012 Stage 1. 「[Distance](https://szkopul.edu.pl/problemset/problem/Phel_x2Ny30OUh7z1RhCtzEG/site/?key=statement)」**

定义一次「操作」为将一个正整数除以或乘以一个质数。定义函数 $d(a,b)$ 表示将 $a$ 进行若干次“操作”变成 $b$ 所需要的最小操作次数。例如，$d(69,42)=3$.

$d$ 显然是一个距离函数，满足以下性质：
* $d(a,a) = 0$
* $d(a,b) = d(b,a)$
* $d(a,b) + d(b,c) \ge d(a,c)$

给定 $n$ 个正整数 $a_1, a_2, \ldots, a_n$，对每个 $a_i (1 \le i \le n)$，求 $j$ 使得 $j \neq i$ 且 $d(a_i,a_j)$ 最小。如果有多个满足条件的 $j$，应输出最小的那个。

### 输入格式

第一行一个正整数 $n (2 \le n \le 100,000)$.

第二行 $n$ 个正整数 $a_1, a_2, \ldots, a_n (1 \le a_i \le 1\ 000\ 000)$.

### 输出格式

输出 $n$ 行，每行一个整数，表示使 $j \neq i$ 且 $d(a_i,a_j)$ 最小的 $j$.

### 数据范围

对于 $30\%$ 的数据有 $n \le 1000$.

对于所有数据有 $2 \le n \le 10^5,1 \le a_i \le 10^6$.

翻译来自于 [LibreOJ](https://loj.ac/p/2690)。


---

---
title: "[POI 2014] PRZ-Criminals"
layout: "post"
diff: 省选/NOI-
pid: P3570
tag: ['2014', '线性数据结构', 'POI（波兰）', '枚举']
---
# [POI 2014] PRZ-Criminals
## 题目描述

Byteburg is a beautiful town by a river.

There are $n$ houses along the river, numbered downstream with successive integers from $1$ to $n$.

Byteburg used to be a nice quiet town in which everyone was happy.

Alas, this changed recently, as two dangerous criminals - Bitie and Bytie set up shop in it.

They did so many robberies already that the citizens are afraid to leave their houses.

Bitie and Bytie do no mere burglaries but rather whole raids: each time they leave their houses and walk towards each other, never turning back.

Bitie walks downstream (towards larger numbers) while Bytie walks upstream (towards smaller numbers).

Along the way, before they meet, each chooses several houses to break into and steal precious items    (and vital data).

After the robberies they meet in a house and divide their loot.

Byteburgers are sick of this already - they would all rather have their tranquility restored.

So they asked the detective Bythony for help.

The detective established that the bandits live in houses of the same color but he does not know which one.

Just a moment ago, an anonymous tip claimed that the robbers are on a raid.

Fearing for their own safety, the source did not say which houses will be broken into.

They did however specify their colors.

As it turns out, the bandits are quite superstitious - each of them will rob a house of each color at most once.

Bythony can wait no longer.

He intends to ambush the criminals at their meeting place.

Aid Bythony in his undertaking by writing a program to find all possible meeting places of the robbers.

## 输入格式

There are two integers in the first line of the standard input, $n$ and $k$ ($3\le n\le 1\ 000\ 000$, $1\le k\le 1\ 000\ 000$, $k\le n$),  separated by a single space, that specify the number of houses and the number of house colors  in Byteburg respectively.

The colors are number with successive integers from $1$ to $k$.

In the second line of input, there is a sequence of $n$ integers, $c_1,c_2,\cdots,c_n$ ($1\le c_i\le k$), separated by single spaces.

These are the colors of successive houses in Byteburg.

In the third line of input, there are two integers $m$ and $l$($1\le m,l\le n$,$m+l\le n-1$), separated by a single space, specifying the numbers of houses (to be) broken into by Bitie and Bytie respectively. In the fourth line of input, there are $m$ pairwise different integers $x_1,x_2,\cdots,x_m$($1\le x_i\le k$), separated by single spaces. These are the colors of houses robbed by Bitie in the order of being broken into (i.e., excluding Bitie's house). In the fifth, which is the last, line of input, there are $l$ pairwise different integers $y_1,y_2,\cdots,y_l$ ($1\le y_i\le k$), separated by single spaces. These are the colors of houses robbed by Bytie in the order of being broken into (again, these do not include Bytie's house). Moreover, $x_m=y_l$ is the color of the house in which the robbers will divide the plunder. (Clearly, they have to break into that one as well!)

## 输出格式

Your program it to print exactly two lines to the standard output.

The first of those should give the number of houses in which the criminals can meet  while respecting aforementioned constraints.

The second line should contain the increasing sequence of the numbers of those houses,  separated by single spaces.

If the robbers cannot meet at all, the first line should contain the number 0 while the second one should be empty.

## 样例

### 样例输入 #1
```
15 7
2 5 6 2 4 7 3 3 2 3 7 5 3 6 2
3 2
4 7 3
5 3

```
### 样例输出 #1
```
3
7 8 10

```
## 题目翻译

## 题目描述

两个罪犯 Bitie 和 Bytie 抢劫 $n$ 个房子，每个房子有一个颜色，Bitie 从低编号到高编号，Bytie 从高编号到低编号，直到相遇为止。已知罪犯开始时所在房子颜色相同（但不知道是什么颜色），并且知道罪犯依次抢劫的所有房子的颜色，且每个罪犯对每种颜色的房子分别最多抢劫一次，求所有可能的相遇点。

## 输入格式

第一行两个整数 $n,k$ ，分别表示房子的个数和不同的颜色数。颜色以从 $1$ 到 $k$ 的整数标号。

接下来一行有 $n$ 个整数 $c_1,c_2,...,c_n (1 \le c_i \le k)$，表示房子的颜色。

第三行有两个整数 $m,l (1 \le m,l \le n,m+l \le n-1)$，分别表示 Bitie 和 Bytie 抢劫房子的个数。

第四行有 $m$ 个两两不同的整数 $x_1, x_2, ..., x_m (1 \le x_i \le k)$，表示 Bitie 抢劫房子的颜色（不包括 Bitie 开始时所在房子的颜色）。

第五行有 $l$ 个两两不同的整数 $y_1, y_2, ..., y_l (1 \le y_i \le k)$，表示 Bytie 抢劫房子的颜色 （不包括 Bytie 开始时所在房子的颜色）。

保证 $x_m = y_l$。

## 输出格式

输出两行，第一行一个整数，表示可能相遇的房子个数，第二行升序输出可能相遇的房子编号。


---

---
title: "[USACO17JAN] Subsequence Reversal P"
layout: "post"
diff: 省选/NOI-
pid: P3607
tag: ['动态规划 DP', '2017', 'USACO', '枚举']
---
# [USACO17JAN] Subsequence Reversal P
## 题目描述

Farmer John is arranging his $N$ cows in a line to take a photo ($1 \leq N \leq 50$). The height of the $i$th cow in sequence is $a(i)$, and Farmer John thinks it would make for an aesthetically pleasing photo if the cow lineup has a large increasing subsequence of cows by height.

To recall, a subsequence is a subset $a(i_1), a(i_2), \ldots, a(i_k)$ of elements from the cow sequence, found at some series of indices $i_1 < i_2 < \ldots < i_k$. We say the subsequence is increasing if $a(i_1) \leq a(i_2) \leq \ldots \leq a(i_k)$.

FJ would like there to be a long increasing subsequence within his ordering of the cows. In order to ensure this, he allows himself initially to choose any subsequence and reverse its elements.

For example, if we had the list

```
1 6 2 3 4 3 5 3 4
```

We can reverse the chosen elements

```
1 6 2 3 4 3 5 3 4
  ^         ^ ^ ^
```
to get

```
1 4 2 3 4 3 3 5 6
  ^         ^ ^ ^
```
Observe how the subsequence being reversed ends up using the same indices as it initially occupied, leaving the other elements unchanged.

Please find the maximum possible length of an increasing subsequence, given that you can choose to reverse an arbitrary subsequence once.
## 输入格式

The first line of input contains $N$. The remaining $N$ lines contain $a(1) \ldots a(N)$, each an integer in the range $1 \ldots 50$.
## 输出格式

Output the number of elements that can possibly form a longest increasing subsequence after reversing the contents of at most one subsequence.
## 样例

### 样例输入 #1
```
9
1
2
3
9
5
6
8
7
4
```
### 样例输出 #1
```
9

```
## 题目翻译

### 题目描述

Farmer John 正在将他的 $N$ 头奶牛排成一列拍照（$1 \leq N \leq 50$）。序列中第 $i$ 头奶牛的高度为 $a(i)$，Farmer John 认为如果奶牛队列中存在一个较长的按高度递增的子序列，那么这张照片会更具美感。

回顾一下，子序列是指从奶牛序列中选出的一组元素 $a(i_1), a(i_2), \ldots, a(i_k)$，这些元素位于一系列索引 $i_1 < i_2 < \ldots < i_k$ 处。如果满足 $a(i_1) \leq a(i_2) \leq \ldots \leq a(i_k)$，则称该子序列是递增的。

FJ 希望在他的奶牛排列中存在一个较长的递增子序列。为了确保这一点，他允许自己最初选择任意一个子序列并将其元素反转。

例如，如果我们有以下序列：

```
1 6 2 3 4 3 5 3 4
```

我们可以反转选中的元素：

```
1 6 2 3 4 3 5 3 4
  ^         ^ ^ ^
```

得到：

```
1 4 2 3 4 3 3 5 6
  ^         ^ ^ ^
```

注意被反转的子序列最终仍然使用最初占据的索引，而其他元素保持不变。

请找出在最多反转一个子序列的情况下，可能的最长递增子序列的长度。

### 输入格式

输入的第一行包含 $N$。接下来的 $N$ 行包含 $a(1) \ldots a(N)$，每个数均为 $1$ 到 $50$ 之间的整数。

### 输出格式

输出在最多反转一个子序列后，可能形成的最长递增子序列的元素个数。


---

---
title: "[APIO2007] 动物园"
layout: "post"
diff: 省选/NOI-
pid: P3622
tag: ['2007', 'APIO', '枚举', '深度优先搜索 DFS', '状压 DP']
---
# [APIO2007] 动物园
## 题目描述

新建的圆形动物园是亚太地区的骄傲。圆形动物园坐落于太平洋的一个小岛上，包含一大圈围栏，每个围栏里有一
种动物。如下图所示：

![](https://cdn.luogu.com.cn/upload/image_hosting/8pr43p86.png)

你是动物园的公共主管。你要做的是，让每个来动物园的人都尽可能高兴。今天有一群小朋友来动物园参观，你希望能让他们在动物园度过一段美好的时光。但这并不是一件容易的事——有的动物有一些小朋友喜欢，有的动物有一些小朋友害怕。如，Alex 喜欢可爱的猴子和考拉，而害怕拥牙齿锋利的狮子。而 Polly 会因狮子有美丽的鬃毛而喜欢它，但害怕有臭味的考拉。你可以选择将一些动物从围栏中移走以使得小朋友不会害怕。但你不能移走太多动物，否则小朋友们就没有动物可看了。每个小朋友站在大围栏圈的外面，可以看到连续的 $5$ 个围栏。你得到了所有小朋友喜欢和害怕的动物信息。当下面两处情况之一发生时，小朋友就会高兴：
- 至少有一个他害怕的动物被移走
- 至少有一个他喜欢的动物没被移走

例如，考虑下图中的小朋友和动物：

![](https://cdn.luogu.com.cn/upload/image_hosting/n69iqfv6.png)

- 假如你将围栏 $4$ 和 $12$ 的动物移走。Alex 和 Ka-Shu 将很高兴，因为至少有一个他们害怕的动物被移走了。这也会使 Chaitanya 高兴，因为他喜欢的围栏  $6$ 和 $8$ 中的动物都保留了。但是，Polly 和 Hwan 将不高兴，因为他们看不到任何他们喜欢的动物，而他们害怕的动物都还在。这种安排方式使得三个小朋友高兴。
- 现在，换一种方法，如果你将围栏 $4$ 和 $6$ 中的动物移走，Alex 和 Polly 将很高兴，因为他们害怕的动物被移走了。Chaitanya 也会高兴，虽然他喜欢的动物 $6$ 被移走了，他仍可以看到围栏 $8$ 里面他喜欢的动物。同样的 Hwan 也会因可以看到自己喜欢的动物 $12$ 而高兴。唯一不高兴的只有 Ka-Shu。
- 如果你只移走围栏 $13$ 中的动物，Ka-Shu 将高兴，因为有一个他害怕的动物被移走了，Alex, Polly, Chaitanya 和 Hwan 也会高兴，因为他们都可以看到至少一个他们喜欢的动物。所以有 $5$ 个小朋友会高兴。这种方法使得了最多的小朋友高兴。
## 输入格式

输入的第一行包含两个整数 $N$，$C$，用空格分隔。

$N$ 是围栏数（$10 \le N \le 10^4$），$C$ 是小朋友的个数（$1 \le C \le 5\times 10^4$）。

围栏按照顺时针的方向编号为 $1,2,3,\cdots,N$。

接下来的 $C$ 行，每行描述一个小朋友的信息，以下面的形式给出： $E, F, L ,X_1, X_2 ,\cdots ,X_F ,Y_1 ,Y_2 ,\cdots ,Y_L$。 

其中： $E$ 表示这个小朋友可以看到的第一个围栏的编号（$1 \le E \le N$），换句话说，该小朋友可以看到的围栏为 $E$， $E+1$， $E+2$， $E+3$， $E+4$。

注意，如果编号超过 $N$ 将继续从 $1$ 开始算。

如：当 $N=14$，$ E=13$ 时，这个小朋友可以看到的围栏为 $13,14,1, 2$ 和 $3$。

$F$ 表示该小朋友害怕的动物数。

$L$ 表示该小朋友喜欢的动物数。

围栏 $X_1, X_2, \cdots, X_F$ 中包含该小朋友害怕的动物。

围栏 $Y_1, Y_2, \cdots, Y_L$ 中包含该小朋友喜欢的动物。 

$X_1, X_2, \cdots, X_F, Y_1, Y_2, \cdots, Y_L$ 是两两不同的整数，而且所表示的围栏都是该小朋友可以看到的。

小朋友已经按照他们可以看到的第一个围栏的编号从小到大的顺序排好了（这样最小的 $E$ 对应的小朋友排在第一个，最大的 $E$ 对应的小朋友排在最后一个）。

注意可能有多于一个小朋友对应的 $E$ 是相同的。
## 输出格式

仅输出一个数，表示最多可以让多少个小朋友高兴。

## 样例

### 样例输入 #1
```
14 5 
2 1 2 4 2 6 
3 1 1 6 4 
6 1 2 9 6 8
8 1 1 9 12 
12 3 0 12 13 2 
```
### 样例输出 #1
```
5
```
### 样例输入 #2
```
12 7 
1 1 1 1 5 
5 1 1 5 7 
5 0 3 5 7 9 
7 1 1 7 9 
9 1 1 9 11 
9 3 0 9 11 1
11 1 1 11 1
```
### 样例输出 #2
```
6
```
## 提示

**数据范围**
对于 $100\%$ 的数据，$10 \le N \le 10^4$，$1 \le C \le 5\times 10^4$，$1 \le E \le N$。

**样例说明**
- 第一个样例是题目描述中的例子，所有的 $C=5$ 个小朋友都能高兴。
- 第二个样例是一个不能使得所有 $C=7$ 个小朋友都高兴的例子。


---

---
title: "[APIO2008] DNA"
layout: "post"
diff: 省选/NOI-
pid: P3624
tag: ['2008', 'APIO', '枚举', '前缀和']
---
# [APIO2008] DNA
## 题目描述

分析如DNA序列这样的生命科学数据是计算机的一个有趣应用。从生物学的角度上说，DNA是一种由腺嘌呤、胞嘧啶、鸟嘌呤和胸腺嘧啶这四种核苷酸组成的链式结构。这四种核苷酸分别用大写字母A、C、G、T表示。这样，一条DNA单链可以被表示为一个只含以上四种字符的字符串。我们将这样的字符串称作一个DNA序列。

有时生物学家可能无法确定一条DNA单链中的某些核苷酸。在这种情况下，字符N将被用来表示一个不确定的核苷酸。换句话说，N可以用来表示A、C、G、T中的任何一个字符。我们称包含一个或者多个N的DNA序列为未完成序列；反之，就称作完成序列。如果一个完成序列可以通过将一个未完成序列中的个N任意替换成A、C、G、T得到的话，就称完成序列适合这个未完成序列。举例来说，ACCCT适合ACNNT，但是AGGAT不适合。

研究者们常按照如下方式排序四种核苷酸：A优先于C，C优先于G，G优先于T。如果一个DNA序列中的个核苷酸都与其右边的相同或者优先，就将其归类为范式-1。举例来说，AACCGT是范式-1，但是AACGTC不是。

一般来说，一个DNA序列属于范式-j(j>1)，只要它属于范式-(j-1)或者是一个范式-(j-1)和一个范式-1的连接。举例来说，AACCC、ACACC和ACACA都是范式-3，但GCACAC和ACACACA不是。

同样，研究者们按照字典序对DNA序列进行排序。按照这个定义，最小的属于范式-3的DNA序列是AAAAA，最大的是TTTTT。这里是另外一个例子，考虑未完成序列ACANNCNNG。那么前7个适合这个未完成序列的DNA序列是：
```
ACAAACAAG
ACAAACACG
ACAAACAGG
ACAAACCAG
ACAAACCCG
ACAAACCGG
ACAAACCTG
```
## 输入格式

输入第一行包含三个由空格隔开的整数：M(1≤M≤50,000)，K(1≤K≤10)和 R(1≤R≤2×$10^{12}$)。

第二行包含一个长度为 M 的字符串，表示未完成序列。

保证适 合该未完成序列的范式-K 的总数不超过 4×10^18，因此该数可以用 C 和 C++中的 long long 类型或者 Pascal 中的 Int64 类型表示。同时，R 不会超过适合给定未完 成序列的范式-K 的总数。

## 输出格式

 在第一行中输出第R个适合输入中的未完成序列的范式-K。
## 样例

### 样例输入 #1
```
9 3 5 
ACANNCNNG
```
### 样例输出 #1
```
ACAAACCCG
```
### 样例输入 #2
```
5 4 10 
ACANN
```
### 样例输出 #2
```
ACAGC 
```


---

---
title: "[APIO2010] 信号覆盖"
layout: "post"
diff: 省选/NOI-
pid: P3630
tag: ['2010', 'APIO', 'Special Judge', '枚举', '排序']
---
# [APIO2010] 信号覆盖
## 题目描述

一家电信公司正在北京城搭建一个 GSM 网络。城市里共有 n 个房子需要被 信号覆盖。由于经费的限制，电信公司只能安装一个天线。 这里将每个房子用一个点坐标来表示。为了简化天线的放置，电信公司将会 选择其中的 3 个房子作一个外接圆，然后将天线放在圆的中心，所有位于这个圆 内或者圆的边界上的房子都将被天线的信号所覆盖。 电信公司将会随机选择城市中的 3 个房子来搭建天线，他们想知道在所有可 能放置天线的方案中平均会有多少个房子被信号覆盖。 例如，假设共有 4 个房子 A, B, C, D，它们的位置如下图：

  ![](https://cdn.luogu.com.cn/upload/pic/4405.png) 

如果我们选择ABC或者BCD三个点搭建的外接圆，所有的房子都会被覆盖。 如果我们选择 ACD 或者 ABD，剩下的房子将不会在天线的信号覆盖范围内。因 此平均有(4 + 4 + 3 + 3) / 4 = 3.50 个房子被信号覆盖。 给定所有房子的位置，你的任务是计算平均有多少个房子被信号覆盖。假定 每一个房子都有一个二维的整数坐标，并且保证任何三个房子都不在同一条直线 上，任何四个房子都不在同一个圆上。

## 输入格式

输入第一行包含一个正整数 n, 表示房子的总数。接下来有 n 行，分别表示 每一个房子的位置。对于 i = 1, 2, .., n, 第 i 个房子的坐标用一对整数 xi和 yi来表 示，中间用空格隔开。

## 输出格式

输出文件包含一个实数，表示平均有多少个房子被信号所覆盖，需保证输出 结果与精确值的绝对误差不超过 0.01。

## 样例

### 样例输入 #1
```
4
0 2 
4 4 
0 0 
2 0
```
### 样例输出 #1
```
3.500 
```
## 提示

【样例说明】

3.5, 3.50, 3.500, … 中的任何一个输出均为正确。此外，3.49, 3.51, 3.499999，…等也都是可被接受的输出。

【数据范围】

100%的数据保证，对于 i = 1, 2, .., n, 第 i 个房子的坐标(xi, yi)为整数且 –1,000,000 ≤ xi, yi ≤ 1,000,000. 任何三个房子不在同一条直线上，任何四个房子不 在同一个圆上；

40%的数据，n ≤ 100；

70%的数据，n ≤ 500；

100%的数据，3 ≤ n ≤ 1,500。



---

---
title: "[APIO2011] 方格染色"
layout: "post"
diff: 省选/NOI-
pid: P3631
tag: ['数学', '2011', '并查集', 'APIO', '枚举', '位运算']
---
# [APIO2011] 方格染色
## 题目描述

Sam 和他的妹妹 Sara 有一个包含 $n \times m$ 个方格的表格。他们想要将其中的每个方格都染成红色或蓝色。出于个人喜好，他们想要表格中每个 $2 \times 2$ 的方形区域都包含奇数个（ $1$ 个或 $3$ 个）红色方格。例如，下面是一个合法的表格染色方案（`R` 代表红色，`B` 代表蓝色）：
```
B B R B R
R B B B B
R R B R B
```
可是昨天晚上，有人已经给表格中的一些方格染上了颜色！现在 Sam 和 Sara 非常生气。不过，他们想要知道是否可能给剩下的方格染上颜色，使得整个表格依然满足他们的要求。如果可能的话，满足他们要求的染色方案数有多少呢？
## 输入格式

输入的第一行包含三个整数 $n,m,k$，分别代表表格的行数，列数和已被染色的方格数目。

之后的 $k$ 行描述已被染色的方格。其中第i行包含三个整数 $x_i,y_i,c_i$，分表代表第 $i$ 个已被染色的方格的行编号、列编号和颜色。$c_i$ 为 $1$ 表示方格被染成红色，$c_i$ 为 $0$ 表示方格被染成蓝色。
## 输出格式

输出一个整数，表示可能的染色方案数 $w$ 对于 $10^9$ 取模后得到的值。

## 样例

### 样例输入 #1
```
3 4 3
2 2 1
1 2 0
2 3 1
```
### 样例输出 #1
```
8
```
## 提示

对于 $20\%$ 的测试数据，$n,m,k \leqslant 5$。

对于 $50\%$ 的测试数据，$n,m \leqslant 5000$，$k \leqslant 25$。

对于 $100\%$ 的测试数据，$2 \leqslant n,m \leqslant 10^5$，$0 \leqslant k \leqslant 10^5$，$1 \leqslant x_i \leqslant n$，$1 \leqslant y_i \leqslant m$，$\forall c_i \in \{0,1\}$。


---

---
title: "[APIO2015] 雅加达的摩天楼"
layout: "post"
diff: 省选/NOI-
pid: P3645
tag: ['2015', 'APIO', '枚举', '最短路', '分块']
---
# [APIO2015] 雅加达的摩天楼
## 题目描述

印尼首都雅加达市有 $N$ 座摩天楼，它们排列成一条直线，我们从左到右依次将它们编号为 $0$ 到 $N − 1$。除了这 $N$ 座摩天楼外，雅加达市没有其他摩天楼。

有 $M$ 只叫做 “doge” 的神秘生物在雅加达市居住，它们的编号依次是 $0$ 到 $M − 1$。编号为 $i$ 的 doge 最初居住于编号为 $B_i$ 的摩天楼。每只 doge 都有一种神秘的力量，使它们能够在摩天楼之间跳跃，编号为 $i$ 的 doge 的跳跃能力为 $P_i$ （$P_i > 0$）。

在一次跳跃中，位于摩天楼 $b$ 而跳跃能力为 $p$ 的 doge 可以跳跃到编号为 $b - p$ （如果 $0 \leq b - p < N$）或 $b + p$ （如果 $0 \leq b + p < N$）的摩天楼。

编号为 $0$ 的 doge 是所有 doge 的首领，它有一条紧急的消息要尽快传送给编号为 $1$ 的 doge。任何一个收到消息的 doge 有以下两个选择:

- 跳跃到其他摩天楼上；
- 将消息传递给它当前所在的摩天楼上的其他 doge。

请帮助 doge 们计算将消息从 $0$ 号 doge 传递到 $1$ 号 doge 所需要的最少总跳跃步数，或者告诉它们消息永远不可能传递到 $1$ 号 doge。

## 输入格式

输入的第一行包含两个整数 $N$ 和 $M$。

接下来 $M$ 行，每行包含两个整数 $B_i$ 和 $P_i$。

## 输出格式

输出一行，表示所需要的最少步数。如果消息永远无法传递到 $1$ 号 doge，输出 $−1$。

## 样例

### 样例输入 #1
```
5 3
0 2
1 1
4 1
```
### 样例输出 #1
```
5
```
## 提示

【样例解释】

下面是一种步数为 $5$ 的解决方案：

$0$ 号 doge 跳跃到 $2$ 号摩天楼，再跳跃到 $4$ 号摩天楼（$2$ 步）。

$0$ 号 doge 将消息传递给 $2$ 号 doge。

$2$ 号 doge 跳跃到 $3$ 号摩天楼,接着跳跃到 $2$ 号摩天楼，再跳跃到 $1$ 号摩天楼（$3$ 步）。

$2$ 号 doge 将消息传递给 $1$ 号 doge。

【数据范围】

所有数据都保证 $0 \leq B_i < N$。

子任务 1 （10 分）$1 \leq N \leq 10$

$1 \leq P_i \leq 10$

$2 \leq M \leq 3$


子任务 2 （12 分）$1 \leq N \leq 100$

$1 \leq P_i \leq 100$

$2 \leq M \leq 2000$


子任务 3 （14 分）$1 \leq N \leq 2000$

$1 \leq P i ≤ 2000$

$2 \leq M \leq 2000$


子任务 4 （21 分）$1 \leq N \leq 2000$

$1 \leq P_i \leq 2000$

$2 \leq M \leq 30000$


子任务 5 （43 分）$1 \leq N \leq 30000$

$1 \leq P_i \leq 30000$

$2 \leq M \leq 30000$



---

---
title: "[APIO2015] 巴厘岛的雕塑"
layout: "post"
diff: 省选/NOI-
pid: P3646
tag: ['动态规划 DP', '贪心', '2015', 'APIO', '枚举', '进制', '位运算']
---
# [APIO2015] 巴厘岛的雕塑
## 题目描述

印尼巴厘岛的公路上有许多的雕塑,我们来关注它的一条主干道。

在这条主干道上一共有 $N$ 座雕塑，为方便起见，我们把这些雕塑从 $1$ 到 $N$ 连续地进行标号，其中第 $i$ 座雕塑的年龄是 $Y_i$ 年。为了使这条路的环境更加优美，政府想把这些雕塑分成若干组，并通过在组与组之间种上一些树，来吸引更多的游客来巴厘岛。

下面是将雕塑分组的规则：

这些雕塑必须被分为恰好 $X$ 组，其中 $A \leq X \leq B$，每组必须含有至少一个雕塑，每个雕塑也必须属于且只属于一个组。同一组中的所有雕塑必须位于这条路的连续一段上。

当雕塑被分好组后，对于每个组，我们首先计算出该组所有雕塑的年龄和。

计算所有年龄和按位取或的结果。我们这个值把称为这一分组的最终优美度。

请问政府能得到的最小的最终优美度是多少?

备注：将两个非负数 $P$ 和 $Q$ 按位取或是这样进行计算的：

首先把 $P$ 和 $Q$ 转换成二进制。

设 $n_P$ 是 $P$ 的二进制位数，$n_Q$ 是 $Q$ 的二进制位数，$M$ 为 $n_P$ 和 $n_Q$ 中的最大值。$P$ 的二进制表示为 $p_{M-1}p_{M-2} \dots p_1p_0$，$Q$ 的二进制表示为 $q_{M-1}q_{M-2} \dots q_1 q_0$，其中 $p_i$ 和 $q_i$ 分别是 $P$ 和 $Q$ 二进制表示下的第 $i$ 位，第 $M -1$ 位是数的最高位，第 $0$ 位是数的最低位。

$P$ 与 $Q$ 按位取或后的结果是： $(p_{M-1}\mathbin{\mathrm{OR}} q_{M-1})(p_{M-2}\mathbin{\mathrm{OR}}q_{M-2})\dots (p_1\mathbin{\mathrm{OR}} q_1) (p_0\mathbin{\mathrm{OR}}q_0)$。其中：$0 \mathbin{\mathrm{OR}} 0 = 0$

$0 \mathbin{\mathrm{OR}} 1 = 1$

$1 \mathbin{\mathrm{OR}} 0 = 1$

$1 \mathbin{\mathrm{OR}} 1 = 1$

## 输入格式

输入的第一行包含三个用空格分开的整数 $N, A, B$。

第二行包含 $N$ 个用空格分开的整数 $Y_1, Y_2, \dots, Y_N$。

## 输出格式

输出一行一个数，表示最小的最终优美度。

## 样例

### 样例输入 #1
```
6 1 3
8 1 2 1 5 4
```
### 样例输出 #1
```
11

```
## 提示

【样例解释】

将这些雕塑分为 $2$ 组，$(8, 1, 2)$ 和 $(1, 5, 4)$，它们的和是 $(11)$ 和 $(10)$，最终优美度是 $(11 \mathbin{\mathrm{OR}} 10) = 11$。（不难验证，这也是最终优美度的最小值。）

【数据范围】

子任务 1 （9 分）$1 \leq N \leq 20$

$1 \leq A \leq B \leq N$

$0 \leq Y_i \leq 1000000000$


子任务 2 （16 分）$1 \leq N \leq 50$

$1 \leq A \leq B \leq \min\{20, N\}$

$0 \leq Y_i \leq 10$


子任务 3 （21 分）$1 ≤ N ≤ 100$

$A = 1$

$1 \leq B \leq N$

$0 \leq Y_i \leq 20$


子任务 4 （25 分）$1 \leq N \leq 100$

$1 \leq A \leq B \leq N$

$0 \leq Y_i \leq 1000000000$


子任务 5 （29 分）$1 \leq N \leq 2000$

$A = 1$

$1 \leq B \leq N$

$0 \leq Y_i \leq 1000000000$



---

---
title: "[APIO2014] 连珠线"
layout: "post"
diff: 省选/NOI-
pid: P3647
tag: ['动态规划 DP', '2014', 'APIO', '枚举']
---
# [APIO2014] 连珠线
## 题目描述

在达芬奇时代，有一个流行的儿童游戏称为连珠线。当然，这个游戏是关于珠子和线的。线是红色或蓝色的，珠子被编号为 $1$ 到 $n$。这个游戏从一个珠子开始，每次会用如下方式添加一个新的珠子：

`Append(w, v)`：一个新的珠子 $w$ 和一个已经添加的珠子 $v$ 用红线连接起来。

`Insert(w, u, v)`：一个新的珠子 $w$ 插入到用红线连起来的两个珠子 $u, v$ 之间。具体过程是删去 $u, v$ 之间红线，分别用蓝线连接 $u, w$ 和 $w, v$。

每条线都有一个长度。游戏结束后，你的最终得分为蓝线长度之和。

给你连珠线游戏结束后的游戏局面，只告诉了你珠子和链的连接方式以及每条线的长度，没有告诉你每条线分别是什么颜色。

你需要写一个程序来找出最大可能得分。即，在所有以给出的最终局面结束的连珠线游戏中找出那个得分最大的，然后输出最大可能得分。

## 输入格式

第一行一个正整数 $n$，表示珠子的数量。珠子从 $1$ 到 $n$ 编号。

接下来 $n - 1$ 行每行三个整数 $a_i, b_i, c_i$。保证 $1 \leq a_i < b_i \leq n$。$1 \leq c_i \leq 10000$。表示 $a_i$ 号珠子和 $b_i$ 号珠子间连了长度为 $c_i$ 的线。

## 输出格式

输出一个整数，表示最大可能得分。

## 样例

### 样例输入 #1
```
5
1 2 10
1 3 40
1 4 15
1 5 20
```
### 样例输出 #1
```
60
```
### 样例输入 #2
```
10
4 10 2
1 2 21
1 3 13
6 7 1
7 9 5
2 4 3
2 5 8
1 6 55
6 8 34
```
### 样例输出 #2
```
140
```
## 提示

【样例描述1】

可以通过如下方式获得 $60$ 分：首先从 $3$ 号珠子开始。

把 $5$ 和 $3$ 连起来。（线长度任意）

在 $3$ 和 $5$ 之间插入 $1$。（线长分别为 $40$ 和 $20$）。

把 $2$ 和 $1$ 用长度为 $10$ 的线连起来。

把 $4$ 和 $1$ 用长度为 $15$ 的线连起来。


【限制与约定】

第一个子任务共 13 分，满足 $1 \leq n \leq 10$。

第二个子任务共 15 分，满足 $1 \leq n \leq 200$。

第三个子任务共 29 分，满足 $1 \leq n \leq 10000$。

第四个子任务共 43 分，满足 $1 \leq n \leq 200000$。



---

---
title: "[APIO2014] 序列分割"
layout: "post"
diff: 省选/NOI-
pid: P3648
tag: ['2014', 'APIO', 'Special Judge', '枚举', '斜率优化', '前缀和']
---
# [APIO2014] 序列分割
## 题目描述

你正在玩一个关于长度为 $n$ 的非负整数序列的游戏。这个游戏中你需要把序列分成 $k + 1$ 个非空的块。为了得到 $k + 1$ 块，你需要重复下面的操作 $k$ 次：

选择一个有超过一个元素的块（初始时你只有一块，即整个序列）

选择两个相邻元素把这个块从中间分开，得到两个非空的块。

每次操作后你将获得那两个新产生的块的元素和的乘积的分数。你想要最大化最后的总得分。

## 输入格式

第一行包含两个整数 $n$ 和 $k$。保证 $k + 1 \leq n$。

第二行包含 $n$ 个非负整数 $a_1, a_2, \cdots, a_n$ $(0 \leq a_i \leq 10^4)$，表示前文所述的序列。

## 输出格式

第一行输出你能获得的最大总得分。

第二行输出 $k$ 个介于 $1$ 到 $n - 1$ 之间的整数，表示为了使得总得分最大，你每次操作中分开两个块的位置。第 $i$ 个整数 $s_i$ 表示第 $i$ 次操作将在 $s_i$ 和 $s_{i} + 1$ 之间把块分开。

如果有多种方案使得总得分最大，输出任意一种方案即可。

## 样例

### 样例输入 #1
```
7 3
4 1 3 4 0 2 3
```
### 样例输出 #1
```
108
1 3 5
```
## 提示

你可以通过下面这些操作获得 $108$ 分：

初始时你有一块 $(4, 1, 3, 4, 0, 2, 3)$。在第 $1$ 个元素后面分开，获得 $4 \times (1 + 3 + 4 + 0 + 2 + 3) = 52$ 分。

你现在有两块 $(4), (1, 3, 4, 0, 2, 3)$。在第 $3$ 个元素后面分开，获得 $(1 + 3) \times (4 + 0 + 2 + 3) = 36$ 分。

你现在有三块 $(4), (1, 3), (4, 0, 2, 3)$。在第 $5$ 个元素后面分开，获得 $(4 + 0) \times (2 + 3) = 20$ 分。

所以，经过这些操作后你可以获得四块 $(4), (1, 3), (4, 0), (2, 3)$ 并获得 $52 + 36 + 20 = 108$ 分。

限制与约定

第一个子任务共 11 分，满足 $1 \leq k < n \leq 10$。

第二个子任务共 11 分，满足 $1 \leq k < n \leq 50$。

第三个子任务共 11 分，满足 $1 \leq k < n \leq 200$。

第四个子任务共 17 分，满足 $2 \leq n \leq 1000, 1 \leq k \leq \min\{n - 1, 200\}$。

第五个子任务共 21 分，满足 $2 \leq n \leq 10000, 1 \leq k \leq \min\{n - 1, 200\}$。

第六个子任务共 29 分，满足 $2 \leq n \leq 100000, 1 \leq k \leq \min\{n - 1, 200\}$。

感谢@larryzhong  提供的加强数据



---

---
title: "小清新数学题"
layout: "post"
diff: 省选/NOI-
pid: P3653
tag: ['O2优化', '枚举', '素数判断,质数,筛法', '前缀和']
---
# 小清新数学题
## 题目背景

**本题时限 3s**

友情提示：https://www.luogu.com.cn/problem/P3601

## 题目描述

题目还是简单一点好。


我们定义莫比乌斯函数 $\mu(x)$，如果 $x$ 的每个素因子只出现一次，有 $p$ 个素因子，那么 $\mu(x)=(-1)^p$，否则 $\mu(x)=0$。


这题要求你求出 $\sum_{i=l}^r \mu(i)$。

## 输入格式

一行两个整数 $l,r$。

## 输出格式

一行一个整数表示答案。

## 样例

### 样例输入 #1
```
1 233
```
### 样例输出 #1
```
-1
```
### 样例输入 #2
```
99999999999899999 99999999999999999
```
### 样例输出 #2
```
421
```
## 提示

对于 $10\%$ 的数据，$l,r \leq 10^6$。

对于 $30\%$ 的数据，$l,r \leq 10^{12}$。

对于 $100\%$ 的数据，$1 \leq l \leq r \leq 10^{18}$，$r-l \leq 10^5$。



---

---
title: "[USACO17FEB] Why Did the Cow Cross the Road II P"
layout: "post"
diff: 省选/NOI-
pid: P3657
tag: ['2017', 'USACO', '树状数组', '离散化', '枚举']
---
# [USACO17FEB] Why Did the Cow Cross the Road II P
## 题目背景

*本题与 [金组同名题目](/problem/P6119) 在题意上一致，唯一的差别是数据范围。*
## 题目描述

Farmer John 饲养了 $N$ 种奶牛，编号从 $1$ 到 $N$。一些品种的奶牛和其他奶牛间相处良好，事实证明，如果两个品种的奶牛编号分别为 $a,b$，当 $|a-b| \leq 4$ 时，这两个品种的奶牛能友好相处，否则不能友好相处。

一条长长的道路贯穿整个农场，道路的左侧有 $N$ 个牧场（每个品种的奶牛恰好占据一个牧场），道路的右侧也有 $N$ 个牧场（每个品种的奶牛恰好占据一个牧场）。为了让奶牛们安全穿过马路，Farmer John 希望能在马路上画出一些人行道（牛行道？），要求这些人行道满足如下条件：

1. 人行道从左侧的某个牧场出发，连接到右侧的某个牧场；
2. 人行道连接的两个牧场的奶牛要能友好相处；
3. 人行道不能在道路中间相交；
4. 每个牧场只能与一条人行道相连。

你需要帮 FJ 求出最多能有多少条人行道。
## 输入格式

输入第一行一个整数 $N$（$1 \leq N \leq 10^5$）。

接下来 $N$ 行，每行一个整数 $a_i$，代表道路左侧第 $i$ 个牧场的奶牛品种编号。

接下来 $N$ 行，每行一个整数 $b_i$，代表道路右侧第 $i$ 个牧场的奶牛品种编号。
## 输出格式

输出最多能画多少条人行道。
## 样例

### 样例输入 #1
```
6
1
2
3
4
5
6
6
5
4
3
2
1
```
### 样例输出 #1
```
5

```


---

---
title: "小清新签到题"
layout: "post"
diff: 省选/NOI-
pid: P3672
tag: ['动态规划 DP', '贪心', '洛谷原创', 'O2优化', '枚举', '前缀和', '洛谷月赛']
---
# 小清新签到题
## 题目描述

题目还是简单一点好。

给定自然数 $n$、$k$、$x$，你要求出第 $k$ 小的长度为 $n$ 的逆序对对数为 $x$ 的 $1\sim n$ 的排列 $a_1,a_2 ... a_n$ ~~，然后用仙人图上在线分支定界启发式带花树上下界最小费用流解决问题~~，保证存在。

注：逆序对为满足 $i<j$、$a_i>a_j$ 的 $(i,j)$。比较为字典序比较，即比较从前往后第一个不同的位置。第 $k$ 小从 $1$ 开始标号。一个 $1\sim n$ 的排列定义为一个长度为 $n$ 的数列，排序完可以得到 $1\sim n$。

## 输入格式

一行三个自然数 $n$、$k$、$x$。

## 输出格式

输出满足条件的排列，一行n个数，用空格分隔。

## 样例

### 样例输入 #1
```
3 2 2
```
### 样例输出 #1
```
3 1 2
```
### 样例输入 #2
```
10 6 4
```
### 样例输出 #2
```
1 2 3 4 5 7 6 10 9 8
```
### 样例输入 #3
```
50 233 233
```
### 样例输出 #3
```
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 32 50 49 48 47 46 45 44 43 42 41 40 39 38 37 36 33 35 34 31 30 29 28
```
### 样例输入 #4
```
50 233333333 333
```
### 样例输出 #4
```
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 43 49 50 47 46 45 48 44 41 42 40 39 37 38 36 35 34 33 32 30 29 31 28 25 26 27 24
```
## 提示

对于 $10\%$ 的数据，$n \leq 8$。

对于 $30\%$ 的数据，$n \leq 10$。

对于 $50\%$ 的数据，$n \leq 50$。

对于另外 $20\%$ 的数据，$k=1$。

对于 $100\%$ 的数据，$1 \leq n \leq 300$，$1 \leq k \leq 10^{13}$，保证存在符合题意的排列。



---

---
title: "小清新计数题"
layout: "post"
diff: 省选/NOI-
pid: P3673
tag: ['洛谷原创', 'O2优化', '枚举', '生成树', '基环树', '洛谷月赛']
---
# 小清新计数题
## 题目描述

小 A 正在电脑上玩一个叫做 Truth or Lie 的游戏。

游戏开始时电脑会给出 $n$ 句话，每句话形如“第 $x$ 句话为真”或“第 $x$ 句话为假”，其中 $x$ 是一个 $1$ 到 $n$ 的整数，你只要选择“Good”或者“Bad”，“Good”表示可以决定每句话的真假使每句话的内容都成立，“Bad”反之。

作为一个菜鸡，小 A 只会不停地点“Good”，靠脸过关。

在无数次失败后，非洲人小 A 发现游戏每关中，每句话包含的是“真”还是“假”是固定的，但是每句话中的 $x$ 是在 $1$ 到 $n$ 均匀随机的。

现在小 A 告诉了你某一关每句话的真假，用一个 $01$ 序列表示。第 $i$ 位为 $0$ 表示第 $i$ 句话包含“假”，否则表示包含“真”。现在他想要知道使得点击“Good”正确的方案数。

由于方案数可能比较大，你需要输出方案数对 $998244353$ 取模的结果。

（读不懂题的请移步样例解释）
## 输入格式

一行一个 $01$ 序列，它的长度即为 $n$。
## 输出格式

输出方案数对 $998244353$ 取模的结果。
## 样例

### 样例输入 #1
```
01
```
### 样例输出 #1
```
1
```
### 样例输入 #2
```
10101
```
### 样例输出 #2
```
1154
```
### 样例输入 #3
```
10101101010111110100110100101010110001010010101001
```
### 样例输出 #3
```
322173207
```
## 提示

### 样例解释

第一句话的内容为“某句话为假”，第二句话的内容为“某句话为真”。所有可能情况如下：

1. 第一句话的内容为“第一句话为假”，第二句话的内容为“第一句话为真”，结果应为 Bad。

2. 第一句话的内容为“第一句话为假”，第二句话的内容为“第二句话为真”，结果应为 Bad。

3. 第一句话的内容为“第二句话为假”，第二句话的内容为“第一句话为真”，结果应为 Bad。

4. 第一句话的内容为“第二句话为假”，第二句话的内容为“第二句话为真”，结果应为 Good，因为只需认为第一句话为假，第二句话为真就符合两句话，所以是 Good。

所以共有一种合法方案。

### 数据范围

- 对于$10\%$ 的数据，$n \leq 7$；
- 对于$20\%$ 的数据，$n \leq 9$；
- 对于$60\%$ 的数据，$n \leq 20$；
- 对于$100\%$ 的数据，$1 \leq n \leq 50$。



---

---
title: "小清新人渣的本愿"
layout: "post"
diff: 省选/NOI-
pid: P3674
tag: ['莫队', '洛谷原创', 'O2优化', '枚举', '洛谷月赛']
---
# 小清新人渣的本愿
## 题目背景

**本题时限3s，空间128MB**

我感觉我要挂省选

人渣的本愿是一个有趣的番

可爱的花火喜欢从小和她谈♂笑♂风♂生的欧♂尼♂酱鸣海，欧尼酱特别想当老师，然后剧本安排当了花火的班主任。

然而有个叫做皆川茜的奇怪的人抢走了欧尼酱！

花火就很失落呀，然后看到一个叫做麦的人也很失落，原来麦喜欢茜老师。。。

花火和麦从此天天谈笑风生，然后决定在一起，把对方当做自己喜欢的人的替代品

因为花火很可爱，所以有许多奇怪的人喜欢花火，比如一个叫做绘鸠早苗的妹子

因为麦长的也不错，所以有许多奇怪的人喜欢麦，比如一个叫做最可的妹子

然后就开始愉快的生♂活了~

以上内容如果你没有看过这个番可以无视掉


按照套路，现在欧尼酱会问花火一个OI问题（一般是数据结构），然后花火肯定不会OI，所以会来请教您这位IOI Au选手，然后您肯定会帮助她

但是
这个套路太无聊了，我们来换一个（但是不会改变您是IOI Au选手的事实）

花火有一天看了几个有趣的番，叫做“在W??身上寻找女装是否搞错了什么”，“从女装开始的?X?”，“我家大佬不可能那么可爱”，然后发现??H太厉害了，然后就穿越到了异世界，和???谈笑风生

花火就和???做了一个交♂易，花火帮???做一道题，然后???帮花火改写地球online的程序，让花火和欧尼酱在♂一♂起

???虽然非常厉害，但是不会数据结构题，他最近刚刚遇到一道有趣的数据结构题，于是他接受了交易

但是花火也不会数据结构题呀

所以又回到了这个老套路，就靠您这个IOI Au选手来帮她了！

以上内容如果你没有看过这个番还是可以无视掉

这里用一个经典的图来解释这个关系（其实没那么蛋疼的）

![](https://cdn.luogu.com.cn/upload/pic/4628.png)

## 题目描述

这个题是这样的：

给你一个序列 $a$，长度为 $n$，有 $m$ 次操作，每次询问一个区间是否可以选出两个数它们的差为 $x$，或者询问一个区间是否可以选出两个数它们的和为 $x$，或者询问一个区间是否可以选出两个数它们的乘积为 $x$ ，这三个操作分别为操作 $1,2,3$。

选出的这两个数可以是同一个位置的数。

![](https://cdn.luogu.com.cn/upload/pic/4629.png)

## 输入格式

第一行两个数 $n,m$。

后面一行 $n$ 个数表示 $a_i$。

后面 $m$ 行每行四个数 `opt l r x`。

$opt$ 表示这个是第几种操作，$l,r$ 表示操作的区间，$x$ 表示这次操作的 $x$。
## 输出格式

对于每个询问，如果可以，输出 `hana`，否则输出 `bi`。

## 样例

### 样例输入 #1
```
10 10
1 1 8 9 9 1 1 1 1 9 
3 5 9 42
2 1 3 14
2 3 5 2
2 3 3 6
1 6 10 18
3 4 9 14
2 1 4 22
3 1 3 32
2 5 6 32
3 1 9 17
```
### 样例输出 #1
```
bi
bi
bi
bi
bi
bi
bi
bi
bi
bi

```
### 样例输入 #2
```
5 5
1 1 2 3 4
2 1 1 2
1 1 2 2
3 1 1 1
3 5 5 16
1 2 3 4
```
### 样例输出 #2
```
hana
bi
hana
hana
bi
```
## 提示

定义 $c$ 为每次的 $x$ 和 $a_i$ 中的最大值，$a_i \geq 0$，每次的 $x\geq 2$。

对于 $10\%$ 的数据，$n,m,c \leq 100$。

对于另外 $10\%$ 的数据，$n,m,c \leq 3\times 10^3$。

对于另外 $10\%$ 的数据，只有 $1$ 操作。

对于另外 $10\%$ 的数据，只有 $2$ 操作。
 
对于另外 $10\%$ 的数据，只有 $3$ 操作。

对于 $100\%$ 的数据，$n,m,c \leq 10^5$。

![](https://cdn.luogu.com.cn/upload/pic/4630.png)



---

---
title: "[ZJOI2017] 仙人掌"
layout: "post"
diff: 省选/NOI-
pid: P3687
tag: ['2017', '各省省选', '浙江', 'O2优化', '枚举', '仙人掌']
---
# [ZJOI2017] 仙人掌
## 题目描述

如果一个**无自环无重边无向连通图**的任意一条边最多属于一个简单环，我们就称之为仙人掌。所谓简单环即不经过重复的结点的环。

 ![](https://cdn.luogu.com.cn/upload/pic/4742.png) 

现在九条可怜手上有一张**无自环无重边的无向连通图**，但是她觉得这张图中的边数太少了，所以她想要在图上连上一些新的边。同时为了方便的存储这张无向图，图中的边数又不能太多。经过权衡，她想要加边后得到的图为一棵仙人掌。

不难发现合法的加边方案有很多，可怜想要知道总共有多少不同的加边方案。

两个加边方案是不同的当且仅当一个方案中存在一条另一个方案中没有的边。

## 输入格式

多组数据，第一行输入一个整数 $T$ 表示数据组数。

每组数据第一行输入两个整数 $n$,$m$，表示图中的点数与边数。

接下来 m 行，每行两个整数 $u$,$v$(1 ≤ $u$,$v$ ≤ $n$,$u$ ≠ $v$) 表示图中的一条边。保证输入的图联通且没有自环与重边。

## 输出格式

对于每组数据，输出一个整数表示方案数，当然方案数可能很大，请对 998244353 取模后输出。

## 样例

### 样例输入 #1
```
2
3 2
1 2
1 3
5 4
1 2
2 3
2 4
1 5
```
### 样例输出 #1
```
2
8
```
## 提示

**样例说明**

对于第一组样例合法加边的方案有 {},{(2,3)}，共 2 种。

**时空限制**

时间限制1s，空间限制512M。

**数据范围**

![](https://cdn.luogu.com.cn/upload/pic/4743.png)



---

---
title: "琪露诺的冰雪小屋"
layout: "post"
diff: 省选/NOI-
pid: P3693
tag: ['模拟', '洛谷原创', '枚举', '广度优先搜索 BFS', '连通块']
---
# 琪露诺的冰雪小屋
## 题目背景

琪露诺有一片正方形的雪地，她想在上面盖一栋小冰屋。

## 题目描述

琪露诺偶然间得到了一片 $N\times N$ 大小的正方形的雪地，她想在上面盖一栋冰雪小屋。

但调皮的⑨才不会认真地收集冰块呢，她要在这片土地上使用冰雪弹幕来制造冰砖，然后一块一块地搭起一个房子。

琪露诺制造冰砖的方式是这样的：她会站在某个方格上，然后向上，下，左，右，左上，左下，右上，右下这八个方向之一发射强力的冰雪弹幕，弹幕能影响到该方向一条直线上一定的距离以内的所有方格。

地面的每个方格都有一个冷冻度，初始为 $0$。被冰雪弹幕影响一次，冷冻度 $+1$，冷冻度的上限为 $4$。

在发射弹幕的间隙中，琪露诺会来到所有冷冻度为 $4$ 的格子，把那里的雪堆到一起，制作一个冰砖（大小为 $1\times1\times1$ 方格），并且将冷冻度重新归零。

琪露诺会拿着这些冰砖来盖房子。这个房子的长度、宽度和坐落位置她在一开始就已经规划好了，但她并不愿意提早确定房子的高度。

琪露诺是这样计划的：这个房子外观上看起来是一个长方体。

她会先盖起这个房子的四面墙（厚度为 $1$ 个方格），并在贴近地面的位置（废话）留一个宽度和高度分别为 $1$ 和 $2$ 的空位不放冰砖，作为房门。（显然，门无法开在墙的拐角处，但可以紧贴拐角）。

在她喜欢的时候，她会结束四面墙的建造，并一次性在墙顶部盖上一个厚度为 $1$ 方格的屋顶，使房子成为一个空心有顶的长方体。

计划已经非常充分了，但琪露诺还是不放心，所以她想请你帮她写一个程序，来随时提醒着她别出什么差错。这个程序需要具备的功能将在下文详细介绍。

----------------------
雪地由 $N$ 行 $N$ 列，$N\times N$ 个方格组成。（下标从 $0$ 开始，也就是说，存在第 $0$ 行第 $0$ 列，但不存在第 $N$ 行第 $N$ 列）每个方格都有一个冷冻度,范围 $[0,4]$，初始为 $0$。注意，空间是三维的，而冷冻度只是地面的属性。

琪露诺想将房子的左上角放在第 $H_R$行，$H_C$ 列（外墙也是房子的一部分，因此左上角位置不应该是房子的内部,而是外墙,并且是墙的拐角）。

这个房子的长度（平行于每列）是 $H_X$，宽度（平行于每行）是 $H_Y$，包含墙。保证房子所占空间不会超出雪地的范围。

除了最后搭建屋顶，琪露诺只会在高度 $[0,H_M-1]$ 放置冰砖。

一开始，琪露诺一个冰砖也没有。
在以下的介绍中，我们用俯视图来作示意：
```plain
0000
0000
4x90
0x01
```
数字代表当前该格子的冷冻度。如果位置紧贴地面（高度为 $0$）的地方放上了冰砖，那么用字母 $x$ 表示。

如果紧贴地面的位置没有冰砖，但是位置正上方的高空存在冰砖，那么仍然用数字表示地面的冷冻度，但这个数字会增加 $5$。即如果在示意图中看到了一个数字 $t\ge5$，表示该位置地面是空的，但高处有冰砖，且地面的冷冻度为 $t-5$。

第一个操作：`ICE_BARRAGE R C D S`  
---------------
表示琪露诺站在第 $R$ 行 $C$ 列的位置，朝着方向 $D$ 发射了一个强度为 $S$ 的弹幕。  
$R,C,D,S\in\mathbf{Z},0\le D\le7,0\le R,C,S<N$。  
方向编号 $0$ 表示上 $(R-1,C)$，$1$ 表示左上 $(R-1,C-1)$，   
$2$ 表示左 $(R,C-1)$，$3$ 表示左下 $(R+1,C-1)$，  
$4$ 表示下 $(R+1,C)$，$5$ 表示右下 $(R+1,C+1)$，  
$6$ 表示右 $(R,C+1)$，$7$ 表示右上 $(R-1,C+1)$。  
强度为 $S$ 的弹幕，可以使“处在发射方向直线上，距离琪露诺不超过 $S$ 格的所有格子（包括她站的格子）”的冷冻度都 $+1$。有以下几种特殊情况：

1. 如果某个格子冷冻度为 $4$，那么该格子冷冻度不变。
2. 如果弹幕所经路途上，有一个位置的地面上（高度为 $0$）已经放了冰砖（就是弹幕撞上了琪露诺已经盖了一半的房子），那么弹幕将被阻挡，无法影响到冰砖所在的格子以及冰砖后面被挡住的格子。
3. 弹幕超出雪地的部分忽略不计。

对于这个操作，需要如下输出一行：`CIRNO FREEZED k BLOCK(S)`  
如果这个弹幕将某个方格的冷冻度成功增加了 $1$，那么认为这个弹幕冻住了该方格。

`k` 表示这个弹幕总共冻住了多少方格。

如图：发射弹幕前地图如下：
```plain
00000
00000
00000
000x0
00000
```
执行操作 `ICE_BARRAGE 1 1 5 4`，地图变为：
```plain
00000
01000
00100
000x0
00000
```
输出：`CIRNO FREEZED 2 BLOCK(S)`  
解释：琪露诺站在第一行第一列，面对右下角发射了一个强度为 $4$ 的弹幕，但弹幕被 `x` 所阻挡，只能影响到 `x` 之前的格子。

第二个操作：`MAKE_ICE_BLOCK`  
-------------------------
琪露诺走遍地图上所有冷冻度为 $4$ 的方格，每个方格可以收集一个冰砖，然后将它们的冷冻度归零。 

对于这个操作，你需要给出如下输出一行：`CIRNO MADE x ICE BLOCK(S),NOW SHE HAS y ICE BLOCK(S)`  
表示琪露诺制造了 $x$ 个冰砖，目前她有 $y$ 个冰砖。  
比如琪露诺一开始有 $0$ 个冰砖，并且状态如下：
```plain
0xxx
0x4x
0x9x
0400
```
执行操作 `MAKE_ICE_BLOCK` 后变为
```plain
0xxx
0x0x
0x5x
0000
```
输出：`CIRNO MADE 3 ICE BLOCK(S),NOW SHE HAS 3 ICE BLOCK(S)`  
在这个示例中，房子已经完成了一部分，`x` 表示墙，`9` 这个位置地面没有冰砖，但高处有（可以猜出是门）。房间内唯一一块空地、门的位置，以及房间外的一个位置的冷冻度都达到了 $4$，因此可以收集到 $3$ 块冰砖，收集后将三个位置冷冻度都归零。

第三个操作：`PUT_ICE_BLOCK R C H` 
-----------------
表示在第 $R$ 行，第 $C$ 列，高度为 $H$ 的地方放一个冰砖。$0\le R,C<N,0\le H<H_M$。

贴近地面的位置高度为 $0$。如果冰砖放置成功，那么琪露诺库存的冰砖数量将减 $1$。

如果放置的位置贴近地面，该位置冷冻度立即归 $0$。

有以下几种情况，序号越小优先级越高，并且只能满足一种情况。

如果满足 $1$ 的话就忽视后面的，不满足 $1$ 的前提下才可能满足 $2\cdots\cdots$ 以此类推。

1. 琪露诺目前没有任何冰砖，无法放置。这种情况下你需要输出：`CIRNO HAS NO ICE_BLOCK`
2. 冰砖将放在半空中，无法依附其他任何冰砖，或者目标位置已有冰砖了。  
这种情况下你需要输出一行：`BAKA CIRNO,CAN'T PUT HERE`，并无视此次操作，不做任何工作。
3. 冰砖放在了规划建造房子的区域之外，即
$R<H_R$ 或 $R>H_R+H_x-1$  
或 $C<H_C$ 或 $C>H_C+H_Y-1$。请输出一行：`CIRNO MISSED THE PLACE`  
尽管琪露诺放错了地方，但你并不能阻止她放置这个冰砖。  
4. 冰砖留在了房子的内部，本应留空的地方被占用了，即  
$H_R+1\le R\le H_R+H_X-2$ 且 $H_C+1\le C\le H_C+H_Y-2$  
在屋顶的高度固定下来前，我们将所有满足上式的情况都认为是放在了房屋内部。  
请输出一行：`CIRNO PUT AN ICE_BLOCK INSIDE THE HOUSE`  
尽管琪露诺放错了地方，但你并不能阻止她放置这个冰砖。
5. 冰砖放在了正确的位置（不必考虑是否堵住了留给门的地方）  
请输出一行：`CIRNO SUCCESSFULLY PUT AN ICE_BLOCK,NOW SHE HAS x ICE_BLOCK(S)`  
`x` 表示放过这块冰砖后琪露诺剩余的冰砖。

第四个操作：`REMOVE_ICE_BLOCK R C H` 
---------
表示取走第 $R$ 行，第 $C$ 列，高度为 $H$ 处的冰砖。  
有以下几种情况，序号越小优先级越高，并且只能满足一种情况。

如果满足 $1$ 的话就忽视后面的，不满足 $1$ 的前提下才可能满足 $2\cdots\cdots$ 以此类推。

1. 目标位置没有冰砖，输出一行：`BAKA CIRNO,THERE IS NO ICE_BLOCK`
2. 目标位置有冰砖，并且在这个冰砖被移走后，至少有一个冰砖形成了一个悬空的块。  
如下面的“侧视图”，`x` 表示冰砖，`0` 表示空位。
```plain
xxxx
x000
x000
x000
```
$\ \ $在移走左上角的冰砖后，第一行右边三个冰砖没有了依靠，形成了一个悬空的连通块，就属于这种情况。  
$\ \ $这个冰砖将成功移走，琪露诺的冰砖库存将会 $+1$。并且所有的悬空连通块都会掉下来摔碎并消失  
$\ \ $（既不会进入冰砖库存，也不会在地面上留有任何痕迹）。  
$\ \ $输出一行：`CIRNO REMOVED AN ICE_BLOCK,AND k BLOCK(S) ARE BROKEN`，`k` 表示摔碎的冰砖数量。  
3. 琪露诺挪走了冰砖，并且其他冰砖不受任何影响。    
$\ \ \ $琪露诺的冰砖库存 $+1$，输出一行：`CIRNO REMOVED AN ICE_BLOCK`
    
第五个操作：`MAKE_ROOF` 
--------
这个操作只会出现一次，并且只会作为最后一个操作。  
这个操作表明琪露诺已经完成了冰雪小屋的四墙，只剩屋顶了！  

一般情况下，琪露诺将放置最后的 $H_X\times H_Y$ 个冰砖，把它们放置在墙壁最高的高度 $+1$ 的那一层，  
形成一个屋顶。然后她移除所有多余的冰砖，接下来补好所有残缺的墙壁。

你需要按顺序来执行整个过程，一旦遇到某种用 $\bullet$ 标识的特殊情况，则执行完该情况后退出流程。

在特殊情况之间所描述的均为一般情况，只要之前没有因为满足某种特殊情况而退出流程，均认为满足了一般情况。

首先，琪露诺将会一次性放置最多 $H_X\times H_Y$ 个冰砖来建造屋顶。

为什么是最多呢？请注意一点：如果之前错误放置在房子内部的冰砖恰好充当了屋顶的一部分，那么就不用在这个位置再放冰砖了。并且，所有比屋顶高的冰砖在之后将视为错误放置在了房子外部。

注意，放屋顶的时候可能会触及到高度为 $H_M$ 的那个平面。

建造屋顶前后将会碰到两种特殊情况：
- 琪露诺剩余的冰砖不足以建造屋顶。输出一行：`SORRY CIRNO,NOT ENOUGH ICE_BLOCK(S) TO MAKE ROOF`
- 墙壁的最高高度小于 $2$ 个方格，或者内部有效空间小于两个方格。  
墙壁所在的一圈不算内部空间。计算内部有效空间时请忽视错误放置的冰砖，因为它们将来要被移除。  
输出一行：`SORRY CIRNO,HOUSE IS TOO SMALL`

（特殊情况结束）

此后，我们认为琪露诺已经造好了屋顶，接下来该移除所有多余冰砖了。在移除过程中，琪露诺会尽可能让更少的冰砖摔碎。如果墙壁上某个冰砖因为移走了多余的冰砖而将要摔碎，那么她会先拆掉墙壁上的那个冰砖，然后在填补墙壁残缺时重新补回来（显然，这种行为不会影响到墙壁有无残缺的定性，但可以少损失一个冰砖）。她不会故意拆掉一个处在墙壁上且不会摔碎的冰砖。  
输出两行：  
`K1 ICE_BLOCK(S) INSIDE THE HOUSE NEED TO BE REMOVED`  
`K2 ICE_BLOCK(S) OUTSIDE THE HOUSE NEED TO BE REMOVED`  
`K1`表示房子内部错误放置的冰砖数量，`K2`表示房子外部错误放置的冰砖数量。

将有可能遭遇一种特殊情况：
- 琪露诺移除了所有多余的冰砖，但在移除过程中，屋顶塌陷了。  
输出一行：`SORRY CIRNO,HOUSE IS BROKEN WHEN REMOVING BLOCKS`

（特殊情况结束）

此后，我们认为琪露诺已经移除了所有多余的冰砖，接下来该填补墙壁的残缺了。

墙壁有残缺的定义是：除了宽为 $1$，高为 $2$ 的门以外，
在房子内部看外面还能看到其他缺口。

如果某个空位将来要作为门的一部分，则不属于残缺。并且房子只能有一个门。

如果墙壁没有残缺，则不要填补，否则需要填补。你需要记下墙壁是否有残缺，之后会用到。

填补的策略是：使用尽可能少的冰砖，在正确的位置填补墙壁，使房屋的状态不满足墙壁有残缺的定义（即不能放置多余的冰砖，通过遮挡视线来达到目的）。在此定义下，**大多数**情况我们无需考虑四角的柱子是否完整，因为在房间里看不到。

将有可能遭遇一种特殊情况：
- 琪露诺剩余的冰砖不足以填补墙壁的残缺。  
输出一行：`SORRY CIRNO,NOT ENOUGH ICE_BLOCKS TO FIX THE WALL`

（特殊情况结束）

此后，我们认为房子被成功建成了，这时你需要输出几行内容来对房子进行评价。

首先输出这么一行来庆祝房子的建成：`GOOD JOB CIRNO,SUCCESSFULLY BUILT THE HOUSE`  
1. 在贴近地面的位置找不到一个宽度为 $1$，高度为 $2$ 的位置留给门。  
	输出一行：`HOUSE HAS NO DOOR`，然后琪露诺会尽可能利用墙壁上的残缺来开一个门。  
    否则，输出一行：`DOOR IS OK`
2. 接下来输出一行表示填补之前墙壁的完整程度  
	2.1. 在之前的记录中，墙壁不完整而需要修补。输出：`WALL NEED TO BE FIXED`  
    2.2. 在之前的记录中，墙壁完整而无需修补。输出：`WALL IS OK`  
3. 接下来一行表示四角的完整程度。  
	如果四个角的柱子有不完整的地方，就输出：`CORNER NEED TO BE FIXED`  
    在这种情况下，如果琪露诺剩余的冰砖足够修复拐角的空缺，那么她直接会修复这个空缺。  
    如果不够的话，她会再多收集几个冰砖，数量恰好修复这个空缺，然后修复这个空缺。  
    否则，输出：`CORNER IS OK`
    
接下来，输出一行：`CIRNO FINALLY HAS k ICE_BLOCK(S)`  
`k` 表示琪露诺最后剩余的冰砖的数量。

最后，如果在之前的记录中，墙壁完整无缺，没有一个位置需要填补。房子内外都无任何多余的方块，没有一个位置需要移除。没有出现房子没门的情况，房子四角的柱子也在造屋顶前完全造好，而不是通过修补完善的。并且门恰好开在了某面墙的正中央（如果长度为偶数，中间的两个都算），输出一行：   
`CIRNO IS PERFECT!`
## 输入格式

第一行一个正整数 $N$，表示雪地的大小。

第二行一个正整数$H_M$，表示琪露诺放置方块的最大高度。

第三行四个正整数 $H_R,H_C,H_X,H_Y$，表示房子左上角位置的行列坐标，房子的长度以及宽度。

第四行一个正整数 $M$，表示操作的数量。

接下来 $M$ 行，每行表示一个操作，输入格式见题目描述。
## 输出格式

在题目描述中已经介绍。

## 样例

### 样例输入 #1
```
8
10
4 0 4 4
63
ICE_BARRAGE 2 1 1 3
ICE_BARRAGE 0 1 3 1
MAKE_ICE_BLOCK
PUT_ICE_BLOCK 3 2 0
ICE_BARRAGE 1 0 6 7
ICE_BARRAGE 2 0 6 7
ICE_BARRAGE 3 0 6 7
ICE_BARRAGE 4 0 6 7
ICE_BARRAGE 1 0 6 7
ICE_BARRAGE 1 0 6 7
ICE_BARRAGE 1 0 6 7
ICE_BARRAGE 1 0 6 7
MAKE_ICE_BLOCK
PUT_ICE_BLOCK 4 0 1
PUT_ICE_BLOCK 4 0 0
PUT_ICE_BLOCK 4 0 1
PUT_ICE_BLOCK 3 0 1
REMOVE_ICE_BLOCK 4 0 1
PUT_ICE_BLOCK 4 2 0
PUT_ICE_BLOCK 6 1 0
PUT_ICE_BLOCK 4 3 0
PUT_ICE_BLOCK 5 3 0
PUT_ICE_BLOCK 6 3 0
PUT_ICE_BLOCK 7 3 0
ICE_BARRAGE 0 1 4 7
ICE_BARRAGE 1 0 6 7
ICE_BARRAGE 1 0 6 7
ICE_BARRAGE 1 0 6 7
ICE_BARRAGE 1 0 6 7
MAKE_ICE_BLOCK
ICE_BARRAGE 1 0 6 7
ICE_BARRAGE 1 0 6 7
ICE_BARRAGE 1 0 6 7
ICE_BARRAGE 1 0 6 7
MAKE_ICE_BLOCK
ICE_BARRAGE 1 0 6 7
ICE_BARRAGE 1 0 6 7
ICE_BARRAGE 1 0 6 7
ICE_BARRAGE 1 0 6 7
MAKE_ICE_BLOCK
ICE_BARRAGE 1 0 6 7
ICE_BARRAGE 1 0 6 7
ICE_BARRAGE 1 0 6 7
ICE_BARRAGE 1 0 6 7
MAKE_ICE_BLOCK
REMOVE_ICE_BLOCK 6 1 0
PUT_ICE_BLOCK 5 0 0
PUT_ICE_BLOCK 6 0 0
PUT_ICE_BLOCK 7 0 0
PUT_ICE_BLOCK 7 1 0
PUT_ICE_BLOCK 7 2 0
PUT_ICE_BLOCK 4 0 1
PUT_ICE_BLOCK 5 0 1
PUT_ICE_BLOCK 6 0 1
PUT_ICE_BLOCK 7 0 1
PUT_ICE_BLOCK 7 1 1
PUT_ICE_BLOCK 7 2 1
PUT_ICE_BLOCK 7 3 1
PUT_ICE_BLOCK 6 3 1
PUT_ICE_BLOCK 5 3 1
PUT_ICE_BLOCK 4 3 1
PUT_ICE_BLOCK 4 2 1
MAKE_ROOF

```
### 样例输出 #1
```
CIRNO FREEZED 2 BLOCK(S)
CIRNO FREEZED 2 BLOCK(S)
CIRNO MADE 0 ICE BLOCK(S),NOW SHE HAS 0 ICE BLOCK(S)
CIRNO HAS NO ICE_BLOCK
CIRNO FREEZED 8 BLOCK(S)
CIRNO FREEZED 8 BLOCK(S)
CIRNO FREEZED 8 BLOCK(S)
CIRNO FREEZED 8 BLOCK(S)
CIRNO FREEZED 8 BLOCK(S)
CIRNO FREEZED 7 BLOCK(S)
CIRNO FREEZED 7 BLOCK(S)
CIRNO FREEZED 0 BLOCK(S)
CIRNO MADE 8 ICE BLOCK(S),NOW SHE HAS 8 ICE BLOCK(S)
BAKA CIRNO,CAN'T PUT HERE
CIRNO SUCCESSFULLY PUT AN ICE_BLOCK,NOW SHE HAS 7 ICE_BLOCK(S)
CIRNO SUCCESSFULLY PUT AN ICE_BLOCK,NOW SHE HAS 6 ICE_BLOCK(S)
CIRNO MISSED THE PLACE
CIRNO REMOVED AN ICE_BLOCK,AND 1 BLOCK(S) ARE BROKEN
CIRNO SUCCESSFULLY PUT AN ICE_BLOCK,NOW SHE HAS 5 ICE_BLOCK(S)
CIRNO PUT AN ICE_BLOCK INSIDE THE HOUSE
CIRNO SUCCESSFULLY PUT AN ICE_BLOCK,NOW SHE HAS 3 ICE_BLOCK(S)
CIRNO SUCCESSFULLY PUT AN ICE_BLOCK,NOW SHE HAS 2 ICE_BLOCK(S)
CIRNO SUCCESSFULLY PUT AN ICE_BLOCK,NOW SHE HAS 1 ICE_BLOCK(S)
CIRNO SUCCESSFULLY PUT AN ICE_BLOCK,NOW SHE HAS 0 ICE_BLOCK(S)
CIRNO FREEZED 6 BLOCK(S)
CIRNO FREEZED 8 BLOCK(S)
CIRNO FREEZED 8 BLOCK(S)
CIRNO FREEZED 8 BLOCK(S)
CIRNO FREEZED 7 BLOCK(S)
CIRNO MADE 8 ICE BLOCK(S),NOW SHE HAS 8 ICE BLOCK(S)
CIRNO FREEZED 8 BLOCK(S)
CIRNO FREEZED 8 BLOCK(S)
CIRNO FREEZED 8 BLOCK(S)
CIRNO FREEZED 8 BLOCK(S)
CIRNO MADE 8 ICE BLOCK(S),NOW SHE HAS 16 ICE BLOCK(S)
CIRNO FREEZED 8 BLOCK(S)
CIRNO FREEZED 8 BLOCK(S)
CIRNO FREEZED 8 BLOCK(S)
CIRNO FREEZED 8 BLOCK(S)
CIRNO MADE 8 ICE BLOCK(S),NOW SHE HAS 24 ICE BLOCK(S)
CIRNO FREEZED 8 BLOCK(S)
CIRNO FREEZED 8 BLOCK(S)
CIRNO FREEZED 8 BLOCK(S)
CIRNO FREEZED 8 BLOCK(S)
CIRNO MADE 8 ICE BLOCK(S),NOW SHE HAS 32 ICE BLOCK(S)
CIRNO REMOVED AN ICE_BLOCK
CIRNO SUCCESSFULLY PUT AN ICE_BLOCK,NOW SHE HAS 32 ICE_BLOCK(S)
CIRNO SUCCESSFULLY PUT AN ICE_BLOCK,NOW SHE HAS 31 ICE_BLOCK(S)
CIRNO SUCCESSFULLY PUT AN ICE_BLOCK,NOW SHE HAS 30 ICE_BLOCK(S)
CIRNO SUCCESSFULLY PUT AN ICE_BLOCK,NOW SHE HAS 29 ICE_BLOCK(S)
CIRNO SUCCESSFULLY PUT AN ICE_BLOCK,NOW SHE HAS 28 ICE_BLOCK(S)
CIRNO SUCCESSFULLY PUT AN ICE_BLOCK,NOW SHE HAS 27 ICE_BLOCK(S)
CIRNO SUCCESSFULLY PUT AN ICE_BLOCK,NOW SHE HAS 26 ICE_BLOCK(S)
CIRNO SUCCESSFULLY PUT AN ICE_BLOCK,NOW SHE HAS 25 ICE_BLOCK(S)
CIRNO SUCCESSFULLY PUT AN ICE_BLOCK,NOW SHE HAS 24 ICE_BLOCK(S)
CIRNO SUCCESSFULLY PUT AN ICE_BLOCK,NOW SHE HAS 23 ICE_BLOCK(S)
CIRNO SUCCESSFULLY PUT AN ICE_BLOCK,NOW SHE HAS 22 ICE_BLOCK(S)
CIRNO SUCCESSFULLY PUT AN ICE_BLOCK,NOW SHE HAS 21 ICE_BLOCK(S)
CIRNO SUCCESSFULLY PUT AN ICE_BLOCK,NOW SHE HAS 20 ICE_BLOCK(S)
CIRNO SUCCESSFULLY PUT AN ICE_BLOCK,NOW SHE HAS 19 ICE_BLOCK(S)
CIRNO SUCCESSFULLY PUT AN ICE_BLOCK,NOW SHE HAS 18 ICE_BLOCK(S)
CIRNO SUCCESSFULLY PUT AN ICE_BLOCK,NOW SHE HAS 17 ICE_BLOCK(S)
0 ICE_BLOCK(S) INSIDE THE HOUSE NEED TO BE REMOVED
0 ICE_BLOCK(S) OUTSIDE THE HOUSE NEED TO BE REMOVED
GOOD JOB CIRNO,SUCCESSFULLY BUILT THE HOUSE
DOOR IS OK
WALL IS OK
CORNER IS OK
CIRNO FINALLY HAS 1 ICE_BLOCK(S)
CIRNO IS PERFECT!

```
## 提示

共分为 $6$ 个 **Subtask**，每个 **Subtask** 的数据都满足一定条件，并且同时满足序号更大的 **Subtask** 的条件。  
如 **Subtask #0** 同时满足 **Subtask #0~5** 的条件。  
每一个 **Subtask** 的得分取所有测试点的最低分。

**Subtask #0** $20\%$  
琪露诺只想玩玩冰雪弹幕，她不会放置任何冰砖，也不会盖房子(即只有操作一和操作二)。  


**Subtask #1** $10\%$  
琪露诺不会移除已经放置的冰砖。

**Subtask #2** $20\%$  
琪露诺很有信心，她将在没有 `MAKE_ROOF` 的情况下建造她的冰屋(这种情况下，放置方块的高度仍然会小于 $H_M$ 且没有 `MAKE_ROOF` 操作)。

**Subtask #3** $20\%$  
琪露诺在移除方块时会谨慎考虑,不会造成任何冰砖摔落。`MAKE_ROOF` 操作移除多余冰砖时，也不会造成屋顶塌陷。

**Subtask #4** $20\%$  
琪露诺不喜欢把门开到四角的柱子旁边(数据保证在所有可能作为门的墙壁空缺中，有一种可能使得门不紧贴四角的柱子)。 

**Subtask #5** $10\%$  
$4\le N\le 16$，$5\le H_M\le 20$，$10\le M\le 10^3$，保证不属于冰屋范围内的所有空地至多构成一个连通块。

注意：判断墙壁是否有残缺时，候选的开门位如果被方块堵住，在当时还未被清空。"能看到残缺"以当时的情况作为判断依据。


---

---
title: "[SDOI2017] 数字表格"
layout: "post"
diff: 省选/NOI-
pid: P3704
tag: ['2017', '各省省选', '山东', 'O2优化', '枚举', '莫比乌斯反演', '分块']
---
# [SDOI2017] 数字表格
## 题目背景

Doris 刚刚学习了 fibonacci 数列。用 $f_i$ 表示数列的第 $i$ 项，那么

$$f_0=0,f_1=1$$

$$f_n=f_{n-1}+f_{n-2},n\geq 2$$
## 题目描述

Doris 用老师的超级计算机生成了一个 $n\times m$ 的表格，

第 $i$ 行第 $j$ 列的格子中的数是 $f_{\gcd(i,j)}$，其中 $\gcd(i,j)$ 表示 $i,j$ 的最大公约数。


Doris 的表格中共有 $n\times m$ 个数，她想知道这些数的乘积是多少。

答案对 $10^9+7$ 取模。

## 输入格式

**本题单个测试点内有多组测试数据**。

输入的第一行是一个整数 $T$，表示测试数据的组数。

接下来 $T$ 行，每行两个整数 $n, m$，表示一组数据。
## 输出格式

对于每组数据，输出一行一个整数表示答案。
## 样例

### 样例输入 #1
```
3
2 3
4 5
6 7
```
### 样例输出 #1
```
1
6
960
```
## 提示

#### 数据规模与约定

- 对于 $10\%$ 的数据，保证 $n,m\leq 10^2$。
- 对于 $30\%$ 的数据，保证 $n,m\leq 10^3$。
- 另有 $30\%$ 的数据，保证 $T\leq 3$。
- 对于 $100\%$ 的数据，保证 $1 \leq T\leq 10^3$，$1\leq n,m\leq 10^6$。



---

---
title: "方方方的数据结构"
layout: "post"
diff: 省选/NOI-
pid: P3710
tag: ['线段树', '平衡树', '洛谷原创', 'O2优化', '枚举', '分块', '洛谷月赛']
---
# 方方方的数据结构
## 题目描述

在很久很久以前，有一个长度为 $n$ 的数列，一开始数列全是 $0$。

方方方觉得这个数列太单调了，打算对它进行 $m$ 次操作，每次操作为区间加法或者区间乘法。

方方方进行一些操作之后，还可能会对某个数进行询问。

但是进行过一些操作之后，方方方可能会发现之前某次操作失误了，需要撤销这次操作，其它操作和其它操作的前后顺序保持不变。

方方方想好这些操作之后，马上想到了一个优秀的数据结构可以维护这些东西，可是他懒得写标程了，就生成了 $10$ 个**随机数据**，就把这道题扔给了你。

**数据全是随机的，生成方式见最下方的提示。**

## 输入格式

第一行两个数 $n,m$，表示数列的长度和操作个数。

接下来 $m$ 行每行 $2$ 或 $4$ 个数。

1. 如果第一个数为 $1$，接下来跟三个数 $l,r,d$，表示把区间 $[l,r]$ 中的数加上 $d$。
2. 如果第一个数为 $2$，接下来跟三个数 $l,r,d$，表示把区间 $[l,r]$ 中的数乘上 $d$。
3. 如果第一个数为 $3$，接下来跟一个数 $p$，表示询问 $p$ 位置的数 $\bmod\ 998244353$。
4. 如果第一个数为 $4$，接下来跟一个数 $p$，表示将第 $p$ 行输入的操作撤销（保证为加或者乘操作，一个操作不会被撤销两次）。

## 输出格式

对于每个 $3$ 操作输出一行表示答案。

## 样例

### 样例输入 #1
```
6 14
1 1 5 1
2 2 4 3
1 2 6 5
3 2
4 1
3 3
2 1 3 4
3 3
1 2 2 3
3 2
4 7
3 1
3 2
3 3
```
### 样例输出 #1
```
8
5
20
23
0
8
5
```
## 提示

对于 $20\%$ 的数据，$n,m \leq 500$，时限 1s。

对于 $50\%$ 的数据，$n,m \leq 30000$，时限 1s。

对于 $100\%$ 的数据，$1 \leq n,m \leq 150000$，$1 \le l \le r \le n$，$3$ 操作的 $p$ 满足 $1 \le p \le n$，$4$ 操作的 $p$ 满足 $1 \le p \le m$，$0 \leq d \leq 1073741823$（原因见数据生成器），时限 4.5s。


数据生成器：

```cpp
#include <bits/stdc++.h>
using namespace std;
int rand_() {return rand()&32767;} 
int br() {return rand_()*32768+rand_();}
vector<int> cs;
int main()
{
    srand(...); //这里要填一个种子 
    int n=...,m=...; //这里要填n、m
    cout<<n<<" "<<m<<"\n";
    for(int i=1;i<=m;i++)
    {
        int o=rand()%4+1;
        if(o<=2)
        {
            cout<<o<<" ";
            int l=br()%n+1,r=br()%n+1;
            if(l>r) swap(l,r); cs.push_back(i);
            cout<<l<<" "<<r<<" "<<br()<<"\n";
        }
        else if(o==3) cout<<o<<" "<<br()%n+1<<"\n";
        else
        {
            if(!cs.size()) {--i; continue;}
            int s=br()%cs.size(),g=cs[s];
            cs.erase(cs.begin()+s);
            cout<<o<<" "<<g<<"\n";
        }
    }
}
```


---

---
title: "曼哈顿计划E"
layout: "post"
diff: 省选/NOI-
pid: P3727
tag: ['点分治', '洛谷原创', '枚举', '分治', '深度优先搜索 DFS']
---
# 曼哈顿计划E
## 题目背景

1942 年 6 月，美国开始实施利用核裂变反应来研制原子弹的计划，亦称曼哈顿计划。后来两颗原子弹在广岛和长崎爆炸，世界见证了核武器的威力，并在它的威胁下颤抖不已。2200 年，dedsec 组织利用美国军方的网络安全漏洞渗入了美国的和武器系统，并密谋使用隐藏在曼哈顿的核武器储备毁灭世界。然而 dedsec 的一名成员 Badboy17 反对这一计划，她把这一计划告知了艾登。为了拯救他的家人，避免地球变为废土，艾登不得不再次发挥他的黑客能力拯救世界。

![](https://cdn.luogu.com.cn/upload/pic/5119.png)

## 题目描述

艾登尝试黑入 dedsec 的系统并取得控制权，然而 dedsec 有所反应并予以反击。

dedsec 的网络可以看做是一个 $n$ 个点 $n-1$ 条边的连通图（一棵树），每个节点有一个稳定值。

艾登可以选择网络中上的一条链，并对那一条链上的节点进行破解（把这一条链从树上拆下来）。

假设这一条链长度为 $m$，现在你会得到 $m$ 个节点。

然后艾登要和 dedsec 开始攻防战，双方轮流行动，每次可以从任意一个稳定值大于 $0$ 的节点里依照计算规则进行一些操作，操作后，稳定值不能小于 $0$，否则计算机会爆炸，最后不能进行操作的一方算作失败

由于 dedsec 占据了防守的地理优势，dedsec 先进行操作


艾登虽然精于黑客技术，但他的手机没电了。现在他把这个消息告诉了你，希望你帮他拯救世界，所以你需要写一个程序，来帮你判断是否存在一种方式，艾登可以取胜。当然，dedsec 的防守可能完美无缺，艾登根本无法取胜，你只好跑到 shelter 里去当试验品。

## 输入格式

输入包含多组测试数据，输入第一行包含一个整数 $T$，表示数据组数。

对于每组测试数据，第一行一个整数 $n$，表示有 $n$ 个点。

第二行至第 $n$ 行，每行两个整数 $u,v$，表示网络中有一条边连接 $u,v$。

第 $n+1$ 行 $n$ 个整数 $w$，第 $w_i$ 表示 $i$ 号节点的稳定值。

第 $n+2$ 行一个整数 $k$，描述操作的规则：

- 如果 $k=1$，你可以减少任意正整数的稳定值。
- 如果 $k=2$，接下来一行一个正整数 $s$，表示双方每次可以减少 $s$ 的非负整数幂的稳定值。
- 如果 $k=3$，接下来一行一个正整数 $s$，表示双方每次可以减少大于等于 $s$ 的稳定值。
- 如果 $k=4$，表示双方每次可以减少任意正整数的稳定值，或者把一个稳定值数量大于等于 $2$ 的节点分裂成两个，分开后的两个节点的稳定值之和等于原来的节点（比如 $7$ 分成 $3+4$）。
- 如果 $k=5$，双方都不能进行操作。

## 输出格式

对于每一组测试数据，输出一行：

如果存在一种方式，你可以获胜，输出 `Mutalisk ride face how to lose?`。

如果不存在一种方式可以取胜，输出 `The commentary cannot go on!`。

## 样例

### 样例输入 #1
```
1
3
1 2
2 3
1 2 3
1
```
### 样例输出 #1
```
Mutalisk ride face how to lose?
```
### 样例输入 #2
```
1
3
1 2
2 3
1 2 4
1
```
### 样例输出 #2
```
The commentary cannot go on!
```
## 提示

|测试点|$n\le$|$k$|$w_i\le$|
|:-:|:-:|:-:|:-:|
|$1$|$50$|$1$|$10^3$|
|$2$|$3\times 10^4$|$1$|$10^3$|
|$3$|$300$|$3$|$10^6$|
|$4$|$10^3$|$4$|$10^6$|
|$5$|$3\times 10^4$|$1$|$10^9$|
|$6$|$3\times 10^4$|$2$|$10^9$|
|$7$|$3\times 10^4$|$3$|$10^9$|
|$8$|$3\times 10^4$|$3$|$10^9$|
|$9$|$3\times 10^4$|$4$|$10^9$|
|$10$|$3\times 10^4$|$4$|$10^9$|

对于 $100\%$ 的数据，$T\le 5$。

保证输入均为正整数



---

---
title: "曼哈顿计划EX"
layout: "post"
diff: 省选/NOI-
pid: P3729
tag: ['洛谷原创', '枚举']
---
# 曼哈顿计划EX
## 题目背景

- 曼哈顿计划EX， The X Makes It Sound Cool

- 艾登黑进了dedsec的系统以后，发现核弹发射已经进入了倒计时，他必须停止核弹的发射进程。

![](https://cdn.luogu.com.cn/upload/pic/5120.png)

## 题目描述

- 艾登拥有一个计算机网络，每一台计算机都至少有着Intel Xeon E50 v40 + 40路GTX10800Titan的恐怖配置，并由无线网络直接或间接连接，这可以用一个无向连通图来表示。但是他的计算机网络有一个问题——不够安全，dedsec可能会攻击他的网络，切断一些无线连接，从而导致整个计算机网络不连通。为了避免这种情况，艾登决定从这些计算机中挑出一些计算机作为计算节点，其他计算机作为信息的中转站，进行停止核弹发射进程的任务。虽然台台都是顶配，但是艾登的计算机也会有从山寨厂买回的配件和原装正版配件的差别——每台电脑的工作能力是不同的，记为$ w_{i}$。现在艾登想知道，对于一个工作能力的要求，整个网络的安全系数最大是多少？


- 设给出的图为$G = (V , E)$，其中$V$ = $V_{1}$（计算节点） + $V_{2}$（中转节点）

- 我们定义安全系数k为：最大的k，使得任意两点$u,v\in V_{1}$都至少有k条互不相交的u到v的链（互不相交定义为：没有重复的边，可以重复有重复的点）

- 我们定义整个图的工作能力$W = \sum_{v \in V_{1}}{w_{v}}$

## 输入格式

- 第1行，三个整数n,m,q表示有n台计算机，m个无线网络，q次询问

- 第2行，n个整数，表示计算机的$w_{i}$

- 第3行到m+2行，每行两个整数u,v，表示有u，v之间存在直接的无线网络，什么都不保证

- 第m+3行到m+q+2行，每行一个整数k，表示一个询问

## 输出格式

- 一共q行，每行一个整数，表示要达到k的工作能力的前提下，整个网络最大的安全系数，如果只用一台计算机就能满足要求，输出"nan"

- 如果没有办法满足需求，输出"Nuclear launch detected"

- 仅输出nan并不能得分

## 样例

### 样例输入 #1
```
4 5 3
1 1 1 1
1 2
1 3
2 3
1 4
2 4
1
3
5
```
### 样例输出 #1
```
nan
2
Nuclear launch detected
```
## 提示

 ![](https://cdn.luogu.com.cn/upload/pic/5114.png) 

## 样例解释

- 对于询问1，选择任何一台计算机作为计算节点都是一个合法答案

- 对于询问2，至少要选择3台计算机，任选三个都是合法方案。选出的三个点构成三角形，对于任意两个点都有两种相互到达的方法（在三角形上顺时针和逆时针走），所以答案是2

- 对于询问3，选择所有的计算机都不足以满足任务


## 数据规模

- 对于30%的数据，n<=20，保证 $qn^{4}$ 不大于1e8

- 对于100%的数据，n<=550,m<=3000,q<=2017,询问以及$w_{i}$均不超过$10^{6}$

- 所有数字均为正整数



---

---
title: "[HAOI2016] 字符合并"
layout: "post"
diff: 省选/NOI-
pid: P3736
tag: ['2016', '河南', '各省省选', '枚举', '状压 DP']
---
# [HAOI2016] 字符合并
## 题目描述

有一个长度为 $n$ 的 $01$ 串，你可以每次将相邻的 $k$ 个字符合并，得到一个新的字符并获得一定分数。

得到的新字符和分数由这 $k$ 个字符确定。你需要求出你能获得的最大分数。

## 输入格式

输入的第一行是两个整数，分别代表字符串长度 $n$ 和参数 $k$。  

输入的第二行有 $n$ 个用空格隔开的非零即一的字符，第 $i$ 个字符表示初始串的第 $i$ 个字符。。  

第 $3$ 到第 $(2^k + 2)$ 行，每行有一个字符和一个整数，第 $(i + 2)$ 行的字符 $c_i$ 个整数 $w_i$ 表示长度为 $k$ 的 $01$ 串连成二进制后按从小到大顺序得到的第 $i$ 种合并方案得到的新字符,  $w_i$ 表示对应的第 $i$ 种方案对应获得的分数。  
## 输出格式

输出一个整数表示答案。

## 样例

### 样例输入 #1
```
3 2
1 0 1
1 10
1 10
0 20
1 30

```
### 样例输出 #1
```
40
```
## 提示

#### 数据规模与约定

对于 $100\%$ 的数据，保证：

- $1\leq n\leq 300$，$1 \lt k \leq 8$。
- $c_i\in\{0,1\}$，$1 \leq w_i \leq 10^9$。


---

---
title: "[六省联考 2017] 摧毁“树状图”"
layout: "post"
diff: 省选/NOI-
pid: P3748
tag: ['动态规划 DP', '2017', '各省省选', '枚举']
---
# [六省联考 2017] 摧毁“树状图”
## 题目描述

自从上次神刀手帮助蚯蚓国增添了上千万人口（蚯口？），蚯蚓国发展得越来越繁荣了！最近，他们在地下发现了一些神奇的纸张，经过仔细研究，居然是 D 国 X 市的超级计算机设计图纸！

这台计算机叫做 “树状图”，由 $n$ 个计算节点与 $n - 1$ 条可以双向通信的网线连接而成，所有计算节点用不超过 $n$ 的正整数编号。顾名思义，这形成了一棵树的结构。

蚯蚓国王已在图纸上掌握了这棵树的完整信息，包括 $n$ 的值与 $n - 1$ 条网线的连接信息。于是蚯蚓国王决定，派出蚯蚓国最强大的两个黑客，小 P 和小 H，入侵 “树状图”，尽可能地摧毁它。

小 P 和小 H 精通世界上最好的编程语言，经过一番商量后，他们决定依次采取如 下的步骤：
* 小 P 选择某个计算节点，作为他入侵的起始点，并在该节点上添加一个 **P** 标记。
* 重复以下操作若干次（可以是 $0$ 次）：
    * 小 P 从他当前所在的计算节点出发，选择一条没有被标记过的网线，入侵到该网线的另一端的计算节点，并在路过的网线与目的计算节点上均添加一个 **P** 标记。
* 小 H 选择某个计算节点，作为她入侵的起始点，并在该节点上添加一个 **H** 标记。
* 重复以下操作若干次（可以是 $0$ 次）：
    * 小 H 从她当前所在的计算节点出发，选择一条没有被标记过的网线，入侵到该网线的另一端的计算节点，并在路过的网线与目的计算节点上均添加一个 **H** 标记。（注意，小 H 不能经过带有 **P** 标记的网线，但是可以经过带有 **P** 标记的计算节点）
* 删除所有被标记过的计算节点和网线。
* 对于剩下的每条网线，如果其一端或两端的计算节点在上一步被删除了，则也删除这条网线。

经过以上操作后，“树状图” 会被断开，剩下若干个（可能是 $0$ 个）连通块。为了达到摧毁的目的，蚯蚓国王希望，连通块的个数越多越好。于是他找到了你，希望你能帮他计算这个最多的个数。

小 P 和小 H 非常心急，在你计算方案之前，他们可能就已经算好了最优方案或最优方案的一部分。你能得到一个值 $x$：
* 若 $x = 0$，则说明小 P 和小 H 没有算好最优方案，你需要确定他们两个的入侵路线。
* 若 $x = 1$，则说明小 P 已经算好了某种两人合作的最优方案中，他的入侵路线。他将选择初始点 $p_0$，并沿着网线一路入侵到了目标点 $p_1$，并且他不会再沿着网线入侵；你只需要确定小 H 的入侵路线。
* 若 $x = 2$，则说明小 P 和小 H 算好了一种两人合作的最优方案，小 P 从点 $p_0$ 入侵到了 $p_1$ 并停下，小 H 从点 $h_0$ 入侵到了 $h_1$ 并停下。此时你不需要指挥他们入侵了，只需要计算最后两步删除计算节点与网线后，剩下的连通块个数即可。
## 输入格式

每个输入文件包含多个输入数据。输入文件的第一行为两个整数 $T$ 和 $x$，$T$ 表示该文件包含的输入数据个数，$x$ 的含义见上述。（同一个输入文件的所有数据的 x 都是相同的。）

接下来依次输入每个数据。
## 输出格式

对于每个数据，输出一行，表示在给定条件下，剩下连通块的最大个数。
## 样例

### 样例输入 #1
```
1 0
13
1 2
2 3
2 4
4 5
4 6
4 7
7 8
7 9
9 10
10 11
10 12
12 13
```
### 样例输出 #1
```
8
```
### 样例输入 #2
```
8 0
1
2
1 2
3
1 2
2 3
4
1 3
2 3
2 4
5
1 5
2 5
3 5
4 5
16
1 2
1 3
1 4
1 5
5 6
5 7
5 8
5 9
9 10
9 11
9 12
9 13
13 14
13 15
13 16
17
1 2
1 3
1 4
1 5
5 6
5 7
5 8
5 17
17 9
9 10
9 11
9 12
9 13
13 14
13 15
13 16
17
8 6
2 6
11 6
4 6
14 2
10 2
5 4
1 4
9 8
17 11
12 5
3 6
13 6
16 8
7 11
15 16

```
### 样例输出 #2
```
0
1
2
2
4
12
13
10

```
### 样例输入 #3
```
8 1
1 1 1
2 1 1
1 2
3 2 2
1 2
2 3
4 2 2
1 3
2 3
2 4
5 5 5
1 5
2 5
3 5
4 5
16 1 5
1 2
1 3
1 4
1 5
5 6
5 7
5 8
5 9
9 10
9 11
9 12
9 13
13 14
13 15
13 16
17 1 5
1 2
1 3
1 4
1 5
5 6
5 7
5 8
5 17
17 9
9 10
9 11
9 12
9 13
13 14
13 15
13 16
17 2 4
8 6
2 6
11 6
4 6
14 2
10 2
5 4
1 4
9 8
17 11
12 5
3 6
13 6
16 8
7 11
15 16

```
### 样例输出 #3
```
0
1
2
2
4
12
13
10

```
## 提示

* 若 $x = 0$，则该行只有一个整数 $n$。
* 若 $x = 1$，则该行依次有三个整数 $n, p_0, p_1$。
* 若 $x = 2$，则该行依次有五个整数 $n, p_0, p_1, h_0, h_1$。

保证 $p_0, p_1, h_0, h_1$ 均为不超过 $n$ 的正整数。

每个数据接下来有 $n - 1$ 行，每行有两个不超过 $n$ 的正整数，表示这两个编号的计算节点之间有一条网线将其相连。保证输入的是一棵树。

同一行相邻的整数之间用恰好一个空格隔开。

**数据文件可能较大，请避免使用过慢的输入输出方法。**

【样例 1 说明】

这个输入文件只有一个输入数据。一种最优的方案如下：

- 小 P 从节点 $2$ 开始入侵，节点 $2$ 被小 P 标记。

- 小 P 从节点 $2$ 入侵到节点 $4$，节点 $4$ 和经过的网线被小 P 标记。

- 小 P 从节点 $4$ 入侵到节点 $7$，节点 $7$ 和经过的网线被小 P 标记。

- 小 H 从节点 $10$ 开始入侵，节点 $10$ 被小 H 标记。

- 删除被标记的节点 $2,4,7,10$ 和被标记的网线 $(2,4)$ 和 $(4,7)$。

- 删除任意一端在上一步被删除的网线。

此时还剩下 $8$ 个连通块。其中节点 $1,3,5,6,8,9,11$ 各自形成一个连通块，节点$12,13$形成了一个连通块。


【样例 2 说明】

- 数据 1：只有 $1$ 个计算节点，唯一可行的方案是小 P 从节点 $1$ 开始入侵（并马上停止），小 H 也从节点 $1$ 入侵到节点 $1$。所有的节点都被删去，剩下 $0$ 个连通块。

- 数据 2：一种最优方案是，小 P 从节点 $1$ 入侵到节点 $1$，小 H 也从节点 $1$ 入侵到节点 $1$。在删除操作后，剩下 $1$ 个连通块（只有节点 $2$）。

- 数据 3：唯一的最优方案是，小 P 从节点 $2$ 入侵到节点 $2$，小 H 也从节点 $2$ 入侵到节点 $2$，剩下 $2$ 个连通块。

- 数据 4：一种最优方案是，小 P 从节点 $2$ 入侵到节点 $2$，小 H 也从节点 $2$ 入侵到节点 $2$，剩下 $2$ 个连通块。

- 数据 5：唯一的最优方案是，小 P 从节点 $5$ 入侵到节点 $5$，小 H 也从节点 $5$ 入侵到节点 $5$，剩下 $4$ 个连通块。



![](https://cdn.luogu.com.cn/upload/pic/38934.png)

![](https://cdn.luogu.com.cn/upload/pic/38935.png)

![](https://cdn.luogu.com.cn/upload/pic/38936.png)

对于整数 $k$，设$\sum n^k$ 为某个输入文件中，其$ T$ 个输入数据的 $n^k$ 之和。

对于所有数据，$T \leq 10^5, \sum n^1 <5 \times 10^5$

请注意初始化的时间复杂度，避免输入大量小数据时超时。

每个测试点的详细数据范围见下表。如果表中 “完全二叉” 为 Yes，则该输入文件的每个数据满足：网线信息的第 $j$ 行 $(1 \leq j < n)$ 输入的两个数依次是 $\left\lfloor \frac {j + 1} {2} \right\rfloor$ 和 $j + 1$。

![](https://cdn.luogu.com.cn/upload/pic/38937.png)


---

---
title: "[六省联考 2017] 分手是祝愿"
layout: "post"
diff: 省选/NOI-
pid: P3750
tag: ['动态规划 DP', '递推', '2017', '各省省选', '枚举', '期望']
---
# [六省联考 2017] 分手是祝愿
## 题目描述

> Zeit und Raum trennen dich und mich.
时空将你我分开。

B 君在玩一个游戏，这个游戏由 $n$ 个灯和 $n$ 个开关组成，给定这 $n$ 个灯的初始状态，下标为从 $1$ 到 $n$ 的正整数。

每个灯有两个状态亮和灭，我们用 $1$ 来表示这个灯是亮的，用 $0$ 表示这个灯是灭的，游戏的目标是使所有灯都灭掉。

但是当操作第 $i$ 个开关时，所有编号为 $i$ 的约数（包括 $1$ 和 $i$）的灯的状态都会被改变，即从亮变成灭，或者是从灭变成亮。

B 君发现这个游戏很难，于是想到了这样的一个策略，每次等概率随机操作一个开关，直到所有灯都灭掉。

这个策略需要的操作次数很多，B 君想到这样的一个优化。如果当前局面，可以通过操作小于等于 $k$ 个开关使所有灯都灭掉，那么他将不再随机，直接选择操作次数最小的操作方法（这个策略显然小于等于 $k$ 步）操作这些开关。

B 君想知道按照这个策略（也就是先随机操作，最后小于等于 $k$ 步，使用操作次数最小的操作方法）的操作次数的期望。

这个期望可能很大，但是 B 君发现这个期望乘以 $n$ 的阶乘一定是整数，所以他只需要知道这个整数对 $100003$ 取模之后的结果。

## 输入格式

第一行两个整数 $n, k$。
接下来一行 $n$ 个整数，每个整数是 $0$ 或者 $1$，其中第 $i$ 个整数表示第 $i$ 个灯的初始情况。

## 输出格式

输出一行，为操作次数的期望乘以 $n$ 的阶乘对 $100003$ 取模之后的结果。

## 样例

### 样例输入 #1
```
4 0
0 0 1 1

```
### 样例输出 #1
```
512
```
### 样例输入 #2
```
5 0
1 0 1 1 1
```
### 样例输出 #2
```
5120
```
## 提示

对于 $0\%$ 的测试点，和样例一模一样；  
对于另外 $30\%$ 的测试点，$n \leq 10$；  
对于另外 $20\%$ 的测试点，$n \leq 100$；  
对于另外 $30\%$ 的测试点，$n \leq 1000$；  
对于 $100\%$ 的测试点，$1 \leq n \leq 100000, 0 \leq k \leq n$；  
对于以上每部分测试点，均有一半的数据满足 $k = n$。



---

---
title: "[TJOI2017] 不勤劳的图书管理员"
layout: "post"
diff: 省选/NOI-
pid: P3759
tag: ['2017', '线段树', '各省省选', '枚举', '树套树', '天津']
---
# [TJOI2017] 不勤劳的图书管理员
## 题目描述

加里敦大学有个帝国图书馆，小豆是图书馆阅览室的一个书籍管理员。

他的任务是把书排成有序的，所以无序的书让他产生厌烦。

两本乱序的书会让小豆产生这两本书页数的和的厌烦度。

现在有 $n$ 本被打乱顺序的书，在接下来 $m$ 天中每天都会因为读者的阅览导致书籍顺序改变位置。

因为小豆被要求在接下来的 $m$ 天中至少要整理一次图书。

小豆想知道，如果他前 $i$ 天不去整理，第 $i$ 天他的厌烦度是多少，这样他好选择厌烦度最小的那天去整理。
## 输入格式

第一行会有两个数，$n,m$ 分别表示有 $n$ 本书，$m$ 天。

接下来 $n$ 行，每行两个数，$a_i,v_i$，分别表示第 $i$ 本书本来应该放在 $a_i$ 的位置，这本书有 $v_i$ 页，保证不会有放置同一个位置的书。

接下来 $m$ 行，每行两个数，$x_j$ 和 $y_j$，表示在第 $j$ 天的第 $x_j$ 本书会和第 $y_j$ 本书会因为读者阅读交换位置。
## 输出格式

一共 $m$ 行，每行一个数，第 $i$ 行表示前 $i$ 天不去整理，第 $i$ 天小豆的厌烦度，因为这个数可能很大，所以将结果模 $10^9 +7$ 后输出。
## 样例

### 样例输入 #1
```
5 5
1 1
2 2
3 3
4 4
5 5
1 5
1 5
2 4
5 3
1 3
```
### 样例输出 #1
```
42
0
18
28
48
```
## 提示

#### 数据规模与约定

- 对于 $20\%$ 的数据，$1\le a_i,x_j,y_j\le n \le 5\times 10^3$，$1\le m\le 5\times 10^3$， $1\le v_i\le10^5$。
- 对于 $100\%$ 的数据，$1\le a_i,x_j,y_j\le n\le 5\times 10^4$，$1\le m\le 5\times 10^4$，$1\le v_i\le 10^5$。


---

---
title: "[TJOI2017] 城市"
layout: "post"
diff: 省选/NOI-
pid: P3761
tag: ['2017', '各省省选', '枚举', '树的直径', '天津']
---
# [TJOI2017] 城市
## 题目描述

从加里敦大学城市规划专业毕业的小明来到了一个地区城市规划局工作。这个地区一共有 $n$ 座城市，$n-1$ 条高速公路，保证了任意两运城市之间都可以通过高速公路相互可达，但是通过一条高速公路需要收取一定的交通费用。小明对这个地区深入研究后，觉得这个地区的交通费用太贵。

小明想彻底改造这个地区，但是由于上司给他的资源有限，因而小明现在只能对一条高速公路进行改造，改造的方式就是去掉一条高速公路，并且重新修建一条一样的高速公路（即交通费用一样），使得这个地区的两个城市之间的最大交通费用最小（即使得交通费用最大的两座城市之间的交通费用最小），并且保证修建完之后任意两座城市相互可达。如果你是小明，你怎么解决这个问题？

## 输入格式

输入数据的第一行为一个整数 $n$，代表城市个数。

接下来的 $n - 1$ 行分别代表了最初的 $n-1$ 条公路情况。每一行都有三个整数 $u,v,d$。$u,v$ 代表这条公路的两端城市标号，$d$ 代表这条公路的交通费用。

$1 \leq u,v \leq n$，$1\leq d \leq 2000$。

## 输出格式

输出数据仅有一行，一个整数，表示进行了最优的改造之后，该地区两城市 之间最大交通费用。

## 样例

### 样例输入 #1
```
5
1 2 1
2 3 2
3 4 3
4 5 4
```
### 样例输出 #1
```
7
```
## 提示

对于 $30\%$ 的数据，$1\leq n\leq 500$。

对于 $100\%$ 的数据，$1\leq n\leq 5000$。



---

---
title: "签到题 III"
layout: "post"
diff: 省选/NOI-
pid: P3764
tag: ['数学', '递归', '洛谷原创', 'O2优化', '枚举', '洛谷月赛']
---
# 签到题 III
## 题目背景

pj组选手zzq近日学会了求最大公约数的辗转相除法。

## 题目描述

类比辗转相除法，zzq定义了一个奇怪的函数：

```cpp
typedef long long ll;
ll f(ll a,ll b)
{
    if(a==b) return 0;
    if(a>b) return f(a-b,b+b)+1;
    else return f(a+a,b-a)+1;
}
```
zzq定义完这个函数兴高采烈，随便输入了两个数，打算计算f值，发现这个函数死循环了...于是zzq定义这个函数递归死循环的情况下f值为0。

现在zzq输入了一个数n，想要求出$\sum_{i=1}^n \sum_{j=1}^n f(i,j)$。

## 输入格式

一行一个数n。

## 输出格式

一行一个数$\sum_{i=1}^n \sum_{j=1}^n f(i,j)$。

## 样例

### 样例输入 #1
```
100
```
### 样例输出 #1
```
1124
```
### 样例输入 #2
```
2000
```
### 样例输出 #2
```
68204
```
## 提示

对于10%的数据，$n \leq 300$。

对于40%的数据，$n \leq 2000$。

对于70%的数据，$n \leq 5 \times 10^5$。

对于100%的数据，$1 \leq n \leq 5 \times 10^{11}$。



---

---
title: "总统选举"
layout: "post"
diff: 省选/NOI-
pid: P3765
tag: ['线段树', '平衡树', '洛谷原创', 'O2优化', '枚举', '构造', '洛谷月赛']
---
# 总统选举
## 题目背景

黑恶势力的反攻计划被小 C 成功摧毁，黑恶势力只好投降。秋之国的人民解放了，举国欢庆。此时，原秋之国总统因没能守护好国土，申请辞职，并请秋之国人民的大救星小 C 钦定下一任。

作为一名民主人士，小 C 决定举行全民大选来决定下一任。为了使最后成为总统的人得到绝大多数人认同，小 C 认为，一个人必须获得超过全部人总数的一半的票数才能成为总统。如果不存在符合条件的候选人，小 C 只好自己来当临时大总统。为了尽可能避免这种情况，小 C 决定先进行几次小规模预选，根据预选的情况，选民可以重新决定自己选票的去向。

由于秋之国人数较多，统计投票结果和选票变更也成为了麻烦的事情，小 C 找到了你，让你帮他解决这个问题。
## 题目描述

秋之国共有 $n$ 个人，分别编号为 $1,2,…,n$，一开始每个人都投了一票，范围 $1 \sim n$，表示支持对应编号的人当总统。

共有 $m$ 次预选，每次选取编号 $[l_i,r_i]$ 内的选民展开小规模预选，在该区间内获得超过区间大小一半的票的人获胜。如果没有人获胜，则由小 C 钦定一位候选者获得此次预选的胜利（获胜者可以不在该区间内），每次预选的结果需要公布出来，并且每次会有 $k_i$ 个人决定将票改投向该次预选的获胜者。

全部预选结束后，公布最后成为总统的候选人。
## 输入格式

第一行两个整数 $n,m$，表示秋之国人数和预选次数。

第二行 $n$ 个整数，分别表示编号 $1 \sim n$ 的选民投的票。

接下来 $m$ 行，每行先有四个整数，分别表示 $l_i,r_i,s_i,k_i$，$s_i$ 表示若此次预选无人胜选，视作编号为 $s_i$ 的人获得胜利，接下来 $k_i$ 个整数，分别表示决定改投的选民。
## 输出格式

共 $m+1$ 行，前 $m$ 行表示各次预选的结果，最后一行表示最后成为总统的候选人，若最后仍无人胜选，输出 $-1$。
## 样例

### 样例输入 #1
```
5 4
1 2 3 4 5
1 2 1 1 3
5 5 1 2 2 4
2 4 2 0
3 4 2 1 4
```
### 样例输出 #1
```
1
5
5
2
-1
```
## 提示

对于前 $20 \%$ 的数据，$1 \leq n,m \leq 5000$。

对于前 $40 \%$ 的数据，$1 \leq n,m \leq 50000$，$\sum k_i \leq 50000$。

对于前 $50 \%$ 的数据，$1 \leq n,m \leq {10}^5$，$\sum k_i \leq 2 \times {10}^5$。

对于数据点 6~7，保证所有选票始终在 $1 \sim 10$ 之间。

对于 $100 \%$ 的数据，$1 \leq n,m \leq 5 \times {10}^5$，$\sum k_i \leq 10^6$，$1 \leq l_i \leq r_i \leq n$，$1 \leq s_i \leq n$。


---

---
title: "[CTSC2017] 密钥"
layout: "post"
diff: 省选/NOI-
pid: P3770
tag: ['2017', 'Special Judge', '枚举', '前缀和', 'CTSC/CTS']
---
# [CTSC2017] 密钥
## 题目描述

一个密钥是一个长度为 n = 2k + 1 的字符串，它包含 1 个字母 X、k 个字母 A 和k 个字母 B。例如 k = 3 时，BAXABAB 就是一个密钥。

如下图所示，可以按顺时针顺序把这 2k+1 个字母排成一个圈：

 ![](https://cdn.luogu.com.cn/upload/pic/5481.png) 

在 k 个字母 A 中，有一部分可以定义为 “强的’’。具体来说，从 X 出发顺时针走到某个 A 时，如果途中 A 的数目**严格多于**B的数目，则称此字母 A 为强的。

对于上面的例子来说，顺时针方向从字母 X 数起第 1 个和第 2 个字母 A 是强的，而第 3 个字母 A 不是强的。

一个密钥的**特征值**就是其中包含的强的字母 A 的个数。

天才小朋友 KT 给出了一个结论：

假设 k 个字母 A 所在的位置已经固定，但是剩下的 k 个 B 和 1 个 X 的位置是未知的。（注意，满足这样要求的密钥一共有 k + 1 个，因为字母 X 还剩下 k + 1 个可能的位置。）

可以证明：所有这 k + 1 个可能的密钥的特征值是各不相同的，它们恰好为0, 1, 2, …, k。

下面的图是一个具体的示例，从左到右的四个子图中分别有 3 个，2 个，1 个，0个字母 A 是强的。

 ![](https://cdn.luogu.com.cn/upload/pic/5482.png) 

类似地，如果固定 k 个字母 B 的位置，那满足条件的所有 k + 1 个密钥的特征值也各不相同，恰好为 0, 1, …, k。

现在你需要解决以下三个问题：

1. 给定密钥中所有 A 的位置，当密钥的特征值为 0 时，请问 X 在哪个位置。

2. 给定密钥中所有 A 的位置，当密钥的特征值为 S 时，请问 X 在哪个位置。

3. 给定密钥中所有 B 的位置，当密钥的特征值为 S 时，请问 X 在哪个位置。

注意：字符串的 2k + 1 个字母的位置由 1 到 2k + 1 编号。


【例子 1】

假定 k = 3, S = 2。那么：

当 A 的位置是 {2,4,6} 且特征值为 0 时，X 的位置在 7；

当 A 的位置是 {2,4,6} 且特征值为 2 时，X 的位置在 3；

当 B 的位置是 {2,4,6} 且特征值为 2 时，X 的位置在 5。

【例子 2】

假定 k=9。S=7。那么：

当 A 的位置是 {3,4,5,9,10,12,13,16,19} 且特征值为 0 时，X 的位置在 14；

当 A 的位置是 {3,4,5,9,10,12,13,16,19} 且特征值为 7 时，X 的位置在 18；

当 B 的位置是 {3,4,5,9,10,12,13,16,19} 且特征值为 7 时，X 的位置在 17。

## 输入格式

只包含一组测试数据。

第一行包含一个整数 k，意义如题所述。

第二行包含一个整数 seed，这个数将用于生成一个 k 元集合 P。

第三行包含一个整数 S，意义如题所述。

保证 0 ≤ S ≤ k ≤ 10^7。1 ≤ seed ≤ 10000。

在 cipher/下，包含两个用于生成输入数据的文件 cipher.cpp/pas。其中读入部分已经完成，在数组 p[] 中，若 p[i] = 0，表示 i 不属于集合 P，否则，i 属于集合P。

[百度网盘链接>>   密码：9vr3](http://pan.baidu.com/s/1i55NdWx) 请自行编译

```cpp
#include <stdio.h>
#include <string.h>
int p[20000005];
int seed, n, k, S;
int getrand() {
	seed = ((seed * 12321) ^ 9999) % 32768;
	return seed;
}
void generateData() {
	scanf( "%d%d%d", &k, &seed, &S );
	int t = 0;
	n = k * 2 + 1;
	memset(p, 0, sizeof(p));
	for( int i = 1; i <= n; ++i ) {
		p[i] = (getrand() / 128) % 2;
		t += p[i];
	}
	int i = 1;
	while( t > k ) {
		while ( p[i] == 0 ) ++i;
		p[i] = 0;
		--t;
	}
	while( t < k ) {
		while( p[i] == 1 ) ++i;
		p[i] = 1;
		++t;
	}
}
int main() {
	generateData();
	return 0;
}
```

## 输出格式

输出三行，每行一个数，依次对应问题描述中的三个子问题的答案。

即：
1. 第一个数表示当 k 元集合 P 代表 A 的位置且特征值为 0 时 X 的位置。

2. 第二个数表示当 k 元集合 P 代表 A 的位置且特征值为 S 时 X 的位置。

3. 第三个数表示当 k 元集合 P 代表 B 的位置且特征值为 S 时 X 的位置。

## 样例

### 样例输入 #1
```
5
3344
2
```
### 样例输出 #1
```
10
1
2
```
### 样例输入 #2
```
500000
4545
234567
```
### 样例输出 #2
```
999992
246922
753067
```
## 提示

【样例解释】

第一个样例中, P 数组为 1 的元素的下标分别为 5, 6, 7, 8, 9。


【数据范围与约定】

对于 30% 的数据，k ≤ 10^3。

对于 50% 的数据，k ≤ 10^5。

对于 100% 的数据，k ≤ 10^7。

对于每个测试点, 得分为以下三部分得分之和：

1. 如果第一问回答正确，你将获得 3 分。

2. 如果第二问回答正确，你将获得 4 分。

3. 如果第三问回答正确，你将获得 3 分。

**如果你仅仅知道部分答案，请也务必按此格式要求输出三个数。否则你可能会因格式错误无法得分。**



---

---
title: "[CTSC2017] 吉夫特"
layout: "post"
diff: 省选/NOI-
pid: P3773
tag: ['2017', '递归', 'O2优化', '枚举', '进制', '组合数学', 'CTSC/CTS']
---
# [CTSC2017] 吉夫特
## 题目描述

简单的题目，既是礼物，也是毒药。

B 君设计了一道简单的题目，准备作为 gift 送给大家。

输入一个长度为  $n$  的数列  $a_1, a_2, \cdots , a_n$  问有多少个长度大于等于  $2$  的不上升的子序列满足：

 $$\prod _{i=2}^{k} \binom{a_{b_{i-1}}}{a_{b_i}} \bmod 2 = \binom{a_{b_1}}{a_{b_2}} \times \binom{a_{b_2}}{a_{b_3}} \times \cdots \binom{a_{b_{k-1}}}{a_{b_k}} \bmod 2 > 0$$ 

输出这个个数对  $1000000007$  取模的结果。

G 君看到题目后，为大家解释了一些基本概念。

我们选择任意多个整数  $b_i$  满足

 $$1 \leq b_1 < b_2 < \dots < b_{k-1} < b_k \leq n$$ 

我们称  $a_{b_1}, a_{b_2}, \cdots, a_{b_k} $  是  $a$  的一个子序列。

如果这个子序列同时还满足

 $$a_{b_1} \geq a_{b_2} \geq \cdots \geq a_{b_{k-1}}\geq a_{b_k}$$ 

我们称这个子序列是不上升的。

组合数  $\binom {n} {m} $  是从  $n$  个互不相同的元素中取  $m$  个元素的方案数，具体计算方案如下：

 $$\binom {n}{m}=\frac{n!}{m!(n-m)!}=\frac{n \times (n-1) \times \cdots \times 2 \times 1}{(m \times (m-1) \cdots \times 2 \times 1)((n-m)\times(n-m-1)\times \cdots \times 2 \times 1)}$$ 

这里要特别注意，因为我们只考虑不上升子序列，所以在求组合数的过程中，一定满足  $n \geq m$ ，也就是 $\binom {a_{b_{i-1}}}{a_{b_i}}$ 中一定有 $a_{b_{i-1}} \geq a_{b_i}$ 。

我们在这里强调取模  $x \mod y$  的定义：

 $x \bmod y = x -\left \lfloor \frac{x}{y} \right \rfloor \times y$ 

其中  $\left \lfloor n \right \rfloor$  表示小于等于  $n$  的最大整数。

 $x \bmod 2 > 0$  ，就是在说  $x$  是奇数。

与此同时，经验告诉我们一个长度为  $n$  的序列，子序列个数有  $O(2^n)$  个，所以我们通过对答案取模来避免输出过大。

B 君觉得 G 君说的十分有道理，于是再次强调了这些基本概念。

最后， G 君听说这个题是作为 gift 送给大家，她有一句忠告。

“Vorsicht, Gift!”

“小心. . . . . .剧毒！ ”
## 输入格式

第一行一个整数 $n$。

接下来 $n$ 行，每行一个整数，这 $n$ 行中的第 $i$ 行，表示 $a_i$。

## 输出格式

一行一个整数表示答案。

## 样例

### 样例输入 #1
```
4
15
7
3
1
```
### 样例输出 #1
```
11
```
## 提示

对于前 $10\%$ 的测试点，$n \leq 9$，$1\leq a_i\leq 13$。

对于前 $20\%$ 的测试点，$n\leq 17$，$1\leq a_i\leq 20$。

对于前 $40\%$ 的测试点，$n\leq 1911$，$1\leq a_i\leq 4000$。

对于前 $70\%$ 的测试点，$n\leq 2017$。

对于前 $85\%$ 的测试点，$n\leq 100084$。

对于 $100\%$ 的测试点，$1\leq n\leq 211985$，$1\leq a_i\leq 233333$。所有的 $a_i$ 互不相同，也就是说不存在 $i, j$ 同时满足 $1\leq i < j\leq n$ 和 $a_i = a_j$。



---

---
title: "文艺数学题"
layout: "post"
diff: 省选/NOI-
pid: P3790
tag: ['洛谷原创', 'O2优化', '枚举', '剪枝', '生成树', '洛谷月赛']
---
# 文艺数学题
## 题目背景

小Y在AK曼哈顿OI，CTSC和APIO之后，开始研究数学题。

## 题目描述

小Y有一张N个点，M条边的无向图（**可能有重边、自环**），每条边都有一个权值w。


你需要计算：所有**生成树的边权的最大公约数**之和，具体操作见样例。


由于答案可能很大，需要**对1000000007取模**。

## 输入格式

第一行两个正整数N，M，表示点数和边数。


接下来M行，每行三个正整数u，v，w，表示一条边连接u和v，权值为w。

## 输出格式

输出一行一个数，表示答案**对1000000007取模**的值。

## 样例

### 样例输入 #1
```
4 5  
1 2 12  
1 3 9  
2 4 6  
3 4 8  
1 4 4  
```
### 样例输出 #1
```
15
```
## 提示

### 样例1的解释



 ![](https://cdn.luogu.com.cn/upload/pic/13639.png) 

显然，这张图有8个不同的生成树。


用$(x,y,z)$表示x,y,z的最大公约数，则答案


$=(12,6,8)+(6,8,9)+(8,9,12)+(9,12,6)+(9,4,6)+(12,4,8)+(12,4,9)+(6,4,8)$


$=2+1+1+3+1+4+1+2$


$=15$

### 数据范围


对于20%的数据，$N\le 10, M\le 20$；

对于另外10%的数据，$N\le 12, M\le 24$；

对于另外20%的数据，$N\le 60, M\le 3000$，且满足$u_i+1=v_i$；

对于另外20%的数据，$N\le 40, M\le 1000, W\le 1000$；

对于另外15%的数据，$N\le 50, M\le 2000$；

对于所有100%的数据，$N\le 60, M\le 3000, W\le 1000000$；




---

---
title: "[FJOI2017] 矩阵填数"
layout: "post"
diff: 省选/NOI-
pid: P3813
tag: ['2017', '各省省选', '离散化', '福建', '枚举', '容斥原理']
---
# [FJOI2017] 矩阵填数
## 题目描述

给定一个 $h \times w$ 的矩阵，矩阵的行编号从上到下依次为 $1 \sim h$，列编号从左到右依次 $1 \sim w$。

在这个矩阵中你需要在每个格子中填入 $1 \sim m$ 中的某个数。

给这个矩阵填数的时候有一些限制，给定 $n$ 个该矩阵的子矩阵，以及该子矩阵的最大值 $v$，要求你所填的方案满足该子矩阵的最大值为 $v$。

现在，你的任务是求出有多少种填数的方案满足 $n$ 个限制。

两种方案是不一样的当且仅当两个方案至少存在一个格子上有不同的数。由于答案可能很大，你只需要输出答案对 $10 ^ 9 + 7$ 取模后的结果。
## 输入格式

输入数据的第一行为一个数 $T$，表示数据组数。

对于每组数据，第一行为四个数 $h,w,m,n$。

接下来 $n$ 行，每一行描述一个子矩阵的最大值 v。每行为五个整数 $x1,y1,x2,y2,v$，表示一个左上角为$(x1,y1)$,右下角为$(x2,y2)$的子矩阵的最大值为 $v$。 $1 \le x1 \le x2 \le h$, $1 \le y1 \le y2 \le w$

## 输出格式

对于每组数据输出一行，表示填数方案 mod $1,000,000,007$ 后的值。

## 样例

### 样例输入 #1
```
2
3 3 2 2
1 1 2 2 2
2 2 3 3 1
4 4 4 4
1 1 2 3 3
2 3 4 4 2
2 1 4 3 2
1 2 3 4 4
```
### 样例输出 #1
```
28
76475
```
## 提示

对于 $20\%$ 的数据，$n \le 2$。

另有 $20\%$ 的数据，$1 \le h, w \le 50$。

对于 $100\%$ 的数据，$T \le 5$，$1 \le h, w, m \le 10 ^ 4$，$1 \le n \le 10$，$1 \le v \le m$。


---

---
title: "[FJOI2017] 树的平均路长问题"
layout: "post"
diff: 省选/NOI-
pid: P3816
tag: ['字符串', '动态规划 DP', '2017', '各省省选', '福建', '枚举']
---
# [FJOI2017] 树的平均路长问题
## 题目描述

一棵树 $T$ 的平均路长 $IPL(T)$定义为：

$IPL(T)=\sum_{v\varepsilon T}length(path(v))$

其中， $v$ 是树 $T$ 中的内结点， $length(path(v))$是从树根到结点$v$的路径长度。

红黑树是一类特殊的二叉搜索树，其中每个结点被“染成”红色或黑色。若将二叉搜索树结点中的空指针看作是指向一个空结点，则称这类空结点为二叉搜索树的前端结点。并规定所有前端结点的高度为$-1$。除了前端结点外，其他结点均为内结点。

一棵红黑树是满足下面“红黑性质”染色二叉搜索树：

1. 每个结点被染成红色或黑色；

2. 每个前端结点为黑色结点；

3. 任一红结点的儿子结点均为黑结点；

4. 在从任一结点到其子孙前端结点的所有路径上具有相同的黑结点数。

从红黑树中任一结点 $x$ 出发(不包括结点 $x$)，到达一个前端结点的任意一条路径上的黑结点个数称为结点 $x$ 的黑高度，记作 $bh(x)$。红黑树的黑高度定义为其根结点的黑高度。

给定正整数 $n$，试设计一个算法，计算出在所有含有 $n$ 个结点的红黑树中，平均路长的最大值。

## 输入格式

文件有多个测试项。每行有1个正整数$n$， ($1\le n\le 30000$)，表示红黑树的结点数。文件最后以一个$0$结束。

## 输出格式

对每行中红黑树的结点数 $n$，将计算出的平均路长的最大值输出到文件中。

每行输出一个最大值。 文件最后以一个$0$ 结束。

## 样例

### 样例输入 #1
```
1
2
3
0
```
### 样例输出 #1
```
1
3
5
0
```


---

---
title: "[TJOI2007] 书架"
layout: "post"
diff: 省选/NOI-
pid: P3850
tag: ['2007', '各省省选', '平衡树', '枚举', '天津']
---
# [TJOI2007] 书架
## 题目描述

Knuth 先生家里有个精致的书架，书架上有 $N$ 本书，如今他想学到更多的知识，于是又买来了 $M$ 本不同的新书。现在他要把新买的书依次插入到书架中，他已经把每本书要插入的位置标记好了，并且相应的将它们放好。由于 Knuth 年龄已大，过几天他已经记不清某些位置上放的到底是什么书了，请问你能帮助他吗？

## 输入格式

输入文件的第一行为整数 $N$，接下来 $N$ 行分别是书架上依次放着的 N 本书的书名（书名由不含空格的字符串构成，长度不超过 $10$）。下一行将要输入一个整数 $M$，接下来的 $M$ 行分别为这本书的书名和要插入的位置。下一行将要输入一个整数 $Q$，接下来共有 $Q$ 次询问，每行都是一个整数表示询问的位置。（书架上位置的编号从 $0$ 开始）

## 输出格式

输出 $Q$ 行，每行对应着相应查询位置的书名。

## 样例

### 样例输入 #1
```
3
Math
Algorithm
Program
2
Picture 2
System 1
3
0
1
3
```
### 样例输出 #1
```
Math
System
Picture
```
## 提示

原来有三本书 Math、Algorithm、Program，后来又买了两本书，分别插入到 $2$ 和 $1$ 的位置，每次插入时其他书都要向后挪一个位置，最后书架上书的序列为：

```plain
0  Math
1  System
2  Algorithm
3  Picture
4  Program
```
$Q$ 次询问依次为 $0$, $1$, $3$ 位置的书，所以答案为：Math、System、Picture


对于 $30\%$ 的数据，$1 \leqslant N \leqslant 100$, $1 \leqslant M \leqslant 10^3$, $1 \leqslant Q \leqslant 10^3$

对于 $100\%$ 的数据，$1 \leqslant N \leqslant 200$, $1 \leqslant M \leqslant 10^5$, $1 \leqslant Q \leqslant 10^4$

对于 $100\%$ 的数据都符合题目中所描述的限制关系，数据保证每次插入的位置均不超过当时书架上书的数量，而且保证 $Q$ 次查询中的每个位置上一定有书。


---

---
title: "[TJOI2008] 公共子串"
layout: "post"
diff: 省选/NOI-
pid: P3856
tag: ['动态规划 DP', '2008', '各省省选', '枚举', '天津']
---
# [TJOI2008] 公共子串
## 题目描述

一个字符串的子串是在这个串基础上去掉0个或者若干个字符所形成的，例如abc, aa和abbc都是字符串aabbcc的子串，而aba不是。 现给你三个字符串，请问他们三个共同含有多少种子串（不算空串）?

注意： 有些相同的公共子串尽管出现在不同的位置，但仍算1种，详见样例。

## 输入格式

每组测试数据只有3行，每行都是一个只包含有小写字母的字符串。

## 输出格式

输出3个字符串共有的公共子串种类数。

## 样例

### 样例输入 #1
```
apartment
apache
approach

```
### 样例输出 #1
```
6
```
## 提示

3个字符串共有的公共子串有： “a”, “p”, “ap”, “pa”, “aa”, “apa”。 其中子串 “a” 有多个，但由于统计的是公共子串种类，所以 “a” 只算1种子串。


100%的数据中，字符串的长度不超过100。字符串中只含有小写字母。





---

---
title: "[湖南集训] Crazy Rabbit"
layout: "post"
diff: 省选/NOI-
pid: P3897
tag: ['湖南', '枚举', '排序']
---
# [湖南集训] Crazy Rabbit
## 题目描述

兔子们决定在自己的城堡里安排一些士兵进行防守。

给出 $n$ 个点的坐标，和城堡里一个圆心在原点的圆形的障碍，兔子们希望从中选出 $k$ 个兔子，使得它们两两**所在的直线**都不与圆相交。

兔子们希望知道最多能选出多少兔子。
## 输入格式

第一行两个整数 $n$ 和 $r$，表示兔子的个数和圆的半径。

接下来 $n$ 行，每行两个整数 $x_i$ 和 $y_i$，表示第 $i$ 只兔子的坐标

保证每只兔子都严格在障碍外部，且两两所在的直线不与圆相切。
## 输出格式

输出一行一个整数, 表示最多能选出多少兔子
## 样例

### 样例输入 #1
```
6 3
0 6
-7 -4
-3 -2
7 -5
-2 3
8 -3
```
### 样例输出 #1
```
4
```
## 提示

#### 样例 1 解释

 ![](https://cdn.luogu.com.cn/upload/pic/6853.png) 

选择第 $1, 2, 6, 4$ 只兔子即可。

---

#### 数据规模与约定

- 对于 $10\%$ 的数据，保证 $1\leq n\leq 20$。
- 对于 $30\%$ 的数据，保证 $1\leq n\leq 100$。
- 对于 $100\%$ 的数据，保证 $1\leq n\leq 2000$，$1\leq r,x_i,y_i \leq 5000$。


---

---
title: "[Ynoi Easy Round 2016] 炸脖龙 I"
layout: "post"
diff: 省选/NOI-
pid: P3934
tag: ['2016', '线段树', '树状数组', 'O2优化', '枚举', '洛谷月赛', 'Ynoi']
---
# [Ynoi Easy Round 2016] 炸脖龙 I
## 题目背景

备餐时光，软泞蜥獾

草地中钻孔，日晷下打转

波若歌鹦苟延残喘，迷途绿龟嚎哮迷茫

“当心炸脖龙，我的孩子！

那锋爪利颚，能挠钩撕咬！

注意秋布秋布鸟，你需回避，

那暴躁冒烟恶怪大毛怪！”

手持宝剑鸣真理之语：寻觅强敌豪壮永不息——于噹噹树下稍事休憩，伫立良久，深陷思绪。

当思绪纷乱杂绪之际，炸脖龙双目如烔炬，从阴暗密林奔跃闯出，一路悲鸣低吟时啭啼！

一，二！一，二！一刺再刺，真理之语将敌斩成糜！

取其首级，置之死地，

伴随胜利，驰马归疾。

“真当是你把怪龙斩于马下？

奋勇吾儿！

来我怀里！奔走相告！衣锦还乡！

父喜不自禁窃鸣得意

波若歌鹦苟延残喘，

迷途绿龟嚎哮迷茫，

备餐时光，软泞蜥獾

草地中钻孔，日晷下打转

波若歌鹦苟延残喘，

迷途绿龟嚎哮迷茫”

——《炸脖龙之诗》

![](https://cdn.luogu.com.cn/upload/pic/21111.png)

我喊了出来...却不成人话

只能，像在水中一边融化一边下沉的方糖一样...

失去自己的轮廓...一直沉向最低处

想要爬上去的子午

维持自己是自己的连续体...

溶解的渐渐七零八落的意识...

失去了用来挣扎的双手

失去了用来挣扎的双臂

向下，

向下，

一直沉下去

向着意识的底层

沉陷下去的自我...

逐渐消失的世界...

我看到了世界

失落的...世界...

![](https://cdn.luogu.com.cn/upload/pic/21112.png)

```plain

   回归天空的话我就可以成为      了

  开什么玩笑，你才不是什么      ！

  吵死了！吵死了！我是      ！而且生来就是！

就是因为这个家伙我才失去      的资格的！

 呜呜呜，由岐姐姐，由岐姐姐！

  ...怎么会...由岐姐...

 卓司！你这家伙！

        吵死了吵死了！像你这样的普通人懂些什么！

   由岐的血慢慢在冰凉的水泥地上扩散开来

   抱在怀里的      在渐渐地流出来        本应成为      而出生

的我的被      妨碍了！

不出生的话我就没法拯救是这个世界！

            所以预言者说能当世界回归天空的此处就是尽头

   只要      回归天空的话！

 我有这么可怕吗？

              因为我是要对一切生物下达审判的存在！

       因为哥哥是凡人呢

    凡人与天才

                            救世主

   世界

                    救世主

                回天之门

  要死的是你！

            我不会死               不会死       诅咒你

       要死的是羽咲

         只要羽咲死了

                  间宫              皆

                                    守           由

                         岐

                                间宫羽咲

                          可能性

                                    和镜

                     终

                   终之空

                     空

```

![](https://cdn.luogu.com.cn/upload/pic/21113.png)

一个婴儿出生了

谁的？

不知道


虽然不知道...
但确实有一个婴儿出生了

嗯...那个婴儿在哭...

呜嘎，呜嘎，地哭着...

听到这个哭声大家都笑了

大家都在为婴儿祝福

母亲也是...

父亲也是...

并且其他人也是...

为那个婴儿的出生...

衷心祝福

世界充满着生命的祝福

但是

但不是这样的

在那里

我

我一个人在那里恐惧着

非常恐惧...

要说为什么的话...

因为那是在对世界进行诅咒

没错...

他在诅咒着那个世界，那个刚出生的婴儿

诅咒着自己的出生

我

我当场全身僵硬

在大家的笑容之中

在祝福之中

独自一人...

我啊...

我摇摇晃晃地...

接近那个婴儿

然后想要让那个婴儿停止哭泣

我想着必须要那样做才行

为什么呢？

我自己也不明白...

那是

那是，自从出生以来

就悲惨地活到今天的我能做到的

我能做到的

唯一的

唯一的赎罪啊。

![](https://cdn.luogu.com.cn/upload/pic/21114.png)

让我在这里了结了你吧…间宫卓司

这里是终之空的下面吧…这不刚好吗

跟我们的终结很相称不是吗…

这里，是只对你而言的，终结的天空…

这里就是终焉之地…

![](https://cdn.luogu.com.cn/upload/pic/21115.png)

“不行！绝对不行！”

…为什么…跟过来了…

![](https://cdn.luogu.com.cn/upload/pic/21116.png)

预定…调和吗…

原来如此…看来不管怎样对于你来说…我都已经毫无任何价值了对吧…

竟然被这家伙打倒了…真是没办法呐…

这也是现实吗…

那就接受吧…

![](https://cdn.luogu.com.cn/upload/pic/21117.png)

不知为何，我好像看到了在夜空中挺立的向日葵…

只有一瞬间…

那株向日葵…

好像在某个地方…

向日葵…

跟羽咲一起…

是啊…

我是哥哥啊…

要是…能再多当当她的哥哥就好了……

![](https://cdn.luogu.com.cn/upload/pic/21119.png)

咦……

刚才的…

那个是…那片风景…

是吗…那片风景…

我也是知道的啊…

在坡道途中的向日葵…

蔚蓝的天空和向日葵。

漂浮着大大的云朵…

羽咲戴着大大的帽子…

然后跟我走在一起…

走着走着…

为了…

两人一起…

爬上那个坡道…

因为…那个坡道的前面有很漂亮的景色…
## 题目描述

您正在打 galgame，然后您觉得这个 gal 不知所云，于是您弃坑了，开始写数据结构题：

给一个长为 $n$ 的序列，$m$ 次操作，每次操作：

1. 区间 $[l,r]$ 加 $x$；
2. 对于区间 $[l,r]$，查询：

$$a[l]^{a[l+1]^{a[l+2]^{\dots ^{a[r]}}}} \mod p$$
## 输入格式

第一行两个整数 $n,m$ 表示序列长度和操作数。

接下来一行，$n$ 个整数表示这个序列。

接下来 $m$ 行，可能是以下两种操作之一：

- $1\ l\ r\ x$ 表示区间 $[l,r]$ 加上 $x$；
- $2\ l\ r\ p$ 表示对区间 $[l,r]$ 进行一次查询，模数为 $p$。
## 输出格式

对于每个询问，输出一个数表示答案。
## 样例

### 样例输入 #1
```
6 4
1 2 3 4 5 6
2 1 2 10000007
2 2 3 5
1 1 4 1
2 2 4 10

```
### 样例输出 #1
```
1
3
1
```
### 样例输入 #2
```
5 5
2 3 3 3 3
1 1 1 530739835
2 1 1 8356089
2 1 4 5496738
1 1 2 66050181
1 2 4 138625417

```
### 样例输出 #2
```
4306230
697527

```
## 提示

Idea：nzhtl1477，Solution：nzhtl1477，Code：nzhtl1477，Data：nzhtl1477

对于100%的数据，$n , m \le 500000$ , 序列中每个数在$[1,2\cdot 10^9]$内，$p \le 2 \cdot 10^7 $, 每次加上的数在$[0,2\cdot 10^9]$内

共10组数据



---

---
title: "[NOIP 2017 提高组] 宝藏"
layout: "post"
diff: 省选/NOI-
pid: P3959
tag: ['贪心', '2017', 'NOIP 提高组', '枚举', '状压 DP']
---
# [NOIP 2017 提高组] 宝藏
## 题目背景

NOIP2017 D2T2
## 题目描述

参与考古挖掘的小明得到了一份藏宝图，藏宝图上标出了 $n$ 个深埋在地下的宝藏屋， 也给出了这 $n$ 个宝藏屋之间可供开发的 $m$ 条道路和它们的长度。

小明决心亲自前往挖掘所有宝藏屋中的宝藏。但是，每个宝藏屋距离地面都很远，也就是说，从地面打通一条到某个宝藏屋的道路是很困难的，而开发宝藏屋之间的道路则相对容易很多。

小明的决心感动了考古挖掘的赞助商，赞助商决定免费赞助他打通一条从地面到某个宝藏屋的通道，通往哪个宝藏屋则由小明来决定。

在此基础上，小明还需要考虑如何开凿宝藏屋之间的道路。已经开凿出的道路可以 任意通行不消耗代价。每开凿出一条新道路，小明就会与考古队一起挖掘出由该条道路所能到达的宝藏屋的宝藏。另外，小明不想开发无用道路，即两个已经被挖掘过的宝藏屋之间的道路无需再开发。

新开发一条道路的代价是 $\mathrm{L} \times \mathrm{K}$。其中 $L$ 代表这条道路的长度，$K$ 代表从赞助商帮你打通的宝藏屋到这条道路起点的宝藏屋所经过的宝藏屋的数量（包括赞助商帮你打通的宝藏屋和这条道路起点的宝藏屋） 。

请你编写程序为小明选定由赞助商打通的宝藏屋和之后开凿的道路，使得工程总代价最小，并输出这个最小值。

## 输入格式

第一行两个用空格分离的正整数 $n,m$，代表宝藏屋的个数和道路数。

接下来 $m$ 行，每行三个用空格分离的正整数，分别是由一条道路连接的两个宝藏屋的编号（编号为 $1-n$），和这条道路的长度 $v$。

## 输出格式

一个正整数，表示最小的总代价。

## 样例

### 样例输入 #1
```
4 5 
1 2 1 
1 3 3 
1 4 1 
2 3 4 
3 4 1 
 
```
### 样例输出 #1
```
4
```
### 样例输入 #2
```
4 5 
1 2 1 
1 3 3 
1 4 1 
2 3 4 
3 4 2  
```
### 样例输出 #2
```
5
```
## 提示

 ![](https://cdn.luogu.com.cn/upload/pic/10868.png) 

【样例解释 $1$】

小明选定让赞助商打通了 $1$ 号宝藏屋。小明开发了道路 $1 \to 2$，挖掘了 $2$ 号宝藏。开发了道路 $1 \to 4$，挖掘了 $4$ 号宝藏。还开发了道路 $4 \to 3$，挖掘了 $3$ 号宝藏。

工程总代价为 $1 \times 1 + 1 \times 1 + 1 \times 2  = 4 $。

【样例解释 $2$】

小明选定让赞助商打通了 $1$ 号宝藏屋。小明开发了道路 $1 \to 2$，挖掘了 $2$ 号宝藏。开发了道路 $1 \to 3$，挖掘了 $3$ 号宝藏。还开发了道路 $1 \to 4$，挖掘了 $4$ 号宝藏。

工程总代价为 $1 \times 1 + 3 \times 1 + 1 \times 1  = 5$。


【数据规模与约定】

对于 $ 20\%$ 的数据： 保证输入是一棵树，$1 \le n \le 8$，$v \le 5\times 10^3$ 且所有的 $v$ 都相等。

对于 $40\%$ 的数据： $1 \le n \le 8$，$0 \le m \le 10^3$，$v \le 5\times 10^3$ 且所有的 $v$ 都相等。

对于 $ 70\%$ 的数据： $1 \le n \le 8$，$0 \le m \le 10^3$，$v \le  5\times 10^3$。

对于 $ 100\%$ 的数据： $1 \le n \le 12$，$0 \le m \le 10^3$，$v \le  5\times 10^5$。

---

$\text{upd 2022.7.27}$：新增加 $50$ 组 Hack 数据。



---

---
title: "[TJOI2014] 匹配"
layout: "post"
diff: 省选/NOI-
pid: P3967
tag: ['2014', '各省省选', '枚举', '二分图', '费用流', '天津']
---
# [TJOI2014] 匹配
## 题目描述

有 $N$ 个单身的男孩和 $N$ 个单身女孩，男孩 $i$ 和女孩 $j$ 在一起得到的幸福值为 $H_{i,j}$。

一个匹配即对这 $N$ 个男孩女孩的安排：每个男孩恰好有一个女朋友，每个女孩恰好有一个男朋友。

一个匹配的幸福值即这 $N$ 对男女朋友的幸福值的和。

经典的问题是计算幸福值最大的匹配，即完美匹配。然而完美匹配有时候并不唯一，你需要计算对于所有的完美匹配，其交集是什么。
## 输入格式

输入的第一行是一个正整数 $N$ 。

接下来是一个 $N\times N$ 大小的矩阵 $H$，$H_{i,j}$ 表示男孩 $i$ 和女孩 $j$ 在一起的幸福值。
## 输出格式

第一行输出完美匹配的幸福值，接下来是若干行，每一行是一对整数 $i$ 和 $j$，表示男孩 $i$ 和女孩 $j$ 在所有完美匹配的交集中，以 $i$ 的递增顺序输出。
## 样例

### 样例输入 #1
```
3
1 1 1
2 1 1
1 1 1
```
### 样例输出 #1
```
4
2 1
```
## 提示

- 对于 $30\%$ 的数据，$N \leq 30$；
- 对于 $100\%$ 的数据，$1\leq N \leq 80$，$0\leq H_{i,j}\leq 5\times10^3$。


---

---
title: "[TJOI2015] 弦论"
layout: "post"
diff: 省选/NOI-
pid: P3975
tag: ['2015', '各省省选', '后缀自动机 SAM', '枚举', '后缀数组 SA', '天津']
---
# [TJOI2015] 弦论
## 题目描述

为了提高智商，ZJY 开始学习弦论。这一天，她在《String theory》中看到了这样一道问题：对于一个给定的长度为 $n$ 的字符串，求出它的第 $k$ 小子串是什么。你能帮帮她吗?

## 输入格式

第一行是一个仅由小写英文字母构成的字符串 $s$。

第二行为两个整数 $t$ 和 $k$，$t$ 为 $0$ 则表示不同位置的相同子串算作一个，$t$ 为 $1$ 则表示不同位置的相同子串算作多个。$k$ 的意义见题目描述。

## 输出格式

输出数据仅有一行,该行有一个字符串，为第 $k$ 小的子串。若子串数目不足 $k$ 个，则输出 $-1$。

## 样例

### 样例输入 #1
```
aabc
0 3
```
### 样例输出 #1
```
aab
```
### 样例输入 #2
```
aabc
1 3
```
### 样例输出 #2
```
aa
```
### 样例输入 #3
```
aabc
1 11
```
### 样例输出 #3
```
-1
```
## 提示

### 数据范围

对于 $10\%$ 的数据，$n\leq 1000$。

对于 $50\%$ 的数据，$t = 0$。

对于 $100\%$ 的数据，$1\leq n \leq 5 \times 10^5$，$0\leq t \leq 1$，$1\leq k \leq 10^9$。



---

---
title: "[TJOI2015] 棋盘"
layout: "post"
diff: 省选/NOI-
pid: P3977
tag: ['递推', '2015', '各省省选', '枚举', '矩阵加速', '进制', '天津', '状压 DP']
---
# [TJOI2015] 棋盘
## 题目描述

为了提高智商，ZJY 去新世界旅游了。可是旅游过后的 ZJY 杯具地发现要打开通往原来世界的门，必须要解开门上面画的谜题。谜题是这样的：

有个 $n$ 行 $m$ 列的棋盘，棋盘上可以放许多特殊的棋子。每个棋子的攻击范围是 $3$ 行 $p$ 列。输入数据用一个 $3\times p$ 的矩阵给出了棋子攻击范围的模板，棋子被默认为模板中的第 $1$ 行，第 $k$ 列，则棋子能攻击到的位置是 $1$，不能攻击到的位置是 $0$。输入数据保证第 $1$ 行第 $k$ 列的位置是 $1$。打开门的密码就是，在要求棋子互相不能攻击到的前提下，摆放棋子的方案数。注意什么棋子都不摆放也算作一种可行方案。由于方案数可能很大,而密码为 $32$ 位的二进制密码,所以 ZJY 仅需要知道方案数对 $2^{32}$ 次方取余数的结果即可。

注意：编号从 $0$ 开始，即第 $1$ 行指的是中间那行。
## 输入格式

输入数据的第一行为两个整数 $n$ 和 $m$，表示棋盘的大小。

第二行为两个整数 $p$ 和 $k$，表示接下来的攻击范围模板的大小，以及棋子在模板中的位置。

接下来三行,每行有 $p$ 个数,表示攻击范围的模版。每个数字后有一个空格。
## 输出格式

输出数据仅有一行，一个整数，表示可行的方案数模 $2^{32}$ 的余数。
## 样例

### 样例输入 #1
```
5 5
3 1
0 1 0
1 1 1
0 1 0

```
### 样例输出 #1
```
55447

```
## 提示

### 数据范围

对于 $10\%$ 的数据，$1 \leq n \leq 5$，$1 \leq m \leq5$。

对于 $50\%$ 的数据，$1 \leq n \leq 1000$，$1 \leq m \leq 6$。

对于 $100\%$ 的数据，$1 \leq n \leq 10^{6}$，$1 \leq m \leq 6$。


---

---
title: "小 Y 和地铁"
layout: "post"
diff: 省选/NOI-
pid: P4005
tag: ['模拟', '搜索', '2017', '树状数组', 'O2优化', '枚举', '模拟退火', 'CTT（清华集训/北大集训）']
---
# 小 Y 和地铁
## 题目描述

小 Y 是一个爱好旅行的 OIer。一天，她来到了一个新的城市。由于不熟悉那里的交通系统，她选择了坐地铁。

她发现每条地铁线路可以看成平面上的一条曲线，不同线路的交点处一定会设有换乘站 。通过调查得知，没有线路是环线，也没有线路与自身相交。任意两条不同的线路只会在若干个点上相交，没有重合的部分，且没有三线共点的情况。即，如图所示的情况都是不存在的：

 ![](https://cdn.luogu.com.cn/upload/pic/12055.png) 

小 Y 坐着地铁 $0$ 号线，路上依次经过了 $n$ 个换乘站。她记下了每个换乘站可以换乘的线路编号，发现每条线路与她所乘坐的线路最多只有 $2$ 个换乘站。现在小 Y 想知道，除掉她经过的换乘站以外，这个城市里最少有几个换乘站。只有你告诉她正确的答案，她才会答应下次带你去玩呢。

## 输入格式

**请注意本题有多组输入数据。**

输入数据的第一行是一个整数 $T$，表示输入数据的组数。接下来依次给出每组数据。

对于每组数据，第一行是一个整数 $n$，表示小 Y 经过的换乘站的数目。第二行为 $n$ 个用空格隔开的整数，依次表示每个换乘站的可以换乘的线路编号。这些编号都在 $1\sim n$ 之内。

## 输出格式

对于每组输入数据，输出一行一个整数，表示除掉这 $n$ 个换乘站之外，最少有几个换乘站。

## 样例

### 样例输入 #1
```
4 4
1 2 1 2
8
1 2 3 4 1 2 3 4
5
5 4 3 3 5
8
1 2 3 4 1 3 2 4
```
### 样例输出 #1
```
0 
0 
0 
1
```
## 提示

【样例 1 解释】

对于样例的前两组数据，一种可能的最优答案如下图所示。

 ![](https://cdn.luogu.com.cn/upload/pic/12053.png) 

【子任务】

一共有 $50$ 个测试点，每个测试点 $2$ 分。你只有在答案完全正确时才能得到该测试点的全部分数，否则不得分。

对于所有测试点，以及对于样例， $1 \leq T \leq 100$, $1 \leq n \leq 44$。对于每个测试点， $n$ 的范围如下表：

![](https://cdn.luogu.com.cn/upload/pic/12054.png)



---

---
title: "[SHOI2008] 循环的债务"
layout: "post"
diff: 省选/NOI-
pid: P4026
tag: ['动态规划 DP', '2008', '各省省选', '上海', '枚举', '背包 DP']
---
# [SHOI2008] 循环的债务
## 题目描述

Alice、Bob和Cynthia总是为他们之间混乱的债务而烦恼，终于有一天，他们决定坐下来一起解决这个问题。不过，鉴别钞票的真伪是一件很麻烦的事情，于是他们决定要在清还债务的时候尽可能少的交换现金。

比如说，Alice欠Bob 10元，而Cynthia和他俩互不相欠。现在假设Alice只有一张50元，Bob有3张10元和10张1元，Cynthia有3张20元。一种比较直接的做法是：Alice将50元交给Bob，而Bob将他身上的钱找给Alice，这样一共就会有14张钞票被交换。但这不是最好的做法，最好的做法是：Alice把50块给Cynthia，Cynthia再把两张20给Alice，另一张20给Bob，而Bob把一张10块给C，此时只有5张钞票被交换过。

没过多久他们就发现这是一个很棘手的问题，于是他们找到了精通数学的你为他们解决这个难题。

## 输入格式

输入的第一行包括三个整数：$x_1$、$x_2$、$x_3$（-1,000≤$x_1$，$x_2$，$x_3$≤1,000），其中

$x_1$代表Alice欠Bob的钱（如果$x_1$是负数，说明Bob欠了Alice的钱）

$x_2$代表Bob欠Cynthia的钱（如果$x_2$是负数，说明Cynthia欠了Bob的钱）

$x_3$代表Cynthia欠Alice的钱（如果$x_3$是负数，说明Alice欠了Cynthia的钱）

接下来有三行，每行包括6个自然数：

a100，a50，a20，a10，a5，a1

b100，b50，b20，b10，b5，b1

c100，c50，c20，c10，c5，c1

a100表示Alice拥有的100元钞票张数，b50表示Bob拥有的50元钞票张数，以此类推。另外，我们保证有a10+a5+a1≤30，b10+b5+b1≤30，c10+c5+c1≤30，而且三人总共拥有的钞票面值总额不会超过1,000。

## 输出格式

如果债务可以还清，则输出需要交换钞票的最少张数；如果不能还清，则输出“impossible”（注意单词全部小写，输出到文件时不要加引号）。

## 样例

### 样例输入 #1
```
10 0 0
0 1 0 0 0 0
0 0 0 3 0 10
0 0 3 0 0 0
```
### 样例输出 #1
```
5
```
### 样例输入 #2
```
-10 -10 -10
0 0 0 0 0 0
0 0 0 0 0 0
0 0 0 0 0 0
```
### 样例输出 #2
```
0
```
## 提示

对于30%的数据，$x_1$、$x_2$、$x_3$ ≤ |50|。
对于100%的数据，$x_1$、$x_2$、$x_3$ ≤ |1,000|。



---

---
title: "[JSOI2008] 魔兽地图"
layout: "post"
diff: 省选/NOI-
pid: P4037
tag: ['2008', '各省省选', '江苏', 'O2优化', '枚举', '背包 DP']
---
# [JSOI2008] 魔兽地图
## 题目描述

DotR (Defense of the Robots) Allstars是一个风靡全球的魔兽地图，他的规则简单与同样流行的地图DotA (Defense of the Ancients) Allstars。

DotR里面的英雄只有一个属性——力量。他们需要购买装备来提升自己的力量值，每件装备都可以使佩戴它的英雄的力量值提高固定的点数，所以英雄的力量值等于它购买的所有装备的力量值之和。装备分为基本装备和高级装备两种。基本装备可以直接从商店里面用金币购买，而高级装备需要用基本装备或者较低级的高级装备来合成，合成不需要附加的金币。装备的合成路线可以用一棵树来表示。

比如，Sange and Yasha的合成需要Sange,Yasha和Sange and Yasha Recipe Scroll三样物品。其中Sange又要用Ogre Axe, Belt of Giant Strength和 Sange Recipe Scroll合成。每件基本装备都有数量限制，这限制了你不能无限制地合成某些性价比很高的装备。

现在，英雄Spectre有M个金币，他想用这些钱购买装备使自己的力量值尽量高。你能帮帮他吗？他会教你魔法Haunt（幽灵附体）作为回报的。

## 输入格式

第一行包含两个整数，N (1 <= n <= 51) 和 m (0 <= m <= 2,000)。分别表示装备的种类数和金币数。装备用1到N的整数编号。

接下来的N行，按照装备1到装备n的顺序，每行描述一种装备。

每一行的第一个非负整数表示这个装备贡献的力量值。

接下来的非空字符表示这种装备是基本装备还是高级装备，A表示高级装备，B表示基本装备。如果是基本装备，紧接着的两个正整数分别表示它的单价（单位为金币）和数量限制（不超过100）。如果是高级装备，后面紧跟着一个正整数C，表示这个高级装备需要C种低级装备。后面的2C个数，依次描述某个低级装备的种类和需要的个数。

## 输出格式

第一行包含一个整数S，表示最多可以提升多少点力量值。

## 样例

### 样例输入 #1
```
10 59
5 A 3 6 1 9 2 10 1
1 B 5 3
1 B 4 3
1 B 2 3
8 A 3 2 1 3 1 7 1
1 B 5 3
5 B 3 3
15 A 3 1 1 5 1 4 1
1 B 3 5
1 B 4 3
```
### 样例输出 #1
```
33
```


---

---
title: "[JSOI2010] 冷冻波"
layout: "post"
diff: 省选/NOI-
pid: P4048
tag: ['计算几何', '2010', '各省省选', '江苏', '枚举']
---
# [JSOI2010] 冷冻波
## 题目描述

WJJ喜欢“魔兽争霸”这个游戏。在游戏中，巫妖是一种强大的英雄，它的技能Frozen Nova每次可以杀死一个小精灵。我们认为，巫妖和小精灵都可以看成是平面上的点。

当巫妖和小精灵之间的直线距离不超过R，且巫妖看到小精灵的视线没有被树木阻挡（也就是说，巫妖和小精灵的连线与任何树木都没有公共点）的话，巫妖就可以瞬间杀灭一个小精灵。

在森林里有N个巫妖，每个巫妖释放Frozen Nova之后，都需要等待一段时间，才能再次施放。不同的巫妖有不同的等待时间和施法范围，但相同的是，每次施放都可以杀死一个小精灵。

现在巫妖的头目想知道，若从0时刻开始计算，至少需要花费多少时间，可以杀死所有的小精灵？

## 输入格式

输入文件第一行包含三个整数N、M、K(N,M,K<=200)，分别代表巫妖的数量、小精灵的数量和树木的数量。

接下来N行，每行包含四个整数x, y, r, t，分别代表了每个巫妖的坐标、攻击范围和施法间隔（单位为秒）。

再接下来M行，每行两个整数x, y，分别代表了每个小精灵的坐标。

再接下来K行，每行三个整数x, y, r，分别代表了每个树木的坐标。

输入数据中所有坐标范围绝对值不超过10000，半径和施法间隔不超过20000。

## 输出格式

输出一行，为消灭所有小精灵的最短时间（以秒计算）。如果永远无法消灭所有的小精灵，则输出-1。

## 样例

### 样例输入 #1
```
2 3 1
-100 0 100 3
100 0 100 5
-100 -10
100 10
110 11
5 5 10
```
### 样例输出 #1
```
5
```


---

---
title: "[Code+#1] 大吉大利，晚上吃鸡！"
layout: "post"
diff: 省选/NOI-
pid: P4061
tag: ['动态规划 DP', '图论', 'O2优化', '枚举', '最短路', 'Code+']
---
# [Code+#1] 大吉大利，晚上吃鸡！
## 题目背景

最近《绝地求生：大逃杀》风靡全球，皮皮和毛毛也迷上了这款游戏，他们经常组队玩这款游戏。

在游戏中，皮皮和毛毛最喜欢做的事情就是堵桥，每每有一个好时机都能收到不少的快递。

当然，有些时候并不能堵桥，皮皮和毛毛会选择在其他的必经之路上蹲点。

K博士作为一个老年人，外加有心脏病，自然是不能玩这款游戏的，但是这并不能妨碍他对这款游戏进行一些理论分析，比如最近他就对皮皮和毛毛的战术很感兴趣。

## 题目描述

游戏的地图可以抽象为一张 $n$ 个点 $m$ 条无向边的图，节点编号为 $1$ 到 $n$ ，每条边具有一个正整数的长度。

**假定大魔王都会从 $S$ 点出发到达 $T$ 点（ $S$ 和 $T$ 已知），并且只会走最短路，**皮皮和毛毛会在 $A$ 点和 $B$ 点埋伏大魔王。

为了保证一定能埋伏到大魔王，同时又想留大魔王一条生路，皮皮和毛毛约定 $A$ 点和 $B$ 点必须满足：

- 大魔王所有可能路径中，必定会经过 $A$ 点和 $B$ 点中的任意一点

- 大魔王所有可能路径中，不存在一条路径同时经过 $A$ 点和 $B$ 点

K博士想知道，满足上面两个条件的 $A,B$ 点对有多少个，交换 $A,B$ 的顺序算相同的方案。

## 输入格式

第一行输入四个整数 $n,m,S,T(1 \le n \le 5 \times 10^{4}, 1 \le m \le 5 \times 10^{4}, 1 \le S,T \le n)$ ，含义见题目描述。

接下来输入 $m$ 行，每行输入三个整数 $u,v,w(1 \le u,v \le n, 1 \le w \le 10^{9})$ 表示存在一条长度为 $w$ 的边链接 $u$ 和 $v$ 。

## 输出格式

输出一行表示答案。

## 样例

### 样例输入 #1
```
7 7 1 7
1 2 2
2 4 2
4 6 2
6 7 2
1 3 2
3 5 4
5 7 2
```
### 样例输出 #1
```
6
```
### 样例输入 #2
```
5 5 1 4
1 2 1
1 3 1
2 4 1
3 4 1
4 5 1
```
### 样例输出 #2
```
3
```
### 样例输入 #3
```
6 7 1 4
1 2 1
1 3 1
2 4 1
3 4 1
4 5 1
1 6 2
6 4 2
```
### 样例输出 #3
```
5
```
## 提示

### 样例1解释

合法的方案为$<2,3>,<2,4>,<4,3>,<4,5>,<6,3>,<6,5>$ 。

 ![](https://cdn.luogu.com.cn/upload/pic/12824.png) 

来自 CodePlus 2017 11 月赛，清华大学计算机科学与技术系学生算法与竞赛协会 荣誉出品。

Credit：idea/陈宇 命题/陈宇 验题/邢健开

Git Repo：https://git.thusaac.org/publish/CodePlus201711

感谢腾讯公司对此次比赛的支持。



---

---
title: "[JXOI2017] 颜色"
layout: "post"
diff: 省选/NOI-
pid: P4065
tag: ['2017', '线段树', '各省省选', '枚举', '概率论', '栈']
---
# [JXOI2017] 颜色
## 题目描述

可怜有一个长度为 $n$ 的正整数序列 $A_i$，其中相同的正整数代表着相同的颜色。

现在可怜觉得这个序列太长了，于是她决定选择一些颜色把这些颜色的所有位置都删去。

删除颜色 $i$ 可以定义为把所有满足 $A_j = i$ 的位置 $j$ 都从序列中删去。

然而有些时候删去之后，整个序列变成了好几段，可怜不喜欢这样，于是她想要知道有多少种删去颜色的方案使得最后剩下来的序列非空且连续。

例如颜色序列 $\{1, 2, 3, 4, 5\}$，删除颜色 $3$ 后序列变成了 $\{1, 2\}$ 和 $\{4, 5\}$ 两段，不满足条件。而删除颜色 $1$ 后序列变成了 $\{2, 3, 4, 5\}$，满足条件。

两个方案不同当且仅当至少存在一个颜色 $i$ 只在其中一个方案中被删去。

## 输入格式

第一行输入一个整数 $T$ 表示数据组数。

每组数据第一行，输入一个整数 $n$ 表示数列长度；第二行输入 $n$ 个整数描述颜色序列。

## 输出格式

对于每组数据输出一个整数表示答案。
## 样例

### 样例输入 #1
```
1
5
1 3 2 4 3
```
### 样例输出 #1
```
6
```
## 提示

满足条件的删颜色方案有 $\{1\}, \{1, 3\}, \{1, 2, 3\}, \{1, 3, 4\}, \{2, 3, 4\}, \varnothing$。

对于 $20\%$ 的数据，保证 $1 \le \sum n \le  20$。

对于 $40\%$ 的数据，保证 $1 \le \sum n \le  500$。

对于 $60\%$ 的数据，保证 $1 \le \sum n \le  10^4$。

对于 $100\%$ 的数据，保证 $1 \le  T,\sum n \le  3 \times 10^5, 1 \le  A_i \le  n$。

$\text{Statement fixed by @Starrykiller.}$


---

---
title: "[USACO18FEB] Slingshot P"
layout: "post"
diff: 省选/NOI-
pid: P4088
tag: ['2018', '线段树', 'USACO', '枚举', '树套树']
---
# [USACO18FEB] Slingshot P
## 题目描述

One of the farming chores Farmer John dislikes the most is hauling around lots of cow manure. In order to streamline this process, he comes up with an intriguing idea: instead of hauling manure between two points in a cart behind his tractor, why not shoot it through the air with a giant manure slingshot? (indeed, what could possibly go wrong...)
Farmer John's farm is built along a single long straight road, so any location on his farm can be described simply using its position along this road (effectively a point on the number line). FJ builds $N$ slingshots ($1 \leq N \leq 10^5$), where the $i$th slingshot is described by three integers $x_i$, $y_i$, and $t_i$, specifying that this slingshot can shoot manure from position $x_i$ to position $y_i$ in only $t_i$ total units of time.

FJ has $M$ piles of manure to transport ($1 \leq M \leq 10^5$). The $j$th such pile needs to be moved from position $a_j$ to position $b_j$. Hauling manure with the tractor for a distance of $d$ takes $d$ units of time. FJ is hoping to reduce this by allowing up to one use of any slingshot for transporting each pile of manure. Time FJ spends moving his tractor without manure in it does not count.

For each of the $M$ manure piles, please help FJ determine the minimum possible transportation time, given that FJ can use up to one slingshot during the process.
## 输入格式

The first line of input contains $N$ and $M$. The next $N$ lines each describe a single slingshot in terms of integers $x_i$, $y_i$, and $t_i$ ($0 \leq x_i, y_i, t_i \leq 10^9$). The final $M$ lines describe piles of manure that need to be moved, in terms of integers $a_j$ and $b_j$.
## 输出格式

Print $M$ lines of output, one for each manure pile, indicating the minimum time needed to transport it.
## 样例

### 样例输入 #1
```
2 3
0 10 1
13 8 2
1 12
5 2
20 7
```
### 样例输出 #1
```
4
3
10
```
## 提示

Here, the first pile of manure needs to move from position 1 to position 12. Without using an slingshot, this would take 11 units of time. However, using the first slingshot, it takes 1 unit of time to move to position 0 (the slingshot source), 1 unit of time to fling the manure through the air to land at position 10 (the slingshot destination), and then 2 units of time to move the manure to position 12. The second pile of manure is best moved without any slingshot, and the third pile of manure should be moved using the second slingshot.

Problem credits: Brian Dean
## 题目翻译

### 题目描述

Farmer John 最不喜欢的农活之一就是到处搬运牛粪。为了简化这一过程，他想出了一个有趣的主意：与其用拖拉机后面的拖车搬运牛粪，为什么不通过一个巨大的牛粪弹弓将其射到空中呢？（确实，可能会出什么问题呢……）

Farmer John 的农场建在一条笔直的长路上，因此农场上的任何位置都可以简单地用其在这条路上的位置来描述（实际上就是数轴上的一个点）。FJ 建造了 $N$ 个弹弓（$1 \leq N \leq 10^5$），其中第 $i$ 个弹弓由三个整数 $x_i$、$y_i$ 和 $t_i$ 描述，表示这个弹弓可以将牛粪从位置 $x_i$ 射到位置 $y_i$，仅需 $t_i$ 个单位时间。

FJ 有 $M$ 堆牛粪需要搬运（$1 \leq M \leq 10^5$）。第 $j$ 堆牛粪需要从位置 $a_j$ 搬运到位置 $b_j$。用拖拉机搬运牛粪，每移动距离 $d$ 需要 $d$ 个单位时间。FJ 希望通过允许每堆牛粪最多使用一次弹弓来减少搬运时间。FJ 在没有牛粪的情况下移动拖拉机的时间不计入搬运时间。

对于每堆牛粪，请帮助 FJ 确定在最多使用一次弹弓的情况下，搬运所需的最少时间。

### 输入格式

输入的第一行包含 $N$ 和 $M$。接下来的 $N$ 行每行描述一个弹弓，包含三个整数 $x_i$、$y_i$ 和 $t_i$（$0 \leq x_i, y_i, t_i \leq 10^9$）。最后的 $M$ 行描述需要搬运的牛粪堆，每行包含两个整数 $a_j$ 和 $b_j$。

### 输出格式

输出 $M$ 行，每行对应一堆牛粪，表示搬运所需的最少时间。

### 提示

在这里，第一堆牛粪需要从位置 $1$ 搬运到位置 $12$。如果不使用弹弓，这将花费 $11$ 个单位时间。然而，使用第一个弹弓，花费 $1$ 个单位时间将牛粪移动到位置 $0$（弹弓的起点），$1$ 个单位时间将牛粪射到位置 $10$（弹弓的终点），然后花费 $2$ 个单位时间将牛粪移动到位置 $12$。第二堆牛粪最好不使用弹弓搬运，而第三堆牛粪应使用第二个弹弓搬运。

题目来源：Brian Dean


---

---
title: "[HEOI2013] ALO"
layout: "post"
diff: 省选/NOI-
pid: P4098
tag: ['2013', '各省省选', '河北', '枚举', '可持久化', '字典树 Trie']
---
# [HEOI2013] ALO
## 题目描述

Welcome to ALO (Arithmetic and Logistic Online）。这是一个 VR MMORPG，如名字所见，到处充满了数学的谜题。

现在你拥有 $n$ 颗宝石，第 $i$ 颗宝石有一个能量密度，记为 $a_i$，这些宝石的能量密度**两两不同**。现在你可以选取**连续**的一些宝石（必须多于一个）进行融合，设他们的能量密度为 $a_i,a_{i+1},\cdots,a_j$，则融合而成的宝石的能量密度为这些宝石中能量密度的次大值与其他任意一颗宝石的能量密度按位异或的值的最大值。即，假设该段宝石能量密度次大值为 $k$，则生成的宝石的能量密度为 $\max\{k\oplus a_p\mid a_p\ne k, i\le p\le j\}$。

现在你需要知道你怎么选取需要融合的宝石，才能使生成的宝石能量密度最大。
## 输入格式

第一行，一个整数 $n$，表示宝石个数。

第二行，$n$ 个整数，分别表示 $a_1$ 至 $a_n$，表示每颗宝石的能量密度，保证对于 $i\ne j$ 有 $a_i\ne a_j$。
## 输出格式

输出一行一个整数，表示最大能生成的宝石能量密度。

## 样例

### 样例输入 #1
```
5 
9 2 1 4 7
```
### 样例输出 #1
```
14
```
## 提示

### 样例解释

选择区间 $[1,5]$，最大值为 $7\oplus 9 = 14$。

### 数据规模与约定

- 对于 $20\%$ 的数据有 $n\le 100$；
- 对于 $50\%$ 的数据有 $n\le 2000$；
- 对于 $100\%$ 的数据有 $1\le n\le 50000$，$0\le a_i\le 10^9$。

2023.4.28：添加两组 hack 数据，不计分。


---

---
title: "[HEOI2013] SAO"
layout: "post"
diff: 省选/NOI-
pid: P4099
tag: ['动态规划 DP', '2013', '各省省选', '河北', '枚举', '拓扑排序', '前缀和']
---
# [HEOI2013] SAO
## 题目描述

Welcome to SAO ( Strange and Abnormal Online)。这是一个 VR MMORPG， 含有 n 个关卡。但是，挑战不同关卡的顺序是一个很大的问题。

某款游戏有 $n-1$ 个对于挑战关卡的限制，诸如第 $i$ 个关卡必须在第 $j$ 个关卡前挑战，或者完成了第 $k$ 个关卡才能挑战第 $l$ 个关卡。并且，如果不考虑限制的方向性，那么在这 $n-1$ 个限制的情况下，任何两个关卡都存在某种程度的关联性。即，我们不能把所有关卡分成两个非空且不相交的子集，使得这两个子集之间没有任何限制。

## 输入格式

第一行，一个整数 $T$，表示数据组数。

对于每组数据，第一行一个整数 $n$，表示关卡数。接下来 $n - 1$ 行，每行为 $i \text{ sign } j$，其中 $0 \leq i, j \leq n - 1$ 且 $i \neq j$，$\text{sign}$ 为 $\tt{<}$ 或者 $\tt{>}$，表示第 $i$ 个关卡必须在第 $j$ 个关卡前或后完成。

## 输出格式

对于每个数据，输出一行一个整数，为攻克关卡的顺序方案个数，$\bmod (10^9+7)$ 输出。

## 样例

### 样例输入 #1
```
2 
5 
0 < 2 
1 < 2 
2 < 3 
2 < 4 
4 
0 < 1 
0 < 2 
0 < 3
```
### 样例输出 #1
```
4 
6
```
## 提示

对于 $20\%$ 的数据有 $n \le 10$。

对于 $40\%$ 的数据有 $n \le 100$。

对于另外 $20\%$ 的数据有，保证数据中 sign 只会是 <，并且 $i<j$。

对于 $100\%$ 的数据有 $T \le 5$，$1 \le n \le 1000$。


---

---
title: "[HEOI2015] 公约数数列"
layout: "post"
diff: 省选/NOI-
pid: P4108
tag: ['2015', '各省省选', '河北', '枚举']
---
# [HEOI2015] 公约数数列
## 题目描述

设计一个数据结构. 给定一个正整数数列 $a_0, a_1, \cdots, a_{n - 1}$，你需要支持以下两种操作：


1. $\text{\texttt{MODIFY} \textit{id} \textit{x}}$：将 $a_{id}$ 修改为 $x$；
2. $\text{\texttt{QUERY} \textit{x}}$：求最小的整数 $p \ (0 \le p < n)$，使得 $\gcd(a_0, a_1, \cdots, a_p) \times  \operatorname{xor}(a_0, a_1, \cdots, a_p) = x$。其中 $\operatorname{xor}(a_0, a_1, \cdots, a_p)$ 代表 $a_0, a_1, \cdots, a_p$ 的异或和，$\gcd$ 表示最大公约数。

## 输入格式

第一行包含一个正整数 $n$。

接下来一行包含 $n$ 个正整数 $a_0,a_1,\cdots,a_{n-1}$。

之后一行包含一个正整数 $q$，表示询问的个数。

之后 $q$ 行，每行包含一个询问。格式如题目中所述。
## 输出格式

对于每个 $\texttt{QUERY}$ 询问，在单独的一行中输出结果。如果不存在这样的 $p$，输出 `no`。
## 样例

### 样例输入 #1
```
10
1353600 5821200 10752000 1670400 3729600 6844320 12544000 117600 59400 640
10
MODIFY 7 20321280
QUERY 162343680
QUERY 1832232960000
MODIFY 0 92160
QUERY 1234567
QUERY 3989856000
QUERY 833018560
MODIFY 3 8600
MODIFY 5 5306112
QUERY 148900352
```
### 样例输出 #1
```
6
0
no
2
8
8
```
## 提示

### 数据范围及约定

- 对于 $30\%$ 的数据，$n\le10^4$，$q\le 1000$。
- 对于 $100\%$ 的数据，$n\le10^5$，$q\le 10000$，$1\le a_i\le 10^9$，询问操作中 $x \le 10^{18}$，修改操作中 $0\le id<n$，$1\le x\le 10^9$。


---

---
title: "[WC2005] 友好的生物"
layout: "post"
diff: 省选/NOI-
pid: P4131
tag: ['2005', 'Special Judge', '枚举', 'WC', '状压 DP']
---
# [WC2005] 友好的生物
## 题目描述

$W$ 星球是一个和地球一样气候适宜、物种聚集的星球。经过多年的研究，外星生物学家们已经发现了数万种生物，而且这个数字还在不断增大。

$W$ 星球上的生物很有趣，有些生物之间很友好，朝夕相伴，形影不离；但有些却很敌对，一见面就难免发生战斗。为了能够更好地了解它们之间的友好程度，外星生物学家希望进行一些量化的计算。他们发现，两种生物之间的友好程度和它们的 $K$ 种属性有关，暂且将它们编号为属性 $1$、属性 $2$、……、属性 $K$，这些属性都是可以进行量化的。外星生物学家研究发现，如果前 $K-1$ 种属性的差别越大，这两种生物就越友好；但是属性 $K$ 与众不同，这种属性差别越小的两种生物越友好。

因此他们猜想是不是可以用这样一个公式量化两种生物之间的友好程度：$Friendliness=(\sum_{i=1}^{k-1} C_id_i)-C_Kd_K$

其中 $C_i$ 是非负常数，$d_i$ 是属性 $i$ 的差别。如果知道了每种生物的各种属性，利用上述公式就很容易算出它们之间的友好程度了。现在，外星生物学家们想问一问：在目前发现的这些生物当中，关系最友好的那对生物是哪一对呢？它们之间的友好程度是多少？

## 输入格式

输入文件的第一行是两个整数 $N$ 和 $K$，分别表示目前发现的生物种数和属性的种数。

第二行有 $K$ 个非负整数 $C_i$，即计算友好程度时所需的常数。

接下来的 $N$ 行，描述每种生物，按照先后顺序依次编号为生物 $1$、生物 $2$、……、生物 $N$。每一行都有 $K$ 个整数，给出该种生物的各项属性值，按照先后顺序依次编号为属性 $1$、属性 $2$、……、属性 $K$。

## 输出格式

输出文件包含两行。第一行为两个整数 $i$ 和 $j$（$i \neq j$），表示你所找到的关系最友好的两种生物为生物 $i$ 和生物 $j$。若最友好的不止一对，输出任意一对。

第二行为一个整数，表示生物 $i$ 和生物 $j$ 之间的友好程度。

## 样例

### 样例输入 #1
```
5 3
1 2 3
-5 3 2
-2 3 0
0 5 9
3 4 -1
-10 -11 7
```
### 样例输出 #1
```
3 5
36
```
## 提示

【样例说明】

生物 $3$ 和 $5$ 之间的友好程度为 $1\times |0-(-10)|+2\times |5-(-11)|-3\times |9-7|=36$。

【约定】

- $2 \leq N \leq 100,000$

- $2 \leq K \leq 5$

- $0 \leq C_i \leq 100$。

- 每种生物的各项属性值不小于$-10000$ 且不大于 $10000$。

- 最大的友好程度一定大于 $0$。



---

---
title: "作诗"
layout: "post"
diff: 省选/NOI-
pid: P4135
tag: ['O2优化', '枚举', '分块']
---
# 作诗
## 题目背景

神犇 SJY 虐完 HEOI 之后给傻× LYD 出了一题：

SHY 是 T 国的公主，平时的一大爱好是作诗。
## 题目描述

由于时间紧迫，SHY 作完诗之后还要虐 OI，于是 SHY 找来一篇长度为 $n$ 的文章，阅读 $m$ 次，每次只阅读其中连续的一段 $[l,r]$，从这一段中选出一些汉字构成诗。因为 SHY 喜欢对偶，所以 SHY 规定最后选出的每个汉字都必须在 $[l,r]$ 里出现了正偶数次。而且 SHY 认为选出的汉字的种类数（两个一样的汉字称为同一种）越多越好（为了拿到更多的素材！）。于是 SHY 请 LYD 安排选法。

LYD 这种傻×当然不会了，于是向你请教……

问题简述：给定 $n$ 个不大于 $c$ 的正整数 $a_1 \dots a_n$ 和 $m$ 组询问，每次问 $[l,r]$ 中有多少个数出现正偶数次。
## 输入格式

**本题强制在线**。

第一行有三个整数 $n$、$c$ 以及 $m$ 。表示文章字数、汉字的种类数、要选择 $m$ 次。

第二行有 $n$ 个整数，第 $i$ 个整数表示第 $i$ 个汉字的编码 $a_i$。

接下来 $m$ 行每行两个整数 $l$ 和 $r$，设上一个询问的答案为 $ans$（第一个询问时 $ans=0$），令 $L=((l+ans)\bmod n)+1$，$R=((r+ans)\bmod n)+1$，若 $L>R$，交换 $L$ 和 $R$，则本次询问为 $[L,R]$。
## 输出格式

输出共 $m$ 行，每行一个整数，第 $i$ 个数表示 SHY 第 $i$ 次能选出的汉字的最多种类数。
## 样例

### 样例输入 #1
```
5 3 5
1 2 2 3 1
0 4
1 2
2 2
2 3
3 5
```
### 样例输出 #1
```
2
0
0
0
1
```
## 提示

#### 数据规模与约定

对于 $100\%$ 的数据，$1\le n,c,m\le 10^5$，$1 \leq a_i \leq c$，$1 \leq l, r \leq n$。


---

---
title: "[WC2011] 最大XOR和路径"
layout: "post"
diff: 省选/NOI-
pid: P4151
tag: ['图论', '贪心', '2011', '枚举', '深度优先搜索 DFS', '线性基', '向量', 'WC']
---
# [WC2011] 最大XOR和路径
## 题目描述

XOR（异或）是一种二元逻辑运算，其运算结果当且仅当两个输入的布尔值不相等时才为真，否则为假。 XOR 运算的真值表如下（$1$ 表示真， $0$ 表示假）：

| 输入 | 输入 | 输出 |
| :----------: | :----------: | :----------: |
| A | B | A XOR B |
| 0 | 0 | 0 |
| 0 | 1 | 1 |
| 1 | 0 | 1 |
| 1 | 1 | 0 |


而两个非负整数的 XOR 是指将它们表示成二进制数，再在对应的二进制位进行 XOR 运算。

譬如 $12$ XOR $9$ 的计算过程如下：

$$
12=(1100)_2\ \ \ 9=(1001)_2\\
\begin{matrix}
&1\ 1\ 0\ 0\\
\text{XOR}&1\ 0\ 0\ 1\\
\hline
&0\ 1\ 0\ 1\\
\end{matrix}\\
(0101)_2=5
$$

故 $12$ XOR $9 = 5$。

容易验证， XOR 运算满足交换律与结合律，故计算若干个数的 XOR 时，不同的计算顺序不会对运算结果造成影响。从而，可以定义 $K$ 个非负整数 $A_1$，$A_2$，……，$A_{K-1}$，$A_K$的 XOR 和为

$A_1$ XOR $A_2$ XOR …… XOR $A_{K-1}$ XOR $A_K$

考虑一个边权为非负整数的无向连通图，节点编号为 $1$ 到 $N$，试求出一条从 $1$ 号节点到 $N$ 号节点的路径，使得路径上经过的边的权值的 XOR 和最大。

路径可以重复经过某些点或边，当一条边在路径中出现了多次时，其权值在计算 XOR 和时也要被计算相应多的次数，具体见样例。

## 输入格式

输入文件 xor.in 的第一行包含两个整数 $N$ 和 $M$， 表示该无向图中点的数目与边的数目。

接下来 $M$ 行描述 $M$ 条边，每行三个整数 $S_i$， $T_i$ ， $D_i$， 表示 $S_i$ 与 $T_i$ 之间存在一条权值为 $D_i$ 的无向边。

图中可能有重边或自环。

## 输出格式

输出文件 xor.out 仅包含一个整数，表示最大的 XOR 和（十进制结果）。

## 样例

### 样例输入 #1
```
5 7
1 2 2
1 3 2
2 4 1
2 5 1
4 5 3
5 3 4
4 3 2
```
### 样例输出 #1
```
6
```
## 提示

【样例说明】

![](https://cdn.luogu.com.cn/upload/image_hosting/p6bf4fgf.png)

如图，路径$1 \rightarrow 2 \rightarrow 4 \rightarrow 3 \rightarrow 5 \rightarrow 2 \rightarrow 4 \rightarrow 5$对应的XOR和为

$2$ XOR $1$ XOR $2$ XOR $4$ XOR $1$ XOR $1$ XOR $3 = 6$

当然，一条边数更少的路径$1 \rightarrow 3 \rightarrow 5$对应的XOR和也是$2$ XOR $4 = 6$。

【数据规模】

对于 $20 \%$ 的数据，$N \leq 100$， $M \leq 1000$，$D_i \leq 10^{4}$；

对于 $50 \%$ 的数据，$N \leq 1000$， $M \leq 10000$，$D_i \leq 10^{18}$；

对于 $70 \%$ 的数据，$N \leq 5000$， $M \leq 50000$，$D_i \leq 10^{18}$；

对于 $100 \%$ 的数据，$N \leq 50000$， $M \leq 100000$，$D_i \leq 10^{18}$。





---

---
title: "[SCOI2007] 组队"
layout: "post"
diff: 省选/NOI-
pid: P4165
tag: ['2007', '四川', '各省省选', '枚举', '排序']
---
# [SCOI2007] 组队
## 题目描述

NBA每年都有球员选秀环节。通常用速度和身高两项数据来衡量一个篮球运动员的基本素质。假如一支球队里速度最慢的球员速度为minV，身高最矮的球员高度为minH，那么这支球队的所有队员都应该满足: A × ( height – minH ) + B × ( speed – minV ) <= C 其中A和B，C为给定的经验值。这个式子很容易理解，如果一个球队的球员速度和身高差距太大，会造成配合的不协调。

请问作为球队管理层的你，在N名选秀球员中，最多能有多少名符合条件的候选球员。

## 输入格式

第一行四个数N、A、B、C 下接N行每行两个数描述一个球员的height和speed

## 输出格式

最多候选球员数目。

## 样例

### 样例输入 #1
```
4 1 2 10
5 1
3 2
2 3
2 1
```
### 样例输出 #1
```
4
```
## 提示

数据范围： N <= 5000 ,height和speed不大于10000。A、B、C在长整型以内。




---

---
title: "[SCOI2007] 最大土地面积"
layout: "post"
diff: 省选/NOI-
pid: P4166
tag: ['2007', '四川', '各省省选', '枚举', '向量', '凸包', '叉积']
---
# [SCOI2007] 最大土地面积
## 题目描述

在某块平面土地上有N个点，你可以选择其中的任意四个点，将这片土地围起来，当然，你希望这四个点围成的多边形面积最大。

## 输入格式

第1行一个正整数N，接下来N行，每行2个数x,y，表示该点的横坐标和纵坐标。

## 输出格式

最大的多边形面积，答案精确到小数点后3位。

## 样例

### 样例输入 #1
```
5
0 0
1 0
1 1
0 1
0.5 0.5
```
### 样例输出 #1
```
1.000
```
## 提示

数据范围 n<=2000, |x|,|y|<=100000



---

---
title: "[Violet] 蒲公英"
layout: "post"
diff: 省选/NOI-
pid: P4168
tag: ['离散化', 'O2优化', '枚举', '分块']
---
# [Violet] 蒲公英
## 题目背景

亲爱的哥哥：

你在那个城市里面过得好吗？

我在家里面最近很开心呢。昨天晚上奶奶给我讲了那个叫「绝望」的大坏蛋的故事的说！它把人们的房子和田地搞坏，还有好多小朋友也被它杀掉了。我觉得把那么可怕的怪物召唤出来的那个坏蛋也很坏呢。不过奶奶说他是很难受的时候才做出这样的事的……

最近村子里长出了一大片一大片的蒲公英。一刮风，这些蒲公英就能飘到好远的地方了呢。我觉得要是它们能飘到那个城市里面，让哥哥看看就好了呢！

哥哥你要快点回来哦！

爱你的妹妹 Violet

Azure 读完这封信之后微笑了一下。

“蒲公英吗……”

## 题目描述

在乡下的小路旁种着许多蒲公英，而我们的问题正是与这些蒲公英有关。

为了简化起见，我们把所有的蒲公英看成一个长度为 $n$ 的序列 $\{a_1,a_2..a_n\}$，其中 $a_i$ 为一个正整数，表示第 $i$ 棵蒲公英的种类编号。

而每次询问一个区间 $[l, r]$，你需要回答区间里出现次数最多的是哪种蒲公英，如果有若干种蒲公英出现次数相同，则输出种类编号最小的那个。

**注意，你的算法必须是在线的**。

## 输入格式

第一行有两个整数，分别表示蒲公英的数量 $n$ 和询问次数 $m$。

第二行有 $n$ 个整数，第 $i$ 个整数表示第 $i$ 棵蒲公英的种类 $a_i$。

接下来 $m$ 行，每行两个整数 $l_0, r_0$，表示一次询问。输入是加密的，解密方法如下：

令上次询问的结果为 $x$（如果这是第一次询问，则 $x = 0$），设 $l=((l_0+x-1)\bmod n) + 1,r=((r_0+x-1) \bmod n) + 1$。如果 $l > r$，则交换 $l, r$。  
最终的询问区间为计算后的 $[l, r]$。

## 输出格式

对于每次询问，输出一行一个整数表示答案。

## 样例

### 样例输入 #1
```
6 3 
1 2 3 2 1 2 
1 5 
3 6 
1 5

```
### 样例输出 #1
```
1 
2 
1

```
## 提示

#### 数据规模与约定

- 对于 $20\%$ 的数据，保证 $n,m \le 3000$。
- 对于 $100\%$ 的数据，保证 $1\le n \le 40000$，$1\le m \le 50000$，$1\le a_i \le 10^9$，$1 \leq l_0, r_0 \leq n$。



---

---
title: "[USACO18JAN] Lifeguards P"
layout: "post"
diff: 省选/NOI-
pid: P4182
tag: ['动态规划 DP', '2018', 'USACO', '单调队列', '枚举', '队列']
---
# [USACO18JAN] Lifeguards P
## 题目描述

Farmer John has opened a swimming pool for his cows, figuring it will help them relax and produce more milk.

To ensure safety, he hires $N$ cows as lifeguards, each of which has a shift that covers some contiguous interval of time during the day. For simplicity, the pool is open from time $0$ until time $10^9$ on a daily basis, so each shift can be described by two integers, giving the time at which a cow starts and ends her shift. For example, a lifeguard starting at time $t = 4$ and ending at time $t = 7$ covers three units of time (note that the endpoints are "points" in time).


Unfortunately, Farmer John hired $K$ more lifeguards than he has the funds to support. Given that he must fire exactly $K$ lifeguards, what is the maximum amount of time that can still be covered by the shifts of the remaining lifeguards? An interval of time is covered if at least one lifeguard is present.

## 输入格式

The first line of input contains $N$ and $K$ ($K \leq N \leq 100,000, 1 \leq K \leq 100$). Each of the next $N$ lines describes a lifeguard in terms of two integers in the range $0 \ldots 10^9$, giving the starting and ending point of a lifeguard's shift. All such endpoints are distinct. Shifts of different lifeguards might overlap.

## 输出格式

Please write a single number, giving the maximum amount of time that can still be covered if Farmer John fires $K$ lifeguards.

## 样例

### 样例输入 #1
```
3 2
1 8
7 15
2 14
```
### 样例输出 #1
```
12

```
## 提示

In this example, FJ should fire the lifeguards covering $1 \ldots 8$ and $7 \ldots 15$.


## 题目翻译

### 题目描述

Farmer John 为他的奶牛们开设了一个游泳池，认为这将帮助它们放松并产更多的奶。

为了确保安全，他雇佣了 $N$ 头奶牛作为救生员，每头奶牛的班次覆盖一天中的某个连续时间段。为简单起见，游泳池每天从时间 $0$ 开放到时间 $10^9$，因此每个班次可以用两个整数描述，分别表示奶牛开始和结束其班次的时间。例如，一头救生员从时间 $t = 4$ 开始到时间 $t = 7$ 结束，覆盖了 $3$ 个单位的时间（注意端点表示时间点）。

不幸的是，Farmer John 多雇佣了 $K$ 名救生员，超出了他的资金支持范围。鉴于他必须解雇恰好 $K$ 名救生员，剩下的救生员的班次能够覆盖的最长时间是多少？如果至少有一名救生员在场，则某个时间段被视为被覆盖。

### 输入格式

输入的第一行包含 $N$ 和 $K$（$K \leq N \leq 100,000$，$1 \leq K \leq 100$）。接下来的 $N$ 行每行描述一名救生员，用两个范围在 $0 \ldots 10^9$ 的整数表示该救生员班次的开始和结束时间。所有端点都是唯一的。不同救生员的班次可能会重叠。

### 输出格式

请输出一个数字，表示如果 Farmer John 解雇 $K$ 名救生员后，剩下的救生员的班次能够覆盖的最长时间。

### 提示

在这个例子中，Farmer John 应该解雇覆盖 $1 \ldots 8$ 和 $7 \ldots 15$ 的救生员。


---

---
title: "【模板】扩展 BSGS/exBSGS"
layout: "post"
diff: 省选/NOI-
pid: P4195
tag: ['O2优化', '枚举', '素数判断,质数,筛法', '分块', '大步小步算法 BSGS']
---
# 【模板】扩展 BSGS/exBSGS
## 题目背景

题目来源：SPOJ3105 Mod
## 题目描述

给定 $a,p,b$，求满足 $a^x≡b \pmod p$ 的最小自然数 $x$ 。

## 输入格式

每个测试文件中包含若干组测试数据，保证 $\sum \sqrt p\le 5\times 10^6$。

每组数据中，每行包含 $3$ 个正整数 $a,p,b$ 。

当 $a=p=b=0$ 时，表示测试数据读入完全。

## 输出格式

对于每组数据，输出一行。

如果无解，输出 `No Solution`，否则输出最小自然数解。

## 样例

### 样例输入 #1
```
5 58 33
2 4 3
0 0 0
```
### 样例输出 #1
```
9
No Solution
```
## 提示

对于 $100\%$ 的数据，$1\le a,p,b≤10^9$ 或 $a=p=b=0$。

2021/5/14 加强 by [SSerxhs](https://www.luogu.com.cn/user/29826)。  
2021/7/1 新添加[一组 Hack 数据](https://www.luogu.com.cn/discuss/391666)。


---

---
title: "万径人踪灭"
layout: "post"
diff: 省选/NOI-
pid: P4199
tag: ['字符串', '枚举', '快速傅里叶变换 FFT']
---
# 万径人踪灭
## 题目背景

保先生是个好司机，总是开车带学生们上山玩。但是保先生去年开了最后一趟车后，由于一些奇奇怪怪的原因转行了。半年间，再也没有从这条路上山的人了。

当 VFleaKing 再次来到这座山玩的时候，发现已经没有往日的来来往往的游人了。算了，过去保先生还在的时候，来山上玩的人，也不全是来欣赏山上的风景的。
## 题目描述

如果机房马上要关门了，或者你急着要走，请直接跳到第六个自然段。

VFleaKing 注意到了这条上山下山的土路，有些地方能欣赏到美景，有些地方则不能。把上山的道路每 $10$ cm 分为一小段，则对于每一小段，用 `a` 表示能欣赏到美景，用 `b` 表示不能欣赏到美景，就能得到一个只含 `a`、`b` 的字符串 $s$。当然由于下山和上山是一条路，所以下山的道路的字符串就是将上山的道路的字符串反过来。

设上山字符串长度为 $n$，每个字符依次为 $s_1, s_2 .…, s_n$。在上山和下山的路上，VFleaKing 会选择某些小段查看旁边的景色，其他时间低头走路。即 VFleaKing 会选择 $k$ 个小段 $x_1, x_2 …x_k$，且 $k >0$，$1\le x_1<x_2<…<x_k\le n$，VFleaKing 上山和下山的过程中会在这些地方查看景色。

![](https://cdn.luogu.com.cn/upload/image_hosting/t9qpo3f9.png)

VFleaKing 希望，上山下山时看到的美景的情况相同。也就是说，VFleaKing 上山时是否看到了美景的情况是： $s_{x_1},s_{x_2},\cdots,s_{x_k}$ 记为字符序列 $T_1$，下山时是否看到了美景的情况是：$s_{x_k},s_{x_{k-1}},\cdots,s_{x_1}$ 记为字符序列 $T_2$。VFleaKing 希望 $T_1=T_2$。

VFleaKing 还希望，上山下山时查看景色的间隔相等。也就是说，上山时查看景色的间隔为：$x_2-x_1,x_3-x_2,x_k-x_{k-1}$，记为数列 $P_1$。下山时查看景色的间隔为：$x_k-x_{k-1},x_{k-1}-x_{k-2},…,x_2-x_1$，记为数列 $P_2$。VFleaKing 希望 $P_1=P_2$。

VFleaKing 觉得，如果第一次查看景色和最后一次查看景色这段时间里，没有一次低头看路他就会摔倒。也就是说，如果对于所有 $1\le i\le k$ 都有$x_i=x_1+i- 1$，VFleaKing 就会摔倒，VFleaKing不希望发生这样的情况。

就是要在一个只含 `a`、`b` 的字符串中选取一个子序列，使得:

1. 位置和字符都关于某条对称轴对称。
2. 不能是连续的一段。

以 $s = \texttt{"abaaaaabbabbabaa"}$ 为例。如果我们用符号 $[a_1, a_2,…,a_k]$ 表示一个序列，那么 $[1,4]$ 就是一个合法的序列 $x$，$[5,8,10,12,15]$ 也是，$[4,5,8,9,10,11,12,15,16]$ 也是。但是 $[1,2]$ 不满足 VFleaKing 第一个希望和第三个希望，所以不是。$[1,2,4]$ 不满足第二个希望，所以不是。$[9,10,11]$ 不满足第三个希望，所以不是。

![](https://cdn.luogu.com.cn/upload/image_hosting/6849dqla.png)

给你字符串 $s$，现在 VFleaKing 想知道，有多少个合法的 $x$。答案可能很大，VFleaKing 想知道对 $1000000007$ 取模的值。
## 输入格式

一行，一个只包含 `a`、`b` 的两种字符的字符串。
## 输出格式

一行，一个非负整数表示问题的答案。
## 样例

### 样例输入 #1
```
abaabaa
```
### 样例输出 #1
```
14
```
### 样例输入 #2
```
aaabbbaaa
```
### 样例输出 #2
```
44
```
### 样例输入 #3
```
aaaaaaaa
```
### 样例输出 #3
```
53
```
## 提示

## 样例解释

### 样例解释 1

$14$ 个方案分别是：

- $[1,3]$，$[1,4]$，$[2,5]$，$[1,6]$，$[3,6]$，$[4,6]$，$[1,7]$，$[3,7]$，$[4,7]$；
- $[1,4,7]$，$[3,5,7]$；
- $[1,3,4,6]$，$[1,2,5,6]$，$[3,4,6,7]$。

### 样例解释 2

我已经想到了一个绝妙的解释，可惜方案太多，写不下了。

### 样例解释 3

我已经想到了一个绝妙的解释，可惜方案太多，写不下了。

## 数据范围

- 其中 $10\%$ 的数据，字符串仅包含字母 `a` 或字母 `b`。
- 另有 $20\%$ 的数据，$n\le 1000$。
- 另有 $20\%$ 的数据，要么 `a` 的个数不超过 $10$，要么 `a` 的个数不超过 $10$。
- 另有 $10\%$ 的数据，$n\le 10000$。
- 对于 $100\%$ 的数据，$n \le 100000$。

## 来源

- 2013 湖北互测 week1
- bzoj 3160
- 信息学奥赛之数学一本通
- stong9070 整理




---

---
title: "[NOI2005] 智慧珠游戏"
layout: "post"
diff: 省选/NOI-
pid: P4205
tag: ['搜索', '2005', 'NOI', '枚举', '剪枝', 'Dancing Links']
---
# [NOI2005] 智慧珠游戏
## 题目描述

智慧珠游戏拼盘由一个三角形盘件和 12 个形态各异的零件组成。拼盘的盘 件如图 1 所示
![](https://cdn.luogu.com.cn/upload/pic/13767.png)
![](https://cdn.luogu.com.cn/upload/pic/13768.png)
![](https://cdn.luogu.com.cn/upload/pic/13769.png)
对 于 由珠子构成的零件，可以放到盘件的任一位置，条件是能有地方放，且 尺寸合适，所有的零件都允许旋转(0º、90º、180º、270º)和翻转(水平、竖直)。
 
 
现给出一个盘件的初始布局，求一种可行的智慧珠摆放方案，使所有的零件 都能放进盘件中。 
## 输入格式

文件中包含初始的盘件描述，一共有 10 行，第 i 行有 i 个字符。如果第 i 行 的第 j 个字符是字母”A”至”L”中的一个，则表示第 i 行第 j 列的格子上已经放了 零件，零件的编号为对应的字母。如果第 i 行的第 j 个字符是”.”，则表示第 i 行 第 j 列的格子上没有放零件。
输入保证预放的零件已摆放在盘件中。
## 输出格式

如果能找到解，向输出文件打印 10 行，为放完全部 12 个零件后的布局。其 中，第 i 行应包含 i 个字符，第 i 行的第 j 个字符表示第 i 行第 j 列的格子上放的 是哪个零件。 如果无解，输出单独的一个字符串‘No solution’(不要引号，请注意大小写)。
 所有的数据保证最多只有一组解
## 样例

### 样例输入 #1
```
.
..
...
....
.....
.....C
...CCC.
EEEHH...
E.HHH....
E.........
```
### 样例输出 #1
```
B
BK
BKK
BJKK
JJJDD
GJGDDC
GGGCCCI
EEEHHIIA
ELHHHIAAF
ELLLLIFFFF
```


---

---
title: "最小差值生成树"
layout: "post"
diff: 省选/NOI-
pid: P4234
tag: ['图论', 'O2优化', '枚举', '深度优先搜索 DFS', '生成树', '动态树 LCT']
---
# 最小差值生成树
## 题目描述

给定一个点标号从 $1$ 到 $n$ 的、有 $m$ 条边的无向图，求边权最大值与最小值的差值最小的生成树。图可能存在自环。
## 输入格式

第一行有两个整数，表示图的点数 $n$ 和边数 $m$。

接下来 $m$ 行，每行三个整数 $u, v, w$，表示存在一条连接 $u, v$ 长度为 $w$ 的边。
## 输出格式

输出一行一个整数，表示答案。

## 样例

### 样例输入 #1
```
4 6 
1 2 10 
1 3 100 
1 4 90 
2 3 20 
2 4 80 
3 4 40 

```
### 样例输出 #1
```
20
```
## 提示

#### 数据规模与约定

- 对于 $30\%$ 的数据，保证 $n \leq 100$，$m \leq 10^3$。
- 对于 $97\%$ 的数据，保证 $n \leq 500$，$m \leq 10^5$。
- 对于 $100\%$ 的数据，保证 $1 \leq n \leq 5 \times 10^4$，$1 \leq m \leq 2 \times 10^5$，$1 \leq u, v \leq n$，$1 \leq w \leq 10^4$。


---

---
title: "采摘毒瘤"
layout: "post"
diff: 省选/NOI-
pid: P4241
tag: ['枚举', '背包 DP']
---
# 采摘毒瘤
## 题目背景

Salamander见到路边有如此多的毒瘤，于是见猎心喜，从家里拿来了一个大袋子，准备将一些毒瘤带回家。

## 题目描述

路边共有$n$种不同的毒瘤，第$i$种毒瘤有$k_i$个，每个需要占据$d_i$的空间。Salamander的袋子能装下的最大体积为$m$。


Salamander是一个很贪心的人，不过他也**不要求**带尽可能多或是总体积尽可能大的毒瘤回家，他只要求袋子里**再也装不下剩余的任何一种毒瘤**。


Salamander想知道有多少种不同的装毒瘤的方案。两种方案不同当且仅当取的毒瘤种类不同或者至少有一种毒瘤取的数量不同。由于方案数可能太多，请输出答案对$19260817$取模后的结果。

## 输入格式

第一行包括两个正整数$n$、$m$，表示毒瘤的种类数和袋子的大小。

接下来的$n$行，每行两个正整数$k_i$、$d_i$，表示一种毒瘤。

## 输出格式

一行，表示不同的方案数对$19260817$取模后的结果。

## 样例

### 样例输入 #1
```
2 5
2 3
3 1
```
### 样例输出 #1
```
2
```
## 提示

###样例解释：

两种方案如下：

1.取1个第一种毒瘤和2个第二种毒瘤。

2.取3个第二种毒瘤。


$~$
$~$

对于10%的数据，$1\leq n,k_i,d_i\leq 10$，$1\leq m\leq 100$；

对于30%的数据，$1\leq n,k_i,d_i\leq 50$，$1\leq m\leq 5000$；

对于另外20%的数据，$k_i=1$；

对于100%的数据，$1\leq n,k_i,d_i\leq 500$，$1\leq m\leq 10^5$。



---

---
title: "[清华集训 2012] 序列操作"
layout: "post"
diff: 省选/NOI-
pid: P4247
tag: ['2012', '线段树', 'O2优化', '枚举', 'CTT（清华集训/北大集训）']
---
# [清华集训 2012] 序列操作
## 题目背景

**滥用评测功能将被封号。**
## 题目描述

有一个长度为 $n$ 的序列，有三个操作：

1. `I a b c` 表示将 $[a,b]$ 这一段区间的元素集体增加 $c$；
2. `R a b`表示将 $[a,b]$ 区间内所有元素变成相反数；
3. `Q a b c` 表示询问 $[a,b]$ 这一段区间中选择 $c$ 个数相乘的所有方案的和 $\mod 19940417$ 的值。
## 输入格式

第一行两个数 $n, q$ 表示序列长度和操作个数。

第二行 $n$ 个整数，表示序列。

接下来 $q$ 行每行输入一个操作 `I a b c` 或者 `R a b` 或者 `Q a b c`，意义如题目描述。
## 输出格式

对于每个询问，输出选出 $c$ 个数相乘的所有方案的和 $\mod 19940417$ 的值。
## 样例

### 样例输入 #1
```
5 5
1 2 3 4 5
I 2 3 1
Q 2 4 2
R 1 5
I 1 3 -1
Q 1 5 1
```
### 样例输出 #1
```
40
19940397
```
## 提示

**样例说明：**

做完第一个操作序列变为 `1 3 4 4 5`。

第一次询问结果为 $3 \times 4+3 \times 4+4 \times 4=40$。

做完 `R` 操作变成 `-1 -3 -4 -4 -5`。

做完 `I` 操作变为 `-2 -4 -5 -4 -5`。

第二次询问结果为 $-2-4-5-4-5=-20$。

**数据范围：**

对于 $100\%$ 的数据，$n \leq 50000, q \leq 50000$。初始序列的元素的绝对值 $\leq 10^9$，保证 $[a,b]$ 是一个合法区间，`I` 操作中 $|c| \leq 10^9$，`Q` 操作中 $1 \leq c \leq \min(b-a+1,20)$。


---

---
title: "[Code+#3] 寻找车位"
layout: "post"
diff: 省选/NOI-
pid: P4259
tag: ['线段树', '单调队列', '枚举', 'Code+']
---
# [Code+#3] 寻找车位
## 题目描述

access_globe 有一个巨大的停车场，这个停车场有 $n$ 行，每行有 $m$ 个车位。为了美观，access_globe 在建立这个停车场时，规定这个停车场必须是长条形的，即 $n\ge m$。每个车位都是一个正方形的区域。

最近，access_globe 正在为抽不到 Missing Poster 而苦恼，因此他请你帮他维护这个停车场。你需要支持两个个事件：

- 一辆车停到某一个车位中，或一辆车从某个车位开走
- 查询一个矩形区域内最大的只包含空车位的正方形区域

如果你能帮 access_globe 高效地解决这个问题，access_globe 一定会好好奖励你的。

## 输入格式

第一行包含三个正整数 $n$、$m$、$q$，表示停车场的大小和事件的个数；

接下来 $n$ 行，每行 $m$ 个 0 或 1 的数，如果第 $i$ 行第 $j$ 的数**为 $1$**，则表示第 $i$ 行第 $j$ 列的车位**为空**，否则表示这个车位**非空**；

接下来 $q$ 行，每行表示一个事件，有以下两种形式：

- $0$ $x$ $y$ ：第 $x$ 行第 $y$ 列的车位的停车情况改变，即若此事件发生前这个车位为空，则此事件后这个车位非空，否则此事件后这个车位为空，保证 $1\le x\le n$，$1\le y\le m$
- $1$ $l$ $s$ $r$ $t$：询问以 $(l, s)$ 和 $(r,t)$ 为对角的矩形区域中，最大的全空正方形区域的边长，保证 $1\le l\le r\le n$，$1\le s\le t\le m$

## 输出格式

对每个询问输出一行一个整数，表示该询问的全空正方形的边长。
## 样例

### 样例输入 #1
```
5 4 10
1 1 1 0
1 1 1 1
1 1 0 1
1 0 1 0
1 1 0 0
1 1 1 5 4
1 3 1 3 1
1 3 3 3 3
1 2 3 5 3
0 2 2
1 1 4 2 4
1 1 3 3 3
0 5 1
1 2 3 2 4
1 1 2 2 4

```
### 样例输出 #1
```
2
1
0
1
1
1
1
1
```
## 提示

![](https://cdn.luogu.com.cn/upload/pic/15114.png)

所有子任务的分值均等分布。

对于所有数据，保证 $n\times m\le4\times 10^6$，$q\le 2000$。

Credit：https://www.luogu.org/discuss/show?postid=35727


---

---
title: "[Code+#3] 白金元首与克劳德斯"
layout: "post"
diff: 省选/NOI-
pid: P4261
tag: ['离散化', '枚举', '线段相交', 'Code+']
---
# [Code+#3] 白金元首与克劳德斯
## 题目背景

> 千里白金雪满天　烽火江山起狼烟　分手竟兵刃相见

1941.7.

苏联军队出乎意料的反抗力量、前线德军的补给困难 —— 元首 Adolf 望着天空的云层陷入沉思……
## 题目描述

在 $xy$-直角坐标平面的天空中，有 $n$ 片四边平行于坐标轴的矩形云朵。每一片云由一个五元组 $(x_i, y_i, w_i, h_i, d_i)$ 表示，其中 $(x_i, y_i)$ 为云左下角顶点的坐标，$w_i$ 表示云在 $x$ 轴方向的宽度，$h_i$ 表示云在 $y$ 轴方向的长度，$d_i \in \{0, 1\}$ 为云的移动方向（$0$ 为横向，$1$ 为纵向）。具体来说，满足 $d_i = 0$ 的云沿 $x$ 轴正方向以每秒 $1$ 长度单位的速率不断移动，而满足 $d_i = 1$ 的云沿 $y$ 轴正方向以每秒 $1$ 长度单位的速率不断移动。

元首发现，**所有的云在此时没有重叠的面积**。他将这个时刻记作时刻 $0$。他想知道，对于 $(-\infty, +\infty)$ 中的**任意时刻**和平面上的**任意一个点**，最多可以同时被多少片云覆盖。一个点在某时刻被一朵云覆盖当且仅当这个点位于该时刻云朵所处矩形的**内部（不含边界）**。

你需要编写程序帮助元首满足他的好奇心。

## 输入格式

输入的第一行包含一个正整数 $T$ —— 数据的组数。接下来包含 $T$ 组数据，格式如下，数据间没有空行。

* 第 $1$ 行：一个正整数 $n$ —— 云朵的数量。
* 接下来 $n$ 行：每行五个空格分隔的整数 $x_i$、$y_i$、$w_i$、$h_i$ 和 $d_i$ —— 描述一朵云在时刻 $0$ 的状态。

## 输出格式

对于每组数据输出一行 —— 在任意时刻，覆盖平面上任意一个点的云朵数目的最大值。
## 样例

### 样例输入 #1
```
3
1
0 0 1 1 0
3
0 -10 10 10 1
10 0 10 10 1
-10 0 10 10 0
3
0 10 10 10 1
10 20 10 10 1
10 0 10 10 0

```
### 样例输出 #1
```
1
2
2

```
## 提示

第 $1$ 组数据中，任意时刻的任意一个点至多被惟一的一片云覆盖。

第 $2$ 组数据中，下图从左至右分别示意时刻 $0$、时刻 $4$、时刻 $11$ 的情形。

![](https://cdn.luogu.com.cn/upload/pic/15106.png)

第 $3$ 组数据中，时刻 $0$ 对应第 $2$ 组数据时刻 $20$ 的情形。在该组数据中，$(-20, 0)$ 内的时刻均有 $2$ 片云覆盖同一个点。请注意考察范围 $(-\infty, +\infty)$ 包含时刻 $0$ 之前的时间段。

对于所有数据，有 $1 \leq T \leq 15$，$-5\times 10^8 \leq x_i, y_i \leq 5\times 10^8$，$1 \leq w_i, h_i \leq 5\times 10^8$，$d_i \in {0, 1}$。

![](https://cdn.luogu.com.cn/upload/pic/15108.png)

Credit：https://www.luogu.org/discuss/show?postid=35727


---

---
title: "封兽鵺的激光游戏"
layout: "post"
diff: 省选/NOI-
pid: P4276
tag: ['模拟', '计算几何', '枚举']
---
# 封兽鵺的激光游戏
## 题目背景

#盛大的宴会已经开始
![](https://cdn.luogu.com.cn/upload/pic/15071.png)
## 题目描述

在你的帮助下，萃香终于在一天内送出了所有的请柬。

夜幕低垂，随着由河城荷取提供的烟花"嗖"的一声蹿上天际，这场盛大的宴会终于如期开始。

顷刻之间，偌大的会场就已经被大家的欢声笑语充满：萃香和勇仪把酒言欢，散发着醉醺醺的酒香；帕秋莉和爱丽丝拽着魔理沙的两只胳膊争论着先逛哪边；琪露诺和大妖精在地上写写画画钻研着数学难题......一切都显得和谐而美满。

可是，随着会场愈发热闹，宴会的举办者萃香总感觉还是少了些什么，转念一想，她方才发觉自己没有准备游戏活动。没有游戏的宴会又怎能叫做宴会？为了解决这个严重的问题，萃香放下了酒葫芦，找到了路边的封兽鵺请她帮忙。

这可愁死封兽鵺啦！只擅长搞事情和打马赛克的她苦思冥想，终于想出了一个好主意，于是她将自己的UFO翻出来一些，再找圣白莲借几束激光，而下面就是封兽鵺制定的游戏规则：

封兽鵺在平面上放置了一些实心的质量均匀的UFO(可视为凸多边形)，由于她的能力有限，所以这些UFO最多只有五条边。现在你可以从一给定点向任意方向发射一束激光(x轴正方向为0°，y轴正方形为90°，保证发射角度为两位小数，即激光从0°开始旋转，每次旋转0.01°)，激光碰到UFO的边界便会发生反射，且激光每反射一次能量便会增加w(初始能量为0)，这里要注意的是，每当一条边被激光打中过一次后便会失去反射的能力变成一条可以直接透过的边，这时候你的激光可以直接穿进UFO的内部从内部进行反射。

如果你还没有理解，封兽鵺已经贴心的为你准备了下面这张图：
![](https://cdn.luogu.com.cn/upload/pic/15112.png)

本来唯恐天下不乱的封兽鵺想让激光射出时能量最大，但是萃香担心会场被破坏而将"能量最大"改为"能量最接近一整数E"。同时为了保证游戏的难度，封兽鵺会在游戏开始前将每个UFO绕重心顺时针旋转k*90°。

现在，轮到了你参加这个游戏，如果你射出激光的角度与封兽鵺的答案相符，那么你就会获得两份奖励——100分和封兽鵺的写真集！

当然，拥有电脑的你当然不会一次一次去试，而是通过编程预先解决这个问题，然后真正实践的时候直接用最优解拔得头筹。
## 输入格式

第一行一个整数n，为UFO的数量。

之后n行每行一个整数m，随后有m个实数对x[i],y[i]表示按顺时针顺序给出的UFO的m个顶点。

之后n行每行一个整数k，表示将该UFO顺时针旋转k*90°。

第2n+2行两个整数w和E，分别为每次反射激光的能量增量及规定的接近量。

最后一行两个实数x0，y0表示激光的射出点。
## 输出格式

一个实数d，保留到两位小数，表示使激光出射能量最接近E的出射角度。(如果有多个解符合题意，请输出角度最小的那个)
## 样例

### 样例输入 #1
```
2
4 0 0 0 4 4 4 4 0
3 8 0 12 4 12 0
0 
0
1 2
5 5
```
### 样例输出 #1
```
300.97
```
## 提示

【样例解释】：

如图所示，当激光射出偏角为300.97度时恰好能反射两次，E1-2*w=2=E，符合题意
![](https://cdn.luogu.com.cn/upload/pic/15105.png)

#你需要特别注意的一些事:
1. 当一束激光碰到UFO顶点的时候不认为它们相撞
2. 多边形不会重叠，初始激光射出点不会在UFO上或UFO内
3. 不要在这里讲科学，所以激光可以射到UFO内部进行反射


【数据范围】：

![](https://cdn.luogu.com.cn/upload/pic/15115.png)

奖励：

![](https://cdn.luogu.com.cn/upload/pic/15074.png)

(没错就是zun绘写真集，如果你AC了此题就可以获得)



---

---
title: "[CTSC2011] 幸福路径"
layout: "post"
diff: 省选/NOI-
pid: P4308
tag: ['2011', '倍增', '枚举', 'CTSC/CTS']
---
# [CTSC2011] 幸福路径
## 题目描述

有向图 $G$ 有 $n$ 个顶点 $1, 2, \cdots, n$，点 $i$ 的权值为 $w(i)$。

现在有一只蚂蚁，从给定的起点 $v_0$ 出发，沿着图 $G$ 的边爬行。开始时，它的体力为 $1$。每爬过一条边，它的体力都会下降为原来的 $\rho$ 倍，其中 $\rho$ 是一个给定的小于 $1$ 的正常数。而蚂蚁爬到某个顶点时的幸福度，是它当时的体力与该点权值的乘积。 

我们把蚂蚁在爬行路径上幸福度的总和记为 $H$。很显然，对于不同的爬行路径，$H$ 的值也可能不同。小 Z 对 $H$ 值的最大可能值很感兴趣，你能帮助他计算吗？注意，蚂蚁爬行的路径长度可能是无穷的。
## 输入格式

每一行中两个数之间用一个空格隔开。 

输入文件第一行包含两个正整数 $n,m$，分别表示 $G$ 中顶点的个数和边的条数。 

第二行包含 $n$ 个非负实数，依次表示 $n$ 个顶点权值  $w(1), w(2), \cdots, w(n)$。

第三行包含一个正整数 $v_0$，表示给定的起点。

第四行包含一个实数 $\rho$，表示给定的小于 $1$ 的正常数。 

接下来 $m$ 行，每行两个正整数 $x, y$，表示 $(x, y)$ 是 $G$ 的一条有向边。可能有自环，但不会有重边。
## 输出格式

仅包含一个实数，即 $H$ 值的最大可能值，四舍五入到小数点后一位。
## 样例

### 样例输入 #1
```
5 5 
10.0 8.0 8.0 8.0 15.0 
1 
0.5 
1 2 
2 3 
3 4 
4 2 
4 5
```
### 样例输出 #1
```
18.0
```
## 提示

对于 $100\%$ 的数据，$1\leq n \le 100$，$1\leq m \le 1000$，$0 < \rho \le 1 - 10^{-6}$，$0\leq w(i) \leq 100$。


---

---
title: "[CQOI2005] 三角形面积并"
layout: "post"
diff: 省选/NOI-
pid: P4406
tag: ['2005', '重庆', '各省省选', '枚举', '排序']
---
# [CQOI2005] 三角形面积并
## 题目描述

给出 $n$ 个三角形，求它们并的面积。
## 输入格式

第一行为 $n(n \leq 100)$， 即三角形的个数。

以下 $n$ 行，每行 $6$ 个实数 $x_1$, $y_1$, $x_2$, $y_2$, $x_3$, $y_3$，代表三角形的顶点坐标。坐标均为不超过 $10^6$ 的实数，输入数据保留 $1$ 位小数。
## 输出格式

输出并的面积 $u$, 保留两位小数。

## 样例

### 样例输入 #1
```
2
0.0 0.0 2.0 0.0 1.0 1.0
1.0 0.0 3.0 0.0 2.0 1.0
```
### 样例输出 #1
```
1.75
```


---

---
title: "[HNOI/AHOI2018] 游戏"
layout: "post"
diff: 省选/NOI-
pid: P4436
tag: ['2018', '各省省选', '安徽', '湖南', '枚举', '剪枝', '强连通分量', '栈']
---
# [HNOI/AHOI2018] 游戏
## 题目描述

一次小G和小H在玩寻宝游戏，有 $n$ 个房间排成一列，编号为 $1,2,\cdots,n$ ，相邻的房间之间都有一道门。其中一部分门上锁（因此需要有对应的钥匙才能开门），其余的门都能直接打开。现在小G告诉了小H每把锁的钥匙在哪个房间里（**每把锁有且只有一把钥匙与之对应**），并作出 $p$ 次指示：第 $i$ 次让小H从第 $S_i$ 个房间出发到 $T_i$ 个房间里。但是小G有时会故意在指令中放入死路，而小H也不想浪费多余的体力去尝试，于是想事先调查清楚每次的指令是否会存在一条通路。

你是否能为小H作出解答呢？
## 输入格式

第一行三个数字： $n,m,p$ ，代表有 $n$ 个房间， $m$ 道门上了锁，以及 $p$ 个询问。接下来$m$行，每行两个数字 $x,y$ 代表 $x$ 到 $x+1$ 的钥匙在房间 $y$ 。接下来 $p$ 行，其中第$i$行是两个整数 $S_i$，$T_i$，代表一次询问
## 输出格式

输出 $p$ 行，每行一个`YES`或`NO`，分别代表能或不能到达。
## 样例

### 样例输入 #1
```
5 4 5 
1 3
2 2 
3 1
4 4
2 5
3 5
4 5 
2 1
3 1
```
### 样例输出 #1
```
YES
NO
YES
YES
NO
```
### 样例输入 #2
```
7 5 4
2 2
3 3 
4 2 
5 3 
6 6
2 1
3 4
3 7
4 5
```
### 样例输出 #2
```
YES
YES
NO
NO
```
## 提示

![](https://cdn.luogu.com.cn/upload/pic/17503.png)

$1\le n,p\le 10^6$ ， $0\le m <n$ ， $1\le x,y,S_i,T_i<n$ 保证 $x$ 不重复


---

---
title: "[BJWC2018] 基础匹配算法练习题"
layout: "post"
diff: 省选/NOI-
pid: P4477
tag: ['2018', '莫队', '北京', '枚举']
---
# [BJWC2018] 基础匹配算法练习题
## 题目描述

小 S 最近学会了二分图匈牙利匹配算法。

现在二分图的 X 部有 $N$ 个数字 $A_i$，Y 部有 $K$ 个数字 $C_i$。

已知如果 $A_i + C_j \le  Z$，那么 $A_i$ 和 $C_j$ 之间就有一条边，求二分图（X，E，Y）的最大匹配数。

小 S 是初学者，所以她想做多做一些练习来巩固知识。于是她找到了一个长度为 $M$ 的正整数数组 $B$，每次她会在 $B$ 数组中抽取一段连续的区间 $[L_i,R_i]$，把区间 $[L_i,R_i]$ 的所有数字作为二分图 Y 部的 $K$ 个数字 $C_i$，然后重新求一次二分图最大匹配数。

小 S 打算一共做 $Q$ 次练习，但是她不知道每次计算出的答案对不对，你能帮帮她吗？
## 输入格式

第一行为三个正整数 $N,M,Z$。

第二行为 $N$ 个正整数，第 $i$ 个正整数表示 $A_i$。

第三行为 $M$ 个正整数，第 $i$ 个正整数表示 $B_i$。

第四行为一个整数 $Q$ 表示询问个数。

接下来 $Q$ 行每行两个正整数，第 $i$ 行的两个正整数分别表示 $L_i,R_i$。
## 输出格式

对于每次练习，输出该次练习的答案。
## 样例

### 样例输入 #1
```
4 10 8
1 2 4 6
6 3 6 2 8 4 9 10 6 8
4
1 4
2 5
5 6
1 6
```
### 样例输出 #1
```
4
3
1
4
```
## 提示

测试数据编号|$N$|$M$|$Q$
:-:|:-:|:-:|:-:
$1 \sim 4$|$\le 50$|$\le 50$|$\le 50$
$5 \sim 10$|$\le 2501$|$\le 2501$|$\le 2501$
$11\sim 14$|$\le 152501$|$\le 45678$|$\le 45678$
$15 ,16$|$\le 152501$|$\le 50$|$\le 52501$
$17 \sim 20$|$\le 152501$|$\le 52501$|$\le 52501$

对于 $100\%$ 的数据，$1 \le A_i,B_i,Z \le 10^9$，$1 \le L_i \le R_i \le Q$。

保证数据有一定梯度。


---

---
title: "[HAOI2018] 奇怪的背包"
layout: "post"
diff: 省选/NOI-
pid: P4495
tag: ['动态规划 DP', '2018', '河南', '各省省选', 'O2优化', '枚举']
---
# [HAOI2018] 奇怪的背包
## 题目描述

小 C 非常擅长背包问题，他有一个奇怪的背包，这个背包有一个参数 $P$ ，当他向这个背包内放入若干个物品后，背包的重量是物品总体积对 $P$ 取模后的结果。

现在小 C 有 $n$ 种体积不同的物品，第 $i$ 种占用体积为 $V_i$ ，每种物品都有无限个。他会进行 $q$ 次询问，每次询问给出重量 $w_i$ ，你需要回答有多少种放入物品的方案，能将一个初始为空的背包的重量变为 $w_i$。注意，两种方案被认为是不同的，当且仅当放入物品的种类不同，而与每种物品放入的个数无关．不难发现总的方案数为 $2^n$。

由于答案可能很大，你只需要输出答案对 $10^9 + 7$ 取模的结果。
## 输入格式

第一行三个整数 $n, q, P$，含义见问题描述。

接下来一行 $n$ 个整数表示 $V_i$。

接下来一行 $q$ 个整数表示 $w_i$。
## 输出格式

输出 $q$ 行，每行一个整数表示答案。
## 样例

### 样例输入 #1
```
3 3 6
1 3 4
5 2 3
```
### 样例输出 #1
```
5
6
6
```
## 提示

![](https://cdn.luogu.com.cn/upload/pic/18144.png)
HAOI2018 round1 T1


---

---
title: "[HNOI2006] 军机调度"
layout: "post"
diff: 省选/NOI-
pid: P4540
tag: ['2006', '各省省选', '湖南', '枚举', '排序', '位运算']
---
# [HNOI2006] 军机调度
## 题目描述

凯萨拥有一支由n个人组成的雇佣军，他们靠在威尼斯商行接任务过活。

这支军队的成份比较复杂，不同的人往往具有不同的技能，有的人还拥有多项技能。

威尼斯商行的任务也参差不齐，有的需要几个人合作完成，有的只需要一个人独立完成：有的很简单，不需要耗多少时间，因此报酬也较低，有的很有难度，需要多个人长期合作完成，因此报酬就高。完成这些任务的时间不会超过一个月。并且，一个人不能同时执行两项任务，也不能中途加入或者退出任务。但可以不执行任何任务。

一项只需要n个人来完成的任务，如果执行该任务的人数p大于n,那么反而会得到更少的报酬，即原报酬的1/(p-n+1)。

凯萨是一位英明的领袖，他往往在每个月的月底召开军事会议，总结上个月的成果，发给大家报酬，并指派下个月的任务。

请问，凯萨应该怎样指派任务，才能使总报酬最高？总报酬为多少？
## 输入格式

一行包含两个正整数n,m。彼此用空格隔开，

其中n〈10表示雇佣军的人数，m〈15表示下个月可选的任务数。

接下来的n行中第i行（对应文件的第i+1行）的第一个整数小于等于表示编号为i的雇佣军可执行的任务数

后面的整数是编号为i的雇佣军可以执行的所有任务的编号，这些整数之间用空格隔开。

最后的m行中，每行有四个整数b、e、p和r，彼此之间用空格隔开，

其中第j行（对应整个文件的第n+j+1行）是编号为j的任务的描述：

0<b<32表示该任务的开始日（这一天会被计入任务所需的时间中），

0<e<32表示该任务的结束日（这一天也会被计入任务所需的时间中），

p<10表示该任务所需人数，0<r<100000表示该任务的报酬。
## 输出格式

第一行只有一个整数t,表示最多可获得的总报酬
## 样例

### 样例输入 #1
```
3 5
2 1 4
2 2 4
3 3 4 5
2 20 1 100 
1 18 1 200 
3 28 1 800 
21 30 3 1500 
19 21 1 400 
```
### 样例输出 #1
```
1800
```


---

---
title: "[CTSC2018] 假面"
layout: "post"
diff: 省选/NOI-
pid: P4564
tag: ['数学', '2018', 'O2优化', '枚举', '期望', 'CTSC/CTS']
---
# [CTSC2018] 假面
## 题目背景


针针是绿绿的好朋友。
## 题目描述

针针喜欢玩一款叫做 DotA (**D**efense **o**f **t**he **A**lgorithm) 的游戏，在这个游戏中，针针会操纵自己的英雄与队友一起对抗另一支队伍。
针针在 DotA 中最喜欢使用的英雄叫做假面（Faceless），该英雄有 $2$ 个技能：

- 锁定：对一名指定的敌方单位使用，以 $p$ 的概率对该单位造成 $1$ 点伤害（使其减少 $1$ 点生命值）。
- 结界：在一片区域施放结界，让该区域内的所有其他单位无法动弹。
在游戏中，如果一个单位的生命值降至 $0$ 或 $0$ 以下，那么该单位就会死亡。

针针操纵假面的水平一般，因此他决定勤加练习。现在有 $n$ 个敌方单位（编号从 $1$ 至 $n$），编号为 $i$ 的敌方单位有 $h_i$ 点生命值。

针针已经安排好了练习的计划，他会按顺序施放 $Q$ 个技能：

- 对于锁定技能：针针会指定一个敌方单位 $id$ ，并对它施放。由于决定概率系数 $p$ 的因素很多，因此每次的 $p$ 都不一定相同。
特别地，如果该敌方单位已经死亡，那么该技能不会造成任何效果。
- 对于结界技能：针针会希望对 $k$ 个指定的敌方单位施放，但由于针针并不擅长施放该技能，因此他只能命中恰好 $1$ 个敌方单位。命中每个存活的敌方单位的概率是相等的（也就是说已经死亡的敌方单位不会有任何影响）。
特别地，如果这 $k$ 个敌方单位均已死亡，那么该技能同样不会命中任何敌方单位。

现在，围观针针进行练习的绿绿想知道：

1. 对于针针施放的每个结界技能，它命中各敌人的概率分别是多少。
2. 在针针的所有技能施放完毕后，所有敌方单位剩余生命值的期望分别是多少。

由于绿绿还要围观针针训练，所以请你帮他解决这两个问题。

为了防止精度误差，对于所有需要输出的数值，请输出其在模 $998244353$ 意义下的值。

由于结界为假面的终极技能，因此针针施放该技能的次数不会太多。具体请见”子任务“。
## 输入格式

第 $1$ 行为 $1$ 个正整数 $n$ ，表示敌方单位的数量。  
第 $2$ 行为 $n$ 个正整数 $m_1,\cdots , m_n$，依次表示各敌方单位的初始生命值。  
第 $3$ 行为 $1$ 个非负整数 $Q$ ，表示针针施放技能的数量。  
第 $4$ 行至第 $Q + 3$ 行，每行描述一个技能，第 $i + 3$ 行描述第 $i$ 个技能。

每行的开头为一个整数 $op$ ，表示该技能的种类。  
如果 $op = 0$ ，则表示锁定技能。并在此后跟随着 $3$ 个正整数 $id , u , v$ ，表示技能施放的目标为 $id$ ，技能命中的概率为 $p = \frac{u}{v}$ 。（保证 $1\le id \le n , 0 < u \le v < 998244353$ ）  
如果 $op = 1$ ，则表示结界技能。并在此后跟随着 $1$ 个正整数 $k$ 表示技能施放的目标数量，随后还有额外的 $k$ 个数 $id_1,\cdots,id_k$ 描述技能施放的所有目标。（保证所有 $1 \le id_i \le n$ 互不相同） 对于每一行，如果行内包含多个数，则用单个空格将它们隔开。
## 输出格式

输出包括 $C + 1$ 行（其中 $C$ 为结界技能的数量）：

前 $C$ 行依次对应每个结界技能，对于每行：

输出 $k$ 个数，第 $i$ 个数表示结界命中敌方单位 $id_i$ 的概率。   
第 $C + 1$ 行输出 $n$ 个数，第 $i$ 个数表示在所有技能施放完毕后，敌方单位 $i$ 剩余生命值的期望值。  

对于每一行，如果行内包含多个数，则用单个空格将它们隔开。

对于所有数值，请输出它们对 $998244353$ 取模的结果：即设答案化为最简分式后的形式为 $\frac{a}{b}$ ，其中 $a$ 和 $b$ 的互质。输出整数 $x$ 使得 $bx \equiv a\bmod 998244353$ 且 $0 \le x < 998244353$ 。（可以证明这样的整数 $x$ 是唯一的）

## 样例

### 样例输入 #1
```
3
1 2 3
6
0 2 1 1
1 1 2
0 2 1 1
0 3 1 1
1 1 2
1 3 1 2 3
```
### 样例输出 #1
```
1
0
499122177 0 499122177
1 0 2

```
### 样例输入 #2
```
3
1 1 1
4
0 2 1 2
1 2 1 2
0 3 2 3
1 3 1 2 3
```
### 样例输出 #2
```
249561089 748683265
804141285 887328314 305019108
1 499122177 332748118

```
## 提示

### 样例解释 1
针针按顺序施放如下技能：

1. 对敌方单位 $2$ 施放技能锁定：以 $1$ 的概率对其造成 $1$ 点伤害。此时 $2$ 号敌方单位必定剩余 $1$ 点生命值。
2. 对敌方单位 $2$ 施放技能结界：（由于 $2$ 号敌方单位尚存活，）必定命中 $2$ 号单位。
3. 对敌方单位 $2$ 施放技能锁定：以 $1$ 的概率对其造成 $1$ 点伤害。
4. 对敌方单位 $3$ 施放技能锁定：以 $1$ 的概率对其造成 $1$ 点伤害。此时三个敌方单位的生命值一定分别为 $1, 0 ,2$ ，敌方单位 $2$ 一定死亡。
5. 对敌方单位 $2$ 施放技能结界：（由于 $2$ 号敌方单位已死亡，）必定不命中任何单位。
6. 对敌方单位 $1, 2, 3$ 施放技能结界：命中敌方单位 $1, 3$ 的概率是相等的，即各 $\frac{1}{2}$ 。 最终，三个敌方单位的剩余生命值一定为 $1 , 0 , 2$ 。

### 样例解释 2
对于各结界技能的分析：

1. 第 $1$ 个结界（目标为敌方单位 $1,2$ ）：
- $2$ 号敌方单位存活的概率为 $\frac{1}{2}$ ， $1$ 号敌方单位必定存活。
- 如果 $2$ 号敌方单位存活，那么结界命中 $1 , 2$ 的概率相等，均为 $\frac{1}{2}$ ；如果 $2$ 号敌方单位死亡，那么结界必定命中 $1$ 号敌方单位。
- 因此：命中 $1$ 号敌方单位的概率为 $\frac{1}{2} \times 1 + \frac{1}{2} \times \frac{1}{2} = \frac{3}{4}$ ；命中 $2$ 号敌方单位的概率为 $\frac{1}{2} \times 0 + \frac{1}{2} \times \frac{1}{2} = \frac{1}{4}$ 。
2. 第 $2$ 个结界（目标为敌方单位 $1, 2, 3$ ）：
- 三个敌方单位存活的概率分别为 $1, \frac{1}{2} , \frac{1}{3}$ 。
- $1 , 2 , 3$ 同时存活的概率为 $\frac{1}{6}$ ；只有 $1, 2$ 存活的概率为 $\frac{1}{3}$ ；只有 $1 , 3$ 存活的概率为 $\frac{1}{6}$ ；只有 $1$ 存活的概率为 $\frac{1}{3}$ 。
- 因此：命中 $1$ 号敌方单位的概率为 $\frac{1}{6} \times \frac{1}{3} + (\frac{1}{3}+\frac{1}{6}) \times \frac{1}{2}+ \frac{1}{3} \times 1 = \frac{23}{36}$ ；命中 $2$ 号敌方单位的概率为 $\frac{1}{6} \times \frac{1}{3} + \frac{1}{3} \times \frac{1}{2} = \frac{2}{9}$ ；命中 $3$ 号敌方单位的概率为 $\frac{1}{6} \times \frac{1}{3} + \frac{1}{6} \times \frac{1}{2} = \frac{5}{36}$ 。 最终，三个敌方单位的剩余生命值的期望值为 $1 , \frac{1}{2} , \frac{1}{3}$ 。


### 数据范围

我们记 $C$ 为结界技能的数量。

测试点编号|n=|Q=|C=|u,v|其他限制
-|-|-|-|-|-
1|5|21|6|u<v|无
2|60|199992|500|u<v|所有 p 均相等
3|60|23|6|u<v|所有m_i =1
4|60|199994|500|u<v|无
5|60|199995|500|u<v|无
6|60|199996|0|u<v|无
7|60|199997|500|u=v|无
8|200|199998|1000|u<v|无
9|200|199999|1000|u<v|无
10|200|200000|1000|u<v|无

对于所有测试点，保证 $n \le 200 , Q \le 200000 , C \le 1000 , m_i \le 100$ 。

提示

Q 的个位可以帮助你快速确定测试点的编号。
测试点顺序可能与难度无关。

感谢 @和泉正宗 提供题面 


---

---
title: "[CQOI2013] 二进制A+B"
layout: "post"
diff: 省选/NOI-
pid: P4574
tag: ['动态规划 DP', '2013', '重庆', '各省省选', '枚举', '进制']
---
# [CQOI2013] 二进制A+B
## 题目描述

输入三个整数$a, b, c$，把它们写成无前导0的二进制整数。
比如$a=7, b=6, c=9$，写成二进制为$a=111, b=110, c=1001$。

接下来以位数最多的为基准，其他整数在前面添加前导0，使得$a, b, c$拥有相同的位数。比如在刚才的例子中，添加完前导0后为$a=0111, b=0110, c=1001$。

最后，把$a, b, c$的各位进行重排，得到a’, b’, c’，使得a’+b’=c’。比如在刚才的例子中，可以这样重排：a’=0111, b’=0011, c’=1010。


你的任务是让c’最小。如果无解，输出-1。
## 输入格式

输入仅一行，包含三个整数$a, b, c$。
## 输出格式

仅一行，为c’的最小值。
## 样例

### 样例输入 #1
```
7 6 9
```
### 样例输出 #1
```
10
```
## 提示

$a,b,c <= 2^{30}$



---

---
title: "[TJOI2018] 游园会"
layout: "post"
diff: 省选/NOI-
pid: P4590
tag: ['字符串', '递推', '2018', '各省省选', '枚举', '有限状态自动机', '天津', 'DP 套 DP']
---
# [TJOI2018] 游园会
## 题目描述

小豆参加了 NOI 的游园会，会场上每完成一个项目就会获得一个奖章，奖章只会是 $\texttt{N}$、$\texttt{O}$、$\texttt{I}$ 的字样。在会场上他收集到了 $K$ 个奖章组成的串。兑奖规则是奖章串和兑奖串的最长公共子序列长度为小豆最后奖励的等级。现在已知兑奖串长度为 $N$，并且在兑奖串上不会出现连续三个奖章为 $\texttt{NOI}$，即奖章中不会出现子串 $\texttt{NOI}$。现在小豆想知道各个奖励等级会对应多少个不同的合法兑奖串。

## 输入格式

第一行两个数，$N, K$ 分别代表兑奖串的长度，小豆收集的奖章串的长度（$N\leq1000,K\leq15$）。

第二行一共 $K$ 个字符，表示小豆得到的奖章串。
## 输出格式

一共 $K+1$ 行，第行表示小豆最后奖励等级为 $i-1$ 的不同的合法兑奖串的个数，可能这个数会很大，结果对 $10^9+7$ 取模。
## 样例

### 样例输入 #1
```
3 2
NO
```
### 样例输出 #1
```
1
19
6
```
## 提示

### 样例解释

最长公共子序列长度为 $0$ 的串有：$\texttt{III}$;

最长公共子序列长度为 $2$ 的串有：$\texttt{NON}$、$\texttt{NNO}$、$\texttt{NOO}$、$\texttt{ONO}$、$\texttt{INO}$、$\texttt{NIO}$；

除去 $\texttt{NOI}$，余下的 $19 = 26-6-1$ 种为最长公共子序列长度为 $1$。

### 数据范围

- 对于 $10\%$ 的数据，$N\leq10,K\leq10$；
- 对于 $30\%$ 的数据，$N\leq100,K\leq4$；
- 对于 $100\%$ 的数据，$N\leq1000,K\leq15$。


---

---
title: "[IOI 2007] pairs 动物对数"
layout: "post"
diff: 省选/NOI-
pid: P4648
tag: ['2007', '树状数组', 'IOI', '枚举', '前缀和']
---
# [IOI 2007] pairs 动物对数
## 题目描述

Mirko 和 Slavko 正在玩动物玩具的游戏。 首先，他们要在下图给出的三种玩具模板中选择一种。三种模板分别由一维、二维和三维的网格点（在图中用圆圈表示）组成。 

![](https://cdn.luogu.com.cn/upload/pic/20672.png )

接下来Mirko 把 $N$ 个小动物玩具放到选中的模板的网格点上。

动物玩具可以走一步到达与它相邻的网格点上（在图中相邻的点之间有一条小短线相连）。两个网格点之间的距离定义为**从一个网格点到另一个网格点所需要移动的最小步数**。

如果两个动物之间的距离小于等于$D$，则它们之间可以互相听见。Slavko 的任务是计算在模板上有多少对动物可以互相听得见。

给定模板的类型、所有动物的位置以及数字$D$，写一个程序计算有多少对动物可以互相听得见。 
## 输入格式

输入的第一行按顺序给出四个整数： 
- 模板类型 $B (1 \leq B \leq 3)$; 
- 玩具动物的数目 $N (1 \leq N \leq 100 000)$; 
- 动物之间可以互相听得见的最大距离$D (1 \leq D \leq 100 000 000)$; 
- 模板的大小 $M$ ( 即在输入中允许的最大的坐标值):  当 $B=1$ 时, $M$ 最大是 $75 000 000$. 当 $B=2$时, $M$ 最大是 $75 000$. 当 $B=3$时, $M$ 最大是 $75$.

接下来的$N$ 行每行包含$B$ 个整数，整数之间用空格隔开，表示一个动物玩具的坐标。坐标的取值范围是$1$ 到 $M$ ( 包括$M$ )。

每个网格点可以同时包含多个动物玩具。 
## 输出格式

输出应该包括一个整数，表示可以互相听得见的玩具动物的对数。

注意：使用64 位整数类型计算和输出结果 (在 C/C++ 中用```long long```, 在Pascal 中用```int64``` ) 。 
## 样例

### 样例输入 #1
```
1 6 5 100 
25 
50 
50 
10 
20 
23 
```
### 样例输出 #1
```
4
```
### 样例输入 #2
```
2 5 4 10 
5 2 
7 2 
8 4 
6 5 
4 4 
```
### 样例输出 #2
```
8
```
### 样例输入 #3
```
3 8 10 20 
10 10 10 
10 10 20 
10 20 10 
10 20 20 
20 10 10 
20 10 20 
20 20 10 
20 20 20 
```
### 样例输出 #3
```
12
```
## 提示

在30分的测试数据中, 动物数目 $N$ 最多是 $1 000$。

如果成功通过了某一种模板（一维、二维或者三维）的全部测试数据，将会得到至少30分。

对于input 1的解释： 假设动物按给出的顺序编号为$1$到$6$。$4$对互相能够听得到的动物分别是:
- 1-5 ( 距离是5)
- 1-6 ( 距离是2)
- 2-3 ( 距离是0)
- 5-6 ( 距离是3)

对于input 2 的解释：$8$对动物分别是:
- 1-2 ( 距离是2)
- 1-4 ( 距离是4)
- 1-5 ( 距离是3)
- 2-3 ( 距离是3)
- 2-4 ( 距离是4)
- 3-4 ( 距离是3)
- 3-5 ( 距离是4)
- 4-5 ( 距离是3)


---

---
title: "[BalticOI 2008] 网格"
layout: "post"
diff: 省选/NOI-
pid: P4661
tag: ['2008', '二分', '枚举', 'BalticOI（波罗的海）']
---
# [BalticOI 2008] 网格
## 题目描述

Byteland 国的地图是一个大小为 $n\times m$ 的网格（$n$ 是垂直方向长度，$m$ 是水平方向长度）。标记分隔的水平线被叫做平行线，并编号为 $0$ 到 $n$，标记分隔的垂直线被叫做子午线，并编号为 $0$ 到 $m$。

在 Byteland 国，天气预报是一个十分严肃的话题，对于每个单元格，准备天气预报需要一定时间来计算。由于地形条件和其他因素，不同的单元格有着不同的计算时间。直到目前为止，预报系统还是会依次处理每一个单元格，所以完成预报天气需要花费的时间为计算所有单元的时间。

你被要求设计一个可以在多进程处理器上运行的新系统，为了共享处理器的计算能力，Byteland 国要被 $r$ 条平行线和 $s$ 条子午线划分为 $(r+1)(s+1)$ 个矩形。每个线程会依次处理一个矩形内部的单元格，这样的话对于一个矩形区域的计算时间，就为矩形区域内单元格计算时间之和。完成预报的计算时间是一个处理器上计算时间的最大值。

你的任务是找到对于选择 $r$ 条平行线和 $s$ 条子午线分隔后最小的计算时间。

#任务

写一个程序能够：

-    从标准输入读取 Byteland 的地图，要求的平行线和子午线条数以及每个单元格的处理时间；
-    找到完成预报的最小计算时间；
-    输出这个值到标准输出。

## 输入格式

第一行包含四个正整数 $n,m,r,s$，由一个空格隔开。

接下来 $n$ 行包含每一个单元格的计算时间 $c_{i,j}$。第 $i+1$ 行的第 $j$ 个数表示位于第 $i-1$ 和第 $i$ 条平行线，第 $j-1$ 和第 $j$ 条子午线之间的单元格需要的计算时间。 
## 输出格式

输出一行一个整数，表示最优的计算时间。
## 样例

### 样例输入 #1
```
7 8 2 1
0 0 2 6 1 1 0 0
1 4 4 4 4 4 3 0
2 4 4 4 4 4 3 0
1 4 4 4 8 4 4 0
0 3 4 4 4 4 4 3
0 1 1 3 4 4 3 0
0 0 0 1 2 1 2 0
```
### 样例输出 #1
```
31
```
## 提示

**样例解释**

![0](https://i.loli.net/2018/02/19/5a8ae8ca02cbb.png)

第二条和第四条平行线，第四条子午线把整个国家分为六个矩形，计算时间为 $21, 13, 27, 27, 17, 31$，所以完成预报的计算时间为 $31$。

**数据范围**

对于 $40\%$ 的数据，$n\le 10,m\le 10$；

对于全部数据，$1\le r<n\le 18,1\le s<m\le 18$，$1\le i\le n,1\le j\le m,0\le c_{i,j}\le 2\times 10^6$​​。 


---

---
title: "取石子"
layout: "post"
diff: 省选/NOI-
pid: P4706
tag: ['枚举', '素数判断,质数,筛法', '概率论']
---
# 取石子
## 题目描述

现在 Yopilla 和 yww 要开始玩游戏！

他们在一条直线上标记了 $n$ 个点，从左往右依次标号为 $1, 2, ..., n$ 。然后在每个点上放置一些棋子，其中第 $i$ 个点放置了 $a_i$ 个棋子。接下来，从 Yopilla 开始操作，双方轮流操作，谁不能操作谁输。每次的操作是：当前操作方选定一个有棋子的点 $x$ ，然后选择至少一个点 $x$ 上的棋子，然后把这些棋子全都移动到点 $x / prime$ 上，其中 $prime$ 是一个质数，且 $prime \mid x$ 。

Yopilla 最初一次操作的策略是随机的：随机找到一个有棋子的点 $x$ ，随机选择正整数个棋子 $y$ ，随机转移到一个能转移到的点 $z$ 。所有棋子可以看作是一样的，换句话说：两种操作不同，当且仅当三元组 $(x, y, z)$ 不同。之后双方都按照最优策略来操作。

Yopilla 想要预测，他能够获胜的概率是多少，答案对 $998244353$ 取模。
## 输入格式

第一行一个数 $n$ 。

第二行 $n$ 个数 $a_1, a_2, ..., a_n$ 。
## 输出格式

输出 $m$ 行，表示 Yopilla 能够获胜的概率对 $998244353$ 取模。
## 样例

### 样例输入 #1
```
3
3 1 2
```
### 样例输出 #1
```
332748118
```
## 提示

样例解释：

$1$ 号点有 $3$ 个棋子，$2$ 号点有 $1$ 个棋子，$3$ 号点有 $2$ 个棋子。第一次操作的时候，能进行的有三种可能：将 $2$ 号点的 $1$ 个棋子移到 $1$ 号点，将 $3$ 号点的 $1$ 个棋子移到 $1$ 号点，将 $3$ 号点的 $2$ 个棋子移到一号点。而其中只有一种情况能使得 Yopilla 有必胜策略。所以答案为
$$\frac{1}{3} \equiv 332748118 \pmod {998244353}$$

对于 $20 \%$ 的数据，只有一个石子。

对于 $100 \%$ 的数据，$1 \le n \le {10} ^ 6, 0 \le a_i \le {10} ^ 9$ ，保证至少有一个不在一号点的石子。


---

---
title: "「语文」凑字数"
layout: "post"
diff: 省选/NOI-
pid: P4713
tag: ['贪心', 'O2优化', '枚举', '洛谷月赛']
---
# 「语文」凑字数
## 题目背景

 数据的锅修好了！
## 题目描述

时间在一秒一秒地减少着，然而小 F 仍对着作文题冥思苦想。看起来，他又写不完作文了。

然而，小 F 有一种特殊的凑字数技巧——不停换行。这是因为，作文纸每行 $L$ 个字，而最低字数限制是以行数来计算的。

也就是说，只要写到了 $M$ 行（不含标题）即认为时满足要求，写到意味着这一行上有字。注意，由于作文格式要求，每段首行会**有两个字符的缩进空格**。

现在，他已经构思好了 $N$ 句话，每句话有着自己的长度 $a_i$ ——包括标点符号，不考虑因句号等在最后一格之外而不换行的情况。这几句话的关联或强或弱，关联强的更适合放在一段，关联弱的更适合分段，然而因为凑字数小 F 可以对任意两句话之间进行换行以分段。

关联关系会用一种特殊的方式来表示。我们知道，作文改卷时会将作文的得分点划分为几个主要部分，比如全国卷分为基础，表达，发展三个部分；每个部分拥有着相同的总分，比如对于全国卷来说是 $20$ 分；每个部分的最低均为 $0$ 分，也就是说哪怕扣到 $0$ 以下也算 $0$ 分。在这里，我们的评分标准有 $K$ 个部分，每个部分有 $S$ 分的满分。根据方面的不同，小 F 将两句话的关联关系用一个 $K$ 元组 $s_i = (s_{i,1}, s_{i, 2}, \cdots, s_{i, K})$ 表示，其中每个数都是整数，第 $j$ 个数 $s_{i, j}$ 表示：
* 如果是正数，那么表示拆开 $i, i + 1$ 这两句话会导致第 $j$ 部分得分扣 $s_{i, j}$ 分 。
* 如果是负数，那么表示**不**拆开这两句话第 $j$ 部分得分扣 $-s_{i, j}$ 分。
* 如果为 0，那么表示是否拆开这两句话对得分没有影响。

从满分开始，在计算完上面的扣分之后可以得到一个初步的总分。在这之后，最低字数线上每空一行，会扣 $C$ 分字数分，总分扣至 0 为止。

如果能够拿到高分作文，小 F 就可以得到老师的大拇指！所以，请你帮小 F 设计出一种方案以最大化得分。
## 输入格式

输入第一行为 $6$ 个整数，$N, M, L, K, S, C$，对应题目描述里的内容。

输入第二行为 $N$ 个整数，第 $i$ 个为 $a_i$，即每句话的长度。 

接下来 $N - 1$ 行，每行 $K$ 个整数，第 $i$ 行第 $j$ 个表示 $s_{i, j}$。
## 输出格式

输出一行一个非负整数，表示你所求得的最大得分。


## 样例

### 样例输入 #1
```
4 4 12 2 10 5
5 5 10 4
2 -1
0 0
1 1
```
### 样例输出 #1
```
18
```
### 样例输入 #2
```
2 2 10 1 10 1
1 1
2
```
### 样例输出 #2
```
9
```
## 提示

### 样例 1 解释

这是样例 1 不分段的情况：

![](https://cdn.luogu.com.cn/upload/pic/21276.png )

这样做，得分是 $10 + 9 - 5 = 14$ 分。

我们发现，字数分太痛了，于是我们一定要去避免它。

最优解如下：

![](https://cdn.luogu.com.cn/upload/pic/21277.png)

这样做，得分是 $8 + 10 - 0 = 18$ 分。

### 样例 2 解释

即使换行可以避免一分字数扣分，但是相应地会扣掉两分，所以不如不换。


### 子任务

子任务 $1(21 \mathrm{pts}) : N \leq 10$；

子任务 $2(21 \mathrm{pts}) : K = 1$；

子任务 $3(31 \mathrm{pts}) : N \times a_i \leq 800$；

子任务 $4(77 \mathrm{pts}) :$
* $1 \leq N, M, a_i \leq 200$
* $3 \leq L \leq 200$
* $1 \leq K \leq 5$
* $0 \leq S, C, |s_{i, j}| \leq 200$


---

---
title: "[Wind Festival] Energy Center"
layout: "post"
diff: 省选/NOI-
pid: P4743
tag: ['平衡树', '树状数组', 'O2优化', '枚举']
---
# [Wind Festival] Energy Center
## 题目背景

$[Noon - 12:13$ $P.M.]$

$Curtis$ $Nishikino$看到大家为晚会准备地如此认真，~~可爱的~~她也做起了志愿者！
## 题目描述

$Curtis$ $Nishikino$来到了风筝节的能源中心，大家正在为晚会做准备. 这里共有 $N$ 台设备. 当然，由于计划的调整，可能会随时发生增删设备的操作. 但设备的总数不会超过$10^4$. 随时记录设备的数量也是志愿者的工作之一.

每台设备都有一些属性，比如设备$i$, 对于她拥有的每个属性, 比如属性$j$, 都会有一个给定的值, 记为$value_{ij}$.但属性是共有的, 这意味着即便一台设备没有某个属性, 也只会使她这个属性的值为$0$. 属性的数量是$M$. 注意属性的编号是从$0$到$M-1$.

现在志愿者们正尝试将一部分相邻设备联系在一起，效果如下：

- 对于从$j$到$k$的设备, 最终效果$i$的值为 $\sum_{p=j}^{k}value_{pi}$.

志愿者需要$Curtis$帮忙，但做计算太麻烦了，$Curtis$ $Nishikino$也希望你能帮帮她.
## 输入格式

第一行两个整数 $n$ 和 $m$.

接下来 $n$ 行, 第一个整数 $k_i$,这意味着设备 $i$ 有 $k_i$ 个属性. 后面是 $2\times k$ 个整数, $x_j$ 和 $y_j$, 这意味着 $value_{ix_j}=y_j$.

下面是一个整数 $q$, 即 $q$ 个操作. 每项操作都是如下之一:

$I$ $x$ :在设备 $x$ 后插入一台设备, 下面有一行描述信息，像初始化一样.

$D$ $x$:丢弃第 $x$ 台设备.

$QA$ :询问设备总数.

$QS$ $l$ $r$: 询问连接设备 $l$ 到 $r$ 的效果.

输入数据保证合法.
## 输出格式

对于每个 $QA$, 输出一行一个整数.

对于每个 $QS$, 输出一行 $m$ 个整数, 如果属性 $i$ 的值是 $0$, 在那个位置输出 $0$ 即可.

###### 注意！

请在完成所有操作后输出一行额外的 "end" (不包含双引号).
## 样例

### 样例输入 #1
```
4 4
4 0 1 1 2 2 2 3 1
2 0 1 2 1
0
2 1 2 3 1
5
QA
I 2 
2 1 1 3 2
QS 2 4
QA
QS 1 1
```
### 样例输出 #1
```
4
1 1 1 2
5
1 2 2 1
end
```
## 提示

对于 $15\%$ 的数据, $0 < N \le 10^3\ , \ 0<M \le 10\ , \ 0 < q \le 10^3$.

对于额外的 $5\%$ 数据, $0<N \le 10^4\ , \ 0<M \le 200\ , \ 0 < q \le 10^4$, 保证没有 $QS$ 操作.

对于 $100\%$ 的数据, $0<N \le 10^4\ ,\ 0<M \le 200\ , \ 0<q\le10^4$.


---

---
title: "Beautiful Pair"
layout: "post"
diff: 省选/NOI-
pid: P4755
tag: ['O2优化', '枚举', '分治', '可持久化线段树', '洛谷月赛']
---
# Beautiful Pair
## 题目描述

小 D 有个数列 $\{a\}$，当一个数对 $(i,j)$（$i \le j$）满足 $a_i$ 和 $a_j$ 的积不大于 $a_i, a_{i+1}, \ldots, a_j$ 中的最大值时，小 D 认为这个数对是美丽的。请你求出美丽的数对的数量。
## 输入格式

第一行输入一个整数 $n$，表示元素个数。
第二行输入 $n$ 个整数 $a_1,a_2,a_3,\ldots,a_n$，为所给的数列。

## 输出格式

输出一个整数，为美丽的数字对数。
## 样例

### 样例输入 #1
```
4
1 3 9 3

```
### 样例输出 #1
```
5

```
### 样例输入 #2
```
5
1 1 2 1 1

```
### 样例输出 #2
```
14

```
## 提示

**【样例解释 #1】**

五种可行的数对为 $(1,1), (1,2), (1,3), (1,4), (2,4)$。

**【样例解释 #2】**

只有数对 $(3,3)$ 不可行。

**【数据范围】**

对于 $100 \%$ 的数据，$1\le n\le{10}^5$，$1\le a_i\le{10}^9$。


---

---
title: "[IOI 2000] 邮局 加强版"
layout: "post"
diff: 省选/NOI-
pid: P4767
tag: ['数学', '2000', 'IOI', '枚举', '区间 DP', '四边形不等式']
---
# [IOI 2000] 邮局 加强版
## 题目描述

高速公路旁边有一些村庄。高速公路表示为整数轴，每个村庄的位置用单个整数坐标标识。没有两个在同样地方的村庄。两个位置之间的距离是其整数坐标差的绝对值。

邮局将建在一些，但不一定是所有的村庄中。为了建立邮局，应选择他们建造的位置，使每个村庄与其最近的邮局之间的距离总和最小。

你要编写一个程序，已知村庄的位置和邮局的数量，计算每个村庄和最近的邮局之间所有距离的最小可能的总和。
## 输入格式

第一行包含两个整数：第一个是村庄 $V$ 的数量，第二个是邮局的数量 $P$。

第二行包含 $V$ 个整数。这些整数是村庄的位置。
## 输出格式

第一行包含一个整数 $S$，它是每个村庄与其最近的邮局之间的所有距离的总和。
## 样例

### 样例输入 #1
```
10 5 
1 2 3 6 7 9 11 22 44 50
```
### 样例输出 #1
```
9
```
## 提示

对于 $40\%$ 的数据，$V \leq 300$。

对于 $100\%$ 的数据，$1 \leq P \leq 300$，$P \leq V  \leq 3000$，$1 \leq $ 村庄位置 $\leq 10000$。


---

---
title: "[BalticOI 2016] 城市 (Day2)"
layout: "post"
diff: 省选/NOI-
pid: P4784
tag: ['2016', '枚举', '生成树', 'BalticOI（波罗的海）']
---
# [BalticOI 2016] 城市 (Day2)
## 题目描述

在 Byteland 有 $n$ 个城市，并且其中有 $k$ 个国王经常来访的主要城市。

其中有 $m$ 条道路，每条道路连接两个城市。然而不幸的是，这些道路的环境极差使得国王无法全速驶过。

对于每条道路，翻修的成本是已知的。你的任务是选择性的翻修道路使得 $k$ 个主要城市都可以经过翻修后的道路互相连通，且总成本尽量小。
## 输入格式

第一行，三个整数 $n,k$ 和 $m$，分别表示城市的个数，主要城市的个数和道路的个数。城市的编号分别为 $1,2,\dots,n$。

第二行，$k$ 个整数，表示主要城市。

接下来 $m$ 行，每行三个整数 $a,b$ 和 $c$，表示有一条双向道路从城市 $a$ 连接到城市 $b$，且翻修成本为 $c$。
## 输出格式

输出一行，表示满足以上条件的最小的总成本。


## 样例

### 样例输入 #1
```
4 3 6
1 3 4
1 2 4
1 3 9
1 4 6
2 3 2
2 4 5
3 4 8
```
### 样例输出 #1
```
11
```
## 提示

对于所有子任务，$1 \leq c \leq 10^9$ 且 $n \geq k$。

|子任务|分数|数据范围|
|:-:|:-:|-|
|1|22|$2 \leq k \leq 5,n \leq 20,1 \leq m \leq 40$|
|2|14|$2 \leq k \leq 3,n \leq 10^5,1 \leq m \leq 2 \cdot 10^5$|
|3|15|$2 \leq k \leq 4,n \leq 1000,1 \leq m \leq 2000$|
|4|23|$k = 4,n \leq 10^5,1 \leq m \leq 2 \cdot 10^5$|
|5|26|$k = 5,n \leq 10^5,1 \leq m \leq 2 \cdot 10^5$|



---

---
title: "萨塔尼亚的一生之敌"
layout: "post"
diff: 省选/NOI-
pid: P4833
tag: ['图论', '枚举', '队列']
---
# 萨塔尼亚的一生之敌
## 题目背景

“Trick or treat！”

万圣节到了，薇奈特、萨塔尼亚和菈菲尔敲开了珈百璃的门，但果然不出所料，珈百璃在打网游，真是颓废啊。

“干嘛，烦死了”珈百璃一脸嫌弃地看着她们

“珈百璃，好歹也出来玩玩嘛，天天待在家里打游戏，会烂掉的”薇奈特抢先说道

“哈？我每天都出去玩啊，去买泡面的时候顺路在家楼下逛了一圈啊”

“这只能算是去小卖部吧，根本不算是出去玩吧”

“对啊，而且万圣节到了，我们一起出去要糖果吃呀”

“哈？你几岁了？还玩这么无聊的游戏”

“不会啊，我觉得很有趣啊”三人异口同声

“真是的，好吧好吧，就陪你们玩玩”

于是珈百璃随着他们三个出去要糖果吃了

“那么，先去谁家呢？”

“我有提议！！”萨塔尼亚激动地抢着说

于是，她们一行人来到了某人家。

“咚咚咚”过了一会，门开了，走出来的，是一个光头吴克

“Trick or treat！”萨塔尼亚开心地叫倒。面前站的，就是她们的班主任。但是，除了萨塔尼亚在开心的要糖果，其他三个人早已经吓得瑟瑟发抖了

“呃。。班。。班主任。。。？老。。老师，这是有误会的。。。”薇奈特颤抖地说道

“哪有什么误会啊？班主任，Trick or treat！哦~再不给糖，就把你画成鬼~”萨塔尼亚依旧天不怕地不怕

“喂。。。”薇奈特微微后退了一步

但令人惊讶的是，老师居然进房间，拿了一袋礼品出来，其中包括萨塔尼亚最喜欢的限量版菠萝包

“啊！！！是限量版的！！！太好了！！！”当萨塔尼亚刚要伸手去拿菠萝包时，天使的走狗杀了出来，一把抢走了菠萝包。

“喂！！那是我的！！你给我回来”萨塔尼亚生气地望着天使的走狗，宣誓自己一定要抢回来

萨塔尼亚势力和天使的走狗势力占领着不同的区域，每个天使的走狗占领的区域都会有一个菠萝包，萨塔尼亚想抢回这些菠萝包，你能帮助她吗？

## 题目描述

详情是这样的，在萨塔尼亚强大的立场下，这个世界被分成了若干区域，有一些区域有连边。为了能够抢回菠萝包，萨亚尼亚将这些区域再分成了若干领域，使得每个领域由一些区域组成，萨塔尼亚占领了一些领域，并以这些领域为基础向走狗发起进攻。为了成功夺回所有菠萝包，萨塔尼亚决定让这些自己占领的领域满足以下性质

1、    为了能够及时支援友军，在自己占领的领域中，每两个存在于不同领域的两个点都要有连边

2、    为了能够灵活的进攻，自己的任意一个领域中的任意一个点和走狗占领的任意一个领域中的任意一个点都要有连边

当然走狗也不是吃干饭的，它为了羞辱萨塔尼亚，也选择了一些领域，这些领域满足的性质和萨塔尼亚选择的领域满足的性质一样，且走狗的领域和萨塔尼亚的领域互补

萨塔尼亚觉得，只要将领域分的越分散，胜利的几率就越大，于是想分尽可能多的领域，请问最多能分多少领域？每个领域有多少个区域组成？

\*特殊的，一个人可能占领不到任何一个领域，即占领的领域数量为0。如果你能告诉萨塔尼亚答案，萨塔尼亚就会占领最大的领域向走狗发起进攻，并最终失败。

## 输入格式

第一行两个整数n和m，表示n个区域m条边

接下来m行每行两个数a，b表示a和b之间有连边，保证没有自环和重边

## 输出格式

第一行输出一个整数s表示最多能分成领几个领域

第二行s个数从小到大输出每个领域由几个区域组成

## 样例

### 样例输入 #1
```
3 2
1 2
2 3

```
### 样例输出 #1
```
2
1 2

```
## 提示

样例解释：最多分成两个领域，区域1、3为一个领域，区域2为一个领域

请结合样例仔细读题！

对于40%的数据，n≤10^3，m≤5\*10^5

对于100%的数据，n≤10^5，m≤2\*10^6



---

---
title: "LJJ爱数数"
layout: "post"
diff: 省选/NOI-
pid: P4844
tag: ['数学', '枚举', '莫比乌斯反演']
---
# LJJ爱数数
## 题目背景

题解请查看 <https://www.cnblogs.com/Blog-of-Eden/p/9367521.html>。
## 题目描述

PJY 某次翻阅杂志时，看到一道题：

求出所有的 **正整数** 三元组 $(a,b,c)$，满足 $a,b,c \leq n$，**$\bold{a,b,c}$ 三个数的最大公约数为 $\bold{1}$**，且 **$\bold{\frac{1}{a}+\frac{1}{b}=\frac{1}{c}}$**。

PJY 嫌这道题太水，于是把它甩给了爱数数的 LJJ，并加上了数据范围 $\bold{n \leq 10^{12}}$，让 LJJ 数出 **有多少组满足条件的三元组 $\bold{(a,b,c)}$**
（注意当 $a \not= b$ 时，$(a,b,c)$ 和 $(b,a,c)$ 是不同的三元组，要算两次）

LJJ 数到一半，发现这个数量太大了，于是他把问题抛给了你。请你输出这个数量。
## 输入格式

输入仅一行：一个正整数 $n(n\leq 10^{12})$。
## 输出格式

输出仅一行：一个整数，表示满足条件的三元组 $(a,b,c)$ 的数量。
## 样例

### 样例输入 #1
```
10
```
### 样例输出 #1
```
3
```
### 样例输入 #2
```
100
```
### 样例输出 #2
```
43
```
### 样例输入 #3
```
100000
```
### 样例输出 #3
```
42139

```
## 提示

对于 $20\%$ 的数据，$n \leq 2 \times 10^{3}$。

对于 $40\%$ 的数据，$n \leq 10^{5}$。

对于 $60\%$ 的数据，$n \leq 10^{7}$。

对于 $80\%$ 的数据，$n \leq 10^{9}$。

对于 $100\%$ 的数据，$n \leq 10^{12}$。


---

---
title: "Samcompu Loves Water"
layout: "post"
diff: 省选/NOI-
pid: P4865
tag: ['并查集', '枚举']
---
# Samcompu Loves Water
## 题目背景

Samcompu拥有大量的**"水"**资源！！
## 题目描述

Samcompu需要制定一个**水**计划。这个计划的主要目的就是为了避开老师监视的时间来水。

老师在中途会离开机房$T$次，第$i$次将会离开$tim_i$秒。Samcompu划水的时候可不是随便乱水的。他可是拥有**"水"**资源的。在他的库存中有$N$个可以水的网站。Samcompu拥有一种黑科技，他可以几乎不耗任何时间在网站与网站之间跳转并且把跳转的网页的信息秒存。也就是说，Samcompu并不需要在每一次跳转的时候花费时间去浏览网页。当然，这只局限于$N$个网站之间的$N-1$个跳转方式(保证每一个网站都可以跳转到另外的所有网站)。对于第$i$种跳转方式，第$u_i$个网站到第$v_i$个网站的跳转存在一个危险程度$w_i$，这个危险值可能会造成电脑卡死，如果Samcompu不能及时处理，那么就会**完美地**被老师发现。

值得一提的是，在被查水表很多次后，Samcompu总结出了一个规律：

老师走得越久，能够保证在被老师发现之前处理好电脑卡死的危险程度的上限就越高。简单来说，两者就是成正比的关系，比例系数为1。

可惜的是，Samcompu的黑科技并不稳定，在老师第$i$次离开的时候，第$K_i$个跳转方式就不可用了。

当然，每一次水都可以从任意一个网站开始，也可以从任意一个网站结束。

现在Samcompu想知道，对于第$i$次老师离开机房时，他能够有多少种不同的安全的水的方案。两种水的方案不同当且仅当这两种水的方案的第一个网站或者最后一个网站不同。

(补充说明: 一个安全的水的方案当且仅当当前是老师第$j$次离开教室时跳转的路径中不存在一个跳转方式$i$使得$tim_j \leqslant w_i$，每一次水完后不可用的跳转方式就会恢复。)
## 输入格式

第一行两个正整数$T$, $N$

接下来$N-1$行，每一行三个正整数$u_i$, $v_i$, $w_i$

接下来$T$行，每一行两个正整数$tim_i$, $K_i$
## 输出格式

$T$行，每行一个正整数表示有多少中安全的水的方案。
## 样例

### 样例输入 #1
```
3 5
1 2 1
1 3 2
3 4 1
3 5 3
1 1
2 2
3 3

```
### 样例输出 #1
```
0
4
6

```
## 提示

![](https://cdn.luogu.com.cn/upload/pic/25960.png)

第一次连接1和2的边不可用，当前能经过的边的危险程度需要<1，并没有合法的方案。

第二次连接1和3的边不可用，当前能经过的边的危险程度需要<2，合法的方案有  (1,2)    (2,1)    (3,4)    (4,3)  共四种。

第三次连接3和4的边不可用，当前能经过的边的危险程度需要<3，合法的方案有  (1,2)    (1,3)    (2,1)    (2,3)    (3,1)    (3,2)  共六种。

提醒:本题计算答案按照点对的方式计算.也就是说,如果起点和终点一样,则只看做同一种方案.特别的,$(x,y)$和$(y,x)\ (x \neq y)$算作两种不同的方案.

数据范围：

Subtask 1(30 pts):

$$ T=1 \qquad 1 \leqslant K_i \leqslant N \leqslant 10^3 \qquad 1 \leqslant tim_i, w_i \leqslant 10^3 $$

Subtask 2(50 pts):

$$ 1 \leqslant T \leqslant 5*10^3 \qquad 1 \leqslant K_i \leqslant N \leqslant 10^4 \qquad 1 \leqslant tim_i, w_i \leqslant 10^3 $$

Subtask 3(20 pts):

$$ 1 \leqslant T \leqslant 10^4 \qquad 1 \leqslant K_i \leqslant N \leqslant 10^4 \qquad 1 \leqslant tim_i, w_i \leqslant 10^3 $$

数据保证不同的$K_i$最多只有$10^3$个。

温馨提醒：由于出题人数据比较毒瘤，所以请尽量卡常。


---

---
title: "Zrz_orz Loves Secondary Element"
layout: "post"
diff: 省选/NOI-
pid: P4866
tag: ['动态规划 DP', '枚举', '背包 DP']
---
# Zrz_orz Loves Secondary Element
## 题目背景

zrz_orz赘喜欢二次元辣！！
## 题目描述

众所周知的是，zrz_orz是全机房最强的死宅。~~他甚至使用嘴遁使得Samcompu不得不在自己的网站上挂上时崎狂三~~。(话说Samcompu好像醒悟了又把狂三给去掉了。)作为新一代死宅的一员，从电脑壁纸到输入法皮肤，到处都是二次元的痕迹。所以，他经常在梦里梦见一些二次元的角色。

zrz_orz的梦，是由$n$个点和$n-1$条边构成的连通图。其中有$m$个节点上有一个二次元的角色。对于zrz_orz来说，每一个二次元的角色都有一个对应的$pos_i$和$val_i$表示这个角色在图上的哪一个节点以及与之聊天对zrz_orz来说会增加多少愉悦值。(由于某种原因，聊天的过程可以不用计入时间。)可惜的是，zrz_orz每一次做梦都只会做$tim_i$个单位时间。现在请你告诉他，他每一次做梦最多能获得多少愉悦值。

注：

1.zrz_orz每一次做梦都只会从1号节点开始走！

2.每一次做梦后zrz_orz梦境中的图都不会改变！

**3.每一次做完梦之后zrz_orz就必须要回到1号节点，否则他就会迷失在梦境里！**
## 输入格式

第1行三个正整数$N$,$M$,$T$表示图的节点数、二次元角色的数量、做梦的天数。

接下来$N-1$行每行三个正整数$u_i$,$v_i$,$w_i$表示第$i$条边连接的两个节点以及zrz_orz走过这条边所花费的时间。

接下来$M$行每行两个正整数$pos_j$和$val_j$表示第$j$个二次元角色在节点上的位置以及能给zrz_orz带来的愉悦值。

接下来$T$行每行一个正整数$tim_k$表示第$k$天zrz_orz做梦的时间。
## 输出格式

一共$T$行。每一行包括一个正整数表示zrz_orz每天最多能获得的最大愉悦值。
## 样例

### 样例输入 #1
```
7 3 3
1 2 2
1 3 1
2 4 1
2 5 10
3 6 1
6 7 2
4 5
5 50
7 7
1
10
100

```
### 样例输出 #1
```
0
7
62
```
## 提示

![](https://cdn.luogu.com.cn/upload/pic/25600.png)

第一天哪里都去不了。

第二天1->3->6->7->6->3->1获得最大愉悦值为7。

第三天所有的地方都可以走一遍。

Subtask 1(20 pts): 

$ 1 \leqslant T \leqslant 10 \qquad 1 \leqslant N \leqslant 1000 \qquad 1 \leqslant M \leqslant 20 \qquad 1 \leqslant  tim_k \leqslant 1000$

Subtask 2(40 pts):

$ 1 \leqslant T \leqslant 10^5 \qquad 1 \leqslant N \leqslant 10^5 \qquad 1 \leqslant M \leqslant 20 \qquad 1 \leqslant  tim_k \leqslant 10^5$

Subtask 3(40 pts):

$ 1 \leqslant T \leqslant 5*10^4 \qquad 1 \leqslant N \leqslant 5000 \qquad 1 \leqslant M \leqslant 100 \qquad 1 \leqslant  tim_k \leqslant 100 \qquad 1 \leqslant w_i \leqslant 5$

For all test points:

$ 1 \leqslant pos_j,u_i,v_i \leqslant N \qquad 1 \leqslant \sum val_j \leqslant 2e9 \qquad 1 \leqslant w_i \leqslant 20 \qquad 1 \leqslant tim_k \leqslant 10^5 $

注意: 标记的分数就是这个Subtask的分数，每一个Subtask必须全对才能得分。Subtask 2的时限为1.5s。

$$ \color{white} \text{NOIP 2合1} $$


---

---
title: "序列"
layout: "post"
diff: 省选/NOI-
pid: P4891
tag: ['线段树', '枚举', '分块', '洛谷月赛']
---
# 序列
## 题目背景

# 本题数据已更新
## 题目描述

给定两个长度为 $n$ 的序列 $A$ 和 $B$，定义序列 $C_i=\max\limits_{j=1}^i A_j$。

定义当前的价值是 $\prod\limits_{i=1}^n \min(B_i,C_i)$。

现在有 $q$ 次操作，每次操作将会修改序列 $A$ 或者 $B$ 中的一个位置，将会把数字变大。现在请求出每次修改之后的价值。
## 输入格式

第一行两个整数 $n,q$。

第二行 $n$ 个整数表示 $A_i$。

第三行 $n$ 个整数表示 $B_i$。

接下来 $q$ 行，每行三个整数 $opt,x,y$，如果 $opt=0$ 表示对序列 A 操作，如果 $opt=1$ 则是对序列 $B$ 操作，把序列中第 $x$ 个元素变成 $y$，保证 $y$ 不小于原来的元素。
## 输出格式

输出 $q$ 行，表示每次修改之后的价值。

由于答案很大，请对 $10^9+7$ 取模后输出。
## 样例

### 样例输入 #1
```
3 1
2 1 3
1 2 3
1 3 5

```
### 样例输出 #1
```
6
```
## 提示

对于所有数据，满足 $1 \le n,q\le 10^5,0\le A_i,B_i,y \le 10^9$。

对于 20% 的数据范围，满足 $1\le n,q\le 1000$

对于另外 10% 的数据范围，满足 $opt=1$

对于另外 20% 的数据范围，满足 $opt=0$

对于 80% 的数据范围，满足 $n,q\le 50000$



---

---
title: "GodFly的寻宝之旅"
layout: "post"
diff: 省选/NOI-
pid: P4892
tag: ['枚举', '位运算', '状压 DP']
---
# GodFly的寻宝之旅
## 题目背景

“蒹葭苍苍，白露为霜。所谓伊人，在水一方…”

怀着$a$ $burning$ $desire$，$GodFly$开启了他追寻学妹之路。
## 题目描述

我们把校园抽象成一个具有$n$个点的无向连通图，其中的$n$个结点分别编号为$1,2,3,...,n$。把$GodFly$经过的结点表示为一个路径集合$A=\left\{a_1,a_2,a_3,...,a_m\right\}$，表示他依次经过了编号为$a_1$、$a_2$、…、$a_m$的结点，由于集合的元素具有互异性，这意味着$GodFly$无法重复经过同一个结点。

$GodFly$现在要从第$1$个结点走到第$n$个结点，然而他的腿疾对他造成了许多不便。定义$GodFly$经过了$m$个结点，当前在点$a_m$，且路径集合$A=\left\{a_1,a_2,a_3...,a_{m-1}\right\}$（加入新结点$a_m$前）时，他的总体力耗费为$w_m=(w_{m-1}+a_m*sum(A))$%$2$，其中$w_{m-1}$表示上一个路径集合的体力耗费；且对于集合$A$，$sum(A)=a_1+a_2+...+a_{m-1}$。

对于$w=0$的情况，我们称$GodFly$处于“滑基态”，否则对于$w=1$的情况，我们称$GodFly$处于“对偶态”。现在$GodFly$想要知道，他走到$n$结点后处于滑基态或对偶态的方案数，由于这个数可能很大，你只需要输出它对$19260817$取膜（模）的结果；注意两个方案是不同的，当且仅当它们有至少一条经过的边不同，而非路径集合不同。

**注意：T3压缩包内第一个数据有误，以题面的样例为准。**
## 输入格式

第一行，两个数$n$，$k$，分别表示点数和边数；

接下来$k$行，每行两个数$u$、$v$，表示结点$u$与结点$v$之间有一条边。

输入的最后一行为一个数$c$，$c=0$表示求滑基态方案数，$c=1$表示求对偶态方案数。
## 输出格式

一行，一个数表示方案数，详见题面。
## 样例

### 样例输入 #1
```
3 3
1 2
2 3
1 3
1
```
### 样例输出 #1
```
2
```
## 提示

**【数据范围】**

对于$30$%的数据，$n<=10$，$k<=45$，无重边及自环；

对于$60$%的数据，$n<=15$，$k<=300$；

对于$80$%的数据，$n<=15$，$k<=100000$；

对于$100$%的数据，$n<=18$，$k<=100000$；

样例数据在**data.zip\fantasy\**中。

**【样例说明】**

![](https://cdn.luogu.com.cn/upload/pic/30986.png)

如图，初始时在$1$结点，路径集合为$\left\{1\right\}$，费用为$0$；

若从$1$走到$2$结点再走到$3$结点，到$2$结点时，费用为$(0+2*sum(\left\{1\right\}))$%$2=2*1$%$2=0$，并把$2$加入路径集合，则此时路径集合为$\left\{1,2\right\}$；到$3$结点时，因上一次费用为0，费用为$(0+3*sum(\left\{1,2\right\}))$%$2=3*(1+2)$%$2=1$；

若从$1$结点直接走到$3$结点，则费用为$(0+3*sum(\left\{1\right\}))$%$2=3*1$%$2=1$。

故最终走到$3$结点时费用为$1$的方案数为$2$。

**【提示】**

本题时限$3s$，且可以开启$O_2$优化，不必过分担心卡常数，但请确保算法足够优美。


---

---
title: "天守阁的地板"
layout: "post"
diff: 省选/NOI-
pid: P4917
tag: ['O2优化', '枚举', '前缀和', '逆元']
---
# 天守阁的地板
## 题目背景

在下克上异变中，博丽灵梦为了找到异变的源头，一路打到了天守阁。  

异变主谋鬼人正邪为了迎击，将天守阁反复颠倒过来，而年久失修的天守阁也因此掉下了很多块地板。    

异变结束后，恢复了正常大小的小碗回到了天守阁，想要修复这里的地板，她需要知道自己要采购的地板数量(一个惊人的数字)，于是，她找到了精通 $\text{OI}$ 的你来帮忙。   

## 题目描述

为了使万宝槌能发挥出全部魔力，小碗会将买来的地板铺满一个**任意**边长的正方形(地板有图案，因此**不允许旋转**，当然，地板也**不允许重叠**)来达到最大共鸣。  

在每一次购买中，小碗只能买到一种规格为 $a*b$ 的地板，为了省钱，她会在满足能摆成正方形的前提下购买尽可能少的地板。  
  
现在，她想知道对于每一对 $a,b(1≤a,b≤n)$ ，她最少需要购买的地板数量。当然，由于输出可能很大，你只需要输出所有答案的乘积对 `19260817` 取模后的结果即可。    
## 输入格式

第一行一个整数 $\text{T}$ ，表示数据组数  

下面 $\text{T}$ 行，每行一个整数 $n$ 
## 输出格式

共 $\text{T}$ 行，每行一个整数，表示取模后的答案
## 样例

### 样例输入 #1
```
4
1
2
3
100
```
### 样例输出 #1
```
1
4
1296
18996121
```
## 提示

#### 样例解释:  

对于`n=1`，$(a,b)$ 仅有 $(1,1)$ 一种情况，只需要一块 $1 * 1$ 的地板即可构成边长为1的正方形,答案为 $1$  

对于`n=2`，$(a,b)$ 有 $(1,1),(1,2),(2,1),(2,2)$ 四种情况，分别需要 $1,2,2,1$ 块地板以拼成正方形，答案为 $1*2*2*1=4$  

进一步解释：  

当只能买到 $1*1$ 的地板时，只需要一块(本身就是正方形)  

当只能买到 $1*2$ 的地板时，需要两块(两块拼在一起组成 $2*2$ 的正方形)  
  
#### 数据范围：

对于 $30\%$ 的数据，$1 \le T \le 100,1 \le n \le 100$  

对于 $60\%$ 的数据，$1 \le T \le 300,1 \le n \le 3*10^4$   

对于 $100\%$ 的数据，$1 \le T \le 1000,1 \le n \le 10^6$    


---

---
title: "[MtOI2018] gcd？人生赢家！"
layout: "post"
diff: 省选/NOI-
pid: P4923
tag: ['2018', '洛谷原创', 'O2优化', '枚举', '最短路', '状压 DP']
---
# [MtOI2018] gcd？人生赢家！
## 题目背景

gcd 是一个热爱游戏的人。
## 题目描述

gcd 最近在玩一个有趣的游戏。

我们把这个游戏抽象成一张图，图上有 $n$ 个点，gcd 需要寻找总计 $m$ 件宝物，它们分布在图上。

对于每件宝物而言，将会有一个前置集合 $S$。只有当取得所有前置宝物时，才能获得该宝物。

gcd 拥有一件神器，这件神器具有传送功能，它可以使用 $k$ 次，可以传送到一个任意节点。

对于游戏而言，肯定会有额外的成就，这些成就会奖励一定的传送次数，成就的达成是满足集合 $S$ 的一瞬间。

现在 gcd 想知道能最快通关的方法，请你求出通关的最少时间。
## 输入格式

输入共 $s+m+e+6$ 行。

第 $1$ 行输入 $3$ 个正整数 $n,m,k$。

第 $2$ 行输入 $1$ 个正整数 $s$ 表示成就的数量。

以下 $s$ 行每行输入 $1$ 个非负整数 $num$ 表示需求多少个宝物，然后输入 $num$ 个数，为所需宝物编号。

第 $s+3$ 行输入 $s$ 个正整数 $a_1,a_2,\cdots a_s$ 表示成就的奖励次数。

第 $s+4$ 行输入 $m$ 个正整数 $p_1,p_2,\cdots p_m$ 表示宝物的位置。

第 $s+5$ 行输入 $1$ 个正整数 $e$ 表示边的总数。

以下 $e$ 行每行输入 $3$ 个正整数 $x,y,z$ 表示 $x$ 与 $y$ 之间有一条边权为 $z$ 的无向边连接。

以下 $m$ 行每行输入 $1$ 个非负整数 $num$ 表示宝物前置要求个数，然后输入 $num$ 个数，为要求的编号。

最后一行输入 $1$ 个正整数 $st$ 表示起点。
## 输出格式

输出共 $1$ 行 $1$ 个正整数，输出最少时间。
## 样例

### 样例输入 #1
```
3 2 0
1
1 1
1
2 3
3
1 2 20
1 3 20
3 2 1
0
0
1

```
### 样例输出 #1
```
20
```
### 样例输入 #2
```
3 2 0
1
1 1
1
2 3
3
1 2 1
1 3 20
3 2 20
1 2
0
1
```
### 样例输出 #2
```
40
```
## 提示

### 子任务

对于 $20\%$ 的数据，$s=0$。

对于 $100\%$ 的数据，$n\leq 200$，$m\leq 12$，$k\leq 4$，$s\leq 8$，$e\leq 20000$ ，奖励次数总和不超过 $8$，保证每两个宝物的位置不相同，可能有重边，保证有解。

### 题目来源

[MtOI2018 迷途の家の水题大赛](https://www.luogu.org/contest/11260) T5

出题人：b2019dy

78488


---

---
title: "礼物"
layout: "post"
diff: 省选/NOI-
pid: P4934
tag: ['Special Judge', 'O2优化', '枚举', '排序', '拓扑排序', '洛谷月赛']
---
# 礼物
## 题目背景

由于你出色的完成了前面两道题目，善良的 __stdcall 决定给你一个小礼物，给拼搏在 AK 这套题之路上的你，一个有力的援助。
## 题目描述

__stdcall 决定给你 $n$ 个礼物，每个礼物有一个魔力值 $a_i$。

这些礼物的魔力值都是独一无二的，两两互不相同。这些礼物都有着神奇的魔力，如果两个礼物 $i, j$ 的魔力值满足 $a_i \operatorname{bitand} a_j \ge \min(a_i, a_j)$，那么这两个礼物的魔力将会相互抵消，因此它们不能放在一个箱子里。

这里的 $\operatorname{bitand}$ 表示按位与运算，如果你对这一运算不够了解，请参考：<https://baike.baidu.com/item/%E6%8C%89%E4%BD%8D%E4%B8%8E/9601818>。

作为发礼物苦力的 ljt12138 的箱子并不多，不过幸运的是，每个箱子都足够大。现在他请求你帮助他合理分配，用**尽可能少**的箱子装下所有礼物。换言之，使得每个礼物都被恰好装入一个箱子中，且同一个箱子中的礼物魔力不会相互抵消。如果有多种合法的方案，你只需要给出**任意一种**。

ljt12138 十分善良，如果你只能求出所需要的箱子数，也可以获得该测试点 $60\%$ 的分数，关于这一点，请参考下面的提示与说明。
## 输入格式

- 第一行两个数 $n$ 和 $k$，$n$ 为礼物总数，$k$ 为一个参数，方便你进行计算。
- 第二行 $n$ 个两两不同的数$a_i$，满足 $0\le a_i < 2^k$，表示礼物的魔力值。
## 输出格式

- 第一行输出一个数。如果你不希望输出方案，请输出0；如果你希望输出方案，请输出 $1$。**如果你在这一行输出了不符合要求的信息，将被判为 WA**。
- 第二行一个数 $m$，表示你将礼物装到了 $m$ 个箱子里。
- 如果你在第一行输出了 $1$，接下来 $m$ 行，每行表示一个箱子：首先一个数 $s_i$，表示当前箱子中礼物的个数；接下来 $s_i$ 个数，表示当前子集。
## 样例

### 样例输入 #1
```
5 3
0 4 7 1 6 

```
### 样例输出 #1
```
1
4
1 0
2 1 4
1 6
1 7 
```
## 提示

### 附加样例

你可以在  <https://pan.baidu.com/s/1A8_ZA4yXXi5y6771x9JKUw> 下载附加样例。

### 关于输出方案

- 如果你在第一行输出了 $0$，而正确回答了最小所需的箱子数，将获得测试点 $60\%$ 的分数。
- 如果你在第一行输出了 $1$，正确回答了最小所需的箱子数，但没有给出正确的方案，也将获得该测试点 $60\%$ 的分数。
- 如果你没有正确回答最小所需的箱子数，将不会获得该测试点的分数。
- 请选手注意，如果你未按照上述格式输出答案，将无法获得任何分数。

数据 $n, k$ 的关系由下面的表格给出：

|数据编号| $n$ | $k$ |
|:----:|:----:|:----:|
|$1$|$5$|$3$|
|$2$|$6$|$3$|
|$3$|$7$|$10$|
|$4$|$8$|$10$|
|$5$|$16$|$7$|
|$6$|$17$|$8$|
|$7$|$17$|$9$|
|$8$|$17$|$20$|
|$9$|$2\times 10^3$|$17$|
|$10$|$2.5\times 10^3$|$18$|
|$11$|$3\times 10^3$|$19$|
|$12$|$3\times 10^3$|$20$|
|$13$|$2.5\times 10^4$|$15$|
|$14$|$2.5\times 10^4$|$15$|
|$15$|$5\times 10^4$|$16$|
|$16$|$5\times 10^4$|$16$|
|$17$|$2.5\times 10^5$|$18$|
|$18$|$5\times 10^5$|$19$|
|$19$|$10^6$|$20$|
|$20$|$10^6$|$20$|


---

---
title: "美樱的颜料"
layout: "post"
diff: 省选/NOI-
pid: P4963
tag: ['动态规划 DP', '数学', '枚举']
---
# 美樱的颜料
## 题目背景

在春辉去美国留学之后，美樱时常感到寂寞。为了排解寂寞，她在画画时总是对颜料有着特殊的要求。

![](https://i.loli.net/2018/10/10/5bbd8d3178ee9.jpg)
## 题目描述

美樱共有 $n$ 种不同的颜料，编号依次为 $1$ ~ $n$，每种颜料只能使用一次。开始画一幅画时，美樱可以任意选择一种颜料使用。之后，美樱每次都会选择一种颜料 $i$ 使用，满足使用颜料 $i$ 后已经使用了的颜料的编号的 $gcd$（最大公约数）尽量大，即：

> 设现在已经使用了的颜料编号构成的集合为 $A$，若$\ \exists\ i,\ j\notin A,\ i,\ j\in [1,\ n],\ gcd(A,\ i)>gcd(A,\ j)$，那么就不能选择颜料 $j$。

如果有多种满足条件的颜料，美樱可以任意选择一种使用。每使用完一种颜料，美樱就会获得当前使用了的所有颜料的编号的 $gcd$ 的快乐值。

现在美樱想画一幅使用 $m$ 种颜料的画，她能够获得的最大快乐值之和是多少？
## 输入格式

共一行，两个正整数 $n,\ m$，分别代表颜料的种类数和美樱要使用的颜料数。
## 输出格式

一个正整数，美樱能获得的最大快乐值。
## 样例

### 样例输入 #1
```
7 4
```
### 样例输出 #1
```
11
```
### 样例输入 #2
```
15 3
```
### 样例输出 #2
```
25
```
## 提示

$1\le m\le n\le 10^7$

## 样例解释

样例一：`6 3 5 2`为一组最优解，每次获得的快乐值分别为`6 3 1 1`

样例二：`15 10 5`为一组最优解，每次获得的快乐值分别为`15 5 5`


---

---
title: "绫小路的特别考试"
layout: "post"
diff: 省选/NOI-
pid: P4964
tag: ['贪心', '枚举', '排序', '深度优先搜索 DFS', '栈']
---
# 绫小路的特别考试
## 题目背景

>  这世界上「胜利」便是一切。无关乎过程。
要付出多少牺牲都无所谓。只要最后我「胜出」那就行了。

![](https://i.loli.net/2018/10/06/5bb879f4ac370.jpg)
## 题目描述

一场新的特别考试来临了，这次的考试内容是（wan e de）文化课，但有所不同的是，考试中允许学生使用对讲机。然而，对讲机的接收范围是有限的（每个对讲机都能发送无限远，但是只能接收到接收范围内的信号），所以不是所有学生都能接收到其他同学的广播。

考试时，共有 $n$ 名学生坐成一排（从左至右依次编号为 $1$ ~ $n$），绫小路自己坐在第 $c$ 号位置。每名学生都有一个能力值 $w_i$。绫小路已经给每名学生安排了一个接收范围为 $d_i$ 的对讲机。

每名学生可以直接做出难度**不超过**自身能力值的**所有**题目，一旦一名学生凭能力做出某道题，他就会把这道题的做法进行广播。一名坐在位置 $i$，有接收范围为 $d_i$ 的对讲机的学生，可以接收到 $[i-d_i,\ i+d_i]$ 范围内所有学生的广播，若这个范围内有人公布了做法，则他将会做这道题，并也会把这道题的做法进行广播。

绫小路会问你一些问题：当一道题目难度为 $x$ 时，有多少学生会做这道题？由于绫小路想隐藏实力，他可能会修改自己的能力值。这两种操作分别用以下两种方式表示：

- $1\ x$，表示询问当一道题目难度为 $x$ 时，有多少学生会做这道题。

- $2\ x$，将绫小路的能力值修改为 $x$，即将 $w_c$ 修改为 $x$。

---

形式化描述（与上文同义）：

> 给你两个长为 $n$ 的数列 $w_{1..n}$ 和 $d_{1..n}$，以及一个 $w_c$ 可修改的位置 $c$。现在有两种操作（共 $m$ 次）：
- $1\ x$ 表示一次询问：设 $f_i=\begin{cases}1\quad(w_i\ge x)\\1\quad(\exists\ j \in [i - d_i,\ i + d_i],\ f_j=1)\\ 0\quad(otherwise)\end{cases}$，这里的 $f_i$ 定义中引用了 $f_j$，$\ \ \ \ $所以 $f_{1..n}$ 是会不断更新的，直到无法继续更新时，计算这次询问的答案为 $\sum\limits_{i=1}^nf_i$。
- $2\ x$ 表示一次修改：把 $w_c$ 修改为 $x$。
## 输入格式

由于数据量太大，为了避免读入耗时过长，使用**伪随机数生成器**的方式输入，并**强制在线**。

**建议你忽略输入格式，直接使用下面提供的数据生成器模板，了解具体的生成过程对你来说是不必要的。**

第一行，三个正整数 $n,\ m,\ c$，分别代表学生的总人数，操作总数和绫小路所在的位置。

第二行，五个整数 $\mathrm{seed},\ \mathrm{mind},\ \mathrm{maxd},\ \mathrm{mfq},\ k$。

> 此处的 $\mathrm{mind},\ \mathrm{maxd}$ 仅用于生成初始的 $d_{1..n}$，下文中调整 $d_p$ 所用的 $t$ 可能不在 $[\mathrm{mind},\ \mathrm{maxd}]$ 范围内。

接下来的 $k$ 行，每行两个整数 $p,\ t$，表示调整第 $p$ 号同学的对讲机接收范围（即 $d_p$）为 $t$。

> 若一名同学的对讲机接收范围被调整多次，以**最后一次**为准。

---

** 数据生成器模板：**

```cpp
#include <cstdio>

unsigned long long seed;
int n, m, c, mfq, mind, maxd, k, w[2000001], d[2000001];

inline int randInt() { seed = 99999989 * seed + 1000000007; return seed >> 33; } 

void generate()
{
	// 在读入种子后生成初始的 w 数组和 d 数组.
    for (int i = 1; i <= n; i++) { w[i] = randInt() % n; }
    for (int i = 1; i <= n; i++) { d[i] = randInt() % (maxd - mind + 1) + mind; }
}

void getOperation(int lastans, int &opt, int &x)
{
    // 生成一次操作的参数 opt 和 x, lastans 表示上一次询问的答案, 初始值为 0.
    if ((0ll + randInt() + lastans) % mfq) { opt = 1; } else { opt = 2; }
    x = (0ll + randInt() + lastans) % n;
}

int main()
{
    scanf("%d %d %d", &n, &m, &c);
    scanf("%llu %d %d %d %d", &seed, &mind, &maxd, &mfq, &k);
    generate();
    for (int i = 1; i <= k; i++)
    {
        int p, t;
        scanf("%d %d", &p, &t);
        d[p] = t;
    }
    // 从这里开始，你可以使用生成的 w 数组和 d 数组.
    int lastans = 0, finalans = 0;
    for (int i = 1; i <= m; i++)
    {
        int opt, x;
        getOperation(lastans, opt, x);
        if (opt == 1)
        {
            // 在这里执行询问操作，并用答案的表达式替代下面的 ___.      
            finalans = (finalans * 233ll + ___) % 998244353;
            lastans = ___;
        }
        else
        {
            // 在这里执行修改操作.
        }
    }
    printf("%d\n", finalans);
    return 0;
}
```
## 输出格式

令 $ans_i$ 表示第 $i$ 次询问（操作 $1$）的答案，$T_i=\begin{cases}(T_{i-1}\times 233+ans_i)\mod 998244353\quad(i\ge 1)\\0\quad(i=0)\end{cases}$

设 $q$ 表示询问（操作 $1$）的个数，你只需要输出一个整数 $T_q$。
## 样例

### 样例输入 #1
```
3 3 2
19720918 0 1 2 0
```
### 样例输出 #1
```
700
```
### 样例输入 #2
```
10 10 8
2102036 0 1 4 1
5 2
```
### 样例输出 #2
```
760521825
```
### 样例输入 #3
```
1000 1000 126
114321251 1 2 2 0
```
### 样例输出 #3
```
91977056
```
## 提示

### 你需要用到的变量：

$1\le c\le n\le 2\times 10^6$，$1\le m\le 2\times 10^6$，$0\le w_i,\ d_i,\ x<n$。

### 其它用于生成数据的变量：

$1\le \mathrm{seed},\ \mathrm{mfq}\le 10^9$，$0\le \mathrm{mind}\le \mathrm{maxd}<n$，$0\le k\le 2\times 10^5$，$1\le p\le n$，$0\le t<n$。

## 样例解释

### 样例一：

生成得到三名同学的能力值 $w_{1..3} = \{0,\ 1,\ 2\}$，对讲机接收范围 $d_{1..3} = \{1,\ 0,\ 1\}$。

第一个操作是 `1 1`，询问有多少同学会做难度为 $1$ 的题。

绫小路（第 $2$ 名同学）和第 $3$ 名同学能够独立做出这道题（$w_2 \ge 1$ ，$w_3 \ge 1$），第 $1$ 名同学虽然能力不足，但通过对讲机能接收到绫小路广播的做法（$2 \in [1 - d_1,\ 1 + d_1]$），所以他也会做。故 $ans_1 = 3$。

第二个操作是 `2 0`，修改绫小路（第 $2$ 名同学）的能力值为 $0$。此时 $w_{1..3} = \{0,\ 0,\ 2\}$。

第三个操作是 `1 1`，再次询问有多少同学会做难度为 $1$ 的题。

只有第 $3$ 名同学能够独立做出（$w_3 \ge 1$），然而第 $1$ 名同学和绫小路（第 $2$ 名同学）都无法接收到他广播的做法（$3 \notin [1 - d_1,\ 1 + d_1]$，$3 \notin [2 - d_2,\ 2 + d_2]$），做不出来。故 $ans_2 = 1$。

综上所述，$T_1 = ans_1 = 3$，$T_2 = 3 \times T_1+ ans_2 = 3 \times 233 + 1 = 700$，仅输出 $700$ 即可。

### 样例二：

生成得到 $w_{1..10} = \{1,\ 6,\ 6,\ 5,\ 3,\ 5,\ 2,\ 7,\ 9,\ 5\}$，$d_{1..10} =\{1,\ 1,\ 1,\ 1,\ 2,\ 0,\ 1,\ 0,\ 1,\ 1\}$。

十次操作及对应结果如下所示：

`1 6`，查询操作，$ans_1 = 9$，$T_1 = 9$。

`2 2`，修改操作，$w_{1..10}$ 变为 $\{1,\ 6,\ 6,\ 5,\ 3,\ 5,\ 2,\ 2,\ 9,\ 5\}$。

`1 7`，查询操作，$ans_2 = 2$，$T_2 = 2099$。

`1 3`，查询操作，$ans_3 = 9$，$T_3 = 489076$。

`2 4`，修改操作，$w_{1..10}$ 变为 $\{1,\ 6,\ 6,\ 5,\ 3,\ 5,\ 2,\ 4,\ 9,\ 5\}$。

`1 3`，查询操作，$ans_4 = 10$，$T_4 = 113954718$。
  
`2 2`，修改操作，$w_{1..10}$ 变为 $\{1,\ 6,\ 6,\ 5,\ 3,\ 5,\ 2,\ 2,\ 9,\ 5\}$。
  
`1 9`，查询操作，$ans_5 = 2$，$T_5 = 597096118$。  

`1 0`，查询操作，$ans_6 = 10$，$T_6 = 367430437$。    

`1 3`，查询操作，$ans_7 = 9$，$T_7 = 760521825$。

仅输出 $760521825$ 即可。

### 样例三：

~~出题人有足够的良心写出这个样例的解释，可惜版面太小，写不下。~~


---

---
title: "评分系统"
layout: "post"
diff: 省选/NOI-
pid: P4993
tag: ['递推', '枚举', '素数判断,质数,筛法']
---
# 评分系统
## 题目背景

答疑请到：https://www.luogu.org/discuss/show?postid=79498

由于时限等问题，请大家重交一遍这道题

本题时限开至2s

样例：https://files.cnblogs.com/files/ztz11/yl.rar

---

众所周知，luogu 有题目难度的评分系统，用户在通过题目后可以选择题目难度以及算法标签，来完善 luogu 的题库。

![](https://cdn.luogu.com.cn/upload/pic/40327.png)

（原注：以下内容非真实评分数据，纯属作者编造，仅供娱乐使用。）
## 题目描述

Menteur-Hxy 同学很不老实，为了实现 NOIp 前 AC $100$ 道黑题的目标，他决定雇佣一些水军，最少雇佣 $1$ 个水军。

每个水军都有一个能力值 $x_i$，表示该水军可以解决难度最高为 $x_i$ 的题目。这些水军十分尽职尽责，在通过这道题目后都会给题目评最高难度。当然，luogu 的正常用户也会做题，他们会正常地评分。现在，我们给你所有水军的能力值以及每道题正常用户的评分记录，请你求出有多少种选择水军的方案，可以使这道题的评分变为黑题。因为答案可能过大，最终请输出答案数 $\bmod p$ 的值。

评分计算公式：去掉一个最高分，去掉一个最低分后求平均分。

**【表一：投票信息】**

| 投票编号 | 对应难度 | 分数贡献 |
| :------: | :------: | :------: |
| $1$ | 入门 | $1$ |
| $2$ | 普及- | $10$ |
| $3$ | 普及/提高- | $15$ |
| $4$ | 普及+/提高 | $25$ |
| $5$ | 提高+/省选- | $40$ |
| $6$ | 省选/NOI- | $55$ |
| $7$ | NOI | $75$ |
| $8$ | NOI+/CTSC | $100$ |

**【表二：难度规则】**

| 难度等级 | 对应颜色 | 对应分数 |
| :------: | :------: | :------: |
| 入门 | 红 | $1\sim 5$ |
| 普及- | 橙 | $6\sim 12$ |
| 普及/提高- | 黄 | $13\sim 20$ |
| 普及+/提高 | 绿 | $21\sim 35$ |
| 提高+/省选- | 蓝 | $36\sim 45$ |
| 省选/NOI- | 紫 | $46\sim 70$ |
| NOI+/CTSC | 黑 | $71\sim 100$ |
## 输入格式

**本题有多组数据。**

第一行，一个整数 $T$，表示数据组数。

对于每组数据：

+ 第一行三个整数 $n, m, p$，分别表示 Menteur-Hxy 找的水军数量，luogu 用户评分数量，和输出时的模数。
+ 第二行，$n$ 个整数 $s_1 \dots s_n$ 分别表示水军的能力值。
+ 第三行，$m$ 个整数 $t_1 \dots t_n$，表示每个 luogu 用户的投票编号。
+ 第四行，一个整数 $k$ ，表示题目的难度系数。
## 输出格式

对于每组数据，输出一行一个整数，表示总选择方案数对 $p$ 取模后的结果，如无解，则输出 $0$。
## 样例

### 样例输入 #1
```
1
5 5 9
1 2 3 4 5
4 5 6 7 8
2
```
### 样例输出 #1
```
2
```
### 样例输入 #2
```
5
20 10 1329
540 499 490 419 308 261 323 476 476 374 23 13 14 16 19 34 43 19 27 32 
8 8 8 8 8 7 7 7 7 7 
50
20 10 1800
74 434 97 134 283 118 234 498 328 388 29 48 48 43 23 42 31 16 20 26 
8 8 7 6 8 8 8 7 7 7 
50
20 10 2704
142 378 330 281 377 64 340 309 466 289 34 37 19 17 20 48 21 28 38 15 
6 8 6 6 8 7 7 7 7 6 
50
20 10 72
365 356 456 479 459 222 548 377 212 223 38 20 49 18 49 38 31 48 41 17 
6 8 7 6 8 7 8 8 8 6 
50
20 10 1416
367 191 403 298 445 464 79 467 431 362 10 45 48 37 46 43 11 35 30 39 
8 6 8 7 7 7 8 8 7 8 
50
```
### 样例输出 #2
```
1023
1023
1023
15
1023
```
## 提示

**【样例解释 $1$】**

luogu 用户评分和为 $25+40+55+75+100=295$，弃掉一个最低分后为 $270$，这时 Menteur-Hxy 雇佣两个及以上水军就可以达到目的。

因为可以通过本题的水军共有 $4$ 个，所以选择方案共有：

$$\{1,2\}\{1,2,3\}\{1,2,3,4\}\{1,2,4\}\{1,3\}\{1,3,4\}\{1,4\}\{2,3\}\{2,3,4\}\{2,4\}\{3,4\}$$

共 $11$ 种，对 $9$ 取余后结果为 $2$。

**【数据规模与约定】**

对于 $30\%$ 的数据，$n, m \leq 50$。

对于另外 $20\%$ 的数据，$p$ 为质数。

对于 $100\%$ 的数据，$1 \leq n, m, k,s_i \leq 10^5, 1 \leq t \leq 5, 2 \leq p \leq 3 \times 10^3, 1 \leq t_i \leq 8$。

保证合格水军的数量与需要的最少水军数量之差不超过 $5000$。

（原注：本题可能轻微卡常。感谢 @Ghostcai ，@Swhsz 帮忙验题。）


---

---
title: "随机生成树"
layout: "post"
diff: 省选/NOI-
pid: P5036
tag: ['模拟', '枚举', '连通块']
---
# 随机生成树
## 题目背景

@葛军 改编的水题


## 题目描述

rainheavy在纸上画了N个点（从1到N编号），每个点的颜色用一个整数描述。rainheavy决定用这N个点随机生成一棵树，生成的规则如下：

对于2号点到N号点，每个点随机指定连接一个点。i号点(2 <= i <= N)的连的点在i的约数中和i的倍数中不超过N的中随机挑选一个。（例如N=30时10号点的可以连接1号，2号，5号，20号，30号）

生成的树中不能有重边（不然就不叫树了）

树生成完之后，rainheavy可以计算出这个树有多少个联通块，一个联通块是一些点的集合，需要满足以下两个条件：

1、从集合中任取两个点都满足：两个点颜色相同，且这两个点之间存在一条树边组成的路径，路径上的所有点都和这两个点颜色相同

2、对于集合中的任意一个点和集合外的任意一个点：两点要么不同色，要么不存在一条树边组成的路径使得路径上所有点都和这两个点同色。

rainheavy希望计算出生成的树中联通块个数最多时，需要连接哪些边，但是rainheavy太强了，不屑于做这种辣鸡题目，~~更重要的是他要去AK IOI~~，于是就把题目扔给了你

注：边的顺序

1.首先，满足连通块个数最多的优先（即对于生成连通块有贡献的优先）

2.同样满足条件1时，连接的两个点编号之和较小的边优先（如满足条件1时，连接3号点和5号点的边比连接4号点和5号点的边优先）

3.同时满足条件2时，连接的两个点编号的之中较小的一个较小的边优先（如满足条件2时，连接2号点和6号点的边比连接3号点和5号点的边优先）
## 输入格式

第一行一个整数N代表点数

第二行N个整数，第i个整数$c_i$代表第i个点的颜色

## 输出格式

输出共n-1行，每行两个整数x,y表示需要一条边连接点x和点y（要求x<y，且输出的顺序满足题目描述中边的顺序）

Tip：由于输出较多，建议用快速输出（不会就算了顶多T掉嘛对不对）
## 样例

### 样例输入 #1
```
4
3 2 3 2
```
### 样例输出 #1
```
1 2
1 4
1 3
```
## 提示

对于样例的解释：因为2号、4号点会对生成联通块有贡献（3号你连了也没用），又因为1+2<1+4，所以1 2比1 4优先输出，最后再输出1 3


对于30%的数据, 2 <= N <= 10

对于60%的数据, 2 <= N <= 5000

对于80%的数据, 2 <= N <= 200000

对于100%的数据, 2 <= N <= 500000，1<=颜色<=1e9（反正多了也没用）


---

---
title: "[yLOI2019] 珍珠"
layout: "post"
diff: 省选/NOI-
pid: P5523
tag: ['2019', 'O2优化', '枚举', '位运算']
---
# [yLOI2019] 珍珠
## 题目背景

> 别叹息太多告别，至少相遇很真切。  
> 摇曳着盛放枯竭，时间从未停歇。  
> 天涯浪迹的白雪，念念不忘山川蝴蝶。  
> 听说有人孤负黑夜，偏要点亮人间的月。

——银临《珍珠》
## 题目描述

扶苏给了你一个放珍珠的小匣子，这个匣子在左右两端都可以无限制的加入珍珠，珍珠在匣子里会排成一列，每次在左端加入珍珠，这个珍珠会被加入到这个珍珠序列的最左侧，在右端加入则会被加入到珍珠序列的最右侧。初始时，匣子是空的。

这些珍珠要么是黑色的，要么是白色的，为了方便起见，我们将白色看作 $0$，黑色看作 $1$。

在人鱼的世界中，定义颜色 $A$ **组合** 颜色 $B$ 为 $A\operatorname{nand}B$，读作 $A$ 与非 $B$。

定义 $A \operatorname{nand} B = \operatorname{not} (A \operatorname{and}B)$ ，其中 $\operatorname{and}$ 运算代表二进制与运算，$\operatorname{not}$ 运算代表二进制非运算。

定义位置 $x$ 到位置 $y$ 的组合和为：

从 $x$ 开始向 $y$ ，第一个颜色组合第二个颜色的结果组合第三个颜色，得到的结果组合第四个颜色……一直组合到位置 $y$ 的颜色的结果。特别的，$x = y$ 时，组合和为该颜色。

形式化的，设 $C_{x, y}$ 为序列 $A$ 从 $x$ 到 $y$ 的组合和，则
$$C_{x, y} = \begin{cases} C_{x, y - 1} \operatorname{nand} A_y & x < y \\  C_{x, y + 1} \operatorname{nand} A_y & x > y \\ A_x &x = y \end{cases}$$

例如，给定序列 $1, 1, 0, 0$，从 $2$ 到 $4$ 的组合和为 

$$(1 \operatorname{nand} 0) \operatorname{nand} 0 = 1 \operatorname{nand} 0 = 1$$

从 $3$ 到 $1$ 的组合和为

$$(0 \operatorname{nand} 1) \operatorname{nand} 1 = 1 \operatorname{nand} 1 = 0$$

从 $2$ 到 $2$ 的组合和为

$$1$$

扶苏会在匣子的两边加入一些珍珠，或者给定一个位置 $p$，询问你从左向右数第 $1$ 个位置到从左向右数第 $p$ 个位置的组合和，或者从右向左数第 $1$ 个位置到从右向左数第 $p$ 个位置的组合和。
## 输入格式

每个输入文件中都有且仅有一组测试数据。

数据的第一行是一个整数 $n$，代表扶苏的操作个数。

由于正常读入每个操作所需要的输入量过大，因此我们采用下面的生成器来生成每个操作。

```cpp
#include <cstdio>

namespace Maker {

typedef unsigned int uit;

bool __sp;
uit __x, __y, __z;
int __type, __k, __m;

template <typename T>
inline void qr(T &x) {
  char ch = getchar(), lst = ' ';
  while ((ch > '9') || (ch < '0')) lst = ch, ch = getchar();
  while ((ch >= '0') && (ch <= '9')) x = (x << 1) + (x << 3) + (ch ^ 48), ch = getchar();
  if (lst == '-') x = -x;
}

template <typename T>
inline void Begin(const T &x) {
  __type = x % 10;
  qr(__x); qr(__y); qr(__z); qr(__m);
  __sp = (__type == 3) || (__type == 4); __type &= 1;
}

inline uit __Next_Integer() {
  __x ^= __y << (__z & 31);
  __y ^= __z >> (__x & 31);
  __z ^= __x << (__y & 31);
  __x ^= __x >> 5; __y ^= __y << 13; __z ^= __z >> 6;
  return __x;
}

inline uit Rand() { return __Next_Integer(); }

template <typename Tx, typename Ty, typename Tz>
inline void Get_Nextline(Tx &x, Ty &y, Tz &z) {
  if (__m) {
    --__m;
    x = 0; y = 0; z = 0;
    qr(x); qr(y); qr(z);
    if (x == 0) {
      ++__k;
    }
  } else {
    x = Rand() & 1; y = Rand() & 1;
    if (__k == 0) { x = 0; }
    if (x == 0) {
      ++__k;
      if (__sp) {
        z = __type;
      } else {
        z = Rand() & 1;
      }
    } else {
      int dk = __k >> 1;
      if (dk == 0) {
        z = 1;
      } else {
        z = Rand() % dk + dk;
      }
    }
  }
}

}
```

对于 C/C++ 选手，我们提供了如上的数据生成代码（C 选手请使用 C++ 语言提交)，请将他们直接复制到你的代码中。

对于非 C/C++ 选手，请你自行按照上面代码的内容，自行写出你所使用语言的对应生成器。

下面的内容只针对 C++ 选手，请其他语言的选手自行按照对应语言的语法来完成代码。

在读入 $n$ 这个数字以后，请你调用 ``Maker`` 命名空间中的 ``Begin`` 函数，函数的参数为 $n$。换句话说，你的代码中需要出现类似 ``Maker::Begin(n)`` 的语句。

在调用完 ``Maker::Begin`` 函数以后，生成器就可以开始工作了。一共有 $n$ 次操作，每次操作时请你调用 ``Maker::Get_Nextline`` 函数，传入三个**整形**变量，(不妨设为 $x,y,z$)，每次函数调用结束以后，$x,y,z$ 的值都会被修改，作为每次操作的参数。具体含义如下：

> 每次操作会有三个整数作为参数， 依次记为 $x,y,z$
>
> - 如果 $x = 0$，则代表这是一次插入操作；
> - 如果 $x = 1$，则代表这是一次查询。
> - 如果 $y = 0$，则代表插入操作是从左侧进行的，或者查询的位置是从左向右数的；
> - 如果 $y = 1$，则代表插入操作是从右侧进行的，或者查询的位置是从右向左数的。
> - 如果 $x = 0$，则 $z$ 是一个非零即一的整数，代表插入珍珠的颜色，$0$ 代表白色，$1$ 代表黑色；
> - 如果 $x = 1$，则 $z$ 代表查询从第一个到第 $z$ 个位置的组合和。组合和的方向和位置的方向由参数 $y$ 决定。

对于 C/C++ 选手，我们提供了模板程序([模板程序链接](https://www.luogu.org/paste/lk7wn4a1))，在这个程序中，已经做好了变量的读入和生成器的初始化，同时能够自动获取 $x,y,z$ 的值，你需要做的只是每次依照题意进行一个操作，最终输出答案。你可以自主选择是否使用这个模板，最终的评测得分与你的代码内容**无关**。

**特别提醒：不建议使用 ``fread`` 等直接从输入中大量读取信息然后保存的函数对 $n$ 进行读入，如果你非要这么做，请你自行重写 ``Maker::Begin()`` 中的读入部分。**

**从输入数据的第二行起，所有的数据都会被生成器自动读入（包括第二行），不需要你再行读入**。

输入数据的第二行是四个整数 $a,b,c,m$，其中 $a,b,c$ 是生成器的参数，$m$ 为需要额外读入的操作数。

为了在某种意义上避免因为生成的操作完全随机而产生的乱搞做法，我们将首先额外读入 $m$ 个给定的操作，然后再行随机。

以下 $m$ 行，每行三个整数 $x,~y,~z$，代表一次操作。

请特别注意，这 $m$ 次操作会被生成器**自动读入**。
## 输出格式

为了避免输出过大，请输出一行四个用空格隔开的整数，分别代表所有的查询中：

- 一共有多少次查询的结果为 $1$。
- 一共有多少次查询的操作编号为奇数且查询结果为 $0$。
- 一共有多少次查询的操作编号为偶数且查询结果为 $1$。
- 一共有多少次查询的操作编号是 $1024$ 的倍数且查询结果为 $0$。

定义第 $i$ 次操作的操作编号为 $i$。

**注意，一次插入也算做一次操作**。
## 样例

### 样例输入 #1
```
6
233 666 250 0
```
### 样例输出 #1
```
0 0 0 0
```
## 提示

#### 样例输入输出 1 解释

第一次操作，$x=0,y=1,z=0$，在匣子右端插入一个 $0$，那么匣子里的珍珠序列为 $\{0\}$

第二次操作，$x = 1,y = 0,z = 1$，查询从左向右数第一个数到第一个数的组合和，答案是 $0$。

第三次操作，$x = 0,y = 1,z = 1$，在匣子右端插入一个 $1$，匣子里的珍珠序列为 $\{0,~1\}$

第四次操作，$x = 1,y = 0,z = 1$，查询从左向右数第一个数到第一个数的组合和，答案是 $0$。

第五次操作，$x = 0,y = 0,z = 0$，在匣子左侧插入一个 $0$，那么匣子里的珍珠序列为 $\{0,~0,~1\}$

第六次操作，$x = 0,y = 1,z = 1$，在匣子右侧插入一个 $1$，那么匣子的珍珠序列为 $\{0,~0,~1,~1\}$

没有任何一次查询的结果满足【输出格式】中提到的任意一种情况，于是输出 ``0 0 0 0``。

---

#### 数据规模与约定

**本题采用多测试点捆绑测试，共有 $7$ 个子任务**。

- Subtask 1（5 points）：$n = m = 0$。
- Subtask 2（15 points）：$n = 1001$。
- Subtask 3（15 points）：$n = 10^5 + 2$。
- Subtask 4（10 points）：$n = 10^7 + 3$，对于所有 $x = 0$ 的操作，保证 $z = 1$。
- Subtask 5（10 points）：$n = 10^7 + 4$，对于所有 $x = 0$ 的操作，保证 $z = 0$。
- Subtask 6（15 points）：$n = 10^7 + 5$，$m = 0$。
- Subtask 7（30 points）：$n = 10^7 + 6$。

对于全部的测试点，保证 $0 \leq n \leq 10^7 + 6$，$0 \leq m \leq \min(n, 10^6)$，$x, y \in \{0, 1\}$，且对于所有 $x = 0$ 的操作，保证  $z \in \{0, 1\}$，若设 $k$ 为在任一查询时匣子里的珍珠个数，则保证对于 $x = 1$ 的操作，$1 \leq z \leq k$，匣子为空时不会有查询操作。

---

#### 提示与说明

- 请注意常数因子对程序效率造成的影响。
- $n$ 的末位数字可以帮助你快速的判断测试点所属的子任务。
- 由于涉及到非操作，与非运算可能不具备一些常见位运算的运算律，请格外注意。
- std 使用 C++ 语言，保证时限是 std 用时的 1.5 倍以上，**但是不保证其他语言能够通过本题**。
- 对于 C++ 选手，如果你直接复制上面的生成器，保证生成器运行总时间不超过 300ms。


---

---
title: "ygg发神威"
layout: "post"
diff: 省选/NOI-
pid: P5647
tag: ['树形数据结构', '线段树', '二分', '平衡树', 'O2优化', '枚举', '排序']
---
# ygg发神威
## 题目背景

ygg 发神威了，机房的萌新们瑟瑟发抖。
## 题目描述

ygg 的机房内共有 $n$ 台电脑且都被使用，为了节省机房内电脑的开销，第 $i$ 台电脑会同时被 $a_i$ 个萌新使用。每台电脑都装有一个「多人在线交流平台」，一台电脑会直接地或间接地通过这个平台与其他所有电脑连接。由于「多人在线交流平台」仍然处于测试阶段，如果一台电脑有多于一种不同的消息传输方式将消息传输到另外的任意一台电脑，就会有各种稀奇古怪的问题产生。两种消息的传输方式被认为是不同的，当且仅当传输消息所经过的直接连接的线路的集合不同，或者传输所经过的电脑的集合不同。当然，消息的传输肯定不会经过一条线路多次。为了避免这种状况，「多人在线交流平台」的线路被特殊地设计了，以使得任意两台电脑之间的传输线路唯一。同时，为了防止一台电脑负荷过大，一台电脑最多会通过「多人在线交流平台」的线路与 $p$ 台电脑相连。

原本两台通过「多人在线交流平台」的线路相连的电脑之间可以相互传输数据，可是 ygg 发现，这会允许使用两台电脑的萌新们互相发送消息，引起大规模~~考试作弊~~膜拜 ygg 的行为。所以他大发神威，切断了所有连接线路的一半。具体地，他将原本通过「多人在线交流平台」的双向线路连接的两台电脑之间的线路变成了单向线路。即，原本通过一条双向线路连接的两台电脑中，只能有一台电脑向另一台电脑发送消息，而另一台电脑不能将任何消息发送回来。

机房内的萌新们在每个时刻都有若干条消息需要传递。如果一台电脑 $i$ 能够直接或间接地通过「多人在线交流平台」的线路连接到电脑 $j$，那么使用电脑 $i$ 的 $a_i$ 个萌新中的任何一个都可以向使用电脑 $j$ 的 $a_j$ 个萌新发送消息。显然，使用同一台电脑的萌新之间的消息只需要在线下传达，不需要使用「多人在线交流平台」，因此不会计入线上发送的消息。

其实机房中的萌新们早已知道了「多人在线交流平台」的管理员密码，所以能够对其线路的连接方向做出修改。可无论他们怎么尝试，都不能恢复最开始时双向连接的状态了。机房中的萌新们当然希望能够尽可能地发送消息，所以他们想要知道，在机房的电脑仅被单向的线路连接时，每一时刻最多能有多少条消息被通过「多人在线交流平台」发送。

为了简化问题，我们假设机房内的所有萌新均能够在同一时刻发送线上消息，并且每一个萌新可以同时向多个人发送消息。

**简要题面：给一棵结点编号** $1\sim n$**，结点权值** $a_i$**，且结点度数最大为** $p$ **的树。求将树的每条边改为有向边后下式的最大值：**

$$\sum_{i=1}^{n}\sum_{j=1}^{n}a_ia_j\left[i\rightarrow j\right]$$

$\left[i\rightarrow j\right]$ **定义为：若编号为** $i$ **的结点能通过有向边到达编号为** $j$ **的结点，则值为** $1$**；否则值为** $0$**，且** $\left[i\rightarrow i\right]=0$**。**
## 输入格式

输入共 $(n+1)$ 行。

第一行两个正整数 $n$ 和 $p$，分别代表机房内的电脑数与所有电脑的负荷的最大值。  
第二行共 $n$ 个正整数，第 $i$ 个整数 $a_i$ 为使用第 $i$ 台电脑的萌新的数量。  
接下来 $(n-1)$ 行，第 $(i+2)$ 行两个整数 $u_i,v_i$ ，表示第 $u_i$ 和 $v_i$ 台电脑之间原本有一条「多人在线交流平台」的双向线路。
## 输出格式

输出一行一个整数，表示在某一时刻能够发送的消息数的最大值。
## 样例

### 样例输入 #1
```
4 2
1 2 3 4
1 2
3 2
4 1

```
### 样例输出 #1
```
35

```
## 提示

### 样例解释

能够发送的消息最多时的消息传递方向如下：

![](https://i.loli.net/2019/10/30/3AsqcyzdY25E8gP.png)

在该连接方式下发送消息最多的时刻，使用 $1$ 号电脑的 $1$ 个萌新向 $5$ 个萌新各发送了一条消息，共 $1\times5=5$ 条消息；  
使用 $2$ 号电脑的 $2$ 个萌新分别向 $3$ 个萌新各发送了一条消息，共 $2\times3=6$ 条消息；  
使用 $3$ 号电脑的 $3$ 个萌新不能向任何萌新发送线上消息，因此没有消息从该电脑发送；  
使用 $4$ 号电脑的 $4$ 个萌新分别向 $6$ 个萌新各发送了一条消息，共 $4\times6=24$ 条消息。  
因此，在某一时刻，最多可以有 $5+6+24=35$ 条线上消息被发送。   
可以使用枚举法验证，不存在一种单向的连接方式，使得在某一时刻发送的线上消息的数量能够达到 $36$ 条或更多。

### 数据范围及约定

对于 $10\%$ 的数据，$n\le10$；  
对于另外 $10\%$ 的数据，$n=p+1$；  
对于另外 $10\%$ 的数据，$p=2$；  
对于另外 $10\%$ 的数据，$p\le20$；  
对于另外 $10\%$ 的数据，$p\le40$；  

对于所有数据，$2\le n\le10^5$，$2\le p\le50$，$1\le a_i\le100$，$1\le u_i,v_i\le n$。保证给出的双向连接线路能够使任意两台电脑之间的消息传输线路唯一。保证至少有一台电脑原本通过「多人在线交流平台」连接的线路数恰好为 $p$，且没有电脑原本连接的线路数大于 $p$。


---

---
title: "秘籍-反复异或"
layout: "post"
diff: 省选/NOI-
pid: P5670
tag: ['枚举', '分块', '位运算']
---
# 秘籍-反复异或
## 题目描述

给定一个长为 $n$ 的序列，支持操作：

- `1 l r x`：将区间 $[l,r]$ 的所有元素加 $x$。
- `2 l r` ：查询区间 $[l,r]$ 中所有元素异或和的后 $m$ 个二进制位的值。
## 输入格式

第一行三个正整数 $n,m,q$，表示序列长度，位数，操作数。

第二行 $n$ 个非负整数，表示原始序列 $a_i$。

接下来 $q$ 行，每行若干个非负整数表示一个操作。
## 输出格式

对于每个 $2$ 操作输出一行，一个非负整数表示答案。
## 样例

### 样例输入 #1
```
10 2 10
0 1 0 0 1 0 2 2 0 1 
2 3 9
2 1 5
1 9 9 0
1 3 7 2
1 1 6 3
2 1 10
2 6 7
2 3 6
1 3 9 2
1 3 9 3

```
### 样例输出 #1
```
1
0
3
1
3

```
## 提示

【数据范围】   
本题共 $10$ 个测试点。

对于测试点 $1 \sim 3$，$1\le n,q \le 1000$；    
对于测试点 $4,5$，$1 \le m \le 5$；   
对于测试点 $6 \sim 10$，设 $k$ 为测试点编号，有 $m=k$。  

对于 $100\%$ 的数据，$1 \le n,q \le 10^5$，$1\le m \le 10$，$0\le a_i,x < 2^m$。

**请注意常数优化。**


---

---
title: "悔改"
layout: "post"
diff: 省选/NOI-
pid: P6300
tag: ['2020', 'O2优化', '枚举', '快速傅里叶变换 FFT', '快速数论变换 NTT']
---
# 悔改
## 题目描述

Daniel13265 有一些同样长的小木棍，他把这些木棍随意砍成两段，使得每段的长都不超过 $m$。

现在他想把小木棍拼接成原来的样子，但是却遗失了部分小木棍，而且忘记了自己开始时有多少根木棍和它们的长度。所以他打算把剩下的小木棍拼接出尽可能多的相同长度的木棍。

给出每段小木棍的长度，求出从剩下的木棍中最多能够拼接出的相同长度的木棍的个数与能拼接出来相同长度的木棍个数最多时木棍的最小可能长度。

## 输入格式

输入共 $2$ 行。
  
第一行包含两个正整数 $n,m$，分别表示剩余木棍个数与剩余木棍的最大可能长度。  
第二行共 $n$ 个用单个空格隔开的正整数，第 $i$ 个数 $a_i$ 表示第 $i$ 个木棍的长度。
## 输出格式

输出一行两个整数，分别表示从剩下的木棍中最多能够拼接出的相同长度的木棍的个数与能拼接出来相同长度的木棍个数最多时木棍的最小可能长度。
## 样例

### 样例输入 #1
```
7 10
1 1 2 4 7 8 9

```
### 样例输出 #1
```
2 9
```
## 提示

### 样例解释

如果要拼接出尽量多的长度为 $11$ 的木棍，可以将长度为 $2$ 和 $9$ 的木棍拼接在一起，将长度为 $4$ 和 $7$ 的木棍拼接在一起。然而如果将长度为 $1$ 和 $8$ 的木棍拼接在一起，将长度为 $2$ 和 $7$ 的木棍拼接在一起，可以拼接出 $2$ 根长度为 $9$ 的木棍。  

可以发现能拼接出来相同长度的木棍个数的最大值就是 $2$，此时木棍的长度可能为 $9,10$ 或 $11$，其中最小的为 $9$。


### 数据范围

**本题采用捆绑测试。你每通过一个子任务的所有数据点，就能得到该子任务的全部分数。**

| 子任务编号 | $n\le$ | $m\le$ | 分值 |
|:-:|:-:|:-:|:-:|
| $1$ | $10$ | $10^5$ | $5$ |
| $2$ | $10^3$ | $10^3$ | $10$ |
| $3$ | $10^3$ | $10^5$ | $10$ |
| $4$ | $10^5$ | $10$ | $5$ |
| $5$ | $10^5$ | $10^3$ | $10$ |
| $6$ | $10^5$ | $10^5$ | $60$ |

对于 $100\%$ 的数据，满足 $2\le n,m\le10^5,1\le a_i\le m$。


---

---
title: "「EZEC-4」月下轻花舞"
layout: "post"
diff: 省选/NOI-
pid: P6826
tag: ['数学', '枚举', '前缀和']
---
# 「EZEC-4」月下轻花舞
## 题目背景

>月下的轻花，随轻风飘舞，勾起了你我的记忆......

![](http://p1.music.126.net/mi-oogxsSXkHwPACQRsxgw==/109951163115816964.jpg?param=557y315)
## 题目描述

在轻花林中，有从 $l$ 到 $r$ 编号的轻花树，编号为 $i$ 的树有 $i-1$ 棵，轻花林很美，所以每棵树上都有编号为 $1\sim n$ 的 $n$ 朵轻花，编号为 $i$ 的树上编号为 $j$ 的轻花落下会产生大小为 $\left\lceil\log_ij\right\rceil$ 的魅力值。  

夜幕降临，所有树上的所有轻花全部落下，花痴（雾）tlx 想知道总共有多大的魅力值，但是只算一次太简单了，所以他会设置不同情境询问你 $T$ 次，不过由于答案很大，你只需要告诉他魅力值总和对 $998244353$ 取模的结果。    

**一句话题意**： $T$ 组询问，每次给定三个整数 $l,r,n$，求出下式的值： 

$$\sum_{i=l}^r(i-1)\sum_{j=1}^n \left\lceil\log_ij\right\rceil\;\;\bmod998244353$$
## 输入格式

第一行一个整数 $T$，代表询问个数。  

接下来 $T$ 行，每行三个整数 $l,r,n$，分别代表树编号的起始值，终止值，以及一棵树上轻花的朵数。
## 输出格式

共 $T$ 行，每行一个整数，代表每一个询问的结果对 $998244353$ 取模的结果。
## 样例

### 样例输入 #1
```
1
2 3 5
```
### 样例输出 #1
```
20
```
### 样例输入 #2
```
2
23333 23333 233233
114514 19260817 1919810   
```
### 样例输出 #2
```
356712294
125194507
```
## 提示

**【数据范围与约束】**   

**本题采用捆绑测试，具体约束如下：**  

- Subtask 1 $(1\text{ pts})$：$T=1$，$n=1$；   
- Subtask 2 $(9\text{ pts})$：$l=r=2$；   
- Subtask 3 $(10\text{ pts})$：$T=1$，$n\leq 10^3$，$r\leq 10^3$；   
- Subtask 4 $(10\text{ pts})$：$l=r\not=2$；      
- Subtask 5 $(20\text{ pts})$：$T=1$，$n\leq 10^6$；
- Subtask 6 $(20\text{ pts})$：$T=1$，$r\leq 10^6$；
- Subtask 7 $(20\text{ pts})$：$T\leq 3000$；
- Subtask 8 $(10\text{ pts})$：无特殊限制，时间限制 $1.5\;\text{s}$。

对于所有数据，满足：  

$1\leq T\leq 10^5$，$1\leq n\leq 10^{18}$，$2\leq l\leq r\leq 10^{18}$。  

**注意：在具体约束中没有提到的数据范围均为极限数据范围。**



------------


**【样例解释 #1】**   

$$\left\lceil\log_21\right\rceil+\left\lceil\log_22\right\rceil+\left\lceil\log_23\right\rceil+\left\lceil\log_24\right\rceil+\left\lceil\log_25\right\rceil=8$$

$$\left\lceil\log_31\right\rceil+\left\lceil\log_32\right\rceil+\left\lceil\log_33\right\rceil+\left\lceil\log_34\right\rceil+\left\lceil\log_35\right\rceil=6$$   

故：

$$ans=8×(2-1)+6×(3-1)=20$$   

对于样例 #2，我相信您聪明的大脑可以分分钟得到答案的。



------------

**【其他提示】**  

如果你不了解对数（$\log$）运算,可以查看[这里](https://baike.baidu.com/item/对数公式/5557846?fr=aladdin)。


---

---
title: "「EZEC-11」Tyres"
layout: "post"
diff: 省选/NOI-
pid: P8179
tag: ['动态规划 DP', '贪心', 'O2优化', '枚举', '洛谷月赛']
---
# 「EZEC-11」Tyres
## 题目背景

这道题曾经有有趣的题目背景。
## 题目描述

有 $n$ 套轮胎，滴叉需要用这些轮胎跑 $m$ 圈。

使用第 $i$ 套轮胎跑的第 $j$ 圈（对每套轮胎单独计数）需要 $a_i+b_i(j-1)^2$ 秒。在本题中，你不需要担心爆胎，安全车，红旗或者不同的比赛策略。

滴叉需要进入维修站来更换轮胎，所消耗的时间为 $t$ 秒。特别地，滴叉使用的**第一套**轮胎不需要进站更换。

为了帮助滴叉拿下 WDC，你需要最小化总时间，总时间等于每圈的时间之和加上进站所花费的时间。
## 输入格式

第一行输入三个整数 $n,m,t$。

接下来 $n$ 行，每行输入两个整数 $a_i,b_i$。
## 输出格式

输出一个整数，代表总时间的最小值。
## 样例

### 样例输入 #1
```
2 4 50
10 100
100 1
```
### 样例输出 #1
```
365
```
### 样例输入 #2
```
6 6 10
90 200
90 200
90 200
92 200
92 200
94 200
```
### 样例输出 #2
```
598
```
### 样例输入 #3
```
3 10 30
1000 8
1050 3
1100 1
```
### 样例输出 #3
```
10607
```
## 提示

**【样例解释】**

对于第一个样例：

* 你先让滴叉用第一套轮胎跑一圈，消耗 $10$ 秒。
* 然后进站更换第二套轮胎，消耗 $50$ 秒。
* 然后用第二套轮胎跑三圈。第一圈消耗 $100$ 秒，第二圈消耗 $100+1\times 1^2=101$ 秒，第三圈消耗 $100+1\times 2^2=104$ 秒。
* 总时间为 $10+50+100+101+104=365$ 秒。

对于第二个样例，滴叉每圈更换一次新轮胎。

注意一套轮胎被卸下后并不会重置它跑的圈数。

对于第三个样例，滴叉先使用第一套轮胎跑 $4$ 圈，然后更换第二套轮胎跑 $6$ 圈。

**【数据范围】**

**本题采用捆绑测试**。

- Subtask 1（7 pts）：$n=1$。
- Subtask 2（9 pts）：$n\leq10$，$m\leq 100$。
- Subtask 3（13 pts）：$t=0$。
- Subtask 4（21 pts）：保证 $a_i,b_i$ 随机生成。
- Subtask 5（50 pts）：无特殊限制。

对于前 $100\%$ 的数据，$1\leq n,b_i\leq 500$，$0\leq t\leq 500$，$1\leq m\leq 2 \times 10^5$，$1\leq a_i\leq 10^9$。


---

---
title: "[蓝桥杯 2015 国 AC] 切开字符串"
layout: "post"
diff: 省选/NOI-
pid: P8631
tag: ['2015', '枚举', '前缀和', 'Manacher 算法', '蓝桥杯国赛']
---
# [蓝桥杯 2015 国 AC] 切开字符串
## 题目描述

Pear 有一个字符串，不过他希望把它切成两段。

这是一个长度为 $N$（$ \le 10^5$）的字符串。

Pear 希望选择一个位置，把字符串不重复不遗漏地切成两段，长度分别是 $t$ 和 $N-t$（这两段都必须非空）。

Pear 用如下方式评估切割的方案：

定义“正回文子串”为：长度为奇数的回文子串。

设切成的两段字符串中，前一段中有 $A$ 个不相同的正回文子串，后一段中有 $B$ 个不相同的非正回文子串，则该方案的得分为 $A \times B$。

注意，后一段中的 $B$ 表示的是：“ ... 非正回文 ... ”，而不是：“ ... 正回文 ... ”。

那么所有的切割方案中，$A \times B$ 的最大值是多少呢？
## 输入格式

输入第一行一个正整数 $N$（$ \le 10^5$）

接下来一行一个字符串，长度为 $N$。该字符串仅包含小写英文字母。
## 输出格式

一行一个正整数，表示所求的 $A \times B$ 的最大值。
## 样例

### 样例输入 #1
```
10
bbaaabcaba
```
### 样例输出 #1
```
38
```
## 提示

对于 $20\%$ 的数据，$N \le 100$。

对于 $40\%$ 的数据，$N \le 1000$。

对于 $100\%$ 的数据，$N \le 10^5$。

时限 1 秒, 512M。蓝桥杯 2015 年第六届国赛


---

---
title: "[蓝桥杯 2015 国 B] 模型染色"
layout: "post"
diff: 省选/NOI-
pid: P8633
tag: ['2015', '枚举', 'Pólya 定理', '蓝桥杯国赛']
---
# [蓝桥杯 2015 国 B] 模型染色
## 题目描述

在电影《超能陆战队》中，小宏可以使用他的微型机器人组合成各种各样的形状。

现在他用他的微型机器人拼成了一个大玩具给小朋友们玩。为了更加美观，他决定给玩具染色。

小宏的玩具由 $n$ 个球型的端点和 $m$ 段连接这些端点之间的边组成。下图给出了一个由 $5$ 个球型端点和 $4$ 条边组成的玩具，看上去很像一个分子的球棍模型。

![](https://cdn.luogu.com.cn/upload/image_hosting/sefn3dug.png)

由于小宏的微型机器人很灵活，这些球型端点可以在空间中任意移动，同时连接相邻两个球型端点的边可以任意的伸缩，这样一个玩具可以变换出不同的形状。在变换的过程中，边不会增加，也不会减少。

小宏想给他的玩具染上不超过 $k$ 种颜色，这样玩具看上去会不一样。如果通过变换可以使得玩具变成完全相同的颜色模式，则认为是本质相同的染色。现在小宏想知道，可能有多少种本质不同的染色。
## 输入格式

输入的第一行包含三个整数 $n,m,k$，

分别表示小宏的玩具上的端点数、边数和小宏可能使用的颜色数。端点从 $1$ 到 $n$ 编号。

接下来 $m$ 行每行两个整数 $a,b$，表示第 $a$ 个端点和第 $b$ 个端点之间有一条边。输入保证不会出现两条相同的边。
## 输出格式

输出一行，表示本质不同的染色的方案数。由于方案数可能很多，请输入方案数除 $10007$ 的余数。
## 样例

### 样例输入 #1
```
3 2 2
1 2
3 2
```
### 样例输出 #1
```
6
```
## 提示

**【样例说明】**

令 $(a,b,c)$ 表示第一个端点染成 $a$，第二个端点染成 $b$，第三个端点染成 $c$，则下面 $6$ 种本质不同的染色：$(1,1,1),(1,1,2),(1,2,1),(1,2,2),(2,1,2),(2,2,2)$。

而 $(2,1,1)$ 与 $(1,1,2)$ 是本质相同的，$(2,2,1)$ 与 $(2,1,2)$ 是本质相同的。

**【数据规模与约定】**

对于 $20\%$ 的评测数据，$1 \le n \le 5$，$1 \le k \le 2$。

对于 $50\%$ 的评测数据，$1 \le n \le 10,1 \le k \le 8$。

对于 $100\%$ 的评测数据，$1 \le n \le 10,1 \le m \le 45,1 \le k \le 30$。


---

---
title: "[蓝桥杯 2021 省 A] 分果果"
layout: "post"
diff: 省选/NOI-
pid: P8746
tag: ['动态规划 DP', '2021', '枚举', '蓝桥杯省赛']
---
# [蓝桥杯 2021 省 A] 分果果
## 题目描述

小蓝要在自己的生日宴会上将 $n$ 包糖果分给 $m$ 个小朋友。每包糖果都要分出去，每个小朋友至少要分一包，也可以分多包。

小蓝已经提前将糖果准备好了，为了在宴会当天能把糖果分得更平均一些，小蓝要先计算好分配方案。

小蓝将糖果从 $1$ 到 $n$ 编号, 第 $i$ 包糖果重 $w_{i}$ 。小朋友从 $1$ 到 $m$ 编号。每个小朋友只能分到编号连续的糖果。小蓝想了很久没想出合适的分配方案使得每个小朋友分到的糖果差不多重。因此需要你帮他一起想办法。为了更好的分配糖果，他可以再买一些糖果，让某一些编号的糖果有两份。当某个编号的糖果有两份时，一个小朋友最多只能分其中的一份。

请找一个方案，使得小朋友分到的糖果的最大重量和最小重量的差最小，请输出这个差。

例如，小蓝现在有 5 包糖果, 重量分别为 $6,1,2,7,9$，如果小蓝要分给两个小朋友，则他可以将所有糖果再买一份，两个小朋友都分到 $1$ 至 $5$ 包糖果，重量都是 $25$, 差为 $0$。

再如，小蓝现在有 $5$ 包糖果, 重量分别为 $6,1,2,7,9$，如果小蓝要分给三个小朋友，则他可以将第 $3$ 包糖果再买一份，第一个小朋友分 $1$ 至 $3$ 包，第二个小朋友分 $3$ 至 $4$ 包，第三个小朋友分第 $5$ 包，每个小朋友分到的重量都是 $9$，差为 $0$。

再如, 小蓝现在有 5 包糖果, 重量分别为 $6,1,2,7,9$, 如果小蓝要分给四个小朋友，则他可以将第 $3$ 包和第 $5$ 包糖果再买一份, 仍然可以每个小朋友分到的重量都是 $9$，差为 $0$。

再如, 小蓝现在有 $5$ 包糖果, 重量分别为 $6,1,2,7,9$, 如果小蓝要分给五个小朋友, 则他可以将第 $4$ 包和第 $5$ 包糖果再买一份, 第一个小朋友分第 $1$ 至 $2$ 包重量为 $7$ , 第二个小朋友分第 $3$ 至 $4$ 包重量为 $9$, 第三个小朋友分第 $4$ 包重 量为 $7$, 第四个和第五个小朋友都分第 $5$ 包重量为 $9$。差为 $2$。
## 输入格式

输入第一行包含两个整数 $n$ 和 $m$, 分别表示糖果包数和小朋友数量。

第二行包含 $n$ 个整数 $w_{1}, w_{2}, \cdots, w_{n}$, 表示每包糖果的重量。
## 输出格式

输出一个整数, 表示在最优情况下小朋友分到的糖果的最大重量和最小重量的差。
## 样例

### 样例输入 #1
```
5 2
6 1 2 7 9
```
### 样例输出 #1
```
0
```
### 样例输入 #2
```
5 5
6 1 2 7 9
```
### 样例输出 #2
```
2
```
## 提示

对于 $30 \%$ 的评测用例, $1 \leq n \leq 10,1 \leq m \leq 10,1 \leq w_{i} \leq 10$;

对于 $60 \%$ 的评测用例, $1 \leq n \leq 30,1 \leq m \leq 20,1 \leq w_{i} \leq 30$;

对于所有评测用例, $1 \leq n \leq 100,1 \leq m \leq 50,1 \leq w_{i} \leq 100$ 。在评测数据 中, $w_{i}$ 随机生成, 在某个区间均匀分布。

蓝桥杯 2021 第一轮省赛 A 组 J 题。


---

---
title: "「KDOI-04」挑战 NPC Ⅲ"
layout: "post"
diff: 省选/NOI-
pid: P9036
tag: ['搜索', '图论', '贪心', '2023', '洛谷原创', 'O2优化', '枚举', '深度优先搜索 DFS', '剪枝', '组合数学', '洛谷月赛', '状压 DP']
---
# 「KDOI-04」挑战 NPC Ⅲ
## 题目背景

![](https://cdn.luogu.com.cn/upload/image_hosting/zn5t5x28.png)
## 题目描述

小 S 有一个伟大的梦想：证明 $\text{P}=\text{NP}$。

有一天，他得知一般图最大独立集是 NPC 问题后，决定解决他。

当然小 S 太菜了，解决不了，于是求助于你：

> 给出一个含有 $n$ 个顶点，$m$ 条边的无向图 $G$，求 $G$ 中大小恰好为 $n-k$ 的独立集的数量。由于答案可能很大，请将其对 $998~244~353$ 取模。

小 S 不喜欢多测，因为他在 NOIp 中因为多测挂分，所以本题包含多组测试数据。
## 输入格式

**本题包含多组测试数据。**

第一行一个正整数 $T$，表示测试数据组数。

对于每组测试数据，第一行三个正整数 $n,m,k$。

接下来 $m$ 行，每行两个正整数 $u,v$ 表示一条边。

保证图中不存在自环，但**可能存在重边**。
## 输出格式

对于每组测试数据，输出一行一个正整数，表示符合要求的独立集数量。答案对 $998~244~353$ 取模。
## 样例

### 样例输入 #1
```
3
4 6 1
1 2
1 3
1 4
2 3
2 4
3 4
4 6 3
1 2
1 3
1 4
2 3
2 4
3 4
8 13 5
1 2
7 8
1 3 
2 5
3 8
6 8
4 7
5 6
5 7
5 8
6 7
1 8
3 5
```
### 样例输出 #1
```
0
4
8
```
## 提示

**【样例解释】**

对于第 $1,2$ 组测试数据，图是完全图，容易发现，完全图的最大独立集为 $1$，并且每一个顶点都单独构成一个独立集。因此第 $1$ 组测试数据的答案为 $0$，第 $2$ 组测试数据的答案为 $4$。

对于第 $3$ 组测试数据，该组数据中给出的无向图如下：

![](https://cdn.luogu.com.cn/upload/image_hosting/abt8ho3b.png)

其中，所有大小为 $3$ 的独立集为：

+ $\{2,4,8\}$；
+ $\{2,3,7\}$；
+ $\{3,4,6\}$；
+ $\{2,4,6\}$；
+ $\{1,4,6\}$；
+ $\{2,3,6\}$；
+ $\{1,4,5\}$；
+ $\{2,3,4\}$。

**【数据范围】**

**本题采用捆绑测试。**

![数据范围](https://cdn.luogu.com.cn/upload/image_hosting/p3jwdqp3.png)

对于 $100\%$ 的数据，保证 $1\leq n\leq10^5$，$0\le m\le 10^5$，$0\leq k\leq \min(n-1,18)$，$1\leq T\leq 10^{4}$，$\sum n,\sum m\leq10^6$。

并且对于每个测试点保证：

设 $K=\max k$，即该测试点中所有 $k$ 的最大值，

+ 若 $K\ge 17$，则 $T=1$；
+ 若 $K\ge 15$，则 $T\le 3$；
+ 若 $K\ge 10$，则 $T\le 5$；
+ 若 $K\ge 5$，则 $T\le 300$。



---

---
title: "「GMOI R2-T3」粒子环游"
layout: "post"
diff: 省选/NOI-
pid: P9200
tag: ['数学', '线段树', '二分', '树状数组', '洛谷原创', 'O2优化', '枚举', '洛谷月赛']
---
# 「GMOI R2-T3」粒子环游
## 题目背景

热爱珂学的小 Z 正在进行一项无聊的实验。
## 题目描述

实验室中有一个由 $n$ 个实验腔连接而成的环形轨道，其中第 $i$ 个实验腔顺时针连向第 $i+1$ 个实验腔（特别的，第 $n$ 个实验腔连向第 $1$ 个实验腔）。同时还有一个标号为 $n+1$ 的新建实验腔要接入这个环形轨道。它可以接在任意两个原本相连的实验腔之间。

第 $i$ 个实验腔可以将带电荷量为 $Q$ 的粒子运输到它的下一个实验腔，这个过程花费的能量为 $\vert Q \vert \times c_i$。除此之外，第 $i$ 个实验腔本身就存储了量为 $e_i$ 的电荷（电荷量有正负）。由于众所周知的电荷守恒定律，第 $n+1$ 个实验腔储存的电荷量与前 $n$ 个实验腔储存的总电荷量的代数和为 $0$。

小 Z 有一个原本不带电的粒子。等到第 $n+1$ 个实验腔接入轨道后，他要任选一个实验腔（包括第 $n+1$ 个）作为出发点，将粒子放入，并使之在实验腔的能量驱动下顺时针环游一周回到出发点。粒子每到达一个实验腔（包括出发点），它所带电荷量就会变成原来所带的电荷量和这个实验腔所储存的电荷量的代数和。

**注意：电荷量会先加上实验腔所含电荷量，再计算能量贡献。**

现在，小 Z 想知道，在所有接入新建实验腔并选定出发点的方案中，粒子环游一周所需的能量最少为多少？
## 输入格式

第一行为一个正整数 $n$ ，表示环形轨道原有实验腔数。

第二行有 $n+1$ 个非负整数，依次表示 $c_1,c_2,...,c_{n+1}$。

第三行有 $n$ 个整数，依次表示 $e_1,e_2,...,e_{n}$。
## 输出格式

输出共一行，包括一个数，表示粒子环游一周所需的最少能量。
## 样例

### 样例输入 #1
```
3
1 3 2 2
3 -5 1
```
### 样例输出 #1
```
9
```
### 样例输入 #2
```
12
4 7 7 8 8 4 5 5 9 10 1 1 10 
0 -5 7 8 1 -1 -6 8 2 4 10 8 
```
### 样例输出 #2
```
509
```
## 提示

样例 $1$ 解释：一种最优方案为将 $4$ 号实验腔接在 $3$ 号实验腔与 $1$ 号实验腔之间，以 $4$ 号实验腔为出发点，花费能量为 $ 1\times 2\ +\ 4\times 1\ + \vert -1 \vert \times 3 \ +\ 0 \times 2 =9$。

**本题采用 Subtask 捆绑测试。**

| Subtask | $n\le$ | $c_i\le$ | $\vert e_i\vert$ | 特殊性质 | 对应测试点 | 总分 |
| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |
| $0$ | $300$ | $100$ | $100$ | $-$ | $1\sim 5$ | $10$ |
| $1$ | $10^3$ | $10^3$ | $10^3$ | $\bf A$ | $6\sim 7$ | $5$ |
| $2$ | $10^4$ | $10^4$ | $10^4$ | $-$ | $8\sim12$ | $15$ |
| $3$ | $10^5$ | $10^5$ | $10^5$ | $\bf B$ | $13\sim 16$ | $10$ |
| $4$ | $2.5\times 10^5$ | $10^5$ |$10^5$ | $-$ | $17\sim 25$ | $60$ |

特殊性质 $\bf A$：对于所有的 $i\in[1,n+1](i\in \Z)$，满足 $c_i=0$。

特殊性质 $\bf B$：对于所有的 $i\in[1,n+1](i\in \Z)$，满足 $c_i=1$。

对于 $100\%$ 的数据，$1\le n\le 2.5\times 10^5$，$0\le c_i\le 10^5$，$0\le |e_i|\le 10^5$。

保证答案在 long long 范围内。


---


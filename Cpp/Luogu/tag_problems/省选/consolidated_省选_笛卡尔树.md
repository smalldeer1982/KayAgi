---
title: "运输规划"
layout: "post"
diff: 省选/NOI-
pid: P10919
tag: ['O2优化', '二分图', '树链剖分', '笛卡尔树']
---
# 运输规划
## 题目背景

你需要规划卡车的运输方案，为了让您更好地解决问题，**请仔细阅读题面。**
## 题目描述

有 $n$ 个城市，对于任意 $1 < i \leq n$ 满足第 $i$ 个城市与第 $i-1$ 个城市间有一条双向的道路，每个城市有一个对卡车高度的限制 $h_i$，代表只有高度小于等于 $h_i$ 的卡车可以从这个城市经过，现在有 $m$ 个城市 $S_{1},S_{2},...,S_{m}$ 各有**恰好**一个运输任务，任务要求**编号为 $i$ 且高度为 $h_{S_{i}}$ 的**卡车从城市 $S_{i}$ 出发**到达**任意一个有机场的城市，而有 $m$ 个城市有机场，分别为 $T_{1},T_{2},...,T_{m}$，对于一个合法的运输方案而言，需要保证每个卡车都到达一个机场且每个机场**恰好**有一辆卡车**抵达**。一个机场**可以**同时被多辆卡车**经过**。请注意，如果你无法经过某个城市，那么你也无法抵达这个城市。

记 $c_i$ 表示抵达位于城市 $T_i$ 的机场的的**卡车编号**，令数组 $F = \{c_1,c_2,...,c_m\}$，请你最小化 $F$ 的字典序并输出 $F$。

我们定义两个长度为 $len$ 的数组 $A,B$ 满足 $A$ 的字典序小于 $B$ 当且仅当存在 $0 \leq i < len$ 满足对于任意 $1 \leq j \leq i$ 满足 $A_j = B_j$ 且 $A_{i+1} < B_{i+1}$。

数据保证有解，保证**所有 $h_i$ 互不相同**，所有 $T_i$ 互不相同，所有 $S_i$ 互不相同。但是**可能会**存在 $i,j$ 满足 $S_i = T_j$。

## 输入格式

第一行两个数 $n,m$。

接下来一行 $n$ 个数表示 $h_1,h_2,...,h_n$。

再接下来一行 $m$ 个数表示 $S_{1},S_{2},...,S_{m}$。

再接下来一行 $m$ 个数表示 $T_{1},T_{2},...,T_{m}$。


## 输出格式

输出一行 $m$ 个数表示 $F$。
## 样例

### 样例输入 #1
```
10 3 
1 2 3 5 4 10 8 6 7 9
1 2 8
6 10 3

```
### 样例输出 #1
```
1 3 2
```
### 样例输入 #2
```
20 5
12 13 14 15 16 17 18 19 20 22 21 30 29 28 27 26 23 24 25 1
1 20 2 5 3 
10 12 11 9 13 

```
### 样例输出 #2
```
1 2 3 4 5
```
## 提示

**本题采用捆绑测试**。

| 子任务编号 | 特殊性质 | 分值 |
| :-----------: | :-----------: | :-----------: |
| $1$ | $n,m \leq 50$ | $10$ |
| $2$ | 对于任意 $1 < i \leq n$ 满足 $h_i < h_{i-1}$ | $25$ |
| $3$ | $n,m \leq 10^3$ | $25$ |
| $4$ | 无特殊性质 | $40$ |

对于 $100\%$ 的数据保证 $1 \leq m \leq n \leq 2 \times 10^5,0 < h_i \leq 10^9$。



---

---
title: "兰奇的卡牌游戏"
layout: "post"
diff: 省选/NOI-
pid: P11411
tag: ['贪心', '树的直径', '笛卡尔树']
---
# 兰奇的卡牌游戏
## 题目描述

作为制卡大师的兰奇，发明了一种自助型卡牌游戏。

给定 $n$ 张卡牌，第 $i$ 张卡牌编号为 $i$，其权值为 $a_i$，卡牌的权值互不相同。

这个卡牌游戏的规则需要自己生成。一开始，所有的牌都在备选区。从备选区中选取一张编号最小的卡牌放到手牌区，便可进入规则生成阶段。

规则生成阶段的步骤如下：

1. 将手牌区的任意一张牌弃置到废牌区之中。

1.  然后在备选区中选择一张编号和权值均大于当前弃牌的牌，加入手牌区。若存在这样的一张牌，则称这张牌与弃牌互为置换；若不存在这样的一张牌，则跳过当前步骤。

1. 继续从备选区中选择一张编号大于当前弃牌且权值小于当前弃牌的牌，加入手牌区。若存在这样的一张牌，则同样可称这张牌与弃牌互为置换；若不存在这样的一张牌，则跳过当前步骤。

1. 完成以上步骤后，若手牌区没有卡牌了，则规则生成阶段结束。若仍有卡牌，则继续重复上述步骤，直到手牌区没有卡牌。

为了保证生成置换的唯一性，兰奇规定规则生成阶段合法当且仅当规则生成结束后，所有的牌都在废牌区。并且在正式游戏阶段一张编号较大的牌经过一系列操作后得到一张编号较小的牌后，该编号较大的牌，均要满足能够有机会按照在手牌区出现过的该张编号较小的牌的弃牌后生成的置换相同的步骤在规则生成阶段成为编号较小的牌的置换；若手牌区未出现该张编号较小的牌的弃牌后生成的置换，则无需考虑。否则，生成的置换是无效的。

可以证明在规则生成阶段合法的情况下，每张卡牌可以与哪些卡牌互为置换的方案是唯一的。

正式游戏阶段的步骤如下：

1. 选择任意一张卡牌作为起始卡牌并加入手牌区，然后进入下一步骤。

1. 将前手牌区的卡牌弃入废牌堆，然后从备选区中选择一张该卡牌的置换加入手牌区。若当前弃置的卡牌在备选区没有置换，则正式游戏阶段结束；反之，则得分增加 $1$ 分，然后继续重复步骤 2。

游戏发售后，销量并不是很好。因为游戏规则太复杂了。玩家们希望删去一些卡牌，使得正式游戏阶段的最大得分不超过 $k$。

而兰奇为了保证游戏的不做太大的改动，他要求删去一些卡牌后，保留下来的任意一张卡牌重新生成的置换要与原来未删去卡牌情况下的置换相同。

删去后置换仍相同的定义是：设 $S$ 表示某一张卡牌，未删除任何一张卡牌时的置换集合；$T$ 表示该张卡牌，在删除了部分卡牌时的置换集合。此时，满足 $T \subseteq S$。则称删去部分卡牌后，该卡牌的置换与原来未删去卡牌情况下的置换相同。

兰奇想知道，在满足了玩家和自己的要求的前提下，他最少要删除几张卡片。

## 输入格式

第一行输入两个正整数 $n$ 和 $k$，分别表示卡牌的数量和正式游戏阶段的最大得分不能超过的值。

第二行输入 $n$ 个元素，第 $i$ 个元素 $a_i$，表示编号为 $i$ 的卡牌权值。
## 输出格式

输出一个正整数，表示在满足玩家和自己的要求的前提下，最少要删除几张卡片。
## 样例

### 样例输入 #1
```
3 2
1 2 3
```
### 样例输出 #1
```
0
```
### 样例输入 #2
```
6 2
3 2 7 99 10 15
```
### 样例输出 #2
```
3
```
## 提示

**【样例1解释】**

编号为 $1$ 的卡牌与编号为 $2$ 的卡牌互为置换，编号为 $2$ 的卡牌与编号为 $3$ 的卡牌互为置换。

所以，在不删去的情况下，获得最大得分的方案是：用编号为 $1$ 的卡牌作为起始卡牌置换出编号为 $2$ 的卡牌，然后再置换出编号为 $3$ 的卡牌。该方案的最大得分为 $2$，所以不需要删除任何一张卡牌。

**【数据范围】**

**本题采用捆绑测试**。

- Subtask 1（15 points）：$n \le 10$。
- Subtask 2（5 points）：$k = n$。
- Subtask 3（80 points）：无特殊限制。

对于所有测试数据，$1 \le n \le 2000$，$1 \le a_i \le 10^9$。


---

---
title: "无聊"
layout: "post"
diff: 省选/NOI-
pid: P11661
tag: ['莫队', 'O2优化', '分治', 'ST 表', '笛卡尔树', '根号分治']
---
# 无聊
## 题目背景

![](https://cdn.luogu.com.cn/upload/image_hosting/f9kqwg7m.png)
## 题目描述

白很无聊呢，于是她给空出了道题。

给出 $n$ 个数的序列 $a,b$。

求 $b_l\equiv b_r\pmod {\displaystyle\max_{l\le i\le r}a_i}$ 的 $(l,r)$ 个数。
## 输入格式

第一行一个整数 $n$。

第二行 $n$ 个整数表示 $a$ 序列。

第三行 $n$ 个整数表示 $b$ 序列。
## 输出格式

一个整数。
## 样例

### 样例输入 #1
```
10
5 5 7 8 6 7 2 1 7 2 
4 11 7 19 13 8 10 11 10 7 
```
### 样例输出 #1
```
15
```
## 提示

对于所有测试数据，保证：$1\le n,a_i,b_i\le 5\times10^5$。

| Subtask | $n\le$ | 限制 | 分值 |
| :----------: | :----------: | :----------: | :----------: |
| $0$ | $10^4$ | - | $5$ |
| $1$ | $10^5$ | $a_i\ge a_{i+1}$ | $15$ |
| $2$ | $10^5$ | - | $30$ |
| $3$ | $5\times10^5$ | - | $50$ |


---

---
title: "[CERC2019] Be Geeks!"
layout: "post"
diff: 省选/NOI-
pid: P9607
tag: ['2019', '线段树', '倍增', 'ST 表', 'ICPC', '笛卡尔树', '单调栈']
---
# [CERC2019] Be Geeks!
## 题目背景

**题目译自 [CERC 2019](https://contest.felk.cvut.cz/19cerc/solved.html) 「[Be Geeks!](https://contest.felk.cvut.cz/19cerc/solved/begeeks.pdf)」**
## 题目描述

音乐乐队 Be Geeks! 的名字并非偶然，因为所有成员都是真正的数学怪才。除此之外，他们喜欢研究数列的各种性质。下面是他们感兴趣的一个例子：
- 设 $A$ 是一个非空正整数序列，$A=(a_1, a_2, \dots, a_N)$。
- $G(i, j)=\gcd (a_i, a_{i+1}, \dots, a_j)$，其中 $1\le i\le j\le N$。
- $M(i, j)=\max (a_i, a_{i+1}, \dots, a_j)$，其中 $1\le i\le j\le N$。
- $P(i, j)=G(i, j)\times M(i, j)$，其中 $1\le i\le j\le N$。
- $F(A)=\sum P(i, j)[1\le i\le j\le N]$。

给出一个序列 $A$，你需要求出 $F(A)\bmod 1\,000\,000\,007$ 的值。
## 输入格式

第一行包含一个整数 $N\ (1\le N\le 2\times 10^5)$，代表序列 $A$ 的长度。

第二行包含 $N$ 个整数 $a_1, a_2, \dots, a_N\ (1\le a_i\le 10^9)$，代表序列 $A$。
## 输出格式

输出一个整数，代表 $F(A)\bmod 1\,000\,000\,007$ 的值。
## 样例

### 样例输入 #1
```
4
1 2 3 4

```
### 样例输出 #1
```
50

```
### 样例输入 #2
```
5
2 4 6 12 3

```
### 样例输出 #2
```
457

```


---


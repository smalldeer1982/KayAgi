---
title: "[蓝桥杯 2023 国 A] 子串"
layout: "post"
diff: 省选/NOI-
pid: P10420
tag: ['2023', '后缀自动机 SAM', '蓝桥杯国赛']
---
# [蓝桥杯 2023 国 A] 子串
## 题目描述

给定一个仅含小写英文字母组成的字符串 $S$，问有多少个不同的字符串在 $S$ 中出现 $1\sim |S|$ 次。当两个字符串的长度或任意位置的字符不同时，我们认为这两个字符串是不同的。
## 输入格式

输入一行包含一个字符串 $S$，由小写英文字母组成。
## 输出格式

输出 $|S|$ 行，每行包含一个整数，其中第 $i$ 行的整数表示在 $|S|$ 中正好出现 $i$ 次的字符串的数量。
## 样例

### 样例输入 #1
```
abb

```
### 样例输出 #1
```
4
1
0
```
## 提示

**【样例解释 1】**

`a`，`ab`，`bb`，`abb` 出现了一次，`b` 出现了两次。

**【评测用例规模与约定】**

对于 $20\%$ 的评测用例，$|S|\le 300$；  
对于 $40\%$ 的评测用例，$|S|\le 5000$；  
对于所有评测用例，$1\le |S|\le 10^6$。


---

---
title: "[蓝桥杯 2024 国 A] 异或路径"
layout: "post"
diff: 省选/NOI-
pid: P10583
tag: ['2024', '蓝桥杯国赛']
---
# [蓝桥杯 2024 国 A] 异或路径
## 题目描述

给定一棵有 $n$ 个结点的树，结点 $1$ 至 $n$ 编号。编号为 $x > 1$ 的结点与编号为 $\lfloor \sqrt x \rfloor$
 的结点有一条权值为 $x-\lfloor \sqrt x \rfloor ^ 2$ 的边。
 
定义一条路径的价值为这条路径上的所有边的权值的异或和。如果两条路径包含不同的边，则认为这两条路径不同。求这棵树的所有本质不同的简单路的价值的乘积（价值为 $0$ 的除外），答案对 $998\ 244\ 353$ 取模。
## 输入格式

输入一行包含一个整数 $n$。
## 输出格式

输出一行包含一个整数表示答案。
## 样例

### 样例输入 #1
```
5
```
### 样例输出 #1
```
36
```
## 提示

对于 $40\%$ 的评测用例，$n\le 10^3$；  
对于 $70\%$ 的评测用例，$n\le 10^6$；  
对于所有评测用例，$1\le n\le 10^9$。


---

---
title: "[蓝桥杯 2023 国 Python A] 等腰三角形"
layout: "post"
diff: 省选/NOI-
pid: P10989
tag: ['2023', '三分', '蓝桥杯国赛']
---
# [蓝桥杯 2023 国 Python A] 等腰三角形
## 题目背景

Python 用户建议使用 PyPy3 提交本题。
## 题目描述

给定一个包含 $n$ 个数的序列 $A_i$，每次操作可以选择其中任意一个数将其
$+1$ 或 $−1$。

我们要让这个序列满足能够从中任选三个数，这三个数对应长度的三条边总能组成一个等腰三角形。问最少需要多少次操作才能让序列满足条件。

## 输入格式

输入的第一行包含一个整数 $n$。

第二行包含 $n$ 个整数，分别表示 $A_1, A_2, \cdots, A_n$，相邻两个整数之间使用一个空格分隔。
## 输出格式

输出一行包含一个整数，表示最少的操作次数。

## 样例

### 样例输入 #1
```
5
3 3 5 7 7

```
### 样例输出 #1
```
3

```
## 提示

对于 $40\%$ 的评测用例，$n \le 5000,A_i \le5000$；

对于 $70\%$ 的评测用例，$n \le 2 \times 10^5,A_i \le 10^6$；

对于所有评测用例，$1 \le n \le 2 \times 10^5,1 \le A_i \le 10^9$。

#### 样例解释

将原序列修改为 $4, 4, 4, 7, 7$ 即可。



---

---
title: "[蓝桥杯 2023 国 Java A] 游戏的得分"
layout: "post"
diff: 省选/NOI-
pid: P12239
tag: ['2023', '数论', '蓝桥杯国赛', '大步小步算法 BSGS']
---
# [蓝桥杯 2023 国 Java A] 游戏的得分
## 题目描述

小蓝和小乔正在玩游戏，一开始双方分数均为 $1$，每局游戏都有多个轮次。游戏的每轮总有一个人获胜/失败，其中获胜者分数变为原来的 $4$ 倍，失败者分数变为原来的 $2$ 倍。小蓝和小乔玩了很多局游戏，它们记下了每局游戏最终的分数对 $998\,244\,353$ 取模的结果，但他们忘记了每局游戏进行的轮次数。

请输出每局游戏中要得到给定的结果所需的最少轮次数。特别地，如果小蓝和小乔记错了游戏的结果，也就是无论如何也得不到输入的分数，请输出 $-1$。
## 输入格式

输入的第一行包含一个整数 $T$ 表示游戏局数。

接下来 $T$ 行，每行包含两个整数 $a_i$，$b_i$ 分别表示小蓝和小乔在第 $i$ 局游戏的记录。

## 输出格式

输出 $T$ 行，每行包含一个整数，其中第 $i$ 行的整数表示得到第 $i$ 局游戏给定结果所需的最少轮次数。
## 样例

### 样例输入 #1
```
4
4 2
6 3
8 8
1 2
```
### 样例输出 #1
```
1
-1
2
665496235
```
## 提示

### 评测用例规模与约定

- 对于 $20\%$ 的评测用例，$T \leq 5$；
- 对于 $40\%$ 的评测用例，$T \leq 2000$；
- 对于所有评测用例，$1 \leq T \leq 10^5$，$1 \leq a_i, b_i < 998244353$。


---

---
title: "[蓝桥杯 2024 国 Java B] 最优路径"
layout: "post"
diff: 省选/NOI-
pid: P12259
tag: ['2024', '生成树', '线性基', '蓝桥杯国赛']
---
# [蓝桥杯 2024 国 Java B] 最优路径
## 题目描述

给出一个具有 $N$ 个点、$M$ 条边的无向图（可能存在重边和自环）。其中每条边都有一个 $w$ 属性表示无向边的权重。

你可以从这个图中任意选两个不同的点 $start$、$end$，并以 $start$ 作为起点，$end$ 作为终点找出一条从 $start$ 到 $end$ 的路径（这条路径可以多次经过同一个点，也可以多次经过同一条边），将这条路径上经过的所有边的权重求一个异或和便得到了这条路径的风险值。

小蓝想要找到一条风险值最小的路径，请问最小的风险值是多少？
## 输入格式

第一行输入两个整数 $N$，$M$。

接下来输入 $M$ 行，每行三个整数 $u$、$v$、$w$，表示一条无向边连接 $u$、$v$ 两个点，权重为 $w$。
## 输出格式

输出一个整数表示最小的风险值。如果不存在任何一条满足题意的路径，输出 $-1$。
## 样例

### 样例输入 #1
```
3 4
1 1 9
2 3 3
2 3 8
3 3 1
```
### 样例输出 #1
```
2
```
## 提示

### 样例说明

先走第二条边，再走第四条边，风险值 $3 \oplus 1 = 2$。

### 评测用例规模与约定

- 对于 $60\%$ 的评测用例，$1 \leq N \leq 50$，$1 \leq M \leq 10^3$。
- 对于 $100\%$ 的评测用例，$1 \leq N \leq 500$，$1 \leq M \leq 10^4$，$1 \leq u, v \leq N$，$1 \leq w \leq 10^3$。


---

---
title: "[蓝桥杯 2024 国 Java B] 房屋建造"
layout: "post"
diff: 省选/NOI-
pid: P12260
tag: ['2024', '蓝桥杯国赛', '状压 DP']
---
# [蓝桥杯 2024 国 Java B] 房屋建造
## 题目描述

有一个由 $N$ 行 $N$ 列方格组成的建筑用地，每个方格，我们用 `#` 表示这是一堵墙，`.` 表示是一片空地，其中只有在空地上才可以进行房屋建造。小蓝想要在这片区域上建造两个房屋：通过水平/垂直方向可以连通在一起的区域属于同一个房屋。由于建筑物料有限，小蓝最多只能在 $K$ 个空地上进行房屋建造，同时他希望自己的房屋面积尽可能的大，所以他必须用光所有的 $K$ 块空地来建造房屋。

请问一共有多少种不同的建造方案。
## 输入格式

第一行输入三个整数 $N$、$K$。

接下来输入 $N$ 行，每行输入一个长度为 $N$ 的字符串，表示方格布局。
## 输出格式

输出一个整数表示答案。
## 样例

### 样例输入 #1
```
3 3
###
.##
##.
```
### 样例输出 #1
```
0
```
### 样例输入 #2
```
3 3
.#.
.##
..#
```
### 样例输出 #2
```
5
```
## 提示

### 样例说明

- 对于样例 $1$：$K = 3$，但只有两个空地，所以没有符合题意的解，答案为 $0$。
- 对于样例 $2$，答案如下所示，我们用 `@` 表示建筑物：

```
@#. @#@ @#. .#@ .#@
.## @## @## @## .##
@@# ..# .@# @.# @@#
```

### 评测用例规模与约定

- 对于 $50\%$ 的评测用例：$1 \leq N \leq 5$，$1 \leq K \leq 5$。
- 对于 $100\%$ 的评测用例：$1 \leq N \leq 8$，$1 \leq K \leq 8$。


---

---
title: "[蓝桥杯 2024 国 Python A] 药剂"
layout: "post"
diff: 省选/NOI-
pid: P12285
tag: ['数学', '2024', '概率论', '蓝桥杯国赛']
---
# [蓝桥杯 2024 国 Python A] 药剂
## 题目描述

小蓝今天的实验内容是合并 $N$ 瓶试剂。每瓶试剂初始都有一个魔法值 $a_i$，所有魔法值都是正整数。

每次小蓝会随机从手头的试剂中选出两瓶，将其合并。合并时，两瓶试剂会发生化学反应，产生强大的力量，也有可能效果没有那么好。但无论如何，小蓝会得到一瓶全新的，可以和其他试剂合并的试剂。我们认为，小蓝在合并两瓶试剂时，如果两瓶试剂的魔法值分别是 $x$ 和 $y$，有 $\frac{1}{2}$ 的概率，小蓝得到的新试剂魔法值为 $x+y$，对于另 $\frac{1}{2}$ 概率，小蓝得到的新试剂的魔法值为 $xy$。

像这样，小蓝重复合并操作 $n-1$ 次，最后只会剩下一瓶试剂。小蓝希望知道，最后这瓶试剂的魔法值期望是多少。为了方便，假定这个值是 $ans$，你只需要告诉小蓝，$ans$ 乘上 $2^{n-1}\displaystyle \prod_{i=2}^{n}C_i^2$ 的结果，其中 $C_i^2$ 是组合数。不难证明这个值一定是一个整数。但这个乘积显然太大了，小蓝只希望你告诉她这个乘积对整数 $mo$ 取模之后的结果。
## 输入格式

输入的第一行包含两个正整数 $N, mo$，用一个空格分隔。

第二行包含 $N$ 个正整数，相邻整数之间使用一个空格分隔，其中第 $i$ 个正整数表示第 $i$ 瓶试剂的魔法值 $a_i$。
## 输出格式

输出一行包含一个整数表示答案，即最后一瓶试剂魔法值的期望乘上 $2^{n-1}\displaystyle \prod_{i=2}^{n}C_i^2$ 的结果。
## 样例

### 样例输入 #1
```
3 1000000007
1 2 3
```
### 样例输出 #1
```
75
```
## 提示

### 样例说明

可能的合并情形较多，这里给出样例中两种可能的情况：

- 第一次小蓝随机选中魔法值为 $1$ 和 $3$ 的试剂进行合并，得到魔法值为 $1+3=4$ 的一瓶新的试剂。
- 然后小蓝对仅剩的两瓶试剂进行合并，得到 $4 \times 2=8$ 的一瓶试剂。
- 因此这种情况最终试剂的魔法值为 $8$。

又或者：

- 第一次小蓝随机选中魔法值为 $1$ 和 $2$ 的试剂进行合并，得到魔法值为 $1 \times 2=2$ 的一瓶新的试剂。
- 然后小蓝对仅剩的两瓶试剂进行合并，得到 $2+3=5$ 的一瓶试剂。
- 因此这种情况最终试剂的魔法值为 $5$。

### 评测用例规模与约定

- 对于 $30\%$ 的评测用例，$1 \leq N \leq 5$，$mo = 10^9 + 7$；
- 对于 $50\%$ 的评测用例，$1 \leq N \leq 50$，$mo = 10^9 + 7$；
- 对于 $70\%$ 的评测用例，$1 \leq N \leq 300$，$mo = 10^9 + 7$；
- 对于 $80\%$ 的评测用例，$mo = 10^9 + 7$；
- 对于所有评测用例，$1 \leq N \leq 3000$，$1 \leq a_i \leq 10^9$，$1 \leq mo \leq 10^9 + 7$。


---

---
title: "[蓝桥杯 2024 国 Java A] 斗蛐蛐"
layout: "post"
diff: 省选/NOI-
pid: P12292
tag: ['2024', '概率论', '蓝桥杯国赛', '状压 DP']
---
# [蓝桥杯 2024 国 Java A] 斗蛐蛐
## 题目描述

小蓝最近非常热衷于斗蛐蛐。她有 $n$ 只不同的蛐蛐，每只蛐蛐的战斗力都可以用一个数 $a_i$ 表示，含义是当第 $i$ 只蛐蛐攻击别的蛐蛐时有 $a_i$ 的概率打倒对方，有 $1 - a_i$ 的概率无事发生。

小蓝将 $n$ 只蛐蛐按编号由 $1$ 到 $n$ 顺时针的顺序排成一圈，然后从 $1$ 号蛐蛐开始发生以下的过程直到只剩下 $1$ 只蛐蛐：

1. 这只蛐蛐以各 $1/2$ 的概率选定顺时针或逆时针方向。
2. 这只蛐蛐攻击这个方向上第一只未被打倒的蛐蛐。
3. 无论这次攻击是否打倒了蛐蛐，顺时针方向的下一只蛐蛐开始行动。

现在小蓝希望知道，最后剩下的蛐蛐是 $i$ 号蛐蛐的概率是多少。为了防止精度误差，她希望你给出这个值在模素数 $m$ 下的结果。
## 输入格式

输入的第一行包含两个正整数 $n, m$，用一个空格分隔。

第二行包含 $n$ 个正整数，其中第 $i$ 个正整数表示第 $i$ 只蛐蛐在模 $m$ 下的战斗力 $a_i$。
## 输出格式

输出一行包含 $n$ 整数，相邻整数之间使用一个空格分隔，其中第 $i$ 个整数表示最后一只蛐蛐是 $i$ 号蛐蛐的概率在模 $m$ 下的表示。
## 样例

### 样例输入 #1
```
2 1000000007
500000004 500000004
```
### 样例输出 #1
```
666666672 333333336
```
## 提示

### 样例说明

一共两只蛐蛐，蛐蛐的战斗力都是 $1/2$，$1$ 号蛐蛐攻击 $2$ 号蛐蛐若成功，则 $1$ 号蛐蛐获胜，若失败则相当于双方位置交换，所以最终 $1$ 号蛐蛐获胜概率 $p$ 满足 $p = 1/2 + 1/2(1 - p)$ 解得 $p = 2/3$。

### 评测用例规模与约定

- 对于 $30\%$ 的评测用例，$n \leq 8$，$a_i = (m + 1)/2$，即 $a_i$ 在模 $m$ 意义下为 $\frac{1}{2}$；
- 对于 $50\%$ 的评测用例，$n \leq 8$；
- 对于所有评测用例，$2 \leq a_i < m \leq 10^9 + 7$，$2 \leq n \leq 15$，$m$ 必定为一个大于 $2$ 的素数。


---

---
title: "[蓝桥杯 2024 国 Java A] 合并小球"
layout: "post"
diff: 省选/NOI-
pid: P12293
tag: ['动态规划 DP', '2024', '期望', '蓝桥杯国赛']
---
# [蓝桥杯 2024 国 Java A] 合并小球
## 题目描述

给定 $n$ 个小球，其中第 $i$ 个小球位于数轴的 $x_i$ 处，小球上有数字 $y_i$。

每经过一秒，每个小球都有 $\frac{1}{2}$ 的概率向右移动一步。当任意小球到达位置 $T$ 时，小球会被立刻取走。

如果某一秒，有两个相邻的小球，左边的向右移动且右边的不动，那么两个小球会合并成一个，且合并后小球的数字为合并前的小球数字的乘积。

求所有小球都被取走时的数字之和的期望值，答案对 $998244353$ 取模。
## 输入格式

输入的第一行包含两个整数 $n, T$，用一个空格分隔。

接下来 $n$ 行，每行包含两个数 $x_i, y_i$，用一个空格分隔。
## 输出格式

输出一行包含一个整数表示答案。
## 样例

### 样例输入 #1
```
3 5
2 1
3 1
4 1
```
### 样例输出 #1
```
406692146
```
## 提示

### 样例说明

$\frac{59}{27} \equiv 406692146 \pmod{998244353}$，其中 $\frac{1}{27} \equiv 480636170 \pmod{998244353}$。

### 评测用例规模与约定

- 对于 $20\%$ 的评测用例，$n \leq 5$，$T \leq 10$；
- 对于 $40\%$ 的评测用例，$n \leq 10$，$T \leq 20$；
- 对于所有评测用例，$1 \leq n < T \leq 100$，$1 \leq x_{i-1} < x_i < T$，$1 \leq y_i \leq 10^9$。


---

---
title: "[蓝桥杯 2024 国研究生组] 深度优先搜索"
layout: "post"
diff: 省选/NOI-
pid: P12320
tag: ['2024', '组合数学', '容斥原理', '蓝桥杯国赛']
---
# [蓝桥杯 2024 国研究生组] 深度优先搜索
## 题目描述

小蓝正在学习深度优先搜索。给出一段小蓝写的代码

```cpp
void dfs(int rt, int deep, int fa) {
    a[++cnt] = deep;
    for (int i = head[rt]; i; i = e[i].next)
        if (e[i].to != fa) dfs(e[i].to, deep + 1, rt);
}
```

对一个有根树执行 `dfs(root, 0, 0)` 可以生成一个长度为树中结点个数的序列，依次表示对遍历的所有结点的深度，小蓝认为假如一个序列能够通过对一个有根树执行 `dfs` 得到，这个序列就是合法的。现在小蓝有一个只包含 $-1$ 和非负整数的序列，小蓝想要知道，有多少种把 $-1$ 替换成任意非负整数的方案，使得该序列合法。
## 输入格式

输入的第一行包含一个正整数 $n$ 表示序列长度。

第二行包含 $n$ 个非负整数或 $-1$，相邻整数之间使用一个空格分隔，表示序列中的数 $a_i$。
## 输出格式

输出一行包含一个整数，表示答案除以 $10^9 + 7$ 的余数。
## 样例

### 样例输入 #1
```
2
1 -1
```
### 样例输出 #1
```
0
```
### 样例输入 #2
```
4
0 1 -1 1
```
### 样例输出 #2
```
2
```
## 提示

### 样例说明

对于样例 $2$，两个合法的序列是 $\{0, 1, 1, 1\}$ 和 $\{0, 1, 2, 1\}$。

### 评测用例规模与约定

- 对于 $30\%$ 的评测用例，保证序列中不会出现两个连续的 $-1$，即若 $a_i = -1$，则 $a_{i+1} \neq -1$。
- 对于 $50\%$ 的评测用例，$n \leq 300$；
- 对于所有评测用例，$1 \leq n \leq 1000000$，$-1 \leq a_i \leq n$。


---

---
title: "[蓝桥杯 2024 国研究生组] 生成树问题"
layout: "post"
diff: 省选/NOI-
pid: P12321
tag: ['2024', '快速傅里叶变换 FFT', '蓝桥杯国赛']
---
# [蓝桥杯 2024 国研究生组] 生成树问题
## 题目描述

给定 $n$ 个点，编号 $1$ 至 $n$，任意两点 $x, y$ 之间均有且仅有一条边。如果 $x \cdot y$ 为完全平方数（也即存在整数 $z$ 满足 $z^2 = x \cdot y$），那么其边权为 $1$，否则为 $0$。

小蓝想要得到一棵生成树，其除 $1$ 以外的每个点都有一个编号小于自己的点与其相邻。求小蓝想得到的所有生成树中，边权和为 $0$ 至 $n-1$ 的分别各有多少种，请输出答案对 $998244353$ 取模的结果。
## 输入格式

输入一行包含一个整数 $n$。
## 输出格式

输出 $n$ 行，每行包含一个整数，依次表示边权和为 $0 \sim n-1$ 的生成树种数。
## 样例

### 样例输入 #1
```
4
```
### 样例输出 #1
```
4
2
0
0
```
## 提示

### 评测用例规模与约定

- 对于 $60\%$ 的评测用例，$n \leq 5000$；
- 对于 $85\%$ 的评测用例，$n \leq 10^5$；

对于所有评测用例，$1 \leq n \leq 3 \times 10^5$。


---

---
title: "[蓝桥杯 2025 国 A] 连锁反应【数据强度待检验】"
layout: "post"
diff: 省选/NOI-
pid: P12845
tag: ['图论', '贪心', '线段树', '2025', '图论建模', '强连通分量', '蓝桥杯国赛']
---
# [蓝桥杯 2025 国 A] 连锁反应【数据强度待检验】
## 题目背景

数据强度可能较弱，可能会不定期更新。
## 题目描述

小蓝在数轴上放置了 $n$ 枚炸弹，第 $i$ 枚炸弹的位置为 $p_i$，其爆炸范围为 $[p_i - l_i, p_i + r_i]$。当一枚炸弹爆炸时，其范围内的所有其他未爆炸的炸弹均会被引爆。小蓝希望知道至少需要主动引爆多少枚炸弹，才能使得所有炸弹都爆炸。

## 输入格式

输入的第一行包含一个正整数 $n$。

接下来 $n$ 行，每行包含三个整数 $p_i, l_i, r_i$，相邻整数之间使用一个空格分隔。
## 输出格式

输出一行包含一个整数表示答案。
## 样例

### 样例输入 #1
```
5
3 1 1
1 0 2
6 2 1
9 4 2
10 1 1

```
### 样例输出 #1
```
2
```
## 提示

**【样例说明】**

主动引爆炸弹 $2, 4$，即可引爆所有炸弹。

**【评测用例规模与约定】**

对于 20% 的评测用例，$1 \leq n \leq 2000$；

对于另外 20% 的评测用例，$l_i = 0$；

对于所有评测用例，$1 \leq n \leq 200000$，$0 \leq p_i, l_i, r_i \leq 10^5$。


---

---
title: "[蓝桥杯 2013 国 A] 车轮轴迹"
layout: "post"
diff: 省选/NOI-
pid: P8610
tag: ['计算几何', '2013', '蓝桥杯国赛']
---
# [蓝桥杯 2013 国 A] 车轮轴迹
## 题目描述

栋栋每天骑自行车回家需要经过一条狭长的林荫道。道路由于年久失修，变得非常不平整。虽然栋栋每次都很颠簸，但他仍把骑车经过林荫道当成一种乐趣。

由于颠簸，栋栋骑车回家的路径是一条上下起伏的曲线，栋栋想知道，他回家的这条曲线的长度究竟是多长呢？更准确的，栋栋想知道从林荫道的起点到林荫道的终点，他的车前轮的轴（圆心）经过的路径的长度。

栋栋对路面进行了测量。他把道路简化成一条条长短不等的直线段，这些直线段首尾相连，且位于同一平面内。并在该平面内建立了一个直角坐标系，把所有线段的端点坐标都计算好。

假设栋栋的自行车在行进的过程中前轮一直是贴着路面前进的。

![](https://cdn.luogu.com.cn/upload/image_hosting/1vb89irr.png)

图 $1$ 给出了一个简单的路面的例子，其中蓝色实线为路面，红色虚线为车轮轴经过的路径。在这个例子中，栋栋的前轮轴从 $A$ 点出发，水平走到 $B$ 点，然后绕着地面的 $F$ 点到 $C$ 点（绕出一个圆弧），再沿直线下坡到 $D$ 点，最后水平走到 $E$ 点，在这个图中地面的坐标依次为：$(0,0),(2,0),(4,-1),(6,-1)$，前轮半径为 $1.50$，前轮轴前进的距离依次为：

$AB=2.0000$；弧长 $BC=0.6955$；$CD=1.8820$；$DE=1.6459$。

总长度为 $6.2233$。

![](https://cdn.luogu.com.cn/upload/image_hosting/z166vjw7.png)

图 $2$ 给出了一个较为复杂的路面的例子，在这个例子中，车轮在第一个下坡还没下完时（$D$ 点）就开始上坡了，之后在坡的顶点要从 $E$ 绕一个较大的圆弧到 $F$ 点。这个图中前轮的半径为 $1$，每一段的长度依次为：

$AB=3.0000$；弧长 $BC=0.9828$；$CD=1.1913$；$DE=2.6848$；弧长 $EF=2.6224$；$FG=2.4415$；$GH=2.2792$。

总长度为 $15.2021$。

现在给出了车轮的半径和路面的描述，请求出车轮轴轨迹的总长度。
## 输入格式

输入的第一行包含一个整数 $n$ 和一个实数 $r$，用一个空格分隔，表示描述路面的坐标点数和车轮的半径。

接下来 $n$ 行，每个包含两个实数，其中第 $i$ 行的两个实数 $x_i,y_i$ 表示描述路面的第 $i$ 个点的坐标。

路面定义为所有路面坐标点顺次连接起来的折线。给定的路面的一定满足以下性质：

* 第一个坐标点一定是 $(0,0)$；
* 第一个点和第二个点的纵坐标相同；
* 倒数第一个点和倒数第二个点的纵坐标相同；
* 第一个点和第二个点的距离不少于车轮半径；
* 倒数第一个点和倒数第二个点的的距离不少于车轮半径；
* 后一个坐标点的横坐标大于前一个坐标点的横坐标，即对于所有的 $i$，$x_{i+1}>x_i$。
## 输出格式

输出一个实数，四舍五入保留两个小数，表示车轮轴经过的总长度。

你的结果必须和参考答案一模一样才能得分。数据保证答案精确值的小数点后第三位不是 $4$ 或 $5$。
## 样例

### 样例输入 #1
```
4 1.50
0.00 0.00
2.00 0.00
4.00 -1.00
6.00 -1.00
```
### 样例输出 #1
```
6.22
```
### 样例输入 #2
```
6 1.00
0.00 0.00
3.00 0.00
5.00 -3.00
6.00 2.00
7.00 -1.00
10.00 -1.00
```
### 样例输出 #2
```
15.20
```
## 提示

对于 $20\%$ 的数据，$n=4$；

对于 $40\%$ 的数据，$n \le 10$；

对于 $100\%$ 的数据，$4 \le n \le 100$，$0.5 \le r \le 20.0$，$x_i \le 2000.0$，$-2000.0 \le y_i \le 2000.0$。

时限 1 秒, 64M。蓝桥杯 2013 年第四届国赛


---

---
title: "[蓝桥杯 2015 国 AC] 切开字符串"
layout: "post"
diff: 省选/NOI-
pid: P8631
tag: ['2015', '枚举', '前缀和', 'Manacher 算法', '蓝桥杯国赛']
---
# [蓝桥杯 2015 国 AC] 切开字符串
## 题目描述

Pear 有一个字符串，不过他希望把它切成两段。

这是一个长度为 $N$（$ \le 10^5$）的字符串。

Pear 希望选择一个位置，把字符串不重复不遗漏地切成两段，长度分别是 $t$ 和 $N-t$（这两段都必须非空）。

Pear 用如下方式评估切割的方案：

定义“正回文子串”为：长度为奇数的回文子串。

设切成的两段字符串中，前一段中有 $A$ 个不相同的正回文子串，后一段中有 $B$ 个不相同的非正回文子串，则该方案的得分为 $A \times B$。

注意，后一段中的 $B$ 表示的是：“ ... 非正回文 ... ”，而不是：“ ... 正回文 ... ”。

那么所有的切割方案中，$A \times B$ 的最大值是多少呢？
## 输入格式

输入第一行一个正整数 $N$（$ \le 10^5$）

接下来一行一个字符串，长度为 $N$。该字符串仅包含小写英文字母。
## 输出格式

一行一个正整数，表示所求的 $A \times B$ 的最大值。
## 样例

### 样例输入 #1
```
10
bbaaabcaba
```
### 样例输出 #1
```
38
```
## 提示

对于 $20\%$ 的数据，$N \le 100$。

对于 $40\%$ 的数据，$N \le 1000$。

对于 $100\%$ 的数据，$N \le 10^5$。

时限 1 秒, 512M。蓝桥杯 2015 年第六届国赛


---

---
title: "[蓝桥杯 2015 国 B] 居民集会"
layout: "post"
diff: 省选/NOI-
pid: P8632
tag: ['动态规划 DP', '2015', '斜率优化', '蓝桥杯国赛']
---
# [蓝桥杯 2015 国 B] 居民集会
## 题目描述

蓝桥村的居民都生活在一条公路的边上，公路的长度为 $L$，每户家庭的位置都用这户家庭到公路的起点的距离来计算，第 $i$ 户家庭距起点的距离为 $d_i$。

每年，蓝桥村都要举行一次集会。今年，由于村里的人口太多，村委会决定要在 $4$ 个地方举行集会，其中 $3$ 个位于公路中间，$1$ 个位最公路的终点。

已知每户家庭都会向着远离公路起点的方向去参加集会，参加集会的路程开销为家庭内的人数 $t_i$ 与距离的乘积。

给定每户家庭的位置 $d_i$ 和人数 $t_i$，请为村委会寻找最好的集会举办地：$p_1,p_2,p_3,p_4(p_1 \le p_2 \le p_3 \le p_4=L),$ 使得村内所有人的路程开销和最小。
## 输入格式

输入的第一行包含两个整数 $n,L$，分别表示蓝桥村的家庭数和公路长度。

接下来 $n$ 行，每行两个整数 $d_i,t_i$，分别表示第 $i$ 户家庭距离公路起点的距离和家庭中的人数。
## 输出格式

输出一行，包含一个整数，表示村内所有人路程的开销和。
## 样例

### 样例输入 #1
```
6 10
1 3
2 2
4 5
5 20
6 5
8 7
```
### 样例输出 #1
```
18
```
## 提示

【样例说明】

在距起点 $2,5,8,10$ 这 $4$ 个地方集会，$6$ 个家庭需要的走的距离分别为 $1,0,1,0,2,0$，总的路程开销为 $1 \times 3+0 \times 2+1 \times 5+0 \times 20+2 \times 5+0 \times 7=18$。

【数据规模与约定】

对于 $10\%$ 的评测数据，$1 \le n \le 300$。

对于 $30\%$ 的评测数据，$1 \le n \le 2000$，$1 \le L \le 10000$，$0 \le d_i \le L$，$d_i \le d_i+1$，$0 \le t_i \le 20$。

对于 $100\%$ 的评测数据，$1 \le n \le 10^5$，$1 \le L \le 10^6$，$0 \le d_i \le L$，$d_i \le d_i+1$，$0 \le t_i \le 10^6$。


---

---
title: "[蓝桥杯 2015 国 B] 模型染色"
layout: "post"
diff: 省选/NOI-
pid: P8633
tag: ['2015', '枚举', 'Pólya 定理', '蓝桥杯国赛']
---
# [蓝桥杯 2015 国 B] 模型染色
## 题目描述

在电影《超能陆战队》中，小宏可以使用他的微型机器人组合成各种各样的形状。

现在他用他的微型机器人拼成了一个大玩具给小朋友们玩。为了更加美观，他决定给玩具染色。

小宏的玩具由 $n$ 个球型的端点和 $m$ 段连接这些端点之间的边组成。下图给出了一个由 $5$ 个球型端点和 $4$ 条边组成的玩具，看上去很像一个分子的球棍模型。

![](https://cdn.luogu.com.cn/upload/image_hosting/sefn3dug.png)

由于小宏的微型机器人很灵活，这些球型端点可以在空间中任意移动，同时连接相邻两个球型端点的边可以任意的伸缩，这样一个玩具可以变换出不同的形状。在变换的过程中，边不会增加，也不会减少。

小宏想给他的玩具染上不超过 $k$ 种颜色，这样玩具看上去会不一样。如果通过变换可以使得玩具变成完全相同的颜色模式，则认为是本质相同的染色。现在小宏想知道，可能有多少种本质不同的染色。
## 输入格式

输入的第一行包含三个整数 $n,m,k$，

分别表示小宏的玩具上的端点数、边数和小宏可能使用的颜色数。端点从 $1$ 到 $n$ 编号。

接下来 $m$ 行每行两个整数 $a,b$，表示第 $a$ 个端点和第 $b$ 个端点之间有一条边。输入保证不会出现两条相同的边。
## 输出格式

输出一行，表示本质不同的染色的方案数。由于方案数可能很多，请输入方案数除 $10007$ 的余数。
## 样例

### 样例输入 #1
```
3 2 2
1 2
3 2
```
### 样例输出 #1
```
6
```
## 提示

**【样例说明】**

令 $(a,b,c)$ 表示第一个端点染成 $a$，第二个端点染成 $b$，第三个端点染成 $c$，则下面 $6$ 种本质不同的染色：$(1,1,1),(1,1,2),(1,2,1),(1,2,2),(2,1,2),(2,2,2)$。

而 $(2,1,1)$ 与 $(1,1,2)$ 是本质相同的，$(2,2,1)$ 与 $(2,1,2)$ 是本质相同的。

**【数据规模与约定】**

对于 $20\%$ 的评测数据，$1 \le n \le 5$，$1 \le k \le 2$。

对于 $50\%$ 的评测数据，$1 \le n \le 10,1 \le k \le 8$。

对于 $100\%$ 的评测数据，$1 \le n \le 10,1 \le m \le 45,1 \le k \le 30$。


---

---
title: "[蓝桥杯 2015 国 A] 铺瓷砖"
layout: "post"
diff: 省选/NOI-
pid: P8634
tag: ['2015', '蓝桥杯国赛', '状压 DP']
---
# [蓝桥杯 2015 国 A] 铺瓷砖
## 题目描述

为了让蓝桥杯竞赛更顺利的进行，主办方决定给竞赛的机房重新铺放瓷砖。机房可以看成一个 $n \times m$ 的矩形，而这次使用的瓷砖比较特别，有两种形状，如【图1】所示。在铺放瓷砖时，可以旋转。

![](https://cdn.luogu.com.cn/upload/image_hosting/velq3nup.png)

主办方想知道，如果使用这两种瓷砖把机房铺满，有多少种方案。

## 输入格式

输入的第一行包含两个整数，分别表示机房两个方向的长度。
## 输出格式

输出一个整数，表示可行的方案数。这个数可能很大，请输出这个数除以 $65521$ 的余数。
## 样例

### 样例输入 #1
```
4 4
```
### 样例输出 #1
```
2
```
### 样例输入 #2
```
2 6
```
### 样例输出 #2
```
4
```
## 提示

**【样例说明】**

![](https://cdn.luogu.com.cn/upload/image_hosting/rktm7ut2.png)

**【数据规模与约定】**

对于 $20\%$ 的数据，$1 \le n,m \le 5$。

对于 $50\%$ 的数据，$1 \le n \le 100$，$1 \le m \le 5$。

对于 $100\%$ 的数据，$1 \le n \le 10^{15}$，$1 \le m \le 6$。

时限 5 秒, 512M。蓝桥杯 2015 年第六届国赛


---

---
title: "[蓝桥杯 2016 国 B] 生成树计数"
layout: "post"
diff: 省选/NOI-
pid: P8639
tag: ['2016', '蓝桥杯国赛', '状压 DP']
---
# [蓝桥杯 2016 国 B] 生成树计数
## 题目描述

给定一个 $n×m$ 的格点图，包含 $n$ 行 $m$ 列共 $n×m$ 个顶点，相邻的顶点之间有一条边。

![](https://cdn.luogu.com.cn/upload/image_hosting/n56tzo5w.png)

给出了一个 $3×4$ 的格点图的例子。

如果在图中删除部分顶点和其相邻的边，如上图删除第 $2$ 行第 $3$ 列和第 $3$ 行第 $1$ 列的顶点后，如下图所示。

![](https://cdn.luogu.com.cn/upload/image_hosting/alcq3m2c.png)

图的生成树指包含图中的所有顶点和其中的一部分边，使得任意两个顶点之间都有由边构成的唯一路径。如果两个生成树包含有不同的边即被认为不同，则上图中共有 $31$ 种不同的生成树，其中 a 边不选有 $10$ 种，a 边选有 $21$ 种。

给出格点图中保留的顶点的信息，请计算该图一共有多少种不同的生成树。
## 输入格式

输入的第一行包含两个整数 $n$，$m$，用空格分隔，表示格点图的行数和列数。

接下来 $n$ 行，每行 $m$ 个字母（中间没有分隔字符），每个字母必然是大写 `E` 或大写 `N`，`E` 表示对应的顶点存在，`N` 表示对应的顶点不存在。保证存在至少一个顶点。
## 输出格式

输出一行，包含一个整数，表示生成树的个数。答案可能很大，你只需要计算答案除以 $1000000007$（即 $10^9+7$） 的余数即可。
## 样例

### 样例输入 #1
```
3 4
EEEE
EENE
NEEE
```
### 样例输出 #1
```
31
```
## 提示

对于 $10\%$ 的数据，$1\le n\le2$。

对于 $30\%$ 的数据，$1\le n\le3$。

对于 $40\%$ 的数据，$1\le n\le4$。

对于 $50\%$ 的数据，$1\le n\le5$。

另有 $20\%$ 的数据，$1\le n\times m\le12$。

另有 $10\%$ 的数据，$1\le m\le15$。

对于 $100\%$ 的数据，$1\le n\le6，1\le m\le10^5$。


---

---
title: "[蓝桥杯 2016 国 A] 圆圈舞"
layout: "post"
diff: 省选/NOI-
pid: P8640
tag: ['2016', '平衡树', '蓝桥杯国赛']
---
# [蓝桥杯 2016 国 A] 圆圈舞
## 题目描述

春天温暖的阳光照耀着大地，正是草原上的小动物们最快乐的时候。小动物们在草原上开了一个舞会，欢度这美好的时光。

舞会上最重要的一个环节就是跳圆舞曲，$n$ 只小动物手拉手围成一大圈，随着音乐跳起来。在跳的过程中，小动物们可能会变换队形。它们的变换方式是动物 A 松开自己右手，动物 B 松开自己的左手，动物 A 和 B 手拉到一起，而它们对应的松开的手（如果有的话）也拉到一起。

例如，假设有 $10$ 只小动物，按顺序围成一圈，动物 $1$ 的右手拉着动物 $2$ 的左手，动物 $2$ 的右手拉着动物 $3$ 的左手，依次类推，最后动物 $10$ 的右手拉着动物 $1$ 的左手。如果通过动物 $2$ 和 $8$ 变换队形，则动物 $2$ 的右手拉着动物 $8$ 的左手，而对应的动物 $3$ 的左手拉着动物 $7$ 的右手，这样形成了 `1-2-8-9-10` 和 `3-4-5-6-7` 两个圈。如果此时通过动物 $2$ 和 $6$ 变换队形，则将形成 `1-2-6-7-3-4-5-8-9-10` 一个大圈。注意，如果此时通过动物 $1$ 和 $2$ 变换队形，那么队形不会改变，因为动物 $1$ 的右手和动物 $2$ 的左手松开后又拉到一起了。

在跳舞的过程中，每个动物 $i$ 都有一个欢乐值 $H_i$ 和一个感动值 $F_i$。

如果两个动物在一个圈中，欢乐值会彼此影响，产生欢乐能量。如果两个动物 $i, j(i\neq j)$ 在同一个大小为 $t$ 的圈中，而动物 $i$ 在动物 $j$ 右手的第 $p$ 个位置（动物 $j$ 右手的第 $1$ 个位置就是动物 $j$ 右手所拉着的动物，而第 $2$ 个位置就是右手第 $1$ 个位置的动物右手拉着的动物，依次类推），则产生的欢乐能量为 $(t-p)\times H_j\times F_i$。在跳舞的过程中，动物们的欢乐值和感动值有可能发生变化。

圆舞曲开始的时候，所有的动物按编号顺序围成一个圈，动物 $n$ 右手的第 $i$ 个位置正好是动物 $i$。现在已知小动物们变换队形的过程和欢乐值、感动值变化的过程，求每次变换后所有动物所产生的欢迎能量之和。
## 输入格式

输入的第一行包含一个整数 $n$，表示动物的数量。

接下来 $n$ 行，每行两个用空格分隔的整数 $H_i$，$F_i$，按编号顺序给出每只动物的欢乐值和感动值。
接下来一行包含一个整数 $m$，表示队形、欢乐值、感动值的变化次数。

接下来 $m$ 行，每行三个用空格分隔的整数 $k$，$p$，$q$，当 $k=1$ 时，表示小动物们通过动物 $p$ 和动物 $q$ 变换了队形，当 $k=2$ 时，表示动物 $p$ 的欢乐值变为 $q$，当 $k=3$ 时，表示动物 $p$ 的感动值变为了 $q$。
## 输出格式

输出 $m$ 行，每行一个整数，表示每次变化后所有动物产生的能量之和。

答案可能很大，你需要计算答案除以 $1000000007$（即 $10^9+7$） 的余数。

## 样例

### 样例输入 #1
```
10
1 1
1 1
1 1
1 1
1 1
1 1
1 1
1 1
1 1
1 1
9
1 2 8
1 2 6
2 8 10
3 5 10
1 1 2
1 2 1
2 5 5
1 4 8
1 4 5
```
### 样例输出 #1
```
100
450
855
1341
1341
811
923
338
923
```
## 提示

对于 $20\%$ 的数据，$2\le n,m\le100$。

对于 $30\%$ 的数据，$2\le n,m\le1000$。

另有 $20\%$ 的数据，只有 $k=1$ 的操作且 $H_i$，$F_i$ 均为 $1$。

另有 $20\%$ 的数据，只有 $k=1$ 或 $2$ 的操作且 $F_i$ 均为 $1$。

对于 $100\%$ 的数据，$2\le n,m\le10^5$，$0\le H_i,F_i\le10^9$，$1\le k\le3$，$k=1$ 时 $1\le p,q\le n$ 且 $p\neq q$，$k=2$ 或 $3$ 时 $1\le p\le n$ 且 $0\le q\le10^9$。


---

---
title: "[蓝桥杯 2022 国 A] owo"
layout: "post"
diff: 省选/NOI-
pid: P8793
tag: ['贪心', '2022', '蓝桥杯国赛']
---
# [蓝桥杯 2022 国 A] owo
## 题目描述

小蓝很喜欢 `owo`，他现在有一些字符串，他想将这些字符串拼接起来，使得最终得到的字符串中出现尽可能多的 `owo`。

在计算数量时，允许字符重叠，即 `owowo` 计算为 $2$ 个，`owowowo` 计算为 $3$ 个。请算出最优情况下得到的字符串中有多少个 `owo`。
## 输入格式

输入的第一行包含一个整数 $n$，表示小蓝拥有的字符串的数量。

接下来 $n$ 行，每行包含一个由小写英文字母组成的字符串 $s_i$。
## 输出格式

输出 $n$ 行，每行包含一个整数，表示前 $i$ 个字符串在最优拼接方案中可以得到的 `owo` 的数量。
## 样例

### 样例输入 #1
```
3
owo
w
ow
```
### 样例输出 #1
```
1
1
2
```
## 提示

**【评测用例规模与约定】**

- 对于 $10\%$ 的评测用例，$n \leq 10$；
- 对于 $40\%$ 的评测用例，$n \leq 300$；
- 对于 $60\%$ 的评测用例，$n \leq 5000$；
- 对于所有评测用例，$1 \leq n \leq 10^6$，$1 \leq |s_i|,\sum|s_i| \leq 10^6$，其中 $|s_i|$ 表示字符串 $s_i$ 的长度。字符不是 $\tt o$ 就是 $\tt w$。

蓝桥杯 2022 国赛 A 组 E 题。


---


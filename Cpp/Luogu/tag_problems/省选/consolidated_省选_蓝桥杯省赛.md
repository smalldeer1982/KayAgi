---
title: "[蓝桥杯 2013 省 B] 连号区间数"
layout: "post"
diff: 省选/NOI-
pid: P8600
tag: ['2013', '线段树', '分治', '前缀和', '蓝桥杯省赛']
---
# [蓝桥杯 2013 省 B] 连号区间数
## 题目描述


小明这些天一直在思考这样一个奇怪而有趣的问题：

在 $1$ ~ $N$ 的某个全排列中有多少个连号区间呢？这里所说的连号区间的定义是：

如果区间 $[L, R]$ 里的所有元素（即此排列的第 $L$个到第 $R$ 个元素）递增排序后能得到一个长度为 $R-L+1$ 的“连续”数列，则称这个区间连号区间。

当 $N$ 很小的时候，小明可以很快地算出答案，但是当 $N$ 变大的时候，问题就不是那么简单了，现在小明需要你的帮助。
## 输入格式

第一行是一个正整数 $N (1 \le N \le 50000)$， 表示全排列的规模。

第二行是 $N$ 个不同的数字 $P_i(1 \le P_i \le N)$， 表示这 $N$ 个数字的某一全排列。
## 输出格式

输出一个整数，表示不同连号区间的数目。
## 样例

### 样例输入 #1
```
4
3 2 4 1
```
### 样例输出 #1
```
7
```
### 样例输入 #2
```
5
3 4 2 5 1
```
### 样例输出 #2
```
9
```
## 提示

第一个用例中，有 $7$ 个连号区间分别是：$[1,1]$, $[1,2]$, $[1,3]$, $[1,4]$, $[2,2]$, $[3,3]$, $[4,4]$。

第二个用例中，有 $9$ 个连号区间分别是：$[1,1]$, $[1,2]$, $[1,3]$, $[1,4]$, $[1,5]$, $[2,2]$, $[3,3]$, $[4,4]$, $[5,5]$。

原题时限 5 秒, 64M。蓝桥杯 2013 年第四届省赛


---

---
title: "[蓝桥杯 2015 省 A] 灾后重建"
layout: "post"
diff: 省选/NOI-
pid: P8626
tag: ['2015', '生成树', '蓝桥杯省赛', '根号分治']
---
# [蓝桥杯 2015 省 A] 灾后重建
## 题目描述

Pear 市一共有 $N$（$ \le 50000$）个居民点，居民点之间有 $M$（$ \le 2\times 10^5$）条双向道路相连。这些居民点两两之间都可以通过双向道路到达。这种情况一直持续到最近，一次严重的地震毁坏了全部 $M$ 条道路。

震后，Pear 打算修复其中一些道路，修理第 $i$ 条道路需要 $P_i$ 的时间。不过，Pear 并不打算让全部的点连通，而是选择一些标号特殊的点让他们连通。

Pear 有 $Q$（$ \le 50000$）次询问，每次询问，他会选择所有编号在 $[l,r]$ 之间，并且编号 $\bmod{K}=C$ 的点，修理一些路使得它们连通。由于所有道路的修理可以同时开工，所以完成修理的时间取决于花费时间最长的一条路，即涉及到的道路中 $P_i$ 的最大值。

你能帮助 Pear 计算出每次询问时需要花费的最少时间么？这里询问是独立的，也就是上一个询问里的修理计划并没有付诸行动。
## 输入格式

第一行三个正整数 $N$、$M$、$Q$，含义如题面所述。

接下来 $M$ 行，每行三个正整数 $X_i$、$Y_i$、$P_i$，表示一条连接 $X_i$ 和 $Y_i$ 的双向道路，修复需要 $P_i$ 的时间。可能有自环，可能有重边。$1 \le P_i \le 10^6$。

接下来 $Q$ 行，每行四个正整数 $L_i$、$R_i$、$K_i$、$C_i$，表示这次询问的点是 $[L_i,R_i]$ 区间中所有编号 $\bmod{K_i}=C_i$ 的点。保证参与询问的点至少有两个。
## 输出格式

输出 $Q$ 行，每行一个正整数表示对应询问的答案。
## 样例

### 样例输入 #1
```
7 10 4
1 3 10
2 6 9
4 1 5
3 7 4
3 6 9
1 5 8
2 7 4
3 2 10
1 7 6
7 6 9
1 7 1 0
1 7 3 1
2 5 1 0
3 7 2 1
```
### 样例输出 #1
```
9
6
8
8
```
## 提示

对于 $20\%$ 的数据，$N,M,Q \le 30$。

对于 $40\%$ 的数据，$N,M,Q \le 2000$。

对于 $100\%$ 的数据，$N \le 50000,M \le 2 \times 10^5,Q \le 50000.P_i \le 10^6.L_i,R_i,K_i$ 均在 $[1,N]$ 范围内，$C_i$ 在 $[0,K_i)$ 范围内。

时限 5 秒, 256M。

蓝桥杯 2015 年省赛 A 组 J 题。


---

---
title: "[蓝桥杯 2019 省 A] 组合数问题"
layout: "post"
diff: 省选/NOI-
pid: P8688
tag: ['2019', '数位 DP', 'Lucas 定理', '蓝桥杯省赛']
---
# [蓝桥杯 2019 省 A] 组合数问题
## 题目描述

给 $n,m,k$，求有多少对 $(i,j)$ 满足 $1 \le i \le n,0 \le j \le \min(i,m)$ 且 ${i\choose j} \equiv 0\pmod{k}$，$k$ 是质数。其中 ${i\choose j}$ 是组合数，表示从 $i$ 个不同的数中选出 $j$ 个组成一个集合的方案数。
## 输入格式

第一行两个数 $t,k$，其中 $t$ 代表该测试点包含 $t$ 组询问，$k$ 的意思与上文中相同。

接下来 $t$ 行每行两个整数 $n,m$，表示一组询问。
## 输出格式

输出 $t$ 行，每行一个整数表示对应的答案。由于答案可能很大，请输出答案除以 $10^9+7$ 的余数。
## 样例

### 样例输入 #1
```
1 2
3 3
```
### 样例输出 #1
```
1
```
### 样例输入 #2
```
2 5
4 5
6 7
```
### 样例输出 #2
```
0
7
```
### 样例输入 #3
```
3 23
23333333 23333333
233333333 233333333
2333333333 2333333333
```
### 样例输出 #3
```
851883128
959557926
680723120
```
## 提示

**【样例说明】**

在所有可能的情况中，只有 ${2 \choose 1}=2$ 是 $2$ 的倍数。

**【数据规模和约定】**

对于所有评测用例，$1 \le k \le 10^8,1 \le t \le 10^5,1 \le n,m \le 10^{18}$，且 $k$ 是质数。

评测时将使用 $10$ 个评测用例测试你的程序，每个评测用例的限制如下：

![](https://cdn.luogu.com.cn/upload/image_hosting/jb7e32a0.png)

蓝桥杯 2019 年省赛 A 组 J 题。


---

---
title: "[蓝桥杯 2020 省 AB3] 旅行家"
layout: "post"
diff: 省选/NOI-
pid: P8726
tag: ['动态规划 DP', '2020', '斜率优化', '蓝桥杯省赛', '李超线段树']
---
# [蓝桥杯 2020 省 AB3] 旅行家
## 题目描述

从前，在海上有 $n$ 个岛屿，编号 $1$ 至 $n$。居民们深受洋流困扰，无法到达比自己当前所在岛屿编号更小的岛屿。经过数年以后，岛屿上的人数随着岛屿的编号递增（可能相等）。作为一名出色的旅行家（$\mathrm{RP}$ 学家），你想从 $1$ 号岛屿出发开启一次旅程，以获得更多的 $\mathrm{RP}$，因为受到海洋的洋流影响，你只能去到比当前岛屿编号更大的岛屿。因为你比较善良，你会在离开一个岛屿的时候将你的 $\mathrm{RP}$ 分散给岛民，具体地：你的 $\mathrm{RP}$ 会除以 $2$（用去尾法取整，或者说向零取整）（当你的 $\mathrm{RP}$ 小于零时，岛民也依旧要帮你分担，毕竟你们已经建立起了深厚的友谊)。

第 $i$ 号岛屿有 $T_{i}$ 人，但是你很挑剔，每次你从 $j$ 号岛屿到达 $i$ 号岛屿时，你只会在到达的岛屿上做 $T_{i} \times T_{j}$ 件好事（一件好事可以获得 $1$ 点 $\mathrm{RP}$ )。

唯一不足的是，由于你在岛上住宿，劳民伤财，你会扣除巨量 RP，第 $i$ 号岛屿的住宿扣除 $F_{i}$ 点 $\mathrm{RP}$。

注意: 将离开一个岛屿时，先将 $\mathrm{RP}$ 扣除一半，再扣除住宿的 $\mathrm{RP}$，最后在新到达的岛屿上做好事，增加 $\mathrm{RP}$。离开 $1$ 号岛屿时需要扣除在 $1$ 号岛屿住宿的 $\mathrm{RP}$，当到达这段旅程的最后一个岛屿上时，要做完好事，行程才能结束，也就是说不用扣除在最后到达的岛屿上住宿的 $\mathrm{RP}$ 。

你因为热爱旅行（RP），所以从 $1$ 号岛屿开始旅行，初始时你有 $0$ 点 $\mathrm{RP}$。你希望选择一些岛屿经过，最终选择一个岛屿停下来，求最大的 $\mathrm{RP}$ 值是多少?
## 输入格式

输入的第一行包含一个数 $n$，表示岛屿的总数。

第二行包含 $n$ 个整数 $T_{1},T_{2},\cdots,T_{n}$，表示每个岛屿的人口数。

第三行包含 $n$ 个整数 $F_{1},F_{2},\cdots,F_{n}$，表示每个岛屿旅馆损失的 $\mathrm{RP}$。 

## 输出格式


输出一个数，表示最大获得的 $\mathrm{RP}$ 值。
## 样例

### 样例输入 #1
```
3
4 4 5
1 10 3
```
### 样例输出 #1
```
19
```
### 样例输入 #2
```
5
969 980 1013 1016 1021
888423 945460 865822 896150 946615
```
### 样例输出 #2
```
246172
```
## 提示

**【样例说明】**

从一号岛屿直接走到三号岛屿最优，初始 $0$ 点 $\mathrm{RP}$，扣除一半取整变成 $0$ 点。扣除在一号节点住宿的 $1 \mathrm{RP}$，在三号岛屿做好事产生 $4 \times 5=20$ 点 $\mathrm{RP}$。最终得到 $19$ 点 $R P$ 。

**【评测用例规模与约定】**

对于 $20 \%$ 的评测用例，$1 \leq n \leq 15$;

对于 $70 \%$ 的评测用例，$1 \leq n \leq 5000$;

对于所有评测用例，$1 \leq n \leq 5\times10^5,1 \leq T_{i} \leq 20000,1 \leq F_{i} \leq 2\times 10^8$。给定的 $T_{i}$ 已经按照升序排序。

建议使用 64 位有符号整数进行运算。

蓝桥杯 2020 第三轮省赛 AB 组 J 题。

Upd.2024.7.13 已添加hack数据


---

---
title: "[蓝桥杯 2021 省 A] 分果果"
layout: "post"
diff: 省选/NOI-
pid: P8746
tag: ['动态规划 DP', '2021', '枚举', '蓝桥杯省赛']
---
# [蓝桥杯 2021 省 A] 分果果
## 题目描述

小蓝要在自己的生日宴会上将 $n$ 包糖果分给 $m$ 个小朋友。每包糖果都要分出去，每个小朋友至少要分一包，也可以分多包。

小蓝已经提前将糖果准备好了，为了在宴会当天能把糖果分得更平均一些，小蓝要先计算好分配方案。

小蓝将糖果从 $1$ 到 $n$ 编号, 第 $i$ 包糖果重 $w_{i}$ 。小朋友从 $1$ 到 $m$ 编号。每个小朋友只能分到编号连续的糖果。小蓝想了很久没想出合适的分配方案使得每个小朋友分到的糖果差不多重。因此需要你帮他一起想办法。为了更好的分配糖果，他可以再买一些糖果，让某一些编号的糖果有两份。当某个编号的糖果有两份时，一个小朋友最多只能分其中的一份。

请找一个方案，使得小朋友分到的糖果的最大重量和最小重量的差最小，请输出这个差。

例如，小蓝现在有 5 包糖果, 重量分别为 $6,1,2,7,9$，如果小蓝要分给两个小朋友，则他可以将所有糖果再买一份，两个小朋友都分到 $1$ 至 $5$ 包糖果，重量都是 $25$, 差为 $0$。

再如，小蓝现在有 $5$ 包糖果, 重量分别为 $6,1,2,7,9$，如果小蓝要分给三个小朋友，则他可以将第 $3$ 包糖果再买一份，第一个小朋友分 $1$ 至 $3$ 包，第二个小朋友分 $3$ 至 $4$ 包，第三个小朋友分第 $5$ 包，每个小朋友分到的重量都是 $9$，差为 $0$。

再如, 小蓝现在有 5 包糖果, 重量分别为 $6,1,2,7,9$, 如果小蓝要分给四个小朋友，则他可以将第 $3$ 包和第 $5$ 包糖果再买一份, 仍然可以每个小朋友分到的重量都是 $9$，差为 $0$。

再如, 小蓝现在有 $5$ 包糖果, 重量分别为 $6,1,2,7,9$, 如果小蓝要分给五个小朋友, 则他可以将第 $4$ 包和第 $5$ 包糖果再买一份, 第一个小朋友分第 $1$ 至 $2$ 包重量为 $7$ , 第二个小朋友分第 $3$ 至 $4$ 包重量为 $9$, 第三个小朋友分第 $4$ 包重 量为 $7$, 第四个和第五个小朋友都分第 $5$ 包重量为 $9$。差为 $2$。
## 输入格式

输入第一行包含两个整数 $n$ 和 $m$, 分别表示糖果包数和小朋友数量。

第二行包含 $n$ 个整数 $w_{1}, w_{2}, \cdots, w_{n}$, 表示每包糖果的重量。
## 输出格式

输出一个整数, 表示在最优情况下小朋友分到的糖果的最大重量和最小重量的差。
## 样例

### 样例输入 #1
```
5 2
6 1 2 7 9
```
### 样例输出 #1
```
0
```
### 样例输入 #2
```
5 5
6 1 2 7 9
```
### 样例输出 #2
```
2
```
## 提示

对于 $30 \%$ 的评测用例, $1 \leq n \leq 10,1 \leq m \leq 10,1 \leq w_{i} \leq 10$;

对于 $60 \%$ 的评测用例, $1 \leq n \leq 30,1 \leq m \leq 20,1 \leq w_{i} \leq 30$;

对于所有评测用例, $1 \leq n \leq 100,1 \leq m \leq 50,1 \leq w_{i} \leq 100$ 。在评测数据 中, $w_{i}$ 随机生成, 在某个区间均匀分布。

蓝桥杯 2021 第一轮省赛 A 组 J 题。


---

---
title: "[蓝桥杯 2021 省 B] 双向排序"
layout: "post"
diff: 省选/NOI-
pid: P8747
tag: ['2021', '蓝桥杯省赛', 'Ad-hoc']
---
# [蓝桥杯 2021 省 B] 双向排序
## 题目描述

给定序列 $\left(a_{1}, a_{2}, \cdots, a_{n}\right)=(1,2, \cdots, n)$，即 $a_{i}=i$ 。

小蓝将对这个序列进行 $m$ 次操作，每次可能是将 $a_{1}, a_{2}, \cdots, a_{q_{i}}$ 降序排列，或者将 $a_{q_{i}}, a_{q_{i}+1}, \cdots, a_{n}$ 升序排列。

请求出操作完成后的序列。
## 输入格式

输入的第一行包含两个整数 $n, m$，分别表示序列的长度和操作次数。

接下来 $m$ 行描述对序列的操作，其中第 $i$ 行包含两个整数 $p_{i}, q_{i}$ 表示操作类型和参数。

当 $p_{i}=0$ 时，表示将 $a_{1}, a_{2}, \cdots, a_{q_{i}}$ 降序排列;

当 $p_{i}=1$ 时，表示将 $a_{q_{i}}, a_{q_{i}+1}, \cdots, a_{n}$ 升序排列。
## 输出格式

输出一行，包含 $n$ 个整数，相邻的整数之间使用一个空格分隔，表示操作完成后的序列。
## 样例

### 样例输入 #1
```
3 3
0 3
1 2
0 2
```
### 样例输出 #1
```
3 1 2
```
## 提示

**【样例说明】**

原数列为 $(1,2,3)$。

第 1 步后为 $(3,2,1)$。

第 2 步后为 $(3,1,2)$。

第 3 步后为 $(3,1,2)$。与第 2 步操作后相同, 因为前两个数已经是降序了。

**【评测用例规模与约定】**

对于 $30 \%$ 的评测用例, $n, m \leq 1000$;

对于 $60 \%$ 的评测用例, $n, m \leq 5000$;

对于所有评测用例, $1 \leq n, m \leq 10^5,0 \leq p_{i} \leq 1,1 \leq q_{i} \leq n$ 。 

蓝桥杯 2021 第一轮省赛 B 组 I 题。


---

---
title: "[蓝桥杯 2021 省 A2] 完美序列"
layout: "post"
diff: 省选/NOI-
pid: P8757
tag: ['2021', '组合数学', '蓝桥杯省赛']
---
# [蓝桥杯 2021 省 A2] 完美序列
## 题目描述

一个序列中取出一些元素按照原来的顺序排列成新的序列称为该序列的一个子序列。子序列的价值为子序列中所有元素的和。

如果一个序列是单调递减的，而且除了第一个数以外的任何一个数都是上一个数的因数，则称这个序列为一个完美序列。

一个序列中的一个子序列如果是完美序列，则称为该序列的一个完美子序列。一个序列的最长完美子序列长度，称为该序列的完美长度。

给定正整数 $n$，$1$ 至 $n$ 的所有排列的完美长度的最大值，称为 $n$ 阶最大完美长度。

给定正整数 $n$，请求出 $1$ 至 $n$ 的所有排列中长度正好为 $n$ 阶最大完美长度的所有完美子序列的价值的和。

## 输入格式

每个评测用例包含多组询问。询问之间彼此独立。

输入的第一行包含一个整数 $T$, 表示询问数。

接下来 $T$ 行, 每行包含一个整数 $n$, 表示一个给定的 $n$ 。
## 输出格式

输出 $T$ 行，依次对应每组询问的答案。

每行包含一个整数，表示对应的答案除以 $1000000007$（即 $10^{9}+7$）的余数。

## 样例

### 样例输入 #1
```
5
1
2
3
5
10
```
### 样例输出 #1
```
1
3
21
140
2268000
```
## 提示

**【样例说明】**

当 $n=1$ 时，答案显然是 $1$ 。

当 $n=2$ 时, 全排列包括 $(1,2)$ 和 $(2,1)$, 其中 $(2,1)$ 拥有最长的完美子序列, 也就是 $(2,1)$ 本身, $2$ 阶最大完美长度为 $2$，答案即为 $2+1$ 。

当 $n=3$ 时，全排列包括 $(1,2,3)$、$(1,3,2)$、$(2,1,3)$、$(2,3,1)$、$(3,1,2)$、$(3,2,1)$ 。其中 $(2,1)$ 和 $(3,1)$ 都是最长的完美子序列，$3$ 阶最大完美长度为 $2$。

序列 $(1,2,3)$ 和 $(1,3,2)$ 中没有长度为 $2$ 的完美子序列。

序列 $(2,1,3)$ 中有完美子序列 $(2,1)$，价值和为 $3$。

序列 $(2,3,1)$ 中有完美子序列 $(2,1)$ 和 $(3,1)$，价值和为 $7$。

序列 $(3,1,2)$ 中有完美子序列 $(3,1)$，价值和为 $4$。

序列 $(3,2,1)$ 中有完美子序列 $(2,1)$ 和 $(3,1)$,价值和为 $7$。

答案为 $3+7+4+7=21$ 。

**【评测用例规模与约定】**

对于 $10 \%$ 的评测用例，$n \leq 10$;

对于 $20 \%$ 的评测用例，$n \leq 20$;

对于 $30 \%$ 的评测用例，$T \leq 20, n \leq 1000$;

对于 $40 \%$ 的评测用例，$T \leq 20, n \leq 10^{5}$;

对于所有评测用例，$1 \leq T \leq 10^{5}, 1 \leq n \leq 10^{6}$。

蓝桥杯 2021 第二轮省赛 A 组 J 题。


---

---
title: "[蓝桥杯 2023 省 A] 像素放置"
layout: "post"
diff: 省选/NOI-
pid: P9237
tag: ['2023', 'O2优化', '插头 DP', '蓝桥杯省赛']
---
# [蓝桥杯 2023 省 A] 像素放置
## 题目描述

小蓝最近迷上了一款名为《像素放置》的游戏，游戏在一个 $n \times m$ 的网格棋盘上进行，棋盘含有 $n$ 行，每行包含 $m$ 个方格。玩家的任务就是需要对这 $n \times m$ 个方格进行像素填充，填充颜色只有黑色或白色两种。有些方格中会出现一个整数数字 $x(0 \leq x \leq 9)$，这表示当前方格加上周围八个方向上相邻的方格（分别是上方、下方、左方、右方、左上方、右上方、左下方、右下方）共九个方格内有且仅有 $x$ 个方格需要用黑色填充。

玩家需要在满足所有数字约束下对网格进行像素填充，请你帮助小蓝来完成。题目保证所有数据都有解并且解是唯一的。
## 输入格式

输入的第一行包含两个整数 $n,m$，用一个空格分隔，表示棋盘大小。

接下来 $n$ 行，每行包含 $m$ 个字符，表示棋盘布局。字符可能是数字 $0 \sim 9$，这表示网格上的数字；字符还有可能是下划线（$\text{ASCII}$ 码为 $95$），表示一个不带有数字的普通网格。
## 输出格式

输出 $n$ 行，每行包含 $m$ 个字符，表示答案。如果网格填充白色则用字符 $0$ 表示，如果网格填充黑色则用字符 $1$ 表示。
## 样例

### 样例输入 #1
```
6 8
_1__5_1_
1_4__42_
3__6__5_
___56___
_688___4
_____6__
```
### 样例输出 #1
```
00011000
00111100
01000010
11111111
01011110
01111110
```
## 提示

#### 【样例说明】

![image](https://cdn.luogu.com.cn/upload/image_hosting/v8u2zzne.png)

上图左是样例数据对应的棋盘布局，上图右是此局游戏的解。例如第 $3$ 行第 $1$ 列处的方格中有一个数字 $3$，它周围有且仅有 $3$ 个格子被黑色填充，分别是第 $3$ 行第 $2$ 列、第 $4$ 行第 $1$ 列和第 $4$ 行第 $2$ 列的方格。

#### 【评测用例规模与约定】

对于 $50 \%$ 的评测用例，$1 \leq n,m \leq 5$；

对于所有评测用例，$1 \leq n,m \leq 10$。


---

---
title: "[蓝桥杯 2023 省 A] 翻转硬币"
layout: "post"
diff: 省选/NOI-
pid: P9238
tag: ['2023', 'O2优化', '素数判断,质数,筛法', '蓝桥杯省赛']
---
# [蓝桥杯 2023 省 A] 翻转硬币
## 题目描述

给定 $n$ 个按顺序摆好的硬币，一开始只有第 $1$ 个硬币朝下，其他硬币均朝上。你每次操作可以选择任何一个整数 $i$ 并将所有满足 $j \bmod i=0$ 的位置 $j$ 的硬币翻转。

求最少需要多少次操作可以让所有硬币都朝上。
## 输入格式

输入一行包含一个整数 $n$。
## 输出格式

输出一行包含一个整数表示最少需要的操作次数。
## 样例

### 样例输入 #1
```
7
```
### 样例输出 #1
```
6
```
### 样例输入 #2
```
1131796
```
### 样例输出 #2
```
688042
```
## 提示

#### 【评测用例规模与约定】

对于 $30 \%$ 的评测用例，$n \leq 5 \times 10^6$；

对于 $70 \%$ 的评测用例，$n \leq 10^9$；

对于所有评测用例，$1 \leq n \leq 10^{18}$。


---


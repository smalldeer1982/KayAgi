---
title: "[YDOI R1] Lattice"
layout: "post"
diff: 省选/NOI-
pid: P10186
tag: ['数论', '素数判断,质数,筛法', '莫比乌斯反演', '杜教筛']
---
# [YDOI R1] Lattice
## 题目背景

se 喜欢点阵。
## 题目描述

se 有一个正方形点阵，这个点阵以 $(1,1)$ 为左下角，以 $(n,n)$ 为右上角。

se 还有一条直线，其表达式为 $y=kx$，其中 $k\in(0,\infty)$。

对于任意一个 $k$，设该直线经过了 $cnt$ 个点阵中的点，se 对这条直线有一个喜爱程度，为 $cnt^2$。

se 想知道所有直线的喜爱程度和对 $10^9+7$ 取模的结果，请你告诉 se。
## 输入格式

一行一个整数 $n$。
## 输出格式

输出一个整数，表示喜爱程度和对 $10^9+7$ 取模的结果。
## 样例

### 样例输入 #1
```
2
```
### 样例输出 #1
```
6
```
### 样例输入 #2
```
1919810
```
### 样例输出 #2
```
107114211
```
## 提示

### 样例解释 #1
当 $k$ 为 $\frac{1}{2}$ 时，直线过点阵中的点 $(2,1)$，喜爱程度为 $1^2=1$；当 $k$ 为 $1$ 时，直线过点阵中的点 $(1,1)$ 和点 $(2,2)$，喜爱程度为 $2^2=4$；当 $k$ 为 $2$ 时，直线过点阵中的点 $(1,2)$，喜爱程度为 $1^2=1$。喜爱程度和为 $1+4+1=6$。
### 数据范围
**本题采用捆绑测试**。
|子任务编号|$n\le$|分值|
|:--:|:--:|:--:|
|$1$|$8$|$5$|
|$2$|$10^3$|$15$|
|$3$|$10^6$|$30$|
|$4$|$2^{31}-1$|$50$|

对于 $100\%$ 的数据，$1\le n\le 2^{31}-1$。


---

---
title: "实力派"
layout: "post"
diff: 省选/NOI-
pid: P10269
tag: ['数论', '素数判断,质数,筛法', '最大公约数 gcd', '莫比乌斯反演']
---
# 实力派
## 题目背景

![](https://cdn.luogu.com.cn/upload/image_hosting/z8ednvb2.png)
## 题目描述

来自全国各地的 $n$ 位 OIer 组成了一个名为“实力派”的团队，每个人有一个实力值 $a_i$。共有 $m$ 场比赛向他们发送了参赛邀请，其中第 $i$ 场比赛要求 $k_i$ 个人组成一个队伍参加。为了决定他们是否应该参加某场比赛，他们想出了如下两个衡量实力的数据：

- 定义 $x$ 阶最低实力表示从这 $n$ 个人中选出 $x$ 个人，使得这 $x$ 个人实力值的 $\gcd=1$ 的方案数；

- 定义 $x$ 阶最高实力表示从这 $n$ 个人中选出 $x$ 个人，所有方案的 $x$ 个人的 $\gcd$ 之和。

请你对于每场比赛，告诉他们他们在这场比赛中的 $k_i$ 阶最低实力和最高实力。对了，为了不让别人听懂，你需要将答案对一个秘密模数 $p$ 取模。
## 输入格式

第一行三个整数 $n,m,p$，分别表示团队人数，比赛场数及秘密模数；

第二行 $n$ 个整数，第 $i$ 个整数表示第 $i$ 个人的实力值 $a_i$。

接下来 $m$ 行，第 $i$ 行一个整数 $k_i$，表示第 $i$ 场比赛的要求参赛人数。
## 输出格式

输出共 $m$ 行，第 $i$ 行两个整数 $min_i,max_i$，分别表示他们在第 $i$ 场比赛中的最低实力和最高实力，答案对 $p$ 取模。
## 样例

### 样例输入 #1
```
4 4 998244353
8 15 12 6
2
3
4
5
```
### 样例输出 #1
```
1 19
2 7
1 1
0 0
```
### 样例输入 #2
```
6 4 19260817
11 45 14 19 19 810
2
1
2
2
```
### 样例输出 #2
```
12 78
0 918
12 78
12 78
```
### 样例输入 #3
```
8 3 19491001
3 2 2 3 1 2 1 2
5
3
4
```
### 样例输出 #3
```
56 56
52 60
69 71
```
## 提示

**样例** $\mathbf{1}$ **解释**

第一场比赛要求选出 $2$ 人参加，仅有 $(8,15)$ 一种方案的 $\gcd=1$，因此最低实力为 $1$；所有方案的 $\gcd$ 之和为 $19$，因此最高实力为 $19$；

第二场比赛要求选出 $3$ 人参加，有 $(8,15,12)$ 和 $(8,15,6)$ 两种 $\gcd=1$ 的方案，因此最低实力为 $2$；所有方案的 $\gcd$ 之和为 $7$，因此最高实力为 $7$。

**数据范围**

对于所有数据，$1\leq n,m,k_i\leq 2\times 10^5$，$1\leq a_i\leq 10^6$，$10^7\leq p\leq 10^9$，$p\in \mathbb{P}$。

本题共 $30$ 个测试点，**采用捆绑测试**，子任务及数据点分配如下：

| 子任务编号 | 数据点编号 | 特殊性质 | 分值 | 时限 |
| :-: | :-: | :-: | :-: | :-: |
| $0$ | $1\sim 4$ | $n\leq 20$ | $10$ | $1s$ |
| $1$ | $5\sim 8$ | $n,a_i\leq 300$ | $10$ | $1s$ | 
| $2$ | $9\sim 12$ | $k_i\leq 2$ | $20$ | $1.5s$ |
| $3$ | $13\sim 16$ | $a_i\leq 3$ | $10$ | $1s$ |
| $4$ | $17\sim 22$ | $a_i\leq 10^5$ | $20$ | $1s$ |
| $5$ | $23\sim 30$ | 无特殊性质 | $30$ | $1.5s$ |

**提示**

$\mathbb{P}$ 表示全体质数集合，$\gcd$ 表示最大公因数。


---

---
title: "[NOI2015] 寿司晚宴"
layout: "post"
diff: 省选/NOI-
pid: P2150
tag: ['动态规划 DP', '数学', '2015', 'NOI', '素数判断,质数,筛法', '状压 DP']
---
# [NOI2015] 寿司晚宴
## 题目描述

为了庆祝 NOI 的成功开幕，主办方为大家准备了一场寿司晚宴。小 G 和小 W 作为参加 NOI 的选手，也被邀请参加了寿司晚宴。

在晚宴上，主办方为大家提供了 $n−1$ 种不同的寿司，编号 $1,2,3,\ldots,n-1$，其中第 $i$ 种寿司的美味度为 $i+1$。（即寿司的美味度为从 $2$ 到 $n$）

现在小 G 和小 W 希望每人选一些寿司种类来品尝，他们规定一种品尝方案为不和谐的当且仅当：小 G 品尝的寿司种类中存在一种美味度为 $x$ 的寿司，小 W 品尝的寿司中存在一种美味度为 $y$ 的寿司，而 $x$ 与 $y$ 不互质。

现在小 G 和小 W 希望统计一共有多少种和谐的品尝寿司的方案（对给定的正整数 $p$ 取模）。注意一个人可以不吃任何寿司。

## 输入格式

输入文件的第 $1$ 行包含 $2$ 个正整数 $n, p$ 中间用单个空格隔开，表示共有 $n$ 种寿司，最终和谐的方案数要对 $p$ 取模。

## 输出格式

输出一行包含 $1$ 个整数，表示所求的方案模 $p$ 的结果。

## 样例

### 样例输入 #1
```
3 10000
```
### 样例输出 #1
```
9
```
### 样例输入 #2
```
4 10000
```
### 样例输出 #2
```
21
```
### 样例输入 #3
```
100 100000000
```
### 样例输出 #3
```
3107203
```
## 提示

【数据范围】


 ![](https://cdn.luogu.com.cn/upload/pic/1506.png) 


**勘误：$0 < p \le 10^9 $**


---

---
title: "[SDOI2010] 古代猪文"
layout: "post"
diff: 省选/NOI-
pid: P2480
tag: ['数学', '2010', '各省省选', '山东', 'O2优化', '素数判断,质数,筛法', '中国剩余定理 CRT']
---
# [SDOI2010] 古代猪文
## 题目背景

“在那山的那边海的那边有一群小肥猪。他们活泼又聪明，他们调皮又灵敏。他们自由自在生活在那绿色的大草坪，他们善良勇敢相互都关心……”

——选自猪王国民歌


很久很久以前，在山的那边海的那边的某片风水宝地曾经存在过一个猪王国。猪王国地理位置偏僻，实施的是适应当时社会的自给自足的庄园经济，很少与外界联系，商贸活动就更少了。因此也很少有其他动物知道这样一个王国。

猪王国虽然不大，但是土地肥沃，屋舍俨然。如果一定要拿什么与之相比的话，那就只能是东晋陶渊明笔下的大家想象中的桃花源了。猪王勤政爱民，猪民安居乐业，邻里和睦相处，国家秩序井然，经济欣欣向荣，社会和谐稳定。和谐的社会带给猪民们对工作火红的热情和对未来的粉色的憧憬。

小猪iPig是猪王国的一个很普通的公民。小猪今年10岁了，在大肥猪学校上小学三年级。和大多数猪一样，他不是很聪明，因此经常遇到很多或者稀奇古怪或者旁人看来轻而易举的事情令他大伤脑筋。小猪后来参加了全猪信息学奥林匹克竞赛(Pig Olympiad in Informatics, POI)，取得了不错的名次，最终保送进入了猪王国大学(Pig Kingdom University, PKU)深造。

现在的小猪已经能用计算机解决简单的问题了，比如能用P++语言编写程序计算出A + B的值。这个“成就”已经成为了他津津乐道的话题。当然，不明真相的同学们也开始对他刮目相看啦~

小猪的故事就将从此展开，伴随大家两天时间，希望大家能够喜欢小猪。

## 题目描述

猪王国的文明源远流长，博大精深。

iPig 在大肥猪学校图书馆中查阅资料，得知远古时期猪文文字总个数为 $n$。当然，一种语言如果字数很多，字典也相应会很大。当时的猪王国国王考虑到如果修一本字典，规模有可能远远超过康熙字典，花费的猪力、物力将难以估量。故考虑再三没有进行这一项劳猪伤财之举。当然，猪王国的文字后来随着历史变迁逐渐进行了简化，去掉了一些不常用的字。

iPig 打算研究古时某个朝代的猪文文字。根据相关文献记载，那个朝代流传的猪文文字恰好为远古时期的 $1/k$，其中 $k$ 是 $n$ 的一个正约数（可以是 $1$ 或 $n$）。不过具体是哪 $1/k$，以及 $k$ 是多少，由于历史过于久远，已经无从考证了。

iPig 觉得只要符合文献，每一种 $k|n$ 都是有可能的。他打算考虑到所有可能的 $k$。显然当 $k$ 等于某个定值时，该朝的猪文文字个数为 $n/k$。然而从 $n$ 个文字中保留下 $n/k$ 个的情况也是相当多的。iPig 预计，如果所有可能的 $k$ 的所有情况数加起来为 $p$ 的话，那么他研究古代文字的代价将会是 $g^p$。

现在他想知道猪王国研究古代文字的代价是多少。由于 iPig 觉得这个数字可能是天文数字，所以你只需要告诉他答案除以 $999911659$ 的余数就可以了。

## 输入格式

一行两个正整数 $n,g$。

## 输出格式

输出一行一个整数表示答案。
## 样例

### 样例输入 #1
```
4 2
```
### 样例输出 #1
```
2048
```
## 提示

#### 数据规模与约定
- 对于 $10\%$ 的数据，$1\le n \le 50$；  
- 对于 $20\%$ 的数据，$1\le n \le 1000$；  
- 对于 $40\%$ 的数据，$1\le n \le 10^5$；  
- 对于 $100\%$ 的数据，$1\le n,g \le 10^9$。



---

---
title: "[ZJOI2009] 染色游戏"
layout: "post"
diff: 省选/NOI-
pid: P2594
tag: ['递推', '博弈论', '2009', '各省省选', '浙江', '素数判断,质数,筛法', 'SG 函数']
---
# [ZJOI2009] 染色游戏
## 题目描述

一共n × m 个硬币，摆成n × m 的长方形。dongdong 和xixi 玩一个游戏， 每次可以选择一个连通块，并把其中的硬币全部翻转，但是需要满足存在一个 硬币属于这个连通块并且所有其他硬币都在它的左上方(可以正左方也可以正 上方)，并且这个硬币是从反面向上翻成正面向上。dongdong 和xixi 轮流操作。 如果某一方无法操作，那么他(她) 就输了。dongdong 先进行第一步操作，假 设双方都采用最优策略。问dongdong 是否有必胜策略。

## 输入格式

第一行一个数T，表示他们一共玩T 局游戏。接下来是T 组游戏描述。每 组游戏第一行两个数n;m，接下来n 行每行m 个字符，第i 行第j 个字符如 果是“H” 表示第i 行第j 列的硬币是正面向上，否则是反面向上。第i 行j 列 的左上方是指行不超过i 并且列不超过j 的区域。

## 输出格式

对于每局游戏，输出一行。如果dongdong 存在必胜策略则输出“-\_-”(不含 引号) 否则输出“=\_=”(不含引号)。(注意输出的都是半角符号，即三个符号 ASCII 码分别为45,61,95)

## 样例

### 样例输入 #1
```
3
2 3
HHH
HHH
2 3
HHH
TTH
2 1
T
H
```
### 样例输出 #1
```
=_=
-_-
-_-
```
## 提示

对于40% 的数据，满足1 ≤ n;m ≤ 5。

对于100% 的数据，满足1 ≤ n;m ≤ 100，1 ≤ T ≤ 50。



---

---
title: "[USACO08DEC] Largest Fence G"
layout: "post"
diff: 省选/NOI-
pid: P2924
tag: ['数学', '2008', 'USACO', '素数判断,质数,筛法', '凸包']
---
# [USACO08DEC] Largest Fence G
## 题目描述

Farmer John has purchased N (5 <= N <= 250) fence posts in order to build a very nice-looking fence. Everyone knows the best fences are convex polygons where fence posts form vertices of a polygon. The pasture is represented as a rectilinear grid; fencepost i is at integer coordinates (x\_i, y\_i) (1 <= x\_i <= 1,000; 1 <= y\_i <= 1000).

Given the locations of N fence posts (which, intriguingly, feature no set of three points which are collinear), what is the largest number of fence posts FJ can use to create a fence that is convex?

For test cases worth 45% of the points for this problem, N <= 65.

Time limit: 1.2 seconds

POINTS: 400

Farmer John的农场里有N（5<=N<=250）个篱笆桩，每个都有独一无二的坐标(xi,yi)（1<=xi,yi<=1000）。他想选择尽量多的篱笆桩来构建他的围栏。这个围栏要美观，所以必须是凸多边形的。那他最多能选多少个呢？

所有的篱笆桩中不存在三点共线。

## 输入格式

\* Line 1: A single integer: N

\* Lines 2..N+1: Line i+1 describes fence post i's location with two space-separated integers: x\_i and y\_i

## 输出格式

\* Line 1: A single integer, the maximum possible number of fence posts that form a convex polygon.

## 样例

### 样例输入 #1
```
6 
5 5 
2 3 
3 2 
1 5 
5 1 
1 1 

```
### 样例输出 #1
```
5 

```
## 提示

A square with two points inside.


The largest convex polygon is the pentagon (2,3), (3,2), (5,1), (5,5), (1,5).



---

---
title: "[HNOI2009] 有趣的数列"
layout: "post"
diff: 省选/NOI-
pid: P3200
tag: ['2009', '湖南', '素数判断,质数,筛法', 'Catalan 数', '栈']
---
# [HNOI2009] 有趣的数列
## 题目描述

我们称一个长度为 $2n$ 的数列是有趣的，当且仅当该数列满足以下三个条件：

- 它是从 $1 \sim 2n$ 共 $2n$ 个整数的一个排列 $\{a_n\}_{n=1}^{2n}$；

- 所有的奇数项满足 $a_1<a_3< \dots < a_{2n-1}$，所有的偶数项满足 $a_2<a_4< \dots <a_{2n}$；

- 任意相邻的两项 $a_{2i-1}$ 与 $a_{2i}$ 满足：$a_{2i-1}<a_{2i}$。

对于给定的 $n$，请求出有多少个不同的长度为 $2n$ 的有趣的数列。  
因为最后的答案可能很大，所以只要求输出答案对 $p$ 取模。

## 输入格式

一行两个正整数 $n,p$
## 输出格式

输出一行一个整数表示答案。

## 样例

### 样例输入 #1
```
3 10
```
### 样例输出 #1
```
5
```
## 提示

【数据范围】   
对于 $50\%$ 的数据，$1\le n \le 1000$；  
对于 $100\%$ 的数据，$1\le n \le 10^6$，$1\le p \le 10^9$。

【样例解释】   
对应的5个有趣的数列分别为（1,2,3,4,5,6），（1,2,3,5,4,6），（1,3,2,4,5,6），（1,3,2,5,4,6），（1,4,2,5,3,6）。


---

---
title: "[SDOI2015] 序列统计"
layout: "post"
diff: 省选/NOI-
pid: P3321
tag: ['2015', '山东', '素数判断,质数,筛法', '快速傅里叶变换 FFT']
---
# [SDOI2015] 序列统计
## 题目描述

小C有一个集合 $S$，里面的元素都是小于 $m$ 的非负整数。他用程序编写了一个数列生成器，可以生成一个长度为 $n$ 的数列，数列中的每个数都属于集合 $S$。  

小C用这个生成器生成了许多这样的数列。但是小C有一个问题需要你的帮助：给定整数 $x$，求所有可以生成出的，且满足数列中所有数的乘积 $\bmod \ m$ 的值等于 $x$ 的不同的数列的有多少个。  

小C认为，两个数列 $A$ 和 $B$ 不同，当且仅当 $\exists i \text{ s.t. } A_i \neq B_i$。另外，小C认为这个问题的答案可能很大，因此他只需要你帮助他求出答案对 $1004535809$ 取模的值就可以了。

## 输入格式

一行，四个整数，$n,m,x,|S|$，其中 $|S|$ 为集合 $S$ 中元素个数。  
第二行，$|S|$ 个整数，表示集合 $S$ 中的所有元素。

## 输出格式

一行一个整数表示答案。

## 样例

### 样例输入 #1
```
4 3 1 2
1 2
```
### 样例输出 #1
```
8
```
## 提示

【样例说明】

可以生成的满足要求的不同的数列有(1,1,1,1)、(1,1,2,2)、(1,2,1,2)、(1,2,2,1)、(2,1,1,2)、(2,1,2,1)、(2,2,1,1)、(2,2,2,2)。

【数据规模和约定】

对于 $10\%$ 的数据，$1\le n \le 1000$；   
对于 $30\%$ 的数据，$3 \le m \le 100$；    
对于 $60\%$ 的数据，$3 \le m \le 800$；   
对于 $100\%$ 的数据，$1 \le n \le 10^9$，$3 \le m \le 8000$，$1\le x < m$。   
$m$ 为质数，输入数据保证集合 $S$ 中元素不重复。



---

---
title: "[POI 2010] NAJ-Divine Divisor"
layout: "post"
diff: 省选/NOI-
pid: P3499
tag: ['数学', '2010', 'POI（波兰）', '素数判断,质数,筛法']
---
# [POI 2010] NAJ-Divine Divisor
## 题目描述

An integer ![](http://main.edu.pl/images/OI17/naj-en-tex.1.png) is given.

We say that an integer ![](http://main.edu.pl/images/OI17/naj-en-tex.2.png) is a divisor of ![](http://main.edu.pl/images/OI17/naj-en-tex.3.png) with multiplicity ![](http://main.edu.pl/images/OI17/naj-en-tex.4.png)    (![](http://main.edu.pl/images/OI17/naj-en-tex.5.png) is integer) if ![](http://main.edu.pl/images/OI17/naj-en-tex.6.png) and ![](http://main.edu.pl/images/OI17/naj-en-tex.7.png) does not divide ![](http://main.edu.pl/images/OI17/naj-en-tex.8.png).

For example, the number ![](http://main.edu.pl/images/OI17/naj-en-tex.9.png) has the following divisors:

2 with multiplicity 4, 3 with multiplicity 1, 4 with multiplicity 2, 6 with multiplicity 1, and so on.

We say that a number ![](http://main.edu.pl/images/OI17/naj-en-tex.10.png) is a  divine divisor of the number ![](http://main.edu.pl/images/OI17/naj-en-tex.11.png)    if ![](http://main.edu.pl/images/OI17/naj-en-tex.12.png) is a divisor of ![](http://main.edu.pl/images/OI17/naj-en-tex.13.png) with multiplicity ![](http://main.edu.pl/images/OI17/naj-en-tex.14.png) and ![](http://main.edu.pl/images/OI17/naj-en-tex.15.png) has no divisors    with multiplicities greater than ![](http://main.edu.pl/images/OI17/naj-en-tex.16.png).

For example, the sole divine divisor of 48 is 2 (with multiplicity 4),    and the divine divisors of 6 are: 2, 3 and 6 (each with multiplicity 1).

Your task is to determine the multiplicity of divine divisors of ![](http://main.edu.pl/images/OI17/naj-en-tex.17.png)    and the number of its divine divisors.

给定一个正整数 $m$ 以及长度为 $m$ 的正整数序列  $a$ ,同时给出  $n = \prod_{i=1}^{m}{a_i}$。你需要找出一个最大的 $k$ 使得存在一个 $d$ , $d > 1$ 并且 $d^k | n$。求这个最大的 $k$ 以及在 $k$ 最大的情况下有多少个 $d$ 满足条件。
## 输入格式

The number ![](http://main.edu.pl/images/OI17/naj-en-tex.18.png) is given on the standard input, though in a somewhat unusual way.

The first line holds a single integer ![](http://main.edu.pl/images/OI17/naj-en-tex.19.png) (![](http://main.edu.pl/images/OI17/naj-en-tex.20.png)).

The second line holds ![](http://main.edu.pl/images/OI17/naj-en-tex.21.png) integers ![](http://main.edu.pl/images/OI17/naj-en-tex.22.png) (![](http://main.edu.pl/images/OI17/naj-en-tex.23.png))    separated by single spaces.

These denote that ![](http://main.edu.pl/images/OI17/naj-en-tex.24.png).

## 输出格式

The first line of the standard output should hold the maximum integer ![](http://main.edu.pl/images/OI17/naj-en-tex.25.png)    such that there exists a divisor ![](http://main.edu.pl/images/OI17/naj-en-tex.26.png) of ![](http://main.edu.pl/images/OI17/naj-en-tex.27.png) such that ![](http://main.edu.pl/images/OI17/naj-en-tex.28.png).

The second line should hold a single integer ![](http://main.edu.pl/images/OI17/naj-en-tex.29.png) that is the number of    (divine) divisors of ![](http://main.edu.pl/images/OI17/naj-en-tex.30.png) with multiplicity ![](http://main.edu.pl/images/OI17/naj-en-tex.31.png).

## 样例

### 样例输入 #1
```
3
4 3 4
```
### 样例输出 #1
```
4
1
```
## 提示

$1\le m\le 600$，且$\forall 1\le i\le m$，有$1\le a_i\le 10^{18}$



---

---
title: "小清新数学题"
layout: "post"
diff: 省选/NOI-
pid: P3653
tag: ['O2优化', '枚举', '素数判断,质数,筛法', '前缀和']
---
# 小清新数学题
## 题目背景

**本题时限 3s**

友情提示：https://www.luogu.com.cn/problem/P3601

## 题目描述

题目还是简单一点好。


我们定义莫比乌斯函数 $\mu(x)$，如果 $x$ 的每个素因子只出现一次，有 $p$ 个素因子，那么 $\mu(x)=(-1)^p$，否则 $\mu(x)=0$。


这题要求你求出 $\sum_{i=l}^r \mu(i)$。

## 输入格式

一行两个整数 $l,r$。

## 输出格式

一行一个整数表示答案。

## 样例

### 样例输入 #1
```
1 233
```
### 样例输出 #1
```
-1
```
### 样例输入 #2
```
99999999999899999 99999999999999999
```
### 样例输出 #2
```
421
```
## 提示

对于 $10\%$ 的数据，$l,r \leq 10^6$。

对于 $30\%$ 的数据，$l,r \leq 10^{12}$。

对于 $100\%$ 的数据，$1 \leq l \leq r \leq 10^{18}$，$r-l \leq 10^5$。



---

---
title: "[六省联考 2017] 相逢是问候"
layout: "post"
diff: 省选/NOI-
pid: P3747
tag: ['数学', '2017', '线段树', '各省省选', 'O2优化', '素数判断,质数,筛法']
---
# [六省联考 2017] 相逢是问候
## 题目描述

> Informatik verbindet dich und mich.  
> 信息将你我连结。

B 君希望以维护一个长度为 $n$ 的数组，这个数组的下标为从 $1$ 到 $n$ 的正整数。

一共有 $m$ 个操作，可以分为两种：

- `0 l r` 表示将第 $l$ 个到第 $r$ 个数（ $a_l,a_{l+1} ...a_r$）中的每一个数 $a_i$ 替换为 $c^{a_i}$，即 $c$ 的 $a_i$ 次方，其中 $c$ 是输入的一个常数，也就是执行赋值 $a_i = c^{a_i}$。

- `1 l r` 求第 $l$ 个到第 $r$ 个数的和，也就是输出： $\sum_{i=l}^{r}a_i$

因为这个结果可能会很大，所以你只需要输出结果 $\bmod \space p$ 的值即可。

## 输入格式

第一行有四个整数 $n, m, p, c$，所有整数含义见问题描述。  
接下来一行 $n$ 个整数，表示 $a$ 数组的初始值。  
接下来 $m$ 行，每行三个整数，其中第一个整数表示了操作的类型。  

- 如果是 $0$ 的话，表示这是一个修改操作，操作的参数为 $l, r$。
- 如果是 $1$ 的话，表示这是一个询问操作，操作的参数为 $l, r$。


## 输出格式

对于每个询问操作，输出一行，包括一个整数表示答案 $\bmod \space p$ 的值。

## 样例

### 样例输入 #1
```
4 4 7 2
1 2 3 4
0 1 4
1 2 4
0 1 4
1 1 3
```
### 样例输出 #1
```
0
3
```
### 样例输入 #2
```
1 40 19910626 2
0
0 1 1
1 1 1
0 1 1
1 1 1
0 1 1
1 1 1
0 1 1
1 1 1
0 1 1
1 1 1
0 1 1
1 1 1
0 1 1
1 1 1
0 1 1
1 1 1
0 1 1
1 1 1
0 1 1
1 1 1
0 1 1
1 1 1
0 1 1
1 1 1
0 1 1
1 1 1
0 1 1
1 1 1
0 1 1
1 1 1
0 1 1
1 1 1
0 1 1
1 1 1
0 1 1
1 1 1
0 1 1
1 1 1
0 1 1
1 1 1
```
### 样例输出 #2
```
1
2
4
16
65536
11418102
18325590
13700558
13700558
13700558
13700558
13700558
13700558
13700558
13700558
13700558
13700558
13700558
13700558
13700558
```
## 提示

【数据范围】  

对于 $0\%$ 的测试点，和样例一模一样；

对于另外 $10\%$ 的测试点，没有修改；

对于另外 $20\%$ 的测试点，每次修改操作只会修改一个位置（也就是 $l = r$ ），并且每个位置至多被修改一次；

• 对于另外 $10\%$ 的测试点， $p = 2$；

对于另外 $10\%$ 的测试点， $p = 3$；

对于另外 $10\%$ 的测试点， $p = 4$；

对于另外 $20\%$ 的测试点， $1\le n,m \le 100$；

对于 $100\%$ 的测试点， $1\le n,m \le 5\times 10^4$，$1 \le p \le 10^8$，$0< c < p$，$0 \le a_i < p$。



---

---
title: "斐波那契数列"
layout: "post"
diff: 省选/NOI-
pid: P4000
tag: ['字符串', '数学', 'O2优化', '素数判断,质数,筛法', '斐波那契数列']
---
# 斐波那契数列
## 题目描述

大家都知道，斐波那契数列是满足如下性质的一个数列：

• $f_1 = 1$

• $f_2 = 1$

• $f_n = f_{n-1} + f_{n-2}$ ($n \geq 2$ 且 $n$ 为整数)

请你求出 $f_n \mod p$ 的值。

## 输入格式

- 第 1 行：一个整数 $n$。

- 第 2 行：一个整数 $p$。

## 输出格式

- 第 1 行：$f_n \mod p$ 的值。

## 样例

### 样例输入 #1
```
5
1000000007
```
### 样例输出 #1
```
5
```
### 样例输入 #2
```
10
1000000007
```
### 样例输出 #2
```
55
```
## 提示

对于 $100\%$ 的数据，$n \leq 10^{30000000}, p<2^{31}$



---

---
title: "[SDOI2016] 数字配对"
layout: "post"
diff: 省选/NOI-
pid: P4068
tag: ['贪心', '2016', '各省省选', '网络流', '山东', '二分图', '素数判断,质数,筛法']
---
# [SDOI2016] 数字配对
## 题目描述

有 $n$ 种数字，第 $i$ 种数字是 $a_i$、有 $b_i$ 个，权值是 $c_i$。

若两个数字 $a_i$、$a_j$ 满足，$a_i$ 是 $a_j$ 的倍数，且 $a_i/a_j$ 是一个质数，

那么这两个数字可以配对，并获得 $c_i \times c_j$ 的价值。

一个数字只能参与一次配对，可以不参与配对。

在获得的价值总和不小于 $0$ 的前提下，求最多进行多少次配对。
## 输入格式

第一行一个整数 $n$。

第二行 $n$ 个整数 $a_1,a_2,\cdots,a_n$。

第三行 $n$ 个整数 $b_1,b_2,\cdots,b_n$。

第四行 $n$ 个整数 $c_1,c_2,\cdots,c_n$。
## 输出格式

一行一个数，最多进行多少次配对。
## 样例

### 样例输入 #1
```
3
2 4 8
2 200 7
-1 -2 1

```
### 样例输出 #1
```
4
```
## 提示

测试点 $1 \sim 3$： $n \leq 10 $， $a_i \leq 10 ^ 9 $ ， $b_i = 1 $，$ | c_i | \leq 10 ^ 5$；   

测试点 $4 \sim 5$： $n \leq 200 $， $a_i \leq 10 ^ 9 $ ， $b_i \leq 10 ^ 5  $，$c_i = 0$；

测试点 $6 \sim 10$： $n \leq 200 $， $a_i \leq 10 ^ 9 $ ， $b_i \leq 10 ^ 5$ ，$ | c_i | \leq 10 ^ 5$。


---

---
title: "[HEOI2015] 小 Z 的房间"
layout: "post"
diff: 省选/NOI-
pid: P4111
tag: ['2015', '各省省选', '河北', '生成树', '素数判断,质数,筛法', '高斯消元']
---
# [HEOI2015] 小 Z 的房间
## 题目描述

你突然有了一个大房子，房子里面有一些房间。事实上，你的房子可以看做是一个包含 $n\times m$ 个格子的格状矩形，每个格子是一个房间或者是一个柱子。在一开始的时候，相邻的格子之间都有墙隔着。

你想要打通一些相邻房间的墙，使得所有房间能够互相到达。在此过程中，你不能把房子给打穿，或者打通柱子（以及柱子旁边的墙）。同时，你不希望在房子中有小偷的时候会很难抓，所以你希望任意两个房间之间都只有一条通路。现在，你希望统计一共有多少种可行的方案，答案对 $10^9$ 取模。

## 输入格式

第一行两个整数 $n,m$。

接下来 $n$ 行，每行 $m$ 个字符 `.` 或 `*`，其中 `.` 代表房间，`*` 代表柱子。

## 输出格式

一行一个整数，表示合法的方案数对 $10^9$ 取模后的值。
## 样例

### 样例输入 #1
```
2 2
..
..

```
### 样例输出 #1
```
4

```
### 样例输入 #2
```
2 2
*.
.*

```
### 样例输出 #2
```
0

```
## 提示

#### 数据规模与约定

- 对于 $20\%$ 的数据，$n,m \le 3$。
- 对于 $50\%$ 的数据，$n,m \le 5$。
- 有 $40\%$ 的数据，$\min(n,m) \le 3$。
- 有 $30\%$ 的数据，不存在柱子。
- 对于 $100\%$ 的数据，$1 \le n,m \le 9$。



---

---
title: "奇数国"
layout: "post"
diff: 省选/NOI-
pid: P4140
tag: ['数学', '2014', '线段树', '树状数组', '素数判断,质数,筛法', '逆元', 'CTT（清华集训/北大集训）']
---
# 奇数国
## 题目描述

在一片美丽的大陆上有 $100\,000$ 个国家，记为 $1$ 到 $100\,000$。这里经济发达，有数不尽的账房，并且每个国家有一个银行。

某大公司的领袖在这 $100\,000$ 个银行开户时都存了 $3$ 大洋，他惜财如命，因此会不时地派小弟 GFS 清点一些银行的存款或者让 GFS 改变某个银行的存款。

该村子在财产上的求和运算等同于我们的乘法运算，也就是说领袖开户时的存款总和为 $3^{100000}$。这里发行的软妹面额是最小的 $60$ 个素数（$p_1=2,p_2=3,\ldots, p_{60}=281$），任何人的财产都只能由这 $60$ 个基本面额表示，即设某个人的财产为 $fortune$（正整数），则 $fortune=p_1^{k_1} \times p_2^{k_2} \times \ldots p_{60}^{k_{60}}$。

领袖习惯将一段编号连续的银行里的存款拿到一个账房去清点，为了避免 GFS 串通账房叛变，所以他不会每次都选择同一个账房。GFS 跟随领袖多年已经摸清了门路,知道领袖选择账房的方式。如果领袖选择清点编号在 $[a,b]$ 内的银行财产，他会先对 $[a,b]$ 的财产求和（记为 $product$），然后在编号属于 $[1,product]$ 的账房中选择一个去清点存款，检验自己计算是否正确同时也检验账房与 GFS 是否有勾结。GFS 发现如果某个账房的编号 $number$ 与 $product$ 相冲，领袖绝对不会选择这个账房。

怎样才算与 $product$ 不相冲呢？若存在整数 $x,y$ 使得 $number \times x+product \times y=1$，那么我们称 $number$ 与 $product$ 不相冲，即该账房有可能被领袖相中。当领袖又赚大钱了的时候，他会在某个银行改变存款，这样一来相同区间的银行在不同的时候算出来的 $product$ 可能是不一样的，而且领袖不会在某个银行的存款总数超过 $10^6$。

现在 GFS 预先知道了领袖的清点存款与变动存款的计划，想请你告诉他，每次清点存款时领袖有多少个账房可以供他选择，当然这个值可能非常大，GFS 只想知道对 $19\,961\,993$ 取模后的答案。
## 输入格式

第一行一个整数 $x$ 表示领袖清点和变动存款的总次数。

接下来 $x$ 行，每行 $3$ 个整数 $a_i,b_i,c_i$。$a_i$ 为 $0$ 时表示该条记录是清点计划，领袖会清点 $b_i$ 到 $c_i$ 的银行存款，你需要对该条记录计算出 GFS 想要的答案。$a_i$ 为 $1$ 时表示该条记录是存款变动，你要把银行 $b_i$ 的存款改为 $c_i$，不需要对该记录进行计算。

## 输出格式

对于每个询问，输出一行一个整数表示答案。
## 样例

### 样例输入 #1
```
6
0 1 3
1 1 5
0 1 3
1 1 7
0 1 3
0 2 3
```
### 样例输出 #1
```
18
24
36
6


```
## 提示

### 样例解释

- 初始化每个国家存款都为 $3$；
- $1$ 到 $3$ 的 $product$ 为 $27$，$[1,27]$ 与 $27$ 不相冲的有 $18$ 个数；
- $1$ 的存款变为 $5$；
- $1$ 到 $3$ 的 $product$ 为 $45$，$[1,45]$ 与 $45$ 不相冲的有 $24$ 个数；
- $1$ 的存款变为 $7$；
- $1$ 到 $3$ 的 $product$ 为 $63$，$[1,63]$ 与 $63$ 不相冲的有 $36$个数；
- $2$ 到 $3$ 的 $product$ 为 $9$，$[1,9]$ 与 $9$ 不相冲的有 $6$ 个数。

### 数据范围

所有数据均满足：$x \geq 1$，$c_i -b_i \geq 0$。

| 子任务编号 | 分值 |    $x \leq$     | $c_i - b_i \leq$ | 特殊性质 |
| :--------: | :--: | :-------------: | :--------------: | :------: |
|    $1$     | $20$ |     $10^4$      |      $100$       |    有    |
|    $2$     | $30$ | $5 \times 10^4$ |      $10^4$      |    无    |
|    $3$     | $50$ |     $10^5$      |      $10^5$      |    无    |

特殊性质指：所有 $product \leq 10^{18}$。


---

---
title: "【模板】扩展 BSGS/exBSGS"
layout: "post"
diff: 省选/NOI-
pid: P4195
tag: ['O2优化', '枚举', '素数判断,质数,筛法', '分块', '大步小步算法 BSGS']
---
# 【模板】扩展 BSGS/exBSGS
## 题目背景

题目来源：SPOJ3105 Mod
## 题目描述

给定 $a,p,b$，求满足 $a^x≡b \pmod p$ 的最小自然数 $x$ 。

## 输入格式

每个测试文件中包含若干组测试数据，保证 $\sum \sqrt p\le 5\times 10^6$。

每组数据中，每行包含 $3$ 个正整数 $a,p,b$ 。

当 $a=p=b=0$ 时，表示测试数据读入完全。

## 输出格式

对于每组数据，输出一行。

如果无解，输出 `No Solution`，否则输出最小自然数解。

## 样例

### 样例输入 #1
```
5 58 33
2 4 3
0 0 0
```
### 样例输出 #1
```
9
No Solution
```
## 提示

对于 $100\%$ 的数据，$1\le a,p,b≤10^9$ 或 $a=p=b=0$。

2021/5/14 加强 by [SSerxhs](https://www.luogu.com.cn/user/29826)。  
2021/7/1 新添加[一组 Hack 数据](https://www.luogu.com.cn/discuss/391666)。


---

---
title: "[JSOI2008] 最小生成树计数"
layout: "post"
diff: 省选/NOI-
pid: P4208
tag: ['2008', '并查集', '各省省选', '江苏', '生成树', '素数判断,质数,筛法', '高斯消元']
---
# [JSOI2008] 最小生成树计数
## 题目描述

现在给出了一个简单无向加权图。你不满足于求出这个图的最小生成树，而希望知道这个图中有多少个不同的最小生成树。（如果两棵最小生成树中至少有一条边不同，则这两个最小生成树就是不同的）。由于不同的最小生成树可能很多，所以你只需要输出方案数对 $31011$ 的模就可以了。
## 输入格式

第一行包含两个数，$n$ 和 $m$，其中 $1 \le n \le 100$，$1 \le m \le 1000$，表示该无向图的节点数和边数。每个节点用 $1 \sim n$ 的整数编号。

接下来的 $m$ 行，每行包含两个整数：$a,b,c$，表示节点 $a,b$ 之间的边的权值为 $c$，其中 $1 \le c \le 10^9$。

数据保证不会出现自回边和重边。注意：具有相同权值的边不会超过 $10$ 条。
## 输出格式

输出不同的最小生成树有多少个。你只需要输出数量对 $31011$ 的模就可以了。
## 样例

### 样例输入 #1
```
4 6
1 2 1
1 3 1
1 4 1
2 3 2
2 4 1
3 4 1
```
### 样例输出 #1
```
8

```
## 提示

### 数据范围及约定

对于全部数据，$1 \le n \le 100$，$1 \le m \le 1000$，$1\leq c_i\leq 10^9$。


---

---
title: "【模板】任意模数多项式乘法"
layout: "post"
diff: 省选/NOI-
pid: P4245
tag: ['数学', 'O2优化', '素数判断,质数,筛法', '中国剩余定理 CRT', '快速傅里叶变换 FFT']
---
# 【模板】任意模数多项式乘法
## 题目背景

模板题，无背景
## 题目描述

给定 $2$ 个多项式 $F(x), G(x)$ ，请求出 $F(x) * G(x)$。    

**系数对 $p$ 取模**，且**不保证** $p$ 可以分解成 $p = a \cdot 2^k + 1$ 之形式。
## 输入格式

输入共 $3$ 行。   
第一行 $3$ 个整数 $n, m, p$，分别表示 $F(x), G(x)$ 的次数以及模数 $p$ 。   
第二行为 $n+1$ 个整数，第 $i$ 个整数 $a_i$ 表示 $F(x)$ 的 $i-1$ 次项的系数。   
第三行为 $m+1$ 个整数，第 $i$ 个整数 $b_i$ 表示 $G(x)$ 的 $i-1$ 次项的系数。

## 输出格式

输出 $n+m+1$ 个整数， 第 $i$ 个整数 $c_i$ 表示 $F(x) * G(x)$ 的 $i-1$ 次项的系数。
## 样例

### 样例输入 #1
```
5 8 28
19 32 0 182 99 95
77 54 15 3 98 66 21 20 38
```
### 样例输出 #1
```
7 18 25 19 5 13 12 2 9 22 5 27 6 26
```
## 提示

对于 $100 \%$ 的数据，$1 \leq n, m \leq 10^5$，$0 \leq a_i, b_i \leq 10^9$，$2 \leq p \leq 10^9 + 9$。


---

---
title: "公主の#19准备月考"
layout: "post"
diff: 省选/NOI-
pid: P4256
tag: ['数学', '线段树', 'O2优化', '素数判断,质数,筛法', '进制']
---
# 公主の#19准备月考
## 题目背景

公主在玩完游戏后，也要月考了。（就算是公主也要月考啊QWQ）

## 题目描述

公主的文综太差了，全校排名1100+（全校就1100多人），她分析了好久，发现她如果把所有时间放在选择题上，得分会比较好一点。

文综题目共有n个，编号从1到n

公主给每个题目算出来了一个预估值Ai，她认为，一段连续题目的答案会在它们的预估值的gcd和lcm之间；有时候她的想法不同了，一些题目的预估值会改变；有时候，会出现多选题，多选题的答案数量就是一段连续题目答案的预估值的公约数的个数。

具体来说，对于一个数列，有四种操作：

L x y p 表示公主询问区间[x,y]的数字的lcm对p取模之后的值

G x y p 表示公主询问区间[x,y]的数字的gcd对p取模之后的值

C x y c 表示公主改变区间[x,y]的数字的值，统一为c

S x y p 表示公主询问区间[x,y]的数字的公因数个数对p取模之后的值

公主月考不能挂科，不然她就不能学习OI了（假的），所以请你帮帮她吧！

## 输入格式

第一行，两个正整数n和q，q表示操作次数

第二行，n个正整数，表示dkw对题目的预估值

接下来q行，每行输入一个操作，格式详见题目描述

## 输出格式

对于每个询问，输出它的答案。

## 样例

### 样例输入 #1
```
10 10
42 68 35 1 70 25 79 59 63 65 
L 2 6 28
L 2 6 43
G 2 7 5
G 3 4 83
L 7 9 96
G 2 7 39
S 3 8 100
L 4 5 12
G 4 4 65
L 2 4 69
```
### 样例输出 #1
```
0
32
1
1
75
1
1
10
1
34
```
## 提示

对于30%的数据，1<=n,q<=1000

对于另外20%的数据，1<=n<=1000，1<=q<=100000

对于另外20%的数据，1<=n<=100000，1<=q<=100000，保证没有修改操作

对于100%的数据，1<=n<=300000，1<=q<=300000

保证任何时刻每个题目的预估值都在[1,100]之间，答案取模之后不超过int



---

---
title: "完全平方数"
layout: "post"
diff: 省选/NOI-
pid: P4318
tag: ['素数判断,质数,筛法', '容斥原理', '分块']
---
# 完全平方数
## 题目描述

小 X 自幼就很喜欢数。但奇怪的是，他十分讨厌完全平方数。他觉得这些数看起来很令人难受。由此，他也讨厌所有是完全平方数的正整数倍的数。然而这丝毫不影响他对其他数的热爱。

这天是小X的生日，小 W 想送一个数给他作为生日礼物。当然他不能送一个小X讨厌的数。他列出了所有小X不讨厌的数，然后选取了第 K个数送给了小X。小X很开心地收下了。

然而现在小 W 却记不起送给小X的是哪个数了。你能帮他一下吗？
## 输入格式

包含多组测试数据。文件第一行有一个整数 $T$，表示测试数据的组数。
第$2$ 至第$T+1$ 行每行有一个整数$K_i$，描述一组数据，含义如题目中所描述。
## 输出格式

含T 行，分别对每组数据作出回答。第 $i$ 行输出相应的第$K_i$ 个不是完全平方数的正整数倍的数。
## 样例

### 样例输入 #1
```
4 
1 
13 
100 
1234567
```
### 样例输出 #1
```
1 
19 
163 
2030745
```
## 提示

对于 50%的数据有 $1 ≤ K_i ≤ 10^5$,
对于 100%的数据有 $1 ≤ K_i ≤ 10^9, T ≤ 50$


---

---
title: "[CQOI2016] 密钥破解"
layout: "post"
diff: 省选/NOI-
pid: P4358
tag: ['2016', '重庆', '各省省选', '递归', '素数判断,质数,筛法', '逆元']
---
# [CQOI2016] 密钥破解
## 题目描述

一种非对称加密算法的密钥生成过程如下：

1.任选两个不同的质数$p,q$

2.计算$N=p \times q$，$r=(p-1)(q-1)$

3.选取小于$r$，且与$r$互质的整数$e$

4.计算整数$d$，使得$ed≡1(mod r)$

5.二元组$(N,e)$称为公钥，二元组$(N,d)$称为私钥。

当需要加密消息$n$时，（假设$n$是一个小于$N$的整数，因为任何格式的消息都可转为整数表示），使用公钥$(N,e)$，按照

$$n^e≡c(mod N)$$

运算，可得到密文$c$

对密文$c$解密时，用私钥$(N,d)$，按照

$$c^d≡n(mod N)$$

运算，可得到原文 $n$。算法正确性证明省略。

由于用公钥加密的密文仅能用对应的私钥解密，而不能用公钥解密，因此称为非对称加密算法。通常情况下，公钥由消息的接收方公开，而私钥由消息的接收方自己持有。这样任何发送消息的人都可以用公钥对消息加密，而只有消息的接收方自己能够解密消息。

现在，你的任务是寻找一种可行的方法来破解这种加密算法，即根据公钥破解出私钥，并据此解密密文。
## 输入格式

输入文件内容只有一行，为空格分隔的三个正整数$e,N,c$。
## 输出格式

输出文件内容只有一行，为空格分隔的两个整数$d,n$。
## 样例

### 样例输入 #1
```
3 187 45
```
### 样例输出 #1
```
107 12
```
## 提示

对于$30\%$的数据，$e,N,c \le 2^{20}$；

对于$100\%$的数据，$e,N,c \le 2^{62},c<N$


---

---
title: "[CQOI2016] 伪光滑数"
layout: "post"
diff: 省选/NOI-
pid: P4359
tag: ['搜索', '2016', '重庆', '各省省选', '可并堆', '素数判断,质数,筛法']
---
# [CQOI2016] 伪光滑数
## 题目描述

若一个大于 $1$ 的整数 $M$ 的质因数分解有 $k$ 项，其最大的质因子为 $a_k$ ，并且满足 $a_{k}^{k} \le N$，$a_k < 128$，我们就称整数 $M$ 为 $N$ - 伪光滑数。

现在给出 $N$，求所有整数中，第 $K$ 大的 $N$ - 伪光滑数。

### 题意澄清

设 $M = 36 = 2^2 \times 3^2$，则其对应的 $k = 4$，也就是说，对 $M$ 运用唯一分解定理，$M = \prod_{i=1}^n{p_i^{c_i}}$，$k = \sum_{i=1}^n{c_i}$。

第 $K$ 大为字面意思，是真的从大到小第 $K$ 个。

modified by expect2004 2020-11-25，这或许是他退役前对洛谷公共题库的最后一次贡献
## 输入格式

只有一行，为用空格隔开的整数 $N$ 和 $K$ 。
## 输出格式

只有一行，为一个整数，表示答案。
## 样例

### 样例输入 #1
```
12345 20
```
### 样例输出 #1
```
9167
```
## 提示

对于 $30\%$ 的数据，$N \le 10^6$；  
对于 $100\%$ 的数据，$2 \le N \le 10^{18},1 \le K \le 800000$。保证至少有 $K$ 个满足要求的数。


---

---
title: "于神之怒加强版"
layout: "post"
diff: 省选/NOI-
pid: P4449
tag: ['数学', '素数判断,质数,筛法', '前缀和']
---
# 于神之怒加强版
## 题目描述

给定 $n,m,k$，计算

$$\sum_{i=1}^n \sum_{j=1}^m \gcd(i,j)^k$$

对 $10^9 + 7$ 取模的结果。
## 输入格式

**本题单测试点内有多组测试数据**。

第一行有两个整数，分别表示数据组数 $T$ 和给定的 $k$。

接下来 $T$ 行，每行两个整数，表示一组数据的 $n$ 和 $m$。
## 输出格式

对于每组数据，输出一行一个整数表示答案。
## 样例

### 样例输入 #1
```
1 2
3 3
```
### 样例输出 #1
```
20
```
## 提示

#### 数据规模与约定

对于全部的测试点，保证 $1 \leq T \leq 2 \times 10^3$，$1 \leq n, m, k \leq 5 \times 10^6$。


---

---
title: "取石子"
layout: "post"
diff: 省选/NOI-
pid: P4706
tag: ['枚举', '素数判断,质数,筛法', '概率论']
---
# 取石子
## 题目描述

现在 Yopilla 和 yww 要开始玩游戏！

他们在一条直线上标记了 $n$ 个点，从左往右依次标号为 $1, 2, ..., n$ 。然后在每个点上放置一些棋子，其中第 $i$ 个点放置了 $a_i$ 个棋子。接下来，从 Yopilla 开始操作，双方轮流操作，谁不能操作谁输。每次的操作是：当前操作方选定一个有棋子的点 $x$ ，然后选择至少一个点 $x$ 上的棋子，然后把这些棋子全都移动到点 $x / prime$ 上，其中 $prime$ 是一个质数，且 $prime \mid x$ 。

Yopilla 最初一次操作的策略是随机的：随机找到一个有棋子的点 $x$ ，随机选择正整数个棋子 $y$ ，随机转移到一个能转移到的点 $z$ 。所有棋子可以看作是一样的，换句话说：两种操作不同，当且仅当三元组 $(x, y, z)$ 不同。之后双方都按照最优策略来操作。

Yopilla 想要预测，他能够获胜的概率是多少，答案对 $998244353$ 取模。
## 输入格式

第一行一个数 $n$ 。

第二行 $n$ 个数 $a_1, a_2, ..., a_n$ 。
## 输出格式

输出 $m$ 行，表示 Yopilla 能够获胜的概率对 $998244353$ 取模。
## 样例

### 样例输入 #1
```
3
3 1 2
```
### 样例输出 #1
```
332748118
```
## 提示

样例解释：

$1$ 号点有 $3$ 个棋子，$2$ 号点有 $1$ 个棋子，$3$ 号点有 $2$ 个棋子。第一次操作的时候，能进行的有三种可能：将 $2$ 号点的 $1$ 个棋子移到 $1$ 号点，将 $3$ 号点的 $1$ 个棋子移到 $1$ 号点，将 $3$ 号点的 $2$ 个棋子移到一号点。而其中只有一种情况能使得 Yopilla 有必胜策略。所以答案为
$$\frac{1}{3} \equiv 332748118 \pmod {998244353}$$

对于 $20 \%$ 的数据，只有一个石子。

对于 $100 \%$ 的数据，$1 \le n \le {10} ^ 6, 0 \le a_i \le {10} ^ 9$ ，保证至少有一个不在一号点的石子。


---

---
title: "「数学」约数个数和"
layout: "post"
diff: 省选/NOI-
pid: P4714
tag: ['递推', '洛谷原创', '素数判断,质数,筛法', '前缀和', '洛谷月赛']
---
# 「数学」约数个数和
## 题目描述

小 F 在数学课上与同学闲聊。

> 给你一个正整数，计算他的约数个数。

「你们竞赛就学这个啊？太简单了吧。」

「……」

> 给你一个正整数，计算他的所有约数的约数个数和。

「我想想……嗯，还是不难的。诶，你们竞赛还能报名吗？」

「……」

> 给你一个正整数，计算他的所有约数的所有约数的约数个数和。

「哎呀反正你们电脑总是能爆算出来的嘛，快给我说在哪报名。」

「……」

> 给你一个正整数，计算他的所有约数的所有约数的所有约数的约数个数和。

「有完没完了？」

「……」


被嘲讽的小 F 将这个问题交给了你，请展示你的爆算实力。

给你一个正整数 $N$，请计算 $N$ 的 $($所有约数的$)\times K$ 约数个数和。

答案可能很大，请输出对 $998244353$ 取模的结果。

## 输入格式

输入一行两个整数 $N, K(1 \leq N \leq 10 ^ {18}, 0 \leq K \leq 10^{18})$。

## 输出格式

输出一行一个非负整数，表示所求的答案对 $998244353$ 取模的结果。
## 样例

### 样例输入 #1
```
4 0
```
### 样例输出 #1
```
3
```
### 样例输入 #2
```
4 1
```
### 样例输出 #2
```
6
```
### 样例输入 #3
```
4 2
```
### 样例输出 #3
```
10
```
## 提示

### 样例 1, 2, 3 解释

$4,\ 0:$ $4$ 的约数 $\ 1\ 2\ 4$

$4,\ 1:$ $4$ 的所有约数的约数 $\ (1)\ (1\ 2)\ (1\ 2\ 4)$

$4,\ 2:$ $4$ 的所有约数的所有约数的约数 $((1))\ ((1)\ (1\ 2))\ ((1)\ (1\ 2)\ (1\ 2\ 4))$

### 子任务

子任务 $1(11 \mathrm{pts}) : N, K \leq 10 ^ 4$

子任务 $2(31 \mathrm{pts}) : N \leq 10 ^ 4$

子任务 $3(41 \mathrm{pts}) : N \leq 10 ^ 9$

子任务 $4(67 \mathrm{pts}) : 1 \leq N \leq 10 ^ {18}, 0 \leq K \leq 10^{18} $。


---

---
title: "【模板】Pollard-Rho"
layout: "post"
diff: 省选/NOI-
pid: P4718
tag: ['数学', '递归', '素数判断,质数,筛法']
---
# 【模板】Pollard-Rho
## 题目描述

Miller Rabin 算法是一种高效的质数判断方法。虽然是一种不确定的质数判断法，但是在选择多种底数的情况下，正确率是可以接受的。

Pollard rho 是一个非常玄学的方式，用于在 $O(n^{1/4})$ 的期望时间复杂度内计算合数 $n$ 的某个非平凡因子。事实上算法导论给出的是 $O(\sqrt p)$，$p$ 是 $n$ 的某个最小因子，满足 $p$ 与 $n/p$ 互质。但是这些都是期望，未必符合实际。但事实上 Pollard rho 算法在实际环境中运行的相当不错。

这里我们要写一个程序，对于每个数字检验是否是质数，是质数就输出 `Prime`；如果不是质数，输出它最大的质因子是哪个。
## 输入格式

第一行，$T$ 代表数据组数（不大于 $350$）

以下 $T$ 行，每行一个整数 $n$，保证 $2 \le n \le {10}^{18}$。
## 输出格式

输出 $T$ 行。

对于每组测试数据输出结果。
## 样例

### 样例输入 #1
```
6
2
13
134
8897
1234567654321
1000000000000
```
### 样例输出 #1
```
Prime
Prime
67
41
4649
5
```
## 提示

2018.8.14 新加数据两组，时限加大到 2s，感谢 @whzzt

2022.12.22 加入新的数据，感谢 @ftt2333 和 Library Checker

by @will7101


---

---
title: "多少个 1？"
layout: "post"
diff: 省选/NOI-
pid: P4884
tag: ['素数判断,质数,筛法', '进制', '洛谷月赛']
---
# 多少个 1？
## 题目描述

给定整数 $K$ 和质数 $m$，求最小的正整数 $N$，使得 $ 11\cdots1$（$N$ 个 $1$）$\equiv K \pmod m$。

说人话：就是 $111\cdots 1111 \bmod m = K$。
## 输入格式

第一行两个整数，分别表示 $K$ 和 $m$。
## 输出格式

一个整数，表示符合条件最小的 $N$。
## 样例

### 样例输入 #1
```
9 17
```
### 样例输出 #1
```
3
```
## 提示

$30\%$ 的数据保证 $m\leq 10^6$。

$60\%$ 的数据保证 $m\leq 5\times 10^7$。

$100\%$ 的数据保证 $6\leq m\leq 10^{11}$，$0< K< m$，保证 $m$ 是质数。


---

---
title: "食堂"
layout: "post"
diff: 省选/NOI-
pid: P4900
tag: ['O2优化', '素数判断,质数,筛法', '前缀和', '逆元']
---
# 食堂
## 题目背景

我CYJian就是死，死外边，从这跳下去，也不会吃食堂一口饭。

$$\color{white}\text{真香。。}$$
## 题目描述

食堂第$i$天有$i$道菜.$CYJian$觉得第$i$天的第$j$道菜的美味程度为$\lbrace \frac{i}{j} \rbrace$({}就是取小数部分),当然,$CYJian$是一个勇于尝试的人,所以每一道菜都会吃那么一点.

现在CYJian有$T$个问题,每一个问题都是从第$A_i$天到第$B_i$天得到的美味值的总和.现在请你帮他算一算吧!请输出答案模$998244353$的值.
## 输入格式

第一行一个数T。

接下来T行，每一行一共两个数，表示每一次询问的$A$和$B$。
## 输出格式

T行，每行一个正整数表示美味值之和.**如果答案可以表示成$\frac{P}{Q}$的形式,则需要找到任意一个$x$使得$Q \times x \equiv P (\bmod\ 998244353)$,并且输出$x \bmod 998244353$**
## 样例

### 样例输入 #1
```
1
1 3

```
### 样例输出 #1
```
499122177

```
## 提示

样例解释：第一天美味值为0.00，第二天美味值为0.00+0.00=0.00，第三天美味值为0.00+0.50+0.00=0.50，0.00+0.00+0.50=0.50=$\frac{1}{2}$,$499122177 \times 2 \equiv 1 (\bmod\ 998244353)$,所以答案为499122177.

数据范围：

| 数据点范围 | $T$= | $A\leqslant B \leqslant$ |
|:-------------------------:|:-----------------------:|:--------------:|
| $1 \sim 5$ | $1$ | $5000$  |
| $6 \sim 10$ | $1$ | $10^6$  |
| $10 \sim 15$ | $10^6$ | $5000$  |
| $16 \sim 20$ | $10^6$ | $10^6$  |

注意: **本题捆绑测试**


---

---
title: "评分系统"
layout: "post"
diff: 省选/NOI-
pid: P4993
tag: ['递推', '枚举', '素数判断,质数,筛法']
---
# 评分系统
## 题目背景

答疑请到：https://www.luogu.org/discuss/show?postid=79498

由于时限等问题，请大家重交一遍这道题

本题时限开至2s

样例：https://files.cnblogs.com/files/ztz11/yl.rar

---

众所周知，luogu 有题目难度的评分系统，用户在通过题目后可以选择题目难度以及算法标签，来完善 luogu 的题库。

![](https://cdn.luogu.com.cn/upload/pic/40327.png)

（原注：以下内容非真实评分数据，纯属作者编造，仅供娱乐使用。）
## 题目描述

Menteur-Hxy 同学很不老实，为了实现 NOIp 前 AC $100$ 道黑题的目标，他决定雇佣一些水军，最少雇佣 $1$ 个水军。

每个水军都有一个能力值 $x_i$，表示该水军可以解决难度最高为 $x_i$ 的题目。这些水军十分尽职尽责，在通过这道题目后都会给题目评最高难度。当然，luogu 的正常用户也会做题，他们会正常地评分。现在，我们给你所有水军的能力值以及每道题正常用户的评分记录，请你求出有多少种选择水军的方案，可以使这道题的评分变为黑题。因为答案可能过大，最终请输出答案数 $\bmod p$ 的值。

评分计算公式：去掉一个最高分，去掉一个最低分后求平均分。

**【表一：投票信息】**

| 投票编号 | 对应难度 | 分数贡献 |
| :------: | :------: | :------: |
| $1$ | 入门 | $1$ |
| $2$ | 普及- | $10$ |
| $3$ | 普及/提高- | $15$ |
| $4$ | 普及+/提高 | $25$ |
| $5$ | 提高+/省选- | $40$ |
| $6$ | 省选/NOI- | $55$ |
| $7$ | NOI | $75$ |
| $8$ | NOI+/CTSC | $100$ |

**【表二：难度规则】**

| 难度等级 | 对应颜色 | 对应分数 |
| :------: | :------: | :------: |
| 入门 | 红 | $1\sim 5$ |
| 普及- | 橙 | $6\sim 12$ |
| 普及/提高- | 黄 | $13\sim 20$ |
| 普及+/提高 | 绿 | $21\sim 35$ |
| 提高+/省选- | 蓝 | $36\sim 45$ |
| 省选/NOI- | 紫 | $46\sim 70$ |
| NOI+/CTSC | 黑 | $71\sim 100$ |
## 输入格式

**本题有多组数据。**

第一行，一个整数 $T$，表示数据组数。

对于每组数据：

+ 第一行三个整数 $n, m, p$，分别表示 Menteur-Hxy 找的水军数量，luogu 用户评分数量，和输出时的模数。
+ 第二行，$n$ 个整数 $s_1 \dots s_n$ 分别表示水军的能力值。
+ 第三行，$m$ 个整数 $t_1 \dots t_n$，表示每个 luogu 用户的投票编号。
+ 第四行，一个整数 $k$ ，表示题目的难度系数。
## 输出格式

对于每组数据，输出一行一个整数，表示总选择方案数对 $p$ 取模后的结果，如无解，则输出 $0$。
## 样例

### 样例输入 #1
```
1
5 5 9
1 2 3 4 5
4 5 6 7 8
2
```
### 样例输出 #1
```
2
```
### 样例输入 #2
```
5
20 10 1329
540 499 490 419 308 261 323 476 476 374 23 13 14 16 19 34 43 19 27 32 
8 8 8 8 8 7 7 7 7 7 
50
20 10 1800
74 434 97 134 283 118 234 498 328 388 29 48 48 43 23 42 31 16 20 26 
8 8 7 6 8 8 8 7 7 7 
50
20 10 2704
142 378 330 281 377 64 340 309 466 289 34 37 19 17 20 48 21 28 38 15 
6 8 6 6 8 7 7 7 7 6 
50
20 10 72
365 356 456 479 459 222 548 377 212 223 38 20 49 18 49 38 31 48 41 17 
6 8 7 6 8 7 8 8 8 6 
50
20 10 1416
367 191 403 298 445 464 79 467 431 362 10 45 48 37 46 43 11 35 30 39 
8 6 8 7 7 7 8 8 7 8 
50
```
### 样例输出 #2
```
1023
1023
1023
15
1023
```
## 提示

**【样例解释 $1$】**

luogu 用户评分和为 $25+40+55+75+100=295$，弃掉一个最低分后为 $270$，这时 Menteur-Hxy 雇佣两个及以上水军就可以达到目的。

因为可以通过本题的水军共有 $4$ 个，所以选择方案共有：

$$\{1,2\}\{1,2,3\}\{1,2,3,4\}\{1,2,4\}\{1,3\}\{1,3,4\}\{1,4\}\{2,3\}\{2,3,4\}\{2,4\}\{3,4\}$$

共 $11$ 种，对 $9$ 取余后结果为 $2$。

**【数据规模与约定】**

对于 $30\%$ 的数据，$n, m \leq 50$。

对于另外 $20\%$ 的数据，$p$ 为质数。

对于 $100\%$ 的数据，$1 \leq n, m, k,s_i \leq 10^5, 1 \leq t \leq 5, 2 \leq p \leq 3 \times 10^3, 1 \leq t_i \leq 8$。

保证合格水军的数量与需要的最少水军数量之差不超过 $5000$。

（原注：本题可能轻微卡常。感谢 @Ghostcai ，@Swhsz 帮忙验题。）


---

---
title: "抓捕"
layout: "post"
diff: 省选/NOI-
pid: P5037
tag: ['O2优化', '最短路', '素数判断,质数,筛法']
---
# 抓捕
## 题目背景

@葛军  原创

古桥文乃作为一名OIer，每天勤奋地在洛谷上刷题，然而她的父母却认为他有网瘾，就将她送到了杨叫兽的网戒中心。

![](https://cdn.luogu.com.cn/upload/pic/41018.png )

一年之后，凭借不懈地努力古桥文乃终于逃了出来，并且立刻向警察蜀黍举报杨叫兽的所作所为，了解情况后警察请她带路去网戒中心抓捕杨叫兽。
## 题目描述

啊~~~~！

他们刚到达网戒中心就听到惨叫声从里面传来。古桥文乃在网戒中心呆了一年，对里面的情况很熟悉，立马就知道杨叔又在13号治疗室“点现钱”。同时，她知道网戒中心有$n$个房间，任意房间都有走廊相连，每个走廊和房间之间都有门，门是向外锁上的，且在开启后会自动锁上（即每次从房间$i$进入任意一个与其相连的走廊需要花费$c_i$的体力开锁，而从走廊进入房间不用耗费体力）。

杨叔为了防止“盟友”逃跑，在每个房间安装了摄像头，安排了$n$个手下在监控中心看着监控。

**特别的，1号房间为监控中心，1号手下负责防止任何人（除了杨叔）进入监控中心（否则立刻报告给杨叔）**，

其余的2号到$n$号手下每人负责监控编号是自己整数倍的房间（例如$n=10$时2号手下监控2号，4号，6号，8号，10号房间），13号治疗室也按照此规则被监控，如果他们其中一个人看到同一个人两次，就会向杨叔报告（但是每一个手下不会互相交流信息），好在这些手下都四肢发达头脑简单，只能记得上一秒的事情。

为了保证抓捕的顺利，古桥文乃和警察不能被发现，现在他们在$x$号房间，13号治疗室在$y$号房间，已知他们通过每一条走廊要1秒，开锁和通过房间不用花费时间（但会被监控室的手下看到），古桥文乃和警察想知道他们在不被发现的情况下最少要花费多少体力才能进入13号治疗室。
## 输入格式

本题多组询问QAQ

第一行一个数$T$，表示有$T$组询问

第二行一个数$n$，表示有$n$个房间和手下（每组数据$n$相同且只在一开始读入一次，意思就是整个输入中只读入一次n！）

对于每一个询问：

第一行两个数：$x$，$y$，其中$x$表示古桥文乃和警察所在房间的编号，$y$表示13号治疗室所在房间的编号

接下来一行$n$个数，表示$c_i$

提示：

本题读入可能较多，建议使用快读（不会快读的自己搜！）

还有，记得开$O_2$，不然你会T飞掉~~（虽然开了$O_2$也会T飞掉）~~（雾）
## 输出格式

输出共$T$行

每个询问输出一行，仅一个数，表示在不被发现的情况下最少要花费多少体力才能进入13号治疗室，若不能到达输出“-1”（不含引号）
## 样例

### 样例输入 #1
```
1
5
2 4
1 2 3 4 5
```
### 样例输出 #1
```
5
```
## 提示

2->3->4

对于30%的数据，$n$<=$1500$，$T$<=$15$；

对于50%的数据，$n$<=$2500$，$T$<=$30$；

对于70%的数据，$n$<=$4500$，$T$<=$50$；

对于100%的数据，$n$<=$4500$，$T$<=$200$，$2$<=$x$,$y$<=$n$，$c_i$<=$9900$


---

---
title: "质数前缀统计"
layout: "post"
diff: 省选/NOI-
pid: P5493
tag: ['数学', '素数判断,质数,筛法']
---
# 质数前缀统计
## 题目背景

这是洲阁筛和 Min_25 筛的重要前置知识。
## 题目描述

设 $S(n)$ 为 $n$ 以内质数的 $k$ 次方和。

给出 $N$，求下列式子的值。

$$\sum_{i=1}^{\lfloor\sqrt{N}\rfloor} i^2 S \!\left( \left\lfloor \frac{N}{i} \right\rfloor \right)$$

所有结果对给定的质数 $p$ 取模。


## 输入格式

一行三个整数 $N,k,p$，之间用空格隔开。
## 输出格式

一行一个整数，代表计算的结果。
## 样例

### 样例输入 #1
```
10 3 1000000007
```
### 样例输出 #1
```
1458
```
### 样例输入 #2
```
100000 0 1000000007
```
### 样例输出 #2
```
941229402
```
### 样例输入 #3
```
100000 10 1000000007
```
### 样例输出 #3
```
446053671
```
## 提示

**样例解释** : 

$S \!\left( \left\lfloor \frac{N}{1} \right\rfloor \right)\! = S(10) = 2^3 + 3^3 + 5^3 + 7^3 = 503$。

$S \!\left( \left\lfloor \frac{N}{2} \right\rfloor \right)\! = S(5) = 2^3 + 3^3 + 5^3 = 160$。

$S \!\left( \left\lfloor \frac{N}{3} \right\rfloor \right)\! = S(3) = 2^3 + 3^3 = 35$。

$1^2 S \!\left( \left\lfloor \frac{N}{1} \right\rfloor \right)\! + 2^2 S \!\left( \left\lfloor \frac{N}{2} \right\rfloor \right)\! + 3^2 S \!\left( \left\lfloor \frac{N}{3} \right\rfloor \right)\! = 503 + 640 + 315 = 1458$。

| 测试点编号 | $N \le$ | $k \le$ | 时限 |
| :--: | :--: | :--: | :--: |
| $1\sim 3$ | $10^6$ | $10$ | $1\texttt s$ |
| $4\sim 7$ | $4\times {10}^{10}$ | $0$ | $3\texttt s$ |
| $8\sim 12$ | $4\times {10}^{10}$ | $10$ | $3\texttt s$ |

对于 $100\%$ 的数据，$0 \le k \le 10$，$1 \le N \le 4\times {10}^{10}$，${10}^9 < p < 1.01 \times {10}^9$。


---

---
title: "【化学】实验"
layout: "post"
diff: 省选/NOI-
pid: P5881
tag: ['图论', '并查集', 'O2优化', '素数判断,质数,筛法']
---
# 【化学】实验
## 题目背景

小 Z 紧张地坐在了一张化学实验桌前，进行着化学实验。

教室里又传来了一阵哀叹声：

我…我好像又错了…我能再试一次吗?
## 题目描述

在她的面前，摆放着 $n$ 个试管。试管里装着不明液体。对于每种不明液体，有 $2$ 个已知的化学属性：$a$ 和 $b$。第 $i$ 种液体的两个属性值分别为 $a_i$ 和 $b_i$。

现在，老师给她布置了 $m$ 个实验。

对于每一次实验，有一个参照量 $x$（第 $i$ 次实验的参照量记作 $x_i$）。她需要把不明液体分成尽可能多的组，且满足：任意两种不同组的液体$i$和$j$， $\operatorname{gcsd(a_i,a_j)}$ 都不能大于 $x^2$。

其中 $\operatorname{gcsd}$ 代表他们的最大公约平方数。$k$是两个数的公约平方数，当且仅当满足以下两个条件：

- $k$ 为这两个数的公约数；

- $k$ 为完全平方数。

而最大公约平方数 $\operatorname{gcsd}$ 为所有满足条件的 $k$ 中的最大者。

形象的说， $\operatorname{gcsd}$ 可以理解成两个数的最大公约数的算术平方根的整数因式部分的平方。

例如：

求 $\operatorname{gcsd(24,64)}$，就是先求出 $24,64$ 的最大公约数，是 $8$ ，然后 $\sqrt 8=2\sqrt 2$，其整数因式是 $2$，所以 $\operatorname{gcsd(24,64)}=2^2=4$。

她还需要在分组数最多的情况下，使自己的实验得分最大。

实验得分的定义：对于每一种试剂，定义其得分 $c_i$ 为 $b_i$ 分解质因数之后最大的**指数**。

例如：$b_i=12=2^2\times 3^1$，$c_i=\max\{2,1\}=2$。

$b_i=90=2^1\times 3^2\times 5^1$，$c_i=\max\{1,2,1\}=2$。

而实验得分即为所有组内的 $c_i$ 的最大值之和。

当然，她的 $IQ$ 并不高，所以需要请求你的帮助。
## 输入格式

第一行两个整数 $n,m$。

第二行 $n$ 个整数 $a_{1\dots n}$。

第三行 $n$ 个整数 $b_{1\dots n}$。

第四行 $m$ 个整数 $x_{1\dots m}$。
## 输出格式

共 $m$ 行，对于第 $i$ 行，输出 $2$ 个整数：第 $i$ 次试验的组数和实验得分。
## 样例

### 样例输入 #1
```
5 5
36 72 4 9 16
2 4 6 8 10
2 3 4 5 6

```
### 样例输出 #1
```
3 5
4 7
4 7
4 7
5 8
```
## 提示

#### 样例解释 #1

$b_1=2=2^1,c_1=1$。

$b_2=4=2^2,c_2=2$。

$b_3=6=2^1\times 3^1,c_3=\max\{1,1\}=1$。

$b_4=8=2^3,c_4=3$。

$b_5=10=2^1\times 5^1,c_5=\max\{1,1\}=1$。

当 $x=2$ 时，可分为三组：$\{1,2,4\},\{3\},\{5\}$。

实验得分为$\max\{1,2,3\}+\max\{1\}+\max\{1\}=5$。

----------

#### 数据范围

**「本题采用捆绑测试」**

| subtask | $n\le$ | $m\le$ | $a_i \le$ | $b_i\le$ | $x \le$ | 分值 |
| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |:-----------:|
| $1$ | $4$ | $6$ | $100$ | $4 \times 10^4$ | $100$ | $5$ |
| $2$ | $8$ | $7$ | $20$ | $10^3$ | $10$ | $5$ |
| $3$ |$20$ | $30$ | $50$ | $8 \times 10^3$ | $100$ | $10$ |
| $4$ |$100$ | $60$ | $100$ | $4 \times 10^4$ | $10^3$ | $10$ |
| $5$ |$5 \times 10^3$ | $110$ |  $10^3$| $10^5$ | $4 \times 10^3$ | $10$ |
| $6$ |$2 \times 10^4$ | $250$ | $3 \times 10^3$ | $10^6$ | $3 \times 10^3$ | $10$ |
| $7$ |$ 5 \times 10^4$| $10^3$ | $10^4$ | $2 \times 10^7$ | $1.5 \times 10^4$ | $15$ |
| $8$ |$10^5$  | $8 \times 10^3$ | $2 \times 10^4$ | $2 \times 10^7$ | $2.2 \times 10^4$ | $15$ |
| $9$ |$2 \times 10^5$  | $2 \times 10^5$ | $4 \times 10^4$ | $2 \times 10^7$ | $3 \times 10^4$ | $20$ |


对于 $100\%$ 的数据：

$1 \le n,m \le 2\times 10^5$，$2 \le a_i \le 4\times 10^4$，$2 \le b_i \le 2\times 10^7$，$2 \le x \le 3\times 10^4$。

我$\dots$我好像又错了$\dots$我能再试一次吗?


---

---
title: "「EZEC-3」四月樱花"
layout: "post"
diff: 省选/NOI-
pid: P6788
tag: ['数学', '2020', '洛谷原创', 'O2优化', '素数判断,质数,筛法', '洛谷月赛']
---
# 「EZEC-3」四月樱花
## 题目背景

$$又到樱花曼舞的春日，$$

$$花蕾，像无数星星闪烁在枝头含春嬉戏，$$

$$心有灵犀；$$

$$又是为花吹雪的季节，$$

$$花蕊，引万千蜂蝶赶树梢抱春絮语，$$

$$心有念想。$$

$$开了，一夜乍起，$$

$$火树樱花汇聚开遍山野好似茫茫沧海；$$

$$大地樱花，$$

$$赏心悦目怒放层林尽染好似朵朵云霞；$$

$$纵有三千烦恼，$$

$$不过灿烂阳光下释然地娓娓一笑；$$

$$纵有万般郁闷，$$

$$不如和煦暖风里淡淡地悠悠一了；$$



[——《四月樱花》](http://music.163.com/song?id=1355079681&userid=587823498)

![樱花](https://cdn.luogu.com.cn/upload/image_hosting/g5m4h8a3.png)
## 题目描述

在樱花盛开的四月，```Muxii``` 望着满天飘落的樱花，向身旁的 ```ZZH``` 问道：

“究竟有多少朵樱花在这个四月飘落？”

```ZZH``` 答道：“樱花飘落的朵数 $s$ 与时间 $t$ 有如下关系：

$$s=\prod_{x=1}^t\prod_{y|x}\frac{y^{d(y)}}{\prod_{z|y}(z+1)^2}$$

其中 $d(y)$ 表示 $y$ 的约数个数。”

但作为一个~~文科生~~萌新，```Muxii``` 显然无法清楚地知道具体的数目，因此他只好继续向 ```ZZH``` 询问这个问题的答案。

由于数量可能很大，所以你只需要替 ```ZZH``` 告诉 ```Muxii``` 他所需要的答案对 $p$ 取模的结果就好了。
## 输入格式

两个正整数 $t$ 和 $p$，分别表示 ```Muxii``` 询问的时间、模数。
## 输出格式

输出一个正整数 $s$，表示樱花飘落的朵数。答案对 $p$ 取模。
## 样例

### 样例输入 #1
```
4 998244353
```
### 样例输出 #1
```
648735108
```
### 样例输入 #2
```
10 1000000007
```
### 样例输出 #2
```
872041698
```
## 提示

**「样例 1 说明」**

代入计算可得答案为 $\frac1{2073600}$，由于 $2073600$ 在模 $998244353$ 意义下的逆元为 $648735108$，故最终答案为 $1×648735108\bmod998244353 = 648735108$。

**「数据范围与约定」**

**数据保证答案的最简表示中分母不含 $p$ 和 $p$ 的倍数。**

对于所有数据，保证 $1\leq t\leq 2.5×10^9$，$9.9×10^8<p<1.1×10^9$ 且 $p$ 为质数。
|子任务编号|$t≤$|分值|
|:-:|:-:|:-:|
|$1$|$10^3$|$5$|
|$2$|$10^4$|$5$|
|$3$|$2×10^5$|$10$|
|$4$|$2×10^6$|$20$|
|$5$|$10^7$|$20$|
|$6$|$10^8$|$20$|
|$7$|$2.5×10^9$|$20$|

注：本题采用**捆绑测试**，即必须通过单个子任务的所有测试点才可获得该子任务的分数。


---

---
title: "「JZOI-1」红包"
layout: "post"
diff: 省选/NOI-
pid: P7360
tag: ['素数判断,质数,筛法', '最大公约数 gcd', '莫比乌斯反演', '二项式定理', '容斥原理']
---
# 「JZOI-1」红包
## 题目背景

新年到了，小僖收到了叔叔寄给他的红包，这个红包里面有很多很多的钱。
## 题目描述

小僖收到的红包总额是这样的：

所有 $K$ 元组满足每个元素都是正整数且 $\le N$，总额就是这些 $K$ 元组的最小公倍数的乘积。

但由于叔叔并没有那么多的钱，所以结果还要对 $998244353$ 取模。

小僖花了 $10^{-16}$ 秒就算了出来，但他想验证一下是否正确，于是找上了你（别问我为什么他不直接拆开红包看）。

换句话讲，题目只需要你求：
$$\prod_{i_1=1}^N\prod_{i_2=1}^N...\prod_{i_K=1}^N{\rm lcm}(i_1,i_2...i_K)\mod 998244353$$
保证 $K>1$，其中，${\rm lcm}(i_1,i_2...i_K)$，表示 $i_1,i_2...i_K$ 的最小公倍数。
## 输入格式

**本题有多组数据**。

第一行一个数：$T$，表示数据组数。

接下来 $T$ 行，每行两个数，$N,K$，表示每组询问。
## 输出格式

$T$ 行，每行一个数，表示答案，记得对 $998244353$ 取模。
## 样例

### 样例输入 #1
```
2
2 2
3 2
```
### 样例输出 #1
```
8
7776
```
## 提示

对于样例的第一组数据，题目要求求出 ${\rm lcm}(1,1)\times {\rm lcm}(1,2)\times {\rm lcm}(2,1)\times {\rm lcm}(2,2)$。

显然，除了 ${\rm lcm}(1,1)=1$ 以外其它的结果都为 $2$，所以答案为 $1\times2\times2\times2=8$。

| 数据编号 | $N\le$ | $K\leq$ | $T=$ |
| :-----------: | ----------- | ----------- | ----------- |
| **0** |$10$|$5$|$10$|
| **1** | $10^6$ |$2$|$10^3$|
| **2** | $10^6$ |$3$|$10^3$|
| **3** | $100$ |$10^{18}$|$100$|
| **4** | $10^5$ |$100$|$10^3$|
| **5** | $10^5$ |$3\times10^8$|$1$|
| **6** | $10^5$ |$10^{100}$| $10$ |
| **7** |$10^6$|$10^{18}$|$10^3$|
| **8** |$10^6$|$10^{100}$|$10^3$|
| **9** |$10^6$|$10^{100}$|$10^3$|

**出题人：你真以为有这么多钱，哈哈，里面装的全是津巴布韦币哦！**


---

---
title: "「Stoi2031」兰亭序"
layout: "post"
diff: 省选/NOI-
pid: P7487
tag: ['数学', '递推', '递归', 'O2优化', '素数判断,质数,筛法']
---
# 「Stoi2031」兰亭序
## 题目背景

> 无关风月 我题序等你回 悬笔一绝 那岸边浪千叠 情字何解 怎落笔都不对 而我独缺 你一生的了解 ——《兰亭序》
## 题目描述

月非常喜欢复数，尤其喜欢形如 $e^{2\pi it}$ 的复数。她选择了两个正整数 $n,k$，并将 $1+e^{\frac{2\pi i x_1 \dots x_k}{n}}$ 称为 $(x_1,\dots,x_k)$ 的 **绝对度**，所有满足 $1 \le x_i \le n$ $(i \in \{1,2,\dots,k\})$ 的 $(x_1,\dots,x_k)$ 的 **绝对度** 之积称为 $(n,k)$ 的 **无关度**。现在她想请你帮她对 $t \in \{1,2,\dots,k\}$ 求出 $(n,t)$ 的 **无关度** $ans \bmod{335544323}$。由于回答太多的数太麻烦，你只要回答她所有答案进行异或运算后的结果。
## 输入格式

一行两个正整数 $n,k$。
## 输出格式

一行一个自然数表示答案。
## 样例

### 样例输入 #1
```
15 2

```
### 样例输出 #1
```
201012023

```
### 样例输入 #2
```
1 3

```
### 样例输出 #2
```
2

```
### 样例输入 #3
```
521 6

```
### 样例输出 #3
```
262795752

```
### 样例输入 #4
```
6546546546546543 22211

```
### 样例输出 #4
```
388124125

```
## 提示

#### 简述版题意：

给定 $n,k$，对 $1 \le t \le k$ 求

$$\prod_{x_1=1}^{n}\prod_{x_2=1}^{n}\dots\prod_{x_t=1}^{n}\left( 1+e^{\frac{2\pi ix_1x_2\dots x_t}{n}} \right) \bmod{335544323}$$

输出所有 $k$ 个答案的异或和。

其中 $e^{it}=\cos{t}+i\sin{t}$ 对所有 $t \in \mathbb{R}$ 成立，$i$ 为虚数单位，满足 $i^2=-1$。

#### 样例解释：

对于第一组样例，$t=1,2$ 时答案分别为 $2,35184372088832$，取模后为 $2,201012021$，异或和为 $201012023$。

对于第二组样例，$t=1,2,3$ 时答案均为 $2$，异或和为 $2$。

限于篇幅，剩下的样例不作解释说明。

#### 数据范围：

**本题采用捆绑测试，各个 Subtask 的限制与分值如下：**

| Subtask No. | $n \le$ | $k \le$ | 特殊限制 | 分值 |
| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |
| $1$ | $10$ | $1$ | 无 | $7$ |
| $2$ | $1$ | $10$ | 无 | $7$ |
| $3$ | $10$ | $2$ | 无 | $7$ |
| $4$ | $10^{18}$ | $10^5$ | $n$ 为偶数 | $7$ |
| $5$ | $10$ | $10$ | $n^k \le 730$ | $16$ |
| $6$ | $10^9$ | $10^3$ | 无 | $19$ |
| $7$ | $10^{18}$ | $10^5$ | 无 | $37$ |

对于 $100\%$ 的数据，$1 \le n \le 10^{18},1 \le k \le 10^5$。


---

---
title: "[BalkanOI 2003] Farey 序列"
layout: "post"
diff: 省选/NOI-
pid: P8058
tag: ['2003', '二分', '数论', '素数判断,质数,筛法', '最大公约数 gcd', '莫比乌斯反演', 'Stern-Brocot 树', 'BalkanOI（巴尔干半岛）']
---
# [BalkanOI 2003] Farey 序列
## 题目描述

把所有分子和分母都 $\leq n$ 的**最简真分数**从小到大排成一行，形成的序列称为 Farey 序列。

求出 $n$ 所对应的 Farey 序列中第 $k$ 小的数。
## 输入格式

一行，两个整数 $n, k$。
## 输出格式

一行，两个整数 $p, q$，表示答案 $\frac{p}{q}$。
## 样例

### 样例输入 #1
```
5 6
```
### 样例输出 #1
```
3 5
```
## 提示

对于 $100\%$ 的数据，$2 \leq n \leq 4 \times 10^4$，$1 \leq k \leq$ 符合条件的分数的个数。


---

---
title: "[USACO22FEB] Sleeping in Class P"
layout: "post"
diff: 省选/NOI-
pid: P8193
tag: ['贪心', 'USACO', '2022', '数论', '素数判断,质数,筛法', '前缀和']
---
# [USACO22FEB] Sleeping in Class P
## 题目描述

最近终于线下授课了，奶牛 Bessie 十分兴奋！不幸的是，Farmer John 是一个非常无聊的讲师，因此她经常课堂上睡觉。

Farmer John 注意到了 Bessie 上课走神。他要求班上的另一个学生 Elsie 跟踪记录给定课上 Bessie 睡觉的次数。一共有 $N$ 堂课，Elsie 记录下了 Bessie 在第 $i$ 堂课睡了 $a_i$ 次。所有课上 Bessie 一共睡觉的次数最多为 $10^{18}$。

Elsie 认为自己是 Bessie 的竞争对手，所以她想让 FJ 觉得在每堂课上 Bessie 都一直睡了同样多次——让 FJ 觉得这个问题显然完全是 Bessie 的错，而不是 FJ 有时上课很无聊的问题。

Elsie 修改记录只有以下两种方式：把两堂课的记录合起来，或者把一堂课的记录分成两堂课。例如，如果 $a=[1,2,3,4,5]$，那么如果 Elsie 将第二堂和第三堂课的记录合起来，记录就会变为 $[1,5,4,5]$。如果 Elsie 继续选择让第三堂课的记录分为两堂，记录就可能变为 $[1,5,0,4,5],[1,5,1,3,5],[1,5,2,2,5],[1,5,3,1,5]$ 或 $[1,5,4,0,5]$。

给定 $Q$ 个候选的 Bessie 最不喜欢的数字 $q_1,\ldots,q_Q$，对于每个数字，请帮助 Elsie 计算她至少要操作多少次，才能让记录里的所有数字都变成这个数字。
## 输入格式

第一行一个整数 $N$（$2\le N\le 10^5$）。

第二行 $N$ 个整数 $a_1,a_2,\ldots, a_N$（$1\le a_i\le 10^{18}$）。

第三行一个整数 $Q$（$1\le Q\le 10^5$）。

接下来 $Q$ 行，每行一个整数 $q_i$（$1\le q_i\le 10^{18}$），表示 Bessie 最不喜欢的数字。
## 输出格式

对于每个 $q_i$，计算 Elsie 把记录里的每个数都变成 $q_i$ 所需要的最小操作次数。如果不能把所有数都变成 $q_i$，输出 $-1$。
## 样例

### 样例输入 #1
```
6
1 2 3 1 1 4
7
1
2
3
4
5
6
12
```
### 样例输出 #1
```
6
6
4
5
-1
4
5
```
## 提示

**【样例解释】**

Elsie 需要至少 $4$ 次修改才能让记录里的所有数都变成 $3$。

$$
\begin{aligned}
&\ 1\ 2\ 3\ 1\ 1\ 4\\
\rightarrow&\ 3\ 3\ 1\ 1\ 4\\
\rightarrow&\ 3\ 3\ 1\ 5\\
\rightarrow&\ 3\ 3\ 6\\
\rightarrow&\ 3\ 3\ 3\ 3\\
\end{aligned}
$$

Elsie 不可能把记录中的所有数都变成 $5$，因此输出 $-1$。这是正确的。

**【数据范围】**

- 对于第 $2\sim 4$ 组数据，$N,Q\le 5000$。
- 对于第 $5\sim 7$ 组数据，所有 $a_i$ 最多为 $10^9$。
- 对于第 $8\sim 26$ 组数据，无附加限制。


---

---
title: "[CQOI2016] 伪光滑数 加强版"
layout: "post"
diff: 省选/NOI-
pid: P8316
tag: ['动态规划 DP', '2016', '重庆', '各省省选', '优先队列', '可并堆', '可持久化', '素数判断,质数,筛法']
---
# [CQOI2016] 伪光滑数 加强版
## 题目背景

原题链接：[P4359 [CQOI2016] 伪光滑数](https://www.luogu.com.cn/problem/P4359)
## 题目描述

若一个大于 $1$ 的整数 $m$ 的**不去重**质因数分解有 $k$ 项，其最大的质因子为 $a_k$，并且满足 $a_{k}^{k} \leq n$，$a_k \leq 397$，我们就称整数 $m$ 为 $n$ - 伪光滑数。

给定整数 $n$，求出第 $k$ 大的 $n$ - 伪光滑数。
## 输入格式

一行，两个整数 $n, k$。
## 输出格式

一行，一个整数，表示所求的值。
## 样例

### 样例输入 #1
```
12345 20
```
### 样例输出 #1
```
9167
```
## 提示

对于 $100\%$ 的数据，$1 < n \leq 10^{11}$，$k \geq 1$，保证至少有 $k$ 个满足要求的数。


---

---
title: "[AHOI2022] 排列"
layout: "post"
diff: 省选/NOI-
pid: P8338
tag: ['数学', '暴力数据结构', '各省省选', '平衡树', '2022', '安徽', 'O2优化', '优先队列', '素数判断,质数,筛法']
---
# [AHOI2022] 排列
## 题目描述

对于一个长度为 $n$ 的排列 $P = (p_1, p_2, \ldots, p_n)$ 和整数 $k \ge 0$，定义 $P$ 的 $k$ 次幂

$$P^{(k)} = \left( p^{(k)}_1, p^{(k)}_2, \ldots, p^{(k)}_n \right),$$

该排列的第 $i$ 项为

$$p^{(k)}_i = \begin{cases} i, & k = 0, \\ p^{(k - 1)}_{p_i}, & k > 0. \end{cases}$$

容易证明任意排列的任意次幂都是一个排列。

定义排列 $P$ 的**循环值** $v(P)$ 为最小的**正整数** $k$ 使得 $P^{(k + 1)} = P$。

给出一个长度为 $n$ 的排列 $A = (a_1, a_2, \ldots, a_n)$，对于整数 $1 \le i, j \le n$，定义 $f(i, j)$：若存在 $k \ge 0$ 使得 $a^{(k)}_i = j$，则 $f(i, j) = 0$，否则设排列 $A_{i j}$ 为将排列 $A$ 的第 $i$ 项 $a_i$ 和第 $j$ 项 $a_j$ 交换后得到的排列，则 $f(i, j) = v(A_{i j})$。

求 $\sum_{i = 1}^{n} \sum_{j = 1}^{n} f(i, j)$ 的值。答案可能很大，你只需要输出其对 $({10}^9 + 7)$ 取模的结果。
## 输入格式

**本题有多组测试数据**。输入数据的第一行为一个整数 $T$，表示测试数据组数。

对于每组测试数据，第一行一个正整数 $n$ 表示排列的长度，接下来一行 $n$ 个整数 $a_1, a_2, \ldots, a_n$，描述输入的排列。
## 输出格式

对于每组数据输出一行一个整数，表示题目所求的答案对 $({10}^9 + 7)$ 取模的结果。
## 样例

### 样例输入 #1
```
2
3
1 2 3
3
2 3 1

```
### 样例输出 #1
```
12
0

```
## 提示

**【样例解释 #1】**

对于第一组测试数据，$f(1, 2) = f(2, 1) = f(2, 3) = f(3, 2) = f(1, 3) = f(3, 1) = 2$，其余的 $f(i, j)$ 均为 $0$。

对于第二组测试数据，所有的 $f(i, j)$ 均为 $0$。

**【样例 #2】**

见附件中的 `perm/perm2.in` 与 `perm/perm2.ans`。

该组样例中，第一个测试数据满足 $n \le 35$，前四个测试数据满足 $n \le 200$，所有测试数据满足 $n \le 2500$。

**【样例 #3】**

见附件中的 `perm/perm3.in` 与 `perm/perm3.ans`。

该组样例中，第一个测试数据满足特殊性质 A，第二个测试数据满足特殊性质 B，第三个测试数据满足特殊性质 C，前四个测试数据满足 $n \le {10}^5$，第五个测试数据满足 $n \le 5 \times {10}^5$。

特殊性质的具体内容参见数据范围部分。

**【数据范围】**

对于 $100 \%$ 的测试数据，$1 \le T \le 5$，$1 \le n \le 5 \times {10}^5$，$1 \le a_i \le n$。

| 测试点编号 | $n \le$ | 特殊性质 |
|:-:|:-:|:-:|
| $1 \sim 2$ | ${10}^5$ | A |
| $3$ | $35$ | 无 |
| $4$ | $200$ | 无 |
| $5$ | $2500$ | 无 |
| $6$ | ${10}^5$ | B |
| $7$ | ${10}^5$ | C |
| $8$ | ${10}^5$ | 无 |
| $9 \sim 10$ | $5 \times {10}^5$ | 无 |

特殊性质 A：$a_i = (i \bmod n) + 1$。  
特殊性质 B：对于任意 $1 \le i \le n$，存在 $1 \le k \le 20$，$a^{(k)}_i = i$。  
特殊性质 C：存在大小不超过 $10$ 的集合 $S$，使得对于任意 $1 \le i \le n$，存在 $x \in S, k \ge 0$，$a^{(k)}_x = i$。

**【提示】**

输入数据规模较大，请使用较为快速的输入方式。


---

---
title: "[蓝桥杯 2023 省 A] 翻转硬币"
layout: "post"
diff: 省选/NOI-
pid: P9238
tag: ['2023', 'O2优化', '素数判断,质数,筛法', '蓝桥杯省赛']
---
# [蓝桥杯 2023 省 A] 翻转硬币
## 题目描述

给定 $n$ 个按顺序摆好的硬币，一开始只有第 $1$ 个硬币朝下，其他硬币均朝上。你每次操作可以选择任何一个整数 $i$ 并将所有满足 $j \bmod i=0$ 的位置 $j$ 的硬币翻转。

求最少需要多少次操作可以让所有硬币都朝上。
## 输入格式

输入一行包含一个整数 $n$。
## 输出格式

输出一行包含一个整数表示最少需要的操作次数。
## 样例

### 样例输入 #1
```
7
```
### 样例输出 #1
```
6
```
### 样例输入 #2
```
1131796
```
### 样例输出 #2
```
688042
```
## 提示

#### 【评测用例规模与约定】

对于 $30 \%$ 的评测用例，$n \leq 5 \times 10^6$；

对于 $70 \%$ 的评测用例，$n \leq 10^9$；

对于所有评测用例，$1 \leq n \leq 10^{18}$。


---

---
title: "[POI 2020/2021 R3] Suma liczb pierwszych"
layout: "post"
diff: 省选/NOI-
pid: P9407
tag: ['2020', 'POI（波兰）', 'Special Judge', '素数判断,质数,筛法', '双指针 two-pointer', '根号分治']
---
# [POI 2020/2021 R3] Suma liczb pierwszych
## 题目背景

译自 [XXVIII Olimpiada Informatyczna - III etap](https://sio2.mimuw.edu.pl/c/oi28-3/dashboard/) [Suma liczb pierwszych](https://szkopul.edu.pl/problemset/problem/8brtPux-IyytS6rOoOR1cJTL/statement/)。

d2t3。
## 题目描述

给你一个数字 $n$，求 $l,r$，使 $[l,r]$ 区间内的所有质数之和等于 $n$。

如果有多解，任意一组均可；无解输出 `NIE`。
## 输入格式

一行一个正整数 $n$。
## 输出格式

如果有解，一行两个正整数 $l,r$，你的答案。

如果无解，输出 `NIE`。
## 样例

### 样例输入 #1
```
15

```
### 样例输出 #1
```
3 7

```
### 样例输入 #2
```
9992

```
### 样例输出 #2
```
4993 4999

```
### 样例输入 #3
```
100000000

```
### 样例输出 #3
```
NIE

```
### 样例输入 #4
```
1000000007

```
### 样例输出 #4
```
1000000007 1000000007

```
### 样例输入 #5
```
99999999996

```
### 样例输出 #5
```
295693 1693067

```
## 提示

对于所有数据，$1\leq n\leq 10^{11}$。

| 子任务编号 | 附加限制 | 分数 |
| :----------: | :----------: | :----------: |
| 1 | $n\leq 10000$ | 15 |
| 2 | $n\leq 10^8$ | 20 |
| 3 | $n\leq 2\times 10^9$ | 40 |
| 4 |  | 25 |


---

---
title: "「PHOI-1」斗之魂"
layout: "post"
diff: 省选/NOI-
pid: P9551
tag: ['数学', '数论', 'O2优化', '素数判断,质数,筛法', '快速数论变换 NTT']
---
# 「PHOI-1」斗之魂
## 题目背景

**本题数据已加强。**

小 X 忙了一天，于是打起了一款叫斗之魂的游戏。

![](https://cdn.luogu.com.cn/upload/image_hosting/5ha5fx0q.png)
## 题目描述

小 X 要击败 $n$ 个 BOSS，他可以选择以下两种击败 BOSS 的方式：

1. 独自一人击败第 $i$ 个 BOSS 并获得 $k_{i,0}$ 块稀有金属，且保证 $k_{i,0}=k_{i,1}=k_{i,2}$。
2. 和小 Y 一起击败第 $i$ 个 BOSS ，小 X 理应获得 $k_{i,1}$ 块稀有金属，小 Y 理应获得 $k_{i,2}$ 块稀有金属，但是 BOSS 本身实力并没有因为人数的改变而改变，击败难度相对要简单一点，所以系统判定两人实际各获得 $k_{i,0}$ 块稀有金属，其中保证 $\dfrac{1}{k_{i,0}}=\dfrac{1}{k_{i,1}}+\dfrac{1}{k_{i,2}}$。

小 X 已经计划好用第 $b_i$ 种方式击败第 $i$ 个 BOSS，但是考虑到某些因素，小 X 有 $q$ 次询问，每次询问给定一个正整数 $m$，为小 X 击败完所有 BOSS 后获得的稀有金属总数，已知 $k_{i,0},k_{i,1},k_{i,2}$ 均为正整数，求每次询问后所有可能的 $k$ 的值的方案数，两种方案不同当且仅当至少存在一个 $k$ 的值不同，由于这个答案可能很大，你只需要输出它对 $998244353$ 取模后的结果。
## 输入格式

第一行有两个整数 $n$ 和 $q$，分别表示 BOSS 个数和小 X 的询问次数。

第二行有 $n$ 个正整数 $b_i$，表示小 X 用 $b_i$ 种方式击败第 $i$ 个 BOSS。

接下来的 $q$ 行中每行有一个整数 $m$，为该次询问中小 X 击败完所有 BOSS 后获得的稀有金属总数。
## 输出格式

输出共 $q$ 行，第 $i$ 行输出一个答案为当小 X 击败完所有 BOSS 后获得的稀有金属总数为 $m$ 时，所有可能的 $k$ 的值的方案数并对它取模 $998244353$ 后的结果。
## 样例

### 样例输入 #1
```
2 2
2 1
3
4

```
### 样例输出 #1
```
4
7

```
### 样例输入 #2
```
5 5
1 2 1 2 1
4
6
8
10
12

```
### 样例输出 #2
```
0
9
119
630
2210
```
## 提示

**本题采用捆绑测试。**

| Subtask |      $n\le$       |      $m \le$      | $q \le$ |  时限  | 分值 |
| :-----: | :---------------: | :---------------: | :-----: | :----: | :--: |
|   $0$   |       $10$        |       $20$        |   $5$   |  $1s$  | $8$  |
|   $1$   |       $30$        |       $60$        |   $5$   |  $1s$  | $7$  |
|   $2$   |       $40$        |       $100$       | $10^3$  |  $1s$  | $5$  |
|   $3$   |       $150$       |       $500$       | $10^3$  |  $1s$  | $5$  |
|   $4$   |       $200$       |      $5000$       | $10^4$  |  $1s$  | $20$ |
|   $5$   |      $2000$       |  $5 \times 10^4$  | $10^5$  |  $1s$  | $25$ |
|   $6$   | $1.5 \times 10^5$ | $2.5 \times 10^5$ | $10^5$  | $1.8s$ | $30$ |

对于 $100\%$ 的数据，保证 $1 \le n \le 1.5 \times 10^5$，$1 \le m \le 2.5 \times 10^5$，$1 \le b_i \le 2$，$1 \le q \le 10^5$。

### 样例解释 #1：

- 当 $m=3$ 时，所有可能的 $k$ 的值的方案数为 $4$。

    第 $1$ 种：$k_{1,0}=1,k_{1,1}=k_{1,2}=2,k_{2,0}=k_{2,1}=k_{2,2}=2$

    第 $2$ 种：$k_{1,0}=2,k_{1,1}=3,k_{1,2}=6,k_{2,0}=k_{2,1}=k_{2,2}=1$

    第 $3$ 种：$k_{1,0}=2,k_{1,1}=k_{1,2}=4,k_{2,0}=k_{2,1}=k_{2,2}=1$

    第 $4$ 种：$k_{1,0}=2,k_{1,1}=6,k_{1,2}=3,k_{2,0}=k_{2,1}=k_{2,2}=1$

- 当 $m=4$ 时，所有可能的 $k$ 的值的方案数为 $7$。

    第 $1$ 种：$k_{1,0}=1,k_{1,1}=k_{1,2}=2,k_{2,0}=k_{2,1}=k_{2,2}=3$

    第 $2$ 种：$k_{1,0}=2,k_{1,1}=3,k_{1,2}=6,k_{2,0}=k_{2,1}=k_{2,2}=2$

    第 $3$ 种：$k_{1,0}=2,k_{1,1}=k_{1,2}=4,k_{2,0}=k_{2,1}=k_{2,2}=2$

    第 $4$ 种：$k_{1,0}=2,k_{1,1}=6,k_{1,2}=3,k_{2,0}=k_{2,1}=k_{2,2}=2$

    第 $5$ 种：$k_{1,0}=3,k_{1,1}=4,k_{1,2}=12,k_{2,0}=k_{2,1}=k_{2,2}=1$

    第 $6$ 种：$k_{1,0}=3,k_{1,1}=6,k_{1,2}=6,k_{2,0}=k_{2,1}=k_{2,2}=1$

    第 $7$ 种：$k_{1,0}=3,k_{1,1}=12,k_{1,2}=4,k_{2,0}=k_{2,1}=k_{2,2}=1$


---


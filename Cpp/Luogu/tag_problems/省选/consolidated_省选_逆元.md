---
title: "「Stoi2025」爱的飞行日记"
layout: "post"
diff: 省选/NOI-
pid: P11888
tag: ['2025', '数论', 'O2优化', '莫比乌斯反演', '容斥原理', '逆元', '洛谷比赛', '整除分块', 'Dirichlet 卷积', '筛法']
---
# 「Stoi2025」爱的飞行日记
## 题目背景

![](bilibili:BV1fx411N7bU?page=125)
## 题目描述

$t$ 组询问，每次询问给定正整数 $n,m$，计算

$$\prod_{a_1=1}^{m}\prod_{a_2=1}^{m}\cdots\prod_{a_n=1}^{m}\operatorname{lcm}(f_{a_1},f_{a_2},\dots,f_{a_n})\bmod{37426667}$$

的值。其中 $f_i$ 是斐波那契数，满足 $f_1=f_2=1$，且 $f_i=f_{i-1}+f_{i-2},\forall n\ge3$。
## 输入格式

第一行输入一个正整数 $t$ 表示询问组数。

接下来 $t$ 行，每行两个正整数 $n,m$ 表示一次询问。
## 输出格式

每次询问输出一行一个整数表示答案。
## 样例

### 样例输入 #1
```
2
1 3
2 3

```
### 样例输出 #1
```
2
32

```
## 提示

#### 样例解释

对于第一组询问，有答案为 $f_1f_2f_3=1\times1\times2=2$。

对于第二组询问，当 $a_1,a_2\in\{1,2\}$ 时 $\operatorname{lcm}(f_{a_1},f_{a_2})=1$，否则 $\operatorname{lcm}(f_{a_1},f_{a_2})=2$。故答案为 $2^5=32$。

#### 数据范围与限制

**本题采用捆绑测试，各 Subtask 的限制与分值如下。**

| Subtask No. | $t\le$ | $n\le$ | $m\le$ | 分值 |
| :-: | :-: | :-: | :-: | :-: |
| $1$ | $1$ | $2$ | $2 \times 10^3$ | $13$ |
| $2$ | $5$ | $2 \times 10^5$ | $2 \times 10^5$ | $24$ |
| $3$ | $5$ | $2 \times 10^7$ | $2 \times 10^7$ | $36$ |
| $4$ | $300$ | $2 \times 10^{17}$ | $2 \times 10^7$ | $27$ |

对于所有数据，满足 $1 \le t \le 300, 1 \le n \le 2 \times 10^{17}, 1 \le m \le 2 \times 10^7$。


---

---
title: "[HNOI2008] Cards"
layout: "post"
diff: 省选/NOI-
pid: P1446
tag: ['动态规划 DP', '数学', '2008', '各省省选', '湖南', '置换', '逆元']
---
# [HNOI2008] Cards
## 题目描述

小春现在很清闲，面对书桌上的 $n$ 张牌，他决定给每张牌染色，目前小春拥有 $3$ 种颜色：红色，蓝色，绿色。他询问 Sun 有多少种染色方案，Sun 很快就给出了答案。

进一步，小春要求染出 $S_r$ 张红色，$S_b$ 张蓝色，$S_g$ 张绿色。他又询问有多少种方案，Sun 想了一下，又给出了正确答案。最后小春发明了 $m$ 种不同的洗牌法，这里他又问 Sun 有多少种不同的染色方案。两种染色方法相同当且仅当其中一种可以通过任意的洗牌法（即可以使用多种洗牌法，而每种方法可以使用多次）洗成另一种。

Sun 发现这个问题有点难度，决定交给你，由于答案可能很大，你只需要求出答案对于 $P$ 取模的结果。 保证 $P$ 为一个质数。
## 输入格式

第一行输入 $5$ 个整数，依次表示：$S_r,S_b,S_g,m,P$（$m\le 60,m+1<p<100$）。其中，题面所提及的 $n$ 为 $S_r+S_b+S_g$，即 $n=S_r+S_b+S_g$。

接下来 $m$ 行，每行描述一种洗牌法，每行有 $n$ 个用空格隔开的整数 $X_1X_2...X_n$，保证其为 $1$ 到 $n$ 的一个排列，表示使用这种洗牌法，第 $i$ 位变为原来的 $X_i$ 位的牌。输入数据保证任意多次洗牌都可用这 $m$ 种洗牌法中的一种代替，且对每种洗牌法，都存在一种洗牌法使得能回到原状态。

同时，对于 $100\%$ 的数据满足 $\max\{S_r,S_b,S_g\}\le 20$ 。

## 输出格式

不同的染色方法对 $P$ 取模的结果。
## 样例

### 样例输入 #1
```
1 1 1 2 7
2 3 1
3 1 2

```
### 样例输出 #1
```
2

```
## 提示

有 $2$ 种本质上不同的染色法：`RGB` 和 `RBG`，使用洗牌法 `231` 一次，可得 `GBR` 和 `BGR`，使用洗牌法 `312` 一次，可得 `BRG` 和 `GRB`。



---

---
title: "[HNOI2011] 卡农"
layout: "post"
diff: 省选/NOI-
pid: P3214
tag: ['数学', '2011', '各省省选', '湖南', '组合数学', '逆元']
---
# [HNOI2011] 卡农
## 题目描述

众所周知卡农是一种复调音乐的写作技法，小余在听卡农音乐时灵感大发，发明了一种新的音乐谱写规则。  

他将声音分成 $n$ 个音阶，并将音乐分成若干个片段。音乐的每个片段都是由 $1$ 到 $n$ 个音阶构成的和声，即从 $n$ 个音阶中挑选若干个音阶同时演奏出来。  

为了强调与卡农的不同，他规定任意两个片段所包含的音阶集合都不同。同时为了保持音乐的规律性，他还规定在一段音乐中每个音阶被奏响的次数为偶数。  

现在的问题是：小余想知道包含 $m$ 个片段的音乐一共有多少种。  
两段音乐 $a$ 和 $b$ 同种当且仅当将 $a$ 的片段重新排列后可以得到 $b$。例如：假设 $a$ 为 $\{\{1,2\},\{2,3\}\}$，$b$ 为 $\{\{2,3\},\{1,2\}\}$，那么 $a$ 与 $b$ 就是同种音乐。

答案对 $10^8+7$ 取模。


## 输入格式

仅一行两个正整数 $n,m$

## 输出格式

输出一行一个整数表示答案。
## 样例

### 样例输入 #1
```
2 3
```
### 样例输出 #1
```
1
```
## 提示

【数据范围】  
对于 $20\%$ 的数据，$1\le n,m \le 5$；   
对于 $50\%$ 的数据，$1\le n,m \le 3000$；  
对于 $100\%$ 的数据，$1\le n,m \le 10^6$。 

【样例解释】   
音乐为 $\{\{1\},\{2\},\{1,2\}\}$



---

---
title: "奇数国"
layout: "post"
diff: 省选/NOI-
pid: P4140
tag: ['数学', '2014', '线段树', '树状数组', '素数判断,质数,筛法', '逆元', 'CTT（清华集训/北大集训）']
---
# 奇数国
## 题目描述

在一片美丽的大陆上有 $100\,000$ 个国家，记为 $1$ 到 $100\,000$。这里经济发达，有数不尽的账房，并且每个国家有一个银行。

某大公司的领袖在这 $100\,000$ 个银行开户时都存了 $3$ 大洋，他惜财如命，因此会不时地派小弟 GFS 清点一些银行的存款或者让 GFS 改变某个银行的存款。

该村子在财产上的求和运算等同于我们的乘法运算，也就是说领袖开户时的存款总和为 $3^{100000}$。这里发行的软妹面额是最小的 $60$ 个素数（$p_1=2,p_2=3,\ldots, p_{60}=281$），任何人的财产都只能由这 $60$ 个基本面额表示，即设某个人的财产为 $fortune$（正整数），则 $fortune=p_1^{k_1} \times p_2^{k_2} \times \ldots p_{60}^{k_{60}}$。

领袖习惯将一段编号连续的银行里的存款拿到一个账房去清点，为了避免 GFS 串通账房叛变，所以他不会每次都选择同一个账房。GFS 跟随领袖多年已经摸清了门路,知道领袖选择账房的方式。如果领袖选择清点编号在 $[a,b]$ 内的银行财产，他会先对 $[a,b]$ 的财产求和（记为 $product$），然后在编号属于 $[1,product]$ 的账房中选择一个去清点存款，检验自己计算是否正确同时也检验账房与 GFS 是否有勾结。GFS 发现如果某个账房的编号 $number$ 与 $product$ 相冲，领袖绝对不会选择这个账房。

怎样才算与 $product$ 不相冲呢？若存在整数 $x,y$ 使得 $number \times x+product \times y=1$，那么我们称 $number$ 与 $product$ 不相冲，即该账房有可能被领袖相中。当领袖又赚大钱了的时候，他会在某个银行改变存款，这样一来相同区间的银行在不同的时候算出来的 $product$ 可能是不一样的，而且领袖不会在某个银行的存款总数超过 $10^6$。

现在 GFS 预先知道了领袖的清点存款与变动存款的计划，想请你告诉他，每次清点存款时领袖有多少个账房可以供他选择，当然这个值可能非常大，GFS 只想知道对 $19\,961\,993$ 取模后的答案。
## 输入格式

第一行一个整数 $x$ 表示领袖清点和变动存款的总次数。

接下来 $x$ 行，每行 $3$ 个整数 $a_i,b_i,c_i$。$a_i$ 为 $0$ 时表示该条记录是清点计划，领袖会清点 $b_i$ 到 $c_i$ 的银行存款，你需要对该条记录计算出 GFS 想要的答案。$a_i$ 为 $1$ 时表示该条记录是存款变动，你要把银行 $b_i$ 的存款改为 $c_i$，不需要对该记录进行计算。

## 输出格式

对于每个询问，输出一行一个整数表示答案。
## 样例

### 样例输入 #1
```
6
0 1 3
1 1 5
0 1 3
1 1 7
0 1 3
0 2 3
```
### 样例输出 #1
```
18
24
36
6


```
## 提示

### 样例解释

- 初始化每个国家存款都为 $3$；
- $1$ 到 $3$ 的 $product$ 为 $27$，$[1,27]$ 与 $27$ 不相冲的有 $18$ 个数；
- $1$ 的存款变为 $5$；
- $1$ 到 $3$ 的 $product$ 为 $45$，$[1,45]$ 与 $45$ 不相冲的有 $24$ 个数；
- $1$ 的存款变为 $7$；
- $1$ 到 $3$ 的 $product$ 为 $63$，$[1,63]$ 与 $63$ 不相冲的有 $36$个数；
- $2$ 到 $3$ 的 $product$ 为 $9$，$[1,9]$ 与 $9$ 不相冲的有 $6$ 个数。

### 数据范围

所有数据均满足：$x \geq 1$，$c_i -b_i \geq 0$。

| 子任务编号 | 分值 |    $x \leq$     | $c_i - b_i \leq$ | 特殊性质 |
| :--------: | :--: | :-------------: | :--------------: | :------: |
|    $1$     | $20$ |     $10^4$      |      $100$       |    有    |
|    $2$     | $30$ | $5 \times 10^4$ |      $10^4$      |    无    |
|    $3$     | $50$ |     $10^5$      |      $10^5$      |    无    |

特殊性质指：所有 $product \leq 10^{18}$。


---

---
title: "【模板】多项式乘法逆"
layout: "post"
diff: 省选/NOI-
pid: P4238
tag: ['数学', '递推', '倍增', '递归', '逆元', '快速傅里叶变换 FFT']
---
# 【模板】多项式乘法逆
## 题目背景

注意：本题并不属于中国计算机学会划定的提高组知识点考察范围。
## 题目描述

给定一个多项式 $F(x)$ ，请求出一个多项式 $G(x)$， 满足 $F(x) * G(x) \equiv 1 \pmod{x^n}$。系数对 $998244353$ 取模。


## 输入格式

首先输入一个整数 $n$， 表示输入多项式的项数。  
接着输入 $n$ 个整数，第 $i$ 个整数 $a_i$ 代表 $F(x)$ 次数为 $i-1$ 的项的系数。  
## 输出格式

输出 $n$ 个数字，第 $i$ 个整数 $b_i$ 代表 $G(x)$ 次数为 $i-1$ 的项的系数。保证有解。
## 样例

### 样例输入 #1
```
5
1 6 3 4 9
```
### 样例输出 #1
```
1 998244347 33 998244169 1020
```
## 提示

对于 $100\%$ 的数据，$1 \leq n \leq 10^5$，$ 0 \leq a_i \leq 10^9$。


---

---
title: "[SHOI2016] 随机序列"
layout: "post"
diff: 省选/NOI-
pid: P4340
tag: ['2016', '线段树', '各省省选', '上海', '逆元']
---
# [SHOI2016] 随机序列
## 题目描述

你的面前有 $n$ 个数排成一行，分别为 $a_1,a_2,...,a_n$ 。你打算在每相邻的两个 $a_i$​​  和 $a_{i+1}$ 间都插入一个加号、减号或者乘号。那么一共有$3^{n-1}$ 种可能的表达式。

你对所有可能的表达式的值的和非常感兴趣。但这毕竟太简单了，所以你还打算支持一个修改操作，可以修改某个 $a_i$ 的值。

你能够编写一个程序对每个修改都输出修改完之后所有可能表达式的和吗？注意，修改是永久的，也就是说每次修改都是在上一次修改的基础上进行，而不是在最初的表达式上进行。
## 输入格式

第一行包含两个正整数 $n$ 和 $Q$，为数的个数和询问的个数。
第二行包含 $n$ 个非负整数，依次表示 $a_1,a_2,...,a_n$。
接下来 $Q$ 行，每行包含两个非负整数 $t$ 和 $v$，表示要将 $a_t$ 修改为 $v$，其中 $1≤t≤n$。

保证对于 $1≤j≤n$,$1≤i≤Q$，都有 $aj,vi≤10^4$

## 输出格式

输出 $Q$ 行。对于每个修改输出一行，包含一个整数，表示修改之后所有可能表达式的和，对 $10^9+7$ 取模。
## 样例

### 样例输入 #1
```
5 5
9384 887 2778 6916 7794
2 8336
5 493
3 1422
1 28
4 60
```
### 样例输出 #1
```
890543652
252923708
942282590
228728040
608998099
```
## 提示

对于20%的数据，n,q<=20

对于50%的数据，n,q<=1000

对于100%的数据，n,q<=100000

- 2023.11.17 添加一组 hack 数据。


---

---
title: "[CQOI2016] 密钥破解"
layout: "post"
diff: 省选/NOI-
pid: P4358
tag: ['2016', '重庆', '各省省选', '递归', '素数判断,质数,筛法', '逆元']
---
# [CQOI2016] 密钥破解
## 题目描述

一种非对称加密算法的密钥生成过程如下：

1.任选两个不同的质数$p,q$

2.计算$N=p \times q$，$r=(p-1)(q-1)$

3.选取小于$r$，且与$r$互质的整数$e$

4.计算整数$d$，使得$ed≡1(mod r)$

5.二元组$(N,e)$称为公钥，二元组$(N,d)$称为私钥。

当需要加密消息$n$时，（假设$n$是一个小于$N$的整数，因为任何格式的消息都可转为整数表示），使用公钥$(N,e)$，按照

$$n^e≡c(mod N)$$

运算，可得到密文$c$

对密文$c$解密时，用私钥$(N,d)$，按照

$$c^d≡n(mod N)$$

运算，可得到原文 $n$。算法正确性证明省略。

由于用公钥加密的密文仅能用对应的私钥解密，而不能用公钥解密，因此称为非对称加密算法。通常情况下，公钥由消息的接收方公开，而私钥由消息的接收方自己持有。这样任何发送消息的人都可以用公钥对消息加密，而只有消息的接收方自己能够解密消息。

现在，你的任务是寻找一种可行的方法来破解这种加密算法，即根据公钥破解出私钥，并据此解密密文。
## 输入格式

输入文件内容只有一行，为空格分隔的三个正整数$e,N,c$。
## 输出格式

输出文件内容只有一行，为空格分隔的两个整数$d,n$。
## 样例

### 样例输入 #1
```
3 187 45
```
### 样例输出 #1
```
107 12
```
## 提示

对于$30\%$的数据，$e,N,c \le 2^{20}$；

对于$100\%$的数据，$e,N,c \le 2^{62},c<N$


---

---
title: "[Code+#4] 组合数问题2"
layout: "post"
diff: 省选/NOI-
pid: P4370
tag: ['优先队列', '逆元', '队列', 'Code+']
---
# [Code+#4] 组合数问题2
## 题目描述

众所周知，小葱同学擅长计算，尤其擅长计算组合数，所以小葱给了你两个数 $n$ 和 $k$，希望你找到 $k$ 个不同的组合数使得这 $k$ 个组合数的和最大。所谓不同的组合数，即对于组合数 $C_{a_1}^{b_1}$​​​ 和 $C_{a_2}^{b_2}$，若 $a_1\neq a_2$ 或者 $b_1\neq b_2$​​，则我们认为这两个组合数是不同的。现在小葱希望你找到这样 $k$ 个不同的组合数，使得它们互不相同且对于其中任何一个组合数 $C_a^b$ 有 $0\leq b\leq a\leq n$。问这 $k$ 个组合数的和最大是多少？
## 输入格式

从标准输入读入数据。

第一行两个整数 $n,k$。

## 输出格式

输出到标准输出。

一行一个整数，代表 $k$ 个组合数的和对 $10^9+7$ 取模之后的结果；数据保证一定有至少 $k$ 个数可以选。

## 样例

### 样例输入 #1
```
2 3
```
### 样例输出 #1
```
4
```
## 提示

对于 $20\%$ 的数据，$n\leq 10$。

对于 $40\%$ 的数据，$n\leq 500$。

对于另外 $20\%$ 的数据，$k=1$。

对于 $100\%$ 的数据，$1\leq n\leq 10^6,1\leq k\leq 10^5.$

Credit: https://www.luogu.org/discuss/show/38908


---

---
title: "【模板】扩展卢卡斯定理/exLucas"
layout: "post"
diff: 省选/NOI-
pid: P4720
tag: ['中国剩余定理 CRT', '逆元', 'Lucas 定理']
---
# 【模板】扩展卢卡斯定理/exLucas
## 题目背景

这是一道模板题。
## 题目描述

求

$${\mathrm{C}}_n^m \bmod{p}$$

其中 $\mathrm{C}$ 为组合数。
## 输入格式

一行三个整数 $n,m,p$ ，含义由题所述。
## 输出格式

一行一个整数，表示答案。
## 样例

### 样例输入 #1
```
5 3 3
```
### 样例输出 #1
```
1
```
### 样例输入 #2
```
666 233 123456
```
### 样例输出 #2
```
61728
```
## 提示

对于 $100 \%$ 的数据，$1 \le m \le n \le {10}^{18}$，$2 \le p \le {10}^6$，**不保证** $p$ 是质数。


---

---
title: "[NOI2018] 屠龙勇士"
layout: "post"
diff: 省选/NOI-
pid: P4774
tag: ['2018', 'NOI', 'O2优化', '不定方程', '中国剩余定理 CRT', '逆元']
---
# [NOI2018] 屠龙勇士
## 题目描述

小 D 最近在网上发现了一款小游戏。游戏的规则如下：

- 游戏的目标是按照编号 $1 \rightarrow n$ 顺序杀掉 $n$ 条巨龙，每条巨龙拥有一个初始的生命值 $a_i$ 。同时每条巨龙拥有恢复能力，当其使用恢复能力时，它的生命值就会每次增加 $p_i$ ，直至生命值非负。只有在攻击结束后且当生命值 **恰好** 为 $0$ 时它才会死去。
- 游戏开始时玩家拥有 $m$ 把攻击力已知的剑，每次面对巨龙时，玩家只能选择一把剑，当杀死巨龙后这把剑就会消失，但作为奖励，玩家会获得全新的一把剑。

小 D 觉得这款游戏十分无聊，但最快通关的玩家可以获得 ION2018 的参赛资格，于是小 D 决定写一个笨笨的机器人帮她通关这款游戏，她写的机器人遵循以下规则：

- 每次面对巨龙时，机器人会选择当前拥有的，攻击力不高于巨龙初始生命值中攻击力最大的一把剑作为武器。如果没有这样的剑，则选择 **攻击力最低** 的一把剑作为武器。
- 机器人面对每条巨龙，它都会使用上一步中选择的剑攻击巨龙固定的 $x$ 次，使巨龙的生命值减少 $x \times ATK$ 。
- 之后，巨龙会不断使用恢复能力，每次恢复 $p_i$ 生命值。若在使用恢复能力前或某一次恢复后其生命值为 $0$ ，则巨龙死亡，玩家通过本关。

那么显然机器人的攻击次数是决定能否最快通关这款游戏的关键。小 D 现在得知了每条巨龙的所有属性，她想考考你，你知道应该将机器人的攻击次数 $x$ 设置为多少，才能用最少的攻击次数通关游戏吗？

当然如果无论设置成多少都无法通关游戏，输出 $-1$ 即可。
## 输入格式

第一行一个整数 $T$，代表数据组数。

接下来 $T$ 组数据，每组数据包含 $5$ 行。

- 每组数据的第一行包含两个整数，$n$ 和 $m$ ，代表巨龙的数量和初始剑的数量；
- 接下来一行包含 $n$ 个正整数，第 $i$ 个数表示第 $i$ 条巨龙的初始生命值 $a_i$；
- 接下来一行包含 $n$ 个正整数，第 $i$ 个数表示第 $i$ 条巨龙的恢复能力 $p_i$；
- 接下来一行包含 $n$ 个正整数，第 $i$ 个数表示杀死第 $i$ 条巨龙后奖励的剑的攻击力；
- 接下来一行包含 $m$ 个正整数，表示初始拥有的 $m$ 把剑的攻击力。
## 输出格式

一共 $T$ 行。

第 $i$ 行一个整数，表示对于第 $i$ 组数据，能够使得机器人通关游戏的最小攻击次数 $x$ ，如果答案不存在，输出 $-1$。
## 样例

### 样例输入 #1
```
2
3 3
3 5 7
4 6 10
7 3 9
1 9 1000
3 2
3 5 6
4 8 7
1 1 1
1 1
```
### 样例输出 #1
```
59
-1
```
## 提示

### 更多样例

更多样例请在附加文件中下载。

### 样例 2

见附加文件中的 `dragon2.in` 与 `dragon2.ans`。

### 样例 1 解释

第一组数据：
- 开始时拥有的剑的攻击力为 $\{1,9,10\}$，第 $1$ 条龙生命值为 $3$，故选择攻击力为 $1$ 的剑，攻击 $59$ 次，造成 $59$ 点伤害，此时龙的生命值为 $-56$，恢复 14 次后生命值恰好为 $0$，死亡。

- 攻击力为 $1$ 的剑消失，拾取一把攻击力为 $7$ 的剑，此时拥有的剑的攻击力为
$\{7,9,10\}$，第 2 条龙生命值为 $5$，故选择攻击力为 $7$ 的剑，攻击 $59$ 次，造成 $413$ 点伤害，此时龙的生命值为 $-408$，恢复 $68$ 次后生命值恰好为 $0$，死亡。

- 此时拥有的剑的攻击力为 $\{3,9,10\}$，第 $3$ 条龙生命值为 $7$，故选择攻击力为 $3$ 的剑，攻击 $59$ 次，造成 $177$ 点伤害，此时龙的生命值为 $-170$，恢复 $17$ 次后生命值恰好为 0，死亡。

- 没有比 $59$ 次更少的通关方法，故答案为 $59$。

第二组数据：
不存在既能杀死第一条龙又能杀死第二条龙的方法，故无法通关，输出 $-1$。

### 子任务

测试点编号 |　　　$n$　　　|　　　$m$　　　|　　　$p_i$　　　|　　　$a_i$　　　| 　　攻击力　　 | 其他限制
-|-|-|-|-|-|-
1|$\le 10^5$|$=1$|$=1$|$\le 10^5$|$=1$| 无
2|$\le 10^5$|$=1$|$=1$|$\le 10^5$|$=1$| 无
3|$\le 10^5$|$=1$|$=1$|$\le 10^5$|$\le 10^5$| 无
4|$\le 10^5$|$=1$|$=1$|$\le 10^5$|$\le 10^5$| 无
5|$\le 10^3$|$\le 10^3$|$\le 10^5$|$\le 10^5$|$\le 10^5$| 特性 1、特性 2
6|$\le 10^3$|$\le 10^3$|$\le 10^5$|$\le 10^5$|$\le 10^5$| 特性 1、特性 2
7|$\le 10^3$|$\le 10^3$|$\le 10^5$|$\le 10^5$|$\le 10^5$| 特性 1、特性 2
8|$=1$|$=1$|$\le 10^8$|$\le 10^8$|$\le 10^6$| 特性 1
9|$=1$|$=1$|$\le 10^8$|$\le 10^8$|$\le 10^6$| 特性 1
10|$=1$|$=1$|$\le 10^8$|$\le 10^8$|$\le 10^6$| 特性 1
11|$=1$|$=1$|$\le 10^8$|$\le 10^8$|$\le 10^6$| 特性 1
12|$=1$|$=1$|$\le 10^8$|$\le 10^8$|$\le 10^6$| 特性 1
13|$=1$|$=1$|$\le 10^8$|$\le 10^8$|$\le 10^6$| 特性 1
14|$=10^5$|$=10^5$|$=1$|$\le 10^8$|$\le 10^6$| 无特殊限制
15|$=10^5$|$=10^5$|$=1$|$\le 10^8$|$\le 10^6$| 无特殊限制
16|$\le 10^5$|$\le 10^5$| 所有 $p_i$ 是质数 |$\le 10^{12}$|$\le 10^6$| 特性 1
17|$\le 10^5$|$\le 10^5$| 所有 $p_i$ 是质数 |$\le 10^{12}$|$\le 10^6$| 特性 1
18|$\le 10^5$|$\le 10^5$| 无特殊限制 |$\le 10^{12}$|$\le 10^6$| 特性 1
19|$\le 10^5$|$\le 10^5$| 无特殊限制 |$\le 10^{12}$|$\le 10^6$| 特性 1
20|$\le 10^5$|$\le 10^5$| 无特殊限制 |$\le 10^{12}$|$\le 10^6$| 特性 1

特性 1 是指：对于任意的 $i$，$a_i \le p_i$。

特性 2 是指：$\operatorname{lcm}(p_i) \le 10^6$，即所有 $p_i$ 的 **最小公倍数** 不大于 $10^6$。

对于所有的测试点，$T \le 5$，所有武器的攻击力 $\le 10^6$，所有 $p_i$ 的最小公倍数 $\le 10^{12}$。

保证 $ T, n, m $ 均为正整数。

### 提示

你所用到的中间结果可能很大，注意保存中间结果的变量类型。


---

---
title: "萨塔尼亚的期末考试"
layout: "post"
diff: 省选/NOI-
pid: P4834
tag: ['数学', '斐波那契数列', '逆元']
---
# 萨塔尼亚的期末考试
## 题目背景

“呐，珈百璃，我说，暑假我们去哪里玩呢？”薇奈特拍拍珈百璃的肩膀

“哈？暑假当然是在家里打游戏啦”珈百璃无精打采地回答道

“怎么能这样呢？你好歹也是天使啊，给我拿出天使的样子来啊”

“真麻烦”

“所以，暑假我们去海边玩吧？”

“赞成赞成！去海边玩的话，就可以好好调戏珈百璃了”菈菲尔不知道什么时候凑进来

“麻烦死了。”

这边一群人正讨论着暑假去哪玩，然而萨塔尼亚在旁边听得很纠结，因为没有人邀请她。。

“哼哼哼哼，吾乃神魔萨塔尼亚，怎么可能主动去加入呢，我必须等她们邀请我”萨塔尼亚心理打着小算盘

“呐，我说，萨塔尼亚貌似有点小不开心呀”

“已经不是貌似了吧，她这表情完全没有掩盖的意思啊。。”

“呐，我说，要不要邀请她去啊？”

拉菲尓说着，走向了萨塔尼亚。“萨塔尼亚桑，暑假我们要去海边玩哟~”

“哼哼哼，终于来邀请我了吗”萨塔尼亚心里有点小开心，小声嘀咕到

“萨塔尼亚桑就好好待在这里哟~”

“额。。。”萨塔尼亚受到了成吨的暴击，“喂，我说，哪有你这样的啊”

“恩？因为，萨塔尼亚桑，暑假如果要出去玩的话，就要通过期末考试哟，不然会被留下来补课的”

“补。。。补课。。。。”萨塔尼亚貌似意会到了什么，脸色大变，“补课。。。呐，拉菲尓。。你。。你能帮我。。补习吗？”

“恩？可以呀~但是期末考试如何就得看你自己了”

“谢谢，那帮我看看这些哪里错了吧？我完全不懂诶”

“我看看。。。” 拉菲尓丢下珈百璃和薇奈特独自给萨塔尼亚开始了补习。

终于，期末考来了，萨塔尼亚努力的这么久，就看这次考试了！经过长期的努力，期末考一切顺利，除了还没考的数学其他学科都及格啦！

终于到了最后一场考试——物理考试。很不错的是，萨塔尼亚已经答完了59分而且全对，但是她遇到了一道绝世难题，而且她很惊奇的发现，总分100分，这题41分，如果不写出来，就会挂科。“期末考如果有某人有挂科，那么那个人的暑假要参加补课以及补考！”班主任的话萦绕在她的耳旁，这可怎么办啊。。。

## 题目描述

这道题是这样的：

有一个由 $n$ 个点电荷形成的电场。假定每个点电荷放出的电场都是匀强电场而不是点电荷电场，第 $i$ 个点电荷的电场强度 $E_i=i$。

现放一个带负电的试探电荷到这个电场中，这个试探电荷只要触碰到任何一个点电荷就会和这个点电荷发生聚变放出巨大能量。

因为点电荷放出的电场强度不同，所以试探电荷被吸引到每个点电荷的概率也不同，点电荷给试探电荷的吸引力越大被吸到这个点电荷的概率就越大，且成正比。

我们假设最小的点电荷给试探电荷的吸引力为 $F$，那么对于其他点电荷给试探电荷和吸引力就是 $iF$，那么假设触碰最小的点电荷的概率为 $P$，则每个点的概率就是 $iP$，触碰到点电荷后发出的能量为 $\mathrm{Fib}(E_i)$。

求期望放出的能量。

好消息是，只要这道题拿到分，萨塔尼亚就能及格啦！

## 输入格式

第一行一个整数 $T$，表示共有 $T$ 组测试数据。

接下来 $T$ 行每行一个整数 $n$，表示有 $n$ 个点电荷。

## 输出格式

对于每次询问输出一行一个整数表示期望能量。为了避免精度问题，请输出答案对 $998{,}244{,}353$ 取模后的结果。
## 样例

### 样例输入 #1
```
1
2

```
### 样例输出 #1
```
1
```
## 提示

### 样例解释

$\dfrac{1}{3}\times \mathrm{Fib}(1)+\dfrac{2}{3}\times \mathrm{Fib}(2)=1$。

请结合样例仔细再仔细的读题！

### 数据范围

- 对于 $10\%$ 的数据 $T=1$，$n=2$；
- 对于 $30\%$ 的数据 $T≤10$，$1\le n\le 10^6$；
- 对于 $60\%$ 的数据 $T≤10^6$，$1\le n\le 10^6$；
- 对于 $100\%$ 的数据 $T≤10^6$，$1\le n\le 10^9$，保证 $n \ne 998244352$ 且 $n \ne 998244353$。

$\mathrm{Fib}(i)$ 为斐波那契数列。

$$\mathrm{Fib}(i)=\begin{cases}
1 & i\le 2 \cr
\mathrm{Fib}(i-1)+\mathrm{Fib}(i-2) & i > 2
\end{cases}$$



---

---
title: "食堂"
layout: "post"
diff: 省选/NOI-
pid: P4900
tag: ['O2优化', '素数判断,质数,筛法', '前缀和', '逆元']
---
# 食堂
## 题目背景

我CYJian就是死，死外边，从这跳下去，也不会吃食堂一口饭。

$$\color{white}\text{真香。。}$$
## 题目描述

食堂第$i$天有$i$道菜.$CYJian$觉得第$i$天的第$j$道菜的美味程度为$\lbrace \frac{i}{j} \rbrace$({}就是取小数部分),当然,$CYJian$是一个勇于尝试的人,所以每一道菜都会吃那么一点.

现在CYJian有$T$个问题,每一个问题都是从第$A_i$天到第$B_i$天得到的美味值的总和.现在请你帮他算一算吧!请输出答案模$998244353$的值.
## 输入格式

第一行一个数T。

接下来T行，每一行一共两个数，表示每一次询问的$A$和$B$。
## 输出格式

T行，每行一个正整数表示美味值之和.**如果答案可以表示成$\frac{P}{Q}$的形式,则需要找到任意一个$x$使得$Q \times x \equiv P (\bmod\ 998244353)$,并且输出$x \bmod 998244353$**
## 样例

### 样例输入 #1
```
1
1 3

```
### 样例输出 #1
```
499122177

```
## 提示

样例解释：第一天美味值为0.00，第二天美味值为0.00+0.00=0.00，第三天美味值为0.00+0.50+0.00=0.50，0.00+0.00+0.50=0.50=$\frac{1}{2}$,$499122177 \times 2 \equiv 1 (\bmod\ 998244353)$,所以答案为499122177.

数据范围：

| 数据点范围 | $T$= | $A\leqslant B \leqslant$ |
|:-------------------------:|:-----------------------:|:--------------:|
| $1 \sim 5$ | $1$ | $5000$  |
| $6 \sim 10$ | $1$ | $10^6$  |
| $10 \sim 15$ | $10^6$ | $5000$  |
| $16 \sim 20$ | $10^6$ | $10^6$  |

注意: **本题捆绑测试**


---

---
title: "乘积"
layout: "post"
diff: 省选/NOI-
pid: P4902
tag: ['O2优化', '前缀和', '逆元', '差分']
---
# 乘积
## 题目背景

$CYJian$在经过多次加强后的题目..
## 题目描述

给出$A$,$B$,求下面的式子的值.

$$\prod_{i=A}^{B}\prod_{j=1}^{i}(\frac{i}{j})^{\lfloor \frac{i}{j} \rfloor}\ (\bmod \ 19260817)$$

包含$T$组询问.

------

听说有许多人看不懂公式？？

好吧。。这里给出伪代码：

```
for i=A to B
  for j=1 to i
    res = res * power(i/j, floor(i/j))
res = solve(res)
```

最后的solve表示处理成分数取模的形式。。

不保证这样精度不会原地起爆。。
## 输入格式

第一行一个正整数$T$.

接下来$T$行每行两个正整数表示这一组询问的$A$,$B$
## 输出格式

$T$行,每行一个正整数表示这一组询问的答案.
## 样例

### 样例输入 #1
```
1
1 3

```
### 样例输出 #1
```
162

```
## 提示

样例解释: $1 \times 4 \times 1 \times 27 \times \frac{3}{2} \times 1 \equiv 162$

| 数据点范围 | $T$= | $A\leqslant B \leqslant$ |
|:-------------------------:|:-----------------------:|:--------------:|
| $1 \sim 5$ | $1$ | $5000$  |
| $6 \sim 10$ | $1$ | $10^6$  |
| $11 \sim 15$ | $10^6$ | $5000$  |
| $16 \sim 20$ | $10^6$ | $10^6$  |

注意: **本题捆绑测试**


---

---
title: "天守阁的地板"
layout: "post"
diff: 省选/NOI-
pid: P4917
tag: ['O2优化', '枚举', '前缀和', '逆元']
---
# 天守阁的地板
## 题目背景

在下克上异变中，博丽灵梦为了找到异变的源头，一路打到了天守阁。  

异变主谋鬼人正邪为了迎击，将天守阁反复颠倒过来，而年久失修的天守阁也因此掉下了很多块地板。    

异变结束后，恢复了正常大小的小碗回到了天守阁，想要修复这里的地板，她需要知道自己要采购的地板数量(一个惊人的数字)，于是，她找到了精通 $\text{OI}$ 的你来帮忙。   

## 题目描述

为了使万宝槌能发挥出全部魔力，小碗会将买来的地板铺满一个**任意**边长的正方形(地板有图案，因此**不允许旋转**，当然，地板也**不允许重叠**)来达到最大共鸣。  

在每一次购买中，小碗只能买到一种规格为 $a*b$ 的地板，为了省钱，她会在满足能摆成正方形的前提下购买尽可能少的地板。  
  
现在，她想知道对于每一对 $a,b(1≤a,b≤n)$ ，她最少需要购买的地板数量。当然，由于输出可能很大，你只需要输出所有答案的乘积对 `19260817` 取模后的结果即可。    
## 输入格式

第一行一个整数 $\text{T}$ ，表示数据组数  

下面 $\text{T}$ 行，每行一个整数 $n$ 
## 输出格式

共 $\text{T}$ 行，每行一个整数，表示取模后的答案
## 样例

### 样例输入 #1
```
4
1
2
3
100
```
### 样例输出 #1
```
1
4
1296
18996121
```
## 提示

#### 样例解释:  

对于`n=1`，$(a,b)$ 仅有 $(1,1)$ 一种情况，只需要一块 $1 * 1$ 的地板即可构成边长为1的正方形,答案为 $1$  

对于`n=2`，$(a,b)$ 有 $(1,1),(1,2),(2,1),(2,2)$ 四种情况，分别需要 $1,2,2,1$ 块地板以拼成正方形，答案为 $1*2*2*1=4$  

进一步解释：  

当只能买到 $1*1$ 的地板时，只需要一块(本身就是正方形)  

当只能买到 $1*2$ 的地板时，需要两块(两块拼在一起组成 $2*2$ 的正方形)  
  
#### 数据范围：

对于 $30\%$ 的数据，$1 \le T \le 100,1 \le n \le 100$  

对于 $60\%$ 的数据，$1 \le T \le 300,1 \le n \le 3*10^4$   

对于 $100\%$ 的数据，$1 \le T \le 1000,1 \le n \le 10^6$    


---

---
title: "【XR-2】约定"
layout: "post"
diff: 省选/NOI-
pid: P5437
tag: ['数学', '生成树', '期望', '逆元']
---
# 【XR-2】约定
## 题目背景

>「小圆，不要走！这一分离，我们何时才能重逢？」
>
>「小焰，我们一定还会相见的！在那之前，我们只是短暂的离别啊......」
## 题目描述

只因为那一句约定，小焰开始了看不到尽头的等待。

约定在小焰心中幻化成了一张 $n$ 个点的图。一开始，这是一张完全图，其中点的编号从 $1$ 到 $n$，连接点 $i,j$ 的边的权值为 $(i+j)^k$。

然而等待的过程中，岁月也在逐渐消磨着她的信仰，因此图中的一些边被随机地删掉了。最终，图变成了一棵 $n$ 个点的树，永远地留在了小焰的心中。

很久很久以后，小焰的魔力耗尽，在痛苦与绝望之中濒临崩溃。而就在这时，小圆终于来找小焰了。为了拯救自己唯一的朋友，她必须知道这棵树边权和的期望值对 $998244353$ 取模的结果是多少。

你能帮小圆求出答案，让她完成那个约定吗？
## 输入格式

一行两个正整数 $n,k$。
## 输出格式

一行一个整数，表示答案对 $998244353$ 取模后的值。
## 样例

### 样例输入 #1
```
3 1

```
### 样例输出 #1
```
8

```
### 样例输入 #2
```
4 3

```
### 样例输出 #2
```
450

```
### 样例输入 #3
```
1926 817

```
### 样例输出 #3
```
984167516

```
## 提示

【样例 $1$ 说明】

这个完全图有 $3$ 个节点，$3$ 条边，形成了一个环。  
这些边的权分别为：$3,4,5$   
最后形成的树也有 $3$ 种可能，权值分别为：$7,8,9$  
期望值为 $8$。

【数据规模与约定】

**本题采用捆绑测试。**

Subtask 1（5 points）：$1 \le n \le 5$，$1\le k \le 10$。     
Subtask 2（11 points）：$k = 1$。  
Subtask 3（11 points）：$1 \le n,k \le 20000$。  
Subtask 4（13 points）：$1 \le n,k \le 10^5$。   
Subtask 5（23 points）：$1 \le k \le 10^5$。  
Subtask 6（37 points）：无特殊限制。

对于 $100\%$ 的数据，$1\le n \le 998244352,1\le k \le 10^7$。
****
>「抱歉，让你久等了...... 你一直努力到了今天吧......」  
>
>「小圆......」
>
>「来，我们走吧。今后我们永不分离......」
>
>「是啊，我等这一刻——望眼欲穿。」


---

---
title: "【XR-2】约定 (加强版)"
layout: "post"
diff: 省选/NOI-
pid: P5442
tag: ['数学', 'O2优化', '期望', '逆元']
---
# 【XR-2】约定 (加强版)
## 题目背景

原题链接：[P5437](https://www.luogu.org/problemnew/show/P5437)

其实在比赛时就想放上这个加强版了qwq    
但是团队成员都强烈反对，于是就在赛后放上来啦
## 题目描述

有一个 $n$ 个点的完全图，编号从 $1$ 到 $n$。  
连接 $i$ 和 $j$ 节点的边，权值为 $(i+j)^k$。  
定义一棵树的权值为其所有边的权值和。  
从这个图的所有生成树中随机选择一个，求其权值的期望。  
需要将答案对 $998244353$ 取模。
## 输入格式

一行两个正整数 $n,k$。
## 输出格式

一行一个整数表示答案对 $998244353$ 取模的结果。
## 样例

### 样例输入 #1
```
3 1
```
### 样例输出 #1
```
8
```
### 样例输入 #2
```
4 3
```
### 样例输出 #2
```
450
```
### 样例输入 #3
```
1926 817
```
### 样例输出 #3
```
984167516
```
### 样例输入 #4
```
998244353 1
```
### 样例输出 #4
```
998244352
```
## 提示

### 数据范围：   
$1\le n \le 10^{10000}$  
$1\le k \le 10^7$



---

---
title: "随机红包"
layout: "post"
diff: 省选/NOI-
pid: P6130
tag: ['数学', 'O2优化', '前缀和', '逆元']
---
# 随机红包
## 题目背景

出题人准备发一个微信红包给一些人，他很好奇如何随机分配里面的钱。
## 题目描述

出题人蒟蒻的红包里有着 $1$ 块钱，他要把这块钱随机分给 $n$ 个人。

为了随机，他设计了以下算法进行分配：（用伪代码表示）
```
a[0]=0,a[n]=1
for i=1 to n-1 do{
    a[i]=rand()
}
sort(a)
for i=1 to n do{
    money[i]=a[i]-a[i-1]
}
```
这里的 `rand()` 函数会等概率随机返回一个 $[0,1]$ 之间的实数值，`sort()` 函数会将一个数组从小到大排序。

现在，出题人蒟蒻很好奇得到钱数第 $k$ 少的人得到的钱的期望。

由于他要根据这个值去推算他要发多少个红包，所以他要问你 $T$ 次。

为了避免精度丢失，答案对 $998244353$ 取模。

为了避免输出量过大，输出所有答案的异或和。
## 输入格式

**本题有多组数据**。

第一行为整数 $T$，表示数据组数。

对于每组数据，一行两个整数 $n,k$。
## 输出格式

共一行一个整数，表示所有询问的答案的异或和。
## 样例

### 样例输入 #1
```
3
1 1
2 2
2 1
```
### 样例输出 #1
```
574619649
```
## 提示

**【样例解释】**

第一个问题，$n=k=1$，答案是 $1$。

第二个问题，较大的数在 $[\dfrac{1}{2},1]$ 上均匀分布，期望为 $\dfrac{3}{4}$，取模后为 $249561089$。

第三个问题，较小的数在 $[0,\dfrac{1}{2}]$ 上均匀分布，期望为 $\dfrac{1}{4}$，取模后为 $748683265$。

异或和为 $574619649$。

------

**【数据范围】**

**本题采用捆绑测试**。

$\text{Subtask 1 (4 pts)}$：$n \le 10$，$k=1$。

$\text{Subtask 2 (16 pts)}$：$n \le 5 \times 10^3$。

$\text{Subtask 3 (20 pts)}$：$k=1$。

$\text{Subtask 4 (28 pts)}$：$n \le 10^5$。

$\text{Subtask 5 (32 pts)}$：没有任何额外限制。

对于 $100\%$ 的数据，$1 \le k \le n \le 10^7$，$1 \le T \le 2 \times 10^5$。


---

---
title: "「EZEC-6」0-1 Trie"
layout: "post"
diff: 省选/NOI-
pid: P7386
tag: ['动态规划 DP', '组合数学', '逆元', '构造', 'Lucas 定理']
---
# 「EZEC-6」0-1 Trie
## 题目背景

> $\mathbf{000111}$，这就是简单中所蕴含的优美。

众所周知，tlx 不会字符串。
## 题目描述

现在 tlx 有 $n$ 个 $\mathbf{1}$ 和 $m$ 个 $\mathbf{0}$，你需要把它们排列，但要保证任意的 $\mathbf{1}$ 互不相邻且第一个位置是 $\mathbf{0}$、最后一个位置是 $\mathbf{1}$，现在把所有可以构造出的串放到一棵 0-1 Trie 上，需要多少个节点？

**注意：节点计数时，不计算最开始的空节点，只计算代表“ $\mathbf{0}$ ”、“ $\mathbf{1}$ ”的节点。**  

**在本题中，我们认为用节点存储字符而非边， Trie 基本原理不变。**

因为答案可能很大而且询问较多，所以请在最后输出所有询问的答案对 $18888913$ （放心，是个质数）取模的结果的异或和（**异或和不再进行取模**）。
## 输入格式

第一行是一个正整数 $T$，代表数据组数。  

接下来 $T$ 行，每行两个正整数 $n,m$，分别代表 $\mathbf{1,0}$ 的个数。
## 输出格式

共一行一个整数，代表所有结果的异或和。
## 样例

### 样例输入 #1
```
1
2 4
```
### 样例输出 #1
```
15
```
### 样例输入 #2
```
2
3 5
114514 1919810
```
### 样例输出 #2
```
4487351

```
### 样例输入 #3
```
5
78 122
1000000 1000001
74859432 942432534
555555555 77777777 
6666666666 8888888888
```
### 样例输出 #3
```
12287990
```
## 提示

**【样例解释 #1】**

可以发现，所有能构造出的串有：  

$$\mathbf{000101}$$
$$\mathbf{001001}$$
$$\mathbf{010001}$$

构造 0-1 Trie，如图：

![](https://cdn.luogu.com.cn/upload/image_hosting/aql3bwo6.png)

共需 $15$ 个节点。


**【样例解释 #2】**

两次询问的答案分别为 $34$ 和 $4487317$。

------------

**【数据规模与提示】**

注意：本题采用**捆绑测试**，只有当你通过一个 Subtask 内的所有测试点后，你才能拿到这个 Subtask 的分数。

具体约束如下：  

Subtask $1$（$10\%$）：满足 $T\leq 10$，$n,m\leq 5$；

Subtask $2$（$20\%$）：满足 $T \leq 10$，$n,m\leq 1\times 10^3$；

Subtask $3$（$30\%$）：满足 $T\leq 10$，$n,m\leq 5\times 10^5$;


Subtask $4$（$40\%$）：无特殊限制。

对于 $100\%$ 的数据，满足 $1\le T \le 2\times10^6$，$1\le n,m\le 5\times 10^{18}$。

**本题输入量较大，建议采用较为快速的读入方式并注意常数因子对程序效率带来的影响。**



------------
 0-1 Trie 是一种特殊的 Trie ，只有 $\mathbf{0,1}$ 两种字符。
 
 如果你不了解 Trie，可以查看：[OI Wiki--Trie](https://deploy-preview-980--oi-wiki.netlify.app/string/trie/)。


---


---
title: "UCV2013D - Distributing V-Energy"
layout: "post"
diff: 难度0
pid: SP15432
tag: []
---

# UCV2013D - Distributing V-Energy

## 题目描述

你现在需要处理一种名为 V 能量的新型能源，这种能源比电力更便宜，并且具有一些非常有趣的特性。V 能量的公司已经进入了你的城市，并计划建立分配中心。你得到了一张城市的地图，其中标明了分配中心的位置。你需要报告城市中某个建筑物能够接收到的最小能量值，以及有多少建筑物接收到了这个能量值。

V 能量的传递遵循以下规则：

- 如果一个建筑物有 $K$ 单位的 V 能量，该建筑物将消耗 $C$ 单位，剩余的 $K - C$ 单位能量会分发给连接的其他建筑物。如果 $K < C$，则该建筑物将消耗全部 $K$ 能量，不会分发任何能量。
- 如果一个建筑物从不同来源接收到 V 能量，它将只使用并分发最大值能量。例如，一个建筑物如果最初收到 $K = 8$，它消耗 $3$，分发 $5$，随后再收到 $K = 6$，不会作用于该能量，因为之前收到的能量更大。假如后来收到 $K = 15$，它将消耗 $3$ 并分发 $12$。

城市是一个网格状结构，建筑物位于每个街道交叉口上。由于 V 能量只在街道上传播，城市的街道网络正适合用于此次规划。大道水平延伸，而街道垂直延伸。有时街道或大道可能会被阻塞。例如，下图中第 1 条街在大道 1 和 2 之间被阻塞，而第 2 条大道在街道 0 和 1 之间被阻塞。

![Streets and avenues sample](https://cdn.luogu.com.cn/upload/vjudge_pic/SP15432/b1d743a39ed5d749a6ccdc4dd070ed266d4a19a7.png)

## 输入格式

输入包含多个测试用例。每组测试用例的第一行含有两个整数 $K$ 和 $C$，分别表示每个分配中心拥有的 V 能量和每个建筑物消耗的能量，$0 \leq C, K \leq 10000$。接下来一行有两个整数 $N$ 和 $M$，分别表示城市中的大道数和街道数，$1 \leq N, M \leq 1000$。接下来一行有一个整数 $B$，表示阻塞的街道和大道段的数量，$0 \leq B \leq N \times M - N - M$。

接下来的 $B$ 行每行包含四个整数 $T, I, J1, J2$。$T$ 表示段的类型，可以为 'A'（大道段）或 'S'（街道段）。$I$ 表示街道或大道的索引（$0 \leq I < N$）。如果是大道段，则 $J1, J2$ 分别是起始和结束街道的索引；如果是街道段，$J1, J2$ 分别是起始和结束大道的索引（$0 \leq J1 < J2 \leq M$）。

接下来一行有一个整数 $D$，表示分配中心的数量，$0 \leq D \leq \min(1000, N \times M)$。接下来的 $D$ 行，每行有两个整数 $Ai, Si$，表示分配中心位于大道 $Ai$ 和街道 $Si$ 的交叉点（$0 \leq Ai < N, 0 \leq Si < M$）。

以一组 $K = C = 0$ 的输入作为结束标志。

## 输出格式

对于每个测试用例，输出一行，包含两个整数 $Q$ 和 $P$，分别表示到达城市中建筑物的最小能量值，以及具有该能量值的建筑物数量。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
2 1\n2 3\n0\n2\n0 0\n0 2\n12 2\n3 3\n2\nA 2 0 1\nS 1 1 2\n1\n2 0\n0 0
```

### 输出

```
0 1\n2 1 \n
```


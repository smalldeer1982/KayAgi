---
title: "SCYPHER - Substitution Cipher"
layout: "post"
diff: 难度0
pid: SP44
tag: []
---

# SCYPHER - Substitution Cipher

## 题目描述

Malidinesia的古典喜剧演员将表演一个新发现的，由古希腊早期喜剧代表作家Aristophanes的喜剧。将其在舞台上表演对于观众有着极大的震撼，所以所有的准备工作将秘密进行。ACM的导演怀疑他的一个竞争对手会拦截他的通信。为了防止别的公司发现他的秘密，他决定在所有有关新的表演的信中用一种替换密码来隐藏。
   
  替换密码规则是有一个替换密码表来决定的。这个表是一个双射（数学名词，每一个字符都有一个确定的字符与其替换，但不一定所有替换字符都不一样）。导演害怕替换表会泄露，所以他隔一段时间就会改变替换规则。每次改变过后他会随机从字典中挑出一些单词，将这些单词加密后他会将加密后的信息发出。原码（未加密的）将会从一个安全的渠道中发出（非邮件）。接收信息的人会比对原码和加密码然后更新替换表。

不幸的是，ACM的一个密码学家发现这个系统有时候不安全。有些信息会被对手公司解码在不知道原码的情形下。原因在于，在导演从字典中选出单词并加密时，他没有改变他们的顺序（字典中单词按字典序排序）。

举例来说就是，字符串a1,a2,....ap在字典序上比b1,b2,....bq小，则会存在一个整数i, i<=p, i<=q,然后对于每一个j（1<=j<i）都有aj=bj且ai<bi。
导演很想知道他的哪一条信息会被对手公司解读。这就需要你来做出一个程序来告诉他。

## 输入格式

第一行是一个正整数N，代表有N中情况。然后是每一种情况，第一行是两个用空格隔开的正整数A（1<=A<=26）和K。A是替换表的大小（替换表示英文26个字母表中的前A个），K是将有K个加密的单词。原码包含了用于替换字母的字母。其中可以有任何符号，但只有替换字母的字母是被加密的。然后是K行，每一行包含了一个被加密的单词。

## 输出格式

对于每一种情况，输出一行，如果可以解密出一种（独一无二的）信息，那么输出它。不然，输出“Message cannot be decrypted”。
# 输入输出样例略；

## 说明/提示

注意：输入输出数据较大！

感谢@jokers 提供翻译

## 样例 #1

### 输入

```
2
5 6
cebdbac
cac
ecd
dca
aba
bac
cedab
4 4
cca
cad
aac
bca
bdac
```

### 输出

```
abcde
Message cannot be decrypted.
```


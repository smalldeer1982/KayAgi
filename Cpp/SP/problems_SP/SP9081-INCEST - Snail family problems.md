---
title: "INCEST - Snail family problems"
layout: "post"
diff: 难度0
pid: SP9081
tag: []
---

# INCEST - Snail family problems

## 题目描述

给定一颗 $n$ 个点的无根树，初始时所有点都没有联系。

现进行 $Q$ 次询问，格式如下：

`Q n`: 表示询问若以 $n$ 为根，存在多少点与其祖先存在联系。

`M a b`: 表示 $a,b$ 之间出现联系。

`D a b`: 表示 $a,b$ 之间断开联系。

## 输入格式

第一行一个数 $n$。

接下来 $n-1$ 行，每行两个数 $u,v$，表示存在一条 $u,v$ 之间的边。

接下来一行一个数 $Q$。

接下来 $Q$ 行，每行描述一个操作，格式如上。

## 输出格式

对于每个 `Q` 操作，输出一行一个数表示该询问的答案。

### 输入输出样例

```
5
1 2
1 3
2 4
2 5
9
Q 1
M 3 5
Q 1
Q 3
M 1 4
Q 3
Q 4
D 3 5
Q 3
```

```
0
0
1
2
1
1
```

## 说明/提示

$2\le n\le 2\cdot 10^5,1\le Q\le 3\cdot 10^5$。

对于所有的 `M` 操作，保证 $a\not = b$，且 $a,b$ 之间不存在联系。

对于所有的 `D` 操作，保证 $a\not =b$，且 $a,b$ 之间存在联系。

询问之间彼此独立。

Translated by \_Ponder_

## 样例 #1

### 输入

```
5\n1 2\n1 3\n2 4\n2 5\n9\nQ 1\nM 3 5\nQ 1\nQ 3\nM 1 4\nQ 3\nQ 4\nD 3 5\nQ 3
```

### 输出

```
0\n0\n1\n2\n1\n1\n&nbsp;
```


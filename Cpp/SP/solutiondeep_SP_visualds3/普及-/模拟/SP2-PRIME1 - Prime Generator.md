# é¢˜ç›®ä¿¡æ¯

# PRIME1 - Prime Generator

## é¢˜ç›®æè¿°

 Peter wants to generate some prime numbers for his cryptosystem. Help him! Your task is to generate all prime numbers between two given numbers!

## è¯´æ˜/æç¤º

**Warning: large Input/Output data, be careful with certain languages (though most should be OK if the algorithm is well designed)**   
Information
-----------

 After cluster change, please consider [PRINT](http://www.spoj.com/problems/PRINT/) as a more challenging problem.

## æ ·ä¾‹ #1

### è¾“å…¥

```
2
1 10
3 5```

### è¾“å‡º

```
2
3
5
7

3
5```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šPRIME1 - Prime Generator æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šç´ æ•°åˆ¤æ–­ï¼ˆæš´åŠ›æšä¸¾/åŒºé—´ç­›æ³•/Miller-Rabinç´ æ€§æµ‹è¯•ï¼‰

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
é¢˜ç›®è¦æ±‚ç”Ÿæˆä¸¤ä¸ªå¤§æ•´æ•°ä¹‹é—´çš„æ‰€æœ‰ç´ æ•°ï¼ˆä¾‹å¦‚1åˆ°10äº¿ï¼‰ï¼Œä½†æ¯ç»„æµ‹è¯•ç”¨ä¾‹çš„åŒºé—´é•¿åº¦ä¸è¶…è¿‡10ä¸‡ï¼ˆ`n-m<=1e5`ï¼‰ã€‚è§£å†³è¿™ä¸ªé—®é¢˜çš„å…³é”®æ˜¯**é«˜æ•ˆåˆ¤æ–­åŒºé—´å†…çš„æ•°æ˜¯å¦ä¸ºç´ æ•°**ï¼Œå› ä¸ºç›´æ¥ç”Ÿæˆ1åˆ°10äº¿çš„ç´ æ•°è¡¨æ˜¯ä¸å¯èƒ½çš„ï¼ˆå†…å­˜å’Œæ—¶é—´éƒ½ä¸å…è®¸ï¼‰ã€‚  

- **æš´åŠ›æšä¸¾**ï¼šåƒâ€œæ£€æŸ¥ä¸€ä¸ªæ•°æ˜¯ä¸æ˜¯â€˜å­¤ç‹¬çš„â€™â€â€”â€”ä»2åˆ°âˆšxé€ä¸€åˆ¤æ–­æ˜¯å¦èƒ½æ•´é™¤xï¼Œèƒ½æ•´é™¤åˆ™ä¸æ˜¯ç´ æ•°ã€‚è¿™ç§æ–¹æ³•ç®€å•ç›´æ¥ï¼Œé€‚åˆåŒºé—´é•¿åº¦å°çš„æƒ…å†µï¼ˆæœ¬é¢˜åˆšå¥½æ»¡è¶³`n-m<=1e5`ï¼‰ã€‚  
- **åŒºé—´ç­›æ³•**ï¼šåƒâ€œç”¨å°çŸ³å­ç ¸åˆæ•°â€â€”â€”å…ˆç­›å‡ºâˆš1e9ï¼ˆçº¦3ä¸‡ï¼‰ä»¥å†…çš„æ‰€æœ‰ç´ æ•°ï¼Œå†ç”¨è¿™äº›å°ç´ æ•°å»æ ‡è®°åŒºé—´å†…çš„åˆæ•°ï¼ˆä¾‹å¦‚ç”¨2æ ‡è®°åŒºé—´å†…çš„æ‰€æœ‰å¶æ•°ï¼Œç”¨3æ ‡è®°æ‰€æœ‰3çš„å€æ•°ï¼Œå‰©ä¸‹çš„å°±æ˜¯ç´ æ•°ï¼‰ã€‚è¿™ç§æ–¹æ³•æ•ˆç‡å¾ˆé«˜ï¼Œé€‚åˆå¤§æ•°æ®èŒƒå›´ã€‚  
- **Miller-Rabinç´ æ€§æµ‹è¯•**ï¼šåƒâ€œæ•°å­¦ä½“æ£€â€â€”â€”ç”¨è´¹é©¬å°å®šç†å’ŒäºŒæ¬¡æ¢æµ‹å®šç†å¿«é€ŸéªŒè¯ç´ æ•°ï¼Œæ—¶é—´å¤æ‚åº¦æä½ï¼ˆO(logÂ³n)ï¼‰ï¼Œé€‚åˆè¶…å¤§æ•°æ®ï¼ˆå¦‚1e18ä»¥ä¸Šï¼‰ã€‚  

**æ ¸å¿ƒéš¾ç‚¹**ï¼šå¤„ç†1e9çš„å¤§èŒƒå›´å†…çš„ç´ æ•°åˆ¤æ–­ï¼Œé¿å…å†…å­˜æº¢å‡ºæˆ–è¶…æ—¶ã€‚  
**è§£å†³æ–¹æ¡ˆ**ï¼šæ ¹æ®æ•°æ®èŒƒå›´é€‰æ‹©åˆé€‚çš„æ–¹æ³•â€”â€”åŒºé—´ç­›æ³•ï¼ˆåº”å¯¹1e9èŒƒå›´ï¼‰æˆ–æš´åŠ›æšä¸¾ï¼ˆåº”å¯¹å°åŒºé—´é•¿åº¦ï¼‰ã€‚  

**å¯è§†åŒ–è®¾è®¡æ€è·¯**ï¼šç”¨8ä½åƒç´ é£æ ¼å±•ç¤ºåŒºé—´ç­›çš„è¿‡ç¨‹ï¼š  
- å·¦ä¾§æ˜¾ç¤ºç­›å‡ºçš„å°ç´ æ•°ï¼ˆå¦‚2ã€3ã€5ï¼‰ï¼Œå³ä¾§æ˜¾ç¤ºåŒºé—´ï¼ˆå¦‚10-20ï¼‰ã€‚  
- ç”¨â€œåƒç´ çŸ³å­â€ï¼ˆå°ç´ æ•°ï¼‰ç ¸å‘åŒºé—´å†…çš„åˆæ•°ï¼ˆå¦‚2ç ¸å‘12ã€14â€¦ï¼Œ3ç ¸å‘15ã€18â€¦ï¼‰ï¼Œè¢«ç ¸ä¸­çš„åˆæ•°å˜æˆç°è‰²ï¼Œå‰©ä¸‹çš„ç´ æ•°ä¿æŒå½©è‰²ã€‚  
- åŠ å…¥â€œå•æ­¥æ‰§è¡Œâ€å’Œâ€œè‡ªåŠ¨æ’­æ”¾â€åŠŸèƒ½ï¼Œæ¯ç ¸ä¸€ä¸ªåˆæ•°æ’­æ”¾â€œå®â€çš„éŸ³æ•ˆï¼Œæ‰¾åˆ°ç´ æ•°æ—¶æ’­æ”¾â€œæ»´â€çš„éŸ³æ•ˆã€‚  


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼šæ¥æºï¼ˆå­è°¦ï¼Œèµ41ï¼‰  
* **ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£æ˜¯**åŒºé—´ç­›æ³•çš„ç»å…¸å®ç°**ï¼Œå®Œç¾è§£å†³äº†å¤§æ•°æ®èŒƒå›´çš„é—®é¢˜ã€‚æ€è·¯æ¸…æ™°ï¼šå…ˆé€šè¿‡çº¿æ€§ç­›ç­›å‡º3.5ä¸‡ä»¥å†…çš„æ‰€æœ‰ç´ æ•°ï¼ˆå› ä¸ºâˆš1e9â‰ˆ31623ï¼‰ï¼Œå†ç”¨è¿™äº›å°ç´ æ•°å»åˆ¤æ–­åŒºé—´å†…çš„æ•°æ˜¯å¦ä¸ºç´ æ•°ï¼ˆå¦‚æœä¸€ä¸ªæ•°ä¸èƒ½è¢«ä»»ä½•å°ç´ æ•°æ•´é™¤ï¼Œå°±æ˜¯ç´ æ•°ï¼‰ã€‚ä»£ç é£æ ¼è§„èŒƒï¼ˆå˜é‡å`pri`è¡¨ç¤ºç´ æ•°æ•°ç»„ï¼Œ`pr`è¡¨ç¤ºç´ æ•°ä¸ªæ•°ï¼‰ï¼Œè¾¹ç•Œå¤„ç†ä¸¥è°¨ï¼ˆæ¯”å¦‚ç‰¹åˆ¤1ä¸æ˜¯ç´ æ•°ï¼‰ã€‚ä»å®è·µè§’åº¦çœ‹ï¼Œè¿™ä»½ä»£ç èƒ½é«˜æ•ˆå¤„ç†1e9èŒƒå›´å†…çš„åŒºé—´ï¼Œæ˜¯ç«èµ›ä¸­çš„å¸¸ç”¨å†™æ³•ã€‚  

### é¢˜è§£äºŒï¼šæ¥æºï¼ˆHPXXZYYï¼Œèµ4ï¼‰  
* **ç‚¹è¯„**ï¼šæ­¤é¢˜è§£è¯¦ç»†å®ç°äº†**åŸƒæ°åŒºé—´ç­›æ³•**ï¼Œæ€è·¯æ›´ç›´è§‚ï¼šå…ˆç­›å‡ºâˆšmä»¥å†…çš„ç´ æ•°ï¼Œå†ç”¨è¿™äº›ç´ æ•°å»æ ‡è®°åŒºé—´å†…çš„åˆæ•°ï¼ˆä¾‹å¦‚åŒºé—´æ˜¯nåˆ°mï¼Œç”¨ç´ æ•°pæ ‡è®°ä»`max(2*p, n)`å¼€å§‹çš„æ‰€æœ‰pçš„å€æ•°ï¼‰ã€‚ä»£ç ä¸­`calc_first`å‡½æ•°è®¡ç®—æ ‡è®°çš„èµ·ç‚¹ï¼Œä¼˜åŒ–äº†æ—¶é—´ï¼ˆé¿å…é‡å¤æ ‡è®°ï¼‰ã€‚è¿™ä»½é¢˜è§£çš„äº®ç‚¹æ˜¯**æ•°æ®ç»“æ„çš„åˆç†ä½¿ç”¨**ï¼ˆç”¨`v`æ•°ç»„æ ‡è®°åŒºé—´å†…çš„åˆæ•°ï¼ŒèŠ‚çœå†…å­˜ï¼‰ï¼Œé€‚åˆç†è§£åŒºé—´ç­›çš„åº•å±‚é€»è¾‘ã€‚  

### é¢˜è§£ä¸‰ï¼šæ¥æºï¼ˆyu__xuanï¼Œèµ2ï¼‰  
* **ç‚¹è¯„**ï¼šæ­¤é¢˜è§£é‡‡ç”¨äº†**Miller-Rabinç´ æ€§æµ‹è¯•**ï¼Œé€‚åˆè¶…å¤§æ•°æ®ï¼ˆå¦‚1e18ï¼‰ã€‚æ€è·¯é«˜çº§ï¼šç”¨è´¹é©¬å°å®šç†å’ŒäºŒæ¬¡æ¢æµ‹å®šç†å¿«é€ŸéªŒè¯ç´ æ•°ï¼Œé€šè¿‡é€‰å–å›ºå®šçš„æµ‹è¯•åŸºæ•°ï¼ˆ2ã€7ã€61ï¼‰ç¡®ä¿æ­£ç¡®æ€§ã€‚ä»£ç ä¸­`qpow`å‡½æ•°ï¼ˆå¿«é€Ÿå¹‚ï¼‰å’Œ`mb`å‡½æ•°ï¼ˆMiller-Rabinæµ‹è¯•ï¼‰çš„å®ç°å¾ˆè§„èŒƒï¼Œè¯»å…¥ä¼˜åŒ–ï¼ˆ`read`å‡½æ•°ï¼‰å’Œè¾“å‡ºä¼˜åŒ–ï¼ˆ`write`å‡½æ•°ï¼‰æé«˜äº†è¿è¡Œé€Ÿåº¦ã€‚è¿™ä»½é¢˜è§£çš„äº®ç‚¹æ˜¯**ç®—æ³•çš„å…ˆè¿›æ€§**ï¼Œé€‚åˆå­¦ä¹ é«˜çº§ç´ æ•°åˆ¤æ–­æ–¹æ³•ã€‚  


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### 1. éš¾ç‚¹1ï¼šå¦‚ä½•å¤„ç†1e9çš„å¤§èŒƒå›´å†…çš„ç´ æ•°åˆ¤æ–­ï¼Ÿ  
* **åˆ†æ**ï¼šç›´æ¥ç”Ÿæˆ1åˆ°1e9çš„ç´ æ•°è¡¨éœ€è¦çº¦1e9ä½ï¼ˆçº¦125MBï¼‰ï¼Œä½†å†…å­˜å¯èƒ½ä¸å¤Ÿï¼Œè€Œä¸”æ—¶é—´å¤ªé•¿ã€‚  
* **è§£å†³æ–¹æ¡ˆ**ï¼šç”¨**åŒºé—´ç­›æ³•**â€”â€”åªç­›å‡ºâˆš1e9ä»¥å†…çš„ç´ æ•°ï¼ˆçº¦3ä¸‡ï¼‰ï¼Œå†ç”¨è¿™äº›å°ç´ æ•°å»æ ‡è®°åŒºé—´å†…çš„åˆæ•°ã€‚è¿™æ ·å†…å­˜å ç”¨æå°ï¼ˆ3ä¸‡çš„ç´ æ•°æ•°ç»„åªéœ€çº¦120KBï¼‰ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(Ï€(âˆšm) * (m-n+1)/log m)ï¼Œå®Œå…¨å¯ä»¥æ¥å—ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå¤„ç†å¤§èŒƒå›´ç´ æ•°é—®é¢˜ï¼ŒåŒºé—´ç­›æ³•æ˜¯â€œå››ä¸¤æ‹¨åƒæ–¤â€çš„å¥½æ–¹æ³•ã€‚  

### 2. éš¾ç‚¹2ï¼šå¦‚ä½•é«˜æ•ˆåˆ¤æ–­åŒºé—´å†…çš„æ•°æ˜¯å¦ä¸ºç´ æ•°ï¼Ÿ  
* **åˆ†æ**ï¼šæš´åŠ›æšä¸¾ï¼ˆä»2åˆ°âˆšxï¼‰çš„æ—¶é—´å¤æ‚åº¦æ˜¯O(âˆšx)ï¼Œå¯¹äºåŒºé—´é•¿åº¦1e5æ¥è¯´ï¼Œæ€»æ—¶é—´æ˜¯O(1e5*âˆš1e9)=O(1e5*3e4)=3e9ï¼Œè¿™ä¼šè¶…æ—¶å—ï¼Ÿå…¶å®ä¸ä¼šï¼Œå› ä¸ºâˆš1e9=3e4ï¼Œä½†å®é™…è¿è¡Œä¸­ï¼Œå¤§éƒ¨åˆ†æ•°ä¼šæå‰è¢«å°ç´ æ•°æ•´é™¤ï¼ˆæ¯”å¦‚å¶æ•°ä¼šè¢«2æ•´é™¤ï¼Œ3çš„å€æ•°ä¼šè¢«3æ•´é™¤ï¼‰ï¼Œæ‰€ä»¥å®é™…æ—¶é—´è¿œå°äº3e9ã€‚è€ŒåŒºé—´ç­›æ³•çš„æ—¶é—´å¤æ‚åº¦æ›´ä½ï¼ˆO(Ï€(âˆšm) * (m-n+1)/p)ï¼Œpæ˜¯å°ç´ æ•°ï¼‰ï¼Œæ›´é€‚åˆå¤§æ•°æ®ã€‚  
* **è§£å†³æ–¹æ¡ˆ**ï¼šå¦‚æœåŒºé—´é•¿åº¦å°ï¼ˆå¦‚æœ¬é¢˜`n-m<=1e5`ï¼‰ï¼Œå¯ä»¥ç”¨æš´åŠ›æšä¸¾ï¼›å¦‚æœåŒºé—´é•¿åº¦å¤§æˆ–æ•°æ®èŒƒå›´æ›´å¤§ï¼Œç”¨åŒºé—´ç­›æ³•æˆ–Miller-Rabinã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ ¹æ®æ•°æ®èŒƒå›´é€‰æ‹©åˆé€‚çš„æ–¹æ³•ï¼Œæ˜¯è§£é¢˜çš„å…³é”®ã€‚  

### 3. éš¾ç‚¹3ï¼šå¦‚ä½•ä¼˜åŒ–ç´ æ•°åˆ¤æ–­çš„æ•ˆç‡ï¼Ÿ  
* **åˆ†æ**ï¼šæš´åŠ›æšä¸¾çš„æ—¶é—´å¤æ‚åº¦æ˜¯O(âˆšx)ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹æ³•ä¼˜åŒ–ï¼š  
  - ç‰¹åˆ¤1ï¼ˆä¸æ˜¯ç´ æ•°ï¼‰ã€2ï¼ˆæ˜¯ç´ æ•°ï¼‰ã€å¶æ•°ï¼ˆé™¤äº†2éƒ½ä¸æ˜¯ç´ æ•°ï¼‰ã€‚  
  - åˆ¤æ–­åˆ°âˆšxè€Œä¸æ˜¯x-1ï¼ˆå› ä¸ºå› æ•°æ˜¯æˆå¯¹å‡ºç°çš„ï¼‰ã€‚  
  - ç”¨æ•°å­¦å®šç†ï¼ˆå¦‚6çš„å€æ•°é™„è¿‘çš„æ•°æ‰å¯èƒ½æ˜¯ç´ æ•°ï¼Œå³`n%6==1æˆ–5`ï¼‰ã€‚  
* **è§£å†³æ–¹æ¡ˆ**ï¼šåœ¨æš´åŠ›æšä¸¾ä¸­åŠ å…¥è¿™äº›ä¼˜åŒ–ï¼Œèƒ½æ˜¾è‘—æé«˜æ•ˆç‡ã€‚ä¾‹å¦‚é¢˜è§£ä¸­`myfly`çš„ä»£ç ï¼Œåˆ¤æ–­`n%6==1æˆ–5`ï¼Œå‡å°‘äº†å¾ªç¯æ¬¡æ•°ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šç»†èŠ‚ä¼˜åŒ–èƒ½è®©æš´åŠ›ç®—æ³•â€œèµ·æ­»å›ç”Ÿâ€ã€‚  


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒï¼ˆåŒºé—´ç­›æ³•ï¼Œç»¼åˆå­è°¦ã€HPXXZYYçš„æ€è·¯ï¼‰  
* **è¯´æ˜**ï¼šæœ¬ä»£ç ç»¼åˆäº†åŒºé—´ç­›æ³•çš„ç»å…¸æ€è·¯ï¼Œå…ˆç­›å°ç´ æ•°ï¼Œå†ç”¨å°ç´ æ•°åˆ¤æ–­åŒºé—´å†…çš„æ•°æ˜¯å¦ä¸ºç´ æ•°ï¼Œé€‚åˆå¤„ç†1e9èŒƒå›´å†…çš„åŒºé—´ã€‚  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š  
  ```cpp
  #include <iostream>
  #include <vector>
  #include <cmath>
  using namespace std;

  const int MAX_SQRT = 35000; // âˆš1e9 â‰ˆ 31623ï¼Œå–35000è¶³å¤Ÿ
  vector<int> primes; // å­˜å‚¨ç­›å‡ºçš„å°ç´ æ•°
  bool is_prime[MAX_SQRT + 1]; // æ ‡è®°å°ç´ æ•°

  // çº¿æ€§ç­›ç­›å‡º1åˆ°MAX_SQRTçš„ç´ æ•°
  void sieve() {
      fill(is_prime, is_prime + MAX_SQRT + 1, true);
      is_prime[0] = is_prime[1] = false;
      for (int i = 2; i <= MAX_SQRT; ++i) {
          if (is_prime[i]) {
              primes.push_back(i);
          }
          for (int p : primes) {
              if (i * p > MAX_SQRT) break;
              is_prime[i * p] = false;
              if (i % p == 0) break;
          }
      }
  }

  // åˆ¤æ–­xæ˜¯å¦ä¸ºç´ æ•°ï¼ˆç”¨ç­›å‡ºçš„å°ç´ æ•°ï¼‰
  bool isPrime(int x) {
      if (x == 1) return false;
      for (int p : primes) {
          if ((long long)p * p > x) break;
          if (x % p == 0) return false;
      }
      return true;
  }

  int main() {
      sieve(); // é¢„å¤„ç†å°ç´ æ•°
      int t;
      cin >> t;
      while (t--) {
          int n, m;
          cin >> n >> m;
          for (int i = n; i <= m; ++i) {
              if (isPrime(i)) {
                  cout << i << endl;
              }
          }
          cout << endl;
      }
      return 0;
  }
  ```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. **é¢„å¤„ç†å°ç´ æ•°**ï¼šç”¨çº¿æ€§ç­›ç­›å‡º1åˆ°35000çš„æ‰€æœ‰ç´ æ•°ï¼Œå­˜å‚¨åœ¨`primes`æ•°ç»„ä¸­ã€‚  
  2. **åˆ¤æ–­åŒºé—´å†…çš„ç´ æ•°**ï¼šå¯¹äºæ¯ä¸ªæµ‹è¯•ç”¨ä¾‹çš„åŒºé—´`[n, m]`ï¼Œéå†æ¯ä¸ªæ•°`i`ï¼Œç”¨`isPrime`å‡½æ•°åˆ¤æ–­æ˜¯å¦ä¸ºç´ æ•°ï¼ˆ`isPrime`å‡½æ•°ç”¨ç­›å‡ºçš„å°ç´ æ•°é€ä¸€åˆ¤æ–­æ˜¯å¦èƒ½æ•´é™¤`i`ï¼‰ã€‚  
  3. **è¾“å‡ºç»“æœ**ï¼šè¾“å‡ºåŒºé—´å†…çš„æ‰€æœ‰ç´ æ•°ï¼Œæ¯ç»„æµ‹è¯•ç”¨ä¾‹åæ¢è¡Œã€‚  


### é¢˜è§£ä¸€ï¼ˆå­è°¦ï¼‰æ ¸å¿ƒä»£ç ç‰‡æ®µèµæ  
* **äº®ç‚¹**ï¼šçº¿æ€§ç­›ç­›å°ç´ æ•°ï¼Œæ•ˆç‡é«˜ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  void sss(){//çº¿æ€§ç­›ï¼Œç­›å‡ºæ‰€éœ€çš„æ‰€æœ‰ç´ æ•°
      for(int i=2;i<=maxn;i++){
          if(!p[i])pri[pr++]=i;
          for(int j=0;j<pr&&i*pri[j]<maxn;j++){
              p[i*pri[j]]=1;
              if(i%pri[j]==0)break;
          }
      }
  }
  ```
* **ä»£ç è§£è¯»**ï¼š  
  - `p`æ•°ç»„æ ‡è®°æ˜¯å¦ä¸ºåˆæ•°ï¼ˆ`p[i]=1`è¡¨ç¤ºiæ˜¯åˆæ•°ï¼‰ã€‚  
  - éå†`i`ä»2åˆ°`maxn`ï¼ˆ35000ï¼‰ï¼šå¦‚æœ`p[i]`ä¸º0ï¼ˆiæ˜¯ç´ æ•°ï¼‰ï¼Œå°†å…¶åŠ å…¥`pri`æ•°ç»„ï¼ˆç´ æ•°æ•°ç»„ï¼‰ã€‚  
  - ç”¨`pri`æ•°ç»„ä¸­çš„ç´ æ•°å»æ ‡è®°`i*pri[j]`ä¸ºåˆæ•°ï¼ˆçº¿æ€§ç­›çš„æ ¸å¿ƒï¼šæ¯ä¸ªåˆæ•°åªè¢«å…¶æœ€å°è´¨å› æ•°æ ‡è®°ï¼Œé¿å…é‡å¤ï¼‰ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šçº¿æ€§ç­›æ˜¯ç­›ç´ æ•°çš„é«˜æ•ˆæ–¹æ³•ï¼Œæ—¶é—´å¤æ‚åº¦O(n)ã€‚  


### é¢˜è§£äºŒï¼ˆHPXXZYYï¼‰æ ¸å¿ƒä»£ç ç‰‡æ®µèµæ  
* **äº®ç‚¹**ï¼šåŸƒæ°åŒºé—´ç­›æ³•ï¼Œç›´è§‚æ ‡è®°åŒºé—´å†…çš„åˆæ•°ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  int calc_first(int k){
      if (n==k||n<k) return 2*k;
      else if (n%k==0) return n;
      else return (n/k+1)*k;
  }
  ```
* **ä»£ç è§£è¯»**ï¼š  
  - `calc_first`å‡½æ•°è®¡ç®—ç”¨ç´ æ•°`k`æ ‡è®°åŒºé—´`[n, m]`å†…åˆæ•°çš„èµ·ç‚¹ï¼š  
    - å¦‚æœ`n`å°äº`k`ï¼ˆæ¯”å¦‚`k=3`ï¼Œ`n=2`ï¼‰ï¼Œèµ·ç‚¹æ˜¯`2*k`ï¼ˆ6ï¼‰ã€‚  
    - å¦‚æœ`n`æ˜¯`k`çš„å€æ•°ï¼ˆæ¯”å¦‚`k=3`ï¼Œ`n=6`ï¼‰ï¼Œèµ·ç‚¹æ˜¯`n`ï¼ˆ6ï¼‰ã€‚  
    - å¦åˆ™ï¼Œèµ·ç‚¹æ˜¯å¤§äº`n`çš„æœ€å°`k`çš„å€æ•°ï¼ˆæ¯”å¦‚`k=3`ï¼Œ`n=7`ï¼Œèµ·ç‚¹æ˜¯`9`ï¼‰ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šè®¡ç®—æ ‡è®°èµ·ç‚¹æ˜¯åŒºé—´ç­›æ³•çš„å…³é”®ï¼Œèƒ½é¿å…é‡å¤æ ‡è®°ã€‚  


### é¢˜è§£ä¸‰ï¼ˆyu__xuanï¼‰æ ¸å¿ƒä»£ç ç‰‡æ®µèµæ  
* **äº®ç‚¹**ï¼šMiller-Rabinç´ æ€§æµ‹è¯•ï¼Œé€‚åˆè¶…å¤§æ•°æ®ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  bool mb(int p) {//Miller-Rabinç®—æ³•ã€‚ 
      if(p==1) return 0;
      int t=p-1,k=0;
      while(!(t&1)) {
          k++;
          t>>=1;
      }
      for(int i=0; i<=2; ++i) {
          if(p==test[i]) return 1;
          long long a = qpow(test[i],t,p),nx=a;
          for(int j = 1; j <= k; ++j) {
              nx = (a * a) % p;
              if(nx == 1 && a != 1 && a != p - 1) return 0;
              a = nx;
          }
          if(a != 1) return 0;
      }
      return 1;
  }
  ```
* **ä»£ç è§£è¯»**ï¼š  
  - å°†`p-1`åˆ†è§£ä¸º`t*2^k`ï¼ˆ`t`æ˜¯å¥‡æ•°ï¼‰ã€‚  
  - é€‰å–æµ‹è¯•åŸºæ•°`test`ï¼ˆ2ã€7ã€61ï¼‰ï¼Œè®¡ç®—`a^t mod p`ï¼Œç„¶åä¸æ–­å¹³æ–¹`k`æ¬¡ï¼Œç”¨äºŒæ¬¡æ¢æµ‹å®šç†åˆ¤æ–­æ˜¯å¦ä¸ºç´ æ•°ï¼ˆå¦‚æœ`a^2 â‰¡1 mod p`ï¼Œåˆ™`aâ‰¡1`æˆ–`aâ‰¡p-1`ï¼‰ã€‚  
  - å¦‚æœæ‰€æœ‰æµ‹è¯•åŸºæ•°éƒ½é€šè¿‡ï¼Œåˆ™`p`æ˜¯ç´ æ•°ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šMiller-Rabinç´ æ€§æµ‹è¯•æ˜¯ç«èµ›ä¸­çš„â€œç¥å™¨â€ï¼Œèƒ½å¿«é€Ÿåˆ¤æ–­è¶…å¤§æ•°æ®çš„ç´ æ€§ã€‚  


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤ºï¼ˆåŒºé—´ç­›æ³•ï¼‰

### åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜ï¼šã€Šç´ æ•°æ¢é™©å®¶ã€‹ï¼ˆ8ä½åƒç´ é£æ ¼ï¼‰  
**è®¾è®¡æ€è·¯**ï¼šç”¨FCçº¢ç™½æœºçš„é£æ ¼å±•ç¤ºåŒºé—´ç­›çš„è¿‡ç¨‹ï¼Œè®©å­¦ä¹ è€…åƒâ€œæ¢é™©å®¶â€ä¸€æ ·ç”¨å°ç´ æ•°â€œç ¸â€åˆæ•°ï¼Œæ‰¾åˆ°ç´ æ•°ã€‚åŠ å…¥éŸ³æ•ˆå’Œæ¸¸æˆå…ƒç´ ï¼Œå¢åŠ è¶£å‘³æ€§ã€‚  


### åŠ¨ç”»å¸§æ­¥éª¤ä¸äº¤äº’å…³é”®ç‚¹  
1. **åœºæ™¯åˆå§‹åŒ–**ï¼š  
   - å±å¹•å·¦ä¾§æ˜¾ç¤ºâ€œå°ç´ æ•°ä»“åº“â€ï¼ˆå¦‚2ã€3ã€5ã€7â€¦ï¼‰ï¼Œç”¨å½©è‰²åƒç´ å—è¡¨ç¤ºã€‚  
   - å±å¹•å³ä¾§æ˜¾ç¤ºâ€œåŒºé—´åœ°å›¾â€ï¼ˆå¦‚10-20ï¼‰ï¼Œæ¯ä¸ªæ•°ç”¨ç™½è‰²åƒç´ å—è¡¨ç¤ºã€‚  
   - åº•éƒ¨æœ‰â€œæ§åˆ¶é¢æ¿â€ï¼šå¼€å§‹/æš‚åœã€å•æ­¥ã€é‡ç½®æŒ‰é’®ï¼Œé€Ÿåº¦æ»‘å—ï¼ˆ1x-5xï¼‰ã€‚  
   - æ’­æ”¾8ä½é£æ ¼çš„èƒŒæ™¯éŸ³ä¹ï¼ˆå¦‚ã€Šè¶…çº§é©¬é‡Œå¥¥ã€‹çš„è½»å¿«æ—‹å¾‹ï¼‰ã€‚  

2. **ç®—æ³•å¯åŠ¨**ï¼š  
   - â€œå°ç´ æ•°ä»“åº“â€ä¸­çš„ç¬¬ä¸€ä¸ªç´ æ•°ï¼ˆ2ï¼‰å¼€å§‹é—ªçƒï¼Œä¼´éšâ€œå®â€çš„éŸ³æ•ˆã€‚  
   - â€œåŒºé—´åœ°å›¾â€ä¸­çš„å¶æ•°ï¼ˆ10ã€12ã€14â€¦ï¼‰å˜æˆç°è‰²ï¼ˆè¡¨ç¤ºåˆæ•°ï¼‰ï¼Œæ¯æ ‡è®°ä¸€ä¸ªåˆæ•°æ’­æ”¾â€œå•ªâ€çš„éŸ³æ•ˆã€‚  

3. **æ ¸å¿ƒæ­¥éª¤æ¼”ç¤º**ï¼š  
   - æ¥ä¸‹æ¥æ˜¯ç´ æ•°3ï¼šâ€œå°ç´ æ•°ä»“åº“â€ä¸­çš„3é—ªçƒï¼Œâ€œåŒºé—´åœ°å›¾â€ä¸­çš„3çš„å€æ•°ï¼ˆ12ã€15ã€18ï¼‰å˜æˆç°è‰²ã€‚  
   - ç„¶åæ˜¯ç´ æ•°5ï¼šâ€œåŒºé—´åœ°å›¾â€ä¸­çš„5çš„å€æ•°ï¼ˆ15ã€20ï¼‰å˜æˆç°è‰²ã€‚  
   - å‰©ä¸‹çš„ç™½è‰²åƒç´ å—ï¼ˆ11ã€13ã€17ã€19ï¼‰å°±æ˜¯ç´ æ•°ï¼Œæ¯ä¸ªç´ æ•°é—ªçƒå¹¶æ’­æ”¾â€œæ»´â€çš„éŸ³æ•ˆã€‚  

4. **äº¤äº’åŠŸèƒ½**ï¼š  
   - **å•æ­¥æ‰§è¡Œ**ï¼šç‚¹å‡»â€œå•æ­¥â€æŒ‰é’®ï¼Œæ¯ä¸€æ­¥åªæ ‡è®°ä¸€ä¸ªç´ æ•°çš„å€æ•°ã€‚  
   - **è‡ªåŠ¨æ’­æ”¾**ï¼šç‚¹å‡»â€œå¼€å§‹â€æŒ‰é’®ï¼Œç®—æ³•è‡ªåŠ¨æ‰§è¡Œï¼Œé€Ÿåº¦ç”±æ»‘å—è°ƒèŠ‚ã€‚  
   - **é‡ç½®**ï¼šç‚¹å‡»â€œé‡ç½®â€æŒ‰é’®ï¼ŒåŒºé—´åœ°å›¾æ¢å¤åˆå§‹çŠ¶æ€ã€‚  

5. **ç›®æ ‡è¾¾æˆ**ï¼š  
   - å½“æ‰€æœ‰åˆæ•°éƒ½è¢«æ ‡è®°åï¼Œå±å¹•æ˜¾ç¤ºâ€œæ¢ç´¢å®Œæˆï¼æ‰¾åˆ°xä¸ªç´ æ•°ï¼â€ï¼Œæ’­æ”¾èƒœåˆ©éŸ³æ•ˆï¼ˆå¦‚ã€Šé­‚æ–—ç½—ã€‹çš„é€šå…³éŸ³ä¹ï¼‰ã€‚  


### æ—ç™½æç¤ºï¼ˆæ–‡å­—æ°”æ³¡ï¼‰  
- â€œæ¥ä¸‹æ¥ï¼Œç”¨ç´ æ•°2ç ¸å‘åŒºé—´å†…çš„å¶æ•°ï¼â€ï¼ˆæ ‡è®°å¶æ•°æ—¶ï¼‰  
- â€œç´ æ•°3æ¥äº†ï¼Œç ¸å‘3çš„å€æ•°ï¼â€ï¼ˆæ ‡è®°3çš„å€æ•°æ—¶ï¼‰  
- â€œçœ‹ï¼Œ11æ²¡æœ‰è¢«ç ¸ä¸­ï¼Œå®ƒæ˜¯ç´ æ•°ï¼â€ï¼ˆæ‰¾åˆ°ç´ æ•°æ—¶ï¼‰  


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯/æŠ€å·§è¿ç§»  
- **åŒºé—´ç­›æ³•**ï¼šé€‚ç”¨äºâ€œæ±‚å¤§åŒºé—´å†…çš„ç´ æ•°â€é—®é¢˜ï¼ˆå¦‚æ´›è°·P1835ã€Šç´ æ•°å¯†åº¦ã€‹ï¼‰ã€‚  
- **Miller-Rabinç´ æ€§æµ‹è¯•**ï¼šé€‚ç”¨äºâ€œåˆ¤æ–­è¶…å¤§æ•°æ®æ˜¯å¦ä¸ºç´ æ•°â€é—®é¢˜ï¼ˆå¦‚æ´›è°·P1075ã€Šè´¨å› æ•°åˆ†è§£ã€‹ï¼‰ã€‚  
- **æš´åŠ›æšä¸¾**ï¼šé€‚ç”¨äºâ€œå°èŒƒå›´ç´ æ•°åˆ¤æ–­â€é—®é¢˜ï¼ˆå¦‚æ´›è°·P1217ã€Šå›æ–‡è´¨æ•°ã€‹ï¼‰ã€‚  


### ç»ƒä¹ æ¨èï¼ˆæ´›è°·ï¼‰  
1. **æ´›è°· P1835** - ã€Šç´ æ•°å¯†åº¦ã€‹  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™é“é¢˜æ˜¯åŒºé—´ç­›æ³•çš„ç›´æ¥åº”ç”¨ï¼Œè¦æ±‚æ±‚åŒºé—´å†…çš„ç´ æ•°ä¸ªæ•°ï¼Œæ•°æ®èŒƒå›´æ¯”æœ¬é¢˜æ›´å¤§ï¼ˆ1<=l<=r<=2e12ï¼Œr-l<=1e6ï¼‰ï¼Œèƒ½å¸®åŠ©ä½ å·©å›ºåŒºé—´ç­›æ³•çš„é€»è¾‘ã€‚  

2. **æ´›è°· P3383** - ã€Šçº¿æ€§ç­›ç´ æ•°ã€‹  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™é“é¢˜è¦æ±‚ç­›å‡º1åˆ°nçš„æ‰€æœ‰ç´ æ•°ï¼Œæ•°æ®èŒƒå›´1<=n<=1e8ï¼Œèƒ½å¸®åŠ©ä½ æŒæ¡çº¿æ€§ç­›çš„å®ç°ï¼ˆæ¯”åŸƒæ°ç­›æ›´é«˜æ•ˆï¼‰ã€‚  

3. **æ´›è°· P1075** - ã€Šè´¨å› æ•°åˆ†è§£ã€‹  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™é“é¢˜è¦æ±‚å°†ä¸€ä¸ªæ•°åˆ†è§£ä¸ºè´¨å› æ•°çš„ä¹˜ç§¯ï¼Œæ•°æ®èŒƒå›´1<=n<=1e18ï¼Œéœ€è¦ç”¨åˆ°Miller-Rabinç´ æ€§æµ‹è¯•å’ŒPollard's Rhoç®—æ³•ï¼Œèƒ½å¸®åŠ©ä½ å­¦ä¹ é«˜çº§ç´ æ•°å¤„ç†æ–¹æ³•ã€‚  


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«ï¼ˆè‹¥æœ‰ï¼‰  
**å‚è€ƒç»éªŒï¼ˆæ¥è‡ªå­è°¦ï¼‰**ï¼šâ€œç›´æ¥ç­›1e9æ˜¯ä¸å¯èƒ½çš„ï¼Œè¦ç”¨åŒºé—´ç­›æ³•â€”â€”å…ˆç­›å°ç´ æ•°ï¼Œå†ç”¨å°ç´ æ•°åˆ¤æ–­åŒºé—´å†…çš„æ•°ã€‚â€  
**ç‚¹è¯„**ï¼šè¿™ä½ä½œè€…çš„ç»éªŒå¾ˆå…³é”®ã€‚å¤„ç†å¤§èŒƒå›´ç´ æ•°é—®é¢˜æ—¶ï¼Œâ€œç¼©å°èŒƒå›´â€æ˜¯æ ¸å¿ƒæ€è·¯â€”â€”ç”¨å°ç´ æ•°å»â€œè¦†ç›–â€å¤§åŒºé—´çš„åˆæ•°ï¼Œé¿å…ç›´æ¥å¤„ç†å¤§æ•°æ®ã€‚  


## ç»“è¯­  
æœ¬æ¬¡å…³äºâ€œPRIME1 - Prime Generatorâ€çš„C++è§£é¢˜åˆ†æå°±åˆ°è¿™é‡Œã€‚å¸Œæœ›è¿™ä»½å­¦ä¹ æŒ‡å—èƒ½å¸®åŠ©ä½ æŒæ¡ç´ æ•°åˆ¤æ–­çš„å¸¸ç”¨æ–¹æ³•ï¼ˆæš´åŠ›ã€åŒºé—´ç­›ã€Miller-Rabinï¼‰ï¼Œå¹¶å­¦ä¼šæ ¹æ®æ•°æ®èŒƒå›´é€‰æ‹©åˆé€‚çš„ç®—æ³•ã€‚è®°ä½ï¼Œç¼–ç¨‹çš„ä¹è¶£åœ¨äºâ€œç”¨èªæ˜çš„æ–¹æ³•è§£å†³é—®é¢˜â€ï¼Œä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ–°çš„æŒ‘æˆ˜ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š185.26ç§’
---
title: "NSUBSTR2 - Substrings II"
layout: "post"
diff: NOI/NOI+/CTSC
pid: SP8747
tag: []
---

# NSUBSTR2 - Substrings II

## 题目描述

给你一个字符集为小写字母的字符串$T$，同时给你两个参数A和B，有Q组询问

每次询问一个字符串在$T$中出现了多少次

每一次询问之后，假设这次询问的答案为$ans$，你需要把第$((A * ans + B) \% 26) + 1$个小写字母加入到$T$的末尾

接下来$q$ 行，依次是询问的字符串

## 输入格式

第一行一个字符串$T$

第二行三个整数$q, a, b$，分别表示询问次数，参数A和参数B

## 输出格式

一共输出$q$行，第$i$行表示第$i$次询问的答案

# 输入样例

``` plain
aaaaa
2 0 0
a
aa
```

# 输出样例

``` plain
5
5
```

## 说明/提示

$|T| \le 40000$

$1 \le q \le 40000$

$0 \le 27$

$0 \le 26$

输入文件大小不会超过$600kb$


第一次询问的时候，$a$在$aaaaa$中一共出现了$5$次，$ans=5$，之后需要添加第$((0 * ans + 0) \% 26) + 1=1$个小写字母，即$a$，加入到$T$的尾部

此时$T$是$aaaaaa$

第二个询问$aa$在$aaaaaa$中出现了多少次，显然是$5$次

感谢@KingSann 提供的翻译

## 样例 #1

### 输入

```
\naaaaa\n2 0 0\na\naa\n\n
```

### 输出

```
\n5\n5\n
```


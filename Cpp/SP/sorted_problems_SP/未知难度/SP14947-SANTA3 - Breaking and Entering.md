---
title: "SANTA3 - Breaking and Entering"
layout: "post"
diff: 难度0
pid: SP14947
tag: []
---

# SANTA3 - Breaking and Entering

## 题目描述

圣诞老人最享受的圣诞节活动之一，就是在夜晚通过壁炉巧妙地进入人们的房子，并为他们送上礼物。这次，他要造访的房子可以被想象成一个矩形网格，由 $R$ 行（$1 \leq R \leq 100$）和 $C$ 列（$1 \leq C \leq 100$）构成。每个单元格可能是以下几种状态之一：空的（用 '.' 表示）、有墙（用 '#' 表示）、有壁炉（用 'F' 表示）、有某个尺寸的长袜（用 '1' 到 '9' 表示），或者是空的但有一只面朝某个方向的狗（向上 '^'，向右 '>'，向下 'v'，向左 '<'）。壁炉所在的单元格只有一个，也是圣诞老人进入的起点。

为了顺利完成这次任务，圣诞老人提前制定了行动计划。进入房子时，他将携带 $P$ （$1 \leq P \leq 10^9$）个礼物，并计划按顺序执行 $M$ （$1 \leq M \leq 1000$）次移动，每次移动用一秒。每次移动可以是向上（'U'）、向右（'R'）、向下（'D'）、向左（'L'）走一步。然而，圣诞老人无法穿过墙壁，因此如果他试图移出网格或进入一个有墙的单元格，他将停留在原地。

与此同时，房子里的所有狗也会同时行动。每只狗会根据其面朝的方向向前移动一格，前提是该单元格在网格范围内且为空（不考虑其他狗或圣诞老人）。如果无法前进，它就顺时针旋转 90 度。需要注意的是，狗和狗之间不会彼此相互影响，也可能在某些时刻有多只狗出现在同一个单元格内。

在每次移动的最后，如果圣诞老人站在一个有长袜的单元格中，并且他还携带有至少一个礼物，同时长袜中的礼物未满，他会在长袜里放入一个礼物。如果圣诞老人此时站在壁炉旁边，并且他的礼物已经全部分发完毕，或者他已经在每条长袜里放了至少一个礼物，那么他就会离开房子。最终，如果圣诞老人和一只或多只狗在同一个单元格中，每只狗都会顺序偷走他剩余礼物的一半，向上取整。

在实施这个精妙计划之前，圣诞老人想知道他这次探险的成效。他希望你能够为他复制一个房子的网格，其中每个含有长袜的单元格用一个数字（'0'到'9'）表示该长袜最终包含的礼物数，而其他单元格则用 '.' 表示。此外，他还想知道自己最终停留在哪个位置。

## 输入格式

第一行：$R$ 和 $C$

接下来 $R$ 行：每行包含 $C$ 个字符，表示第 $i$ 行的网格状态，其中 $i = 1 \ldots R$

然后一行：$M$ 和 $P$

接下来一行：包含 $M$ 个字符，表示圣诞老人的所有移动步骤

## 输出格式

共 $R$ 行：每行包含 $C$ 个字符，表示房子中各单元格的礼物分布状态

最后一行：表示圣诞老人最终停留的单元格的行和列位置

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
5 3\n.1.\n#F3\n#9.\n..1\n..&lt;\n10 4\nRRDDDULUUU
```

### 输出

```

```


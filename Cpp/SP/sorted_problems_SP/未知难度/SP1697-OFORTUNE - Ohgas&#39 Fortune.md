---
title: "OFORTUNE - Ohgas&#39 Fortune"
layout: "post"
diff: 难度0
pid: SP1697
tag: []
---

# OFORTUNE - Ohgas&#39 Fortune

## 题目描述

Ohga 家族是位于八王子市的一个显赫家族。家族首领 Nemochi Ohga 先生是一位知名富豪，他希望通过将资金存入运营公司来增加财富。你需要帮助 Ohga 先生在指定时间内通过合理操作资金，最大化他的利润。

你需要从给定的操作列表中挑选一个操作，将资金存入其中。在整个期间内，你只能选择一个操作，并将所有资金投入其中。每个操作都有规定的年利率、利息类型（单利或复利）以及每年的运营费用。每年的运营费用是一个固定数额，和资金余额无关。每年年底，利息按照当前资金余额乘以年利率计算出来，并舍去小数部分。若为复利，利息会计入资金余额，成为下一年的利息计算基础；若为单利，利息将单独累积，不会计入下一年的本金计算中。然后，从资金余额中扣除运营费用。可以假设你总是有足够的资金支付运营费用（即资金余额永远不会低于运营费用）。在指定年限结束后，资金的总金额称为“最终资金总额”。对于单利，它是最后一年末资金余额加上期间累计的所有利息；对于复利，则是最后一年末的资金余额。

运营公司使用 C、C++、Java 等编程语言进行计算，因此他们对利率的设置尤其讲究。也就是说，年利率总是 0.0001220703125 的整数倍，并且在 0.0001220703125 到 0.125 之间（包括两个端点在内）。0.0001220703125 是 1/8192 的十进制表示。利率是它的倍数意味着它们在双精度浮点数二进制表示中可以无误差地表示。

例如，假设你用 1000000 日元，以年复利 0.03125（3.125%）和年运营费用 3000 日元来运作五年，资金余额变化如下：

| 年初资金余额 | 利息 | 年末资金余额 |
|--------------|------|--------------|
| 1000000      | 31250 | 1028250      |
| 1028250      | 32131 | 1057382      |
| 1057382      | 33043 | 1087425      |
| 1087425      | 33982 | 1118407      |
| 1118407      | 34950 | 1150357      |

五年后，最终资金总额为 1150357 日元。

如果在相同的情况下采用单利，则资金变化如下：

| 年初资金余额 | 利息 | 年末资金余额 | 累计利息 |
|--------------|------|--------------|----------|
| 1000000      | 31250 | 997000       | 31250    |
| 997000       | 31157 | 966000       | 62407    |
| 966000       | 30188 | 934882       | 92595    |
| 934882       | 29152 | 903034       | 121747   |
| 903034       | 28195 | 870029       | 155311   |

在这种情况下，最终资金总额是运营中的资金 870029 日元加上累计利息 155311 日元，合计 1140330 日元。

## 输入格式

输入由多组数据构成。整体输入格式如下：

```
数据组数 (=m)   
第 1 组数据   
第 2 组数据   
...   
第 m 组数据
```

数据组数 \( m \) 不超过 100。每组数据的格式如下：

```
初始资金金额   
运营年数   
可选操作数量 (=n)   
操作 1   
操作 2   
...   
操作 n
```

初始资金金额、运营年数和可选操作数量都是正整数。初始资金不超过 100000000，运营年数不超过 10，操作数量不超过 100。

每个“操作”的格式如下：

```
简单或复利 年利率 年运营费用
```

其中，“简单或复利”是一个字符，'0' 表示单利，'1' 表示复利。年利率是一个十进制小数，是 1/8192 的整数倍。年运营费用是一个不超过 100000 的整数。

## 输出格式

对于每组数据，输出一行，包含一个整数，表示最佳操作的最终资金总额。即所有可用操作中产生最大最终资金总额的数值。每行的输出只包含这个数，不要包含其他字符。

可以假设最终余额永远不会超过 1000000000，并且至少有一个操作会使最终资金总额不低于初始资金金额。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
4
1000000
5
2
0 0.03125 3000
1 0.03125 3000
6620000
7
2
0 0.0732421875 42307
1 0.0740966796875 40942
39677000
4
4
0 0.0709228515625 30754
1 0.00634765625 26165
0 0.03662109375 79468
0 0.0679931640625 10932
10585000
6
4
1 0.0054931640625 59759
1 0.12353515625 56464
0 0.0496826171875 98193
0 0.0887451171875 78966
```

### 输出

```
1150357
10559683
50796918
20829397
```


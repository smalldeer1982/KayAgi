---
title: "TAP2014E - Erdos et al"
layout: "post"
diff: 难度0
pid: SP21172
tag: []
---

# TAP2014E - Erdos et al

## 题目描述

20世纪，匈牙利数学家 Paul Erdös 享有崇高的声誉。能够与他共同发表论文，甚至仅仅与他的合作者合作发表论文，都被视为一份殊荣。此外，与曾合著过论文的人的再一次合作，也是众多年轻研究学者的梦想。

在这种荣誉系统的驱动下，形成了「Erdös 数」的概念。Erdös 本人的 Erdös 数为 0，对其他任何人 **p**，其 Erdös 数 **n** 定义为最短的论文序列 **a$_{1}$, ... , a$_{n}$**，其中 Erdös 是论文 **a$_{1}$** 的作者，**p** 是论文 **a$_{n}$** 的作者，并且任意相邻的两篇论文 **a$_{i}$** 和 **a$_{i+1}$** （对于 **i = 1, 2, ..., n-1**）都有至少一个共同作者。如果不存在连接 Erdös 和 **p** 的论文序列，则认为 **p** 的 Erdös 数未定义。

你的任务是根据提供的文章和作者列表计算每个人的 Erdös 数。然而，现代科研对于论文数量的要求极高，这使得论文总数以及每篇的作者数都可能很大。解决过程中我们需要应对这样的复杂性。

## 输入格式

第一行输入两个整数 **A** 和 **N**，**A** 表示文章总数，**N** 表示作者人数（**2 ≤ N ≤ 10 $^{5}$**）。每位作者以整数从 **1** 到 **N** 标识，其中 Erdös 总为 **1**。

接下来 **A** 行描述每篇文章。每行首先是一个整数 **C**，表示该文章的作者数量（**2 ≤ C ≤ 10 $^{5}$**），接着是 **C** 个不同的整数 **P$_{1}$, P$_{2}$, ..., P$_{C}$**，表示这些作者的标识（对于 **i = 1, 2, ..., C**，有 **1 ≤ P$_{i}$ ≤ N**）。所有文章的作者总数不超过 **10 $^{5}$**。

## 输出格式

针对每个测试用例，你需要输出三个整数 **D**、**M** 和 **S**。其中，**D** 是具有明确 Erdös 数的作者总人数，**M** 是这些人中最大的 Erdös 数，**S** 是这些人 Erdös 数的总和。

 **本翻译由 AI 自动生成**


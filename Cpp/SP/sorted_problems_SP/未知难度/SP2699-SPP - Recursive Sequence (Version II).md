---
title: "SPP - Recursive Sequence (Version II)"
layout: "post"
diff: 难度0
pid: SP2699
tag: []
---

# SPP - Recursive Sequence (Version II)

## 题目描述

有一个数列a，通项公式如下：

a[i]=b[i],i<=k

a[i]=c1 a[i-1]+c2 a[i-2]+...+c[k] * a[i-k]，i>k

现在给你k,b和c的值，你的任务是求出am+a(m-1)+a(m-2)+...+an的值，其中m<=n

当然，m和n的值也会给你的

注意最后的答案要与p取模

## 输入格式

第一行输入一个C，指一共有多少组数据，C最大不超过50

每组数据都有四行，第一行输入k，1<=k<=15

第二行输入k个整数，第i个数指b[i]的值

第三行输入k个整数，第i个数指ci的值

(1<=b[i]<=10^9)(1<=ci<=10^9)

第四行输入m,n,p,(1 <= m <= n <= 10 ^18,1<= p <= 10 ^8)

## 输出格式

每组数据对应输出题目要求的答案，注意要模p

## 样例 #1

### 输入

```
1
2
1 1
1 1
2 10 1000003
```

### 输出

```
142
```


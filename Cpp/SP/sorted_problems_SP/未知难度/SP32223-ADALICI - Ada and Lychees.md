---
title: "ADALICI - Ada and Lychees"
layout: "post"
diff: 难度0
pid: SP32223
tag: []
---

# ADALICI - Ada and Lychees

## 题目描述

Ada the Ladybug 是一位荔枝树的种植者。与樱桃树不同，荔枝树形成了一棵有根树（根节点为 0）。荔枝果实成串生长，通常在每个节点上有多个果实。

Ada 会给你一系列查询，每个查询由三个数字构成：**节点 U 的索引**、**I 的祖先**、**L 个新荔枝**。具体来说，她希望在节点 **U** 的**第 I 个祖先**上采摘荔枝。在采摘完后，该节点会再长出 **L** 个新的荔枝果实。

你需要计算所有查询采摘值的总和，并输出结果。采摘值用公式 **X\*W** 计算，其中 **X** 是你要采摘的节点编号，**W** 是该节点的荔枝数量。

需注意，输入格式并不简单。你会得到树的描述和参数 **x $ _{0} $ , a, b**。下一个项通过以下公式计算：**x $ _{i} $ =(a\*x $ _{i-1} $ +b)%MOD**，其中 MOD 是 **10^9+7** （即 **1000000007**）。

起初，你要确定每个节点上的荔枝数量：节点 **i** 上的荔枝数量等于 **x $ _{i} $ %100003** （即 **10 $ ^{5} $ +3）。然后会有 **Q** 个查询，给出 **U, I, L** （用 **XT** 表示下一个 **x $ _{i} $**），计算得出 **U=XT%N**，**I=XT%(D\[U\]+1)** （其中 **D** 表示深度，根节点深度为 0），**L=XT%100003**。\[XT 的计算顺序从左至右\]

**注意**：每个节点的父节点 ID 都小于该节点本身（因为离根较远的荔枝更美味）。

## 输入格式

第一行包含五个整数：**N, Q, x $ _{0} $ , a, b**。

接下来的 **N-1** 行，每行包含两个整数 **0 ≤ u < v < N**，表示连接两个节点的边。

## 输出格式

输出一行，表示所有查询采摘值的总和。

## 说明/提示

$1 \le N \le 2 \times 10^5$，$1 \le Q \le 10^5$，$0 \le x_0, a, b < 10^9+7$，$0 \le u < v < N$。

 **本翻译由 AI 自动生成**


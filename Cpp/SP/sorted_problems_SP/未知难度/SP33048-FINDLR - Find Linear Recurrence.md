---
title: "FINDLR - Find Linear Recurrence"
layout: "post"
diff: 难度0
pid: SP33048
tag: []
---

# FINDLR - Find Linear Recurrence

## 题目描述

# 翻译
给定一个 $K$ 阶线性递推的无限数列 $a$ 的前 $2K$ 项，即 $a_0$，$a_1$，$\cdots$，$a_{2K-1}$。（在模 $M$ 的意义下）

一个数列满足 $K$ 阶线性递推，即满足以下式子：

$$a_n=\sum_{i=1}^{K}c_{i}a_{n-i} \quad (\forall \; n \geq K)$$

其中 $c_1$，$c_2$，$\cdots$，$c_K$ 是常数。

现在求 $a_{2K}$ 在模 $M$ 意义下的值。

## 输入格式

**本题有多组测试数据。**

第一行输入一个整数 $T$ ($1 \leq T \leq 4000$)，表示数据组数。

接下来每一组数据包含两行：

- 第一行包含 $K$ ($1 \leq K \leq 50$) 和 $M$ ($1 \leq M < 2^{31}$)。
- 第二行包含 $2K$ 个整数 $a_0$，$a_1$，$\cdots$，$a_{2K-1}$（在模 $M$ 的意义下）。

**注意：$M$ 不一定是质数。**

## 输出格式

对于每组数据，输出一行答案，即 $a_{2K}$（在模 $M$ 的意义下）。

------------

感谢 @[wsyhb](https://www.luogu.com.cn/user/145355) 提供翻译

## 样例 #1

### 输入

```
6
1 16
4 8
1 10
4 8
2 64
13 21 34 55
2 27
13 21 7 1
3 1000000007
32 16 8 4 2 1
2 64
13 21 34 56
```

### 输出

```
0
6
25
8
500000004
40
```


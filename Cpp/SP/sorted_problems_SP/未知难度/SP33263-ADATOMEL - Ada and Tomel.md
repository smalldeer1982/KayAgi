---
title: "ADATOMEL - Ada and Tomel"
layout: "post"
diff: 难度0
pid: SP33263
tag: []
---

# ADATOMEL - Ada and Tomel

## 题目描述

你可能已经知道，瓢虫 Ada 是一位农夫，她种植了一种叫做 tomel 的树。Tomel 树非常特殊，它的生长方式是从一个带有随机口味果实的根节点开始。每当一根新枝条生长时，它会从一个已存在的随机节点开始。在分支完全长成之前，新分支不会开始生长。当分支完全长成时，它的末端会出现一个带有随机口味果实的节点。

由于“随机”这个词可能让你久违，Ada 选择了三条随机路径，想要找到这三条路径上所有果实中，有多少种不同的口味。

**注意：** 这里提到的“随机”都真正意味着每个可能的值都有相同的概率。

## 输入格式

第一行输入包含三个整数 $N, K, Q$，分别表示 tomel 树的节点数量、口味的种类数以及 Ada 提出的询问数量。

接下来的行中，有 $N-1$ 个整数，第 $i$ 个整数表示第 $i+1$ 个节点的父节点（节点序号从 $0$ 到 $N-2$）。

再接下来的行包含 $N$ 个整数，表示每个节点上的果实口味。

接着有 $Q$ 行，每行包含六个整数 $B, E, X, Y, L, R$，代表三条路径的起点和终点，分别是路径 $(B, E)$、$(X, Y)$ 和 $(L, R)$。

## 输出格式

对于每一个询问，输出三条路径上存在的不同口味的数量。

## 说明/提示

$$1 \le N, K, Q \le 10^5$$

 **本翻译由 AI 自动生成**


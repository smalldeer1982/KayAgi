---
title: "ADAGRAFT - Ada and Graft"
layout: "post"
diff: 难度0
pid: SP33331
tag: []
---

# ADAGRAFT - Ada and Graft

## 题目描述

您可能已经知道，Ada是一个农民。她种了一棵大果树（根为0）。树的每个节点上都有一个果实。Ada正在参加嫁接比赛并且这是她的杰作。 最有价值的树将会赢得比赛。**树的价值定义为每个节点的价值乘积。每个节点的值是其子树中不同水果种类的数量**。

你能求出艾达的树的价值吗？ 由于此数字可能很大，因此请对109 + 7取模。

## 输入格式

第一行将包含1≤N≤4 * 10^5。

第二行将包含N-1个整数0≤pi <i,分别表示节点i的父亲节点。

第三行将包含N个整数，0≤Fi≤10^9，表示生长在第i个节点上的水果。

## 输出格式

输出一个整数表示答案模1000000007的值。

## 样例

##### 样例输入1

```cpp
5
0 0 1 1
1 1 1 2 2
```

##### 样例输出1

```cpp
4
```

##### 样例输入2

```cpp
4
0 1 2
6 7 2 3
```

##### 样例输出2

```cpp
24
```

##### 样例输入3

```cpp
11
0 1 1 1 3 5 2 7 5 4
494052753 959648710 959648710 959648710 494052753 959648710 959648710 959648710 959648710 494052753 959648710
```

##### 样例输出3

```cpp
32
```


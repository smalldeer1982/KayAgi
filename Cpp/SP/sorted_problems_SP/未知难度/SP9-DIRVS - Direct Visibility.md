---
title: "DIRVS - Direct Visibility"
layout: "post"
diff: 难度0
pid: SP9
tag: []
---

# DIRVS - Direct Visibility

## 题目描述

```
建造全球移动通信系统网络是一项非常昂贵且复杂的任务。此外，在基站收发站（BTS）建成并投入使用之后，我们需要进行许多不同的测量来确定网络的状态，并且提出有效的改进措施。
ACM技术人员有一种专门的用来测量电磁场强度、收发器功率以及信号质量的设备。这种设备被装入到一个巨大的背包里，技术人员必须带着背包从一个基站移动到另一个基站。不幸的是，背包没有足够的空间来存放所有的测量值。它只有一个小的储存空间来储存几秒钟的测量值。测量值必须通过红外线传输到基站。红外传输需要技术人员与基站直接可见。
你的任务是找出两个基站之间的一条路径，使得在路径中的每时每刻都有至少一个基站是可见的。

## 输入格式

输入的第一行只有一个正整数T（约为500），代表测试用例个数。每个测试用例都给出了一个城镇的描述。为了简化问题，城镇用一个P×Q的矩形网格来表示。每一块地都恰好一米宽。对于每一块地都给出一个非负整数Zij，代表这一块地的高度，单位为米。这意味着城镇模型都是由立方体构成的，要么是实心的立方体，要么是空心的，不存在部分实心的立方体。
每个测试用例的第一行都包含两个整数P和Q，中间用一个空格分开，且1<=P，Q<=200。接下来的P行，每行都有Q个整数（中间用一个空格分开）。这些整数就是Zij（1<=i<=P，1<=j<=Q，0<=Zij<=5000）。在描述完城镇的地形后，在每个测试用例的最后一行，有四个数字R1，C1，R2，C2，代表两个基站的位置（1<=R1，R2<=P，1<=C1，C2<=Q）。R代表是位于城镇的第几行，L代表第几列。
技术人员是按照“步”来移动的。（“步（steps）”全程为“标准技术人员的基本步骤转移”）每一步都只能在相邻的两块地间进行。这意味着每步都只能是东南西北这四个方向。对角线方向的移动是不被允许的。A地与B地之间的移动只有在两地高度相差不多的情况下才被允许。因为技术人员一次最多能向上爬1米或向下爬3米。
在每一步结束时，都必须至少有一个基站是可见的。但是，如果存在在某一步进行到中间时没有基站可见也是被允许的，因为数据可以被储存空间处理。基站被认为是可见的，当且仅当基站坐标正上方的那一个立方体与技术人员所在的那个立方体之间直接可见。两个立方体之间的直接可见被定义为这两个立方体中心的连线不与其他任何其他的实心立方体相交。换句话说，就是把基站和技术人员都看作距地面0.5米且位于适当立方体区域中心的点。
注意红外线可以穿过两个紧挨着的立方体的缝隙，即使中间并没有空间。因为光束虽然接触到了两个立方体但是并未与任何一个“相交”。详情请参考最后一个输入样例。

## 输出格式

请你找到从位于（R1，C1）的基站到位于（R2，C2）的基站的符合上述条件的最短路径。每一步都必须在两块相邻的地上进行，且这两块地高度不能相差太多，并且在每一步的结束，都必须至少有一个基站是可见的。
对于每个测试用例，输出“The shortest path is M steps long.”M为最短路径所需步数。如果不存在这样的路径，输出“Mission impossible!”。
```
贡献者：射命丸文

## 样例 #1

### 输入

```
4
5 5
8 7 6 5 4
2 2 2 2 2
2 2 2 2 2
2 2 2 2 2
2 2 2 2 2
1 1 5 1
5 8
2 2 2 2 2 2 2 2
2 2 2 2 2 2 2 2
2 2 2 2 2 2 2 2
9 9 9 9 9 9 9 2
2 2 2 2 2 2 2 2
1 2 5 1
5 8
2 2 2 2 2 2 2 2
2 2 2 2 2 2 2 2
2 2 2 2 2 2 2 2
9 9 9 9 9 9 9 2
2 2 2 2 2 2 2 2
1 5 5 1
6 12
5 5 5 5 1 5 5 5 5 5 5 5
5 5 5 5 1 5 5 5 5 5 5 5
5 5 5 5 9 5 5 5 5 5 5 5
5 9 1 5 5 5 5 5 5 5 5 5
5 5 9 5 5 5 5 5 5 5 5 5
5 5 9 5 5 5 5 5 5 5 5 5
6 1 3 12
```

### 输出

```
The shortest path is 10 steps long.
Mission impossible!
The shortest path is 14 steps long.
The shortest path is 18 steps long.
```


---
title: "PT07J - Query on a tree III"
layout: "post"
diff: 省选/NOI-
pid: SP1487
tag: ['深度优先搜索 DFS', '可持久化线段树']
---

# PT07J - Query on a tree III

## 题目描述

你被给定一棵带点权的 $n$ 个点的有根树，点从 $1$ 到 $n$ 编号。

定义查询 $q(x,k)$：寻找以 $x$ 为根的子树中的第 $k$ 小点的编号（从小到大排序第 $k$ 个点）。

保证没有两个相同的点权。

## 样例 #1

### 输入

```
5
1 3 5 2 7
1 2
2 3
1 4
3 5
4
2 3
4 1
3 2
3 2
```

### 输出

```
5
4
5
5
```


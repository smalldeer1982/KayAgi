# 题目信息

# Spreading the Wealth

## 题目描述

圆桌旁边坐着$n$个人，每个人有一定数量的金币，金币的总数能被$n$整除。每个人可以给他左右相邻的人一些金币，最终使得每个人的金币数量相等。您的任务是求出被转手的金币的数量的最小值。

　

## 样例 #1

### 输入

```
3
100
100
100
4
1
2
5
4```

### 输出

```
0
4```

# AI分析结果



---

## 唯一算法分类
**数学（中位数应用）**

---

## 综合分析与结论

### 核心算法流程
1. **数学模型建立**：通过递推公式将每个金币传递量转化为关于第一个变量 \( x_1 \) 的表达式。
2. **中位数优化**：将问题转化为求数轴上到一组点的距离之和最小，选择中位数作为最优解。
3. **环形结构处理**：通过前缀和递推 \( C_i = C_{i-1} + A_i - M \) 将环形问题线性化。

**可视化设计思路**：
- **动画方案**：用像素方块表示 \( C \) 数组的值，排序后动态绘制数轴上的点，高亮中位数位置，逐步累加各点距离。
- **颜色标记**：红色标记当前处理的 \( C_i \)，绿色标记已排序的数组，黄色高亮中位数。
- **复古音效**：排序完成时播放 8-bit 音效，选中中位数时播放上扬音调，距离计算时触发轻微点击声。

---

## 题解评分与亮点（≥4星）

### 1. DarthVictor（5星）
- **亮点**：最完整的数学推导，修正了中位数边界条件的 BUG，代码可读性强。
- **关键代码**：
  ```cpp
  for(int i=1;i<=n;i++) c[i]=c[i-1]+a[i]-ave;
  sort(c+1,c+1+n);
  ll mid=c[n/2]; // 修正为考虑偶数情况的中位数
  ```

### 2. 风浔凌（4星）
- **亮点**：引入 `nth_element` 优化排序步骤，时间复杂度降为 \( O(n) \)。
- **核心思想**：
  ```cpp
  nth_element(c+1, c+mid, c+n+1); // 快速定位中位数
  ```

### 3. Sweetie_Liu（4星）
- **亮点**：用清晰的数学语言描述环形方程组的简化过程，代码结构简洁。
- **关键推导**：
  ```
  x_i = x_1 - (A_1 + ... + A_{i-1} - (i-1)M)
  ```

---

## 最优思路与技巧

### 核心技巧
- **中位数降维**：将 \( n \) 元绝对值最值问题转化为单变量中位数问题。
- **前缀和递推**：通过 \( C_i = C_{i-1} + A_i - M \) 快速计算关键数组。
- **环形转线性**：利用递推公式消除环形依赖，将问题转化为线性序列。

### 代码片段
```cpp
// 核心递推与计算
ll sum = 0, M = tot / n;
for(int i=1; i<=n; i++) {
    sum += a[i] - M;
    c[i] = sum;
}
sort(c+1, c+n+1);
ll ans = 0, mid = c[(n+1)/2];
for(int i=1; i<=n; i++) ans += abs(c[i] - mid);
```

---

## 同类型题与推荐

### 相似算法套路
- **环形均分问题**：通过前缀和与中位数解决传递代价最小化。
- **绝对值最值**：中位数性质在数轴距离问题中的广泛应用。

### 推荐题目
1. **P2512 [HAOI2008] 糖果传递**（环形均分模板题）
2. **P4016 负载平衡问题**（网络流解法与数学解法的对比）
3. **P3156 分金币**（二维平面均分问题）

---

## 个人心得摘录

### DarthVictor
> "在测试 n=5 时发现原代码错误，意识到偶数情况需取两中位数的最小值。数学模型的边界条件必须严格验证。"

### 风浔凌
> "使用 `nth_element` 后运行时间从 120ms 降至 80ms，STL 的灵活运用能显著优化代码效率。"

---

## 可视化与游戏化设计

### 像素动画实现
1. **Canvas 绘制**：
   - 用 16x16 像素块表示 \( C \) 数组值，初始随机颜色。
   - 排序过程动态展示冒泡效果，每次交换触发 "哔" 声。
2. **中位数选择**：
   - 中位数位置用闪烁黄色方块标记，播放 "叮" 音效。
3. **距离计算**：
   - 每个距离累加时显示红色连线，总结果以 8-bit 字体弹出。

### 游戏化功能
- **连击奖励**：每正确推导一步增加连击数，连击中断播放失败音效。
- **自动演示**：AI 模式逐步展示递推、排序、计算过程，速度可调。

```javascript
// 音效示例（Web Audio API）
function playBeep() {
    const ctx = new AudioContext();
    const osc = ctx.createOscillator();
    osc.type = 'square';
    osc.frequency.setValueAtTime(800, ctx.currentTime);
    osc.connect(ctx.destination);
    osc.start();
    osc.stop(ctx.currentTime + 0.1);
}
```

---

**通过数学建模与像素化交互，将抽象的中位数优化转化为直观的视觉体验，让算法学习如同闯关游戏般生动有趣。**

---
处理用时：80.49秒